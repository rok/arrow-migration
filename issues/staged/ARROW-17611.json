{
    "issue": {
        "title": "[Rust] Boolean column data saved with V2 from arrow-rs unreadable by pyarrow",
        "body": "***Note**: This issue was originally created as [ARROW-17611](https://issues.apache.org/jira/browse/ARROW-17611). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nI'm generating Parquet V2 files with boolean column, but when trying to read them with pyarrow ({_}parquet-tool{_}s or {_}parq{_}) I'm getting\u00a0\r\n```java\n\r\nOSError: Unknown encoding type. \n```\r\nTo reproduce run following Rust program:\r\n```java\n\r\nuse arrow::json;\r\nuse std::fs::File;\r\n\r\nconst DATA: &'static str = r#\"\r\n\u00a0 \u00a0{\"x\": 1, \"y\": false}\r\n\"#;\r\n\r\nfn main() -> anyhow::Result<()> {\r\n\u00a0 \u00a0let mut json = json::ReaderBuilder::new().infer_schema(Some(2))\r\n\u00a0 \u00a0 \u00a0 .build(std::io::Cursor::new(DATA.as_bytes()))?;\r\n   let batch = json.next()?.unwrap();\u00a0 \u00a0\r\n   let out_file = File::create(\"x.parquet\")?;\r\n\u00a0 \u00a0let props = parquet::file::properties::WriterProperties::builder()\r\n      .set_writer_version(\r\n          parquet::file::properties::WriterVersion::PARQUET_2_0)\r\n\u00a0 \u00a0 \u00a0 .build();\r\n\u00a0 \u00a0let mut writer = parquet::arrow::ArrowWriter::try_new(\r\n          out_file, batch.schema(), Some(props))?;\r\n\u00a0 \u00a0writer.write(&batch)?;\r\n\u00a0 \u00a0writer.close()?;\r\n\u00a0 \u00a0Ok(())\r\n} \n```\r\nand try to show the output _x.parquet_ file\r\n```java\n\r\n$ cargo run\r\n$ parquet-tools show x.parquet\u00a0\r\nTraceback (most recent call last):\r\n\u00a0 File \"/home/nazgul/.local/bin/parquet-tools\", line 8, in <module>\r\n\u00a0 \u00a0 sys.exit(main())\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/parquet_tools/cli.py\", line 26, in main\r\n\u00a0 \u00a0 args.handler(args)\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/parquet_tools/commands/show.py\", line 59, in _cli\r\n\u00a0 \u00a0 with get_datafame_from_objs(pfs, args.head) as df:\r\n\u00a0 File \"/usr/lib/python3.10/contextlib.py\", line 135, in __enter__\r\n\u00a0 \u00a0 return next(self.gen)\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/parquet_tools/commands/utils.py\", line 190, in get_datafame_from_objs\r\n\u00a0 \u00a0 df: Optional[pd.DataFrame] = stack.enter_context(pf.get_dataframe())\r\n\u00a0 File \"/usr/lib/python3.10/contextlib.py\", line 492, in enter_context\r\n\u00a0 \u00a0 result = _cm_type.__enter__(cm)\r\n\u00a0 File \"/usr/lib/python3.10/contextlib.py\", line 135, in __enter__\r\n\u00a0 \u00a0 return next(self.gen)\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/parquet_tools/commands/utils.py\", line 71, in get_dataframe\r\n\u00a0 \u00a0 yield pq.read_table(local_path).to_pandas()\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/pyarrow/parquet/__init__.py\", line 2827, in read_table\r\n\u00a0 \u00a0 return dataset.read(columns=columns, use_threads=use_threads,\r\n\u00a0 File \"/home/nazgul/.local/lib/python3.10/site-packages/pyarrow/parquet/__init__.py\", line 2473, in read\r\n\u00a0 \u00a0 table = self._dataset.to_table(\r\n\u00a0 File \"pyarrow/_dataset.pyx\", line 331, in pyarrow._dataset.Dataset.to_table\r\n\u00a0 File \"pyarrow/_dataset.pyx\", line 2577, in pyarrow._dataset.Scanner.to_table\r\n\u00a0 File \"pyarrow/error.pxi\", line 144, in pyarrow.lib.pyarrow_internal_check_status\r\n\u00a0 File \"pyarrow/error.pxi\", line 115, in pyarrow.lib.check_status\r\nOSError: Unknown encoding type. \n```\r\n\u00a0",
        "created_at": "2022-09-04T16:58:26.000Z",
        "updated_at": "2022-10-22T03:56:35.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Format",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-10-22T03:56:35.000Z"
    },
    "comments": [
        {
            "created_at": "2022-10-19T12:42:43.764Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17611?focusedCommentId=17620333) by Miles Granger (milesgranger):*\n~~[main.rs](main.rs)I adapted\u00a0[arrow2's parquet_write.rs ](https://github.com/jorgecarleitao/arrow2/blob/27e109d54c88a91dc48285ac9a60cfcd93965407/examples/parquet_write.rs) example to use ``BooleanArray`` and it works fine. Suspect there is something wrong in your implementation? Perhaps open an issue with [arrow2 ](https://github.com/jorgecarleitao/arrow2/issues)?~~\r\n\r\n\u2014\r\n\r\nEDIT: My mistake, I was assuming arrow2 and not arrow-rs. Disregard."
        },
        {
            "created_at": "2022-10-20T11:41:04.292Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17611?focusedCommentId=17621039) by Miles Granger (milesgranger):*\nIt seems `arrow-rs` defaults to RLE for the boolean array; but that can be changed using a different encoding thru [set_encoding](https://docs.rs/parquet/latest/parquet/file/properties/struct.WriterPropertiesBuilder.html#method.set_encoding) on the Builder.\r\n\r\nOther good news, is pyarrow 10.x should (and does work, checking on master now) read the given file, thanks to ARROW-18031  being closed.\r\n\r\n\u2014\r\n\r\nEDIT: If this answers the question/issue, can we close this?"
        },
        {
            "created_at": "2022-10-22T03:56:06.807Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17611?focusedCommentId=17622546) by Kamil Skalski (kskalski):*\nThanks for debugging, indeed forcing plain encoding in writer options allows pyarrow to read the output file.\r\n\r\nI think this can be closed if https://issues.apache.org/jira/browse/ARROW-18031 fixes this issue too."
        }
    ]
}