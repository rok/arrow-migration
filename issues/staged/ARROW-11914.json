{
    "issue": {
        "title": "[R] [CI] r-sanitizer nightly is broken",
        "body": "***Note**: This issue was originally created as [ARROW-11914](https://issues.apache.org/jira/browse/ARROW-11914). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nThe test is `test-ubuntu-18.04-r-sanitizer` and it has been failing pretty consistently. \r\n\r\nOne example of a failure is: https://dev.azure.com/ursacomputing/crossbow/_build/results?buildId=1888&view=logs&j=0da5d1d9-276d-5173-c4c4-9d4d4ed14fdb&t=d9b15392-e4ce-5e4c-0c8c-b69645229181&l=792",
        "created_at": "2021-03-09T14:30:44.000Z",
        "updated_at": "2021-03-26T22:30:14.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Continuous Integration",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2021-03-26T22:29:59.000Z"
    },
    "comments": [
        {
            "created_at": "2021-03-15T21:14:50.748Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17301996) by Neal Richardson (npr):*\nLast success was March 1, running 137d495da ARROW-11788: [Java] Fix appending empty delta vectors: https://dev.azure.com/ursacomputing/crossbow/_build/results?buildId=1622&view=logs&j=0da5d1d9-276d-5173-c4c4-9d4d4ed14fdb&t=73c4289c-110b-5085-4a98-4009fa5cc9c8\r\n\r\nMarch 2 was the first failure, running 7184c3f46 ARROW-10570: [R] Use Converter API to convert SEXP to Array/ChunkedArray: https://dev.azure.com/ursacomputing/crossbow/_build/results?buildId=1651&view=logs&j=0da5d1d9-276d-5173-c4c4-9d4d4ed14fdb&t=73c4289c-110b-5085-4a98-4009fa5cc9c8\r\n\r\nThere are no corresponding changes to the base docker image in that time: https://github.com/wch/r-debug/commits/master\r\n\r\nIt seems most likely that ARROW-10570 is responsible for the error, though we should look to see if there are any other commits in the range that could have affected how the sanitizer job runs. What's odd is that we don't get sanitizer output, so perhaps that means that the RDsan process is crashing?"
        },
        {
            "created_at": "2021-03-26T18:09:15.341Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309619) by Jonathan Keane (jonkeane):*\nReading testthat.out locally:\r\n\r\n```Java\n\r\n=ERROR: AddressSanitizer: heap-use-after-free on address 0x60b0000af1e0 at pc 0x7faded148f0d bp 0x7ffd1c986c00 sp 0x7ffd1c986bf0\r\nREAD of size 8 at 0x60b0000af1e0 thread T0\r\n    #0 0x7faded148f0c in arrow::r::Converter_Dictionary::GetOrdered() const (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0xfe2ef0c)\r\n    #1 0x7faded147bb8 in arrow::r::Converter_Dictionary::Allocate(long) const (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0xfe2dbb8)\r\n    #2 0x7faded130dd8 in arrow::r::ArrayVector__as_vector(long, std::shared_ptr<arrow::DataType> const&, std::vector<std::shared_ptr<arrow::Array>, std::allocator<std::shared_ptr<arrow::Array> > > const&) /arrow/r/src/array_to_vector.cpp:144\r\n    #3 0x7faded136c7e in Array__as_vector(std::shared_ptr<arrow::Array> const&) /arrow/r/src/array_to_vector.cpp:1275\r\n    #4 0x7faded237b9a in _arrow_Array__as_vector /arrow/r/src/arrowExports.cpp:306\r\n    #5 0x7fae10f351f3 in R_doDotCall /tmp/r-source/src/main/dotcode.c:598\r\n    #6 0x7fae1102dbad in bcEval /tmp/r-source/src/main/eval.c:7671\r\n    #7 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #8 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #9 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #10 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #11 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #12 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #13 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #14 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #15 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #16 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #17 0x7fae110c2b9c in applyMethod /tmp/r-source/src/main/objects.c:118\r\n    #18 0x7fae110c48d5 in dispatchMethod /tmp/r-source/src/main/objects.c:436\r\n    #19 0x7fae110c4bd6 in Rf_usemethod /tmp/r-source/src/main/objects.c:472\r\n    #20 0x7fae10fe757d in Rf_DispatchOrEval /tmp/r-source/src/main/eval.c:3623\r\n    #21 0x7fae10eb636d in do_asvector /tmp/r-source/src/main/coerce.c:1498\r\n    #22 0x7fae11002de1 in bcEval /tmp/r-source/src/main/eval.c:7115\r\n    #23 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #24 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #25 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #26 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #27 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #28 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #29 0x7fae10fd5148 in Rf_eval /tmp/r-source/src/main/eval.c:750\r\n    #30 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #31 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #32 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #33 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #34 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #35 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #36 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #37 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #38 0x7fae10fddb7d in do_if /tmp/r-source/src/main/eval.c:2225\r\n    #39 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #40 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #41 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #42 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #43 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #44 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #45 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #46 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #47 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #48 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #49 0x7fae10fe357a in do_set /tmp/r-source/src/main/eval.c:2969\r\n    #50 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #51 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #52 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #53 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #54 0x7fae10fd5148 in Rf_eval /tmp/r-source/src/main/eval.c:750\r\n    #55 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #56 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #57 0x7fae10fe5cd7 in do_eval /tmp/r-source/src/main/eval.c:3344\r\n    #58 0x7fae11002de1 in bcEval /tmp/r-source/src/main/eval.c:7115\r\n    #59 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #60 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #61 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #62 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #63 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #64 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #65 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #66 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #67 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #68 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #69 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #70 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #71 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #72 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #73 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #74 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #75 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #76 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #77 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #78 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #79 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #80 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #81 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #82 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #83 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #84 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #85 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #86 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #87 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #88 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #89 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #90 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #91 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #92 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #93 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #94 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #95 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #96 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #97 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #98 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #99 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #100 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #101 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #102 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #103 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #104 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #105 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #106 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #107 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #108 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #109 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #110 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #111 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #112 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #113 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #114 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #115 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #116 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #117 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #118 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #119 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #120 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #121 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #122 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #123 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #124 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #125 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #126 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #127 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #128 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #129 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #130 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #131 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #132 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #133 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #134 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #135 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #136 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #137 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #138 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #139 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #140 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #141 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #142 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #143 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #144 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #145 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #146 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #147 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #148 0x7fae10fe605a in do_eval /tmp/r-source/src/main/eval.c:3367\r\n    #149 0x7fae11002de1 in bcEval /tmp/r-source/src/main/eval.c:7115\r\n    #150 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #151 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #152 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #153 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #154 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #155 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #156 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #157 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #158 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #159 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #160 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #161 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #162 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #163 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #164 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #165 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #166 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #167 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #168 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #169 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #170 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #171 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #172 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #173 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #174 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #175 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #176 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #177 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #178 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #179 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #180 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #181 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #182 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #183 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #184 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #185 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #186 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #187 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #188 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #189 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #190 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #191 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #192 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #193 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #194 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #195 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #196 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #197 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #198 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #199 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #200 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #201 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #202 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #203 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #204 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #205 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #206 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #207 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #208 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #209 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n    #210 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #211 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #212 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #213 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #214 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #215 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #216 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #217 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #218 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #219 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #220 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #221 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #222 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #223 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #224 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #225 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #226 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #227 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #228 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #229 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #230 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #231 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #232 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #233 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #234 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #235 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #236 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #237 0x7fae10fdc416 in R_forceAndCall /tmp/r-source/src/main/eval.c:1964\r\n    #238 0x7fae10e4da63 in do_lapply /tmp/r-source/src/main/apply.c:70\r\n    #239 0x7fae110c1b19 in do_internal /tmp/r-source/src/main/names.c:1397\r\n    #240 0x7fae11003328 in bcEval /tmp/r-source/src/main/eval.c:7135\r\n    #241 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #242 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #243 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #244 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #245 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #246 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #247 0x7fae10fec0dc in FORCE_PROMISE /tmp/r-source/src/main/eval.c:5136\r\n    #248 0x7fae10fec48c in getvar /tmp/r-source/src/main/eval.c:5177\r\n    #249 0x7fae10ffbb9c in bcEval /tmp/r-source/src/main/eval.c:6867\r\n\r\n0x60b0000af1e0 is located 16 bytes inside of 112-byte region [0x60b0000af1d0,0x60b0000af240)\r\nfreed by thread T0 here:\r\n    #0 0x7fae11702a37 in operator delete(void*) (/usr/lib/x86_64-linux-gnu/libasan.so.6+0xb2a37)\r\n    #1 0x7fadf3cc220c in std::_Sp_counted_ptr_inplace<arrow::DictionaryType, std::allocator<arrow::DictionaryType>, (__gnu_cxx::_Lock_policy)2>::_M_destroy() (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0x169a820c)\r\n    #2 0x7faded1250f2 in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() /usr/include/c++/10/bits/shared_ptr_base.h:174\r\n    #3 0x7faded120723 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::~__shared_count() /usr/include/c++/10/bits/shared_ptr_base.h:733\r\n    #4 0x7faded13c63e in std::__shared_ptr<arrow::DataType, (__gnu_cxx::_Lock_policy)2>::~__shared_ptr() /usr/include/c++/10/bits/shared_ptr_base.h:1183\r\n    #5 0x7faded3a55e1 in std::__shared_ptr<arrow::DataType, (__gnu_cxx::_Lock_policy)2>::operator=(std::__shared_ptr<arrow::DataType, (__gnu_cxx::_Lock_policy)2>&&) /usr/include/c++/10/bits/shared_ptr_base.h:1279\r\n    #6 0x7faded3a486a in std::shared_ptr<arrow::DataType>::operator=(std::shared_ptr<arrow::DataType>&&) /usr/include/c++/10/bits/shared_ptr.h:384\r\n    #7 0x7faded5af844 in arrow::r::RDictionaryConverter<arrow::StringType, void>::ToArray() /arrow/r/src/r_to_arrow.cpp:777\r\n    #8 0x7faded5130b0 in arrow::r::vec_to_arrow(SEXPREC*, std::shared_ptr<arrow::DataType> const&, bool) /arrow/r/src/r_to_arrow.cpp:1026\r\n    #9 0x7faded51367d in vec_to_arrow(SEXPREC*, SEXPREC*) /arrow/r/src/r_to_arrow.cpp:1043\r\n    #10 0x7faded2d3b39 in _arrow_vec_to_arrow /arrow/r/src/arrowExports.cpp:3389\r\n    #11 0x7fae10f35260 in R_doDotCall /tmp/r-source/src/main/dotcode.c:601\r\n    #12 0x7fae1102dbad in bcEval /tmp/r-source/src/main/eval.c:7671\r\n    #13 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #14 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #15 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #16 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #17 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #18 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #19 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #20 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #21 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #22 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #23 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #24 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #25 0x7fae10fe357a in do_set /tmp/r-source/src/main/eval.c:2969\r\n    #26 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #27 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #28 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #29 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n\r\npreviously allocated by thread T0 here:\r\n    #0 0x7fae11701f17 in operator new(unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.6+0xb1f17)\r\n    #1 0x7fadf3caf35c in arrow::dictionary(std::shared_ptr<arrow::DataType> const&, std::shared_ptr<arrow::DataType> const&, bool) (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0x1699535c)\r\n    #2 0x7fadf4a8c19f in arrow::internal::DictionaryBuilderBase<arrow::AdaptiveIntBuilder, arrow::StringType>::FinishInternal(std::shared_ptr<arrow::ArrayData>*) (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0x1777219f)\r\n    #3 0x7fadf4eba1fd in arrow::ArrayBuilder::Finish(std::shared_ptr<arrow::Array>*) (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0x17ba01fd)\r\n    #4 0x7fadf4ef2b5b in arrow::ArrayBuilder::Finish() (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0x17bd8b5b)\r\n    #5 0x7faded5aee78 in arrow::r::RDictionaryConverter<arrow::StringType, void>::ToArray() /arrow/r/src/r_to_arrow.cpp:771\r\n    #6 0x7faded5130b0 in arrow::r::vec_to_arrow(SEXPREC*, std::shared_ptr<arrow::DataType> const&, bool) /arrow/r/src/r_to_arrow.cpp:1026\r\n    #7 0x7faded51367d in vec_to_arrow(SEXPREC*, SEXPREC*) /arrow/r/src/r_to_arrow.cpp:1043\r\n    #8 0x7faded2d3b39 in _arrow_vec_to_arrow /arrow/r/src/arrowExports.cpp:3389\r\n    #9 0x7fae10f35260 in R_doDotCall /tmp/r-source/src/main/dotcode.c:601\r\n    #10 0x7fae1102dbad in bcEval /tmp/r-source/src/main/eval.c:7671\r\n    #11 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #12 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #13 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #14 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #15 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #16 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #17 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #18 0x7fae1100250b in bcEval /tmp/r-source/src/main/eval.c:7083\r\n    #19 0x7fae10fd4db6 in Rf_eval /tmp/r-source/src/main/eval.c:727\r\n    #20 0x7fae10fdb475 in R_execClosure /tmp/r-source/src/main/eval.c:1897\r\n    #21 0x7fae10fdab66 in Rf_applyClosure /tmp/r-source/src/main/eval.c:1823\r\n    #22 0x7fae10fd5f8f in Rf_eval /tmp/r-source/src/main/eval.c:850\r\n    #23 0x7fae10fe357a in do_set /tmp/r-source/src/main/eval.c:2969\r\n    #24 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #25 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n    #26 0x7fae10fd5741 in Rf_eval /tmp/r-source/src/main/eval.c:802\r\n    #27 0x7fae10fd4211 in forcePromise /tmp/r-source/src/main/eval.c:555\r\n    #28 0x7fae10fd5148 in Rf_eval /tmp/r-source/src/main/eval.c:750\r\n    #29 0x7fae10fe0b01 in do_begin /tmp/r-source/src/main/eval.c:2517\r\n\r\nSUMMARY: AddressSanitizer: heap-use-after-free (/usr/local/RDsan/lib/R/site-library/arrow/libs/arrow.so+0xfe2ef0c) in arrow::r::Converter_Dictionary::GetOrdered() const\r\nShadow bytes around the buggy address:\r\n  0x0c168000dde0: fa fa fd fd fd fd fd fd fd fd fd fd fd fd fd fa\r\n  0x0c168000ddf0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd\r\n  0x0c168000de00: fd fd fd fd fd fa fa fa fa fa fa fa fa fa fd fd\r\n  0x0c168000de10: fd fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa\r\n  0x0c168000de20: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd\r\n=>0x0c168000de30: fd fa fa fa fa fa fa fa fa fa fd fd[fd]fd fd fd\r\n  0x0c168000de40: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa\r\n  0x0c168000de50: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fa fa\r\n  0x0c168000de60: fa fa fa fa fa fa 00 00 00 00 00 00 00 00 00 00\r\n  0x0c168000de70: 00 00 00 00 fa fa fa fa fa fa fa fa fd fd fd fd\r\n  0x0c168000de80: fd fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n  Shadow gap:              cc\r\n==325==ABORTING\r\n```"
        },
        {
            "created_at": "2021-03-26T18:19:45.835Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309630) by Neal Richardson (npr):*\nThat's this line: https://github.com/apache/arrow/blob/7184c3f46981dd52c3c521b2676796e82f17da77/r/src/array_to_vector.cpp#L662\r\n\r\nWhat's odd is that that line wasn't itself changed recently--it's in the conversion going from Arrow to R, not the R to Arrow code that was refactored around the time that this sanitizer job started failing."
        },
        {
            "created_at": "2021-03-26T18:21:28.974Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309631) by Jonathan Keane (jonkeane):*\nRight! And the only thing that changed in that file with that commit was moving `#include <type_traits>` down 10 lines (though still in the header)"
        },
        {
            "created_at": "2021-03-26T18:22:41.835Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309632) by Neal Richardson (npr):*\nWhich test fails? I guess it could be that we're testing an object that was created just before this using the new R-to-Arrow code."
        },
        {
            "created_at": "2021-03-26T18:29:10.256Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309638) by Jonathan Keane (jonkeane):*\nit looks like it's https://github.com/apache/arrow/blob/master/r/tests/testthat/test-Array.R#L236 which is a roundtrip\r\n"
        },
        {
            "created_at": "2021-03-26T20:43:33.484Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309716) by Jonathan Keane (jonkeane):*\nOk, I think I have a fix (thanks David Li!) I also added to the sanitized bash script to print testthat.out if `RDsan` fails (how this looks on a failing build should be at https://dev.azure.com/ursacomputing/crossbow/_build/results?buildId=2433&view=logs&s=96ac2280-8cb4-5df5-99de-dd2da759617d in a little while). "
        },
        {
            "created_at": "2021-03-26T22:29:59.905Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11914?focusedCommentId=17309779) by Neal Richardson (npr):*\nIssue resolved by pull request 9814\n<https://github.com/apache/arrow/pull/9814>"
        }
    ]
}