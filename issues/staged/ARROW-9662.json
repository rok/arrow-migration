{
    "issue": {
        "title": "Python feather reader segfaults on some file without explicit columns",
        "body": "***Note**: This issue was originally created as [ARROW-9662](https://issues.apache.org/jira/browse/ARROW-9662). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nthis code fails:\r\n\r\n`from pyarrow import feather`\r\n `feather.read_feather('2020-07-30_BF43CA09E5404F9_actuals.feather.zstd', columns=None, use_threads=bool(True))`\r\n\r\n\u00a0\r\n >>> from pyarrow import feather\r\n >>> feather.read_feather('2020-07-30_BF43CA09E5404F9_actuals.feather.zstd', columns=None, use_threads=bool(True))\r\n [1] 37494 segmentation fault python\r\n and this not\r\n\r\n`from pyarrow import feather`\r\n `feather.read_feather('2020-07-30_BF43CA09E5404F9_actuals.feather.zstd', columns=['prediction_id', 'class'], use_threads=bool(True))`\r\n\r\n\u00a0\r\n\r\nenv:\r\n\r\nMacOS Catalina 10.15.5\r\n\r\n$ python -V \r\nPython 3.7.0\r\n\r\n$ pip list \r\nPackage Version Location\r\n------------------------------------ ------------- ------------------------------------\r\nadal 1.2.3\r\naioredis 1.3.1\r\namqp 2.5.2\r\napipkg 1.5\r\nappdirs 1.4.3\r\napplicationinsights 0.11.9\r\nasync-timeout 3.0.1\r\nasyncio 3.4.3\r\nasyncio-redis 0.15.1\r\nattrs 19.3.0\r\nazure-common 1.1.25\r\nazure-core 1.4.0\r\nazure-graphrbac 0.61.1\r\nazure-identity 1.2.0\r\nazure-mgmt-authorization 0.60.0\r\nazure-mgmt-containerregistry 2.8.0\r\nazure-mgmt-keyvault 2.2.0\r\nazure-mgmt-resource 8.0.1\r\nazure-mgmt-storage 9.0.0\r\nazureml-automl-core 1.3.0\r\nazureml-automl-runtime 1.3.0\r\nazureml-core 1.3.0.post2\r\nazureml-dataprep 1.4.3\r\nazureml-dataprep-native 14.1.0\r\nazureml-defaults 1.3.0\r\nazureml-explain-model 1.3.0\r\nazureml-interpret 1.3.0\r\nazureml-model-management-sdk 1.0.1b6.post1\r\nazureml-pipeline 1.3.0\r\nazureml-pipeline-core 1.3.0\r\nazureml-pipeline-steps 1.3.0\r\nazureml-sdk 1.3.0\r\nazureml-telemetry 1.3.0\r\nazureml-train 1.3.0\r\nazureml-train-automl 1.3.0\r\nazureml-train-automl-client 1.3.0\r\nazureml-train-automl-runtime 1.3.0\r\nazureml-train-core 1.3.0.post1\r\nazureml-train-restclients-hyperdrive 1.3.0\r\nbackports.tempfile 1.0\r\nbackports.weakref 1.0.post1\r\nbeautifulsoup4 4.8.2\r\nbilliard 3.6.3.0\r\nbleach 3.1.4\r\nboto 2.49.0\r\nboto3 1.12.34\r\nbotocore 1.15.34\r\ncachetools 4.0.0\r\ncelery 4.4.0\r\ncertifi 2019.11.28\r\ncffi 1.14.0\r\nchardet 3.0.4\r\nclick 7.1.1\r\ncloudpickle 1.4.1\r\nconfigparser 3.7.4\r\ncontextlib2 0.6.0.post1\r\ncoverage 5.0.4\r\ncryptography 2.9.2\r\nCython 0.29.17\r\ndill 0.3.1.1\r\ndistlib 0.3.0\r\ndistro 1.5.0\r\ndocker 4.2.0\r\ndocutils 0.15.2\r\ndotnetcore2 2.1.14\r\nentrypoints 0.3\r\nexecnet 1.7.1\r\nfastapi 0.53.2\r\nfeather-format 0.4.1\r\nfilelock 3.0.12\r\nfire 0.3.1\r\nflake8 3.7.9\r\nFlask 1.0.3\r\nfreezegun 0.3.15\r\nfsspec 0.7.1\r\nfusepy 3.0.1\r\ngensim 3.8.3\r\ngevent 1.4.0\r\ngoogle-api-core 1.16.0\r\ngoogle-auth 1.12.0\r\ngoogle-cloud-automl 0.10.0\r\ngoogle-cloud-core 1.3.0\r\ngoogle-cloud-storage 1.26.0\r\ngoogle-resumable-media 0.5.0\r\ngoogleapis-common-protos 1.51.0\r\ngreenlet 0.4.15\r\ngrpcio 1.27.2\r\ngunicorn 19.9.0\r\nh11 0.9.0\r\nhiredis 1.0.1\r\nHLL 1.3.1\r\nhttptools 0.1.1\r\nidna 2.9\r\nimportlib-metadata 1.6.0\r\ninterpret-community 0.9.2\r\ninterpret-core 0.1.20\r\nisodate 0.6.0\r\nitsdangerous 1.1.0\r\njeepney 0.4.3\r\nJinja2 2.11.2\r\njmespath 0.9.5\r\njoblib 0.14.1\r\njson-logging-py 0.2\r\nJsonForm 0.0.2\r\njsonpickle 1.3\r\njsonschema 3.2.0\r\nJsonSir 0.0.2\r\nkeras2onnx 1.6.1\r\nkeyring 21.2.0\r\nkombu 4.6.8\r\nliac-arff 2.4.0\r\nlightgbm 2.3.0\r\nlxml 4.5.0\r\nmangum 0.9.0\r\nMarkupSafe 1.1.1\r\nmccabe 0.6.1\r\nmock 4.0.2\r\nmore-itertools 8.2.0\r\nmsal 1.2.0\r\nmsal-extensions 0.1.3\r\nmsrest 0.6.13\r\nmsrestazure 0.6.3\r\nmultidict 4.7.5\r\nndg-httpsclient 0.5.1\r\nnimbusml 1.7.0\r\nnumpy 1.16.2\r\noauthlib 3.1.0\r\nonnx 1.6.0\r\nonnxconverter-common 1.6.0\r\nonnxmltools 1.4.1\r\npackaging 20.3\r\npandas 0.23.4\r\npathspec 0.8.0\r\npatsy 0.5.1\r\npip 10.0.1\r\npkginfo 1.5.0.1\r\npluggy 0.13.1\r\npmdarima 1.1.1\r\nportalocker 1.7.0\r\nprotobuf 3.11.3\r\npsutil 5.7.0\r\npy 1.8.1\r\npy-cpuinfo 5.0.0\r\npyarrow 0.17.1\r\npyasn1 0.4.8\r\npyasn1-modules 0.2.8\r\npycodestyle 2.5.0\r\npycparser 2.20\r\npydantic 1.4\r\npyflakes 2.1.1\r\nPygments 2.6.1\r\nPyJWT 1.7.1\r\npyOpenSSL 19.1.0\r\npyparsing 2.4.6\r\npyrsistent 0.16.0\r\npytest 5.4.1\r\npytest-cov 2.8.1\r\npytest-forked 1.1.3\r\npytest-runner 5.2\r\npytest-xdist 1.31.0\r\npython-dateutil 2.8.1\r\npython-dotenv 0.14.0\r\nPython-EasyConfig 0.1.7\r\npytz 2019.3\r\nPyYAML 5.3.1\r\nreadme-renderer 25.0\r\nredis 3.4.1\r\nrequests 2.23.0\r\nrequests-oauthlib 1.3.0\r\nrequests-toolbelt 0.9.1\r\nResource 0.2.1\r\nrsa 4.0\r\nruamel.yaml 0.16.10\r\nruamel.yaml.clib 0.2.0\r\ns3fs 0.4.2\r\ns3transfer 0.3.3\r\nscikit-learn 0.20.3\r\nscipy 1.1.0\r\nSecretStorage 3.1.2\r\nsetuptools 46.1.3\r\nshap 0.34.0\r\nshortuuid 1.0.1\r\nsimplejson 3.17.2\r\nsix 1.14.0\r\nskl2onnx 1.4.9\r\nsklearn-pandas 1.7.0\r\nsmart-open 1.9.0\r\nsoupsieve 2.0\r\nstarlette 0.13.2\r\nstatsmodels 0.10.2\r\ntermcolor 1.1.0\r\ntoml 0.10.0\r\ntox 3.14.6\r\ntqdm 4.45.0\r\ntwine 3.1.1\r\ntyping-extensions 3.7.4.2\r\nurllib3 1.25.8\r\nuvicorn 0.11.3\r\nuvloop 0.14.0\r\nvcrpy 4.0.2\r\nvine 1.3.0\r\nvirtualenv 20.0.15\r\nwcwidth 0.1.9\r\nwebencodings 0.5.1\r\nwebsocket-client 0.57.0\r\nwebsockets 8.1\r\nWerkzeug 0.16.1\r\nwheel 0.30.0\r\nwrapt 1.12.1\r\nwsgi-intercept 1.9.2\r\nyarl 1.4.2\r\nzipp 3.1.0\r\n\r\n\u00a0",
        "created_at": "2020-08-06T06:59:18.000Z",
        "updated_at": "2020-08-06T11:56:43.000Z",
        "labels": [
            "Migrated from Jira",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-08-06T11:56:43.000Z"
    },
    "comments": [
        {
            "created_at": "2020-08-06T07:50:21.213Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172098) by Joris Van den Bossche (jorisvandenbossche):*\n`[~ketzer]` thanks for the report! \r\n\r\nTwo questions:\r\n\r\n- Would you be able to test this with the latest pyarrow release (1.0.0 instead of 0.17.1)\n- Can you reproduce this with a dummy data file (so eg if you generate some random data and write this to feather)? Or is it only with the specific file in question? And if so, what does the file look like? (or how was it written?)"
        },
        {
            "created_at": "2020-08-06T07:52:13.306Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172100) by Joris Van den Bossche (jorisvandenbossche):*\n(note: for me it doesn't segfault with pyarrow 1.0.0 on ubuntu)"
        },
        {
            "created_at": "2020-08-06T08:01:45.770Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172108) by Alex Emelynov (holyketzer):*\nOh, it works with 1.0.0, I was confused with `feather-format==0.4.1` module, with I tried to update but it didn't help. So it means that we just should update `pyarrow`\r\n\r\n\u00a0\r\n\r\nIt fails only with this file, we have a lot of similar files, all generated with `pyarrow.feather.write_feather`\r\ncontent of this file is:\r\n\r\n`,prediction_id,class,null,petal_length,petal_width,prediction_group_id,sepal_length,sepal_width`\r\n`0,6efdf66d-40a2-4074-b3db-8900c622e07f,6.0,['2.2' '5.0' '1.5' 'Iris-virginica'],5.0,1.5,136eeb53-585f-4833-a3be-da4279f3aaa2,6.0,2.2`"
        },
        {
            "created_at": "2020-08-06T08:08:34.625Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172115) by Alex Emelynov (holyketzer):*\nLooks like our system have some data corruption, this file contains `null` column with array of values in corresponding row, it's wrong, and old pyarrow fails trying to read this column"
        },
        {
            "created_at": "2020-08-06T11:23:36.961Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172277) by Alex Emelynov (holyketzer):*\nOK, i got it, there was an error on our side, with wrong data input, which caused a segfault on old pyarrow version. Sorry for noise. \r\n\r\nOh, can't close it. Feel free to close it guys. Thank you"
        },
        {
            "created_at": "2020-08-06T11:56:31.824Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-9662?focusedCommentId=17172301) by Joris Van den Bossche (jorisvandenbossche):*\nNo problem, thanks for the confirmation. Will close."
        }
    ]
}