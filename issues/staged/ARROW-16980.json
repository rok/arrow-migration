{
    "issue": {
        "title": "[Python] Results of running a substrait plan against a tpch data table written into parquet are all null",
        "body": "***Note**: This issue was originally created as [ARROW-16980](https://issues.apache.org/jira/browse/ARROW-16980). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nSQL\r\n```java\n\r\nSELECT l_returnflag, l_linestatus FROM lineitem\n```\r\n\u00a0\r\n\r\nSubstrait Plan:\r\n```java\n\r\n\"\"\"\r\n{\r\n  \"extensionUris\": [],\r\n  \"extensions\": [],\r\n  \"relations\": [{\r\n    \"root\": {\r\n      \"input\": {\r\n        \"project\": {\r\n          \"common\": {\r\n          },\r\n          \"input\": {\r\n            \"read\": {\r\n              \"common\": {\r\n                \"direct\": {\r\n                }\r\n              },\r\n              \"baseSchema\": {\r\n                \"names\": [\"L_ORDERKEY\", \"L_PARTKEY\", \"L_SUPPKEY\", \"L_LINENUMBER\", \"L_QUANTITY\", \"L_EXTENDEDPRICE\", \"L_DISCOUNT\", \"L_TAX\", \"L_RETURNFLAG\", \"L_LINESTATUS\", \"L_SHIPDATE\", \"L_COMMITDATE\", \"L_RECEIPTDATE\", \"L_SHIPINSTRUCT\", \"L_SHIPMODE\", \"L_COMMENT\"],\r\n                \"struct\": {\r\n                  \"types\": [{\r\n                    \"i64\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"i64\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"i64\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"i32\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"decimal\": {\r\n                      \"scale\": 0,\r\n                      \"precision\": 19,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"decimal\": {\r\n                      \"scale\": 0,\r\n                      \"precision\": 19,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"decimal\": {\r\n                      \"scale\": 0,\r\n                      \"precision\": 19,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"decimal\": {\r\n                      \"scale\": 0,\r\n                      \"precision\": 19,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"fixedChar\": {\r\n                      \"length\": 1,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"fixedChar\": {\r\n                      \"length\": 1,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"date\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"date\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"date\": {\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"fixedChar\": {\r\n                      \"length\": 25,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"fixedChar\": {\r\n                      \"length\": 10,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }, {\r\n                    \"varchar\": {\r\n                      \"length\": 44,\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  }],\r\n                  \"typeVariationReference\": 0,\r\n                  \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                }\r\n              },\r\n             \"local_files\": {\r\n                 \"items\": [\r\n                 {\r\n                     \"uri_file\": \"file://FILENAME_PLACEHOLDER\",\r\n                     \"format\": \"FILE_FORMAT_PARQUET\"\r\n                 }\r\n                 ]\r\n             }\r\n            }\r\n          },\r\n          \"expressions\": [{\r\n            \"selection\": {\r\n              \"directReference\": {\r\n                \"structField\": {\r\n                  \"field\": 7\r\n                }\r\n              },\r\n              \"rootReference\": {\r\n              }\r\n            }\r\n          }, {\r\n            \"selection\": {\r\n              \"directReference\": {\r\n                \"structField\": {\r\n                  \"field\": 6\r\n                }\r\n              },\r\n              \"rootReference\": {\r\n              }\r\n            }\r\n          }]\r\n        }\r\n      },\r\n      \"names\": [\"L_TAX\", \"L_DISCOUNT\"]\r\n    }\r\n  }],\r\n  \"expectedTypeUrls\": []\r\n}\r\n\"\"\" \n```\r\n\u00a0\r\n\r\n\u00a0\r\n\r\nResult:\r\n```java\n\r\npyarrow.Table\r\nL_TAX: decimal128(19, 0)\r\nL_DISCOUNT: decimal128(19, 0)\r\n----\r\nL_TAX: [[null,null,null,null,null,null,null,null,null,null]]\r\nL_DISCOUNT: [[null,null,null,null,null,null,null,null,null,null]] \n```\r\n\u00a0\r\n\r\nReproduction Steps:\r\n```java\n\r\nimport pyarrow as pa\r\nimport pyarrow.parquet as pq\r\nimport pyarrow.substrait as substrait\r\n\r\nfrom pyarrow import json as pyarrow_json\r\nfrom pyarrow.lib import tobytes\r\n\r\n\r\nsubstrait_query = <string from above plan>\r\n\r\njson_file_path = os.path.join(<path>, 'lineitem.json')\r\narrow_data_path_parquet = os.path.join(str(tmpdir), 'substrait_data.parquet') substrait_query = tobytes(substrait_query.replace(\"FILENAME_PLACEHOLDER\", arrow_data_path_parquet))\r\n\r\n\r\n# Save lineitem.json into parquet file\r\ntable = pyarrow_json.read_json(json_file_path) \u00a0\r\npq.write_table(pa_table, arrow_data_path_parquet)\r\n\r\n# Run the substrait query plan\r\nbuf = pa._substrait._parse_json_plan(substrait_query)\r\nreader = substrait.run_query(buf)\r\nresult = reader.read_all()\r\n\r\nprint(result)\r\n\r\n\r\n```\r\nlineitem.json is attached\r\n\r\n\u00a0",
        "created_at": "2022-07-05T15:54:25.000Z",
        "updated_at": "2022-07-05T20:48:46.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": []
}