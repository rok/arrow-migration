{
    "issue": {
        "title": "[Python] pyarrow causes python to crash errors on parquet.dll",
        "body": "***Note**: This issue was originally created as [ARROW-1247](https://issues.apache.org/jira/browse/ARROW-1247). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nHello,\n      I have a script which fetches data, and stores the data in Pandas dataframe.\n\nI make 3 aggregations of data, MEAN/STDEV/MAX, each of which are converted to an arrow table and saved on the disk as a parquet file.\n\nThis code works just fine for 100-500 records, but errors out for bigger volume. I also know this code works because another developer is using the same code on a mirrored machine ( in terms of hardware ) and it works.\nThe order of the dataset I am trying to save is millions.\n\nThe code errors out @ line \tpq.write_table(arrowTable, filePath).\n\n\n\nHere is the code:\n\n    arrowTable = pa.Table.from_pandas(self.grpByMeanDS2)\n\t\n\tbegintime = datetime.now()\n\tbegintime_str = begintime.strftime(\"%Y%m%d%I%M%S\")\t\t\n\t\n\tfilePath = SaveFileLoc + \"\nRaw\n\" + agg + \"Data\" + begintime_str + \".parq\"\n\n\tprint('Begin Saving File')\n\tpq.write_table(arrowTable, filePath)\n\tprint('Done Saving File')\n\t\n\tprint('Appending FilePath to List')\n\tself.listspDF.append(filePath)\n\tprint('Done Appending FilePath to List')\n\t\n\n\n\nPython crashes and throws a \"python has to close error\".\n\n\nFollowing is the detailed error:\n------------------\nProblem Event Name:                        APPCRASH\n  Application Name:                           python.exe\n  Application Version:                        3.5.2150.1013\n  Application Timestamp:                  577be340\n  Fault Module Name:                        parquet.dll\n  Fault Module Version:                     0.0.0.0\n  Fault Module Timestamp:               59403662\n  Exception Code:                               c0000005\n  Exception Offset:                              000000000005f990\n  OS Version:                                       6.3.9600.2.0.0.400.8\n  Locale ID:                                          1033\n\nRead our privacy statement online:\n  http://go.microsoft.com/fwlink/?linkid=280262\n\nIf the online privacy statement is not available, please read our privacy statement offline:\n  C:\\Windows\\system32\\en-US\\erofflps.txt\n\n--------------------------------------------\n\nI have tried updating Python and pyarrow, with no luck.\n\nFollowing is the version of python:\n\n    import sys\n\n    print (sys.version)\n    3.5.2 |Anaconda custom (64-bit)| (default, Jul  5 2016, 11:41:13) [MSC v.1900 64 bit (AMD64)]\n\nFollowing are results of pip freeze:\n\n\talabaster==0.7.9\n\tanaconda-clean==1.0\n\tanaconda-client==1.5.1\n\tanaconda-navigator==1.3.1\n\targcomplete==1.0.0\n\tastroid==1.4.7\n\tastropy==2.0\n\tBabel==2.3.4\n\tbackports.shutil-get-terminal-size==1.0.0\n\tbeautifulsoup4==4.5.1\n\tbitarray==0.8.1\n\tblaze==0.10.1\n\tbokeh==0.12.2\n\tboto==2.42.0\n\tBottleneck==1.2.1\n\tcffi==1.7.0\n\tchest==0.2.3\n\tclick==6.6\n\tcloudpickle==0.2.1\n\tclyent==1.2.2\n\tcolorama==0.3.7\n\tcomtypes==1.1.2\n\tconda==4.3.22\n\tconda-build==2.0.2\n\tconfigobj==5.0.6\n\tcontextlib2==0.5.3\n\tcryptography==1.5\n\tcycler==0.10.0\n\tCython==0.24.1\n\tcytoolz==0.8.0\n\tdask==0.11.0\n\tdatashape==0.5.2\n\tdecorator==4.0.10\n\tdill==0.2.5\n\tdocutils==0.12\n\tdynd===c328ab7\n\tet-xmlfile==1.0.1\n\tfastcache==1.0.2\n\tfilelock==2.0.6\n\tFlask==0.11.1\n\tFlask-Cors==2.1.2\n\tgevent==1.1.2\n\tgreenlet==0.4.10\n\th5py==2.7.0\n\tHeapDict==1.0.0\n\tidna==2.1\n\timageio==2.2.0\n\timagesize==0.7.1\n\tipykernel==4.5.0\n\tipython==5.1.0\n\tipython-genutils==0.1.0\n\tipywidgets==5.2.2\n\titsdangerous==0.24\n\tjdcal==1.2\n\tjedi==0.9.0\n\tJinja2==2.8\n\tjsonschema==2.5.1\n\tjupyter==1.0.0\n\tjupyter-client==4.4.0\n\tjupyter-console==5.0.0\n\tjupyter-core==4.2.0\n\tlazy-object-proxy==1.2.1\n\tllvmlite==0.19.0\n\tlocket==0.2.0\n\tlxml==3.6.4\n\tMarkupSafe==0.23\n\tmatplotlib==2.0.2\n\tmenuinst==1.4.1\n\tmistune==0.7.3\n\tmpmath==0.19\n\tmultipledispatch==0.4.8\n\tnb-anacondacloud==1.2.0\n\tnb-conda==2.0.0\n\tnb-conda-kernels==2.0.0\n\tnbconvert==4.2.0\n\tnbformat==4.1.0\n\tnbpresent==3.0.2\n\tnetworkx==1.11\n\tnltk==3.2.1\n\tnose==1.3.7\n\tnotebook==4.2.3\n\tnumba==0.34.0\n\tnumexpr==2.6.2\n\tnumpy==1.13.1\n\todo==0.5.0\n\topenpyxl==2.3.2\n\tpandas==0.20.2\n\tpartd==0.3.6\n\tpath.py==0.0.0\n\tpathlib2==2.1.0\n\tpatsy==0.4.1\n\tpep8==1.7.0\n\tpickleshare==0.7.4\n\tPillow==3.3.1\n\tpkginfo==1.3.2\n\tply==3.9\n\tprompt-toolkit==1.0.3\n\tpsutil==4.3.1\n\tpy==1.4.31\n\tpy4j==0.10.4\n\tpyarrow==0.4.1\n\tpyasn1==0.1.9\n\tpycosat==0.6.1\n\tpycparser==2.14\n\tpycrypto==2.6.1\n\tpycurl==7.43.0\n\tpyflakes==1.3.0\n\tPygments==2.1.3\n\tpyidealdata==0.7.0\n\tpylint==1.5.4\n\tpyodbc==4.0.17\n\tpyOpenSSL==16.2.0\n\tpyparsing==2.1.4\n\tpyspark==2.1.0+hadoop2.7\n\tpytest==2.9.2\n\tpython-dateutil==2.5.3\n\tpytz==2016.6.1\n\tPyUber==1.4.4\n\tPyWavelets==0.5.2\n\tpywin32==220\n\tPyYAML==3.12\n\tpyzmq==15.4.0\n\tQtAwesome==0.3.3\n\tqtconsole==4.2.1\n\tQtPy==1.1.2\n\trequests==2.14.2\n\trope-py3k==0.9.4.post1\n\truamel-yaml===-VERSION\n\tscikit-image==0.13.0\n\tscikit-learn==0.18.2\n\tscipy==0.19.1\n\tsimplegeneric==0.8.1\n\tsingledispatch==3.4.0.3\n\tsix==1.10.0\n\tsnowballstemmer==1.2.1\n\tsockjs-tornado==1.0.3\n\tsphinx==1.4.6\n\tspyder==3.0.0\n\tSQLAlchemy==1.0.13\n\tstatsmodels==0.8.0\n\tsympy==1.0\n\ttables==3.2.2\n\ttoolz==0.8.0\n\ttornado==4.4.1\n\ttraitlets==4.3.0\n\tunicodecsv==0.14.1\n\twcwidth==0.1.7\n\tWerkzeug==0.11.11\n\twidgetsnbextension==1.2.6\n\twin-unicode-console==0.5\n\twrapt==1.10.6\n\txlrd==1.0.0\n\tXlsxWriter==0.9.3\n\txlwings==0.10.0\n\txlwt==1.1.2\n\nI was wondering if someone could shed light why pyarrow would not work on a certain machine ?\n\nThanks,\nAdu",
        "created_at": "2017-07-21T15:14:56.000Z",
        "updated_at": "2017-08-07T20:14:14.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2017-08-07T18:38:20.000Z"
    },
    "comments": [
        {
            "created_at": "2017-07-21T20:33:04.740Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16096811) by Wes McKinney (wesm):*\nhi Adu \u2013 how did you install pyarrow, with pip or conda? If conda, could you show the output of `conda list`? \n\nDoes the code work on the other machine on an identical file / dataset? Could you say what is the approximate total size of the dataset where there are problems? We fixed a couple bugs between 0.4.1 and 0.5.0 (which is in release candidate now) which could potentially cause issues"
        },
        {
            "created_at": "2017-07-24T00:51:46.421Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16097839) by Aditi Breed (P Ved):*\nHello Wes,\n                 Thank you for your reply.Greatly appreciate your help here.\n\nAfter I posted this issues, I went back to the server, and uninstalled Python/Anaconda completely.\n\nI installed Anaconda Python 3.6 and installed pyarrow using pip instead of conda.\n\nThe code worked fr smaller data-sets that day ( of the order of thousands). Your reply back that afternoon also helped me believe that the problem was solved.\n\nHowever I wanted to do a holistic test, to ensure that I had really solved the problem by installing the pip version. \n\nSo I ran the code on a huge dataset( not huge by Big Data Standards though), 1633665 records were being saved in this latest run( for each aggregations). \n\nJust a quick order of the flow of code:\n1) get data\n2) remove nans ( I double checked this by saving , re-reading and checking on the dataset).\n3) Aggregate to get Means - Save as parquet with pyarrow\n4) Aggregate to get StdDev - Save as parquet with pyarrow\n\n\nIn the case above, it saved the parquet file for Step 3, but failed again on Step 4.\n\nPython again crashed with error\" Python has stopped working\".\nFollowing is the detailed error:\n\nDescription:\n  Stopped working\n\nProblem signature:\n  Problem Event Name:\tAPPCRASH\n  Application Name:\tpython.exe\n  Application Version:\t3.6.2150.1013\n  Application Timestamp:\t5970e8c6\n  Fault Module Name:\tVCRUNTIME140.dll\n  Fault Module Version:\t14.0.24210.0\n  Fault Module Timestamp:\t575a4cd0\n  Exception Code:\tc0000005\n  Exception Offset:\t000000000000c387\n  OS Version:\t6.3.9600.2.0.0.400.8\n  Locale ID:\t1033\n\nRead our privacy statement online:\n  http://go.microsoft.com/fwlink/?linkid=280262\n\nIf the online privacy statement is not available, please read our privacy statement offline:\n  C:\\Windows\\system32\\en-US\\erofflps.txt\n\n\nIf pyarrow was able to save the first aggregated Arrow table, it does not have a problem with saving the file itself.\n\nDo I the correct versiomn of the VC++ redistributable for VS2015 ?\nCurrently I have x64 version of VC++ redistributable , 14.0.24215..\nThe machine also has the x86 version of the same redistributable ( dont know how and why ) \n\nI decided to do conda list and checks the results, though it shows that it has pre version of arrow-cpp ( i dont know why because I did not install it from conda. I did a pip install pyarrow, so I assumed it will bring in the associated cpp's.).\n\n>conda list\n1. packages in environment at XXX:\n#\n_license                  1.1                      py36_1\nalabaster                 0.7.10                   py36_0\nanaconda                  custom                   py36_0\nanaconda-client           1.6.3                    py36_0\nanaconda-navigator        1.6.3                    py36_0\nanaconda-project          0.6.0                    py36_0\narrow-cpp                 0.5.0.pre       np113py36_vc14_4  [vc14]  conda-forge\nasn1crypto                0.22.0                   py36_0\nastroid                   1.4.9                    py36_0\nastropy                   2.0                 np113py36_0\nbabel                     2.4.0                    py36_0\nbackports                 1.0                      py36_0\nbeautifulsoup4            4.6.0                    py36_0\nbitarray                  0.8.1                    py36_1\nbkcharts                  0.2                      py36_0\nblaze                     0.10.1                   py36_0\nbleach                    1.5.0                    py36_0\nbokeh                     0.12.6                   py36_0\nboto                      2.47.0                   py36_0\nbottleneck                1.2.1               np113py36_0\nbzip2                     1.0.6                    vc14_3  [vc14]\ncffi                      1.10.0                   py36_0\nchardet                   3.0.4                    py36_0\nclick                     6.7                      py36_0\ncloudpickle               0.2.2                    py36_0\nclyent                    1.2.2                    py36_0\ncolorama                  0.3.9                    py36_0\ncomtypes                  1.1.2                    py36_0\nconda                     4.3.22                   py36_0    conda-forge\nconda-env                 2.6.0                         0    conda-forge\nconsole_shortcut          0.1.1                    py36_1\ncontextlib2               0.5.5                    py36_0\ncryptography              1.8.1                    py36_0\ncurl                      7.52.1                   vc14_0  [vc14]\ncycler                    0.10.0                   py36_0\ncython                    0.25.2                   py36_0\ncytoolz                   0.8.2                    py36_0\ndask                      0.15.0                   py36_0\ndatashape                 0.5.4                    py36_0\ndecorator                 4.0.11                   py36_0\ndistributed               1.17.1                   py36_0\ndocutils                  0.13.1                   py36_0\nentrypoints               0.2.3                    py36_0\net_xmlfile                1.0.1                    py36_0\nfastcache                 1.0.2                    py36_1\nflask                     0.12.2                   py36_0\nflask-cors                3.0.2                    py36_0\nfreetype                  2.5.5                    vc14_2  [vc14]\nget_terminal_size         1.0.0                    py36_0\ngevent                    1.2.2                    py36_0\ngreenlet                  0.4.12                   py36_0\nh5py                      2.7.0               np113py36_0\nhdf5                      1.8.15.1                 vc14_4  [vc14]\nheapdict                  1.0.0                    py36_1\nhtml5lib                  0.999                    py36_0\nicu                       57.1                     vc14_0  [vc14]\nidna                      2.5                      py36_0\nimagesize                 0.7.1                    py36_0\nipykernel                 4.6.1                    py36_0\nipython                   6.1.0                    py36_0\nipython_genutils          0.2.0                    py36_0\nipywidgets                6.0.0                    py36_0\nisort                     4.2.15                   py36_0\nitsdangerous              0.24                     py36_0\njdcal                     1.3                      py36_0\njedi                      0.10.2                   py36_2\njinja2                    2.9.6                    py36_0\njpeg                      9b                       vc14_0  [vc14]\njsonschema                2.6.0                    py36_0\njupyter                   1.0.0                    py36_3\njupyter_client            5.1.0                    py36_0\njupyter_console           5.1.0                    py36_0\njupyter_core              4.3.0                    py36_0\nlazy-object-proxy         1.3.1                    py36_0\nlibpng                    1.6.27                   vc14_0  [vc14]\nlibtiff                   4.0.6                    vc14_3  [vc14]\nllvmlite                  0.19.0                   py36_0\nlocket                    0.2.0                    py36_1\nlxml                      3.8.0                    py36_0\nmarkupsafe                0.23                     py36_2\nmatplotlib                2.0.2               np113py36_0\nmenuinst                  1.4.7                    py36_0\nmistune                   0.7.4                    py36_0\nmkl                       2017.0.3                      0\nmkl-service               1.1.2                    py36_3\nmpmath                    0.19                     py36_1\nmsgpack-python            0.4.8                    py36_0\nmultipledispatch          0.4.9                    py36_0\nnavigator-updater         0.1.0                    py36_0\nnbconvert                 5.2.1                    py36_0\nnbformat                  4.3.0                    py36_0\nnetworkx                  1.11                     py36_0\nnltk                      3.2.4                    py36_0\nnose                      1.3.7                    py36_1\nnotebook                  5.0.0                    py36_0\nnumba                     0.34.0              np113py36_5\nnumexpr                   2.6.2               np113py36_0\nnumpy                     1.13.1                   py36_0\nnumpydoc                  0.6.0                    py36_0\nodo                       0.5.0                    py36_1\nolefile                   0.44                     py36_0\nopenpyxl                  2.4.7                    py36_0\nopenssl                   1.0.2l                   vc14_0  [vc14]\npackaging                 16.8                     py36_0\npandas                    0.20.2              np113py36_0\npandocfilters             1.4.1                    py36_0\nparquet-cpp               1.2.0.pre                vc14_2  [vc14]  conda-forge\npartd                     0.3.8                    py36_0\npath.py                   10.3.1                   py36_0\npathlib2                  2.2.1                    py36_0\npatsy                     0.4.1                    py36_0\npep8                      1.7.0                    py36_0\npickleshare               0.7.4                    py36_0\npillow                    4.2.1                    py36_0\npip                       9.0.1                    py36_1\nply                       3.10                     py36_0\nprompt_toolkit            1.0.14                   py36_0\npsutil                    5.2.2                    py36_0\npy                        1.4.34                   py36_0\npy4j                      0.10.4                    <pip>\npyarrow                   0.4.1                     <pip>\npycosat                   0.6.2                    py36_0\npycparser                 2.17                     py36_0\npycrypto                  2.6.1                    py36_6\npycurl                    7.43.0                   py36_2\npyflakes                  1.5.0                    py36_0\npygments                  2.2.0                    py36_0\npylint                    1.6.4                    py36_1\npyodbc                    4.0.17                   py36_0\npyopenssl                 17.0.0                   py36_0\npyparsing                 2.1.4                    py36_0\npyqt                      5.6.0                    py36_2\npytables                  3.2.2               np113py36_4\npytest                    3.1.2                    py36_0\npython                    3.6.2                         0\npython-dateutil           2.6.0                    py36_0\npytz                      2017.2                   py36_0\nPyUber                    1.4.4                     <pip>\npywavelets                0.5.2               np113py36_0\npywin32                   220                      py36_2\npyyaml                    3.12                     py36_0\npyzmq                     16.0.2                   py36_0\nqt                        5.6.2                    vc14_5  [vc14]\nqtawesome                 0.4.4                    py36_0\nqtconsole                 4.3.0                    py36_0\nqtpy                      1.2.1                    py36_0\nrequests                  2.14.2                   py36_0\nrope                      0.9.4                    py36_1\nruamel_yaml               0.11.14                  py36_1\nscikit-image              0.13.0              np113py36_0\nscikit-learn              0.18.2              np113py36_0\nscipy                     0.19.1              np113py36_0\nseaborn                   0.7.1                    py36_0\nsetuptools                27.2.0                   py36_1\nsimplegeneric             0.8.1                    py36_1\nsingledispatch            3.4.0.3                  py36_0\nsip                       4.18                     py36_0\nsix                       1.10.0                   py36_0\nsnowballstemmer           1.2.1                    py36_0\nsortedcollections         0.5.3                    py36_0\nsortedcontainers          1.5.7                    py36_0\nsphinx                    1.6.2                    py36_0\nsphinxcontrib             1.0                      py36_0\nsphinxcontrib-websupport  1.0.1                    py36_0\nspyder                    3.1.4                    py36_0\nsqlalchemy                1.1.11                   py36_0\nstatsmodels               0.8.0               np113py36_0\nsympy                     1.1                      py36_0\ntblib                     1.3.2                    py36_0\ntestpath                  0.3.1                    py36_0\ntk                        8.5.18                   vc14_0  [vc14]\ntoolz                     0.8.2                    py36_0\ntornado                   4.5.1                    py36_0\ntraitlets                 4.3.2                    py36_0\nunicodecsv                0.14.1                   py36_0\nvc                        14                            0    conda-forge\nvs2015_runtime            14.0.25420                    0\nwcwidth                   0.1.7                    py36_0\nwerkzeug                  0.12.2                   py36_0\nwheel                     0.29.0                   py36_0\nwidgetsnbextension        2.0.0                    py36_0\nwin_unicode_console       0.5                      py36_0\nwrapt                     1.10.10                  py36_0\nxlrd                      1.0.0                    py36_0\nxlsxwriter                0.9.6                    py36_0\nxlwings                   0.10.4                   py36_0\nxlwt                      1.2.0                    py36_0\nzict                      0.1.2                    py36_0\nzlib                      1.2.8                    vc14_3  [vc14]\n\nI also did a pip freeze:\n\n\n>pip freeze\nalabaster==0.7.10\nanaconda-client==1.6.3\nanaconda-navigator==1.6.3\nanaconda-project==0.6.0\nasn1crypto==0.22.0\nastroid==1.4.9\nastropy==2.0\nBabel==2.4.0\nbackports.shutil-get-terminal-size==1.0.0\nbeautifulsoup4==4.6.0\nbitarray==0.8.1\nbkcharts==0.2\nblaze==0.10.1\nbleach==1.5.0\nbokeh==0.12.6\nboto==2.47.0\nBottleneck==1.2.1\ncffi==1.10.0\nchardet==3.0.4\nclick==6.7\ncloudpickle==0.2.2\nclyent==1.2.2\ncolorama==0.3.9\ncomtypes==1.1.2\nconda==4.3.22\ncontextlib2==0.5.5\ncryptography==1.8.1\ncycler==0.10.0\nCython==0.25.2\ncytoolz==0.8.2\ndask==0.15.0\ndatashape==0.5.4\ndecorator==4.0.11\ndistributed==1.17.1\ndocutils==0.13.1\nentrypoints==0.2.3\net-xmlfile==1.0.1\nfastcache==1.0.2\nFlask==0.12.2\nFlask-Cors==3.0.2\ngevent==1.2.2\ngreenlet==0.4.12\nh5py==2.7.0\nHeapDict==1.0.0\nhtml5lib==0.999\nidna==2.5\nimagesize==0.7.1\nipykernel==4.6.1\nipython==6.1.0\nipython-genutils==0.2.0\nipywidgets==6.0.0\nisort==4.2.15\nitsdangerous==0.24\njdcal==1.3\njedi==0.10.2\nJinja2==2.9.6\njsonschema==2.6.0\njupyter==1.0.0\njupyter-client==5.1.0\njupyter-console==5.1.0\njupyter-core==4.3.0\nlazy-object-proxy==1.3.1\nllvmlite==0.19.0\nlocket==0.2.0\nlxml==3.8.0\nMarkupSafe==0.23\nmatplotlib==2.0.2\nmenuinst==1.4.7\nmistune==0.7.4\nmpmath==0.19\nmsgpack-python==0.4.8\nmultipledispatch==0.4.9\nnavigator-updater==0.1.0\nnbconvert==5.2.1\nnbformat==4.3.0\nnetworkx==1.11\nnltk==3.2.4\nnose==1.3.7\nnotebook==5.0.0\nnumba==0.34.0+5.g1762237\nnumexpr==2.6.2\nnumpy==1.13.1\nnumpydoc==0.6.0\nodo==0.5.0\nolefile==0.44\nopenpyxl==2.4.7\npackaging==16.8\npandas==0.20.2\npandocfilters==1.4.1\npartd==0.3.8\npath.py==10.3.1\npathlib2==2.2.1\npatsy==0.4.1\npep8==1.7.0\npickleshare==0.7.4\nPillow==4.2.1\nply==3.10\nprompt-toolkit==1.0.14\npsutil==5.2.2\npy==1.4.34\npy4j==0.10.4\npyarrow==0.4.1\npycosat==0.6.2\npycparser==2.17\npycrypto==2.6.1\npycurl==7.43.0\npyflakes==1.5.0\nPygments==2.2.0\npylint==1.6.4\npyodbc==4.0.17\npyOpenSSL==17.0.0\npyparsing==2.1.4\npyspark==2.1.1+hadoop2.7\npytest==3.1.2\npython-dateutil==2.6.0\npytz==2017.2\nPyUber==1.4.4\nPyWavelets==0.5.2\npywin32==220\nPyYAML==3.12\npyzmq==16.0.2\nQtAwesome==0.4.4\nqtconsole==4.3.0\nQtPy==1.2.1\nrequests==2.14.2\nrope-py3k==0.9.4.post1\nscikit-image==0.13.0\nscikit-learn==0.18.2\nscipy==0.19.1\nseaborn==0.7.1\nsimplegeneric==0.8.1\nsingledispatch==3.4.0.3\nsix==1.10.0\nsnowballstemmer==1.2.1\nsortedcollections==0.5.3\nsortedcontainers==1.5.7\nsphinx==1.6.2\nsphinxcontrib-websupport==1.0.1\nspyder==3.1.4\nSQLAlchemy==1.1.11\nstatsmodels==0.8.0\nsympy==1.1\ntables==3.2.2\ntblib==1.3.2\ntestpath==0.3\ntoolz==0.8.2\ntornado==4.5.1\ntraitlets==4.3.2\nunicodecsv==0.14.1\nwcwidth==0.1.7\nWerkzeug==0.12.2\nwidgetsnbextension==2.0.0\nwin-unicode-console==0.5\nwrapt==1.10.10\nxlrd==1.0.0\nXlsxWriter==0.9.6\nxlwings==0.10.4\nxlwt==1.2.0\nzict==0.1.2\n\nLet me know if I am doing something wrong.\n\nThanks,\nAdu"
        },
        {
            "created_at": "2017-07-24T00:55:58.550Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16097841) by Wes McKinney (wesm):*\nIs it possible to link to a pickle file of the DataFrame causing the problem so we can take a look (if the data is not sensitive)? \n\nAs one other thing I'd like to rule out, can you remove the pyarrow installed with pip and instead install with conda to see if that also fails?\n\n`conda install pyarrow=0.4.1 -c conda-forge`\n\nThanks"
        },
        {
            "created_at": "2017-07-25T16:48:47.898Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16100337) by Aditi Breed (P Ved):*\nHello Wes,\n                 Thank you for your response. Apologies for the late response. I was trying out a few things, before I replied to you.\n\nUnfortunately I cannot share the dataset with you, since it is considered secret data in our company.\n\nThe first install was a conda install and not working. The day  i reported this, I uninstalled the conda install, and did a pip install of pyarrow.a quick order of the flow of code:\n1) get data\n2) remove nans ( I double checked this by saving , re-reading and checking on the dataset).\n3) Aggregate to get Means - Save as parquet with pyarrow ( works fine )\n4) Aggregate to get StdDev - Save as parquet with pyarrow ( Errors out ) \n\nError out at the same line which works in Step 3 above.\nprint('Begin Saving File')\npq.write_table(arrowTable, filePath)\nprint('Done Saving File')\n\t\nI also felt like I was unable to view the actual error, so I ran the code in a diff IDE. below is the error I see.\n\nUnhandled Exception: System.ArgumentException: Missing parameter does not have a default value.\nParameter name: parameters\n   at System.Reflection.MethodBase.CheckArguments(Object[] parameters, Binder binder, BindingFlags invokeAttr, CultureInfo culture, Signature sig)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)\n   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)\n\n\n\n\n\n\nI enforce types on the columns in the dataframe before i create the arrow table:\n\nFollowing is the code for that:\n\nself.grpByMeanDS2 = self.grpByMeanDS2.dropna(how='any')\n\ndates = self.grpByMeanDS2.select_dtypes(['datetime64'])\n\t\nfor col in dates.columns:\n\tself.grpByMeanDS2[col] = np.divide(dates[col].astype(np.int64), np.int64(1e9)).astype(np.int64)\n\t\nobjects = self.grpByMeanDS2.select_dtypes([object])\n\t\nfor col in objects.columns:\n\tself.grpByMeanDS2[col] = objects[col].astype(str)\n\narrowTable = pa.Table.from_pandas(self.grpByMeanDS2)\n\t\nbegintime = datetime.now()\nbegintime_str = begintime.strftime(\"%Y%m%d%I%M%S\")\t\t\n\t\nfilePath = SaveFileLoc + \"\nRaw\n\" + agg + \"Data\" + begintime_str + \".parq\"\n\t\nprint('Begin Saving File')\npq.write_table(arrowTable, filePath)\nprint('Done Saving File')\n\t\t\t\t\t\t\t\t\nAm i missing something ? \n\nLet me know.\n\nThanks,\nAdu\n"
        },
        {
            "created_at": "2017-07-25T16:53:43.921Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16100348) by Wes McKinney (wesm):*\nI am not sure how to debug from here. You have one of two options:\n\n- Create an obfuscated data file that does not contain proprietary IP, but exhibits the error\n- Provide reproducible code that generates data in memory that exhibits the error\n\nShort of something reproducible to enable us to locate the source of the problem, we'll have to wait for someone else to have an issue that may be able to provide a reproducible example.\n\npyarrow 0.5.0 has just been published on conda-forge, can you try this again with\n\n`conda install pyarrow=0.5.0 -c conda-forge`\n\nand let me know if it is still a problem?"
        },
        {
            "created_at": "2017-07-25T18:38:18.478Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16100534) by Aditi Breed (P Ved):*\nOk I will try that, and let you know what i find.\n\n"
        },
        {
            "created_at": "2017-08-07T18:35:12.496Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16117004) by Aditi Breed (P Ved):*\nI took the dataset and divided it into chunks, to see which chunk would not save properly,\nIn one of the chunks, a string value had about 5 Mill chars, which is a problem ( bad dataset from what I found).\n\nThis was causing the dataset save to fail.\n\nI dont think this is a pyarrow issue. \n\n\n\n\n\n"
        },
        {
            "created_at": "2017-08-07T18:38:20.890Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-1247?focusedCommentId=16117012) by Wes McKinney (wesm):*\nThanks! If you run into a reproducible failure please reopen the issue so we can investigate"
        }
    ]
}