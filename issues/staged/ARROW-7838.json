{
    "issue": {
        "title": "[C++] Installed plasma-store-server fails finding Boost",
        "body": "***Note**: This issue was originally created as [ARROW-7838](https://issues.apache.org/jira/browse/ARROW-7838). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nIn my build directory I have:\r\n```Java\n\r\n$ ldd build-test/debug/plasma-store-server \r\n\tlinux-vdso.so.1 (0x00007ffc0001f000)\r\n\tlibplasma.so.100 => /home/antoine/arrow/dev/cpp/build-test/debug/libplasma.so.100 (0x00007efbff629000)\r\n\tlibarrow_cuda.so.100 => /home/antoine/arrow/dev/cpp/build-test/debug/libarrow_cuda.so.100 (0x00007efbff58d000)\r\n\tlibarrow.so.100 => /home/antoine/arrow/dev/cpp/build-test/debug/libarrow.so.100 (0x00007efbfcbae000)\r\n\tlibssl.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libssl.so.1.1 (0x00007efbfcb1e000)\r\n\tlibcrypto.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libcrypto.so.1.1 (0x00007efbfc870000)\r\n\tlibaws-cpp-sdk-config.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-config.so (0x00007efbfc6be000)\r\n\tlibaws-cpp-sdk-transfer.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-transfer.so (0x00007efbff557000)\r\n\tlibaws-cpp-sdk-s3.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-s3.so (0x00007efbfc478000)\r\n\tlibaws-cpp-sdk-core.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-core.so (0x00007efbfc37b000)\r\n\tlibaws-c-event-stream.so.0unstable => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-c-event-stream.so.0unstable (0x00007efbff54e000)\r\n\tlibaws-c-common.so.0unstable => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-c-common.so.0unstable (0x00007efbff52d000)\r\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007efbfbfa2000)\r\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007efbfbd83000)\r\n\tlibaws-checksums.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-checksums.so (0x00007efbff51d000)\r\n\tlibrt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007efbfbb7b000)\r\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007efbfb977000)\r\n\tlibcuda.so.1 => /usr/lib/x86_64-linux-gnu/libcuda.so.1 (0x00007efbfadd7000)\r\n\tlibstdc++.so.6 => /home/antoine/miniconda3/envs/pyarrow/lib/libstdc++.so.6 (0x00007efbfac63000)\r\n\tlibgcc_s.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libgcc_s.so.1 (0x00007efbff507000)\r\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007efbfa872000)\r\n\t/lib64/ld-linux-x86-64.so.2 (0x00007efbff4d7000)\r\n\tlibbz2.so.1.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libbz2.so.1.0 (0x00007efbfa85e000)\r\n\tliblz4.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/liblz4.so.1 (0x00007efbfa829000)\r\n\tlibsnappy.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libsnappy.so.1 (0x00007efbfa81e000)\r\n\tlibz.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libz.so.1 (0x00007efbfa804000)\r\n\tlibzstd.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libzstd.so.1 (0x00007efbfa748000)\r\n\tlibboost_filesystem.so.1.68.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libboost_filesystem.so.1.68.0 (0x00007efbfa72a000)\r\n\tlibboost_system.so.1.68.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libboost_system.so.1.68.0 (0x00007efbff4fe000)\r\n\tlibcurl.so.4 => /home/antoine/miniconda3/envs/pyarrow/lib/./libcurl.so.4 (0x00007efbfa6a4000)\r\n\tlibnvidia-fatbinaryloader.so.390.116 => /usr/lib/x86_64-linux-gnu/libnvidia-fatbinaryloader.so.390.116 (0x00007efbfa456000)\r\n\tlibssh2.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/././libssh2.so.1 (0x00007efbfa423000)\r\n\tlibgssapi_krb5.so.2 => /home/antoine/miniconda3/envs/pyarrow/lib/././libgssapi_krb5.so.2 (0x00007efbfa3d4000)\r\n\tlibkrb5.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libkrb5.so.3 (0x00007efbfa2fd000)\r\n\tlibk5crypto.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libk5crypto.so.3 (0x00007efbfa2de000)\r\n\tlibcom_err.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libcom_err.so.3 (0x00007efbfa2d6000)\r\n\tlibkrb5support.so.0 => /home/antoine/miniconda3/envs/pyarrow/lib/./././libkrb5support.so.0 (0x00007efbfa2c8000)\r\n\tlibresolv.so.2 => /lib/x86_64-linux-gnu/libresolv.so.2 (0x00007efbfa0ad000)\r\n```\r\n\r\nHowever, once installed it seems the Boost resolution fails:\r\n```Java\n\r\n$ ldd /home/antoine/miniconda3/envs/pyarrow/bin/plasma-store-server\r\n\tlinux-vdso.so.1 (0x00007ffc0001f000)\r\n\tlibplasma.so.100 => /home/antoine/miniconda3/envs/pyarrow/lib/libplasma.so.100 (0x00007efbff629000)\r\n\tlibarrow_cuda.so.100 => /home/antoine/miniconda3/envs/pyarrow/lib/libarrow_cuda.so.100 (0x00007efbff58d000)\r\n\tlibarrow.so.100 => /home/antoine/miniconda3/envs/pyarrow/lib/libarrow.so.100 (0x00007efbfcbae000)\r\n\tlibssl.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libssl.so.1.1 (0x00007efbfcb1e000)\r\n\tlibcrypto.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libcrypto.so.1.1 (0x00007efbfc870000)\r\n\tlibaws-cpp-sdk-config.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-config.so (0x00007efbfc6be000)\r\n\tlibaws-cpp-sdk-transfer.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-transfer.so (0x00007efbff557000)\r\n\tlibaws-cpp-sdk-s3.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-s3.so (0x00007efbfc478000)\r\n\tlibaws-cpp-sdk-core.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-cpp-sdk-core.so (0x00007efbfc37b000)\r\n\tlibaws-c-event-stream.so.0unstable => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-c-event-stream.so.0unstable (0x00007efbff54e000)\r\n\tlibaws-c-common.so.0unstable => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-c-common.so.0unstable (0x00007efbff52d000)\r\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007efbfbfa2000)\r\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007efbfbd83000)\r\n\tlibaws-checksums.so => /home/antoine/miniconda3/envs/pyarrow/lib/libaws-checksums.so (0x00007efbff51d000)\r\n\tlibrt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007efbfbb7b000)\r\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007efbfb977000)\r\n\tlibcuda.so.1 => /usr/lib/x86_64-linux-gnu/libcuda.so.1 (0x00007efbfadd7000)\r\n\tlibstdc++.so.6 => /home/antoine/miniconda3/envs/pyarrow/lib/libstdc++.so.6 (0x00007efbfac63000)\r\n\tlibgcc_s.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libgcc_s.so.1 (0x00007efbff507000)\r\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007efbfa872000)\r\n\t/lib64/ld-linux-x86-64.so.2 (0x00007efbff4d7000)\r\n\tlibbz2.so.1.0 => /lib/x86_64-linux-gnu/libbz2.so.1.0 (0x00007efbfa662000)\r\n\tliblz4.so.1 => /usr/lib/x86_64-linux-gnu/liblz4.so.1 (0x00007efbfa446000)\r\n\tlibsnappy.so.1 => /usr/lib/x86_64-linux-gnu/libsnappy.so.1 (0x00007efbfa23e000)\r\n\tlibz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007efbfa021000)\r\n\tlibzstd.so.1 => /usr/lib/x86_64-linux-gnu/libzstd.so.1 (0x00007efbf9da6000)\r\n\tlibboost_filesystem.so.1.68.0 => not found\r\n\tlibboost_system.so.1.68.0 => not found\r\n\tlibcurl.so.4 => /home/antoine/miniconda3/envs/pyarrow/lib/./libcurl.so.4 (0x00007efbf9d20000)\r\n\tlibnvidia-fatbinaryloader.so.390.116 => /usr/lib/x86_64-linux-gnu/libnvidia-fatbinaryloader.so.390.116 (0x00007efbf9ad4000)\r\n\tlibssh2.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/././libssh2.so.1 (0x00007efbf9aa1000)\r\n\tlibgssapi_krb5.so.2 => /home/antoine/miniconda3/envs/pyarrow/lib/././libgssapi_krb5.so.2 (0x00007efbf9a52000)\r\n\tlibkrb5.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libkrb5.so.3 (0x00007efbf997b000)\r\n\tlibk5crypto.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libk5crypto.so.3 (0x00007efbf995c000)\r\n\tlibcom_err.so.3 => /home/antoine/miniconda3/envs/pyarrow/lib/././libcom_err.so.3 (0x00007efbf9956000)\r\n\tlibkrb5support.so.0 => /home/antoine/miniconda3/envs/pyarrow/lib/./././libkrb5support.so.0 (0x00007efbf9948000)\r\n\tlibresolv.so.2 => /lib/x86_64-linux-gnu/libresolv.so.2 (0x00007efbf972d000)\r\n```\r\n\r\nOther libraries in the same directory are found, so I don't know what's happening here.\r\n",
        "created_at": "2020-02-12T10:27:16.000Z",
        "updated_at": "2020-03-09T17:23:55.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: C++ - Plasma",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-02-18T01:51:02.000Z"
    },
    "comments": [
        {
            "created_at": "2020-02-12T10:27:37.546Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17035229) by Antoine Pitrou (apitrou):*\ncc `[~kou]` would you have a hint here?"
        },
        {
            "created_at": "2020-02-12T10:29:48.669Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17035233) by Antoine Pitrou (apitrou):*\nIf I enable static linking (`ARROW_BUILD_STATIC`), then apparently it works fine:\r\n```Java\n\r\n$ ldd /home/antoine/miniconda3/envs/pyarrow/bin/plasma-store-server\r\n\tlinux-vdso.so.1 (0x00007ffc0001f000)\r\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007efbff2d3000)\r\n\tlibrt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007efbff0cb000)\r\n\tlibcuda.so.1 => /usr/lib/x86_64-linux-gnu/libcuda.so.1 (0x00007efbfe52b000)\r\n\tlibssl.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libssl.so.1.1 (0x00007efbff631000)\r\n\tlibcrypto.so.1.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libcrypto.so.1.1 (0x00007efbfe27d000)\r\n\tlibbz2.so.1.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libbz2.so.1.0 (0x00007efbff61d000)\r\n\tliblz4.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/liblz4.so.1 (0x00007efbff5e6000)\r\n\tlibsnappy.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libsnappy.so.1 (0x00007efbff5db000)\r\n\tlibz.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libz.so.1 (0x00007efbff5c1000)\r\n\tlibzstd.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libzstd.so.1 (0x00007efbff505000)\r\n\tlibboost_filesystem.so.1.68.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libboost_filesystem.so.1.68.0 (0x00007efbfe25f000)\r\n\tlibboost_system.so.1.68.0 => /home/antoine/miniconda3/envs/pyarrow/lib/libboost_system.so.1.68.0 (0x00007efbff4fe000)\r\n\tlibstdc++.so.6 => /home/antoine/miniconda3/envs/pyarrow/lib/libstdc++.so.6 (0x00007efbfe0e9000)\r\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007efbfdd4b000)\r\n\tlibgcc_s.so.1 => /home/antoine/miniconda3/envs/pyarrow/lib/libgcc_s.so.1 (0x00007efbfdd37000)\r\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007efbfdb18000)\r\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007efbfd727000)\r\n\t/lib64/ld-linux-x86-64.so.2 (0x00007efbff4d7000)\r\n\tlibnvidia-fatbinaryloader.so.390.116 => /usr/lib/x86_64-linux-gnu/libnvidia-fatbinaryloader.so.390.116 (0x00007efbfd4db000)\r\n```\r\n\r\nBut static linking is wasteful, it would be good if we could avoid it."
        },
        {
            "created_at": "2020-02-15T08:13:20.510Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17037462) by Kouhei Sutou (kou):*\nWhat CMake options do you use?\r\nI couldn't build `plasma-store-server` that links to `libboost*` with my CMake options. "
        },
        {
            "created_at": "2020-02-17T10:46:59.887Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17038233) by Antoine Pitrou (apitrou):*\nAh, apparently you need `ARROW_S3` enabled to have Boost linked in. I'm not sure why..."
        },
        {
            "created_at": "2020-02-17T10:47:57.755Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17038235) by Antoine Pitrou (apitrou):*\nHmm, so the S3 and Flight **tests** need Boost. But Boost shouldn't be linked with `libarrow.so`."
        },
        {
            "created_at": "2020-02-18T01:51:02.090Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17038726) by Kouhei Sutou (kou):*\nIssue resolved by pull request 6438\n<https://github.com/apache/arrow/pull/6438>"
        },
        {
            "created_at": "2020-02-18T09:02:35.142Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17038907) by Wes McKinney (wesm):*\nI tagged this with 0.16.1 since it probably all Boost-related patches would need to be included in a patch release"
        },
        {
            "created_at": "2020-02-18T09:37:39.106Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7838?focusedCommentId=17038938) by Antoine Pitrou (apitrou):*\nFrom the users' side, they're probably more improvements than bug fixes.\r\n\r\nYou need to build tests to trigger this one. The other one is simply an optimization where we don't bundle unneeded DLLs."
        }
    ]
}