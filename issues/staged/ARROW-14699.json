{
    "issue": {
        "title": "[R] [C++] lz4 sanitizer error",
        "body": "***Note**: This issue was originally created as [ARROW-14699](https://issues.apache.org/jira/browse/ARROW-14699). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nNow that we enable lz4 by default, we are exposed to sanitizer errors. There is one on fedora-clang (bumped into on the test-fedora-r-clang-sanitizer nightly), during tests:\r\n\r\n```Java\n\r\nlz4frame.c:907:58: runtime error: applying non-zero offset 5242880 to null pointer\r\n    #0 0x7f8b7f287807 in LZ4F_compressUpdate (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9d01807)\r\n    #1 0x7f8b7f282c1b in LZ4F_compressFrame_usingCDict (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9cfcc1b)\r\n    #2 0x7f8b7f28939b in LZ4F_compressFrame (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9d0339b)\r\n    #3 0x7f8b7bd25ecd in arrow::util::(anonymous namespace)::Lz4FrameCodec::Compress(long, unsigned char const*, long, unsigned char*) (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x679fecd)\r\n    #4 0x7f8b7ebcadcc in arrow::ipc::(anonymous namespace)::RecordBatchSerializer::CompressBodyBuffers()::'lambda'(unsigned long)::operator()(unsigned long) const (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9644dcc)\r\n    #5 0x7f8b7ebcbfa2 in decltype(std::__1::forward<arrow::detail::ContinueFuture&>(fp)(std::__1::forward<arrow::Future<arrow::internal::Empty>&>(fp0), std::__1::forward<arrow::ipc::(anonymous namespace)::RecordBatchSerializer::CompressBodyBuffers()::'lambda'(unsigned long)&>(fp0), std::__1::forward<int&>(fp0))) std::__1::__invoke<arrow::detail::ContinueFuture&, arrow::Future<arrow::internal::Empty>&, arrow::ipc::(anonymous namespace)::RecordBatchSerializer::CompressBodyBuffers()::'lambda'(unsigned long)&, int&>(arrow::detail::ContinueFuture&, arrow::Future<arrow::internal::Empty>&, arrow::ipc::(anonymous namespace)::RecordBatchSerializer::CompressBodyBuffers()::'lambda'(unsigned long)&, int&) (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9645fa2)\r\n    #6 0x7f8b7ebcbdb5 in arrow::internal::FnOnce<void ()>::FnImpl<std::__1::__bind<arrow::detail::ContinueFuture, arrow::Future<arrow::internal::Empty>&, arrow::ipc::(anonymous namespace)::RecordBatchSerializer::CompressBodyBuffers()::'lambda'(unsigned long)&, int&> >::invoke() (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x9645db5)\r\n    #7 0x7f8b7bc2cd37 in arrow::internal::FnOnce<void ()>::operator()() && (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x66a6d37)\r\n    #8 0x7f8b7bc2b665 in arrow::internal::WorkerLoop(std::__1::shared_ptr<arrow::internal::ThreadPool::State>, std::__1::__list_iterator<std::__1::thread, void*>) (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x66a5665)\r\n    #9 0x7f8b7bc2b06b in decltype(std::__1::forward<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3>(fp)()) std::__1::__invoke<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3>(arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3&&) (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x66a506b)\r\n    #10 0x7f8b7bc2a92c in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3> >(void*) (/opt/R-devel/lib64/R/library/arrow/libs/arrow.so+0x66a492c)\r\n    #11 0x7f8b8c9b83f8 in start_thread (/lib64/libpthread.so.0+0x93f8)\r\n    #12 0x7f8b8c7fb4c2 in clone (/lib64/libc.so.6+0x1014c2)\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior lz4frame.c:907:58 in \r\n```\r\n\r\nhttps://dev.azure.com/ursacomputing/crossbow/_build/results?buildId=15256&view=logs&j=0da5d1d9-276d-5173-c4c4-9d4d4ed14fdb&t=d9b15392-e4ce-5e4c-0c8c-b69645229181&l=11776\r\n\r\n",
        "created_at": "2021-11-12T16:31:54.000Z",
        "updated_at": "2021-11-22T19:37:30.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2021-11-22T14:07:12.000Z"
    },
    "comments": [
        {
            "created_at": "2021-11-22T14:07:12.306Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-14699?focusedCommentId=17447432) by Antoine Pitrou (apitrou):*\nIssue resolved by pull request 11713\n<https://github.com/apache/arrow/pull/11713>"
        }
    ]
}