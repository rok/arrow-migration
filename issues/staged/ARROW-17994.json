{
    "issue": {
        "title": "[C++] Add overflow argument is required when it shouldn't be",
        "body": "***Note**: This issue was originally created as [ARROW-17994](https://issues.apache.org/jira/browse/ARROW-17994). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nIf I pass a substrait plan that contains an add function, but don't provide the nullablity argument, I get the following error:\r\n\r\n```none\n\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"pyarrow/_substrait.pyx\", line 140, in pyarrow._substrait.run_query\r\n  File \"pyarrow/error.pxi\", line 144, in pyarrow.lib.pyarrow_internal_check_status\r\n  File \"pyarrow/error.pxi\", line 100, in pyarrow.lib.check_status\r\npyarrow.lib.ArrowInvalid: Expected Substrait call to have an enum argument at index 0 but the argument was not an enum.\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/extension_set.cc:684  call.GetEnumArg(arg_index)\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/extension_set.cc:702  ParseEnumArg(call, 0, kOverflowParser)\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/relation_internal.cc:332  FromProto(expr, ext_set, conversion_options)\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/serde.cc:156  FromProto(plan_rel.has_root() ? plan_rel.root().input() : plan_rel.rel(), ext_set, conversion_options)\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/util.cc:106  engine::DeserializePlans(substrait_buffer, consumer_factory, registry, nullptr, conversion_options_)\r\n/Users/willjones/Documents/arrows/arrow/cpp/src/arrow/engine/substrait/util.cc:130  executor.Init(substrait_buffer, registry)\r\n```\r\n\r\nYet in the spec, this argument is supposed to be optional: https://github.com/substrait-io/substrait/blob/f3f6bdc947e689e800279666ff33f118e42d2146/extensions/functions_arithmetic.yaml#L11\r\n\r\nIf I modify the plan to include the argument, it works as expected.",
        "created_at": "2022-10-11T22:57:30.000Z",
        "updated_at": "2022-10-13T20:15:14.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2022-10-11T22:58:52.340Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17994?focusedCommentId=17616096) by Will Jones (willjones127):*\nExample plan that is broken:\r\n\r\n```json\n\r\n{\r\n  \"extensionUris\": [\r\n    {\r\n      \"extensionUriAnchor\": 1\r\n    }\r\n  ],\r\n  \"extensions\": [\r\n    {\r\n      \"extensionFunction\": {\r\n        \"extensionUriReference\": 1,\r\n        \"functionAnchor\": 1,\r\n        \"name\": \"equal\"\r\n      }\r\n    },\r\n    {\r\n      \"extensionFunction\": {\r\n        \"extensionUriReference\": 1,\r\n        \"functionAnchor\": 2,\r\n        \"name\": \"add\"\r\n      }\r\n    }\r\n  ],\r\n  \"relations\": [\r\n    {\r\n      \"root\": {\r\n        \"input\": {\r\n          \"project\": {\r\n            \"input\": {\r\n              \"read\": {\r\n                \"baseSchema\": {\r\n                  \"names\": [\r\n                    \"a\",\r\n                    \"b\",\r\n                    \"c\"\r\n                  ],\r\n                  \"struct\": {\r\n                    \"types\": [\r\n                      {\r\n                        \"fp64\": {\r\n                          \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"i64\": {\r\n                          \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"fp64\": {\r\n                          \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                  }\r\n                },\r\n                \"namedTable\": {\r\n                  \"names\": [\r\n                    \"table0\"\r\n                  ]\r\n                }\r\n              }\r\n            },\r\n            \"expressions\": [\r\n              {\r\n                \"scalarFunction\": {\r\n                  \"functionReference\": 2,\r\n                  \"outputType\": {\r\n                    \"fp64\": {\r\n                      \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                    }\r\n                  },\r\n                  \"arguments\": [\r\n                    {\r\n                      \"value\": {\r\n                        \"selection\": {\r\n                          \"directReference\": {\r\n                            \"structField\": {}\r\n                          },\r\n                          \"rootReference\": {}\r\n                        }\r\n                      }\r\n                    },\r\n                    {\r\n                      \"value\": {\r\n                        \"selection\": {\r\n                          \"directReference\": {\r\n                            \"structField\": {\r\n                              \"field\": 2\r\n                            }\r\n                          },\r\n                          \"rootReference\": {}\r\n                        }\r\n                      }\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"names\": [\r\n          \"a\",\r\n          \"b\",\r\n          \"c\",\r\n          \"v\"\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nExample plan that works:\r\n\r\n```json\n\r\n{\r\n    \"extensionUris\": [\r\n      {\r\n        \"extensionUriAnchor\": 1\r\n      }\r\n    ],\r\n    \"extensions\": [\r\n      {\r\n        \"extensionFunction\": {\r\n          \"extensionUriReference\": 1,\r\n          \"functionAnchor\": 1,\r\n          \"name\": \"equal\"\r\n        }\r\n      },\r\n      {\r\n        \"extensionFunction\": {\r\n          \"extensionUriReference\": 1,\r\n          \"functionAnchor\": 2,\r\n          \"name\": \"add\"\r\n        }\r\n      }\r\n    ],\r\n    \"relations\": [\r\n      {\r\n        \"root\": {\r\n          \"input\": {\r\n            \"project\": {\r\n              \"input\": {\r\n                \"read\": {\r\n                  \"baseSchema\": {\r\n                    \"names\": [\r\n                      \"a\",\r\n                      \"b\",\r\n                      \"c\"\r\n                    ],\r\n                    \"struct\": {\r\n                      \"types\": [\r\n                        {\r\n                          \"fp64\": {\r\n                            \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                          }\r\n                        },\r\n                        {\r\n                          \"i64\": {\r\n                            \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                          }\r\n                        },\r\n                        {\r\n                          \"fp64\": {\r\n                            \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                          }\r\n                        }\r\n                      ],\r\n                      \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                    }\r\n                  },\r\n                  \"namedTable\": {\r\n                    \"names\": [\r\n                      \"table0\"\r\n                    ]\r\n                  }\r\n                }\r\n              },\r\n              \"expressions\": [\r\n                {\r\n                  \"scalarFunction\": {\r\n                    \"functionReference\": 2,\r\n                    \"outputType\": {\r\n                      \"fp64\": {\r\n                        \"nullability\": \"NULLABILITY_NULLABLE\"\r\n                      }\r\n                    },\r\n                    \"arguments\": [\r\n                      {\r\n                        \"enum\": {\r\n                          \"specified\": \"ERROR\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"value\": {\r\n                          \"selection\": {\r\n                            \"directReference\": {\r\n                              \"structField\": {}\r\n                            },\r\n                            \"rootReference\": {}\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"value\": {\r\n                          \"selection\": {\r\n                            \"directReference\": {\r\n                              \"structField\": {\r\n                                \"field\": 2\r\n                              }\r\n                            },\r\n                            \"rootReference\": {}\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"names\": [\r\n            \"a\",\r\n            \"b\",\r\n            \"c\",\r\n            \"v\"\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n```"
        },
        {
            "created_at": "2022-10-11T22:59:24.884Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17994?focusedCommentId=17616097) by Weston Pace (westonpace):*\nDuplicate of ARROW-17966?"
        }
    ]
}