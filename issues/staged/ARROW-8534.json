{
    "issue": {
        "title": "[C++][CSV] Issue building CSV component under GCC 6.1.0",
        "body": "***Note**: This issue was originally created as [ARROW-8534](https://issues.apache.org/jira/browse/ARROW-8534). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nHi,\r\n\r\nIn the current version (0.17.0), it seems that CSV reader.cc fails to compile when using GCC 6.1.0. This builds when using older or newer GCC versions (we tested with 4.8.5, 8.2.0 and 9.3.0).\r\n\r\n\u00a0\r\n\r\n`[root@1d4fcfc2580e arrow_src]# /ourgcc/gcc-6.1.0/bin/g++ -c cpp/src/arrow/csv/reader.cc -I cpp/src`\r\n`cpp/src/arrow/csv/reader.cc: In constructor 'arrow::csv::SerialBlockReader::SerialBlockReader(std::unique_ptr<arrow::Chunker>, arrow::Iterator<std::shared_ptr<arrow::Buffer> >, std::shared_ptr<arrow::Buffer>)':`\r\n`cpp/src/arrow/csv/reader.cc:178:22: error: use of deleted function 'std::unique_ptr<_Tp, _Dp>::unique_ptr(const std::unique_ptr<_Tp, _Dp>&) [with _Tp = arrow::Chunker; _Dp = std::default_delete<arrow::Chunker>]'`\r\n` using BlockReader::BlockReader;`\r\n` ^~~~~~~~~~~`\r\n`In file included from /ourgcc/gcc-6.1.0/include/c++/6.1.0/memory:81:0,`\r\n` from cpp/src/arrow/csv/reader.h:20,`\r\n` from cpp/src/arrow/csv/reader.cc:18:`\r\n`/ourgcc/gcc-6.1.0/include/c++/6.1.0/bits/unique_ptr.h:356:7: note: declared here`\r\n` unique_ptr(const unique_ptr&) = delete;`\r\n` ^~~~~~~~~~`\r\n`cpp/src/arrow/csv/reader.cc:178:22: error: use of deleted function 'arrow::Iterator<std::shared_ptr<arrow::Buffer> >::Iterator(const arrow::Iterator<std::shared_ptr<arrow::Buffer> >&)'`\r\n` using BlockReader::BlockReader;`\r\n` ^~~~~~~~~~~`\r\n`In file included from cpp/src/arrow/csv/reader.cc:43:0:`\r\n`cpp/src/arrow/util/iterator.h:63:7: note: 'arrow::Iterator<std::shared_ptr<arrow::Buffer> >::Iterator(const arrow::Iterator<std::shared_ptr<arrow::Buffer> >&)' is implicitly deleted because the default definition would be ill-formed:`\r\n` class Iterator : public util::EqualityComparable<Iterator<T>> {`\r\n` ^~~~~~~~`\r\n`cpp/src/arrow/util/iterator.h:63:7: error: use of deleted function 'std::unique_ptr<_Tp, _Dp>::unique_ptr(const std::unique_ptr<_Tp, _Dp>&) [with _Tp = void; _Dp = void (*)(void*)]'`\r\n`In file included from /ourgcc/gcc-6.1.0/include/c++/6.1.0/memory:81:0,`\r\n` from cpp/src/arrow/csv/reader.h:20,`\r\n` from cpp/src/arrow/csv/reader.cc:18:`\r\n`/ourgcc/gcc-6.1.0/include/c++/6.1.0/bits/unique_ptr.h:356:7: note: declared here`\r\n` unique_ptr(const unique_ptr&) = delete;`\r\n` ^~~~~~~~~~`\r\n`cpp/src/arrow/csv/reader.cc: In member function 'virtual arrow::Result<std::shared_ptr<arrow::Table> > arrow::csv::SerialTableReader::Read()':`\r\n`cpp/src/arrow/csv/reader.cc:750:88: note: synthesized method 'arrow::csv::SerialBlockReader::SerialBlockReader(std::unique_ptr<arrow::Chunker>, arrow::Iterator<std::shared_ptr<arrow::Buffer> >, std::shared_ptr<arrow::Buffer>)' first required here`\r\n` std::move(buffer_iterator_), std::move(first_buffer));`\r\n` ^`\r\n`cpp/src/arrow/csv/reader.cc: In constructor 'arrow::csv::ThreadedBlockReader::ThreadedBlockReader(std::unique_ptr<arrow::Chunker>, arrow::Iterator<std::shared_ptr<arrow::Buffer> >, std::shared_ptr<arrow::Buffer>)':`\r\n`cpp/src/arrow/csv/reader.cc:221:22: error: use of deleted function 'std::unique_ptr<_Tp, _Dp>::unique_ptr(const std::unique_ptr<_Tp, _Dp>&) [with _Tp = arrow::Chunker; _Dp = std::default_delete<arrow::Chunker>]'`\r\n` using BlockReader::BlockReader;`\r\n` ^~~~~~~~~~~`\r\n`In file included from /ourgcc/gcc-6.1.0/include/c++/6.1.0/memory:81:0,`\r\n` from cpp/src/arrow/csv/reader.h:20,`\r\n` from cpp/src/arrow/csv/reader.cc:18:`\r\n`/ourgcc/gcc-6.1.0/include/c++/6.1.0/bits/unique_ptr.h:356:7: note: declared here`\r\n` unique_ptr(const unique_ptr&) = delete;`\r\n` ^~~~~~~~~~`\r\n`cpp/src/arrow/csv/reader.cc:221:22: error: use of deleted function 'arrow::Iterator<std::shared_ptr<arrow::Buffer> >::Iterator(const arrow::Iterator<std::shared_ptr<arrow::Buffer> >&)'`\r\n` using BlockReader::BlockReader;`\r\n` ^~~~~~~~~~~`\r\n`cpp/src/arrow/csv/reader.cc: In member function 'virtual arrow::Result<std::shared_ptr<arrow::Table> > arrow::csv::ThreadedTableReader::Read()':`\r\n`cpp/src/arrow/csv/reader.cc:815:61: note: synthesized method 'arrow::csv::ThreadedBlockReader::ThreadedBlockReader(std::unique_ptr<arrow::Chunker>, arrow::Iterator<std::shared_ptr<arrow::Buffer> >, std::shared_ptr<arrow::Buffer>)' first required here`\r\n` std::move(first_buffer));`\r\n` ^`\r\n\r\n\u00a0\r\n\r\nMy colleague found a workaround that avoids the build error, however, we are not clear if this is the \"best\" fix.\r\n\r\n`--- a/cpp/src/arrow/csv/reader.cc`\r\n`+++ b/cpp/src/arrow/csv/reader.cc`\r\n`@@ -175,7 +175,12 @@ class BlockReader {`\r\n` // using CSVBlock::consume_bytes.`\r\n` class SerialBlockReader : public BlockReader {`\r\n` public:`\r\n`- using BlockReader::BlockReader;`\r\n`+ SerialBlockReader(std::unique_ptr<Chunker> chunker,`\r\n`+ Iterator<std::shared_ptr<Buffer>> buffer_iterator,`\r\n`+ std::shared_ptr<Buffer> first_buffer)`\r\n`+ : BlockReader(std::move(chunker),`\r\n`+ std::move(buffer_iterator),`\r\n`+ std::move(first_buffer)) {`}`Result<arrow::util::optional<CSVBlock>> Next() {`\r\n` if (buffer_ == nullptr) {`\r\n`@@ -218,7 +223,12 @@ class SerialBlockReader : public BlockReader {`\r\n` // An object that reads delimited CSV blocks for threaded use.`\r\n` class ThreadedBlockReader : public BlockReader {`\r\n` public:`\r\n`- using BlockReader::BlockReader;`\r\n`+ ThreadedBlockReader(std::unique_ptr<Chunker> chunker,`\r\n`+ Iterator<std::shared_ptr<Buffer>> buffer_iterator,`\r\n`+ std::shared_ptr<Buffer> first_buffer)`\r\n`+ : BlockReader(std::move(chunker),`\r\n`+ std::move(buffer_iterator),`\r\n`+ std::move(first_buffer)) {`}`Result<arrow::util::optional<CSVBlock>> Next() {`\r\n` if (buffer_ == nullptr) {`",
        "created_at": "2020-04-20T22:39:00.000Z",
        "updated_at": "2020-04-21T08:16:42.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2020-04-21T08:16:42.278Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8534?focusedCommentId=17088410) by Antoine Pitrou (apitrou):*\nCould you please open a PR?"
        }
    ]
}