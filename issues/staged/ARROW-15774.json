{
    "issue": {
        "title": "[C++] [CMake] Missing hiveserver2 ErrorCodes_types",
        "body": "***Note**: This issue was originally created as [ARROW-15774](https://issues.apache.org/jira/browse/ARROW-15774). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWith cmake preset `ninja-release-maximal`, one of the auto-generated files seems to be missing and that in turn is resulting in the following error\r\n\r\n```sh\n\r\n[96/576] Building CXX object src/arrow/dbi/hiveserver2/CMakeFiles/arrow_hiveserver2_thrift.dir/ErrorCodes_types.cpp.o\r\nFAILED: src/arrow/dbi/hiveserver2/CMakeFiles/arrow_hiveserver2_thrift.dir/ErrorCodes_types.cpp.o \r\n/usr/bin/ccache /usr/bin/c++ -DARROW_HAVE_RUNTIME_AVX2 -DARROW_HAVE_RUNTIME_AVX512 -DARROW_HAVE_RUNTIME_BMI2 -DARROW_HAVE_RUNTIME_SSE4_2 -DARROW_HAVE_SSE4_2 -DARROW_HDFS -DARROW_JEMALLOC -DARROW_JEMALLOC_INCLUDE_DIR=\"\" -DARROW_MIMALLOC -DARROW_WITH_BROTLI -DARROW_WITH_BZ2 -DARROW_WITH_LZ4 -DARROW_WITH_RE2 -DARROW_WITH_SNAPPY -DARROW_WITH_TIMING_TESTS -DARROW_WITH_UTF8PROC -DARROW_WITH_ZLIB -DARROW_WITH_ZSTD -DURI_STATIC_BUILD -I/home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/src -I/home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/src -I/home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/src/generated -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/thirdparty/flatbuffers/include -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/jemalloc_ep-prefix/src -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/mimalloc_ep/src/mimalloc_ep/include/mimalloc-1.7 -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/xsimd_ep/src/xsimd_ep-install/include -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/zstd_ep-install/include -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/thirdparty/hadoop/include -isystem /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/orc_ep-install/include -Wno-noexcept-type  -fdiagnostics-color=always -O3 -DNDEBUG  -Wall -fno-semantic-interposition -msse4.2  -O3 -DNDEBUG -fPIC -std=c++11 -Wno-unused-variable -Wno-shadow-field -MD -MT src/arrow/dbi/hiveserver2/CMakeFiles/arrow_hiveserver2_thrift.dir/ErrorCodes_types.cpp.o -MF src/arrow/dbi/hiveserver2/CMakeFiles/arrow_hiveserver2_thrift.dir/ErrorCodes_types.cpp.o.d -o src/arrow/dbi/hiveserver2/CMakeFiles/arrow_hiveserver2_thrift.dir/ErrorCodes_types.cpp.o -c /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/src/arrow/dbi/hiveserver2/ErrorCodes_types.cpp\r\ncc1plus: fatal error: /home/pradeep/gitroot/ArrowWorkspace/arrow/cpp/build/src/arrow/dbi/hiveserver2/ErrorCodes_types.cpp: No such file or directory\r\n```\r\n\r\n\r\nI have attached the cmake log of configuration/generation steps.",
        "created_at": "2022-02-24T09:26:55.000Z",
        "updated_at": "2022-02-24T18:44:55.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2022-02-24T18:44:55.038Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-15774?focusedCommentId=17497626) by Antoine Pitrou (apitrou):*\nI took some time looking at this. It appears that `ARROW_HIVESERVER2` is currently completely broken (it probably has been for a long time).\r\n\r\nObservations:\r\n- we should track the generated `ErrorCodes.thrift` in the repository, instead of having to run the Python script generating it on each build\n- we should put the generated C++ files for thrift definitions inside a new `src/generated/hiveserver2` directory\n- we should update `build-support/update-thrift.sh` to recreate said C++ generated files\n- when I tried to do all the above, it appears that _some_ files are not generated by the Thrift compiler even though they should, and no error of any sort is printed out; trying to ignore those absent files doesn't work, as there are (predictably) missing symbol errors when linking the tests\n  \n"
        }
    ]
}