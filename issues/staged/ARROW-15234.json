{
    "issue": {
        "title": "[Python] Possible crash with custom CSV invalid row handler",
        "body": "***Note**: This issue was originally created as [ARROW-15234](https://issues.apache.org/jira/browse/ARROW-15234). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nThe crash happens on handler finalization and can be reproduced reliable here:\r\n```Java\n\r\n$ taskset -c 1 python -m pytest -r s --tb=native pyarrow/tests/test_csv.py::TestThreadedCSVTableRead::test_invalid_row_handler\r\n=========================================================================== test session starts ===========================================================================\r\nplatform linux -- Python 3.9.7, pytest-6.2.5, py-1.10.0, pluggy-1.0.0\r\nrootdir: /home/antoine/arrow/dev/python, configfile: setup.cfg\r\nplugins: repeat-0.9.1, lazy-fixture-0.6.3, hypothesis-6.23.2\r\ncollected 1 item                                                                                                                                                          \r\n\r\npyarrow/tests/test_csv.py Fatal Python error: Segmentation fault\r\n\r\nThread 0x00007fd0780af740 (most recent call first):\r\n  File \"/home/antoine/arrow/dev/python/pyarrow/tests/test_csv.py\", line 670 in read_csv\r\n  File \"/home/antoine/arrow/dev/python/pyarrow/tests/test_csv.py\", line 675 in read_bytes\r\n  File \"/home/antoine/arrow/dev/python/pyarrow/tests/test_csv.py\", line 652 in test_invalid_row_handler\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/python.py\", line 183 in pytest_pyfunc_call\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_callers.py\", line 39 in _multicall\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_manager.py\", line 80 in _hookexec\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_hooks.py\", line 265 in __call__\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/python.py\", line 1641 in runtest\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 162 in pytest_runtest_call\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_callers.py\", line 39 in _multicall\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_manager.py\", line 80 in _hookexec\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_hooks.py\", line 265 in __call__\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 255 in <lambda>\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 311 in from_call\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 254 in call_runtest_hook\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 215 in call_and_report\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 126 in runtestprotocol\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/runner.py\", line 109 in pytest_runtest_protocol\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_callers.py\", line 39 in _multicall\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_manager.py\", line 80 in _hookexec\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_hooks.py\", line 265 in __call__\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/main.py\", line 348 in pytest_runtestloop\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_callers.py\", line 39 in _multicall\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_manager.py\", line 80 in _hookexec\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_hooks.py\", line 265 in __call__\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/main.py\", line 323 in _main\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/main.py\", line 269 in wrap_session\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/main.py\", line 316 in pytest_cmdline_main\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_callers.py\", line 39 in _multicall\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_manager.py\", line 80 in _hookexec\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pluggy/_hooks.py\", line 265 in __call__\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/config/__init__.py\", line 162 in main\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/_pytest/config/__init__.py\", line 185 in console_main\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/site-packages/pytest/__main__.py\", line 5 in <module>\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/runpy.py\", line 87 in _run_code\r\n  File \"/home/antoine/miniconda3/envs/pyarrow/lib/python3.9/runpy.py\", line 197 in _run_module_as_main\r\nErreur de segmentation (core dumped)\r\n```",
        "created_at": "2022-01-03T15:10:41.000Z",
        "updated_at": "2022-01-03T18:21:18.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-01-03T16:57:27.000Z"
    },
    "comments": [
        {
            "created_at": "2022-01-03T16:57:27.621Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-15234?focusedCommentId=17468098) by David Li (lidavidm):*\nIssue resolved by pull request 12063\n<https://github.com/apache/arrow/pull/12063>"
        }
    ]
}