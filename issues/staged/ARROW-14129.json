{
    "issue": {
        "title": "[C++] An empty dictionary array crashes on `unique` and `value_counts`.",
        "body": "***Note**: This issue was originally created as [ARROW-14129](https://issues.apache.org/jira/browse/ARROW-14129). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\n```python\n\r\nimport pyarrow as pa\r\narr = pa.array(range(3)).dictionary_encode()\r\nassert not arr[:0]\r\narr[:0].unique() # Check failed: (data->dictionary) != (nullptr) \r\n```",
        "created_at": "2021-09-24T21:33:09.000Z",
        "updated_at": "2021-09-28T19:45:43.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2021-09-27T19:16:48.000Z"
    },
    "comments": [
        {
            "created_at": "2021-09-27T13:49:27.683Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-14129?focusedCommentId=17420752) by David Li (lidavidm):*\nI can confirm this occurs on master, part of the traceback:\r\n```\n\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n#1  0x00007ffff6e56921 in __GI_abort () at abort.c:79\r\n#2  0x00007ffff467d7ae in arrow::util::CerrLog::~CerrLog (this=0x555555ddf980)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/util/logging.cc:72\r\n#3  0x00007ffff467d7e9 in arrow::util::CerrLog::~CerrLog (this=0x555555ddf980)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/util/logging.cc:66\r\n#4  0x00007ffff467d400 in arrow::util::ArrowLog::~ArrowLog (this=0x7fffffffac80)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/util/logging.cc:250\r\n#5  0x00007ffff3bed3c1 in arrow::DictionaryArray::DictionaryArray (this=0x555555f088f0, data=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/array/array_dict.cc:83\r\n#6  0x00007ffff3d3b561 in __gnu_cxx::new_allocator<arrow::DictionaryArray>::construct<arrow::DictionaryArray, std::shared_ptr<arrow::ArrayData> const&> (this=0x7fffffffadf0, __p=0x555555f088f0, __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/ext/new_allocator.h:136\r\n#7  0x00007ffff3d3b51d in std::allocator_traits<std::allocator<arrow::DictionaryArray> >::construct<arrow::DictionaryArray, std::shared_ptr<arrow::ArrayData> const&> (__a=..., __p=0x555555f088f0, __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/alloc_traits.h:475\r\n#8  0x00007ffff3d3b4a1 in std::_Sp_counted_ptr_inplace<arrow::DictionaryArray, std::allocator<arrow::DictionaryArray>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<std::shared_ptr<arrow::ArrayData> const&> (this=0x555555f088e0, \r\n    __a=..., __args=...) at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr_base.h:526\r\n#9  0x00007ffff3d3b370 in std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<arrow::DictionaryArray, std::allocator<arrow::DictionaryArray>, std::shared_ptr<arrow::ArrayData> const&> (this=0x7fffffffafc8, __a=..., __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr_base.h:637\r\n#10 0x00007ffff3d3b286 in std::__shared_ptr<arrow::DictionaryArray, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<arrow::DictionaryArray>, std::shared_ptr<arrow::ArrayData> const&> (this=0x7fffffffafc0, __tag=..., __a=..., \r\n    __args=...) at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr_base.h:1294\r\n#11 0x00007ffff3d3b21d in std::shared_ptr<arrow::DictionaryArray>::shared_ptr<std::allocator<arrow::DictionaryArray>, std::shared_ptr<arrow::ArrayData> const&> (this=0x7fffffffafc0, __tag=..., __a=..., __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr.h:344\r\n#12 0x00007ffff3d3b1cf in std::allocate_shared<arrow::DictionaryArray, std::allocator<arrow::DictionaryArray>, std::shared_ptr<arrow::ArrayData> const&> (__a=..., __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr.h:690\r\n#13 0x00007ffff3d3b150 in std::make_shared<arrow::DictionaryArray, std::shared_ptr<arrow::ArrayData> const&> (__args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/shared_ptr.h:706\r\n#14 0x00007ffff3d19e82 in arrow::(anonymous namespace)::ArrayDataWrapper::Visit<arrow::DictionaryType> (\r\n    this=0x7fffffffb250) at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/array/util.cc:66\r\n#15 0x00007ffff3d09eed in arrow::VisitTypeInline<arrow::(anonymous namespace)::ArrayDataWrapper> (type=..., \r\n    visitor=0x7fffffffb250) at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/visitor_inline.h:90\r\n#16 0x00007ffff3d094d8 in arrow::MakeArray (data=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/cpp/src/arrow/array/util.cc:311\r\n#17 0x00007ffff645fcae in __pyx_f_7pyarrow_3lib_wrap_datum (__pyx_v_datum=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/lib.cpp:68653\r\n#18 0x00007fff6a7927cc in __pyx_pf_7pyarrow_8_compute_8Function_6call (__pyx_v_self=0x7ffff67a34f0, \r\n    __pyx_v_args=0x7fff6a9b14c0, __pyx_v_options=0x555555914c80 <_Py_NoneStruct>, \r\n    __pyx_v_memory_pool=0x555555914c80 <_Py_NoneStruct>)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/_compute.cpp:10347\r\n#19 0x00007fff6a792473 in __pyx_pw_7pyarrow_8_compute_8Function_7call (__pyx_v_self=0x7ffff67a34f0, \r\n    __pyx_args=0x7ffff7f072b0, __pyx_kwds=0x7ffff7f03240)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/_compute.cpp:10182\r\n#20 0x00005555556b3f85 in cfunction_call ()\r\n    at /home/conda/feedstock_root/build_artifacts/python-split_1625973859697/work/Objects/methodobject.c:539\r\n#21 0x00007fff6a7eccc5 in __Pyx_PyObject_Call (func=0x7ffff255df40, arg=0x7ffff7f072b0, kw=0x7ffff7f03240)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/_compute.cpp:44364\r\n#22 0x00007fff6a796f0c in __pyx_pf_7pyarrow_8_compute_6call_function (__pyx_self=0x0, __pyx_v_name=0x7ffff683b8b0, \r\n    __pyx_v_args=0x7fff6a9b14c0, __pyx_v_options=0x555555914c80 <_Py_NoneStruct>, \r\n    __pyx_v_memory_pool=0x555555914c80 <_Py_NoneStruct>)\r\n    at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/_compute.cpp:12425\r\n#23 0x00007fff6a796ad0 in __pyx_pw_7pyarrow_8_compute_7call_function (__pyx_self=0x0, __pyx_args=0x7fff6a8b8f00, \r\n    __pyx_kwds=0x0) at /home/lidavidm/Code/upstream/arrow-14129/python/build/temp.linux-x86_64-3.9/_compute.cpp:12359 \n```"
        },
        {
            "created_at": "2021-09-27T19:16:48.716Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-14129?focusedCommentId=17420984) by David Li (lidavidm):*\nIssue resolved by pull request 11249\n<https://github.com/apache/arrow/pull/11249>"
        }
    ]
}