{
    "issue": {
        "title": "[Python] Incorrectly passing schema=None to do_put crashes",
        "body": "***Note**: This issue was originally created as [ARROW-18360](https://issues.apache.org/jira/browse/ARROW-18360). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nIn pyarrow.flight, putting an incorrect value of None for schema in do_put will lead to a core dump.\r\n\r\nIn pyarrow 9.0.0, trying to enter the command leads to a \r\n\r\n```Java\n\r\nIn [3]: writer, reader = client.do_put(flight.FlightDescriptor.for_command(cmd), schema=None)\r\nSegmentation fault (core dumped)\r\n```\r\n\r\nIn pyarrow 7.0.0, the kernel crashes after attempting to access the writer and I got the following:\r\n```Java\n\r\nIn [38]: client = flight.FlightClient('grpc+tls://localhost:9643', disable_server_verification=True)\r\n\r\nIn [39]: writer, reader = client.do_put(flight.FlightDescriptor.for_command(cmd), None)\r\n\r\nIn [40]: writer./home/conda/feedstock_root/build_artifacts/arrow-cpp-ext_1644752264449/work/cpp/src/arrow/flight/client.cc:736:  Check failed: (batch_writer_) != (nullptr) \r\nminiconda3/envs/dev/lib/python3.10/site-packages/pyarrow/../../../libarrow.so.700(+0x66288c)[0x7f0feeae088c]\r\nminiconda3/envs/dev/lib/python3.10/site-packages/pyarrow/../../../libarrow.so.700(_ZN5arrow4util8ArrowLogD1Ev+0x101)[0x7f0feeae0c91]\r\nminiconda3/envs/dev/lib/python3.10/site-packages/pyarrow/../../../libarrow_flight.so.700(+0x7c1e1)[0x7f0fa9e331e1]\r\nminiconda3/envs/dev/lib/python3.10/site-packages/pyarrow/lib.cpython-310-x86_64-linux-gnu.so(+0x17cf1a)[0x7f0fefe7ff1a]\r\nminiconda3/envs/dev/bin/python(_PyObject_GenericGetAttrWithDict+0x4f3)[0x559a7cb8da03]\r\nminiconda3/envs/dev/bin/python(+0x144814)[0x559a7cb8f814]\r\nminiconda3/envs/dev/bin/python(+0x1445bf)[0x559a7cb8f5bf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x30c)[0x559a7cb7ebcc]\r\nminiconda3/envs/dev/bin/python(+0x1516ac)[0x559a7cb9c6ac]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(+0x1ead44)[0x559a7cc35d44]\r\nminiconda3/envs/dev/bin/python(+0x220397)[0x559a7cc6b397]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(+0x1516ac)[0x559a7cb9c6ac]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(+0x151ef3)[0x559a7cb9cef3]\r\nminiconda3/envs/dev/bin/python(+0x1ead44)[0x559a7cc35d44]\r\nminiconda3/envs/dev/bin/python(+0x220397)[0x559a7cc6b397]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1311)[0x559a7cb7fbd1]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x30c)[0x559a7cb7ebcc]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(+0x14fc9d)[0x559a7cb9ac9d]\r\nminiconda3/envs/dev/bin/python(_PyObject_GenericGetAttrWithDict+0x4f3)[0x559a7cb8da03]\r\nminiconda3/envs/dev/bin/python(PyObject_GetAttr+0x44)[0x559a7cb8c494]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x4d8f)[0x559a7cb8364f]\r\nminiconda3/envs/dev/bin/python(+0x14fc9d)[0x559a7cb9ac9d]\r\nminiconda3/envs/dev/bin/python(+0x1416f5)[0x559a7cb8c6f5]\r\nminiconda3/envs/dev/bin/python(PyObject_GetAttr+0x52)[0x559a7cb8c4a2]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x4d8f)[0x559a7cb8364f]\r\nminiconda3/envs/dev/bin/python(+0x14fc9d)[0x559a7cb9ac9d]\r\nminiconda3/envs/dev/bin/python(_PyObject_GenericGetAttrWithDict+0x4f3)[0x559a7cb8da03]\r\nminiconda3/envs/dev/bin/python(PyObject_GetAttr+0x44)[0x559a7cb8c494]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x4d8f)[0x559a7cb8364f]\r\nminiconda3/envs/dev/bin/python(+0x15a178)[0x559a7cba5178]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x9ca)[0x559a7cb7f28a]\r\nminiconda3/envs/dev/bin/python(+0x15a178)[0x559a7cba5178]\r\nminiconda3/envs/dev/bin/python(+0x1602d9)[0x559a7cbab2d9]\r\nminiconda3/envs/dev/bin/python(+0x19d5f5)[0x559a7cbe85f5]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x30c)[0x559a7cb7ebcc]\r\nminiconda3/envs/dev/bin/python(+0x15a178)[0x559a7cba5178]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x9ca)[0x559a7cb7f28a]\r\nminiconda3/envs/dev/bin/python(+0x1f436d)[0x559a7cc3f36d]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1ae1)[0x559a7cb803a1]\r\nminiconda3/envs/dev/bin/python(+0x15a178)[0x559a7cba5178]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x9ca)[0x559a7cb7f28a]\r\nminiconda3/envs/dev/bin/python(+0x1f436d)[0x559a7cc3f36d]\r\nminiconda3/envs/dev/bin/python(+0x209ae9)[0x559a7cc54ae9]\r\nminiconda3/envs/dev/bin/python(+0x104a5c)[0x559a7cb4fa5c]\r\nminiconda3/envs/dev/bin/python(PyIter_Send+0x53a)[0x559a7cc0dc6a]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1ae1)[0x559a7cb803a1]\r\nminiconda3/envs/dev/bin/python(+0x1f436d)[0x559a7cc3f36d]\r\nminiconda3/envs/dev/bin/python(+0x209ae9)[0x559a7cc54ae9]\r\nminiconda3/envs/dev/bin/python(+0x104a5c)[0x559a7cb4fa5c]\r\nminiconda3/envs/dev/bin/python(PyIter_Send+0x53a)[0x559a7cc0dc6a]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1ae1)[0x559a7cb803a1]\r\nminiconda3/envs/dev/bin/python(+0x1f436d)[0x559a7cc3f36d]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1ae1)[0x559a7cb803a1]\r\nminiconda3/envs/dev/bin/python(+0x1f436d)[0x559a7cc3f36d]\r\nminiconda3/envs/dev/lib/python3.10/lib-dynload/_asyncio.cpython-310-x86_64-linux-gnu.so(+0x78d0)[0x7f0ff5eeb8d0]\r\nminiconda3/envs/dev/bin/python(_PyObject_MakeTpCall+0x338)[0x559a7cb88298]\r\nminiconda3/envs/dev/bin/python(+0xfe792)[0x559a7cb49792]\r\nminiconda3/envs/dev/bin/python(+0x13b8e7)[0x559a7cb868e7]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x5aec)[0x559a7cb843ac]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(+0x1516ac)[0x559a7cb9c6ac]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x1311)[0x559a7cb7fbd1]\r\nminiconda3/envs/dev/bin/python(+0x1516ac)[0x559a7cb9c6ac]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x66f)[0x559a7cb7ef2f]\r\nminiconda3/envs/dev/bin/python(+0x1516ac)[0x559a7cb9c6ac]\r\nminiconda3/envs/dev/bin/python(PyObject_Call+0xb8)[0x559a7cb9d348]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x2b05)[0x559a7cb813c5]\r\nminiconda3/envs/dev/bin/python(_PyFunction_Vectorcall+0x6f)[0x559a7cb8f3cf]\r\nminiconda3/envs/dev/bin/python(_PyEval_EvalFrameDefault+0x30c)[0x559a7cb7ebcc]\r\nminiconda3/envs/dev/bin/python(+0x1eab92)[0x559a7cc35b92]\r\nminiconda3/envs/dev/bin/python(PyEval_EvalCode+0x87)[0x559a7cc35ad7]\r\nminiconda3/envs/dev/bin/python(+0x21d709)[0x559a7cc68709]\r\nminiconda3/envs/dev/bin/python(+0x2183f4)[0x559a7cc633f4]\r\nminiconda3/envs/dev/bin/python(+0x982ba)[0x559a7cae32ba]\r\nminiconda3/envs/dev/bin/python(_PyRun_SimpleFileObject+0x1af)[0x559a7cc5d5cf]\r\nminiconda3/envs/dev/bin/python(_PyRun_AnyFileObject+0x43)[0x559a7cc5d3a3]\r\nminiconda3/envs/dev/bin/python(Py_RunMain+0x39f)[0x559a7cc5a56f]\r\nminiconda3/envs/dev/bin/python(Py_BytesMain+0x39)[0x559a7cc28e09]\r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x7f0ff77df083]\r\nminiconda3/envs/dev/bin/python(+0x1ddd11)[0x559a7cc28d11]\r\nAborted (core dumped)\r\n```\r\n\r\nI know it's incorrect to use None, but we have had a report of this crashing notebook kernels.\r\n",
        "created_at": "2022-11-18T00:43:08.000Z",
        "updated_at": "2022-11-18T00:44:33.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": []
}