{
    "issue": {
        "title": "[Ruby] Not loading libarrow-glib",
        "body": "***Note**: This issue was originally created as [ARROW-4953](https://issues.apache.org/jira/browse/ARROW-4953). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\n```\n\r\nC:\\Users\\Dominic E Sisneros\\Documents\\programming\\ruby\\try_arrow>more arrow_load.rb\r\nrequire 'arrow'\r\nn = 1000000\r\narr = n.times.to_a.map\\{|i| \"test\"}\r\n\r\nstrings = Arrow::StringArray.new(arr)\r\narrow_table = Arrow::Table.new(\"str\" => strings)\r\narrow_table.save(\"data.arrow\")\r\nArrow::Table.load(\"data.arrow\")\r\n\r\nC:\\Users\\Dominic E Sisneros\\Documents\\programming\\ruby\\try_arrow>ruby arrow_load.rb\r\n(NULL)-WARNING **: Failed to load shared library 'libarrow-glib-11.dll' referenced by the typelib: 'libarrow-glib-11.dll': The specified procedure could not be found.\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:563:in `load_interface_info'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:70:in `load_info'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:40:in `block in load'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:34:in `block (2 levels) in each'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:33:in `times'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:33:in `block in each'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:32:in `each'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:32:in `each'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:39:in `load'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:25:in `load'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:24:in `load'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:28:in `<module:Arrow>'\r\n from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:24:in `<top (required)>'\r\n from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\r\n from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\r\n from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\r\n from arrow_load.rb:1:in `<main>'\r\nTraceback (most recent call last):\r\n 2: from arrow_load.rb:1:in `<main>'\r\n 1: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\r\ne:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- arrow (LoadError)\r\n 16: from arrow_load.rb:1:in `<main>'\r\n 15: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\r\n 14: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\r\n 13: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\r\n 12: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:24:in `<top (required)>'\r\n 11: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:28:in `<module:Arrow>'\r\n 10: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:24:in `load'\r\n 9: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:25:in `load'\r\n 8: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:42:in `load'\r\n 7: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:32:in `each'\r\n 6: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:32:in `each'\r\n 5: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:33:in `block in each'\r\n 4: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:33:in `times'\r\n 3: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/repository.rb:34:in `block (2 levels) in each'\r\n 2: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:43:in `block in load'\r\n 1: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.5/lib/gobject-introspection/loader.rb:68:in `load_info'\r\ne:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:85:in `load_object_info': uninitialized constant Arrow::ArrayBuilder (NameError)\r\n\r\nC:\\Users\\Dominic E Sisneros\\Documents\\programming\\ruby\\try_arrow>\r\n```",
        "created_at": "2019-03-18T17:15:57.000Z",
        "updated_at": "2022-08-27T14:42:08.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Ruby",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2019-03-27T21:36:16.000Z"
    },
    "comments": [
        {
            "created_at": "2019-03-20T07:27:38.589Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16796872) by Kouhei Sutou (kou):*\nHow did you install Apache Arrow GLib? `pacman -S --no-confirm mingw-w64-x86_64-arrow`?\r\n\r\nThe following code will work but I don't want users to do this. Users just should use `require \"arrow\"`.\r\n\r\n```ruby\n\r\nrequire \"ruby_installer/runtime\"\r\nRubyInstaller::Runtime.add_dll_directory(\"c:/msys64/mingw64/bin\")\r\nrequire 'arrow'\r\n```"
        },
        {
            "created_at": "2019-03-21T14:00:22.284Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16798116) by Dominic Sisneros (dsisnero):*\n```\n\r\npacman -S mingw64/mingw-w64-x86_64-arrow\r\n```\r\n\r\ndoes it matter that I have my msys2 installed in the e:\\ drive?  \r\n\r\n```\n\r\nE:\\msys64\\mingw64\\bin> \r\n```\r\n\r\nI have the above in the PATH env variable\r\n\r\nAlso running fd on the following\r\n\r\n```\n\r\nE:\\msys64\\mingw64>fd arrow \r\n```\r\n\r\nshows the output at https://gist.github.com/dsisnero/88e72a29f8f886a258e7a7c8f28a9fa5\r\n\r\nUsing your code above in the file , I still have the same problem\r\n\r\n```\n\r\nC:\\Users\\Dominic E Sisneros\\Documents\\programming\\ruby\\try_arrow>more arrow_load.rb\r\nrequire 'arrow'\r\n\r\nrequire \"ruby_installer/runtime\"\r\nRubyInstaller::Runtime.add_dll_directory(\"e:/msys64/mingw64/bin\")\r\nrequire 'arrow'\r\nn = 1000000\r\narr = n.times.to_a.map{|i| \"test\"}\r\n\r\nstrings = Arrow::StringArray.new(arr)\r\narrow_table = Arrow::Table.new(\"str\" => strings)\r\narrow_table.save(\"data.arrow\")\r\nArrow::Table.load(\"data.arrow\")\r\n\r\nC:\\Users\\Dominic E Sisneros\\Documents\\programming\\ruby\\try_arrow>ruby arrow_load.rb\r\n(NULL)-WARNING **: Failed to load shared library 'libarrow-glib-11.dll' referenced by the typelib: 'libarrow-glib-11.dll': The specified procedure could not be found.\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:563:in `load_interface_info'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:70:in `load_info'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:40:in `block in load'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:34:in `block (2 levels) in each'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:33:in `times'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:33:in `block in each'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:32:in `each'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:32:in `each'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:39:in `load'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:25:in `load'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:24:in `load'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:28:in `<module:Arrow>'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:24:in `<top (required)>'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\r\n        from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\r\n        from arrow_load.rb:1:in `<main>'\r\nTraceback (most recent call last):\r\n        2: from arrow_load.rb:1:in `<main>'\r\n        1: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\r\ne:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require': cannot load such file -- arrow (LoadError)\r\n        16: from arrow_load.rb:1:in `<main>'\r\n        15: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:34:in `require'\r\n        14: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `rescue in require'\r\n        13: from e:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:130:in `require'\r\n        12: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:24:in `<top (required)>'\r\n        11: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow.rb:28:in `<module:Arrow>'\r\n        10: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:24:in `load'\r\n         9: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:25:in `load'\r\n         8: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:42:in `load'\r\n         7: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:32:in `each'\r\n         6: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:32:in `each'\r\n         5: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:33:in `block in each'\r\n         4: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:33:in `times'\r\n         3: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/repository.rb:34:in `block (2 levels) in each'\r\n         2: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:43:in `block in load'\r\n         1: from e:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:68:in `load_info'\r\ne:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/red-arrow-0.12.0/lib/arrow/loader.rb:85:in `load_object_info': uninitialized constant Arrow::ArrayBuilder (NameError)\r\n```\r\n\r\n"
        },
        {
            "created_at": "2019-03-21T20:08:21.271Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16798397) by Kouhei Sutou (kou):*\nYou shouldn't do `require 'arrow'` before `add_dll_directory`.\r\nCould you remove `require 'arrow'` at the first line and try again?\r\n\r\nAnd could you try `ruby -rdevkit arrow_load.rb`?"
        },
        {
            "created_at": "2019-03-27T13:59:08.345Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16802816) by Dominic Sisneros (dsisnero):*\nI am not sure if it was the latest pacman -Syu or the gem but it is working now without the workaround. \r\n\r\nThank you so much for all your work.  \r\n\r\nI am going through some examples I have seen and some of the tests.  One thing that doesn't work on windows yet is the red-parquet.  Should I open a new issue and close this one out?\r\n\r\n```\n\r\n[1] pry(main)> require 'arrow'\r\n=> true\r\n[2] pry(main)> require 'parquet'\r\nGObjectIntrospection::RepositoryError::TypelibNotFound: Typelib file for namespace 'Parquet' (any version) not found\r\nfrom E:/rubies/Ruby26-x64/lib/ruby/gems/2.6.0/gems/gobject-introspection-3.3.6/lib/gobject-introspection/loader.rb:37:in `require'\r\nCaused by LoadError: cannot load such file -- parquet\r\nfrom E:/rubies/Ruby26-x64/lib/ruby/site_ruby/2.6.0/rubygems/core_ext/kernel_require.rb:54:in `require'\r\n[3] pry(main)>\r\n```\r\n\r\nAlso, on windows saving a file to gzipped csv seems to hang\r\n\r\n```\n\r\ntable = Arrow::Table.load('worldcitiespop.csv')\r\ntable.save('worldcitiespop.csv.gz', format: :csv, compression: :gzip)\r\n```\r\n\r\nhangs on my computer\r\n\r\nThanks\r\n\r\n\r\n\r\n"
        },
        {
            "created_at": "2019-03-27T21:36:16.406Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16803383) by Kouhei Sutou (kou):*\nOK. We can close this because Red Arrow works on Windows.\r\n\r\nFor red-parquet, we need to enable Parquet in MSYS2 package: https://github.com/msys2/MINGW-packages/blob/master/mingw-w64-arrow/PKGBUILD\r\n\r\nFor hangs, could you open a new issue?"
        },
        {
            "created_at": "2019-03-28T16:31:06.554Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=16804090) by Dominic Sisneros (dsisnero):*\nOk, created a new issue for Parquet in MSYS2\r\n\r\nhttps://issues.apache.org/jira/browse/ARROW-5055\r\n\r\nThanks"
        },
        {
            "created_at": "2022-08-27T14:42:08.245Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-4953?focusedCommentId=17586060) by @toddfarmer:*\nTransitioning issue from Resolved to Closed to based on resolution field value."
        }
    ]
}