{
    "issue": {
        "title": "[RUBY] Gem does not install on macOS due to glib2 3.3.7 compilation failure",
        "body": "***Note**: This issue was originally created as [ARROW-6809](https://issues.apache.org/jira/browse/ARROW-6809). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\n**System information:**\r\n \\* macOS Mojave 10.14.6\r\n \\* Ruby\u00a02.6.3p62 (2019-04-16 revision 67580) [x86_64-darwin18] managed via rbenv\r\n\r\n**Reproduction steps:**\r\nRun `gem install red-arrow`\r\n\r\n**Observe:**\r\nThe following compilation errors occur during compilation of dependent gem glib2 3.3.7:\r\n\r\n```Java\n\r\nBuilding native extensions. This could take a while...\r\nERROR:  Error installing red-arrow:\r\n\tERROR: Failed to build gem native extension.\r\n\r\n    current directory: /Users/kwedinger/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/glib2-3.3.7/ext/glib2\r\n/Users/kwedinger/.rbenv/versions/2.6.3/bin/ruby -I /Users/kwedinger/.rbenv/versions/2.6.3/lib/ruby/2.6.0 -r ./siteconf20191007-84053-1y4ly2q.rb extconf.rb\r\nchecking for --enable-debug-build option... no\r\nchecking for -Wall option to compiler... yes\r\nchecking for -Waggregate-return option to compiler... yes\r\nchecking for -Wcast-align option to compiler... yes\r\nchecking for -Wextra option to compiler... no\r\nchecking for -Wformat=2 option to compiler... yes\r\nchecking for -Winit-self option to compiler... yes\r\nchecking for -Wlarger-than-65500 option to compiler... yes\r\nchecking for -Wmissing-declarations option to compiler... yes\r\nchecking for -Wmissing-format-attribute option to compiler... yes\r\nchecking for -Wmissing-include-dirs option to compiler... yes\r\nchecking for -Wmissing-noreturn option to compiler... yes\r\nchecking for -Wmissing-prototypes option to compiler... yes\r\nchecking for -Wnested-externs option to compiler... yes\r\nchecking for -Wold-style-definition option to compiler... yes\r\nchecking for -Wpacked option to compiler... yes\r\nchecking for -Wp,-D_FORTIFY_SOURCE=2 option to compiler... yes\r\nchecking for -Wpointer-arith option to compiler... yes\r\nchecking for -Wswitch-default option to compiler... yes\r\nchecking for -Wswitch-enum option to compiler... yes\r\nchecking for -Wundef option to compiler... yes\r\nchecking for -Wout-of-line-declaration option to compiler... yes\r\nchecking for -Wunsafe-loop-optimizations option to compiler... no\r\nchecking for -Wwrite-strings option to compiler... yes\r\nchecking for Homebrew... yes\r\nchecking for gobject-2.0 version (>= 2.12.0)... yes\r\nchecking for gthread-2.0... yes\r\nchecking for unistd.h... yes\r\nchecking for io.h... no\r\nchecking for g_spawn_close_pid() in glib.h... yes\r\nchecking for g_thread_init() in glib.h... yes\r\nchecking for g_main_depth() in glib.h... yes\r\nchecking for g_listenv() in glib.h... yes\r\nchecking for rb_check_array_type() in ruby.h... yes\r\nchecking for rb_check_hash_type() in ruby.h... yes\r\nchecking for rb_exec_recursive() in ruby.h... yes\r\nchecking for rb_errinfo() in ruby.h... yes\r\nchecking for rb_thread_call_without_gvl() in ruby.h... yes\r\nchecking for ruby_native_thread_p() in ruby.h... yes\r\nchecking for rb_thread_call_with_gvl() in ruby.h... yes\r\nchecking for rb_gc_register_mark_object() in ruby.h... yes\r\nchecking for rb_exc_new_str() in ruby.h... yes\r\nchecking for rb_enc_str_new_static() in ruby.h... yes\r\nchecking for curr_thread in ruby.h,node.h... no\r\nchecking for rb_curr_thread in ruby.h,node.h... no\r\ncreating ruby-glib2.pc\r\ncreating glib-enum-types.c\r\ncreating glib-enum-types.h\r\ncreating Makefile\r\n\r\ncurrent directory: /Users/kwedinger/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/glib2-3.3.7/ext/glib2\r\nmake \"DESTDIR=\" clean\r\n\r\ncurrent directory: /Users/kwedinger/.rbenv/versions/2.6.3/lib/ruby/gems/2.6.0/gems/glib2-3.3.7/ext/glib2\r\nmake \"DESTDIR=\"\r\ncompiling rbglib-gc.c\r\ncompiling rbgobj_signal.c\r\ncompiling rbglib_int64.c\r\ncompiling rbglib_convert.c\r\ncompiling rbglib_bookmarkfile.c\r\ncompiling rbglib-variant.c\r\ncompiling glib-enum-types.c\r\nglib-enum-types.c:632:9: warning: 'G_SPAWN_ERROR_2BIG' is deprecated: Use 'G_SPAWN_ERROR_TOO_BIG' instead [-Wdeprecated-declarations]\r\n      { G_SPAWN_ERROR_2BIG, \"G_SPAWN_ERROR_2BIG\", \"2big\" },\r\n        ^\r\n/usr/local/Cellar/glib/2.62.1/include/glib-2.0/glib/gspawn.h:76:22: note: 'G_SPAWN_ERROR_2BIG' has been explicitly marked deprecated here\r\n  G_SPAWN_ERROR_2BIG GLIB_DEPRECATED_ENUMERATOR_IN_2_32_FOR(G_SPAWN_ERROR_TOO_BIG) = G_SPAWN_ERROR_TOO_BIG,\r\n                     ^\r\n/usr/local/Cellar/glib/2.62.1/include/glib-2.0/glib/gversionmacros.h:421:54: note: expanded from macro 'GLIB_DEPRECATED_ENUMERATOR_IN_2_32_FOR'\r\n# define GLIB_DEPRECATED_ENUMERATOR_IN_2_32_FOR(f)   GLIB_DEPRECATED_ENUMERATOR_FOR(f)\r\n                                                     ^\r\n/usr/local/Cellar/glib/2.62.1/include/glib-2.0/glib/gmacros.h:1002:43: note: expanded from macro 'GLIB_DEPRECATED_ENUMERATOR_FOR'\r\n#define GLIB_DEPRECATED_ENUMERATOR_FOR(f) G_DEPRECATED_FOR(f)\r\n                                          ^\r\n/usr/local/Cellar/glib/2.62.1/include/glib-2.0/glib/gmacros.h:950:44: note: expanded from macro 'G_DEPRECATED_FOR'\r\n#define G_DEPRECATED_FOR(f) __attribute__((__deprecated__(\"Use '\" #f \"' instead\")))\r\n                                           ^\r\nglib-enum-types.c:729:12: warning: incompatible pointer to integer conversion initializing 'guint' (aka 'unsigned int') with an expression of type 'const char [2]' [-Wint-conversion]\r\n      { }, \"}\", \"}\" },\r\n           ^~~\r\nglib-enum-types.c:729:12: warning: suggest braces around initialization of subobject [-Wmissing-braces]\r\n      { }, \"}\", \"}\" },\r\n           ^~~~~~~~\r\n           {       }\r\nglib-enum-types.c:729:12: error: initializer element is not a compile-time constant\r\n      { }, \"}\", \"}\" },\r\n           ^~~\r\nglib-enum-types.c:729:22: error: expected ';' at end of declaration\r\n      { }, \"}\", \"}\" },\r\n                     ^\r\n                     ;\r\nglib-enum-types.c:730:41: error: expected expression\r\n      { G_GNUC_BEGIN_IGNORE_DEPRECATIONS, \"G_GNUC_BEGIN_IGNORE_DEPRECATIONS\", \"g-gnuc-begin-ignore-deprecations\" },\r\n                                        ^\r\nglib-enum-types.c:730:115: error: expected expression\r\n      { G_GNUC_BEGIN_IGNORE_DEPRECATIONS, \"G_GNUC_BEGIN_IGNORE_DEPRECATIONS\", \"g-gnuc-begin-ignore-deprecations\" },\r\n                                                                                                                  ^\r\nglib-enum-types.c:741:62: error: use of undeclared identifier 'values'\r\n    etype = g_flags_register_static (\"GTestSubprocessFlags\", values);\r\n                                                             ^\r\nglib-enum-types.c:743:3: error: expected identifier or '('\r\n  return etype;\r\n  ^\r\nglib-enum-types.c:744:1: error: extraneous closing brace ('}')\r\n}\r\n^\r\n3 warnings and 7 errors generated.\r\nmake: *** [glib-enum-types.o] Error 1\r\n\r\nmake failed, exit code 2\r\n```\r\n\r\nThis appears to be related to https://github.com/ruby-gnome/ruby-gnome/issues/1294 which is fixed in glib2 3.3.8.",
        "created_at": "2019-10-07T18:28:30.000Z",
        "updated_at": "2019-10-29T03:39:40.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Ruby",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2019-10-29T03:39:40.000Z"
    },
    "comments": [
        {
            "created_at": "2019-10-08T06:01:29.051Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-6809?focusedCommentId=16946512) by Kouhei Sutou (kou):*\nglib2 3.3.8 fixes the problem but has another problem.\r\nglib2 3.3.9 will fix the another problem.\r\n\r\nWorkaround:\r\n\r\n  \\* Downgrade GLib installed by Homebrew to 2.60.\r\n  \\* Use red-arrow at master.\r\n  \\* Wait for Apache Arrow 1.0.0."
        },
        {
            "created_at": "2019-10-29T03:39:40.344Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-6809?focusedCommentId=16961640) by Kouhei Sutou (kou):*\nARROW-6777 solves this."
        }
    ]
}