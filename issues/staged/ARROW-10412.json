{
    "issue": {
        "title": "[C++] CMake Build Fails with grpc 1.33.1, \"GRPC_CPP_PLUGIN-NOTFOUND: program not found or is not executable\"",
        "body": "***Note**: This issue was originally created as [ARROW-10412](https://issues.apache.org/jira/browse/ARROW-10412). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nA cmake build of Apache Arrow 2.0.0 fails when using library grpc version 1.33.1 with the error:\u00a0\r\n```java\n\r\nGRPC_CPP_PLUGIN-NOTFOUND: program not found or is not executable\r\n```\r\nThis is for a Macports port of Apache Arrow; see\u00a0https://github.com/macports/macports-ports/pull/7791.\r\n\r\n~~The build previously worked on grpc version\u00a01.30.2.~~ (Correction: this was using the Makefile, not the cmake system.)\r\n\r\nI am following the build instructions at\u00a0\r\n\r\n<https://github.com/apache/arrow/blob/master/docs/source/developers/python.rst#build-and-test>\r\n\r\nI verify that the executable\u00a0grpc_cpp_plugin is installed with all grpc shared libraries.\r\n\r\nI've read\u00a0cpp/cmake_modules/FindgRPCAlt.cmake and believe that I've set all the correct flags for cmake (below) and believe that this is an issue with the arrow cmake configuration.\r\n\r\nThe error occurs at this line:\r\n\r\n\u00a0\r\n```java\n\r\n/opt/local/bin/protoc -I/opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp/../format --cpp_out=/opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/build/src/arrow/flight /opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp/../format/Flight.proto\r\ncd /opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/build/src/arrow/flight && /opt/local/bin/protoc -I/opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp/../format --grpc_out=/opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/build/src/arrow/flight --plugin=protoc-gen-grpc=GRPC_CPP_PLUGIN-NOTFOUND /opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp/../format/Flight.proto\r\nGRPC_CPP_PLUGIN-NOTFOUND: program not found or is not executable\r\nPlease specify a program using absolute path or make sure the program is available in your PATH system variable\r\n--grpc_out: protoc-gen-grpc: Plugin failed with status code 1.\n```\r\nExample build log: <https://paste.z0k.xyz/ad7d47f2f9e6.txt>\r\n\r\nCmake flags:\u00a0\r\n```java\n\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_FLIGHT=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_GRPC_USE_SHARED=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_JEMALLOC=OFF \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_ORC=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_PARQUET=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_PLASMA=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_PROTOBUF_USE_SHARED=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_PYTHON=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_USE_CCACHE=OFF \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_BZ2=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_ZLIB=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_ZSTD=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_LZ4=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_SNAPPY=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_WITH_BROTLI=ON \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DARROW_INSTALL_NAME_RPATH=OFF \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DCARES_PREFIX=${prefix} \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_INSTALL=OFF \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_ROOT=${prefix} \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_BUILD_TESTS=OFF \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_CARES_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_ABSL_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_PROTOBUF_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_RE2_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_SSL_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DgRPC_ZLIB_PROVIDER=package \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 -DLLVM_ROOT=${llvm_prefix}\r\n```",
        "created_at": "2020-10-28T13:32:21.000Z",
        "updated_at": "2020-11-11T02:33:43.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-11-11T02:33:36.000Z"
    },
    "comments": [
        {
            "created_at": "2020-10-29T00:06:36.061Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17222628) by Kouhei Sutou (kou):*\nDoes the following patch resolve this?\r\n\r\n```\n\r\ndiff --git a/cpp/cmake_modules/FindgRPCAlt.cmake b/cpp/cmake_modules/FindgRPCAlt.cmake\r\nindex d6ba331ae..6d637941f 100644\r\n--- a/cpp/cmake_modules/FindgRPCAlt.cmake\r\n+++ b/cpp/cmake_modules/FindgRPCAlt.cmake\r\n@@ -145,7 +145,7 @@ else()\r\n     find_library(GRPC_UPB_LIB\r\n                  NAMES ${GRPC_UPB_LIB_NAMES}\r\n                  PATH_SUFFIXES ${ARROW_LIBRARY_PATH_SUFFIXES})\r\n-    find_program(GRPC_CPP_PLUGIN grpc_cpp_plugin PATH_SUFFIXES \"bin\")\r\n+    find_program(GRPC_CPP_PLUGIN grpc_cpp_plugin)\r\n     find_path(GRPC_INCLUDE_DIR\r\n               NAMES grpc/grpc.h\r\n               PATH_SUFFIXES ${ARROW_INCLUDE_PATH_SUFFIXES})\r\n```\r\n\r\nBTW, `-DgRPC_ROOT=${prefix`} isn't specified in the real `cmake` command line:\r\n\r\n```\n\r\nExecuting:  cd \"/opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/build\" && /opt/local/bin/cmake -G \"CodeBlocks - Unix Makefiles\" -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=\"/opt/local\" -DCMAKE_INSTALL_NAME_DIR=\"/opt/local/lib\" -DCMAKE_SYSTEM_PREFIX_PATH=\"/opt/local;/usr\" -DCMAKE_C_COMPILER=\"$CC\" -DCMAKE_CXX_COMPILER=\"$CXX\" -DCMAKE_POLICY_DEFAULT_CMP0025=NEW -DCMAKE_POLICY_DEFAULT_CMP0060=NEW -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_COLOR_MAKEFILE=ON -DCMAKE_FIND_FRAMEWORK=LAST -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCMAKE_MAKE_PROGRAM=/usr/bin/make -DCMAKE_MODULE_PATH=\"/opt/local/share/cmake/Modules;/opt/local/libexec/llvm-10/lib/cmake/llvm\" -DCMAKE_PREFIX_PATH=\"/opt/local/share/cmake/Modules;/opt/local/libexec/llvm-10/lib/cmake/llvm\" -DCMAKE_BUILD_WITH_INSTALL_RPATH:BOOL=ON -DCMAKE_INSTALL_RPATH=\"/opt/local/lib\" -Wno-dev -DARROW_FLIGHT=ON -DARROW_JEMALLOC=OFF -DARROW_ORC=ON -DARROW_PARQUET=ON -DARROW_PLASMA=ON -DARROW_PROTOBUF_USE_SHARED=ON -DARROW_PYTHON=ON -DARROW_USE_CCACHE=OFF -DARROW_WITH_BZ2=ON -DARROW_WITH_ZLIB=ON -DARROW_WITH_ZSTD=ON -DARROW_WITH_LZ4=ON -DARROW_WITH_SNAPPY=ON -DARROW_WITH_BROTLI=ON -DARROW_INSTALL_NAME_RPATH=OFF -DCARES_PREFIX=/opt/local -DgRPC_INSTALL=OFF -DgRPC_BUILD_TESTS=OFF -DgRPC_CARES_PROVIDER=package -DgRPC_ABSL_PROVIDER=package -DgRPC_PROTOBUF_PROVIDER=package -DgRPC_RE2_PROVIDER=package -DgRPC_SSL_PROVIDER=package -DgRPC_ZLIB_PROVIDER=package -DLLVM_ROOT=/opt/local/libexec/llvm-10 -DPython3_EXECUTABLE=/opt/local/Library/Frameworks/Python.framework/Versions/3.8/bin/python3.8 -DCMAKE_OSX_ARCHITECTURES=\"x86_64\" -DCMAKE_OSX_DEPLOYMENT_TARGET=\"10.15\" -DCMAKE_OSX_SYSROOT=\"/Library/Developer/CommandLineTools/SDKs/MacOSX10.15.sdk\" /opt/local/var/macports/build/_Users_runner_work_1_s_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp \r\n```"
        },
        {
            "created_at": "2020-10-29T01:55:13.659Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17222656) by Steven Smith (s.t.smith):*\nThank you. This patch does not resolve this issue. A few more notes:\r\n \\* I hit the same issue when I specify\u00a0-`DgRPC_ROOT=$\\{prefix`}\u00a0\r\n \\* Setting\u00a0-DARROW_FLIGHT:BOOL=OFF resolves the issue\u2014this is something to do with cmake and flight.\r\n\r\n\u00a0Successful cmake build without flight:\r\n```java\n\r\n:info:configure Executing:\u00a0 cd \"/opt/local/var/macports/build/_opt_local_ports_devel_apache-arrow/apache-arrow/work/build\" && /opt/local/bin/cmake -G \"CodeBlocks - Unix Makefiles\" -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=\"/opt/local\" -DCMAKE_INSTALL_NAME_DIR=\"/opt/local/lib\" -DCMAKE_SYSTEM_PREFIX_PATH=\"/opt/local;/usr\" -DCMAKE_C_COMPILER=\"$CC\" -DCMAKE_CXX_COMPILER=\"$CXX\" -DCMAKE_POLICY_DEFAULT_CMP0025=NEW -DCMAKE_POLICY_DEFAULT_CMP0060=NEW -DCMAKE_VERBOSE_MAKEFILE=ON -DCMAKE_COLOR_MAKEFILE=ON -DCMAKE_FIND_FRAMEWORK=LAST -DCMAKE_EXPORT_COMPILE_COMMANDS=ON -DCMAKE_MAKE_PROGRAM=/usr/bin/make -DCMAKE_MODULE_PATH=\"/opt/local/share/cmake/Modules;/opt/local/libexec/llvm-10/lib/cmake/llvm\" -DCMAKE_PREFIX_PATH=\"/opt/local/share/cmake/Modules;/opt/local/libexec/llvm-10/lib/cmake/llvm\" -DCMAKE_BUILD_WITH_INSTALL_RPATH:BOOL=ON -DCMAKE_INSTALL_RPATH=\"/opt/local/lib\" -Wno-dev -DARROW_DEPENDENCY_USE_SHARED:BOOL=ON -DARROW_FLIGHT:BOOL=OFF -DARROW_JEMALLOC:BOOL=ON -DARROW_ORC:BOOL=ON -DARROW_PARQUET:BOOL=ON -DARROW_PLASMA:BOOL=ON -DARROW_PROTOBUF_USE_SHARED=:BOOLON -DARROW_PYTHON:BOOL=ON -DARROW_USE_CCACHE:BOOL=OFF -DARROW_WITH_BZ2:BOOL=ON -DARROW_WITH_ZLIB:BOOL=ON -DARROW_WITH_ZSTD:BOOL=ON -DARROW_WITH_LZ4:BOOL=ON -DARROW_WITH_SNAPPY:BOOL=ON -DARROW_WITH_BROTLI:BOOL=ON -DARROW_INSTALL_NAME_RPATH:BOOL=OFF -DgRPC_ROOT=/opt/local -DLLVM_ROOT=/opt/local/libexec/llvm-10 -DPython3_EXECUTABLE=/opt/local/Library/Frameworks/Python.framework/Versions/3.8/bin/python3.8 -DCMAKE_OSX_ARCHITECTURES=\"x86_64\" -DCMAKE_OSX_DEPLOYMENT_TARGET=\"10.15\" -DCMAKE_OSX_SYSROOT=\"/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.15.sdk\" /opt/local/var/macports/build/_opt_local_ports_devel_apache-arrow/apache-arrow/work/arrow-2.0.0/cpp\n```"
        },
        {
            "created_at": "2020-10-29T02:19:52.443Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17222662) by Kouhei Sutou (kou):*\nCould you show `ls -lah ${prefix}/bin`?\r\n\r\nIf we set `-DARROW_FLIGHT:BOOL=OFF`, we don't search (require) gRPC. Because gRPC is used for only Flight."
        },
        {
            "created_at": "2020-10-29T10:35:03.662Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17222821) by Steven Smith (s.t.smith):*\nHere's the grpc binaries and cmake files, all created with a cmake build of grpc. All the shared libraries are in\u00a0 ${prefix}/lib.\r\n\r\n\u00a0\r\n```java\n\r\n\r\n$ ls -lah /opt/local/bin/grpc_*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel \u00a0 111K Oct 28 12:31 /opt/local/bin/grpc_cpp_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 55K Oct 28 12:31 /opt/local/bin/grpc_csharp_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 54K Oct 28 12:31 /opt/local/bin/grpc_node_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 78K Oct 28 12:31 /opt/local/bin/grpc_objective_c_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 62K Oct 28 12:31 /opt/local/bin/grpc_php_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 49K Oct 28 12:31 /opt/local/bin/grpc_python_plugin*\r\n-rwxr-xr-x\u00a0 1 root\u00a0 wheel\u00a0 \u00a0 52K Oct 28 12:31 /opt/local/bin/grpc_ruby_plugin*\r\n\r\n\r\n```\r\n\u00a0\r\n```java\n\r\n$ ls -lah /opt/local/lib/cmake/grpc/\r\ntotal 32\r\ndrwxr-xr-x \u00a0 7 root\u00a0 wheel \u00a0 224B Oct 28 12:31 ./\r\ndrwxr-xr-x\u00a0 82 root\u00a0 admin \u00a0 2.6K Oct 28 18:43 ../\r\n-rw-r--r-- \u00a0 1 root\u00a0 wheel \u00a0 497B Oct 28 12:30 gRPCConfig.cmake\r\n-rw-r--r-- \u00a0 1 root\u00a0 wheel \u00a0 923B Oct 28 12:30 gRPCConfigVersion.cmake\r\n-rw-r--r-- \u00a0 1 root\u00a0 wheel \u00a0 9.7K Oct 28 12:30 gRPCTargets-macports.cmake\r\n-rw-r--r-- \u00a0 1 root\u00a0 wheel \u00a0 8.1K Oct 28 12:30 gRPCTargets.cmake\r\ndrwxr-xr-x \u00a0 4 root\u00a0 wheel \u00a0 128B Oct 28 12:31 modules/\r\n\r\n\r\n```\r\n\u00a0\r\n\r\n\u00a0"
        },
        {
            "created_at": "2020-10-29T11:18:29.712Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17222842) by Steven Smith (s.t.smith):*\nI'm able to get a successful build by editing in the binary path for grpc_cpp_plugin where the string \u00a0GRPC_CPP_PLUGIN-NOTFOUND appears in the file ${cmake.build_dir}/src/arrow/flight/CMakeFiles/flight_grpc_gen.dir/build.make:\r\n\r\n\u00a0\r\n```java\n\r\n# Remove after this cmake issue is resolved: \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\r\n# https://issues.apache.org/jira/browse/ARROW-10412?jql=project%20%3D%20ARROW%20AND%20resolution%20%3D%20Unresolved%20AND%20text%20~%20%22grpc%22%20ORDER%20BY%20cf%5B12313920%5D%20ASC%2C%20priority%20DESC%2C%20updated%20DESC\r\npost-configure {\r\n    reinplace \"s|GRPC_CPP_PLUGIN-NOTFOUND|${prefix}/bin/grpc_cpp_plugin|g\" \\\r\n    ${cmake.build_dir}/src/arrow/flight/CMakeFiles/flight_grpc_gen.dir/build.make\r\n\u00a0 \u00a0 }\n```\r\n\u00a0\r\n\r\n\u00a0"
        },
        {
            "created_at": "2020-10-30T00:49:27.339Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17223293) by Kouhei Sutou (kou):*\nCould you show the log when you enable Flight, use `-DgRPC_ROOT` and use the workaround?\r\n\r\nBTW, `-DGRPC_CPP_PLUGIN=${prefix}/bin/grpc_cpp_plugin` may work without the workaround. (It's a workaround too.)"
        },
        {
            "created_at": "2020-10-31T09:33:30.005Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17224038) by Steven Smith (s.t.smith):*\nLink to buildbot log: <https://paste.z0k.xyz/05ad54392a2f.txt>, attached above.\r\n\r\nAlso, I tried adding\u00a0 -DGRPC_CPP_PLUGIN=${prefix}/bin/grpc_cpp_plugin before, and although this worked for part of the build, I still encountered the same \u00a0issue at a different point later in the build."
        },
        {
            "created_at": "2020-11-02T01:20:49.357Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17224375) by Kouhei Sutou (kou):*\nThanks. It seems that it's for pyarrow's build log not Apache Arrow C++'s build log.\r\n\r\n`-DgRPC_ROOT` and `-DGRPC_CPP_PLUGIN` are for Apache Arrow C++'s build option not pyarrow.\r\n\r\n"
        },
        {
            "created_at": "2020-11-02T11:07:44.526Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17224592) by Steven Smith (s.t.smith):*\nWhoops, here's the correct log: <https://paste.z0k.xyz/8ad82fffe224.txt>\u00a0also attached."
        },
        {
            "created_at": "2020-11-02T22:10:49.702Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17224984) by Kouhei Sutou (kou):*\nThanks.\r\nCould you try this patch?\r\n\r\n```\n\r\ndiff --git a/cpp/cmake_modules/ThirdpartyToolchain.cmake b/cpp/cmake_modules/ThirdpartyToolchain.cmake\r\nindex d084f3468..22531fcfc 100644\r\n--- a/cpp/cmake_modules/ThirdpartyToolchain.cmake\r\n+++ b/cpp/cmake_modules/ThirdpartyToolchain.cmake\r\n@@ -2530,11 +2530,6 @@ if(ARROW_WITH_GRPC)\r\n     endif()\r\n   endif()\r\n \r\n-  get_target_property(GRPC_CPP_PLUGIN gRPC::grpc_cpp_plugin IMPORTED_LOCATION)\r\n-  if(NOT GRPC_CPP_PLUGIN)\r\n-    get_target_property(GRPC_CPP_PLUGIN gRPC::grpc_cpp_plugin IMPORTED_LOCATION_RELEASE)\r\n-  endif()\r\n-\r\n   if(TARGET gRPC::address_sorting)\r\n     set(GRPC_HAS_ADDRESS_SORTING TRUE)\r\n   else()\r\ndiff --git a/cpp/src/arrow/flight/CMakeLists.txt b/cpp/src/arrow/flight/CMakeLists.txt\r\nindex edd4fdf1c..f0c23efb6 100644\r\n--- a/cpp/src/arrow/flight/CMakeLists.txt\r\n+++ b/cpp/src/arrow/flight/CMakeLists.txt\r\n@@ -54,7 +54,7 @@ add_custom_command(OUTPUT ${FLIGHT_GENERATED_PROTO_FILES}\r\n                    COMMAND ${ARROW_PROTOBUF_PROTOC}\r\n                            \"-I${FLIGHT_PROTO_PATH}\"\r\n                            \"--grpc_out=${CMAKE_CURRENT_BINARY_DIR}\"\r\n-                           \"--plugin=protoc-gen-grpc=${GRPC_CPP_PLUGIN}\"\r\n+                           \"--plugin=protoc-gen-grpc=$<TARGET_FILE:gRPC::grpc_cpp_plugin>\"\r\n                            \"${FLIGHT_PROTO}\")\r\n \r\n set_source_files_properties(${FLIGHT_GENERATED_PROTO_FILES} PROPERTIES GENERATED TRUE)\r\n```"
        },
        {
            "created_at": "2020-11-11T02:33:36.721Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10412?focusedCommentId=17229668) by Kouhei Sutou (kou):*\nIssue resolved by pull request 8596\n<https://github.com/apache/arrow/pull/8596>"
        }
    ]
}