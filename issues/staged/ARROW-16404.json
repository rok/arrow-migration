{
    "issue": {
        "title": "[R][CI] Research alternative binary hosting ",
        "body": "***Note**: This issue was originally created as [ARROW-16404](https://issues.apache.org/jira/browse/ARROW-16404). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nFind a way to host the R nightly binaries in some form of artifactory under ASF umbrella. Currently they are hosted on s3. See ARROW-16401\r\n\r\nPython wheels are hosted gemfury.io\r\n\r\ncc: `[~kszucs]` `[~kou]` `[~amol-]` `[~raulcd]` \u00a0\r\n\r\nPossible solutions, both of which could be extended for other Components that don't need an active server for their binary repos:\r\n \\* Host nightly builds on apache artifactory\r\n \\*\\* <https://apache.jfrog.io/artifactory>\r\n \\*\\*\\* (?) Is this even possible as nightlies are not signed official releases?\r\n \\*\\*\\* Size considerations (-> limit to 5 days as with conda?)\r\n \\*\\* <https://nightlies.apache.org/>\r\n \\*\\*\\* {~~}(y){~~}Made for this purpose, extendable to other components like java that currently have no \"nice\" solution\r\n \\*\\*\\* {~~}(y){~~}Entirely under ASF control and on-brand{~~}``{~~}\r\n \\*\\*\\* {~~}`(y)`{~~}`{}We could host M1 binaries compiled on Crossbow (by downloading them in arrow ci){`}\r\n \\* Host nightly builds on Github via Github Pages using either [drat](https://github.com/eddelbuettel/drat) or manually creating the repo structure.\r\n \\*\\* (!) To prevent insane repo sizes this will require constant pruning/rewriting of git history\u00a0\r\n \\*\\* Building and hosting on apache/arrow:\u00a0\r\n \\*\\*\\* (y) The existing [R CI](https://github.com/apache/arrow/blob/master/.github/workflows/r.yml) could easily be extended to also commit the binaries to a gh_pages based repository, either on push to master or as a cron job.\u00a0\r\n \\*\\*\\* (y) Entirely under ASF control and on-brand for users: `install.packages(\"arrow\", repos = \"https://apache.github.io/arrow/r\")` vs. `install.packages(\"arrow\", repos = \"https://arrow-r-nightly.s3.amazonaws.com\")`\r\n \\*\\*\\* (y) Github Pages can be turned on via [.asf.yaml](https://cwiki.apache.org/confluence/display/INFRA/git+-+.asf.yaml+features#Git.asf.yamlfeatures-DependabotAlertsandUpdates) - no ticket needed for Infra?\r\n \\*\\*\\* (n) Not possible to create M1 binaries ([for now?](https://github.com/actions/virtual-environments/issues/2187))\r\n \\*\\* Hosting on a newly created utility repository apache/arrow-nightly:\r\n \\*\\*\\* Build binaries in Crossbow and upload via PAT with write access (not an option for apache/arrow due to security concerns)\r\n \\*\\*\\* `(y) We could host M1 binaries compiled on Crossbow`\r\n \\*\\*\\* (y) Entirely under ASF control and on-brand for users: `install.packages(\"arrow\", repos = \"https://apache.github.io/arrow-nightly/\")` vs. `install.packages(\"arrow\", repos = \"https://arrow-r-nightly.s3.amazonaws.com\")`\r\n \\*\\*\\* (?) Does INFRA even allow such \"utility\" repos?\r\n \\*\\* Building and hosting on ursacomputing/crossbow:\r\n \\*\\*\\* (n) Neither under ASF control nor on-brand\r\n \\*\\*\\* `(y) We could host M1 binaries`",
        "created_at": "2022-04-28T15:27:39.000Z",
        "updated_at": "2022-05-09T19:38:33.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Continuous Integration",
            "Component: R",
            "Type: task"
        ],
        "closed": true,
        "closed_at": "2022-05-09T19:38:33.000Z"
    },
    "comments": [
        {
            "created_at": "2022-05-06T00:42:31.389Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16404?focusedCommentId=17532570) by Kouhei Sutou (kou):*\n> Is this even possible as nightlies are not signed official releases?\r\n\r\nGenerally, we should not mark nightlies as official.\r\n\r\nSee also: https://apache.org/legal/release-policy.html#publication\r\n\r\n> Projects SHALL publish official releases and SHALL NOT publish unreleased materials outside the development community.\r\n>\r\n> During the process of developing software and preparing a release, various packages are made available to the development community for testing purposes. Projects MUST direct outsiders towards official releases rather than raw source repositories, nightly builds, snapshots, release candidates, or any other similar packages. Projects SHOULD make available developer resources to support individuals actively participating in development or following the dev list and thus aware of the conditions placed on unreleased materials.\r\n\r\nIt seems that we can use JFrog Pipelines in https://apache.jfrog.io/ to upload built binaries to JFrog Artifactory. I didn't use JFrog Pipelines. I just read the following documentations:\r\n\r\n- https://www.jfrog.com/confluence/display/JFROG/Defining+a+Pipeline\n- https://www.jfrog.com/confluence/display/JFROG/GitRepo\n- https://www.jfrog.com/confluence/display/JFROG/FileSpec\n  \n  I can set API token/key to download built binaries from GitHub artifacts/releases and upload to JFrog Artifactory."
        },
        {
            "created_at": "2022-05-06T16:13:22.144Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16404?focusedCommentId=17532953) by Neal Richardson (npr):*\nC++ binaries that go with the official release should be created as part of the release process and hosted on the official ASF/artifactory place, alongside the wheels and apt/yum packages.\r\n\r\nBut nightlies are different. I'm not sure it's possible to host nightlies on ASF's artifactory account, is it? We don't currently for anything else, only releases. And that fits with the \"unofficial\" nature of nightlies. \r\n\r\nAssuming that nightlies can't be hosted there, I don't think there's a good alternative to what we're currently doing with the S3 bucket.\r\n\r\n- gemfury doesn't appear to support the R repository structure (which is just putting certain files in certain paths)\n- GitHub Pages will blow up. Each night we currently upload about 170mb of files. If you had to do a `git clone` of that in order to add files and then push, it's going to fall over.\n  \n  We previously hosted them on bintray until that went away. I'm not aware of another file hosting service that's public, free, and lets us lay out the directory structure required for an R repository."
        },
        {
            "created_at": "2022-05-07T14:01:40.309Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16404?focusedCommentId=17533270) by Jacob Wujciak-Jens (assignUser):*\nI wasn't able to find any documentation on it out side of what is uploaded in root but I think <https://nightlies.apache.org/> should be the appropriate place? It should allow us to set up the required folder structure and does not have the issue of a ballooning git history. And we might be able to upload binaries from crossbow too (if infra allows it)."
        },
        {
            "created_at": "2022-05-07T21:02:59.586Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16404?focusedCommentId=17533340) by Kouhei Sutou (kou):*\nWow! I didn't know https://nightlies.apache.org/ . It seems that we can use it from GitHub Actions:\r\n\r\n- https://nightlies.apache.org/authoring.html\n- https://nightlies.apache.org/ghactions-publish-rsync.html\n- https://github.com/apache/infrastructure-test/blob/master/.github/workflows/nightlies-rsync.yml\n- https://github.com/apache/infrastructure-test/blob/master/docs/ghactions-publish-rsync.md\n  \n  apache/ifrastructure-test also includes a JFrog Pipelines example I mentioned above: https://github.com/apache/infrastructure-test/blob/master/docs/ghactions-publish-rsync.md\n  \n  > I'm not sure it's possible to host nightlies on ASF's artifactory account, is it?\n  \n  I think that we can use ASF's artifactory for nightlies. We just should not mark them as \"official\".\n  \n  It seems that we can use https://nightlies.apache.org/ or https://apache.jfrog.io/artifactory for this."
        },
        {
            "created_at": "2022-05-09T12:21:31.862Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16404?focusedCommentId=17533782) by Jacob Wujciak-Jens (assignUser):*\nI think <https://nightlies.apache.org/> is the right place, I will open an INFRA ticket and ask for the required secrets to be placed in the arrow repo. (The actual moving of nightly builds will be down the line ofc.) Unless there are any objections?\u00a0"
        }
    ]
}