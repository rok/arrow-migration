{
    "issue": {
        "title": "[Python][Substrait] Acero consumer is unable to consume count function from substrait query plan",
        "body": "***Note**: This issue was originally created as [ARROW-17061](https://issues.apache.org/jira/browse/ARROW-17061). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nSQL\r\n```java\n\r\nSELECT\r\n    o_orderpriority,\r\n    count(*) AS order_count\r\nFROM\r\n    orders\r\nGROUP BY\r\n    o_orderpriority\n```\r\nThe substrait plan generated from SQL, using Isthmus.\r\n\r\n\u00a0\r\n\r\nsubstrait count:\u00a0\r\n\r\n<https://github.com/substrait-io/substrait/blob/main/extensions/functions_aggregate_generic.yaml>\r\n\r\n\u00a0\r\n\r\nRunning the substrait plan with Acero returns this error:\r\n```java\n\r\nE \u00a0 pyarrow.lib.ArrowInvalid: JsonToBinaryStream returned INVALID_ARGUMENT:(relations[0].root.input.aggregate.measures[0].measure) arguments: Cannot find field. \u00a0\n```\r\n\u00a0\r\n\r\nFrom substrait query plan:\r\n\r\nrelations[0].root.input.aggregate.measures[0].measure\r\n```java\n\r\n\"measure\": {\r\n  \"functionReference\": 0,\r\n  \"args\": [],\r\n  \"sorts\": [],\r\n  \"phase\": \"AGGREGATION_PHASE_INITIAL_TO_RESULT\",\r\n  \"outputType\": {\r\n    \"i64\": {\r\n      \"typeVariationReference\": 0,\r\n      \"nullability\": \"NULLABILITY_REQUIRED\"\r\n    }\r\n  },\r\n  \"invocation\": \"AGGREGATION_INVOCATION_ALL\",\r\n  \"arguments\": []\r\n}\n```\r\n```java\n\r\n\"extensions\": [{\r\n  \"extensionFunction\": {\r\n    \"extensionUriReference\": 1,\r\n    \"functionAnchor\": 0,\r\n    \"name\": \"count:opt\"\r\n  }\r\n}],\n```\r\nCount is a unary function and should be consumable, but isn't in this case.",
        "created_at": "2022-07-12T20:39:06.000Z",
        "updated_at": "2022-09-15T18:11:57.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2022-09-14T14:25:22.431Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17061?focusedCommentId=17604753) by Vibhatha Lakmal Abeykoon (vibhatha):*\n`[~richtia]` \u00a0could you please try the following?\r\n\r\nhttps://github.com/vibhatha/arrow/blob/arrow-17061/python/pyarrow/tests/test_substrait.py#L177-L274\r\n\r\n\u00a0"
        },
        {
            "created_at": "2022-09-14T20:42:41.340Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17061?focusedCommentId=17604965) by Richard Tia (richtia):*\nSo I actually tried again using the example in the issue:\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n```java\n\r\n> \u00a0 ???\r\nE \u00a0 pyarrow.lib.ArrowNotImplementedError: Only unary aggregate functions are currently supported \n```\r\nHere's the plan:\r\n```java\n\r\n{\r\n  \"extensionUris\": [{\r\n    \"extensionUriAnchor\": 1,\r\n    \"uri\": \"AGGREGATE_URI_PLACEHOLDER\"\r\n  }],\r\n  \"extensions\": [{\r\n    \"extensionFunction\": {\r\n      \"extensionUriReference\": 1,\r\n      \"functionAnchor\": 0,\r\n      \"name\": \"count\"\r\n    }\r\n  }],\r\n  \"relations\": [{\r\n    \"root\": {\r\n      \"input\": {\r\n        \"aggregate\": {\r\n          \"common\": {\r\n            \"direct\": {\r\n            }\r\n          },\r\n          \"input\": {\r\n            \"project\": {\r\n              \"common\": {\r\n                \"emit\": {\r\n                  \"outputMapping\": [9]\r\n                }\r\n              },\r\n              \"input\": {\r\n                \"read\": {\r\n                  \"common\": {\r\n                    \"direct\": {\r\n                    }\r\n                  },\r\n                  \"baseSchema\": {\r\n                    \"names\": [\"O_ORDERKEY\", \"O_CUSTKEY\", \"O_ORDERSTATUS\", \"O_TOTALPRICE\", \"O_ORDERDATE\", \"O_ORDERPRIORITY\", \"O_CLERK\", \"O_SHIPPRIORITY\", \"O_COMMENT\"],\r\n                    \"struct\": {\r\n                      \"types\": [{\r\n                        \"i32\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"i32\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"string\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"decimal\": {\r\n                          \"scale\": 2,\r\n                          \"precision\": 15,\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"date\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"string\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"string\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"i32\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }, {\r\n                        \"string\": {\r\n                          \"typeVariationReference\": 0,\r\n                          \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                        }\r\n                      }],\r\n                      \"typeVariationReference\": 0,\r\n                      \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                    }\r\n                  },\r\n                    \"local_files\": {\r\n                      \"items\": [\r\n                        {\r\n                          \"uri_file\": \"file://FILENAME_PLACEHOLDER_0\",\r\n                          \"parquet\": {}\r\n                        }\r\n                      ]\r\n                    }\r\n                }\r\n              },\r\n              \"expressions\": [{\r\n                \"selection\": {\r\n                  \"directReference\": {\r\n                    \"structField\": {\r\n                      \"field\": 5\r\n                    }\r\n                  },\r\n                  \"rootReference\": {\r\n                  }\r\n                }\r\n              }]\r\n            }\r\n          },\r\n          \"groupings\": [{\r\n            \"groupingExpressions\": [{\r\n              \"selection\": {\r\n                \"directReference\": {\r\n                  \"structField\": {\r\n                    \"field\": 0\r\n                  }\r\n                },\r\n                \"rootReference\": {\r\n                }\r\n              }\r\n            }]\r\n          }],\r\n          \"measures\": [{\r\n            \"measure\": {\r\n              \"functionReference\": 0,\r\n              \"args\": [],\r\n              \"sorts\": [],\r\n              \"phase\": \"AGGREGATION_PHASE_INITIAL_TO_RESULT\",\r\n              \"outputType\": {\r\n                \"i64\": {\r\n                  \"typeVariationReference\": 0,\r\n                  \"nullability\": \"NULLABILITY_REQUIRED\"\r\n                }\r\n              },\r\n              \"invocation\": \"AGGREGATION_INVOCATION_ALL\",\r\n              \"arguments\": []\r\n            }\r\n          }]\r\n        }\r\n      },\r\n      \"names\": [\"O_ORDERPRIORITY\", \"ORDER_COUNT\"]\r\n    }\r\n  }],\r\n  \"expectedTypeUrls\": []\r\n} \n```\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0"
        }
    ]
}