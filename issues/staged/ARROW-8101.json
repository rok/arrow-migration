{
    "issue": {
        "title": "[FlightRPC][Java] Can't read/write only an empty null array",
        "body": "***Note**: This issue was originally created as [ARROW-8101](https://issues.apache.org/jira/browse/ARROW-8101). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nThis is rather an edge case, but Java/Flight fails with a table consisting of only an empty null array, since it has no buffers, and Java assumes this can never happen.\r\n\r\n```\n\r\nException in thread \"main\" org.apache.arrow.flight.FlightRuntimeException: CallStatus{code=CANCELLED, cause=java.lang.RuntimeException: Unexpected IO Exception, description='Failed to stream message'}\r\n\tat org.apache.arrow.flight.CallStatus.toRuntimeException(CallStatus.java:113)\r\n\tat org.apache.arrow.flight.grpc.StatusUtils.fromGrpcRuntimeException(StatusUtils.java:134)\r\n\tat org.apache.arrow.flight.grpc.StatusUtils.fromThrowable(StatusUtils.java:142)\r\n\tat org.apache.arrow.flight.FlightClient$SetStreamObserver.onError(FlightClient.java:315)\r\n\tat io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onClose(ClientCalls.java:442)\r\n\tat io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)\r\n\tat io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)\r\n\tat io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40)\r\n\tat org.apache.arrow.flight.grpc.ClientInterceptorAdapter$FlightClientCallListener.onClose(ClientInterceptorAdapter.java:117)\r\n\tat io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)\r\n\tat io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)\r\n\tat io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40)\r\n\tat io.grpc.internal.CensusStatsModule$StatsClientInterceptor$1$1.onClose(CensusStatsModule.java:700)\r\n\tat io.grpc.PartialForwardingClientCallListener.onClose(PartialForwardingClientCallListener.java:39)\r\n\tat io.grpc.ForwardingClientCallListener.onClose(ForwardingClientCallListener.java:23)\r\n\tat io.grpc.ForwardingClientCallListener$SimpleForwardingClientCallListener.onClose(ForwardingClientCallListener.java:40)\r\n\tat io.grpc.internal.CensusTracingModule$TracingClientInterceptor$1$1.onClose(CensusTracingModule.java:399)\r\n\tat io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:510)\r\n\tat io.grpc.internal.ClientCallImpl.access$300(ClientCallImpl.java:66)\r\n\tat io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.close(ClientCallImpl.java:630)\r\n\tat io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.access$700(ClientCallImpl.java:518)\r\n\tat io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInternal(ClientCallImpl.java:692)\r\n\tat io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:681)\r\n\tat io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)\r\n\tat io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.lang.RuntimeException: Unexpected IO Exception\r\n\tat org.apache.arrow.flight.ArrowMessage.asInputStream(ArrowMessage.java:334)\r\n\tat org.apache.arrow.flight.ArrowMessage.access$000(ArrowMessage.java:64)\r\n\tat org.apache.arrow.flight.ArrowMessage$ArrowMessageHolderMarshaller.stream(ArrowMessage.java:382)\r\n\tat org.apache.arrow.flight.ArrowMessage$ArrowMessageHolderMarshaller.stream(ArrowMessage.java:372)\r\n\tat io.grpc.MethodDescriptor.streamRequest(MethodDescriptor.java:290)\r\n\tat io.grpc.internal.ClientCallImpl.sendMessageInternal(ClientCallImpl.java:473)\r\n\tat io.grpc.internal.ClientCallImpl.sendMessage(ClientCallImpl.java:457)\r\n\tat io.grpc.ForwardingClientCall.sendMessage(ForwardingClientCall.java:37)\r\n\tat io.grpc.ForwardingClientCall.sendMessage(ForwardingClientCall.java:37)\r\n\tat io.grpc.ForwardingClientCall.sendMessage(ForwardingClientCall.java:37)\r\n\tat io.grpc.stub.ClientCalls$CallToStreamObserverAdapter.onNext(ClientCalls.java:341)\r\n\tat org.apache.arrow.flight.FlightClient$PutObserver.putNext(FlightClient.java:354)\r\n\tat org.apache.arrow.flight.example.integration.IntegrationTestClient.testStream(IntegrationTestClient.java:132)\r\n\tat org.apache.arrow.flight.example.integration.IntegrationTestClient.run(IntegrationTestClient.java:96)\r\n\tat org.apache.arrow.flight.example.integration.IntegrationTestClient.main(IntegrationTestClient.java:69)\r\nCaused by: java.lang.IllegalArgumentException\r\n\tat org.apache.arrow.util.Preconditions.checkArgument(Preconditions.java:122)\r\n\tat org.apache.arrow.flight.ArrowMessage.asInputStream(ArrowMessage.java:294)\r\n\t... 14 more\r\n```",
        "created_at": "2020-03-12T20:37:37.000Z",
        "updated_at": "2020-03-17T23:11:09.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: FlightRPC",
            "Component: Java",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-03-17T23:11:09.000Z"
    },
    "comments": [
        {
            "created_at": "2020-03-17T23:11:09.792Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8101?focusedCommentId=17061244) by Wes McKinney (wesm):*\nIssue resolved by pull request 6602\n<https://github.com/apache/arrow/pull/6602>"
        }
    ]
}