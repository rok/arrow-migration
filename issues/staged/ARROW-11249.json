{
    "issue": {
        "title": "[R] installation failure on CentOS 7 with bad/missing unzip",
        "body": "***Note**: This issue was originally created as [ARROW-11249](https://issues.apache.org/jira/browse/ARROW-11249). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nI am experiencing some problems with installing the 'arrow' package on my Red Hat linux server. It looks like my issues and setup are very closely related to the ones described in this ticket:\r\n https://issues.apache.org/jira/browse/ARROW-8586\r\n\r\nHowever, even if the issue is marked as resolved, and I tried installing arrow package version 0.17.0 with the fixes mentioned, it still doesn't work. Any advice would be greatly appreciated!\r\n\r\nHere are the environment variables I have set:\r\n```java\n\r\ng020029@~ $ echo $CC\r\n /usr/bin/gcc\r\n g020029@~ $ echo $CXX\r\n /usr/bin/g++\r\n g020029@~ $ echo $LIBARROW_BINARY\r\n centos-7\r\n g020029@~ $ echo $ARROW_R_DEV\r\n true\n```\r\n\r\nI am not using devtools-8, which was reported as a possible issue in the other ticket.\r\n```java\n\r\ng020029@~ $ which gcc\r\n/usr/bin/gcc\r\ng020029@~ $ /usr/bin/gcc --version\r\ngcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-39)\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions. There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\ng020029@~ $ which g++\r\n/usr/bin/g++\r\ng020029@~ $ /usr/bin/g++ --version\r\ng++ (GCC) 4.8.5 20150623 (Red Hat 4.8.5-39)\r\nCopyright (C) 2015 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions. There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n```\r\n\u00a0\r\n\r\n\r\nIf it is important, here is the lsb version.\r\n```java\n\r\ng020029@~ $ lsb_release -rs\r\n7.5\n```\r\n\r\nFinally, here is the output from the installation with a test-run afterwards. (Looks like the output isn't more verbose even if ARROW_R_DEV is set to true).\r\n\r\n\u00a0\r\n```java\n\r\n> install.packages(\"arrow\", repos=\"https://cran.uib.no/\")\r\nInstalling package into \u2018/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5\u2019\r\n(as \u2018lib\u2019 is unspecified)\r\n % Total % Received % Xferd Average Speed Time Time Time Current\r\n Dload Upload Total Spent Left Speed\r\n100 315k 100 315k 0 0 292k 0 0:00:01 0:00:01 --:--:-- 292k\r\n* installing *source* package \u2018arrow\u2019 ...\r\n** package \u2018arrow\u2019 successfully unpacked and MD5 sums checked\r\n % Total % Received % Xferd Average Speed Time Time Time Current\r\n Dload Upload Total Spent Left Speed\r\n100 33 0 33 0 0 49 0 --:--:-- --:--:-- --:--:-- 49\r\n*** Successfully retrieved C++ binaries for centos-7\r\nWarning message:\r\nIn unzip(bin_file, exdir = dst_dir) : error 1 in extracting from zip file\r\n------------------------- NOTE ---------------------------\r\nAfter installation, please run arrow::install_arrow()\r\nfor help installing required runtime libraries\r\n---------------------------------------------------------\r\n** libs\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shar ed/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPL EMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c array.cpp -o array.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shar ed/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPL EMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c array_from_vector.cpp -o array_from_vector.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shar ed/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPL EMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c array_to_vector.cpp -o a rray_to_vector.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_ 64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATIO N -g -O2 -c arraydata.cpp -o arraydata.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_ 64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATIO N -g -O2 -c arrowExports.cpp -o arrowExports.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_ 64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATIO N -g -O2 -c buffer.cpp -o buffer.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c chunkedarray.cpp -o chunkedarray.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c compression.cpp -o compression.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c compute.cpp -o compute.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c csv.cpp -o csv.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c dataset.cpp -o dataset.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c datatype.cpp -o datatype.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pcENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c expression.cpp -o expression.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c feather.cpp -o feather.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c field.cpp -o field.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c filesystem.cpp -o filesystem.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c imports.cpp -o imports.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c io.cpp -o io.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c json.cpp -o json.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c memorypool.cpp -o memorypool.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c message.cpp -o message.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c parquet.cpp -o parquet.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c py-to-r.cpp -o py-to-r.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c recordbatch.cpp -o recordbatch.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c recordbatchreader.cpp -o recordbatchreader.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c recordbatchwriter.cpp -o recordbatchwriter.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c scalar.cpp -o scalar.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c schema.cpp -o schema.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c symbols.cpp -o symbols.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c table.cpp -o table.o\r\ng++ -std=gnu++11 -I/opt/microsoft/ropen/3.5.1/lib64/R/include -DNDEBUG -I\"/shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/cpp11/include\" -DU_STATIC_IMPLEMENTATION -fpic -DU_STATIC_IMPLEMENTATION -g -O2 -c threadpool.cpp -o threadpool.o\r\ng++ -std=gnu++11 -shared -L/opt/microsoft/ropen/3.5.1/lib64/R/lib -o arrow.so array.o array_from_vector.o array_to_vector.o arraydata.o arrowExports.o buffer.o chunkedarray.o compression.o compute.o csv.o dataset.o datatype.o expression.o feather.o field.o filesystem.o imports.o io.o json.o memorypool.o message.o parquet.o py-to-r.o recordbatch.o recordbatchreader.o recordbatchwriter.o scalar.o schema.o symbols.o table.o threadpool.o -L/opt/microsoft/ropen/3.5.1/lib64/R/lib -lR\r\ninstalling to /shared/home/G020029/R/x86_64-pc-linux-gnu-library/3.5/arrow/libs\r\n** R\r\n** inst\r\n** byte-compile and prepare package for lazy loading\r\n** help\r\n*** installing help indices\r\n** building package indices\r\n** installing vignettes\r\n** testing if installed package can be loaded\r\n* DONE (arrow)\r\nThe downloaded source packages are in\r\n \u2018/tmp/RtmpXNtt3z/downloaded_packages\u2019\r\n> library(\"arrow\")\r\nAttaching package: \u2018arrow\u2019\r\nThe following object is masked from \u2018package:utils\u2019:\r\ntimestamp\r\n> tt2 = read_parquet(file = \"/mnt_g/GF_Prising/G020029/test2.parquet\")\r\nError in io___MemoryMappedFile__Open(path, mode) :\r\n Cannot call io___MemoryMappedFile__Open(). Please use arrow::install_arrow() to install required runtime libraries.\r\n```\r\n\u00a0",
        "created_at": "2021-01-14T07:58:15.000Z",
        "updated_at": "2022-10-24T18:20:31.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-10-24T18:20:31.000Z"
    },
    "comments": [
        {
            "created_at": "2021-01-14T08:00:50.657Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11249?focusedCommentId=17264676) by Sindre Froyn (SindreF900):*\nI have tried running\u00a0**arrow::install_arrow()** and\u00a0**arrow::install_arrow(binary=\"centos-7\")**\u00a0after the installation is done, but I get the same error afterwards."
        },
        {
            "created_at": "2021-01-14T16:07:04.197Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11249?focusedCommentId=17264986) by Neal Richardson (npr):*\nOdd, it looks like it's failing to unzip the C++ binary. Try `install_arrow(binary=FALSE)` perhaps?"
        },
        {
            "created_at": "2021-01-15T11:56:07.176Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11249?focusedCommentId=17265976) by Sindre Froyn (SindreF900):*\nThanks for taking the time to reading the issue. I tried the command you suggested, but I still got the same issue, just a bit different.\r\n```java\n\r\n*** Successfully retrieved C++ source\r\n*** Proceeding without C++ dependencies\r\nWarning message:\r\nIn unzip(tf1, exdir = src_dir) : error 1 in extracting from zip file\r\n```\r\n\u00a0\r\nI will try to find out what the issue with unzip is and see if I can resolve it and report back later.\u00a0\u00a0"
        },
        {
            "created_at": "2022-10-24T18:20:31.046Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-11249?focusedCommentId=17623327) by Neal Richardson (npr):*\nA lot has changed in the package build system in the last 2 years. If you still have trouble, please open a new issue."
        }
    ]
}