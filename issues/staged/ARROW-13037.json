{
    "issue": {
        "title": "[R] Incorrect param when creating Expression crashes R",
        "body": "***Note**: This issue was originally created as [ARROW-13037](https://issues.apache.org/jira/browse/ARROW-13037). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\n**Setup**:\r\n \\* Arrow Dev version from commit 0ef2080f6be27\r\n \\* R version 4.1.0 (2021-05-18)\r\n \\* Platform: x86_64-pc-linux-gnu (64-bit)\r\n \\* Running under: Ubuntu 20.04.2 LTS\r\n\r\n**Steps to reproduce:**\r\n```java\n\r\ndevtools::load_all(\"./r\")\r\nExpression$create(\"day_of_week\", Table$create(iris))\r\n```\r\n**Expected behaviour:**\r\n\r\nSome kind of error message warning me that the second argument is wrong.\r\n\r\n**Actual behaviour:**\r\n\r\nBig long error message that entirely crashes R, which ends like this (RStudio won't let me copy and paste the rest once it's crashed!)\r\n```java\n\r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x7f48eb13a0b3]\r\n/usr/lib/rstudio/bin/rsession(+0xb167a)[0x559201a9067a]\r\n[372067:372067:20210610,174533.447567:ERROR process_memory_range.cc:86] read out of range\r\n[372067:372067:20210610,174533.447611:ERROR elf_image_reader.cc:558] missing nul-terminator\r\n[372067:372067:20210610,174533.447702:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449694:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449720:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449743:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449765:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449788:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.449812:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450021:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450043:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450231:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450259:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450281:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450303:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450323:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450344:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450366:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450390:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450412:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450434:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450454:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450475:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450499:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450522:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450547:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450568:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450591:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450611:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450633:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450654:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450675:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372067:20210610,174533.450699:ERROR elf_dynamic_array_reader.h:61] tag not found\r\n[372067:372068:20210610,174533.452365:ERROR directory_reader_posix.cc:42] opendir: No such file or directory (2)\u00a0\u00a0\u00a0\r\n```\r\nThere is also some stuff about `libR.so` higher up in the error message.",
        "created_at": "2021-06-10T16:53:13.000Z",
        "updated_at": "2021-06-24T15:15:46.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2021-06-24T15:15:34.000Z"
    },
    "comments": [
        {
            "created_at": "2021-06-10T17:25:08.756Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-13037?focusedCommentId=17361110) by Neal Richardson (npr):*\nMost crashes/segfaults like this from R are when you pass an externalptr of the wrong type to a function. A type mismatch involving normal R inputs is generally handled fine (e.g. you provide a character vector but the C++ function signature expects int), but this static type checking doesn't catch when (as in this example) you pass a Table to a function that expects an Expression.\r\n\r\nI think you'll see where the missing validation should go, but LMK if you need a pointer."
        },
        {
            "created_at": "2021-06-24T15:15:34.471Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-13037?focusedCommentId=17368924) by Neal Richardson (npr):*\nIssue resolved by pull request 10584\n<https://github.com/apache/arrow/pull/10584>"
        }
    ]
}