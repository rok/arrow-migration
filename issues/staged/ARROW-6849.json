{
    "issue": {
        "title": "[Python] can not read a parquet store containing a list of integers ",
        "body": "***Note**: This issue was originally created as [ARROW-6849](https://issues.apache.org/jira/browse/ARROW-6849). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nA field having a type of list-of-ints can not be read using `parrow.parquet.read_table` function. Also failed with other field types (observed strings, for example).\r\n\r\nThis happens only in pyarrow 0.15.0. When downgrading to 0.14.1, the issue is not observed.\r\n\r\npyspark version: 2.4.4[test_bad_parquet.tgz](test_bad_parquet.tgz)\r\n\r\nMinimal snippet to reproduce the issue:\r\n\r\n\u00a0\r\n```java\n\r\nimport pyarrow.parquet as pq\r\nfrom pyspark.sql import SparkSession\r\nfrom pyspark.sql.types import StructType, StructField, IntegerType, ArrayType, Row\r\n\r\noutput_url = '/tmp/test_bad_parquet'\r\nspark = SparkSession.builder.getOrCreate()\r\n\r\nschema = StructType([StructField('int_fixed_size_list', ArrayType(IntegerType(), False), False)])\r\nrows = [Row(int_fixed_size_list=[1, 2, 3])]\r\ndataframe = spark.createDataFrame(rows, schema).write.mode('overwrite').parquet(output_url)\r\n\r\npq.read_table(output_url)\r\n\r\n```\r\nI get an error:\r\n```java\n\r\nTraceback (most recent call last):\r\n  File \"/home/yevgeni/uatc/dataset-toolkit/repro_failure.py\", line 13, in <module>\r\n    pq.read_table(output_url)\r\n  File \"/home/yevgeni/uatc/.petastorm3.6/lib/python3.6/site-packages/pyarrow/parquet.py\", line 1281, in read_table\r\n    use_pandas_metadata=use_pandas_metadata)\r\n  File \"/home/yevgeni/uatc/.petastorm3.6/lib/python3.6/site-packages/pyarrow/parquet.py\", line 1137, in read\r\n    use_pandas_metadata=use_pandas_metadata)\r\n  File \"/home/yevgeni/uatc/.petastorm3.6/lib/python3.6/site-packages/pyarrow/parquet.py\", line 605, in read\r\n    table = reader.read(**options)\r\n  File \"/home/yevgeni/uatc/.petastorm3.6/lib/python3.6/site-packages/pyarrow/parquet.py\", line 253, in read\r\n    use_threads=use_threads)\r\n  File \"pyarrow/_parquet.pyx\", line 1136, in pyarrow._parquet.ParquetReader.read_all\r\n  File \"pyarrow/error.pxi\", line 78, in pyarrow.lib.check_status\r\npyarrow.lib.ArrowInvalid: Column data for field 0 with type list<item: int32 not null> is inconsistent with schema list<element: int32 not null>Process finished with exit code 1\r\n\r\n```\r\n\u00a0\r\n\r\nColumn data for field 0 with type list<item: int32 not null> is inconsistent with schema list<element: int32 not null>\r\n\r\n\u00a0\r\n\r\nA parquet store, as generated by the snippet is attached.",
        "created_at": "2019-10-11T04:26:50.000Z",
        "updated_at": "2019-10-11T07:11:01.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2019-10-11T07:11:01.000Z"
    },
    "comments": [
        {
            "created_at": "2019-10-11T07:10:43.367Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-6849?focusedCommentId=16949201) by Joris Van den Bossche (jorisvandenbossche):*\n`[~selitvin]` thanks for the issue report and reproducible example! \r\nThis is indeed a regression in 0.15.0, see ARROW-6844. Going to close this issue as duplicate in favor of ARROW-6844"
        }
    ]
}