{
    "issue": {
        "title": "[Python][ppc64le][cuda] pytest segfault - test_cuda.py/test_foreign_buffer",
        "body": "***Note**: This issue was originally created as [ARROW-16009](https://issues.apache.org/jira/browse/ARROW-16009). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nI tried to build and test pyarrow on ppc64le platform with CUDA.\r\nI encounter segmentation fault at\u00a0[test_cuda.py/test_foreign_buffer#L292](https://github.com/apache/arrow/blob/e90472e35b40f58b17d408438bb8de1641bfe6ef/python/pyarrow/tests/test_cuda.py#L292).\r\nIf i comment out the test_foreign_buffer, then rest of the tests pass successfully.\r\n\r\nI'm sharing steps i followed and log `{}p11-arrow.zip{`}.\r\n \\* \r\n## STEPS\r\n----\r\n`{{{}mkdir p11-arrow-repo{`}\r\n`cd p11-arrow-repo`\r\n`git clone [https://github.com/apache/arrow.git]`\r\n`cd arrow`\r\n`git checkout apache-arrow-7.0.0`\r\n`# Not available: benchmark (conda_env_cpp.txt) - Removed for now.`\r\n`vim ci/conda_env_cpp.txt`\r\n`git diff ci/conda_env_cpp.txt`\r\n`{}cd ..{`}}}\r\n`{{{}conda create -y -n p11-arrow -c conda-forge{`}\r\n`{}conda activate p11-arrow{`}`{}conda install -y -c conda-forge {{`}}\r\n{\\{\u00a0 \u00a0 --file arrow/ci/conda_env_unix.txt }}\r\n{\\{\u00a0 \u00a0 --file arrow/ci/conda_env_cpp.txt }}\r\n{\\{\u00a0 \u00a0 --file arrow/ci/conda_env_python.txt }}\r\n{\\{\u00a0 \u00a0 --file arrow/ci/conda_env_gandiva.txt }}\r\n{\\{\u00a0 \u00a0 compilers }}\r\n{\\{\u00a0 \u00a0 python=3.9 }}\r\n`{}\u00a0 \u00a0 pandas{`}`{}conda install -y -c conda-forge cudatoolkit=11.2{`}}}\r\n`{{{}pushd arrow{`}\r\n`git submodule init`\r\n`git submodule update`\r\n`export PARQUET_TEST_DATA=\"${PWD}/cpp/submodules/parquet-testing/data\"`\r\n`export ARROW_TEST_DATA=\"${PWD}/testing/data\"`\r\n`{}popd{`}`{}# CPP{`}\r\n`export ARROW_HOME=$CONDA_PREFIX`\r\n`{}export LD_LIBRARY_PATH=$CONDA_PREFIX/lib{`}`{}mkdir arrow/cpp/build{`}\r\n`{}pushd arrow/cpp/build{`}`{}cmake -DCMAKE_INSTALL_PREFIX=$ARROW_HOME {{`}}\r\n{\\{\u00a0 \u00a0 \u00a0 -DCMAKE_INSTALL_LIBDIR=lib }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DCMAKE_BUILD_TYPE=release }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_BZ2=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_ZLIB=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_ZSTD=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_LZ4=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_SNAPPY=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_WITH_BROTLI=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_PARQUET=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_PYTHON=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_BUILD_TESTS=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_ORC=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_DATASET=ON }}\r\n{\\{\u00a0 \u00a0 \u00a0 -DARROW_HDFS=ON }}\r\n`{}\u00a0 \u00a0 \u00a0 -DARROW_CUDA=ON -DARROW_EXTRA_ERROR_CONTEXT=ON ..{`}}}\r\n`{{{}make -j 4{`}\r\n`make install`\r\n`ctest`\r\n`{}popd{`}}}\r\n\u00a0\r\n`{{{}# Python{`}\r\n`pushd arrow/python`\r\n`export PYARROW_WITH_PARQUET=1`\r\n`export PYARROW_WITH_CUDA=1`\r\n`export PYARROW_WITH_ORC=1`\r\n`export PYARROW_WITH_DATASET=1`\r\n`export PYARROW_WITH_HDFS=1`\r\n`python setup.py build_ext --inplace`\r\n`python setup.py install`\r\n`pip install -e . --no-build-isolation`\r\n`pytest -v`\r\n`{}popd{`}}}",
        "created_at": "2022-03-23T09:19:27.000Z",
        "updated_at": "2022-03-23T09:28:35.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2022-03-23T09:28:35.931Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16009?focusedCommentId=17511148) by Antoine Pitrou (apitrou):*\n`[~pearu]`"
        }
    ]
}