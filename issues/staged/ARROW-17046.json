{
    "issue": {
        "title": "[Python] pyarrow.parquet.write_to_dataset fails to pass kwargs to write_table function",
        "body": "***Note**: This issue was originally created as [ARROW-17046](https://issues.apache.org/jira/browse/ARROW-17046). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nAccording to PyArrow 8.0.0 [documentation](https://arrow.apache.org/docs/python/generated/pyarrow.parquet.write_to_dataset.html) `kwargs` is \"Additional kwargs for `write_table` function.\" However when I try to pass additional arguments, for example `{}flavor{`}, to the underlying write_table I get the following error\r\n```java\n\r\nTypeError: unexpected parquet write option: flavor\n```\r\nThis used to work in PyArrow versions as late as 7.0.0 but started to break in 8.0.0.\r\n\r\nMinimal example to reproduce the error\r\n```java\n\r\nimport pyarrow as pa\r\nimport pandas as pd\r\nimport pyarrow.parquet as pq\r\n\r\ndf = pd.DataFrame({'a': [1, 2], 'b': [3, 4]})\r\ntb = pa.Table.from_pandas(df)\r\npq.write_to_dataset(tb, \"test.parquet\", flavor=\"spark\") \n```",
        "created_at": "2022-07-12T04:09:19.000Z",
        "updated_at": "2022-07-24T07:57:03.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: enhancement"
        ],
        "closed": true,
        "closed_at": "2022-07-24T07:57:03.000Z"
    },
    "comments": [
        {
            "created_at": "2022-07-12T04:51:57.705Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17565268) by Alenka Frim (alenka):*\nThe default option for `write_to_dataset` has changed from legacy implementation to new dataset implementation in https://issues.apache.org/jira/browse/ARROW-16122.\r\n\r\nTo use the legacy implementation you need to add `use_legacy_dataset=True` to `{}write_to_dataset{`}. But note that this option is deprecated, and the legacy implementation will be removed in a future version.\r\n\r\nAlso see: https://issues.apache.org/jira/browse/ARROW-16119.\r\n\r\nAs for the documentation - \\*\\*kwargs part should be clearer due to the change.\r\nI will move this issue from bug to improvement.\r\nContributions are welcome!"
        },
        {
            "created_at": "2022-07-12T04:55:46.668Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17565269) by Amir Khosroshahi (mirkhosro):*\nAfter reporting this, I examined the code and realized that this may in fact be a documentation error, rather than a bug.\r\n\r\nThe documentation can be modified to clarify that kwargs will get passed to write_table only in legacy code path, and when use_legacy_dataset is False, it will get passed to the underlying write function for the new code path instead."
        },
        {
            "created_at": "2022-07-12T04:58:41.170Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17565270) by Amir Khosroshahi (mirkhosro):*\nThanks Alenka. I posted my comment and then noticed your reply.\r\n\r\nBTW when I tried to improve documentation using the edit button I was redirected to a 404 not found page on github.\r\n\r\nThe \"Edit this page\" button takes you to: <https://github.com/apache/arrow/edit/master/docs/source/python/generated/pyarrow.parquet.write_to_dataset.rst>\r\n\r\nwhich does not seem to exist.\r\n\r\n\u00a0"
        },
        {
            "created_at": "2022-07-12T05:16:13.157Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17565271) by Alenka Frim (alenka):*\nYes, this documentation is autogenerated (reference documentation, see <https://arrow.apache.org/docs/developers/guide/documentation.html#where-to-find-the-correct-file-to-change).>\r\n\r\nYou can edit it via GitHub still, just use this link: <https://github.com/apache/arrow/blob/efd7c3a0b2a6ec9c87f80ab4120702364e531369/python/pyarrow/parquet/__init__.py#L3116-L3121> where I marked the lines that need change and on the top right corner you can click the edit button to make changes in a form of Pull Request."
        },
        {
            "created_at": "2022-07-12T14:08:23.983Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17565858) by Amir Khosroshahi (mirkhosro):*\nThe edit button is disabled with the message \"You must be on a branch to make or propose changes to this file\".\r\n\r\nWhich branch should I use to as the base for my pull request?"
        },
        {
            "created_at": "2022-07-12T22:22:23.316Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17566036) by Amir Khosroshahi (mirkhosro):*\nI created a pull request to master branch here: https://github.com/apache/arrow/compare/master...mirkhosro:arrow:patch-1"
        },
        {
            "created_at": "2022-07-13T04:23:27.321Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17566145) by Alenka Frim (alenka):*\nGreat, now you only need to click on \"Create pull request\" so that the change to the code will be visible on Apache Arrow repo as a PR.\r\n\r\nWhen setting the title of the pull request please follow the {_}second item in the guidelines{_}: <https://arrow.apache.org/docs/developers/overview.html#pull-request-and-review> so that the PR gets connected to the Jira issue."
        },
        {
            "created_at": "2022-07-13T05:10:49.818Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17566161) by Amir Khosroshahi (mirkhosro):*\nGot it. Thank you. The pull request is now actually created: https://github.com/apache/arrow/pull/13591"
        },
        {
            "created_at": "2022-07-21T08:25:44.202Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17046?focusedCommentId=17569303) by Alenka Frim (alenka):*\nIssue resolved by pull request 13591\r\nhttps://github.com/apache/arrow/pull/13591"
        }
    ]
}