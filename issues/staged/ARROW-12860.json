{
    "issue": {
        "title": "[R] Error when installing R package on Raspbian",
        "body": "***Note**: This issue was originally created as [ARROW-12860](https://issues.apache.org/jira/browse/ARROW-12860). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nPosting this on behalf of a friend who has a slight allergy to Jira - he's installed the R package via install.packages, but is getting the following error:\r\n```java\n\r\n* installing *source* package 'arrow' ...\r\n** package 'arrow' successfully unpacked and MD5 sums checked\r\n** using staged installation\r\n*** Successfully retrieved C++ source\r\n*** Building C++ libraries\r\n**** arrow  \r\nPKG_CFLAGS=-I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET\r\nPKG_LIBS=-L/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/lib -larrow_dataset -lparquet -larrow -larrow -larrow_bundled_dependencies -larrow_dataset -lparquet\r\n** libs\r\nmake[1]: Entering directory '/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/src'\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c array.cpp -o array.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c array_to_vector.cpp -o array_to_vector.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c arraydata.cpp -o arraydata.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c arrowExports.cpp -o arrowExports.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c buffer.cpp -o buffer.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c chunkedarray.cpp -o chunkedarray.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c compression.cpp -o compression.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c compute.cpp -o compute.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c csv.cpp -o csv.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c dataset.cpp -o dataset.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c datatype.cpp -o datatype.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c expression.cpp -o expression.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c feather.cpp -o feather.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c field.cpp -o field.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c filesystem.cpp -o filesystem.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c imports.cpp -o imports.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c io.cpp -o io.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c json.cpp -o json.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c memorypool.cpp -o memorypool.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c message.cpp -o message.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c parquet.cpp -o parquet.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c py-to-r.cpp -o py-to-r.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c r_to_arrow.cpp -o r_to_arrow.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c recordbatch.cpp -o recordbatch.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c recordbatchreader.cpp -o recordbatchreader.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c recordbatchwriter.cpp -o recordbatchwriter.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c runtimeinfo.cpp -o runtimeinfo.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c scalar.cpp -o scalar.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c schema.cpp -o schema.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c symbols.cpp -o symbols.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c table.cpp -o table.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c threadpool.cpp -o threadpool.o\r\ng++ -std=gnu++11 -I\"/opt/R/release/lib/R/include\" -DNDEBUG -I/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/include  -DARROW_R_WITH_ARROW -DARROW_R_WITH_PARQUET -DARROW_R_WITH_DATASET -I'/home/mds/R/r4pi/cpp11/include' -I/usr/local/include   -fpic  -g -O2  -c type_infer.cpp -o type_infer.o\r\ng++ -std=gnu++11 -shared -L/opt/R/release/lib/R/lib -L/usr/local/lib -o arrow.so array.o array_to_vector.o arraydata.o arrowExports.o buffer.o chunkedarray.o compression.o compute.o csv.o dataset.o datatype.o expression.o feather.o field.o filesystem.o imports.o io.o json.o memorypool.o message.o parquet.o py-to-r.o r_to_arrow.o recordbatch.o recordbatchreader.o recordbatchwriter.o runtimeinfo.o scalar.o schema.o symbols.o table.o threadpool.o type_infer.o -L/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/libarrow/arrow-4.0.0.1/lib -larrow_dataset -lparquet -larrow -larrow -larrow_bundled_dependencies -larrow_dataset -lparquet -L/opt/R/release/lib/R/lib -lR\r\nmake[1]: Leaving directory '/tmp/RtmpLeOMgI/R.INSTALL7a137b00b451/arrow/src'\r\ninstalling to /home/mds/R/r4pi/00LOCK-arrow/00new/arrow/libs\r\n** R\r\n** inst\r\n** byte-compile and prepare package for lazy loading\r\n** help\r\n*** installing help indices\r\n** building package indices\r\n** installing vignettes\r\n** testing if installed package can be loaded from temporary location\r\nError: package or namespace load failed for 'arrow' in dyn.load(file, DLLpath = DLLpath, ...):\r\n unable to load shared object '/home/mds/R/r4pi/00LOCK-arrow/00new/arrow/libs/arrow.so':\r\n  /home/mds/R/r4pi/00LOCK-arrow/00new/arrow/libs/arrow.so: undefined symbol: __atomic_fetch_add_8\r\nError: loading failed\r\nExecution halted\r\nERROR: loading failed\r\n* removing '/home/mds/R/r4pi/arrow'\r\nError: Build of package failed\r\n```\r\n\u00a0\r\n```java\n\r\n> sessionInfo()\r\n R version 4.1.0 (2021-05-18)\r\n Platform: armv7l-unknown-linux-gnueabihf (32-bit)\r\n Running under: Raspbian GNU/Linux 10 (buster)Matrix products: default\r\n BLAS/LAPACK: /usr/lib/arm-linux-gnueabihf/libopenblas_armv6p-r0.3.5.solocale:\r\n [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C \r\n [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8 \r\n [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8 \r\n [7] LC_PAPER=en_US.UTF-8 LC_NAME=C \r\n [9] LC_ADDRESS=C LC_TELEPHONE=C \r\n [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C attached base packages:\r\n [1] stats graphics grDevices utils datasets methods base loaded via a namespace (and not attached):\r\n [1] compiler_4.1.0\r\n```",
        "created_at": "2021-05-24T17:49:09.000Z",
        "updated_at": "2022-08-29T14:15:18.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-08-29T14:13:58.000Z"
    },
    "comments": [
        {
            "created_at": "2021-05-25T22:40:14.988Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-12860?focusedCommentId=17351376) by Nicola Crane (thisisnic):*\nResolved - needed to use additional build flags \"<font color=\"#000000\">-DARROW_CXXFLAGS=-latomic</font>\" as on Raspberry Pi linking with libatomic doesn't happen as it should (i.e. <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81358><font color=\"#333333\">\u00a0and\u00a0</font><https://github.com/alexa/avs-device-sdk/issues/1404>)"
        }
    ]
}