{
    "issue": {
        "title": "[R] Installation on RHEL 7 Cannot call io___MemoryMappedFile__Open()",
        "body": "***Note**: This issue was originally created as [ARROW-7807](https://issues.apache.org/jira/browse/ARROW-7807). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nHey Team,\r\n\r\nI've been using Arrow successfully in python through conda and have been able to write and read parquet files successfully. Now I'm trying to have R users consume some of the parquet files I've produced. They run a shared R build in a custom location, so can't use conda with their setup. We tried installing the C++ libraries system-wide and then the R library in a user's directory, but kept getting\u00a0<font color=\"#de350b\">Cannot call io</font><font color=\"#de350b\">`__MemoryMappedFile_`</font><font color=\"#de350b\">Open() </font>errors on<font color=\"#de350b\">\u00a0read_parquet()</font>. I'm not sure if we've missed a step, or where to continue debugging. Does the R package have any known issues on RHEL 7? Below are some details:\r\n\r\n\u00a0\r\n\r\nEnvironment:\r\n \\* RHEL 7.6\r\n \\* Custom local R environment in a non-default location\r\n\r\nSteps taken:\r\n1. Installed the C++ libraries first (now live in /usr/lib64) as described (v.0.16.0) in\u00a0<https://arrow.apache.org/install/>\n1. Ran <font color=\"#de350b\">`install.packages('arrow')`</font> in an interactive R session\n1. It couldn't find the C++ libraries and said\u00a0`{color:#de350b}No C++ binaries found for rhel-7{color`}\n1. Couldn't find <https://dl.bintray.com/ursalabs/arrow-r/libarrow/bin/rhel-7/arrow-0.16.0.zip>\u00a0when it tried to pull the binaries\n1. Source download didn't work due to internal github firewall rules\n1. Installed without errors, but threw\u00a0`{color:#de350b}Cannot call io{color`}<font color=\"#de350b\">`__MemoryMappedFile_`</font>`{color:#de350b}Open(){color`} error on `{color:#de350b}read_parquet(){color`}\n1. Removed the rlib/arrow directory and tried a different route\n1. Set\u00a0`{color:#de350b}LIBARROW_BINARY_DISTRO='centos-7'{color`}\n1. Set `{color:#de350b}PKG_CONFIG=/usr/lib64{color`}\n1. Ran <font color=\"#de350b\">`install.packages('arrow')`</font> in an interactive R session\n1. Binaries and package seemed to install correctly without complaints\n1. Still threw\u00a0`{color:#de350b}Cannot call {color`}<font color=\"#de350b\">{{io__MemoryMappedFile_Open{{{color:#de350b}()</font>\u00a0on\u00a0<font color=\"#de350b\">read_parquet</font>}}}}{color}",
        "created_at": "2020-02-09T23:24:36.000Z",
        "updated_at": "2020-03-16T20:17:59.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: R",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-03-16T20:17:59.000Z"
    },
    "comments": [
        {
            "created_at": "2020-02-09T23:41:03.670Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033315) by Neal Richardson (npr):*\nA few questions:\r\n\r\n1. What is the full error message and traceback from the `Cannot call io__MemoryMappedFile_Open` you're seeing?\r\n2. Can you show the R code you're running that is triggering that error, as well as session info from that?\r\n3. Can you share the stdout/logs from when the package is installing?  "
        },
        {
            "created_at": "2020-02-10T00:07:26.212Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033321) by Omar Yassin (oyassin):*\nI'll have to switch the text a little bit to remove paths\r\n\r\n\u00a0\r\n\r\n**This is the code that triggers it and the error:**\r\n\r\n```R\n\r\n> data <- read_parquet('/path/to/file.parquet') \r\nError in io___MemoryMappedFile__Open(path, mode) :\r\n\u00a0 \u00a0 Cannot call io___MemoryMappedFile__Open(). Please use arrow::install_arrow() to install required runtime libraries.\r\n```\r\n\u00a0\r\n\r\n**This is the session info:**\r\n\r\n```Java\n\r\nR version 3.3.2 (2016-10-31)\r\nPlatform: x86_64-pc-linux-gnu (64-bit)\r\nRunning under: Red Hat Enterprise Linux Server 7.6 (Maipo)\r\n\r\nlocale:\r\n[1] C\r\n\r\nattached base packages:\r\n[1] stats graphics grDevices utils datasets methods base\r\n\r\nother attached packages:\r\n[1] arrow_0.16.0\r\n\r\nloaded via a namespace (and not attached):\r\n [1] Rcpp_1.0.2 zeallot_0.1.0 crayon_1.3.4 assertthat_0.2.1\r\n [5] R6_2.4.0 backports_1.1.4 magrittr_1.5 pillar_1.4.2\r\n [9] rlang_0.4.0 vctrs_0.2.0 bit64_0.9-7 glue_1.3.1\r\n[13] purrr_0.3.3 bit_1.1-14 pkgconfig_2.0.2 tidyselect_0.2.5\r\n[17] tibble_2.1.3\r\n```\r\n\r\n\u00a0\r\n\r\n**This is the stdout from the build that relied on the system arrow c++ libraries without setting\u00a0LIBARROW_BINARY_DISTRO. The one that was directed to centos-7 skipped directly to the builds without many complaints.**\r\n\r\n\u00a0\r\n\r\n```Java\n\r\n> install.packages('arrow')                                                                                                                                              \r\nInstalling package into '{/custom/user/rlib/path}'                                                                                                                \r\n(as 'lib' is unspecified)                                                                                                                                                \r\n--- Please select a CRAN mirror for use in this session ---                                                                                                              \r\nHTTPS CRAN mirror                                                                                                                                                        \r\n                                                                                                                                                                         \r\n 1: 0-Cloud [https]                      2: Algeria [https]                                                                                                              \r\n 3: Australia (Canberra) [https]         4: Australia (Melbourne 1) [https]                                                                                              \r\n 5: Australia (Melbourne 2) [https]      6: Australia (Perth) [https]                                                                                                    \r\n 7: Austria [https]                      8: Belgium (Antwerp) [https]                                                                                                    \r\n 9: Belgium (Ghent) [https]             10: Brazil (BA) [https]                                                                                                          \r\n11: Brazil (PR) [https]                 12: Brazil (RJ) [https]                                                                                                          \r\n13: Brazil (SP 1) [https]               14: Brazil (SP 2) [https]                                                                                                        \r\n15: Bulgaria [https]                    16: Canada (BC) [https]                                                                                                          \r\n17: Canada (MB) [https]                 18: Canada (NS) [https]                                                                                                          \r\n19: Chile (Santiago) [https]            20: Chile (Temuco) [https]                                                                                                       \r\n21: China (Beijing) [https]             22: China (Hefei) [https]                                                                                                        \r\n23: China (Hong Kong) [https]           24: China (Guangzhou) [https]                                                                                                    \r\n25: China (Lanzhou) [https]             26: China (Shanghai) [https]                                                                                                     \r\n27: Colombia (Cali) [https]             28: Costa Rica [https]                                                                                                           \r\n29: Czech Republic [https]              30: Denmark [https]                                                                                                              \r\n31: East Asia [https]                   32: Ecuador (Cuenca) [https]                                                                                                     \r\n33: Ecuador (Quito) [https]             34: Estonia [https]                                                                                                              \r\n35: France (Lyon 1) [https]             36: France (Lyon 2) [https]                                                                                                      \r\n37: France (Marseille) [https]          38: France (Montpellier) [https]                                                                                                 \r\n39: Germany (Erlangen) [https]          40: Germany (G<U+00F6>ttingen) [https]                                                                                           \r\n41: Germany (M<U+00FC>nster) [https]    42: Germany (Regensburg) [https]                                                                                                 \r\n43: Greece [https]                      44: Hungary [https]                                                                                                              \r\n45: Iceland [https]                     46: Indonesia (Jakarta) [https]                                                                                                  \r\n47: Iran [https]                        48: Ireland [https]                                                                                                              \r\n49: Italy (Padua) [https]               50: Japan (Tokyo) [https]                                                                                                        \r\n51: Japan (Yonezawa) [https]            52: Korea (Busan) [https]                                                                                                        \r\n53: Korea (Gyeongsan-si) [https]        54: Korea (Seoul 1) [https]                                                                                                      \r\n55: Malaysia [https]                    56: Mexico (Mexico City) [https]                                                                                                 \r\n57: Morocco [https]                     58: New Zealand [https]                                                                                                          \r\n59: Norway [https]                      60: Philippines [https]                                                                                                          \r\n61: Russia [https]                      62: Spain (Madrid) [https]                                                                                                       \r\n63: Sweden [https]                      64: Switzerland [https]                                                                                                          \r\n65: Taiwan (Chungli) [https]            66: Turkey (Denizli) [https]                                                                                                     \r\n67: Turkey (Mersin) [https]             68: UK (Bristol) [https]                                                                                                         \r\n69: UK (London 1) [https]               70: USA (IA) [https]                                                                                                             \r\n71: USA (IN) [https]                    72: USA (KS) [https]                                                                                                             \r\n73: USA (MI 1) [https]                  74: USA (MI 2) [https]                                                                                                           \r\n75: USA (OH) [https]                    76: USA (OR) [https]                                                                                                             \r\n77: USA (TN) [https]                    78: USA (TX 1) [https]                                                                                                           \r\n79: Uruguay [https]                     80: (HTTP mirrors)                                                                                                               \r\n                                                                                                                                                                         \r\n                                                                                                                                                                         \r\nSelection: 1                                                                                                                                                             \r\ntrying URL 'https://cloud.r-project.org/src/contrib/arrow_0.16.0.tar.gz'                                                                                                 \r\nContent type 'application/x-gzip' length 212922 bytes (207 KB)                                                                                                           \r\n==================================================                                                                                                                       \r\ndownloaded 207 KB                                                                                                                                                        \r\n                                                                                                                                                                         \r\n* installing *source* package 'arrow' ...                                                                                                                                \r\n** package 'arrow' successfully unpacked and MD5 sums checked                                                                                                            \r\n*** No C++ binaries found for rhel-7                                                                                                                                     \r\n*** Successfully retrieved C++ source                                                                                                                                    \r\nchmod: cannot access '/tmp/RtmpisbeAL/file10a26194990b/cpp/build-support/*.sh': No such file or directory \r\n*** Building C++ libraries                                                                                                                                               \r\n*** Downloading cmake                                                                                                                                                    \r\nError in file(con, \"rb\") : cannot open the connection                                                                                                                    \r\nCalls: build_libarrow -> ensure_cmake -> untar -> readBin -> file                                                                                                        \r\nIn addition: Warning messages:                                                                                                                                           \r\n1: In download.file(binary_url, libfile, quiet = quietly) :                                                                                                              \r\n  URL 'https://dl.bintray.com/ursalabs/arrow-r/libarrow/bin/rhel-7/arrow-0.16.0.zip': status was '404 Not Found'                                                         \r\n2: In download.file(source_url, tf1, quiet = quietly) :                                                                                                                  \r\n  URL 'https://dl.bintray.com/ursalabs/arrow-r/libarrow/src/arrow-0.16.0.zip': status was '404 Not Found'                                                                \r\n3: In unzip(tf1, exdir = src_dir) : error 1 in extracting from zip file                                                                                                  \r\n4: In download.file(cmake_binary_url, cmake_tar, quiet = quietly) :                                                                                                      \r\n  URL 'https://github.com/Kitware/CMake/releases/download/v3.16.2/cmake-3.16.2-Linux-x86_64.tar.gz': status was 'HTTP response code said error'                          \r\n5: In file(con, \"rb\") :                                                                                                                                                  \r\n  cannot open file '/tmp/RtmpisbeAL/file10a26a78d666': No such file or directory                                                                                         \r\nExecution halted                                                                                                                                                         \r\n------------------------- NOTE ---------------------------                                                                                                               \r\nAfter installation, please run arrow::install_arrow()                                                                                                                    \r\nfor help installing required runtime libraries                                                                                                                           \r\n---------------------------------------------------------                                                                                                                \r\n** libs                                                                                                                                                                  \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c array.cpp -o array.o                                                                                                             \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c array_from_vector.cpp -o array_from_vector.o                                                                                     \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c array_to_vector.cpp -o array_to_vector.o                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c arraydata.cpp -o arraydata.o                                                                                                     \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c arrowExports.cpp -o arrowExports.o                                                                                               \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c buffer.cpp -o buffer.o                                                                                                           \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c chunkedarray.cpp -o chunkedarray.o\r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c compression.cpp -o compression.o                                                                                                 \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c compute.cpp -o compute.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c csv.cpp -o csv.o                                                                                                                 \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c dataset.cpp -o dataset.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c datatype.cpp -o datatype.o                                                                                                       \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c expression.cpp -o expression.o                                                                                                   \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c feather.cpp -o feather.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c field.cpp -o field.o                                                                                                             \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c filesystem.cpp -o filesystem.o                                                                                                   \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c io.cpp -o io.o                                                                                                                   \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c json.cpp -o json.o                                                                                                               \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c memorypool.cpp -o memorypool.o                                                                                                   \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c message.cpp -o message.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c parquet.cpp -o parquet.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatch.cpp -o recordbatch.o                                                                                                 \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatchreader.cpp -o recordbatchreader.o\r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatchwriter.cpp -o recordbatchwriter.o                                                                                     \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c schema.cpp -o schema.o                                                                                                           \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c symbols.cpp -o symbols.o                                                                                                         \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c table.cpp -o table.o                                                                                                             \r\ng++ -std=c++0x -I{/custom/path/to/shared/R/build}/lib64/R/include -DNDEBUG  -I{/custom/path/to/shared/R/build}/include -fPIC -I\"{/custom/path/to/user/home}/cod\r\ne/rlib/Rcpp/include\"   -fpic  -g -O2 -c threadpool.cpp -o threadpool.o                                                                                                   \r\ng++ -std=c++0x -shared -L{/custom/path/to/shared/R/build}/lib64/R/lib -Bdirect,--hash-style=both,-Wl,-O1 -L{/custom/path/to/shared/R/build}/lib -o arrow.\r\nso array.o array_from_vector.o array_to_vector.o arraydata.o arrowExports.o buffer.o chunkedarray.o compression.o compute.o csv.o dataset.o datatype.o expression.o feath\r\ner.o field.o filesystem.o io.o json.o memorypool.o message.o parquet.o recordbatch.o recordbatchreader.o recordbatchwriter.o schema.o symbols.o table.o threadpool.o -L{/\r\ncustom/path/to/shared/R/build}/lib64/R/lib -lR                                                                                                                   \r\ninstalling to {/custom/path/to/user/home}/code/rlib/arrow/libs                                                                                                                 \r\n** R                                                                                                                                                                     \r\n** inst                                                                                                                                                                  \r\n** preparing package for lazy loading                                                                                                                                    \r\n** help                                                                                                                                                                  \r\n*** installing help indices                                                                                                                                              \r\n** building package indices                                                                                                                                              \r\n** installing vignettes                                                                                                                                                  \r\n** testing if installed package can be loaded                                                                                                                            \r\n* DONE (arrow)                                                                                                                                                           \r\n                                                                                                                                                                         \r\nThe downloaded source packages are in                                                                                                                                    \r\n        '/tmp/RtmpdzePOS/downloaded_packages'\r\n```\r\n\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\nThanks again!"
        },
        {
            "created_at": "2020-02-10T14:49:12.687Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033651) by Omar Yassin (oyassin):*\nYou've probably noticed this from other reports, but CRAN removed the package due to policy violations"
        },
        {
            "created_at": "2020-02-10T17:45:48.362Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033800) by Neal Richardson (npr):*\nYes, I'm aware, thanks."
        },
        {
            "created_at": "2020-02-10T21:06:04.778Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033945) by Neal Richardson (npr):*\nIf setting the LIBARROW_BINARY_DISTRO to centos-7 worked, could you please make a PR to https://github.com/ursa-labs/arrow-r-nightly/blob/master/linux/distro-map.csv to add that mapping? (See https://ursalabs.org/arrow-r-nightly/articles/install.html#using-prebuilt-binaries)"
        },
        {
            "created_at": "2020-02-10T21:18:26.422Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033948) by Omar Yassin (oyassin):*\nIt made it skip the part that looks for binaries and sources, but the \"Cannot call io___MemoryMappedFile__Open()\" error was still there"
        },
        {
            "created_at": "2020-02-10T21:19:37.831Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033951) by Omar Yassin (oyassin):*\nbut I'll make a PR to that map to solve for the redhat mapping, thanks"
        },
        {
            "created_at": "2020-02-10T21:37:27.968Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17033965) by Neal Richardson (npr):*\nCan I see the installation output from where you set centos-7? The error message:\r\n\r\n```Java\n\r\nCannot call io___MemoryMappedFile__Open(). Please use arrow::install_arrow() to install required runtime libraries.\r\n```\r\n\r\nmeans that the installation/binary didn't work after all."
        },
        {
            "created_at": "2020-02-10T23:23:53.590Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17034016) by Omar Yassin (oyassin):*\nThat's what I can't tease out without knowing the C++ code myself - whether it's a problem on the C++ side, or the R side. Below is the output when I switch it to centos-7\r\n\r\n\u00a0\r\n```java\n\r\n> install.packages('https://cran.r-project.org/src/contrib/Archive/arrow/arrow_0.16.0.tar.gz')\r\nInstalling package into '/path/to/user/home/code/rlib'\r\n(as 'lib' is unspecified)\r\ninferring 'repos = NULL' from 'pkgs'\r\ntrying URL 'https://cran.r-project.org/src/contrib/Archive/arrow/arrow_0.16.0.tar.gz'\r\nContent type 'application/x-gzip' length 212922 bytes (207 KB)\r\n==================================================\r\ndownloaded 207 KB\r\n\r\n* installing *source* package 'arrow' ...\r\n** package 'arrow' successfully unpacked and MD5 sums checked\r\n*** Successfully retrieved C++ binaries for centos-7\r\n------------------------- NOTE ---------------------------\r\nAfter installation, please run arrow::install_arrow()\r\nfor help installing required runtime libraries\r\n---------------------------------------------------------\r\n** libs\r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c array.cpp -o array.o                                                                                       \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c array_from_vector.cpp -o array_from_vector.o                                                               \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c array_to_vector.cpp -o array_to_vector.o                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c arraydata.cpp -o arraydata.o                                                                               \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c arrowExports.cpp -o arrowExports.o                                                                         \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c buffer.cpp -o buffer.o                                                                                     \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c chunkedarray.cpp -o chunkedarray.o                                                                         \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c compression.cpp -o compression.o                                                                           \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c compute.cpp -o compute.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c csv.cpp -o csv.o                                                                                           \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c dataset.cpp -o dataset.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c datatype.cpp -o datatype.o                                                                                 \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c expression.cpp -o expression.o                                                                             \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c feather.cpp -o feather.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c field.cpp -o field.o                                                                                       \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c filesystem.cpp -o filesystem.o                                                                             \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c io.cpp -o io.o                                                                                             \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c json.cpp -o json.o                                                                                         \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c memorypool.cpp -o memorypool.o                                                                             \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c message.cpp -o message.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c parquet.cpp -o parquet.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatch.cpp -o recordbatch.o                                                                           \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatchreader.cpp -o recordbatchreader.o                                                               \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c recordbatchwriter.cpp -o recordbatchwriter.o                                                               \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c schema.cpp -o schema.o                                                                                     \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c symbols.cpp -o symbols.o                                                                                   \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c table.cpp -o table.o                                                                                       \r\ng++ -std=c++0x -I/custom/path/to/shared/build/lib64/R/include -DNDEBUG  -I/custom/path/to/shared/build/include -fPIC -I\"/path/to/user/home/code/rlib/Rcpp/include\"   -fpic  -g -O2 -c threadpool.cpp -o threadpool.o                                                                             \r\ng++ -std=c++0x -shared -L/custom/path/to/shared/build/lib64/R/lib -Bdirect,--hash-style=both,-Wl,-O1 -L/custom/path/to/shared/build/lib -o arrow.so array.o array_from_vector.o array_to_vector.o arraydata.o arrowExports.o buffer.o chunkedarray.o compression.o compute.o csv.o dataset.o datatype.o expression.o feather.o field.o filesystem.o io.o json.o memorypool.o message.o parquet.o recordbatch.o recordbatchreader.o recordbatchwriter.o schema.o symbols.o table.o threadpool.o -L/custom/path/to/shared/build/lib64/R/lib -lR                                                                        \r\ninstalling to /path/to/user/home/code/rlib/arrow/libs\r\n** R\r\n** inst\r\n** preparing package for lazy loading\r\n** help\r\n*** installing help indices\r\n** building package indices\r\n** installing vignettes\r\n** testing if installed package can be loaded\r\n* DONE (arrow)\r\n>\r\n```\r\n\u00a0\r\n\r\n**Same error:**\r\n```java\n\r\n> data <- read_parquet('/custom/path/to/parquet/file.parquet')                                                                                                                                                         \r\nError in io___MemoryMappedFile__Open(path, mode) :\r\n  Cannot call io___MemoryMappedFile__Open(). Please use arrow::install_arrow() to install required runtime libraries.\r\n```"
        },
        {
            "created_at": "2020-02-10T23:34:07.543Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17034024) by Neal Richardson (npr):*\nSo, the line after \"Successfully retrieved\" tells me we're failing on this check:\u00a0<https://github.com/apache/arrow/blob/master/r/configure#L125-L145>\r\n\r\nWe could try to figure out why that is, but maybe we'll have more luck (with less hacking) if we can figure out why your first attempt, using C++ libraries you installed/built on the system, didn't work. Did you try setting `PKG_CONFIG_PATH` or some of those other env vars to point to the system install?\u00a0"
        },
        {
            "created_at": "2020-02-11T01:02:55.318Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17034057) by Omar Yassin (oyassin):*\nUnfortunately, it ends up with the same error whether I set `PKG_CONFIG_PATH` as `/usr/lib64/pkgconfig` or `/usr/lib64`. Also, in case it's useful info, the C++ libraries installed on the system are also centos-7. The only other env variable that I've played around with was `LIBARROW_BINARY_DISTRO` and that produced the results we discussed earlier. I also tried spinning up a fresh rhel-7 AWS instance to test on in case this on-prem machine has something wrong with it, and I still get the same error."
        },
        {
            "created_at": "2020-02-11T21:26:06.750Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17034851) by Neal Richardson (npr):*\nIs there a minimal rhel-7 Docker image with R we can test with? (R-hub only has rhel-6.)\r\n\r\nI'm not sure how to diagnose from a distance why the system packages you said you installed aren't being found.\u00a0\r\n\r\nFWIW, there's a new 0.16.0.1 release on CRAN, and I suspect that the default behavior of building Arrow C++ from source as part of `install.packages(\"arrow\")` should work this time. Can you try that? If so, that should unblock you for now, and then if we can add a Docker image to our build matrix that reproduces the issue you experienced, we might be able to fix it."
        },
        {
            "created_at": "2020-02-11T22:45:38.312Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17034910) by Omar Yassin (oyassin):*\nThanks Neal - I'll give the new release a try, and I'll get back to you on the docker image if I manage to build one that looks like our environment and produces the same error. Thanks for taking a look!"
        },
        {
            "created_at": "2020-03-11T19:00:43.074Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17057318) by Neal Richardson (npr):*\nHi `[~oyassin]`, I think this has been addressed. Could you confirm by installing `arrow` from our nightly build repo: \r\n\r\n```r\n\r\ninstall.packages(\"arrow\", repos = c(\"https://dl.bintray.com/ursalabs/arrow-r\", getOption(\"repos\")))\r\n```"
        },
        {
            "created_at": "2020-03-16T20:17:59.217Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-7807?focusedCommentId=17060452) by Neal Richardson (npr):*\nClosing; please reopen if this is still an issue"
        }
    ]
}