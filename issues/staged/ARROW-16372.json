{
    "issue": {
        "title": "[Python] Tests failing on s390x because they use Parquet",
        "body": "***Note**: This issue was originally created as [ARROW-16372](https://issues.apache.org/jira/browse/ARROW-16372). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nIf I understand correctly, the Parquet implementation does not work on big-endian? So these tests need to be properly marked?\r\n\r\nhttps://app.travis-ci.com/github/apache/arrow/jobs/568309096\r\n\r\n```\n\r\n=================================== FAILURES ===================================\r\n\r\n______________________________ test_dataset_join _______________________________\r\n\r\ntempdir = PosixPath('/tmp/pytest-of-root/pytest-0/test_dataset_join0')\r\n\r\n    @pytest.mark.dataset\r\n\r\n    def test_dataset_join(tempdir):\r\n\r\n        t1 = pa.table({\r\n\r\n            \"colA\": [1, 2, 6],\r\n\r\n            \"col2\": [\"a\", \"b\", \"f\"]\r\n\r\n        })\r\n\r\n>       ds.write_dataset(t1, tempdir / \"t1\", format=\"parquet\")\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/tests/test_dataset.py:4428: \r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:880: in write_dataset\r\n\r\n    format = _ensure_format(format)\r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nobj = 'parquet'\r\n\r\n    def _ensure_format(obj):\r\n\r\n        if isinstance(obj, FileFormat):\r\n\r\n            return obj\r\n\r\n        elif obj == \"parquet\":\r\n\r\n            if not _parquet_available:\r\n\r\n>               raise ValueError(_parquet_msg)\r\n\r\nE               ValueError: The pyarrow installation is not built with support for the Parquet file format.\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:283: ValueError\r\n\r\n_________________________ test_dataset_join_unique_key _________________________\r\n\r\ntempdir = PosixPath('/tmp/pytest-of-root/pytest-0/test_dataset_join_unique_key0')\r\n\r\n    @pytest.mark.dataset\r\n\r\n    def test_dataset_join_unique_key(tempdir):\r\n\r\n        t1 = pa.table({\r\n\r\n            \"colA\": [1, 2, 6],\r\n\r\n            \"col2\": [\"a\", \"b\", \"f\"]\r\n\r\n        })\r\n\r\n>       ds.write_dataset(t1, tempdir / \"t1\", format=\"parquet\")\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/tests/test_dataset.py:4459: \r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:880: in write_dataset\r\n\r\n    format = _ensure_format(format)\r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nobj = 'parquet'\r\n\r\n    def _ensure_format(obj):\r\n\r\n        if isinstance(obj, FileFormat):\r\n\r\n            return obj\r\n\r\n        elif obj == \"parquet\":\r\n\r\n            if not _parquet_available:\r\n\r\n>               raise ValueError(_parquet_msg)\r\n\r\nE               ValueError: The pyarrow installation is not built with support for the Parquet file format.\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:283: ValueError\r\n\r\n_________________________ test_dataset_join_collisions _________________________\r\n\r\ntempdir = PosixPath('/tmp/pytest-of-root/pytest-0/test_dataset_join_collisions0')\r\n\r\n    @pytest.mark.dataset\r\n\r\n    def test_dataset_join_collisions(tempdir):\r\n\r\n        t1 = pa.table({\r\n\r\n            \"colA\": [1, 2, 6],\r\n\r\n            \"colB\": [10, 20, 60],\r\n\r\n            \"colVals\": [\"a\", \"b\", \"f\"]\r\n\r\n        })\r\n\r\n>       ds.write_dataset(t1, tempdir / \"t1\", format=\"parquet\")\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/tests/test_dataset.py:4491: \r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:880: in write_dataset\r\n\r\n    format = _ensure_format(format)\r\n\r\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n\r\nobj = 'parquet'\r\n\r\n    def _ensure_format(obj):\r\n\r\n        if isinstance(obj, FileFormat):\r\n\r\n            return obj\r\n\r\n        elif obj == \"parquet\":\r\n\r\n            if not _parquet_available:\r\n\r\n>               raise ValueError(_parquet_msg)\r\n\r\nE               ValueError: The pyarrow installation is not built with support for the Parquet file format.\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/dataset.py:283: ValueError\r\n\r\n_________________________ test_parquet_invalid_version _________________________\r\n\r\ntempdir = PosixPath('/tmp/pytest-of-root/pytest-0/test_parquet_invalid_version0')\r\n\r\n    def test_parquet_invalid_version(tempdir):\r\n\r\n        table = pa.table({'a': [1, 2, 3]})\r\n\r\n        with pytest.raises(ValueError, match=\"Unsupported Parquet format version\"):\r\n\r\n>           _write_table(table, tempdir / 'test_version.parquet', version=\"2.2\")\r\n\r\nE           NameError: name '_write_table' is not defined\r\n\r\nusr/local/lib/python3.8/dist-packages/pyarrow/tests/parquet/test_basic.py:52: NameError\n```",
        "created_at": "2022-04-27T13:01:18.000Z",
        "updated_at": "2022-05-31T18:31:58.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Continuous Integration",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-05-31T12:24:39.000Z"
    },
    "comments": [
        {
            "created_at": "2022-04-27T13:22:55.629Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16372?focusedCommentId=17528790) by Antoine Pitrou (apitrou):*\n> If I understand correctly, the Parquet implementation does not work on big-endian?\r\n\r\nThat is right."
        },
        {
            "created_at": "2022-05-26T15:52:12.508Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16372?focusedCommentId=17542547) by Alessandro Molina (amol-):*\nThe `test_parquet_invalid_version` was already solved in https://github.com/apache/arrow/pull/13243"
        },
        {
            "created_at": "2022-05-31T12:24:39.588Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16372?focusedCommentId=17544357) by Antoine Pitrou (apitrou):*\nIssue resolved by pull request 13243\n<https://github.com/apache/arrow/pull/13243>"
        }
    ]
}