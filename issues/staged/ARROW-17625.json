{
    "issue": {
        "title": "Cast error on roundtrip of categorical column to parquet and back",
        "body": "***Note**: This issue was originally created as [ARROW-17625](https://issues.apache.org/jira/browse/ARROW-17625). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWriting a table to parquet, then reading it back fails if:\r\n1. One of the columns is a dictionary (came from a pandas Categorical), **and**\n1. Passing the table's schema to `read_table`\n   \n   Failing on attempt to cast int64 into dictionary (full stack trace below).\n   \n   This seems related to ARROW-11157 - but even if losing the categorical type when reading from parquet, the reader should not barf when reading with the schema.\n   \n   Minimal example of failing code:\n   ```java\n   \n   import pandas as pd\n   import pyarrow as pa\n   import pyarrow.parquet as pq\n   import pyarrow.dataset as ds\n   a = [1,2,3,4,1,2,3,4,1,2,3,4]\n   b = [\"a\" for i in a]\n   c = [i for i in range(len(a))]\n   df = pd.DataFrame({\"a\":a, \"b\":b, \"c\":c})\n   df['a'] = df['a'].astype('category')\n   print(\"df dtypes:\\n\", df.dtypes)\n   t = pa.Table.from_pandas(df, preserve_index=True)\n   s = t.schema\n   ds.write_dataset(t, format='parquet', base_dir='./test')\n   df2 = pq.read_table('./test', schema=s).to_pandas()\n   print(\"df2 dtypes:\\n\", df2.dtypes)\n   ```\n   \u00a0\n   \n   Which gives:\u00a0\n   ```java\n   \n   df dtypes:\n    a \u00a0 \u00a0category\n   b \u00a0 \u00a0 \u00a0object\n   c \u00a0 \u00a0 \u00a0 int64\n   dtype: object\n   Traceback (most recent call last):\n   \u00a0 File \"/Users/yishai/lab/pyarrow_bug/reproduce.py\", line 20, in <module>\n     \u00a0 df2 = pq.read_table('./test', schema=s).to_pandas()\n   \u00a0 File \"/Users/yishai/lab/pyarrow_bug/venv/lib/python3.9/site-packages/pyarrow/parquet/_init_.py\", line 2827, in read_table\n   \u00a0 \u00a0 return dataset.read(columns=columns, use_threads=use_threads,\n   \u00a0 File \"/Users/yishai/lab/pyarrow_bug/venv/lib/python3.9/site-packages/pyarrow/parquet/_init_.py\", line 2473, in read\n   \u00a0 \u00a0 table = self._dataset.to_table(\n   \u00a0 File \"pyarrow/_dataset.pyx\", line 331, in pyarrow._dataset.Dataset.to_table\n   \u00a0 File \"pyarrow/_dataset.pyx\", line 2577, in pyarrow._dataset.Scanner.to_table\n   \u00a0 File \"pyarrow/error.pxi\", line 144, in pyarrow.lib.pyarrow_internal_check_status\n   \u00a0 File \"pyarrow/error.pxi\", line 121, in pyarrow.lib.check_status\n   pyarrow.lib.ArrowNotImplementedError: Unsupported cast from int64 to dictionary using function cast_dictionary\n   ```",
        "created_at": "2022-09-06T06:00:21.000Z",
        "updated_at": "2022-09-06T06:05:52.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Parquet",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": []
}