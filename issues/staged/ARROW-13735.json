{
    "issue": {
        "title": "[Python] Creating a Map array with non-default field names segfaults",
        "body": "***Note**: This issue was originally created as [ARROW-13735](https://issues.apache.org/jira/browse/ARROW-13735). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWith ARROW-13696, you can create a MapType with non-default field names (the default being \"key\" and \"value\"). \r\nHowever, when then trying to create an array with it from python tuples, it crashes:\r\n\r\n```python\n\r\n>>> t = pa.map_(pa.field(\"name\", \"string\", nullable=False), \"int64\")\r\n>>> pa.array([[('a', 1), ('b', 2)], [('c', 3)]], type=t)\r\n\r\n../src/arrow/array/array_nested.cc:192:  Check failed: self->list_type_->value_type()->Equals(data->child_data[0]->type) \r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xf0b882)[0x7f298d497882]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xf0b800)[0x7f298d497800]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xf0b822)[0x7f298d497822]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow4util8ArrowLogD1Ev+0x47)[0x7f298d497b81]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xb39d31)[0x7f298d0c5d31]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow8MapArray7SetDataERKSt10shared_ptrINS_9ArrayDataEE+0x198)[0x7f298d0c06be]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow8MapArrayC1ERKSt10shared_ptrINS_9ArrayDataEE+0x64)[0x7f298d0bed14]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN9__gnu_cxx13new_allocatorIN5arrow8MapArrayEE9constructIS2_JRKSt10shared_ptrINS1_9ArrayDataEEEEEvPT_DpOT0_+0x49)[0x7f298d1a0f13]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZNSt16allocator_traitsISaIN5arrow8MapArrayEEE9constructIS1_JRKSt10shared_ptrINS0_9ArrayDataEEEEEvRS2_PT_DpOT0_+0x38)[0x7f298d19ebe6]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZNSt23_Sp_counted_ptr_inplaceIN5arrow8MapArrayESaIS1_ELN9__gnu_cxx12_Lock_policyE2EEC1IJRKSt10shared_ptrINS0_9ArrayDataEEEEES2_DpOT_+0xaf)[0x7f298d19b547]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZNSt14__shared_countILN9__gnu_cxx12_Lock_policyE2EEC2IN5arrow8MapArrayESaIS5_EJRKSt10shared_ptrINS4_9ArrayDataEEEEERPT_St20_Sp_alloc_shared_tagIT0_EDpOT1_+0xb2)[0x7f298d195a64]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZNSt12__shared_ptrIN5arrow8MapArrayELN9__gnu_cxx12_Lock_policyE2EEC2ISaIS1_EJRKSt10shared_ptrINS0_9ArrayDataEEEEESt20_Sp_alloc_shared_tagIT_EDpOT0_+0x4c)[0x7f298d1918bc]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZNSt10shared_ptrIN5arrow8MapArrayEEC1ISaIS1_EJRKS_INS0_9ArrayDataEEEEESt20_Sp_alloc_shared_tagIT_EDpOT0_+0x39)[0x7f298d18f617]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZSt15allocate_sharedIN5arrow8MapArrayESaIS1_EJRKSt10shared_ptrINS0_9ArrayDataEEEES3_IT_ERKT0_DpOT1_+0x38)[0x7f298d18d254]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZSt11make_sharedIN5arrow8MapArrayEJRKSt10shared_ptrINS0_9ArrayDataEEEES2_IT_EDpOT0_+0x54)[0x7f298d1897b7]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xbf5d6a)[0x7f298d181d6a]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(+0xbef0f3)[0x7f298d17b0f3]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow9MakeArrayERKSt10shared_ptrINS_9ArrayDataEE+0x99)[0x7f298d173f6b]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow12ArrayBuilder6FinishEPSt10shared_ptrINS_5ArrayEE+0x115)[0x7f298d0e4ed9]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow.so.600(_ZN5arrow12ArrayBuilder6FinishEv+0x47)[0x7f298d0e4fb7]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow_python.so.600(+0x28cc91)[0x7f29d05d2c91]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow_python.so.600(+0x292774)[0x7f29d05d8774]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow_python.so.600(+0x28ca00)[0x7f29d05d2a00]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow_python.so.600(+0x288f63)[0x7f29d05cef63]\r\n/home/joris/miniconda3/envs/arrow-dev/lib/libarrow_python.so.600(_ZN5arrow2py17ConvertPySequenceEP7_objectS2_NS0_19PyConversionOptionsEPNS_10MemoryPoolE+0xa9d)[0x7f29d05cadb7]\r\n/home/joris/scipy/repos/arrow/python/pyarrow/lib.cpython-38-x86_64-linux-gnu.so(+0x1c890d)[0x7f29d08f190d]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyCFunction_Call+0x54)[0x5581d331a814]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyObject_MakeTpCall+0x31e)[0x5581d332988e]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x5683)[0x5581d33c1bb3]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyEval_EvalCodeEx+0x39)[0x5581d33a0b79]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyEval_EvalCode+0x1b)[0x5581d3442c0b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x2724be)[0x5581d34614be]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x12875b)[0x5581d331775b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x92f)[0x5581d33bce5f]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x183c23)[0x5581d3372c23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x1d3b)[0x5581d33be26b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x183c23)[0x5581d3372c23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x1d3b)[0x5581d33be26b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x183c23)[0x5581d3372c23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x196089)[0x5581d3385089]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0xa4b)[0x5581d33bcf7b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x1a7)[0x5581d33a0d27]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x92f)[0x5581d33bce5f]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x1a7)[0x5581d33a0d27]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0xa4b)[0x5581d33bcf7b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x1b2637)[0x5581d33a1637]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x1789)[0x5581d33bdcb9]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x379)[0x5581d33a0ef9]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0xa4b)[0x5581d33bcf7b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x379)[0x5581d33a0ef9]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0xa4b)[0x5581d33bcf7b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x1a7)[0x5581d33a0d27]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0xa4b)[0x5581d33bcf7b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x379)[0x5581d33a0ef9]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x1b25c1)[0x5581d33a15c1]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyObject_Call+0x5e)[0x5581d3313ace]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x21c0)[0x5581d33be6f0]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyFunction_Vectorcall+0x379)[0x5581d33a0ef9]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalFrameDefault+0x92f)[0x5581d33bce5f]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(_PyEval_EvalCodeWithName+0x2c3)[0x5581d339fb23]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyEval_EvalCodeEx+0x39)[0x5581d33a0b79]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyEval_EvalCode+0x1b)[0x5581d3442c0b]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x253ca3)[0x5581d3442ca3]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x26d8f3)[0x5581d345c8f3]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyRun_FileExFlags+0x97)[0x5581d34618a7]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(PyRun_SimpleFileExFlags+0x19c)[0x5581d3461a7c]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(Py_RunMain+0x36d)[0x5581d3461ffd]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(Py_BytesMain+0x39)[0x5581d34621b9]\r\n/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0x7f29d5c6f0b3]\r\n/home/joris/miniconda3/envs/arrow-dev/bin/python(+0x1e6d19)[0x5581d33d5d19]\r\nAborted (core dumped)\r\n```",
        "created_at": "2021-08-24T13:18:03.000Z",
        "updated_at": "2022-01-05T16:14:33.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-01-04T15:56:55.000Z"
    },
    "comments": [
        {
            "created_at": "2021-11-29T23:01:24.872Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-13735?focusedCommentId=17450761) by Will Jones (willjones127):*\n`[~amol-]` I was reproducing this segfault to test my Python/C++ debugger setup. Are you still working on this? If not I'd be happy to take over.\u00a0"
        },
        {
            "created_at": "2021-12-01T16:01:05.862Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-13735?focusedCommentId=17451903) by Alessandro Molina (amol-):*\n`[~willjones127]` you can freely take this one over, I had it as a reminder to fix it but didn't have a chance to get to it yet."
        },
        {
            "created_at": "2022-01-04T15:56:55.651Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-13735?focusedCommentId=17468702) by Antoine Pitrou (apitrou):*\nIssue resolved by pull request 11855\n<https://github.com/apache/arrow/pull/11855>"
        }
    ]
}