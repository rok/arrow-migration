{
    "issue": {
        "title": "[Python] Bug: Wrong reading of timedelta",
        "body": "***Note**: This issue was originally created as [ARROW-17893](https://issues.apache.org/jira/browse/ARROW-17893). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWhen there is a timedelta and a list of dictionary that also has timedelta as well, reading the upper timedelta in feather format sometimes gives wrong reading.\r\n\r\nbelow is an example if you check the printed results sometime it reads the upper timedelta as <font color=\"#00875a\">0 days 03:40:23 correct</font>, and sometimes as <font color=\"#de350b\">153 days 01:03:20 wrong</font>\r\n\r\nHere is the code, also it is attached as check_timedelta.py\r\n\r\n\u00a0\r\n```java\n\r\nfrom datetime import datetime, timedelta\r\nimport pandas as pd\r\nimport pyarrow.feather as feather\r\ntime_1 = datetime.fromisoformat(\"2022-04-21T10:18:12+03:00\")\r\ntime_2 = datetime.fromisoformat(\"2022-04-21T13:58:35+03:00\")\r\ndata = [\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=12, microseconds=1),\r\n\u00a0 \u00a0 },\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=1020),\r\n\u00a0 \u00a0 },\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=960),\r\n\u00a0 \u00a0 },\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=960),\r\n\u00a0 \u00a0 },\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=960),\r\n\u00a0 \u00a0 },\r\n\u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \"waiting_time\": timedelta(seconds=815, microseconds=1),\r\n\u00a0 \u00a0 },\r\n]\r\ndf = pd.DataFrame(\r\n\u00a0 \u00a0 [\r\n\u00a0 \u00a0 \u00a0 \u00a0 {\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"time_1\": time_1,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"time_2\": time_2,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"data\": data,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"timedelta_1\": time_2 - time_1,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"timedelta_2\": timedelta(hours=3, minutes=40, seconds=23),\r\n\u00a0 \u00a0 \u00a0 \u00a0 },\r\n\u00a0 \u00a0 ]\r\n)\r\n\r\nprint(\"Correct timedelta_1: \", df[\"timedelta_1\"].item())\r\nprint(\"Correct timedelta_2: \", df[\"timedelta_2\"].item())\r\n\r\nwith open(f\"records.feather.lz4\", \"wb\") as f:\r\n\u00a0 \u00a0 feather.write_feather(df, f, compression=\"lz4\")\r\n\r\nfor _ in range(10):\r\n    with open(f\"records.feather.lz4\", \"rb\") as f:\r\n\u00a0 \u00a0     print(\"Reading timedelta_1: \", feather.read_feather(f)[\"timedelta_1\"].item())\r\n\u00a0 \u00a0 \u00a0 \u00a0 print(\"Reading timedelta_2: \", feather.read_feather(f)[\"timedelta_2\"].item())\r\n```\r\n\u00a0\r\n\r\n\u00a0\r\n\r\nPrinted Results\r\n\r\n\u00a0\r\n```java\n\r\nCorrect timedelta_1: \u00a00 days 03:40:23\r\nCorrect timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a0153 days 01:03:20\r\nReading timedelta_2: \u00a0153 days 01:03:20\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a0153 days 01:03:20\r\nReading timedelta_1: \u00a0153 days 01:03:20\r\nReading timedelta_2: \u00a00 days 03:40:23\r\nReading timedelta_1: \u00a00 days 03:40:23\r\nReading timedelta_2: \u00a0153 days 01:03:20\r\nReading timedelta_1: \u00a0153 days 01:03:20\r\nReading timedelta_2: \u00a0153 days 01:03:20\r\nReading timedelta_1: \u00a0153 days 01:03:20\r\nReading timedelta_2: \u00a0153 days 01:03:20\n```\r\n\u00a0\r\n\r\n\u00a0",
        "created_at": "2022-09-29T13:04:41.000Z",
        "updated_at": "2022-11-10T04:02:55.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-11-09T16:26:42.000Z"
    },
    "comments": [
        {
            "created_at": "2022-10-26T17:54:06.702Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17893?focusedCommentId=17624646) by Alenka Frim (alenka):*\nThank you for reporting!\r\n\r\nI can reproduce this behaviour with pyarrow 8.0.0.\r\n```python\n\r\n>>> import pyarrow as pa\r\n>>> pa.__version__\r\n'8.0.0'\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  153 days 01:03:20\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  153 days 01:03:20\r\n# Reading timedelta_1:  153 days 01:03:20\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  153 days 01:03:20\r\n```\r\nbut it was apparently corrected in 9.0.0:\r\n```python\n\r\n>>> import pyarrow as pa\r\n>>> pa.__version__\r\n'9.0.0'\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n# Reading timedelta_1:  0 days 03:40:23\r\n# Reading timedelta_2:  0 days 03:40:23\r\n```\r\n\r\nI will take some time tomorrow to try and find the PR that made the change. In any case I will add a test to the codebase to have it covered."
        },
        {
            "created_at": "2022-10-27T12:21:56.670Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17893?focusedCommentId=17625072) by Alenka Frim (alenka):*\nI can confirm that the PR that solved this issue is linked to https://issues.apache.org/jira/browse/ARROW-17018.\r\nWill add a test similar to the reported example and close the issue with that."
        },
        {
            "created_at": "2022-11-09T16:26:42.540Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17893?focusedCommentId=17631155) by Joris Van den Bossche (jorisvandenbossche):*\nIssue resolved by pull request 14531\n<https://github.com/apache/arrow/pull/14531>"
        },
        {
            "created_at": "2022-11-09T23:57:16.971Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17893?focusedCommentId=17631340) by Yaser Alraddadi (gam.phon):*\nGood to hear that. Thanks"
        }
    ]
}