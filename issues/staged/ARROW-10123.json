{
    "issue": {
        "title": "[Python] `parquet.read_table` fails when `BytesIO` buffer is given as source",
        "body": "***Note**: This issue was originally created as [ARROW-10123](https://issues.apache.org/jira/browse/ARROW-10123). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\n`pyarrow.parquet.write_table` writes correctly to a `BytesIO` object. But when the same buffer is sent to `pyarrow.parquet.read_table` there is an error.\r\n\r\n\u00a0\r\n```python\n\r\nIn[28]: import pyarrow as pa\r\nIn[29]: pa.table({\"a\":[1, 2, 3]})\r\nOut[29]: \r\npyarrow.Table\r\na: int64\r\nIn[30]: table = pa.table({\"a\":[1, 2, 3]})\r\nIn[31]: table\r\nOut[31]: \r\npyarrow.Table\r\na: int64\r\nIn[32]: table['a']\r\nOut[32]: \r\n<pyarrow.lib.ChunkedArray object at 0x7f4a25cce290>\r\n[\r\n  [\r\n    1,\r\n    2,\r\n    3\r\n  ]\r\n]\r\nIn[33]: import io\r\nIn[34]: f = io.BytesIO()\r\nIn[35]: pa.parquet.write_table(table, f)\r\nIn[36]: f.seek(0)\r\nOut[36]: 0\r\nIn[37]: file_buffer = f.read()\r\nIn[38]: file_buffer\r\nOut[38]: b'PAR1\\x15\\x04\\x150\\x15.L\\x15\\x06\\x15\\x04\\x12\\x00\\x00\\x18\\x04\\x01\\x00\\t\\x01<\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x15\\x00\\x15\\x14\\x15\\x18,\\x15\\x06\\x15\\x04\\x15\\x06\\x15\\x06\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\n$\\x02\\x00\\x00\\x00\\x06\\x01\\x02\\x03$\\x00&\\xe4\\x01\\x1c\\x15\\x04\\x195\\x04\\x00\\x06\\x19\\x18\\x01a\\x15\\x02\\x16\\x06\\x16\\xda\\x01\\x16\\xdc\\x01&R&\\x08\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x19,\\x15\\x04\\x15\\x04\\x15\\x02\\x00\\x15\\x00\\x15\\x04\\x15\\x02\\x00\\x00\\x00\\x15\\x02\\x19,5\\x00\\x18\\x06schema\\x15\\x02\\x00\\x15\\x04%\\x02\\x18\\x01a\\x00\\x16\\x06\\x19\\x1c\\x19\\x1c&\\xe4\\x01\\x1c\\x15\\x04\\x195\\x04\\x00\\x06\\x19\\x18\\x01a\\x15\\x02\\x16\\x06\\x16\\xda\\x01\\x16\\xdc\\x01&R&\\x08\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x19,\\x15\\x04\\x15\\x04\\x15\\x02\\x00\\x15\\x00\\x15\\x04\\x15\\x02\\x00\\x00\\x00\\x16\\xdc\\x01\\x16\\x06&\\xe4\\x01\\x16\\xdc\\x01\\x14\\x00\\x00\\x19\\x1c\\x18\\x0cARROW:schema\\x18\\xac\\x01/////3gAAAAQAAAAAAAKAAwABgAFAAgACgAAAAABBAAMAAAACAAIAAAABAAIAAAABAAAAAEAAAAUAAAAEAAUAAgABgAHAAwAAAAQABAAAAAAAAECJAAAABQAAAAEAAAAAAAAAAgADAAIAAcACAAAAAAAAAFAAAAAAQAAAGEAAAA=\\x00\\x18\"parquet-cpp version 1.5.1-SNAPSHOT\\x19\\x1c\\x1c\\x00\\x00\\x00r\\x01\\x00\\x00PAR1'\r\nIn[40]: pa.parquet.read_table(file_buffer)\r\nException ignored in: 'pyarrow._dataset._make_file_source'\r\nTypeError: cannot construct a FileSource from b'PAR1\\x15\\x04\\x150\\x15.L\\x15\\x06\\x15\\x04\\x12\\x00\\x00\\x18\\x04\\x01\\x00\\t\\x01<\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x15\\x00\\x15\\x14\\x15\\x18,\\x15\\x06\\x15\\x04\\x15\\x06\\x15\\x06\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\n$\\x02\\x00\\x00\\x00\\x06\\x01\\x02\\x03$\\x00&\\xe4\\x01\\x1c\\x15\\x04\\x195\\x04\\x00\\x06\\x19\\x18\\x01a\\x15\\x02\\x16\\x06\\x16\\xda\\x01\\x16\\xdc\\x01&R&\\x08\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x19,\\x15\\x04\\x15\\x04\\x15\\x02\\x00\\x15\\x00\\x15\\x04\\x15\\x02\\x00\\x00\\x00\\x15\\x02\\x19,5\\x00\\x18\\x06schema\\x15\\x02\\x00\\x15\\x04%\\x02\\x18\\x01a\\x00\\x16\\x06\\x19\\x1c\\x19\\x1c&\\xe4\\x01\\x1c\\x15\\x04\\x195\\x04\\x00\\x06\\x19\\x18\\x01a\\x15\\x02\\x16\\x06\\x16\\xda\\x01\\x16\\xdc\\x01&R&\\x08\\x1c\\x18\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x16\\x00(\\x08\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x18\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x19,\\x15\\x04\\x15\\x04\\x15\\x02\\x00\\x15\\x00\\x15\\x04\\x15\\x02\\x00\\x00\\x00\\x16\\xdc\\x01\\x16\\x06&\\xe4\\x01\\x16\\xdc\\x01\\x14\\x00\\x00\\x19\\x1c\\x18\\x0cARROW:schema\\x18\\xac\\x01/////3gAAAAQAAAAAAAKAAwABgAFAAgACgAAAAABBAAMAAAACAAIAAAABAAIAAAABAAAAAEAAAAUAAAAEAAUAAgABgAHAAwAAAAQABAAAAAAAAECJAAAABQAAAAEAAAAAAAAAAgADAAIAAcACAAAAAAAAAFAAAAAAQAAAGEAAAA=\\x00\\x18\"parquet-cpp version 1.5.1-SNAPSHOT\\x19\\x1c\\x1c\\x00\\x00\\x00r\\x01\\x00\\x00PAR1'\r\nTraceback (most recent call last):\r\n  File \"/home/pgali/anaconda3/envs/cudf_dev/lib/python3.7/site-packages/IPython/core/interactiveshell.py\", line 3417, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-40-0e57dd61ae16>\", line 1, in <module>\r\n    pa.parquet.read_table(file_buffer)\r\n  File \"/home/pgali/anaconda3/envs/cudf_dev/lib/python3.7/site-packages/pyarrow/parquet.py\", line 1573, in read_table\r\n    ignore_prefixes=ignore_prefixes,\r\n  File \"/home/pgali/anaconda3/envs/cudf_dev/lib/python3.7/site-packages/pyarrow/parquet.py\", line 1411, in __init__\r\n    [fragment], schema=fragment.physical_schema,\r\n  File \"pyarrow/_dataset.pyx\", line 694, in pyarrow._dataset.Fragment.physical_schema.__get__\r\n  File \"pyarrow/error.pxi\", line 122, in pyarrow.lib.pyarrow_internal_check_status\r\n  File \"pyarrow/error.pxi\", line 84, in pyarrow.lib.check_status\r\npyarrow.lib.ArrowInvalid: Called Open() on an uninitialized FileSource\r\n\r\n```\r\n\u00a0\r\n\r\n\u00a0",
        "created_at": "2020-09-28T18:48:54.000Z",
        "updated_at": "2020-10-22T09:41:35.000Z",
        "labels": [
            "Migrated from Jira",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-10-22T09:41:35.000Z"
    },
    "comments": [
        {
            "created_at": "2020-10-22T09:40:38.955Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-10123?focusedCommentId=17218901) by Joris Van den Bossche (jorisvandenbossche):*\n`[~galipremsagar]` Late answer, but `parquet.read_table` indeed doesn't work directly with a bytes objects. Similarly as you did for `write_table`, you can use `BytesIO` to make this work.\r\n\r\nIf you wrap the plain bytes object in a `BytesIO` object, then  `read_table` will read this (using your code example):\r\n\r\n```Java\n\r\nIn [45]: pa.parquet.read_table(io.BytesIO(file_buffer))\r\nOut[45]: \r\npyarrow.Table\r\na: int64\r\n```"
        }
    ]
}