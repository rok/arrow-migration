{
    "issue": {
        "title": "[Python][Parquet] Crash on parquet.read_table on windows python 3.82",
        "body": "***Note**: This issue was originally created as [ARROW-8385](https://issues.apache.org/jira/browse/ARROW-8385). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nOn read of parquet file using pyarrow the program spontaneously exits no thrown exceptions windows only. Testing the same setup on linux (debian 10 in a Docker) reading the same parquet file is done without issue.\r\n\r\nThe follow can reproduce the crash in a python 3.8.2 environment env listed bellow but is essentially pip install pandas and pyarrow.\r\n```python\n\r\nimport pandas as pd\r\nimport pyarrow as pa\r\nimport pyarrow.parquet as pq\r\n\r\ndef test_pandas_write_read():\r\n    df_out = pd.DataFrame.from_dict([{\"A\":i} for i in range(3)])\r\n    df_out.to_parquet(\"crash.parquet\")\r\n    df_in = pd.read_parquet(\"crash.parquet\")\r\n    print(df_in)\r\n\r\ndef test_arrow_write_read():\r\n    df = pd.DataFrame.from_dict([{\"A\":i} for i in range(3)])\r\n    table_out = pa.Table.from_pandas(df)\r\n    pq.write_table(table_out, 'crash.parquet')\r\n    table_in = pq.read_table('crash.parquet')\r\n    print(table_in)\r\n\r\nif _name_ == \"_main_\":\r\n    test_pandas_write_read()\r\n    test_arrow_write_read()\r\n```\r\n\u00a0The interpreter never reaches the print statements crashing somewhere in the call on line 252 of `parquet.py` no error is thrown just spontaneous program exit.\r\n```python\n\r\n    self.reader.read_all(...\r\n```\r\nIn contrast running the same code and python environment in debian 10 there is no error reading the parquet files generated by the same windows code. The sha2sum compare equal for the crash.parquet generated running on debian and windows so something appears to be up with the read. Attached is the crash.parquet file generated on my machine.\r\n\r\nObtusely changing the `range(3)` to `range(2)` gets rid of the crash on windows.",
        "created_at": "2020-04-09T15:52:55.000Z",
        "updated_at": "2020-09-28T19:06:24.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Python",
            "Type: bug"
        ],
        "closed": false
    },
    "comments": [
        {
            "created_at": "2020-04-09T15:55:11.779Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17079511) by Wes McKinney (wesm):*\nThanks for the reproducer, will try to take a look before 0.17.0 goes out"
        },
        {
            "created_at": "2020-04-09T16:03:42.212Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17079516) by Geoff Quested-Jones (geoff3jones):*\nNo problem anything I can help with, happy to do so"
        },
        {
            "created_at": "2020-04-10T23:13:41.450Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17081027) by Wes McKinney (wesm):*\nI haven't succeeded in reproducing this (including reading the crash.parquet you attached) in a few different environments:\r\n\r\n- pip freeze matching yours and Python 3.8.2 from python.org (so not using Anaconda or conda-forge)\n- pyarrow build from master branch on Python 3.7 with full conda-forge stack\n- Python 3.8 from conda-forge but using 0.16.0 wheel \n  \n  I would guess there is something peculiar about your machine or your environment. My Windows 10 machine is relatively recent (i7-8809G GPU). What are you running?"
        },
        {
            "created_at": "2020-04-10T23:14:16.267Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17081028) by Wes McKinney (wesm):*\nI unassigned myself, when we find a way to repro or otherwise diagnose this hopefully someone else will be able to take a look"
        },
        {
            "created_at": "2020-04-11T10:42:28.649Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17081236) by Geoff Quested-Jones (geoff3jones):*\nHi Wes, thanks for looking into this, sorry for the delay in getting back to you I'm currently marooned in Bangladesh. My machine is possibly a little bit on the venerable side of things cpu: i7-3610QM ram 24 GB gpu: nvidia quadro k2000m.\r\n\r\nI have had some mixed results:\r\n \\* Following your tests above I did a conda install of pyarrow in anaconda 2020.02 python 3.8.1. This was successfully able to read without any crash. (/)\r\n \\*\\* (Python 3.8.1 (default, Mar 2 2020, 13:06:26) [MSC v.1916 64 bit (AMD64)] :: Anaconda, Inc. on win32)\r\n \\*\\* NB for this I used: `conda install -c conda-forge pyarrow`\r\n \\* I have also created fresh env in python 3.7.7 x64 (python.org) and loaded the the file un-successfully (x)\r\n \\*\\* Python 3.7.7 (tags/v3.7.7:d7c567b08f, Mar 10 2020, 10:41:24) [MSC v.1900 64 bit (AMD64)] on win32\r\n \\*\\* python -m pip install pyarrow\r\n \\* I am in the process of pulling and building the pyarrow from the git master branch and will try to see if I can reproduce here as then i might be able to step into the dll I will report back.\r\n\r\n\u00a0"
        },
        {
            "created_at": "2020-04-11T22:16:24.915Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17081565) by Wes McKinney (wesm):*\nDo you have VS2015 C++ Redistributable on this machine https://www.microsoft.com/en-us/download/details.aspx?id=48145? Your CPU isn't old enough to cause problems."
        },
        {
            "created_at": "2020-08-18T07:52:06.761Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17179447) by nitonrock (nitonrock):*\nHi,\r\n\r\nI run into the exact same problem on windows as well (python 3.7) while working fine on linux: python crashes when reading from parquet (not writing).\r\n\r\nIn fact this problem appeared since version 0.16 and I must downgrade to 0.15.1 to avoid the crash. The latest 1.0.0 does not help either."
        },
        {
            "created_at": "2020-09-28T18:27:23.363Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-8385?focusedCommentId=17203447) by Andrus (misantroop):*\nSame issue here. Calling read_table produces an exit with no exception. Feather works flawlessly. Python 3.8.5/Win10.\r\n\r\nCPU is an old (2014) dual core Pentium G3258.\r\n\r\nNo problem when using this df:\r\n <font color=\"#d4d4d4\">df\u00a0=\u00a0pd.DataFrame([</font><font color=\"#b5cea8\">11</font><font color=\"#d4d4d4\">,\u00a0</font><font color=\"#b5cea8\">22</font><font color=\"#d4d4d4\">],\u00a0</font><font color=\"#9cdcfe\">columns</font><font color=\"#d4d4d4\">=[</font><font color=\"#ce9178\">'col'</font><font color=\"#d4d4d4\">])</font>\r\n Failure with:\r\n <font color=\"#d4d4d4\">df\u00a0=\u00a0pd.DataFrame([</font><font color=\"#b5cea8\">11</font><font color=\"#d4d4d4\">,\u00a0</font><font color=\"#b5cea8\">22</font><font color=\"#d4d4d4\">,\u00a0</font><font color=\"#b5cea8\">33</font><font color=\"#d4d4d4\">],\u00a0</font><font color=\"#9cdcfe\">columns</font><font color=\"#d4d4d4\">=[</font><font color=\"#ce9178\">'col'</font><font color=\"#d4d4d4\">])</font>\r\n\r\nSO reference with example: <https://stackoverflow.com/questions/64106111/can-only-read-empty-pandas-dataframes-with-parquet/>\r\n\r\n\u00a0\r\n\r\nUpdate: Conda works\u00a0 with py 3.8.3/arrow 0.15.1"
        }
    ]
}