{
    "issue": {
        "title": "Pandas read_parquet failr on pyarrow level",
        "body": "***Note**: This issue was originally created as [ARROW-17474](https://issues.apache.org/jira/browse/ARROW-17474). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWhen reading any of the set of parquet files in pandas with pyarrow parquet engine I am getting \"terminate called without an active exception | Aborted (core dumped)\" error with a 50% chance. I have run this through gdb for the following backtrace:\r\n\r\n\u00a0\r\n\r\n#0 \u00a00x00007ffff7ad69d5 in raise () from /lib64/libc.so.6\r\n#1 \u00a00x00007ffff7abf8a4 in abort () from /lib64/libc.so.6\r\n#2 \u00a00x00007fffe6c68926 in __gnu_cxx::__verbose_terminate_handler() [clone .cold] () from /lib64/libstdc++.so.6\r\n#3 \u00a00x00007fffe6c741ac in __cxxabiv1::__terminate(void (\\*)()) () from /lib64/libstdc++.so.6\r\n#4 \u00a00x00007fffe6c74217 in std::terminate() () from /lib64/libstdc++.so.6\r\n#5 \u00a00x00007fffe6c73bcc in __gxx_personality_v0 () from /lib64/libstdc++.so.6\r\n#6 \u00a00x00007ffff497dd94 in _Unwind_ForcedUnwind_Phase2 () from /lib64/libgcc_s.so.1\r\n#7 \u00a00x00007ffff497e482 in _Unwind_ForcedUnwind () from /lib64/libgcc_s.so.1\r\n#8 \u00a00x00007ffff7a89c26 in __pthread_unwind () from /lib64/libpthread.so.0\r\n#9 \u00a00x00007ffff7a816a2 in pthread_exit () from /lib64/libpthread.so.0\r\n#10 0x00007ffff7b1f34a in pthread_exit () from /lib64/libc.so.6\r\n#11 0x00007ffff7e3657b in PyThread_exit_thread () from /lib64/libpython3.9.so.1.0\r\n#12 0x00007ffff7cc5a8d in take_gil.cold () from /lib64/libpython3.9.so.1.0\r\n#13 0x00007ffff7d8f656 in PyEval_RestoreThread () from /lib64/libpython3.9.so.1.0\r\n#14 0x00007ffff7e68480 in PyGILState_Ensure () from /lib64/libpython3.9.so.1.0\r\n#15 0x00007fffe6f000e3 in std::_Sp_counted_ptr<arrow::py::PyBuffer\\*, (__gnu_cxx::_Lock_policy)2>::_M_dispose() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_python.so.900\r\n#16 0x00007fffe7519c4a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#17 0x00007fffe751badd in arrow::Future<std::shared_ptr<arrow::Buffer> >::SetResult(arrow::Result<std::shared_ptr<arrow::Buffer> >)::\\{lambda(void\\*)#1}::_FUN(void\\*) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#18 0x00007fffe8085929 in arrow::ConcreteFutureImpl::~ConcreteFutureImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#19 0x00007fffe811da3a in arrow::io::internal::ReadRangeCache::Impl::~Impl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#20 0x00007fffe6643eda in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#21 0x00007fffe66ec05e in parquet::ParquetFileReader::~ParquetFileReader() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#22 0x00007fffe676b98a in parquet::arrow::(anonymous namespace)::FileReaderImpl::~FileReaderImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#23 0x00007fffe6643eda in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#24 0x00007fffe67c950a in std::_Function_handler<arrow::Future<std::function<arrow::Future<std::shared_ptr<arrow::RecordBatch> > ()> > (), parquet::arrow::RowGroupGenerator>::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#25 0x00007fffe67bbe8e in std::_Sp_counted_ptr_inplace<arrow::MergedGenerator<std::shared_ptr<arrow::RecordBatch> >::State, std::allocator<arrow::MergedGenerator<std::shared_ptr<arrow::RecordBatch> >::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#26 0x00007fffe6643eda in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#27 0x00007fffe67ba122 in std::_Function_handler<arrow::Future<std::shared_ptr<arrow::RecordBatch> > (), arrow::MergedGenerator<std::shared_ptr<arrow::RecordBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libparquet.so.900\r\n#28 0x00007fffdf126209 in std::_Sp_counted_ptr_inplace<arrow::dataset::SlicingGenerator::State, std::allocator<arrow::dataset::SlicingGenerator::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#29 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#30 0x00007fffdf127392 in std::_Function_handler<arrow::Future<std::shared_ptr<arrow::RecordBatch> > (), arrow::dataset::SlicingGenerator>::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#31 0x00007fffdf11b56a in std::_Sp_counted_ptr_inplace<arrow::SerialReadaheadGenerator<std::shared_ptr<arrow::RecordBatch> >::State, std::allocator<arrow::SerialReadaheadGenerator<std::shared_ptr<arrow::RecordBatch> >::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#32 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#33 0x00007fffdf126732 in std::_Function_handler<arrow::Future<std::shared_ptr<arrow::RecordBatch> > (), arrow::SerialReadaheadGenerator<std::shared_ptr<arrow::RecordBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#34 0x00007fffdf128ae6 in arrow::Future<std::function<arrow::Future<std::shared_ptr<arrow::RecordBatch> > ()> >::SetResult(arrow::Result<std::function<arrow::Future<std::shared_ptr<arrow::RecordBatch> > ()> >)::\\{lambda(void\\*)#1}::_FUN(void\\*) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#35 0x00007fffe8085929 in arrow::ConcreteFutureImpl::~ConcreteFutureImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#36 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#37 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#38 0x00007fffdf1267e2 in std::_Function_handler<arrow::Future<std::shared_ptr<arrow::RecordBatch> > (), arrow::FutureFirstGenerator<std::shared_ptr<arrow::RecordBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#39 0x00007fffdf1261d9 in std::_Sp_counted_ptr_inplace<arrow::DefaultIfEmptyGenerator<std::shared_ptr<arrow::RecordBatch> >::State, std::allocator<arrow::DefaultIfEmptyGenerator<std::shared_ptr<arrow::RecordBatch> >::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#40 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#41 0x00007fffdf127232 in std::_Function_handler<arrow::Future<std::shared_ptr<arrow::RecordBatch> > (), arrow::DefaultIfEmptyGenerator<std::shared_ptr<arrow::RecordBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#42 0x00007fffdf1261a9 in std::_Sp_counted_ptr_inplace<arrow::EnumeratingGenerator<std::shared_ptr<arrow::RecordBatch> >::State, std::allocator<arrow::EnumeratingGenerator<std::shared_ptr<arrow::RecordBatch> >::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#43 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#44 0x00007fffdf127182 in std::_Function_handler<arrow::Future<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> > > (), arrow::EnumeratingGenerator<std::shared_ptr<arrow::RecordBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#45 0x00007fffdf128a26 in arrow::Future<std::function<arrow::Future<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> > > ()> >::SetResult(arrow::Result<std::function<arrow::Future<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> > > ()> >)::\\{lambda(void\\*)#1}::_FUN(void\\*) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#46 0x00007fffe8085929 in arrow::ConcreteFutureImpl::~ConcreteFutureImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#47 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#48 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#49 0x00007fffdf1270d2 in std::_Function_handler<arrow::Future<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> > > (), arrow::FutureFirstGenerator<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> > > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#50 0x00007fffdf14a6dd in std::_Sp_counted_ptr_inplace<arrow::MappingGenerator<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> >, arrow::dataset::EnumeratedRecordBatch>::State, std::allocator<arrow::MappingGenerator<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> >, arrow::dataset::EnumeratedRecordBatch>::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#51 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#52 0x00007fffdf127022 in std::_Function_handler<arrow::Future<arrow::dataset::EnumeratedRecordBatch> (), arrow::MappingGenerator<arrow::Enumerated<std::shared_ptr<arrow::RecordBatch> >, arrow::dataset::EnumeratedRecordBatch> >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#53 0x00007fffdf12cd1e in std::_Sp_counted_ptr_inplace<arrow::MergedGenerator<arrow::dataset::EnumeratedRecordBatch>::State, std::allocator<arrow::MergedGenerator<arrow::dataset::EnumeratedRecordBatch>::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#54 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#55 0x00007fffdf1269f2 in std::_Function_handler<arrow::Future<arrow::dataset::EnumeratedRecordBatch> (), arrow::MergedGenerator<arrow::dataset::EnumeratedRecordBatch> >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#56 0x00007fffdf14a5e2 in std::_Sp_counted_ptr_inplace<arrow::ReadaheadGenerator<arrow::dataset::EnumeratedRecordBatch>::State, std::allocator<arrow::ReadaheadGenerator<arrow::dataset::EnumeratedRecordBatch>::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#57 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#58 0x00007fffdf126942 in std::_Function_handler<arrow::Future<arrow::dataset::EnumeratedRecordBatch> (), arrow::ReadaheadGenerator<arrow::dataset::EnumeratedRecordBatch> >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#59 0x00007fffdf12ba28 in std::_Sp_counted_ptr_inplace<arrow::MappingGenerator<arrow::dataset::EnumeratedRecordBatch, nonstd::optional_lite::optional<arrow::compute::ExecBatch> >::State, std::allocator<arrow::MappingGenerator<arrow::dataset::EnumeratedRecordBatch, nonstd::optional_lite::optional<arrow::compute::ExecBatch> >::State>, (__gnu_cxx::_Lock_policy)2>::_M_dispose() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#60 0x00007fffdf26493a in std::_Sp_counted_base<(__gnu_cxx::_Lock_policy)2>::_M_release() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/_dataset.cpython-39-x86_64-linux-gnu.so\r\n#61 0x00007fffdf126892 in std::_Function_handler<arrow::Future<nonstd::optional_lite::optional<arrow::compute::ExecBatch> > (), arrow::MappingGenerator<arrow::dataset::EnumeratedRecordBatch, nonstd::optional_lite::optional<arrow::compute::ExecBatch> > >::_M_manager(std::_Any_data&, std::_Any_data const&, std::_Manager_operation) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#62 0x00007fffe7e805db in arrow::compute::(anonymous namespace)::SourceNode::~SourceNode() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#63 0x00007fffe7f355e3 in arrow::compute::(anonymous namespace)::ExecPlanImpl::~ExecPlanImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#64 0x00007fffe7f35a52 in std::_Sp_counted_ptr<arrow::compute::(anonymous namespace)::ExecPlanImpl\\*, (__gnu_cxx::_Lock_policy)2>::_M_dispose() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#65 0x00007fffdf0f0a32 in arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::FnImpl<arrow::Future<arrow::internal::Empty>::WrapStatusyOnComplete::Callback<arrow::dataset::(anonymous namespace)::AsyncScanner::ScanBatchesUnorderedAsync(arrow::internal::Executor\\*, bool, bool)::\\{lambda(...)#1}::operator()(...) const::\\{lambda()#1}::operator()() const::\\{lambda(arrow::Status const&)#1}> >::~FnImpl() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow_dataset.so.900\r\n#66 0x00007fffe808a416 in arrow::ConcreteFutureImpl::DoMarkFinishedOrFailed(arrow::FutureState) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#67 0x00007fffe75b33ff in void arrow::Future<arrow::internal::Empty>::MarkFinished<arrow::internal::Empty, void>(arrow::Status) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#68 0x00007fffe7f16f25 in arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::FnImpl<arrow::Future<arrow::internal::Empty>::WrapStatusyOnComplete::Callback<arrow::compute::(anonymous namespace)::ExecPlanImpl::EndTaskGroup()::\\{lambda(arrow::Status const&)#1}> >::invoke(arrow::FutureImpl const&) ()\r\n\u00a0 \u00a0from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#69 0x00007fffe808a408 in arrow::ConcreteFutureImpl::DoMarkFinishedOrFailed(arrow::FutureState) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#70 0x00007fffe75b33ff in void arrow::Future<arrow::internal::Empty>::MarkFinished<arrow::internal::Empty, void>(arrow::Status) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#71 0x00007fffe80cf46b in arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::FnImpl<arrow::Future<arrow::internal::Empty>::WrapStatusyOnComplete::Callback<arrow::util::AsyncTaskGroup::AddTaskUnlocked(arrow::Future<arrow::internal::Empty> const&, arrow::util::Mutex::Guard)::\\{lambda(arrow::Status const&)#1}> >::invoke(arrow::FutureImpl const&) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#72 0x00007fffe808a408 in arrow::ConcreteFutureImpl::DoMarkFinishedOrFailed(arrow::FutureState) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#73 0x00007fffe75b33ff in void arrow::Future<arrow::internal::Empty>::MarkFinished<arrow::internal::Empty, void>(arrow::Status) () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#74 0x00007fffe7f3a5cd in arrow::internal::FnOnce<void ()>::FnImpl<std::_Bind<arrow::detail::ContinueFuture (arrow::Future<arrow::internal::Empty>, std::function<arrow::Status ()>)> >::invoke() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#75 0x00007fffe8066e7b in std::thread::_State_impl<std::thread::_Invoker<std::tuple<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::\\{lambda()#1}> > >::_M_run() () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#76 0x00007fffe8f7d5f0 in execute_native_thread_routine () from /home/inc/.local/lib/python3.9/site-packages/pyarrow/libarrow.so.900\r\n#77 0x00007ffff7a803f9 in start_thread () from /lib64/libpthread.so.0\r\n#78 0x00007ffff7b9ab53 in clone () from /lib64/libc.so.6",
        "created_at": "2022-08-19T09:30:29.000Z",
        "updated_at": "2022-10-19T13:09:37.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: Parquet",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-10-19T13:09:37.000Z"
    },
    "comments": [
        {
            "created_at": "2022-10-19T12:14:19.222Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17474?focusedCommentId=17620307) by Miles Granger (milesgranger):*\nBit hard to debug, do you have any code that can reproduce this or a small sample dataset? Or does it happen with any normal parquet file?"
        },
        {
            "created_at": "2022-10-19T12:46:17.735Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17474?focusedCommentId=17620335) by Amir Aliev (amiraliev):*\n`[~milesgranger]` This happens randomly, even on the same file. Might depend on filters. The file itself is large (several GB) and proprietary (comes from a third-party financial data vendor), so I won;t be able to share it, unfortunately.\r\n\r\nMy workflow is very simple, essentially get some filtered subset of the parquet file to memory and print out something on the command-line. The program always segfaults after printing correct output, so I suppose this is related to cleanup, not to the file reading itself. Also, now that I think about it, it seems the problem went away once I switched from `filters=[('field', '=', 'value'), ...]` filter of `pandas.read_parquet` to pyarrow native dataset filtering (`{}pyarrow.dataset.field.isin(...){`}). I guess that't the extent of\u00a0 guidance I can provide at the moment.\r\n\r\nAs this never happens with the files I create on my end, I suspect the vendor files might be corrupted. However, no matter how corrupt the file is, I don't believe the library should segfault."
        },
        {
            "created_at": "2022-10-19T12:55:32.313Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17474?focusedCommentId=17620346) by Miles Granger (milesgranger):*\nThanks for the response and information. I fully agree pyarrow shouldn't segfault at all, and good to hear that it seems to go away after making that change.\u00a0\r\n\r\nHowever, you might appreciate debugging/reproducing this is helpful in providing a fix first. Should you have availability to supply some script which recreates a file and subsequent operation(s) which causes the segfault it would be greatly helpful and I'd be happy to take it forward to get a fix in.\r\n\r\nIs it okay if we close this for now and maybe re-open should the issue arise again? We could hammer out a test case for it then."
        },
        {
            "created_at": "2022-10-19T12:59:00.014Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17474?focusedCommentId=17620347) by Amir Aliev (amiraliev):*\nYes that's fine with me, thank you.\n\n\n"
        }
    ]
}