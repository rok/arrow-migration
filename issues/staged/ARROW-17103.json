{
    "issue": {
        "title": "[C++][CI] arrow-dataset-scanner-test has been failing on some nightly cpp builds ",
        "body": "***Note**: This issue was originally created as [ARROW-17103](https://issues.apache.org/jira/browse/ARROW-17103). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nThere has been a couple of nightly build failures:\r\n\r\n[test-ubuntu-20.04-cpp](https://github.com/ursacomputing/crossbow/runs/7381345995?check_suite_focus=true)\r\n[test-ubuntu-20.04-cpp-14](https://github.com/ursacomputing/crossbow/runs/7381362410?check_suite_focus=true)\r\n[test-ubuntu-20.04-cpp-bundled](https://github.com/ursacomputing/crossbow/runs/7381351265?check_suite_focus=true)\r\n\r\nWhere arrow-dataset-scanner-test is failing with the following error:\r\n```java\n\r\n[ RUN \u00a0 \u00a0 \u00a0] TestScannerThreading/TestScanner.ScanBatchesFailure/2Threaded1d1b1024r\r\n/arrow/cpp/src/arrow/util/future.cc:331: \u00a0Check failed: !IsFutureFinished(state_) Future already marked finished\r\n/usr/local/lib/libarrow.so.900(arrow::util::CerrLog::PrintBackTrace()+0x39)[0x7f1608d7125f]\r\n/usr/local/lib/libarrow.so.900(arrow::util::CerrLog::~CerrLog()+0x5f)[0x7f1608d711cf]\r\n/usr/local/lib/libarrow.so.900(arrow::util::CerrLog::~CerrLog()+0x1c)[0x7f1608d711f4]\r\n/usr/local/lib/libarrow.so.900(arrow::util::ArrowLog::~ArrowLog()+0x4b)[0x7f1608d71007]\r\n/usr/local/lib/libarrow.so.900(arrow::ConcreteFutureImpl::DoMarkFinishedOrFailed(arrow::FutureState)+0x182)[0x7f1608d3bc48]\r\n/usr/local/lib/libarrow.so.900(arrow::ConcreteFutureImpl::DoMarkFailed()+0x21)[0x7f1608d3af11]\r\n/usr/local/lib/libarrow.so.900(arrow::FutureImpl::MarkFailed()+0x24)[0x7f1608d36618]\r\n/build/cpp/debug/arrow-dataset-scanner-test(arrow::Future<arrow::internal::Empty>::DoMarkFinished(arrow::Result<arrow::internal::Empty>)+0xac)[0x558c15d54542]\r\n/build/cpp/debug/arrow-dataset-scanner-test(void arrow::Future<arrow::internal::Empty>::MarkFinished<arrow::internal::Empty, void>(arrow::Status)+0x7b)[0x558c15d42aab]\r\n/usr/local/lib/libarrow.so.900(+0x215c44d)[0x7f160915c44d]\r\n/usr/local/lib/libarrow.so.900(+0x2161931)[0x7f1609161931]\r\n/usr/local/lib/libarrow.so.900(+0x216149d)[0x7f160916149d]\r\n/usr/local/lib/libarrow.so.900(+0x2161219)[0x7f1609161219]\r\n/usr/local/lib/libarrow.so.900(+0x2161111)[0x7f1609161111]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::operator()(arrow::FutureImpl const&) &&+0x72)[0x7f1608d3d3be]\r\n/usr/local/lib/libarrow.so.900(arrow::ConcreteFutureImpl::AddCallback(arrow::internal::FnOnce<void (arrow::FutureImpl const&)>, arrow::CallbackOptions)::SpanWrapper::operator()(arrow::FutureImpl const&)+0x7d)[0x7f1608d3b095]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::FnImpl<arrow::ConcreteFutureImpl::AddCallback(arrow::internal::FnOnce<void (arrow::FutureImpl const&)>, arrow::CallbackOptions)::SpanWrapper>::invoke(arrow::FutureImpl const&)+0x3f)[0x7f1608d4911b]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void (arrow::FutureImpl const&)>::operator()(arrow::FutureImpl const&) &&+0x72)[0x7f1608d3d3be]\r\n/usr/local/lib/libarrow.so.900(arrow::ConcreteFutureImpl::RunOrScheduleCallback(std::shared_ptr<arrow::FutureImpl> const&, arrow::FutureImpl::CallbackRecord&&, bool)::CallbackTask::operator()()+0x3b)[0x7f1608d3b74b]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void ()>::FnImpl<arrow::ConcreteFutureImpl::RunOrScheduleCallback(std::shared_ptr<arrow::FutureImpl> const&, arrow::FutureImpl::CallbackRecord&&, bool)::CallbackTask>::invoke()+0x28)[0x7f1608d490d8]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void ()>::operator()() &&+0x59)[0x7f1608d9506f]\r\n/usr/local/lib/libarrow.so.900(+0x1d91b91)[0x7f1608d91b91]\r\n/usr/local/lib/libarrow.so.900(+0x1d9490c)[0x7f1608d9490c]\r\n/usr/local/lib/libarrow.so.900(arrow::internal::FnOnce<void ()>::operator()() &&+0x59)[0x7f1608d9506f]\r\n/usr/local/lib/libarrow.so.900(+0x1d90ae5)[0x7f1608d90ae5]\r\n/usr/local/lib/libarrow.so.900(+0x1d91958)[0x7f1608d91958]\r\n/usr/local/lib/libarrow.so.900(+0x1d94a63)[0x7f1608d94a63]\r\n/usr/local/lib/libarrow.so.900(+0x1d94a04)[0x7f1608d94a04]\r\n/usr/local/lib/libarrow.so.900(+0x1d949a2)[0x7f1608d949a2]\r\n/usr/local/lib/libarrow.so.900(+0x1d94963)[0x7f1608d94963]\r\n/usr/local/lib/libarrow.so.900(+0x1d948e0)[0x7f1608d948e0]\r\n/lib/x86_64-linux-gnu/libstdc++.so.6(+0xd6de4)[0x7f1606eedde4]\r\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x8609)[0x7f160629e609]\r\n/lib/x86_64-linux-gnu/libc.so.6(clone+0x43)[0x7f1606d29133]\r\n/build/cpp/src/arrow/dataset \n```",
        "created_at": "2022-07-18T10:02:06.000Z",
        "updated_at": "2022-07-18T13:10:57.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-07-18T13:10:57.000Z"
    },
    "comments": [
        {
            "created_at": "2022-07-18T12:03:41.013Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17103?focusedCommentId=17567958) by David Li (lidavidm):*\nDuplicate of ARROW-17087?"
        },
        {
            "created_at": "2022-07-18T13:10:12.127Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17103?focusedCommentId=17567987) by Ra\u00fal Cumplido (raulcd):*\nYep, I'll tag the other as Nightly and will close this one.\r\n\r\nThanks `[~lidavidm]` \u00a0"
        },
        {
            "created_at": "2022-07-18T13:10:57.607Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-17103?focusedCommentId=17567989) by Ra\u00fal Cumplido (raulcd):*\nThis is a duplicate"
        }
    ]
}