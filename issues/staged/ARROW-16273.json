{
    "issue": {
        "title": "[C++] Valgrind error in arrow-compute-scalar-test",
        "body": "***Note**: This issue was originally created as [ARROW-16273](https://issues.apache.org/jira/browse/ARROW-16273). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nCurrently valgrind is failing earlier on the tpch-node-test and hash-join-node-test.  Once we fix those tests it seems the next error is this:\r\n\r\n```\n\r\n[ RUN      ] TestStringKernels/0.Strptime\r\n==9928== Conditional jump or move depends on uninitialised value(s)\r\n==9928==    at 0x411AEA2: arrow::TestInitialized(arrow::ArrayData const&) (gtest_util.cc:682)\r\n==9928==    by 0xAE1C79: arrow::compute::(anonymous namespace)::ValidateOutput(arrow::ArrayData const&) (test_util.cc:287)\r\n==9928==    by 0xAE23FC: arrow::compute::ValidateOutput(arrow::Datum const&) (test_util.cc:320)\r\n==9928==    by 0xAE4946: arrow::compute::CheckScalarNonRecursive(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::vector<arrow::Datum, std::allocator<arrow::Datum> > const&, arrow::Datum const&, arrow::compute::FunctionOptions const*) (test_util.cc:80)\r\n==9928==    by 0xAE63A4: arrow::compute::CheckScalar(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::vector<arrow::Datum, std::allocator<arrow::Datum> > const&, arrow::Datum, arrow::compute::FunctionOptions const*) (test_util.cc:108)\r\n==9928==    by 0xAE7E28: arrow::compute::CheckScalarUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::Datum, arrow::Datum, arrow::compute::FunctionOptions const*) (test_util.cc:254)\r\n==9928==    by 0xAE80D3: arrow::compute::CheckScalarUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::compute::FunctionOptions const*) (test_util.cc:260)\r\n==9928==    by 0x9F783F: arrow::compute::BaseTestStringKernels<arrow::StringType>::CheckUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::compute::FunctionOptions const*) (scalar_string_test.cc:56)\r\n==9928==    by 0xA2A62D: arrow::compute::TestStringKernels_Strptime_Test<arrow::StringType>::TestBody() (scalar_string_test.cc:1855)\r\n==9928==    by 0x64974DC: void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2607)\r\n==9928==    by 0x648E90C: void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2643)\r\n==9928==    by 0x6469CDC: testing::Test::Run() (gtest.cc:2682)\r\n==9928==    by 0x646A6FE: testing::TestInfo::Run() (gtest.cc:2861)\r\n==9928==    by 0x646B0BD: testing::TestSuite::Run() (gtest.cc:3015)\r\n==9928==    by 0x647B1DB: testing::internal::UnitTestImpl::RunAllTests() (gtest.cc:5855)\r\n==9928==    by 0x6498497: bool testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) (gtest.cc:2607)\r\n==9928==    by 0x648FAF9: bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) (gtest.cc:2643)\r\n==9928==    by 0x64796A8: testing::UnitTest::Run() (gtest.cc:5438)\r\n==9928==    by 0x4204918: RUN_ALL_TESTS() (gtest.h:2490)\r\n==9928==    by 0x420495B: main (gtest_main.cc:52)\r\n==9928== \r\n{\r\n   <insert_a_suppression_name_here>\r\n   Memcheck:Cond\r\n   fun:_ZN5arrow15TestInitializedERKNS_9ArrayDataE\r\n   fun:_ZN5arrow7compute12_GLOBAL__N_114ValidateOutputERKNS_9ArrayDataE\r\n   fun:_ZN5arrow7compute14ValidateOutputERKNS_5DatumE\r\n   fun:_ZN5arrow7compute23CheckScalarNonRecursiveERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKSt6vectorINS_5DatumESaISA_EERKSA_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute11CheckScalarENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKSt6vectorINS_5DatumESaIS8_EES8_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute16CheckScalarUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEENS_5DatumES7_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute16CheckScalarUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESt10shared_ptrINS_8DataTypeEES6_S9_S6_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute21BaseTestStringKernelsINS_10StringTypeEE10CheckUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEES9_St10shared_ptrINS_8DataTypeEES9_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute31TestStringKernels_Strptime_TestINS_10StringTypeEE8TestBodyEv\r\n   fun:_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing4Test3RunEv\r\n   fun:_ZN7testing8TestInfo3RunEv\r\n   fun:_ZN7testing9TestSuite3RunEv\r\n   fun:_ZN7testing8internal12UnitTestImpl11RunAllTestsEv\r\n   fun:_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8UnitTest3RunEv\r\n   fun:_Z13RUN_ALL_TESTSv\r\n   fun:main\r\n}\r\n==9928== Conditional jump or move depends on uninitialised value(s)\r\n==9928==    at 0x411AEA2: arrow::TestInitialized(arrow::ArrayData const&) (gtest_util.cc:682)\r\n==9928==    by 0x411AEF3: arrow::TestInitialized(arrow::Array const&) (gtest_util.cc:663)\r\n==9928==    by 0xAE1E13: arrow::compute::(anonymous namespace)::ValidateOutput(arrow::ChunkedArray const&) (test_util.cc:293)\r\n==9928==    by 0xAE240E: arrow::compute::ValidateOutput(arrow::Datum const&) (test_util.cc:323)\r\n==9928==    by 0xAE753A: arrow::compute::CheckScalar(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::vector<arrow::Datum, std::allocator<arrow::Datum> > const&, arrow::Datum, arrow::compute::FunctionOptions const*) (test_util.cc:167)\r\n==9928==    by 0xAE7E28: arrow::compute::CheckScalarUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::Datum, arrow::Datum, arrow::compute::FunctionOptions const*) (test_util.cc:254)\r\n==9928==    by 0xAE80D3: arrow::compute::CheckScalarUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::compute::FunctionOptions const*) (test_util.cc:260)\r\n==9928==    by 0x9F783F: arrow::compute::BaseTestStringKernels<arrow::StringType>::CheckUnary(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::shared_ptr<arrow::DataType>, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, arrow::compute::FunctionOptions const*) (scalar_string_test.cc:56)\r\n==9928==    by 0xA2A62D: arrow::compute::TestStringKernels_Strptime_Test<arrow::StringType>::TestBody() (scalar_string_test.cc:1855)\r\n==9928==    by 0x64974DC: void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2607)\r\n==9928==    by 0x648E90C: void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) (gtest.cc:2643)\r\n==9928==    by 0x6469CDC: testing::Test::Run() (gtest.cc:2682)\r\n==9928==    by 0x646A6FE: testing::TestInfo::Run() (gtest.cc:2861)\r\n==9928==    by 0x646B0BD: testing::TestSuite::Run() (gtest.cc:3015)\r\n==9928==    by 0x647B1DB: testing::internal::UnitTestImpl::RunAllTests() (gtest.cc:5855)\r\n==9928==    by 0x6498497: bool testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) (gtest.cc:2607)\r\n==9928==    by 0x648FAF9: bool testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool>(testing::internal::UnitTestImpl*, bool (testing::internal::UnitTestImpl::*)(), char const*) (gtest.cc:2643)\r\n==9928==    by 0x64796A8: testing::UnitTest::Run() (gtest.cc:5438)\r\n==9928==    by 0x4204918: RUN_ALL_TESTS() (gtest.h:2490)\r\n==9928==    by 0x420495B: main (gtest_main.cc:52)\r\n==9928== \r\n{\r\n   <insert_a_suppression_name_here>\r\n   Memcheck:Cond\r\n   fun:_ZN5arrow15TestInitializedERKNS_9ArrayDataE\r\n   fun:_ZN5arrow15TestInitializedERKNS_5ArrayE\r\n   fun:_ZN5arrow7compute12_GLOBAL__N_114ValidateOutputERKNS_12ChunkedArrayE\r\n   fun:_ZN5arrow7compute14ValidateOutputERKNS_5DatumE\r\n   fun:_ZN5arrow7compute11CheckScalarENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKSt6vectorINS_5DatumESaIS8_EES8_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute16CheckScalarUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEENS_5DatumES7_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute16CheckScalarUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESt10shared_ptrINS_8DataTypeEES6_S9_S6_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute21BaseTestStringKernelsINS_10StringTypeEE10CheckUnaryENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEES9_St10shared_ptrINS_8DataTypeEES9_PKNS0_15FunctionOptionsE\r\n   fun:_ZN5arrow7compute31TestStringKernels_Strptime_TestINS_10StringTypeEE8TestBodyEv\r\n   fun:_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS_4TestEvEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing4Test3RunEv\r\n   fun:_ZN7testing8TestInfo3RunEv\r\n   fun:_ZN7testing9TestSuite3RunEv\r\n   fun:_ZN7testing8internal12UnitTestImpl11RunAllTestsEv\r\n   fun:_ZN7testing8internal38HandleSehExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8internal35HandleExceptionsInMethodIfSupportedINS0_12UnitTestImplEbEET0_PT_MS4_FS3_vEPKc\r\n   fun:_ZN7testing8UnitTest3RunEv\r\n   fun:_Z13RUN_ALL_TESTSv\r\n   fun:main\r\n}\r\n[       OK ] TestStringKernels/0.Strptime (45 ms)\r\n```",
        "created_at": "2022-04-21T20:34:14.000Z",
        "updated_at": "2022-04-25T09:27:06.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: Continuous Integration",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-04-25T09:27:06.000Z"
    },
    "comments": [
        {
            "created_at": "2022-04-22T22:47:12.305Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16273?focusedCommentId=17526712) by Weston Pace (westonpace):*\nI have not been able to reproduce this and it appears the nightly valgrind is now passing.  I'm not sure if some issue got fixed concurrently or if this is just flaky."
        },
        {
            "created_at": "2022-04-25T09:27:06.690Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-16273?focusedCommentId=17527394) by Antoine Pitrou (apitrou):*\nYes, it should have been fixed in ARROW-16185 already."
        }
    ]
}