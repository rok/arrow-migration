{
    "issue": {
        "title": "[Python] Sustrait-related test failure in wheel tests",
        "body": "***Note**: This issue was originally created as [ARROW-18041](https://issues.apache.org/jira/browse/ARROW-18041). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nSee https://github.com/ursacomputing/crossbow/actions/runs/3240936478/jobs/5312200303#step:7:341\r\n\r\n```Java\n\r\n\r\n2022-10-13T09:42:51.5203618Z __________________________ test_run_serialized_query __________________________\r\n2022-10-13T09:42:51.5203890Z \r\n2022-10-13T09:42:51.5204391Z tmpdir = local('C:\\\\Users\\\\ContainerAdministrator\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-ContainerAdministrator\\\\pytest-0\\\\test_run_serialized_query0')\r\n2022-10-13T09:42:51.5205282Z \r\n2022-10-13T09:42:51.5205769Z     def test_run_serialized_query(tmpdir):\r\n2022-10-13T09:42:51.5206172Z         substrait_query = \"\"\"\r\n2022-10-13T09:42:51.5206505Z         {\r\n2022-10-13T09:42:51.5206828Z             \"relations\": [\r\n2022-10-13T09:42:51.5207175Z             {\"rel\": {\r\n2022-10-13T09:42:51.5207501Z                 \"read\": {\r\n2022-10-13T09:42:51.5207800Z                 \"base_schema\": {\r\n2022-10-13T09:42:51.5208155Z                     \"struct\": {\r\n2022-10-13T09:42:51.5208491Z                     \"types\": [\r\n2022-10-13T09:42:51.5208841Z                                 {\"i64\": {}}\r\n2022-10-13T09:42:51.5209182Z                             ]\r\n2022-10-13T09:42:51.5209501Z                     },\r\n2022-10-13T09:42:51.5209829Z                     \"names\": [\r\n2022-10-13T09:42:51.5210168Z                             \"foo\"\r\n2022-10-13T09:42:51.5210611Z                             ]\r\n2022-10-13T09:42:51.5211097Z                 },\r\n2022-10-13T09:42:51.5211453Z                 \"local_files\": {\r\n2022-10-13T09:42:51.5211747Z                     \"items\": [\r\n2022-10-13T09:42:51.5212083Z                     {\r\n2022-10-13T09:42:51.5212530Z                         \"uri_file\": \"file://FILENAME_PLACEHOLDER\",\r\n2022-10-13T09:42:51.5212930Z                         \"arrow\": {}\r\n2022-10-13T09:42:51.5213261Z                     }\r\n2022-10-13T09:42:51.5213579Z                     ]\r\n2022-10-13T09:42:51.5213885Z                 }\r\n2022-10-13T09:42:51.5214188Z                 }\r\n2022-10-13T09:42:51.5214491Z             }}\r\n2022-10-13T09:42:51.5214795Z             ]\r\n2022-10-13T09:42:51.5215053Z         }\r\n2022-10-13T09:42:51.5215399Z         \"\"\"\r\n2022-10-13T09:42:51.5215708Z     \r\n2022-10-13T09:42:51.5355345Z         file_name = \"read_data.arrow\"\r\n2022-10-13T09:42:51.5356563Z         table = pa.table([[1, 2, 3, 4, 5]], names=['foo'])\r\n2022-10-13T09:42:51.5360922Z         path = _write_dummy_data_to_disk(tmpdir, file_name, table)\r\n2022-10-13T09:42:51.5361743Z         query = tobytes(substrait_query.replace(\"FILENAME_PLACEHOLDER\", path))\r\n2022-10-13T09:42:51.5362170Z     \r\n2022-10-13T09:42:51.5362589Z         buf = pa._substrait._parse_json_plan(query)\r\n2022-10-13T09:42:51.5362990Z     \r\n2022-10-13T09:42:51.5363388Z >       reader = substrait.run_query(buf)\r\n2022-10-13T09:42:51.5363692Z \r\n2022-10-13T09:42:51.5364018Z Python\\lib\\site-packages\\pyarrow\\tests\\test_substrait.py:79: \r\n2022-10-13T09:42:51.5364520Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n2022-10-13T09:42:51.5365008Z pyarrow\\_substrait.pyx:146: in pyarrow._substrait.run_query\r\n2022-10-13T09:42:51.5365444Z     ???\r\n2022-10-13T09:42:51.5365903Z pyarrow\\error.pxi:144: in pyarrow.lib.pyarrow_internal_check_status\r\n2022-10-13T09:42:51.5366352Z     ???\r\n2022-10-13T09:42:51.5366746Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n2022-10-13T09:42:51.5367047Z \r\n2022-10-13T09:42:51.5367246Z >   ???\r\n2022-10-13T09:42:51.5376405Z E   pyarrow.lib.ArrowInvalid: Cannot parse URI: 'file://C:UsersContainerAdministratorAppDataLocalTemppytest-of-ContainerAdministratorpytest-0\test_run_serialized_query0\r\n2022-10-13T09:42:51.5377196Z ead_data.arrow'\r\n2022-10-13T09:42:51.5377363Z \r\n2022-10-13T09:42:51.5377519Z pyarrow\\error.pxi:100: ArrowInvalid\r\n2022-10-13T09:42:51.5377857Z __________________ test_binary_conversion_with_json_options ___________________\r\n2022-10-13T09:42:51.5378087Z \r\n2022-10-13T09:42:51.5378488Z tmpdir = local('C:\\\\Users\\\\ContainerAdministrator\\\\AppData\\\\Local\\\\Temp\\\\pytest-of-ContainerAdministrator\\\\pytest-0\\\\test_binary_conversion_with_js0')\r\n2022-10-13T09:42:51.5378905Z \r\n2022-10-13T09:42:51.5379091Z     def test_binary_conversion_with_json_options(tmpdir):\r\n2022-10-13T09:42:51.5379432Z         substrait_query = \"\"\"\r\n2022-10-13T09:42:51.5379695Z         {\r\n2022-10-13T09:42:51.5379951Z             \"relations\": [\r\n2022-10-13T09:42:51.5380229Z             {\"rel\": {\r\n2022-10-13T09:42:51.5380492Z                 \"read\": {\r\n2022-10-13T09:42:51.5380954Z                 \"base_schema\": {\r\n2022-10-13T09:42:51.5381237Z                     \"struct\": {\r\n2022-10-13T09:42:51.5381473Z                     \"types\": [\r\n2022-10-13T09:42:51.5381760Z                                 {\"i64\": {}}\r\n2022-10-13T09:42:51.5382039Z                             ]\r\n2022-10-13T09:42:51.5382300Z                     },\r\n2022-10-13T09:42:51.5382564Z                     \"names\": [\r\n2022-10-13T09:42:51.5382841Z                             \"bar\"\r\n2022-10-13T09:42:51.5383116Z                             ]\r\n2022-10-13T09:42:51.5383331Z                 },\r\n2022-10-13T09:42:51.5383604Z                 \"local_files\": {\r\n2022-10-13T09:42:51.5383878Z                     \"items\": [\r\n2022-10-13T09:42:51.5384142Z                     {\r\n2022-10-13T09:42:51.5384478Z                         \"uri_file\": \"file://FILENAME_PLACEHOLDER\",\r\n2022-10-13T09:42:51.5384817Z                         \"arrow\": {},\r\n2022-10-13T09:42:51.5385109Z                         \"metadata\" : {\r\n2022-10-13T09:42:51.5385416Z                           \"created_by\" : {},\r\n2022-10-13T09:42:51.5385662Z                         }\r\n2022-10-13T09:42:51.5385919Z                     }\r\n2022-10-13T09:42:51.5386538Z                     ]\r\n2022-10-13T09:42:51.5386915Z                 }\r\n2022-10-13T09:42:51.5387308Z                 }\r\n2022-10-13T09:42:51.5387681Z             }}\r\n2022-10-13T09:42:51.5388028Z             ]\r\n2022-10-13T09:42:51.5388376Z         }\r\n2022-10-13T09:42:51.5388783Z         \"\"\"\r\n2022-10-13T09:42:51.5389130Z     \r\n2022-10-13T09:42:51.5389529Z         file_name = \"binary_json_data.arrow\"\r\n2022-10-13T09:42:51.5389993Z         table = pa.table([[1, 2, 3, 4, 5]], names=['bar'])\r\n2022-10-13T09:42:51.5390483Z         path = _write_dummy_data_to_disk(tmpdir, file_name, table)\r\n2022-10-13T09:42:51.5391031Z         query = tobytes(substrait_query.replace(\"FILENAME_PLACEHOLDER\", path))\r\n2022-10-13T09:42:51.5392363Z         buf = pa._substrait._parse_json_plan(tobytes(query))\r\n2022-10-13T09:42:51.5392817Z     \r\n2022-10-13T09:42:51.5393218Z >       reader = substrait.run_query(buf)\r\n2022-10-13T09:42:51.5393520Z \r\n2022-10-13T09:42:51.5393849Z Python\\lib\\site-packages\\pyarrow\\tests\\test_substrait.py:153: \r\n2022-10-13T09:42:51.5394315Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n2022-10-13T09:42:51.5394796Z pyarrow\\_substrait.pyx:146: in pyarrow._substrait.run_query\r\n2022-10-13T09:42:51.5395221Z     ???\r\n2022-10-13T09:42:51.5395674Z pyarrow\\error.pxi:144: in pyarrow.lib.pyarrow_internal_check_status\r\n2022-10-13T09:42:51.5396125Z     ???\r\n2022-10-13T09:42:51.5396520Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\r\n2022-10-13T09:42:51.5396809Z \r\n2022-10-13T09:42:51.5397008Z >   ???\r\n2022-10-13T09:42:51.5398062Z E   pyarrow.lib.ArrowInvalid: Cannot parse URI: 'file://C:UsersContainerAdministratorAppDataLocalTemppytest-of-ContainerAdministratorpytest-0\test_binary_conversion_with_js0\binary_json_data.arrow'\r\n2022-10-13T09:42:51.5398770Z \r\n2022-10-13T09:42:51.5399026Z pyarrow\\error.pxi:100: ArrowInvalid\r\n```\r\n",
        "created_at": "2022-10-13T17:01:52.000Z",
        "updated_at": "2022-10-15T09:32:14.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: Packaging",
            "Component: Python",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2022-10-14T00:36:30.000Z"
    },
    "comments": [
        {
            "created_at": "2022-10-13T17:05:01.569Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-18041?focusedCommentId=17617198) by Antoine Pitrou (apitrou):*\n`[~octalene]` Do you have time to work very quickly on this? Otherwise, we'll have to revert the PR from ARROW-16424"
        },
        {
            "created_at": "2022-10-13T17:08:38.652Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-18041?focusedCommentId=17617199) by Antoine Pitrou (apitrou):*\nAlso, we should enable Substrait in the AppVeyor build for PyArrow, to avoid being blind to such regressions."
        },
        {
            "created_at": "2022-10-13T17:12:36.232Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-18041?focusedCommentId=17617205) by Antoine Pitrou (apitrou):*\nStarted a dummy AppVeyor build here to see if it reproduces there: https://ci.appveyor.com/project/pitrou/arrow/builds/45062243"
        },
        {
            "created_at": "2022-10-14T00:36:31.000Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-18041?focusedCommentId=17617369) by Kouhei Sutou (kou):*\nIssue resolved by pull request 14408\n<https://github.com/apache/arrow/pull/14408>"
        }
    ]
}