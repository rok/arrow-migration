{
    "issue": {
        "title": "WriteBatchSpaced writes incorrect value for parquet when input contains NULL list",
        "body": "***Note**: This issue was originally created as [ARROW-10442](https://issues.apache.org/jira/browse/ARROW-10442). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nWhen trying to write a column of parquet lists, if there is a NULL list, WriteBatchSpaced will either throw an error (case 1 below) or incorrectly write the last value in the last list as the first value from the first list (case 2 below).\r\n\u00a0\r\nSchema:\r\nmessage schema {\r\n\u00a0 optional group _COL_0 (LIST) {\r\n\u00a0 \u00a0 repeated group list {\r\n\u00a0 \u00a0 \u00a0 optional binary item (UTF8);\r\n\u00a0 \u00a0 }\r\n\u00a0 }\r\n}\r\n\u00a0\r\n**CASE 1**\r\nData (3 lists):\r\n[\r\n\u00a0 \u00a0\"one\"\r\n]\r\nnull\r\n[\r\n\u00a0 \u00a0\"two\"\r\n]\r\n\u00a0\r\nParameters to TypedColumnWriter<PhysicalType<parquet::Type::BYTE_ARRAY>>::WriteBatchSpaced:\r\n1. num_values: 3\n1. def_levels: [3, 0, 3]\n1. rep_levels: [0, 0, 0]\n1. valid_bits: 0x05 (bit representation 101)\n1. valid_bits_offset: 0\u00a0\n1. values: [\"one\", nullptr, \"two\"]\n   When I use WriteBatchSpaced(num_values, def_levels, rep_levels, valid_bits, valid_bits_offset, values), I get the following error when running [parquet-tools](https://github.com/apache/parquet-mr/tree/master/parquet-tools) on the outputted parquet file:\n   \u00a0\n   \u00a0\n   \u00a0\n   ![image-2020-10-30-17-45-37-423.png](https://issues.apache.org/jira/secure/attachment/13014466/image-2020-10-30-17-45-37-423.png)\n   ![image-2020-10-30-17-46-33-370.png](https://issues.apache.org/jira/secure/attachment/13014465/image-2020-10-30-17-46-33-370.png)\n   Additionally, if I add another list into the data that I write, then the last element of that additional list is incorrectly written as the first element of the first list. See below.\n   \u00a0\n**CASE 2**\r\nData (4 lists):\r\n[\r\n\u00a0 \u00a0\"one\"\r\n]\r\nnull\r\n[\r\n\u00a0 \u00a0\"two\"\r\n]\r\n[\r\n\u00a0 \u00a0\"three\",\r\n\u00a0 \u00a0\"four\"\r\n]\r\n\u00a0\r\nTypedColumnWriter<PhysicalType<parquet::Type::BYTE_ARRAY>>::WriteBatchSpaced:\r\n1. num_values: 5\n1. def_levels: [3, 0, 3, 3, 3]\n1. rep_levels: [0, 0, 0, 0, 1]\n1. valid_bits: 0x29 (bit representation 11101)\n1. valid_bits_offset: 0\u00a0\n1. values: [\"one\", nullptr, \"two\", \"three\", \"four\"]\n   \n   Outputted Parquet File:\n   \u00a0\n   ![image-2020-10-30-17-47-31-022.png](https://issues.apache.org/jira/secure/attachment/13014464/image-2020-10-30-17-47-31-022.png)\n   ![image-2020-10-30-17-48-11-872.png](https://issues.apache.org/jira/secure/attachment/13014463/image-2020-10-30-17-48-11-872.png)\n   Here we see that the \"four\" in the last list actually shows up as \"one\".\u00a0",
        "created_at": "2020-10-31T00:49:26.000Z",
        "updated_at": "2020-10-31T01:03:23.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2020-10-31T01:03:23.000Z"
    },
    "comments": []
}