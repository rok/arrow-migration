{
    "issue": {
        "title": "[C++][FlightRPC] Occasional crash on server shutdown",
        "body": "***Note**: This issue was originally created as [ARROW-15181](https://issues.apache.org/jira/browse/ARROW-15181). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nObserved in a PR.\r\n\r\nWhat the problem appears to be:\r\n\r\n```cpp\n\r\n  Status Shutdown() {\r\n    if (self_pipe_.rfd == 0) {\r\n      // Already closed\r\n      return Status::OK();\r\n    }\r\n    if (PIPE_WRITE(self_pipe_.wfd, \"0\", 1) < 0 && errno != EAGAIN &&\r\n        errno != EWOULDBLOCK && errno != EINTR) {\r\n      return arrow::internal::IOErrorFromErrno(errno, \"Could not unblock signal thread\");\r\n    }\r\n    RETURN_NOT_OK(arrow::internal::FileClose(self_pipe_.rfd));\r\n    RETURN_NOT_OK(arrow::internal::FileClose(self_pipe_.wfd));\r\n    handle_signals_.join();\r\n    self_pipe_.rfd = 0;\r\n    self_pipe_.wfd = 0;\r\n    return Status::OK();\r\n  }\r\n```\r\n\r\nThis closes the pipe, then joins the thread. The thread is running this:\r\n\r\n```cpp\n\r\n  static void WaitForSignals(int fd) {\r\n    // Wait for a signal handler to write to the pipe\r\n    int8_t buf[1];\r\n    while (PIPE_READ(fd, /*buf=*/buf, /*count=*/1) == -1) {\r\n      if (errno == EINTR) {\r\n        continue;\r\n      }\r\n      ARROW_CHECK_OK(arrow::internal::IOErrorFromErrno(\r\n          errno, \"Error while waiting for shutdown signal\"));\r\n    }\r\n    auto instance = running_instance_.load();\r\n    if (instance != nullptr) {\r\n      instance->server_->Shutdown();\r\n    }\r\n  }\r\n```\r\n\r\nSo it's possible that 1) we shutdown, 2) we close the pipe, 3) the thread calls PIPE_READ, 4) we get an error (errno 9, invalid fd) because the pipe was closed. We should either ignore the error (and break), or join the thread before closing the pipe.\r\n\r\n```\n\r\n[ RUN      ] TestFlightSqlServer.TestCommandGetExportedKeys\r\n/arrow/cpp/src/arrow/flight/server.cc:884:  Check failed: _s.ok() Operation failed: arrow::internal::IOErrorFromErrno( (*__errno_location ()), \"Error while waiting for shutdown signal\")\r\nBad status: IOError: Error while waiting for shutdown signal. Detail: [errno 9] Bad file descriptor\r\n/opt/conda/envs/arrow/lib/libarrow.so.700(+0x12afab8)[0x7fe71fa07ab8]\r\n/opt/conda/envs/arrow/lib/libarrow.so.700(+0x12afa36)[0x7fe71fa07a36]\r\n/opt/conda/envs/arrow/lib/libarrow.so.700(+0x12afa58)[0x7fe71fa07a58]\r\n/opt/conda/envs/arrow/lib/libarrow.so.700(arrow::util::ArrowLog::~ArrowLog()+0x47)[0x7fe71fa07db7]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x1ef89c)[0x7fe721b9a89c]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x20456d)[0x7fe721baf56d]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x204414)[0x7fe721baf414]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x2042b8)[0x7fe721baf2b8]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x2041fc)[0x7fe721baf1fc]\r\n/opt/conda/envs/arrow/lib/libarrow_flight.so.700(+0x2032ed)[0x7fe721bae2ed]\r\n/opt/conda/envs/arrow/lib/libstdc++.so.6(+0xcc9d4)[0x7fe71e45a9d4]\r\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x76db)[0x7fe71e5406db]\r\n/lib/x86_64-linux-gnu/libc.so.6(clone+0x3f)[0x7fe71e0be71f]\r\nFound core dump, printing backtrace:\r\n\r\nwarning: core file may not match specified executable file.\r\n[New LWP 20513]\r\n[New LWP 20392]\r\n[New LWP 20393]\r\n[New LWP 20401]\r\n[New LWP 20430]\r\n[New LWP 20508]\r\n[New LWP 20509]\r\n[New LWP 20510]\r\n[New LWP 20511]\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\r\nCore was generated by `/build/cpp/debug/arrow-flight-sql-test'.\r\nProgram terminated with signal SIGABRT, Aborted.\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n51\t../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\r\n[Current thread is 1 (Thread 0x7fe710ffc700 (LWP 20513))]\r\n\r\nThread 9 (Thread 0x7fe712ffe700 (LWP 20511)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38\r\n#1  0x00007fe71d4c03cb in absl::lts_20210324::synchronization_internal::Waiter::Wait(absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#2  0x00007fe71d4c0283 in AbslInternalPerThreadSemWait_lts_20210324 () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#3  0x00007fe71d4c2f41 in absl::lts_20210324::CondVar::WaitCommon(absl::lts_20210324::Mutex*, absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#4  0x00007fe71ca7678c in gpr_cv_wait () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#5  0x00007fe71d78704d in timer_thread(void*) () from /opt/conda/envs/arrow/lib/libgrpc.so.20\r\n#6  0x00007fe71ca7c868 in grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*, grpc_core::Thread::Options const&)::{lambda(void*)#1}::_FUN(void*) () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#7  0x00007fe71e5406db in start_thread (arg=0x7fe712ffe700) at pthread_create.c:463\r\n#8  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 8 (Thread 0x7fe713fff700 (LWP 20510)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38\r\n#1  0x00007fe71d4c0367 in absl::lts_20210324::synchronization_internal::Waiter::Wait(absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#2  0x00007fe71d4c0283 in AbslInternalPerThreadSemWait_lts_20210324 () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#3  0x00007fe71d4c2f41 in absl::lts_20210324::CondVar::WaitCommon(absl::lts_20210324::Mutex*, absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#4  0x00007fe71ca767b0 in gpr_cv_wait () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#5  0x00007fe71d770327 in grpc_core::Executor::ThreadMain(void*) () from /opt/conda/envs/arrow/lib/libgrpc.so.20\r\n#6  0x00007fe71ca7c868 in grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*, grpc_core::Thread::Options const&)::{lambda(void*)#1}::_FUN(void*) () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#7  0x00007fe71e5406db in start_thread (arg=0x7fe713fff700) at pthread_create.c:463\r\n#8  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 7 (Thread 0x7fe7193fd700 (LWP 20509)):\r\n#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38\r\n#1  0x00007fe71d4c0367 in absl::lts_20210324::synchronization_internal::Waiter::Wait(absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#2  0x00007fe71d4c0283 in AbslInternalPerThreadSemWait_lts_20210324 () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#3  0x00007fe71d4c2f41 in absl::lts_20210324::CondVar::WaitCommon(absl::lts_20210324::Mutex*, absl::lts_20210324::synchronization_internal::KernelTimeout) () from /opt/conda/envs/arrow/lib/libabsl_synchronization.so.2103.0.1\r\n#4  0x00007fe71ca767b0 in gpr_cv_wait () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#5  0x00007fe71d770327 in grpc_core::Executor::ThreadMain(void*) () from /opt/conda/envs/arrow/lib/libgrpc.so.20\r\n#6  0x00007fe71ca7c868 in grpc_core::(anonymous namespace)::ThreadInternalsPosix::ThreadInternalsPosix(char const*, void (*)(void*), void*, bool*, grpc_core::Thread::Options const&)::{lambda(void*)#1}::_FUN(void*) () from /opt/conda/envs/arrow/lib/./libgpr.so.20\r\n#7  0x00007fe71e5406db in start_thread (arg=0x7fe7193fd700) at pthread_create.c:463\r\n#8  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 6 (Thread 0x7fe71a3fe700 (LWP 20508)):\r\n#0  0x00007fe71e541d2d in __GI___pthread_timedjoin_ex (threadid=140630399371008, thread_return=0x0, abstime=0x0, block=<optimized out>) at pthread_join_common.c:89\r\n#1  0x00007fe71e45a87f in __gthread_join (__value_ptr=<error reading variable: dwarf2_find_location_expression: Corrupted DWARF expression.>, __threadid=<error reading variable: dwarf2_find_location_expression: Corrupted DWARF expression.>) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/src/c++11/thread:669\r\n#2  std::thread::join (this=0x7fe71a3fc078) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/include/bits/new_allocator.h:112\r\n#3  0x00007fe721b9a439 in arrow::flight::ServerSignalHandler::Shutdown (this=0x7fe71a3fc070) at /arrow/cpp/src/arrow/flight/server.cc:831\r\n#4  0x00007fe721b9a50d in arrow::flight::ServerSignalHandler::~ServerSignalHandler (this=0x7fe71a3fc070, __in_chrg=<optimized out>) at /arrow/cpp/src/arrow/flight/server.cc:837\r\n#5  0x00007fe721b9c0be in arrow::flight::FlightServerBase::Serve (this=0x7fe700011df0) at /arrow/cpp/src/arrow/flight/server.cc:986\r\n#6  0x0000561f8f499f3c in arrow::flight::sql::TestFlightSqlServer::RunServer (this=0x561f8f9b3b80) at /arrow/cpp/src/arrow/flight/sql/server_test.cc:196\r\n#7  0x0000561f8f498fa5 in arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}::operator()() const (__closure=0x561f8f96f598) at /arrow/cpp/src/arrow/flight/sql/server_test.cc:152\r\n#8  0x0000561f8f4c0cc0 in std::__invoke_impl<void, arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}>(std::__invoke_other, arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}&&) (__f=...) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/bits/invoke.h:60\r\n#9  0x0000561f8f4c0bf9 in std::__invoke<arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}>(std::__invoke_result&&, (arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}&&)...) (__fn=...) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/bits/invoke.h:95\r\n#10 0x0000561f8f4c0acb in std::thread::_Invoker<std::tuple<arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) (this=0x561f8f96f598) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:244\r\n#11 0x0000561f8f4c090c in std::thread::_Invoker<std::tuple<arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}> >::operator()() (this=0x561f8f96f598) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:251\r\n#12 0x0000561f8f4bfa71 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<arrow::flight::sql::TestFlightSqlServer::SetUp()::{lambda()#1}> > >::_M_run() (this=0x561f8f96f590) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:195\r\n#13 0x00007fe71e45a9d4 in std::execute_native_thread_routine (__p=<optimized out>) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/include/bits/new_allocator.h:82\r\n#14 0x00007fe71e5406db in start_thread (arg=0x7fe71a3fe700) at pthread_create.c:463\r\n#15 0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 5 (Thread 0x7fe70d3ff700 (LWP 20430)):\r\n#0  0x00007fe71e547065 in futex_abstimed_wait_cancelable (private=<optimized out>, abstime=0x7fe70d3fd420, expected=0, futex_word=0x7fe71ba0a790) at ../sysdeps/unix/sysv/linux/futex-internal.h:205\r\n#1  __pthread_cond_wait_common (abstime=0x7fe70d3fd420, mutex=0x7fe71ba0a7d8, cond=0x7fe71ba0a768) at pthread_cond_wait.c:539\r\n#2  __pthread_cond_timedwait (cond=cond@entry=0x7fe71ba0a768, mutex=mutex@entry=0x7fe71ba0a7d8, abstime=abstime@entry=0x7fe70d3fd420) at pthread_cond_wait.c:667\r\n#3  0x00007fe720d74a36 in background_thread_sleep (tsdn=<optimized out>, interval=<optimized out>, info=0x7fe71ba0a760) at src/background_thread.c:255\r\n#4  background_work_sleep_once (ind=<optimized out>, info=<optimized out>, tsdn=<optimized out>) at src/background_thread.c:307\r\n#5  background_work (ind=<optimized out>, tsd=<optimized out>) at src/background_thread.c:497\r\n#6  background_thread_entry () at src/background_thread.c:522\r\n#7  0x00007fe71e5406db in start_thread (arg=0x7fe70d3ff700) at pthread_create.c:463\r\n#8  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 4 (Thread 0x7fe70ebff700 (LWP 20401)):\r\n#0  0x00007fe71e547065 in futex_abstimed_wait_cancelable (private=<optimized out>, abstime=0x7fe70ebfd420, expected=0, futex_word=0x7fe71ba0a6c4) at ../sysdeps/unix/sysv/linux/futex-internal.h:205\r\n#1  __pthread_cond_wait_common (abstime=0x7fe70ebfd420, mutex=0x7fe71ba0a708, cond=0x7fe71ba0a698) at pthread_cond_wait.c:539\r\n#2  __pthread_cond_timedwait (cond=cond@entry=0x7fe71ba0a698, mutex=mutex@entry=0x7fe71ba0a708, abstime=abstime@entry=0x7fe70ebfd420) at pthread_cond_wait.c:667\r\n#3  0x00007fe720d74a36 in background_thread_sleep (tsdn=<optimized out>, interval=<optimized out>, info=0x7fe71ba0a690) at src/background_thread.c:255\r\n#4  background_work_sleep_once (ind=<optimized out>, info=<optimized out>, tsdn=<optimized out>) at src/background_thread.c:307\r\n#5  background_work (ind=<optimized out>, tsd=<optimized out>) at src/background_thread.c:497\r\n#6  background_thread_entry () at src/background_thread.c:522\r\n#7  0x00007fe71e5406db in start_thread (arg=0x7fe70ebff700) at pthread_create.c:463\r\n#8  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 3 (Thread 0x7fe71b3ff700 (LWP 20393)):\r\n#0  0x00007fe71e547065 in futex_abstimed_wait_cancelable (private=<optimized out>, abstime=0x7fe71b3fd420, expected=0, futex_word=0x7fe71ba0a5f4) at ../sysdeps/unix/sysv/linux/futex-internal.h:205\r\n#1  __pthread_cond_wait_common (abstime=0x7fe71b3fd420, mutex=0x7fe71ba0a638, cond=0x7fe71ba0a5c8) at pthread_cond_wait.c:539\r\n#2  __pthread_cond_timedwait (cond=cond@entry=0x7fe71ba0a5c8, mutex=mutex@entry=0x7fe71ba0a638, abstime=abstime@entry=0x7fe71b3fd420) at pthread_cond_wait.c:667\r\n#3  0x00007fe720d75166 in background_thread_sleep (tsdn=<optimized out>, interval=<optimized out>, info=<optimized out>) at src/background_thread.c:255\r\n#4  background_work_sleep_once (ind=0, info=<optimized out>, tsdn=<optimized out>) at src/background_thread.c:307\r\n#5  background_thread0_work (tsd=<optimized out>) at src/background_thread.c:452\r\n#6  background_work (ind=<optimized out>, tsd=<optimized out>) at src/background_thread.c:490\r\n#7  background_thread_entry () at src/background_thread.c:522\r\n#8  0x00007fe71e5406db in start_thread (arg=0x7fe71b3ff700) at pthread_create.c:463\r\n#9  0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nThread 2 (Thread 0x7fe71bce2140 (LWP 20392)):\r\n#0  0x00007fe71e541d2d in __GI___pthread_timedjoin_ex (threadid=140630554568448, thread_return=0x0, abstime=0x0, block=<optimized out>) at pthread_join_common.c:89\r\n#1  0x00007fe71e45a87f in __gthread_join (__value_ptr=<error reading variable: dwarf2_find_location_expression: Corrupted DWARF expression.>, __threadid=<error reading variable: dwarf2_find_location_expression: Corrupted DWARF expression.>) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/src/c++11/thread:669\r\n#2  std::thread::join (this=0x561f8f96f570) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/include/bits/new_allocator.h:112\r\n#3  0x0000561f8f49977b in arrow::flight::sql::TestFlightSqlServer::TearDown (this=0x561f8f9b3b80) at /arrow/cpp/src/arrow/flight/sql/server_test.cc:173\r\n#4  0x00007fe72259bc9c in testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void> (object=0x561f8f9b3b80, method=&virtual testing::Test::TearDown(), location=0x7fe7225b0989 \"TearDown()\") at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2607\r\n#5  0x00007fe722592dd2 in testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void> (object=0x561f8f9b3b80, method=&virtual testing::Test::TearDown(), location=0x7fe7225b0989 \"TearDown()\") at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2643\r\n#6  0x00007fe72256dc4e in testing::Test::Run (this=0x561f8f9b3b80) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2690\r\n#7  0x00007fe72256e63b in testing::TestInfo::Run (this=0x561f8f989390) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2861\r\n#8  0x00007fe72256f010 in testing::TestSuite::Run (this=0x561f8f9938c0) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:3015\r\n#9  0x00007fe72257f31c in testing::internal::UnitTestImpl::RunAllTests (this=0x561f8f990d90) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:5855\r\n#10 0x00007fe72259cce8 in testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool> (object=0x561f8f990d90, method=(bool (testing::internal::UnitTestImpl::*)(testing::internal::UnitTestImpl * const)) 0x7fe72257eed8 <testing::internal::UnitTestImpl::RunAllTests()>, location=0x7fe7225b1468 \"auxiliary test code (environments or event listeners)\") at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2607\r\n#11 0x00007fe722594064 in testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::UnitTestImpl, bool> (object=0x561f8f990d90, method=(bool (testing::internal::UnitTestImpl::*)(testing::internal::UnitTestImpl * const)) 0x7fe72257eed8 <testing::internal::UnitTestImpl::RunAllTests()>, location=0x7fe7225b1468 \"auxiliary test code (environments or event listeners)\") at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:2643\r\n#12 0x00007fe72257d7b7 in testing::UnitTest::Run (this=0x7fe7225dd260 <testing::UnitTest::GetInstance()::instance>) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest.cc:5438\r\n#13 0x00007fe7225de919 in RUN_ALL_TESTS () at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/include/gtest/gtest.h:2490\r\n#14 0x00007fe7225de95c in main (argc=1, argv=0x7ffee00fe7a8) at /build/cpp/googletest_ep-prefix/src/googletest_ep/googletest/src/gtest_main.cc:52\r\n#15 0x00007fe71dfbebf7 in __libc_start_main (main=0x7fe7225de91b <main(int, char**)>, argc=1, argv=0x7ffee00fe7a8, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7ffee00fe798) at ../csu/libc-start.c:310\r\n#16 0x0000561f8f45b7f9 in _start ()\r\n\r\nThread 1 (Thread 0x7fe710ffc700 (LWP 20513)):\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n#1  0x00007fe71dfdd921 in __GI_abort () at abort.c:79\r\n#2  0x00007fe71fa07a3c in arrow::util::CerrLog::~CerrLog (this=0x7fe71402a570, __in_chrg=<optimized out>) at /arrow/cpp/src/arrow/util/logging.cc:72\r\n#3  0x00007fe71fa07a58 in arrow::util::CerrLog::~CerrLog (this=0x7fe71402a570, __in_chrg=<optimized out>) at /arrow/cpp/src/arrow/util/logging.cc:74\r\n#4  0x00007fe71fa07db7 in arrow::util::ArrowLog::~ArrowLog (this=0x7fe710ffa360, __in_chrg=<optimized out>) at /arrow/cpp/src/arrow/util/logging.cc:250\r\n#5  0x00007fe721b9a89c in arrow::flight::FlightServerBase::Impl::WaitForSignals (fd=14) at /arrow/cpp/src/arrow/flight/server.cc:884\r\n#6  0x00007fe721baf56d in std::__invoke_impl<void, void (*)(int), int> (__f=@0x7fe7000251a0: 0x7fe721b9a701 <arrow::flight::FlightServerBase::Impl::WaitForSignals(int)>) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/bits/invoke.h:60\r\n#7  0x00007fe721baf414 in std::__invoke<void (*)(int), int> (__fn=@0x7fe7000251a0: 0x7fe721b9a701 <arrow::flight::FlightServerBase::Impl::WaitForSignals(int)>) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/bits/invoke.h:95\r\n#8  0x00007fe721baf2b8 in std::thread::_Invoker<std::tuple<void (*)(int), int> >::_M_invoke<0ul, 1ul> (this=0x7fe700025198) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:244\r\n#9  0x00007fe721baf1fc in std::thread::_Invoker<std::tuple<void (*)(int), int> >::operator() (this=0x7fe700025198) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:251\r\n#10 0x00007fe721bae2ed in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(int), int> > >::_M_run (this=0x7fe700025190) at /opt/conda/envs/arrow/x86_64-conda-linux-gnu/include/c++/9.4.0/thread:195\r\n#11 0x00007fe71e45a9d4 in std::execute_native_thread_routine (__p=<optimized out>) at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1634095553113/work/build/x86_64-conda-linux-gnu/libstdc++-v3/include/bits/new_allocator.h:82\r\n#12 0x00007fe71e5406db in start_thread (arg=0x7fe710ffc700) at pthread_create.c:463\r\n#13 0x00007fe71e0be71f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n/build/cpp/src/arrow/flight/sql\r\n\r\n      Start 101: arrow-feather-test\r\n \n```",
        "created_at": "2021-12-21T18:42:04.000Z",
        "updated_at": "2021-12-29T19:41:21.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Component: FlightRPC",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2021-12-29T13:51:26.000Z"
    },
    "comments": [
        {
            "created_at": "2021-12-21T19:05:18.150Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-15181?focusedCommentId=17463419) by Antoine Pitrou (apitrou):*\nWe should probably join the thread before closing the pipes, if possible."
        },
        {
            "created_at": "2021-12-29T13:51:26.489Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-15181?focusedCommentId=17466464) by David Li (lidavidm):*\nIssue resolved by pull request 12037\n<https://github.com/apache/arrow/pull/12037>"
        }
    ]
}