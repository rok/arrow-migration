{
    "issue": {
        "title": "[C++] Appveyor builds failing persistently in thrift_ep build",
        "body": "***Note**: This issue was originally created as [ARROW-5735](https://issues.apache.org/jira/browse/ARROW-5735). Please see the [migration documentation](https://gist.github.com/toddfarmer/12aa88361532d21902818a6044fda4c3) for further details.*\n\n### Original Issue Description:\nSee\r\n\r\n```Java\n\r\n72/541] Performing configure step for 'thrift_ep'\r\nFAILED: thrift_ep-prefix/src/thrift_ep-stamp/thrift_ep-configure \r\ncmd.exe /C \"cd /D C:\\projects\\arrow\\cpp\\build\\thrift_ep-prefix\\src\\thrift_ep-build && \"C:\\Program Files (x86)\\CMake\\bin\\cmake.exe\" -DFLEX_EXECUTABLE=C:/projects/arrow/cpp/build/winflexbison_ep/src/winflexbison_ep-install/win_flex.exe -DBISON_EXECUTABLE=C:/projects/arrow/cpp/build/winflexbison_ep/src/winflexbison_ep-install/win_bison.exe -DZLIB_INCLUDE_DIR= -DWITH_SHARED_LIB=OFF -DWITH_PLUGIN=OFF -DZLIB_LIBRARY= \"-DCMAKE_C_COMPILER=C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.16.27023/bin/Hostx64/x64/cl.exe\" -DCMAKE_CXX_COMPILER=C:/Miniconda36-x64/Scripts/clcache.exe -DCMAKE_BUILD_TYPE=RELEASE \"-DCMAKE_C_FLAGS=/DWIN32 /D_WINDOWS /W3  /MD /O2 /Ob2 /DNDEBUG\" \"-DCMAKE_C_FLAGS_RELEASE=/DWIN32 /D_WINDOWS /W3  /MD /O2 /Ob2 /DNDEBUG\" \"-DCMAKE_CXX_FLAGS=/DWIN32 /D_WINDOWS  /GR /EHsc /D_SILENCE_TR1_NAMESPACE_DEPRECATION_WARNING  /MD /Od /UNDEBUG\" \"-DCMAKE_CXX_FLAGS_RELEASE=/DWIN32 /D_WINDOWS  /GR /EHsc /D_SILENCE_TR1_NAMESPACE_DEPRECATION_WARNING  /MD /Od /UNDEBUG\" -DCMAKE_INSTALL_PREFIX=C:/projects/arrow/cpp/build/thrift_ep/src/thrift_ep-install -DCMAKE_INSTALL_RPATH=C:/projects/arrow/cpp/build/thrift_ep/src/thrift_ep-install/lib -DBUILD_SHARED_LIBS=OFF -DBUILD_TESTING=OFF -DBUILD_EXAMPLES=OFF -DBUILD_TUTORIALS=OFF -DWITH_QT4=OFF -DWITH_C_GLIB=OFF -DWITH_JAVA=OFF -DWITH_PYTHON=OFF -DWITH_HASKELL=OFF -DWITH_CPP=ON -DWITH_STATIC_LIB=ON -DWITH_LIBEVENT=OFF -DWITH_MT=OFF -GNinja C:/projects/arrow/cpp/build/thrift_ep-prefix/src/thrift_ep && \"C:\\Program Files (x86)\\CMake\\bin\\cmake.exe\" -E touch C:/projects/arrow/cpp/build/thrift_ep-prefix/src/thrift_ep-stamp/thrift_ep-configure\"\r\n-- The C compiler identification is MSVC 19.16.27030.1\r\n-- The CXX compiler identification is MSVC 19.16.27030.1\r\n-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.16.27023/bin/Hostx64/x64/cl.exe\r\n-- Check for working C compiler: C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Tools/MSVC/14.16.27023/bin/Hostx64/x64/cl.exe -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: C:/Miniconda36-x64/Scripts/clcache.exe\r\n-- Check for working CXX compiler: C:/Miniconda36-x64/Scripts/clcache.exe -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Parsed Thrift package version: 0.12.0\r\n-- Parsed Thrift version: 0.12.0 (0.2.0)\r\n-- Setting C++11 as the default language level.\r\n-- To specify a different C++ language level, set CMAKE_CXX_STANDARD\r\nCMake Warning (dev) at build/cmake/DefineOptions.cmake:63 (find_package):\r\n  Policy CMP0074 is not set: find_package uses <PackageName>_ROOT variables.\r\n  Run \"cmake --help-policy CMP0074\" for policy details.  Use the cmake_policy\r\n  command to set the policy and suppress this warning.\r\n  Environment variable Boost_ROOT is set to:\r\n    C:\\Miniconda36-x64\\envs\\arrow\\Library\r\n  For compatibility, CMake is ignoring the variable.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:52 (include)\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n-- Found Boost 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/Boost-1.70.0\r\n--   Requested configuration: QUIET\r\n-- Found boost_headers 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/boost_headers-1.70.0\r\n-- Boost 1.53 found.\r\n-- libevent NOT found.\r\n-- Could NOT find RUN_HASKELL (missing: RUN_HASKELL) \r\n-- Could NOT find CABAL (missing: CABAL) \r\n-- Looking for arpa/inet.h\r\n-- Looking for arpa/inet.h - not found\r\n-- Looking for fcntl.h\r\n-- Looking for fcntl.h - found\r\n-- Looking for getopt.h\r\n-- Looking for getopt.h - not found\r\n-- Looking for inttypes.h\r\n-- Looking for inttypes.h - found\r\n-- Looking for netdb.h\r\n-- Looking for netdb.h - not found\r\n-- Looking for netinet/in.h\r\n-- Looking for netinet/in.h - not found\r\n-- Looking for signal.h\r\n-- Looking for signal.h - found\r\n-- Looking for stdint.h\r\n-- Looking for stdint.h - found\r\n-- Looking for unistd.h\r\n-- Looking for unistd.h - not found\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - not found\r\n-- Looking for sys/ioctl.h\r\n-- Looking for sys/ioctl.h - not found\r\n-- Looking for sys/param.h\r\n-- Looking for sys/param.h - not found\r\n-- Looking for sys/resource.h\r\n-- Looking for sys/resource.h - not found\r\n-- Looking for sys/socket.h\r\n-- Looking for sys/socket.h - not found\r\n-- Looking for sys/stat.h\r\n-- Looking for sys/stat.h - found\r\n-- Looking for sys/time.h\r\n-- Looking for sys/time.h - not found\r\n-- Looking for sys/un.h\r\n-- Looking for sys/un.h - not found\r\n-- Looking for poll.h\r\n-- Looking for poll.h - not found\r\n-- Looking for sys/poll.h\r\n-- Looking for sys/poll.h - not found\r\n-- Looking for sys/select.h\r\n-- Looking for sys/select.h - not found\r\n-- Looking for sched.h\r\n-- Looking for sched.h - not found\r\n-- Looking for string.h\r\n-- Looking for string.h - found\r\n-- Looking for strings.h\r\n-- Looking for strings.h - not found\r\n-- Looking for gethostbyname\r\n-- Looking for gethostbyname - not found\r\n-- Looking for gethostbyname_r\r\n-- Looking for gethostbyname_r - not found\r\n-- Looking for strerror_r\r\n-- Looking for strerror_r - not found\r\n-- Looking for sched_get_priority_max\r\n-- Looking for sched_get_priority_max - not found\r\n-- Looking for sched_get_priority_min\r\n-- Looking for sched_get_priority_min - not found\r\n-- Performing Test STRERROR_R_CHAR_P\r\n-- Performing Test STRERROR_R_CHAR_P - Failed\r\n-- Looking for pthread.h\r\n-- Looking for pthread.h - not found\r\n-- Found Threads: TRUE  \r\n-- Building without tests\r\n-- Found FLEX: C:/projects/arrow/cpp/build/winflexbison_ep/src/winflexbison_ep-install/win_flex.exe (found version \"2.6.3\") \r\n-- Found BISON: C:/projects/arrow/cpp/build/winflexbison_ep/src/winflexbison_ep-install/win_bison.exe (found version \"2.7\") \r\nCMake Error at lib/cpp/CMakeLists.txt:20 (include_directories):\r\n  include_directories given empty-string as include directory.\r\n```",
        "created_at": "2019-06-26T01:21:40.000Z",
        "updated_at": "2019-06-26T15:06:42.000Z",
        "labels": [
            "Migrated from Jira",
            "Component: C++",
            "Type: bug"
        ],
        "closed": true,
        "closed_at": "2019-06-26T11:53:59.000Z"
    },
    "comments": [
        {
            "created_at": "2019-06-26T01:22:53.343Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16872846) by Wes McKinney (wesm):*\nFor whatever reason, this seems to be mostly happening on the ApacheSoftwareFoundation Appveyor project but not on Appveyor builds on contributor forks. Perplexing"
        },
        {
            "created_at": "2019-06-26T02:08:19.561Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16872868) by Wes McKinney (wesm):*\nThis seems to be Boost-related\r\n\r\n```Java\n\r\n-- Found Boost 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/Boost-1.70.0\r\n--   Requested configuration: QUIET COMPONENTS regex;system;filesystem\r\n-- Found boost_headers 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/boost_headers-1.70.0\r\n-- Found boost_regex 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/boost_regex-1.70.0\r\n--   libboost_regex.lib\r\n-- Adding boost_regex dependencies: headers\r\n-- Found boost_system 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/boost_system-1.70.0\r\n--   libboost_system.lib\r\n-- Adding boost_system dependencies: headers\r\n-- Found boost_filesystem 1.70.0 at C:/Miniconda36-x64/envs/arrow/Library/lib/cmake/boost_filesystem-1.70.0\r\n--   libboost_filesystem.lib\r\n-- Adding boost_filesystem dependencies: headers\r\n-- Boost 1.58 found.\r\n-- Found Boost components:\r\n   regex;system;filesystem\r\n-- Boost include dir: \r\n-- Boost libraries: \r\n```\r\n\r\nThrift is failing due to the empty include dir"
        },
        {
            "created_at": "2019-06-26T08:28:37.259Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873079) by Antoine Pitrou (apitrou):*\nThis is probably related with boost-cpp upgrade on conda-forge.\r\n\r\nWorking build (1.69.0):\r\nhttps://ci.appveyor.com/project/ApacheSoftwareFoundation/arrow/builds/25522758/job/ehs3hy3u04y1elyt?fullLog=true\r\nFailing build (1.70.0):\r\nhttps://ci.appveyor.com/project/ApacheSoftwareFoundation/arrow/builds/25549313/job/j9ri5xfxufcpat7t\r\n"
        },
        {
            "created_at": "2019-06-26T08:30:17.734Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873080) by Antoine Pitrou (apitrou):*\nWhat's weird is that the latest commits date back to June 13:\r\nhttps://github.com/conda-forge/boost-cpp-feedstock/commits/master\r\n\r\n`[~xhochy]`"
        },
        {
            "created_at": "2019-06-26T08:37:31.414Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873087) by Antoine Pitrou (apitrou):*\nPerhaps a subtle change in conda's dependency resolution algorithm... First build has conda 4.6.14, second has conda 4.7.5."
        },
        {
            "created_at": "2019-06-26T08:40:37.410Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873092) by Uwe Korn (uwe):*\nThe problem here is that this is picking up Boost's new CMake config which we cannot ingest. We need to disable this using `-DBoost_NO_BOOST_CMAKE=ON`"
        },
        {
            "created_at": "2019-06-26T08:48:50.384Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873111) by Antoine Pitrou (apitrou):*\nApparently it's https://gitlab.kitware.com/cmake/cmake/issues/18865 . Trying a workaround."
        },
        {
            "created_at": "2019-06-26T11:53:59.597Z",
            "body": "***Note**: [Comment](https://issues.apache.org/jira/browse/ARROW-5735?focusedCommentId=16873268) by Antoine Pitrou (apitrou):*\nIssue resolved by pull request 4702\r\n<https://github.com/apache/arrow/pull/4702>"
        }
    ]
}