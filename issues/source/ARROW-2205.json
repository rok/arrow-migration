{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13140556",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556",
    "key": "ARROW-2205",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
            "name": "adshieh",
            "key": "adshieh",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Albert Shieh",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
            "name": "adshieh",
            "key": "adshieh",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Albert Shieh",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
            "name": "adshieh",
            "key": "adshieh",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Albert Shieh",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2205/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@31b544e0[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@25959dad[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e774847[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5786ced1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41864be4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@707b79fe[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@14aa22c6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@75bb96c4[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6113afc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2d8e1749[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6877ac2c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@41530a50[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Mar 02 14:31:55 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-03-02T14:31:55.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2205/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-02-23T17:41:55.000+0000",
        "updated": "2018-03-02T14:31:55.000+0000",
        "timeoriginalestimate": null,
        "description": "I have a use case where the loss of precision in casting integers to floats matters, and pandas supports storing integers with nulls without loss of precision in object columns. However, a roundtrip through arrow will cast the object columns to float columns, even though the object columns are stored in arrow as integers with nulls.\r\n\r\nThis is a minimal example demonstrating the\u00a0behavior of a roundtrip:\r\n{code}\r\nimport numpy as np\r\nimport pandas as pd\r\nimport pyarrow as pa\r\n\r\ndf = pd.DataFrame({\"a\": np.array([None, 1], dtype=object)})\r\ndf_pa = pa.Table.from_pandas(df).to_pandas()\r\n\r\nprint(df)\r\nprint(df_pa)\r\n{code}\r\nThe output is:\r\n{code}\r\n\u00a0     a\r\n0  None\r\n1     1\r\n     a\r\n0  NaN\r\n1  1.0\r\n{code}\r\nThis seems to be the desired behavior, given test_int_object_nulls in test_convert_pandas.\r\n\r\nI think it would be useful to add an option in the to_pandas methods to allow integers with nulls to be returned as object columns. The option can default to false in order to preserve the current behavior.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Option for integer object nulls",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16374720",
                    "id": "16374720",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh opened a new pull request #1650: [ARROW-2205] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650\n \n \n   Fixes [ARROW-2205](https://issues.apache.org/jira/browse/ARROW-2205).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-23T17:43:35.204+0000",
                    "updated": "2018-02-23T17:43:35.204+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16375665",
                    "id": "16375665",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-368241657\n \n \n   Thanks for working on this @adshieh! I am wondering out loud if there's anything we can do to help with the API for a growing number of pandas conversion arguments (like using an options object instead of keyword args)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-24T16:49:47.451+0000",
                    "updated": "2018-02-24T16:49:47.451+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16375704",
                    "id": "16375704",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-368247892\n \n \n   @wesm I think using `kwargs` seems to be the most pythonic way to do this. With Pandas I also wondered in the beginning over the large number of kwargs but in the end, it seems like a good-enough solution.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-24T18:14:16.728+0000",
                    "updated": "2018-02-24T18:14:16.728+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16375756",
                    "id": "16375756",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-368256301\n \n \n   >  I am wondering out loud if there's anything we can do to help with the API for a growing number of pandas conversion arguments (like using an options object instead of keyword args)\r\n   \r\n   Perhaps the dialect concept used by the [csv module](https://docs.python.org/3/library/csv.html) can be re-used?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-24T20:11:42.955+0000",
                    "updated": "2018-02-24T20:11:42.955+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16376976",
                    "id": "16376976",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-368526062\n \n \n   I personally prefer keyword arguments because the number of calls to `to_pandas` in my use cases has been limited, so having the documentation in the method and avoiding the extra step of creating an options object has been convenient.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T14:46:26.692+0000",
                    "updated": "2018-02-26T14:46:26.692+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377068",
                    "id": "16377068",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "cpcloud commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170637799\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   It doesn't look like you're using `self` here. Can you make this into a test function and [`pytest.mark.parametrize`](https://docs.pytest.org/en/latest/parametrize.html) it on the `int_dtypes` parameter?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T15:54:11.387+0000",
                    "updated": "2018-02-26T15:54:11.387+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377082",
                    "id": "16377082",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170640655\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   We should probably convert this whole module to pytest-style in a separate patch\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T16:01:36.348+0000",
                    "updated": "2018-02-26T16:01:36.348+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377083",
                    "id": "16377083",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170640785\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   Sure! However, it seems like none of the test methods use `self` and the test classes are just for organizational purposes, so moving it to a test function would be a deviation?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T16:02:01.596+0000",
                    "updated": "2018-02-26T16:02:01.596+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377094",
                    "id": "16377094",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "cpcloud commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170642827\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   Sure, but if we are going to do it eventually then we shouldn't knowingly add to the debt in the name of consistency.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T16:07:43.974+0000",
                    "updated": "2018-02-26T16:07:43.974+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377102",
                    "id": "16377102",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170645928\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   I would vote against the pytest-style of a forest of functions. In my experience the lack of organization produces difficult to maintain test modules. Organizing the test methods into several classes helped me figure out which features were tested and how.\r\n   \r\n   An alternative would be to split the tests into several modules (or perhaps several modules inside a subpackage).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T16:16:06.397+0000",
                    "updated": "2018-02-26T16:16:06.397+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16377105",
                    "id": "16377105",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "cpcloud commented on a change in pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#discussion_r170646464\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -615,6 +615,36 @@ def test_int_object_nulls(self):\n         _check_pandas_roundtrip(df, expected=expected,\n                                 expected_schema=schema)\n \n+    def test_int_object_nulls_option(self):\n \n Review comment:\n   Grouping by modules (which contain functions) is the solution to that particular problem.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-26T16:17:31.876+0000",
                    "updated": "2018-02-26T16:17:31.876+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16378833",
                    "id": "16378833",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-368927373\n \n \n   yes, plan to review this today\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-27T15:58:45.531+0000",
                    "updated": "2018-02-27T15:58:45.531+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16380977",
                    "id": "16380977",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-369369328\n \n \n   Rebased. Going to wait for the builds to rujn\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-28T20:18:47.190+0000",
                    "updated": "2018-02-28T20:18:47.190+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16380978",
                    "id": "16380978",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-369369328\n \n \n   Rebased. Going to wait for the builds to run\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-28T20:18:51.213+0000",
                    "updated": "2018-02-28T20:18:51.213+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16382265",
                    "id": "16382265",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650#issuecomment-369649945\n \n \n   Rebasing this again\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-01T16:33:40.870+0000",
                    "updated": "2018-03-01T16:33:40.870+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16383637",
                    "id": "16383637",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy closed pull request #1650: ARROW-2205: [Python] Option for integer object nulls\nURL: https://github.com/apache/arrow/pull/1650\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/python/arrow_to_pandas.cc b/cpp/src/arrow/python/arrow_to_pandas.cc\nindex aefd4d76d..21e848281 100644\n--- a/cpp/src/arrow/python/arrow_to_pandas.cc\n+++ b/cpp/src/arrow/python/arrow_to_pandas.cc\n@@ -362,6 +362,29 @@ static void ConvertBooleanNoNulls(PandasOptions options, const ChunkedArray& dat\n   }\n }\n \n+template <typename T>\n+static Status ConvertIntegerObjects(PandasOptions options, const ChunkedArray& data,\n+                                    PyObject** out_values) {\n+  PyAcquireGIL lock;\n+  for (int c = 0; c < data.num_chunks(); c++) {\n+    const auto& arr = *data.chunk(c);\n+    const T* in_values = GetPrimitiveValues<T>(arr);\n+\n+    for (int i = 0; i < arr.length(); ++i) {\n+      if (arr.IsNull(i)) {\n+        Py_INCREF(Py_None);\n+        *out_values++ = Py_None;\n+      } else {\n+        *out_values++ = std::is_signed<T>::value\n+                            ? PyLong_FromLongLong(in_values[i])\n+                            : PyLong_FromUnsignedLongLong(in_values[i]);\n+        RETURN_IF_PYERROR();\n+      }\n+    }\n+  }\n+  return Status::OK();\n+}\n+\n template <typename Type>\n inline Status ConvertBinaryLike(PandasOptions options, const ChunkedArray& data,\n                                 PyObject** out_values) {\n@@ -684,6 +707,22 @@ class ObjectBlock : public PandasBlock {\n \n     if (type == Type::BOOL) {\n       RETURN_NOT_OK(ConvertBooleanWithNulls(options_, data, out_buffer));\n+    } else if (type == Type::UINT8) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<uint8_t>(options_, data, out_buffer));\n+    } else if (type == Type::INT8) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<int8_t>(options_, data, out_buffer));\n+    } else if (type == Type::UINT16) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<uint16_t>(options_, data, out_buffer));\n+    } else if (type == Type::INT16) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<int16_t>(options_, data, out_buffer));\n+    } else if (type == Type::UINT32) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<uint32_t>(options_, data, out_buffer));\n+    } else if (type == Type::INT32) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<int32_t>(options_, data, out_buffer));\n+    } else if (type == Type::UINT64) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<uint64_t>(options_, data, out_buffer));\n+    } else if (type == Type::INT64) {\n+      RETURN_NOT_OK(ConvertIntegerObjects<int64_t>(options_, data, out_buffer));\n     } else if (type == Type::BINARY) {\n       RETURN_NOT_OK(ConvertBinaryLike<BinaryType>(options_, data, out_buffer));\n     } else if (type == Type::STRING) {\n@@ -1202,34 +1241,33 @@ using BlockMap = std::unordered_map<int, std::shared_ptr<PandasBlock>>;\n \n static Status GetPandasBlockType(const Column& col, const PandasOptions& options,\n                                  PandasBlock::type* output_type) {\n+#define INTEGER_CASE(NAME)                                                           \\\n+  *output_type =                                                                     \\\n+      col.null_count() > 0                                                           \\\n+          ? options.integer_object_nulls ? PandasBlock::OBJECT : PandasBlock::DOUBLE \\\n+          : PandasBlock::NAME;                                                       \\\n+  break;\n+\n   switch (col.type()->id()) {\n     case Type::BOOL:\n       *output_type = col.null_count() > 0 ? PandasBlock::OBJECT : PandasBlock::BOOL;\n       break;\n     case Type::UINT8:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::UINT8;\n-      break;\n+      INTEGER_CASE(UINT8);\n     case Type::INT8:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::INT8;\n-      break;\n+      INTEGER_CASE(INT8);\n     case Type::UINT16:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::UINT16;\n-      break;\n+      INTEGER_CASE(UINT16);\n     case Type::INT16:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::INT16;\n-      break;\n+      INTEGER_CASE(INT16);\n     case Type::UINT32:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::UINT32;\n-      break;\n+      INTEGER_CASE(UINT32);\n     case Type::INT32:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::INT32;\n-      break;\n-    case Type::INT64:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::INT64;\n-      break;\n+      INTEGER_CASE(INT32);\n     case Type::UINT64:\n-      *output_type = col.null_count() > 0 ? PandasBlock::DOUBLE : PandasBlock::UINT64;\n-      break;\n+      INTEGER_CASE(UINT64);\n+    case Type::INT64:\n+      INTEGER_CASE(INT64);\n     case Type::FLOAT:\n       *output_type = PandasBlock::FLOAT;\n       break;\n@@ -1647,9 +1685,15 @@ class ArrowDeserializer {\n     }\n \n     if (data_.null_count() > 0) {\n-      RETURN_NOT_OK(AllocateOutput(NPY_FLOAT64));\n-      auto out_values = reinterpret_cast<double*>(PyArray_DATA(arr_));\n-      ConvertIntegerWithNulls<T>(options_, data_, out_values);\n+      if (options_.integer_object_nulls) {\n+        using c_type = typename Type::c_type;\n+\n+        return VisitObjects(ConvertIntegerObjects<c_type>);\n+      } else {\n+        RETURN_NOT_OK(AllocateOutput(NPY_FLOAT64));\n+        auto out_values = reinterpret_cast<double*>(PyArray_DATA(arr_));\n+        ConvertIntegerWithNulls<T>(options_, data_, out_values);\n+      }\n     } else {\n       RETURN_NOT_OK(AllocateOutput(traits::npy_type));\n       auto out_values = reinterpret_cast<T*>(PyArray_DATA(arr_));\ndiff --git a/cpp/src/arrow/python/arrow_to_pandas.h b/cpp/src/arrow/python/arrow_to_pandas.h\nindex 0541b0f9a..4819eb42c 100644\n--- a/cpp/src/arrow/python/arrow_to_pandas.h\n+++ b/cpp/src/arrow/python/arrow_to_pandas.h\n@@ -44,8 +44,12 @@ struct PandasOptions {\n   /// If true, we will convert all string columns to categoricals\n   bool strings_to_categorical;\n   bool zero_copy_only;\n+  bool integer_object_nulls;\n \n-  PandasOptions() : strings_to_categorical(false), zero_copy_only(false) {}\n+  PandasOptions()\n+      : strings_to_categorical(false),\n+        zero_copy_only(false),\n+        integer_object_nulls(false) {}\n };\n \n ARROW_EXPORT\ndiff --git a/python/pyarrow/array.pxi b/python/pyarrow/array.pxi\nindex 5b8621f13..73c140ad6 100644\n--- a/python/pyarrow/array.pxi\n+++ b/python/pyarrow/array.pxi\n@@ -430,7 +430,8 @@ cdef class Array:\n         return pyarrow_wrap_array(result)\n \n     def to_pandas(self, c_bool strings_to_categorical=False,\n-                  c_bool zero_copy_only=False):\n+                  c_bool zero_copy_only=False,\n+                  c_bool integer_object_nulls=False):\n         \"\"\"\n         Convert to an array object suitable for use in pandas\n \n@@ -441,6 +442,8 @@ cdef class Array:\n         zero_copy_only : boolean, default False\n             Raise an ArrowException if this function call would require copying\n             the underlying data\n+        integer_object_nulls : boolean, default False\n+            Cast integers with nulls to objects\n \n         See also\n         --------\n@@ -454,7 +457,8 @@ cdef class Array:\n \n         options = PandasOptions(\n             strings_to_categorical=strings_to_categorical,\n-            zero_copy_only=zero_copy_only)\n+            zero_copy_only=zero_copy_only,\n+            integer_object_nulls=integer_object_nulls)\n         with nogil:\n             check_status(ConvertArrayToPandas(options, self.sp_array,\n                                               self, &out))\ndiff --git a/python/pyarrow/includes/libarrow.pxd b/python/pyarrow/includes/libarrow.pxd\nindex b9abf2b16..233f2cb47 100644\n--- a/python/pyarrow/includes/libarrow.pxd\n+++ b/python/pyarrow/includes/libarrow.pxd\n@@ -908,6 +908,7 @@ cdef extern from \"arrow/python/api.h\" namespace \"arrow::py\" nogil:\n     cdef struct PandasOptions:\n         c_bool strings_to_categorical\n         c_bool zero_copy_only\n+        c_bool integer_object_nulls\n \n cdef extern from \"arrow/python/api.h\" namespace 'arrow::py' nogil:\n \ndiff --git a/python/pyarrow/table.pxi b/python/pyarrow/table.pxi\nindex 178df5767..c27c0edd9 100644\n--- a/python/pyarrow/table.pxi\n+++ b/python/pyarrow/table.pxi\n@@ -273,7 +273,8 @@ cdef class Column:\n \n     def to_pandas(self,\n                   c_bool strings_to_categorical=False,\n-                  c_bool zero_copy_only=False):\n+                  c_bool zero_copy_only=False,\n+                  c_bool integer_object_nulls=False):\n         \"\"\"\n         Convert the arrow::Column to a pandas.Series\n \n@@ -287,7 +288,8 @@ cdef class Column:\n \n         options = PandasOptions(\n             strings_to_categorical=strings_to_categorical,\n-            zero_copy_only=zero_copy_only)\n+            zero_copy_only=zero_copy_only,\n+            integer_object_nulls=integer_object_nulls)\n \n         with nogil:\n             check_status(libarrow.ConvertColumnToPandas(options,\n@@ -1017,7 +1019,8 @@ cdef class Table:\n         return result\n \n     def to_pandas(self, nthreads=None, strings_to_categorical=False,\n-                  memory_pool=None, zero_copy_only=False, categories=None):\n+                  memory_pool=None, zero_copy_only=False, categories=None,\n+                  integer_object_nulls=False):\n         \"\"\"\n         Convert the arrow::Table to a pandas DataFrame\n \n@@ -1036,6 +1039,8 @@ cdef class Table:\n             the underlying data\n         categories: list, default empty\n             List of columns that should be returned as pandas.Categorical\n+        integer_object_nulls : boolean, default False\n+            Cast integers with nulls to objects\n \n         Returns\n         -------\n@@ -1046,7 +1051,8 @@ cdef class Table:\n \n         options = PandasOptions(\n             strings_to_categorical=strings_to_categorical,\n-            zero_copy_only=zero_copy_only)\n+            zero_copy_only=zero_copy_only,\n+            integer_object_nulls=integer_object_nulls)\n         self._check_nullptr()\n         if nthreads is None:\n             nthreads = cpu_count()\ndiff --git a/python/pyarrow/tests/test_convert_pandas.py b/python/pyarrow/tests/test_convert_pandas.py\nindex 986aeffca..a25337639 100644\n--- a/python/pyarrow/tests/test_convert_pandas.py\n+++ b/python/pyarrow/tests/test_convert_pandas.py\n@@ -634,6 +634,51 @@ def _check_type(t):\n         _check_type(pa.float64())\n \n \n+@pytest.mark.parametrize('dtype',\n+                         ['i1', 'i2', 'i4', 'i8', 'u1', 'u2', 'u4', 'u8'])\n+def test_array_integer_object_nulls_option(dtype):\n+    num_values = 100\n+\n+    null_mask = np.random.randint(0, 10, size=num_values) < 3\n+    values = np.random.randint(0, 100, size=num_values, dtype=dtype)\n+\n+    array = pa.array(values, mask=null_mask)\n+\n+    if null_mask.any():\n+        expected = values.astype('O')\n+        expected[null_mask] = None\n+    else:\n+        expected = values\n+\n+    result = array.to_pandas(integer_object_nulls=True)\n+\n+    np.testing.assert_equal(result, expected)\n+\n+\n+@pytest.mark.parametrize('dtype',\n+                         ['i1', 'i2', 'i4', 'i8', 'u1', 'u2', 'u4', 'u8'])\n+def test_table_integer_object_nulls_option(dtype):\n+    num_values = 100\n+\n+    null_mask = np.random.randint(0, 10, size=num_values) < 3\n+    values = np.random.randint(0, 100, size=num_values, dtype=dtype)\n+\n+    array = pa.array(values, mask=null_mask)\n+\n+    if null_mask.any():\n+        expected = values.astype('O')\n+        expected[null_mask] = None\n+    else:\n+        expected = values\n+\n+    expected = pd.DataFrame({dtype: expected})\n+\n+    table = pa.Table.from_arrays([array], [dtype])\n+    result = table.to_pandas(integer_object_nulls=True)\n+\n+    tm.assert_frame_equal(result, expected)\n+\n+\n class TestConvertDateTimeLikeTypes(object):\n     \"\"\"\n     Conversion tests for datetime- and timestamp-like types (date64, etc.).\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-02T14:31:53.510+0000",
                    "updated": "2018-03-02T14:31:53.510+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13140556/comment/16383639",
                    "id": "16383639",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 1650\n[https://github.com/apache/arrow/pull/1650]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2018-03-02T14:31:55.046+0000",
                    "updated": "2018-03-02T14:31:55.046+0000"
                }
            ],
            "maxResults": 17,
            "total": 17,
            "startAt": 0
        },
        "customfield_12311820": "0|i3qj6v:",
        "customfield_12314139": null
    }
}