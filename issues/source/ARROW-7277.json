{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13271306",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306",
    "key": "ARROW-7277",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fan_li_ya",
            "name": "fan_li_ya",
            "key": "fan_li_ya",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Liya Fan",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328933",
                "id": "12328933",
                "name": "Java"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fan_li_ya",
            "name": "fan_li_ya",
            "key": "fan_li_ya",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Liya Fan",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fan_li_ya",
            "name": "fan_li_ya",
            "key": "fan_li_ya",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Liya Fan",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "aggregateprogress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7277/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 10,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/354079",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "liyafan82 commented on pull request #5969: ARROW-7277: [Document] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969\n \n \n   As discussed in https://issues.apache.org/jira/browse/ARROW-7254?focusedCommentId=16983284&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16983284, we need a discussion about the lifecycle of a vector.\r\n   \r\n   Each vector has a lifecycle, and different operations should be performed in particular phases of the lifecycle. If we violate this, some unexpected results may be produced. This may cause some confusion for Arrow users. So we want to add a new section to the prose document, to make it clear and explicit.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-12-05T07:03:30.195+0000",
                    "updated": "2019-12-05T07:03:30.195+0000",
                    "started": "2019-12-05T07:03:30.195+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "354079",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/354082",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5969: ARROW-7277: [Document] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#issuecomment-562003661\n \n \n   https://issues.apache.org/jira/browse/ARROW-7277\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-12-05T07:15:42.580+0000",
                    "updated": "2019-12-05T07:15:42.580+0000",
                    "started": "2019-12-05T07:15:42.579+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "354082",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/358457",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on issue #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#issuecomment-564910863\n \n \n   @liyafan82 sorry, I've been backlogged will try to review your open PRs over the next week or so (unless others get to them sooner CC @praveenbingo @pravindra @BryanCutler)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-12-12T08:53:23.426+0000",
                    "updated": "2019-12-12T08:53:23.426+0000",
                    "started": "2019-12-12T08:53:23.426+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "358457",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/358482",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "liyafan82 commented on issue #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#issuecomment-564917812\n \n \n   > @liyafan82 sorry, I've been backlogged will try to review your open PRs over the next week or so (unless others get to them sooner CC @praveenbingo @pravindra @BryanCutler)\r\n   \r\n   @emkornfield Please do not be sorry. You have already given me so much help and guidance. I really appreciate all your effort and professional spirit. So please don't worry, just take your time. \r\n   \r\n   I think it is late in your location. I also notice that you often work late into night reviewing our PR. So I also hope you can take good care of your health and have some good rest :-)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-12-12T09:12:58.217+0000",
                    "updated": "2019-12-12T09:12:58.217+0000",
                    "started": "2019-12-12T09:12:58.217+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "358482",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/366094",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jacques-n commented on pull request #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#discussion_r362994688\n \n \n\n ##########\n File path: docs/source/java/vector.rst\n ##########\n @@ -41,50 +121,56 @@ Note that the current implementation doesn't enforce the rule that Arrow objects\n set/setSafe APIs and concrete subclasses of FieldWriter for populating values.\n \n For example, the code below shows how to build a :class:`BigIntVector`, in this case, we build a\n-vector of the range 0 to 7 where the element that should hold the fourth value is nulled::\n-\n-   BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n-\n-   BigIntVector vector = new BigIntVector(\"vector\", allocator);\n-   vector.allocateNew(8);\n-   vector.set(0, 1);\n-   vector.set(1, 2);\n-   vector.set(2, 3);\n-   vector.setNull(3);\n-   vector.set(4, 5);\n-   vector.set(5, 6);\n-   vector.set(6, 7);\n-   vector.set(7, 8);\n-   vector.setValueCount(8); // this will finalizes the vector by convention.\n+vector of the range 0 to 7 where the element that should hold the fourth value is nulled\n+\n+.. code-block:: Java\n+\n+    BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n \n Review comment:\n   I suggest you cover here or somewhere that most objects in Arrow implement AutoCloseable and in your demos you use try-with-resources to make that obvious. For example, it should be done here with both allocator and vector.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-03T23:36:13.513+0000",
                    "updated": "2020-01-03T23:36:13.513+0000",
                    "started": "2020-01-03T23:36:13.512+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "366094",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/366095",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jacques-n commented on pull request #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#discussion_r362994501\n \n \n\n ##########\n File path: docs/source/java/vector.rst\n ##########\n @@ -31,7 +31,87 @@ Table with non-intuitive names (BigInt = 64 bit integer, etc).\n \n It is important that vector is allocated before attempting to read or write,\n :class:`ValueVector` \"should\" strive to guarantee this order of operation:\n-allocate > mutate > set valuecount > access > clear (or allocate to start the process over)\n+create > allocate > mutate > set value count > access > clear (or allocate to start the process over).\n+We will go through a concrete example to demonstrate each operation in the next section.\n+\n+Vector Life Cycle\n+====================\n+As discussed above, each vector goes through several steps in its life cycle,\n+and each step is triggered by a vector operation. In particular, we have the following vector operations:\n+\n+1. **Vector creation**: we create a new vector object by, for example, the vector constructor.\n+The following code creates a new ``IntVector`` by the constructor:\n+\n+.. code-block:: Java\n+\n+    RootAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n+    ...\n+    IntVector vector = new IntVector(\"int vector\", allocator);\n+\n+By now, a vector object is created. However, no underlying memory has been allocated, so we need the\n+following step.\n+\n+2. **Vector allocation**: in this step, we allocate memory for the vector. For most vectors, we\n+have two options: 1) if we know the maximum vector capacity, we can specify it by calling the\n+``allocateNew(int)`` method; 2) otherwise, we should call the ``allocateNew()`` method, and  a default\n+capacity will be allocated for it. For our running example, we assume that the vector capacity never\n+exceeds 10:\n+\n+.. code-block:: Java\n+\n+    vector.allocateNew(10);\n+\n+3. **Vector mutation**: now we can populate the vector with values we desire. For all vectors, we can populate\n+vector values through vector writers (An example will be given in the next section). For primitive types,\n+we can also mutate the vector by the set methods. There are two classes of set methods: 1) if we can\n+be sure the vector has enough capacity, we can call the ``set(index, value)`` method. 2) if we are not sure\n+about the vector capacity, we should call the ``setSafe(index, value)`` method, which will automatically\n+take care of vector reallocation, if the capacity is not sufficient. For our running example, we know the\n+vector has enough capacity, so we can call\n+\n+.. code-block:: Java\n+\n+    vector.set(/*index*/5, /*value*/25);\n+\n+4. **Set value count**: for this step, we set the value count of the vector by calling the\n+``setValueCount(int)`` method:\n+\n+.. code-block:: Java\n+\n+    vector.setValueCount(10);\n+\n+After this step, the vector enters an immutable state. In other words, we should no longer mutate it.\n \n Review comment:\n   This is true unless we allocate again. Vectors are designed to be reused and thus this allocate, mutate, set valuecount, clear, allocate, mutate pattern will be done repeatedly in most cases.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-03T23:36:13.527+0000",
                    "updated": "2020-01-03T23:36:13.527+0000",
                    "started": "2020-01-03T23:36:13.526+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "366095",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/366171",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "liyafan82 commented on pull request #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#discussion_r363018200\n \n \n\n ##########\n File path: docs/source/java/vector.rst\n ##########\n @@ -31,7 +31,87 @@ Table with non-intuitive names (BigInt = 64 bit integer, etc).\n \n It is important that vector is allocated before attempting to read or write,\n :class:`ValueVector` \"should\" strive to guarantee this order of operation:\n-allocate > mutate > set valuecount > access > clear (or allocate to start the process over)\n+create > allocate > mutate > set value count > access > clear (or allocate to start the process over).\n+We will go through a concrete example to demonstrate each operation in the next section.\n+\n+Vector Life Cycle\n+====================\n+As discussed above, each vector goes through several steps in its life cycle,\n+and each step is triggered by a vector operation. In particular, we have the following vector operations:\n+\n+1. **Vector creation**: we create a new vector object by, for example, the vector constructor.\n+The following code creates a new ``IntVector`` by the constructor:\n+\n+.. code-block:: Java\n+\n+    RootAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n+    ...\n+    IntVector vector = new IntVector(\"int vector\", allocator);\n+\n+By now, a vector object is created. However, no underlying memory has been allocated, so we need the\n+following step.\n+\n+2. **Vector allocation**: in this step, we allocate memory for the vector. For most vectors, we\n+have two options: 1) if we know the maximum vector capacity, we can specify it by calling the\n+``allocateNew(int)`` method; 2) otherwise, we should call the ``allocateNew()`` method, and  a default\n+capacity will be allocated for it. For our running example, we assume that the vector capacity never\n+exceeds 10:\n+\n+.. code-block:: Java\n+\n+    vector.allocateNew(10);\n+\n+3. **Vector mutation**: now we can populate the vector with values we desire. For all vectors, we can populate\n+vector values through vector writers (An example will be given in the next section). For primitive types,\n+we can also mutate the vector by the set methods. There are two classes of set methods: 1) if we can\n+be sure the vector has enough capacity, we can call the ``set(index, value)`` method. 2) if we are not sure\n+about the vector capacity, we should call the ``setSafe(index, value)`` method, which will automatically\n+take care of vector reallocation, if the capacity is not sufficient. For our running example, we know the\n+vector has enough capacity, so we can call\n+\n+.. code-block:: Java\n+\n+    vector.set(/*index*/5, /*value*/25);\n+\n+4. **Set value count**: for this step, we set the value count of the vector by calling the\n+``setValueCount(int)`` method:\n+\n+.. code-block:: Java\n+\n+    vector.setValueCount(10);\n+\n+After this step, the vector enters an immutable state. In other words, we should no longer mutate it.\n \n Review comment:\n   Thanks for your comments.\r\n   I have added a note for this. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-04T05:53:55.653+0000",
                    "updated": "2020-01-04T05:53:55.653+0000",
                    "started": "2020-01-04T05:53:55.652+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "366171",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/366172",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "liyafan82 commented on pull request #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#discussion_r363018217\n \n \n\n ##########\n File path: docs/source/java/vector.rst\n ##########\n @@ -41,50 +121,56 @@ Note that the current implementation doesn't enforce the rule that Arrow objects\n set/setSafe APIs and concrete subclasses of FieldWriter for populating values.\n \n For example, the code below shows how to build a :class:`BigIntVector`, in this case, we build a\n-vector of the range 0 to 7 where the element that should hold the fourth value is nulled::\n-\n-   BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n-\n-   BigIntVector vector = new BigIntVector(\"vector\", allocator);\n-   vector.allocateNew(8);\n-   vector.set(0, 1);\n-   vector.set(1, 2);\n-   vector.set(2, 3);\n-   vector.setNull(3);\n-   vector.set(4, 5);\n-   vector.set(5, 6);\n-   vector.set(6, 7);\n-   vector.set(7, 8);\n-   vector.setValueCount(8); // this will finalizes the vector by convention.\n+vector of the range 0 to 7 where the element that should hold the fourth value is nulled\n+\n+.. code-block:: Java\n+\n+    BufferAllocator allocator = new RootAllocator(Long.MAX_VALUE);\n \n Review comment:\n   Good point. Thanks. \r\n   I have added revised the code snippet, and added a note by the end of the first section. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-04T05:55:02.095+0000",
                    "updated": "2020-01-04T05:55:02.095+0000",
                    "started": "2020-01-04T05:55:02.095+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "366172",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/370287",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on issue #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969#issuecomment-573280332\n \n \n   Going to merge this.  Thanks.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-11T04:31:34.838+0000",
                    "updated": "2020-01-11T04:31:34.838+0000",
                    "started": "2020-01-11T04:31:34.838+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "370287",
                    "issueId": "13271306"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/worklog/370290",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #5969: ARROW-7277: [Java] [Doc] Add discussion about vector lifecycle\nURL: https://github.com/apache/arrow/pull/5969\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-11T04:34:32.410+0000",
                    "updated": "2020-01-11T04:34:32.410+0000",
                    "started": "2020-01-11T04:34:32.410+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "370290",
                    "issueId": "13271306"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 5400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@478b1538[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33b2f4c1[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4cdf4020[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@686fa186[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@706da43b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@36a41032[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@cc8886[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@153a6a88[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@8eb5868[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1ed8ecc7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7ab4cf22[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3c1c84d6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 5400,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Jan 11 04:34:35 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-01-11T04:34:35.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7277/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-11-29T02:53:34.000+0000",
        "updated": "2020-01-11T04:34:35.000+0000",
        "timeoriginalestimate": null,
        "description": "As discussed in https://issues.apache.org/jira/browse/ARROW-7254?focusedCommentId=16983284&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16983284, we need a discussion about the lifecycle of a vector.\r\n\r\nEach vector has a lifecycle, and different operations should be performed in particular phases of the lifecycle. If we violate this, some unexpected results may be produced. This may cause some confusion for Arrow users. So we want to add a new section to the prose document, to make it clear and explicit.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 5400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Document] Add discussion about vector lifecycle",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13271306/comment/17013374",
                    "id": "17013374",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
                        "name": "emkornfield@gmail.com",
                        "key": "emkornfield@gmail.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Micah Kornfield",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 5969\n[https://github.com/apache/arrow/pull/5969]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
                        "name": "emkornfield@gmail.com",
                        "key": "emkornfield@gmail.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Micah Kornfield",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-01-11T04:34:35.890+0000",
                    "updated": "2020-01-11T04:34:35.890+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z094io:",
        "customfield_12314139": null
    }
}