{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13259863",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863",
    "key": "ARROW-6749",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12608702",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12608702",
                "type": {
                    "id": "12310051",
                    "name": "Supercedes",
                    "inward": "is superceded by",
                    "outward": "supercedes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310051"
                },
                "outwardIssue": {
                    "id": "13172245",
                    "key": "ARROW-2853",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13172245",
                    "fields": {
                        "summary": "[Python] Implementing support for zero copy NumPy arrays in libarrow_python",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6749/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 20,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/332606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718\n \n \n   `Array.to_numpy` converts to a numpy array zero-copy. It currently does that with a custom `np.frombuffer` (although with a bug for timestamp data, which was the original report in [ARROW-6749](https://issues.apache.org/jira/browse/ARROW-6749)), while we also have the `zero_copy_only` guarantee in the arrow->python conversion code. So here I try to switch to that.\r\n   \r\n   - I added a zero_copy conversion for Timestamp/Duration. I *think* this can correctly be done since the memory layout for the actual values is identical with numpy (not sure if there is a specific reason it was not done before)\r\n   - One consequence of using the conversion code is that the resulting numpy array is non-writable. While the current `to_numpy` created a writable array (and the tests actually used this property to check the zero-copy assumption, which is why tests are now failing). Are we OK with that restriction?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-23T14:32:23.134+0000",
                    "updated": "2019-10-23T14:32:23.134+0000",
                    "started": "2019-10-23T14:32:23.134+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "332606",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/332619",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-545479842\n \n \n   https://issues.apache.org/jira/browse/ARROW-6749\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-23T14:47:00.352+0000",
                    "updated": "2019-10-23T14:47:00.352+0000",
                    "started": "2019-10-23T14:47:00.351+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "332619",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/334256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r339169833\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -947,10 +947,18 @@ cdef class Array(_PandasConvertible):\n         if not is_primitive(self.type.id) or self.type.id == _Type_BOOL:\n             raise NotImplementedError('NumPy array view is only supported '\n                                       'for primitive types.')\n-        buflist = self.buffers()\n-        assert len(buflist) == 2\n-        return np.frombuffer(buflist[-1], dtype=self.type.to_pandas_dtype())[\n-            self.offset:self.offset + len(self)]\n+\n+        cdef:\n+            PyObject* out\n+            PandasOptions c_options\n+            object values\n+\n+        c_options.zero_copy_only = True\n \n Review comment:\n   Hm. This seems too restrictive. If we can zero-copy, then let's do so, but we should not fail if it's not possible.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-25T17:54:19.012+0000",
                    "updated": "2019-10-25T17:54:19.012+0000",
                    "started": "2019-10-25T17:54:19.011+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "334256",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/334260",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r339172233\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -947,10 +947,18 @@ cdef class Array(_PandasConvertible):\n         if not is_primitive(self.type.id) or self.type.id == _Type_BOOL:\n             raise NotImplementedError('NumPy array view is only supported '\n                                       'for primitive types.')\n-        buflist = self.buffers()\n-        assert len(buflist) == 2\n-        return np.frombuffer(buflist[-1], dtype=self.type.to_pandas_dtype())[\n-            self.offset:self.offset + len(self)]\n+\n+        cdef:\n+            PyObject* out\n+            PandasOptions c_options\n+            object values\n+\n+        c_options.zero_copy_only = True\n \n Review comment:\n   I just replicated the current `to_numpy` behaviour of only allowing zero-copy conversion (the docstring says to return a numpy view on the arrow array). \r\n   \r\n   But we can certainly expand the scope, eg adding a `zero_copy_only` keyword like other conversions have?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-25T17:58:51.840+0000",
                    "updated": "2019-10-25T17:58:51.840+0000",
                    "started": "2019-10-25T17:58:51.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "334260",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/334264",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-546453539\n \n \n   > But we can certainly expand the scope, eg adding a zero_copy_only keyword like other conversions have?\r\n   \r\n   However, from the original JIRA issues (https://issues.apache.org/jira/browse/ARROW-2853, https://issues.apache.org/jira/browse/ARROW-564), there is the idea to return a tuple of (values, bytemap) (in which case the values would still be a view for primitive types)\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-25T18:02:38.518+0000",
                    "updated": "2019-10-25T18:02:38.518+0000",
                    "started": "2019-10-25T18:02:38.518+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "334264",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/338794",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-549853423\n \n \n   > I added a zero_copy conversion for Timestamp/Duration. I think this can correctly be done since the memory layout for the actual values is identical with numpy (not sure if there is a specific reason it was not done before)\r\n   \r\n   Isn't there the issue of NaT values (represented as nulls under Arrow)?\r\n   \r\n   > While the current to_numpy created a writable array \r\n   \r\n   That sounds wrong. Arrow data is immutable, we should not allow modifying it through Numpy.\r\n   \r\n   > But we can certainly expand the scope, eg adding a zero_copy_only keyword like other conversions have?\r\n   \r\n   That sounds reasonable to me. Perhaps also a `writable = False` keyword (which would then force a copy if True)?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-05T14:45:31.943+0000",
                    "updated": "2019-11-05T14:45:31.943+0000",
                    "started": "2019-11-05T14:45:31.942+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "338794",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/338846",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-549895781\n \n \n   > Isn't there the issue of NaT values (represented as nulls under Arrow)?\r\n   \r\n   Yes, in such a case a copy is still needed (just like other primitive types as well). There is a check for null_count being zero when trying to do zero copy (but I should add a test for that!).\r\n   \r\n   > That sounds wrong. Arrow data is immutable, we should not allow modifying it through Numpy.\r\n   \r\n   OK, will update the tests to not expect being able to modify the data (this is a backwards incompatible change, though. But since the function is labelled as experimental in its docstring, I suppose it is fine to just change it).\r\n   \r\n   Thoughts on what to do with the validity bitmap? \r\n   As I mentioned, this was one of the original ideas in the JIRA issues to provide an API to get a (values, bytemap) tuple. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-05T16:28:37.694+0000",
                    "updated": "2019-11-05T16:28:37.694+0000",
                    "started": "2019-11-05T16:28:37.694+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "338846",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/339266",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-550228516\n \n \n   > Thoughts on what to do with the validity bitmap?\r\n   \r\n   You could add a `null_bitmap=False` argument that would return a tuple. But what would be the return type be for the null bitmap? A zero-copy `uint8` array? Something else?\r\n   \r\n   Alternatively `masked_array=True` would return a Numpy masked array. Then the bitmap is not zero-copy (Numpy uses a byte per validity bit). It might be more idiomatic, though.\r\n   \r\n   In any case, it doesn't seem it should be part of this PR.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-06T09:39:50.201+0000",
                    "updated": "2019-11-06T09:39:50.201+0000",
                    "started": "2019-11-06T09:39:50.201+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "339266",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/342782",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553545356\n \n \n   I updated this to add a `zero_copy_only` and `writable` arguments. Both arguments do overlap somewhat though (eg if you set `writable=True`, it will never be zero copy)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-13T18:47:11.870+0000",
                    "updated": "2019-11-13T18:47:11.870+0000",
                    "started": "2019-11-13T18:47:11.869+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "342782",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/342785",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r345936368\n \n \n\n ##########\n File path: python/pyarrow/tests/test_array.py\n ##########\n @@ -116,9 +116,6 @@ def test_to_numpy_zero_copy():\n     old_refcount = sys.getrefcount(arr)\n \n     np_arr = arr.to_numpy()\n-    np_arr[0] = 1\n-    assert arr[0] == 1\n-\n     assert sys.getrefcount(arr) == old_refcount\n \n Review comment:\n   I am not fully sure what this was testing, but this line is what's failing the tests now (I suppose because `np_arr` is now referencing `arr`)\r\n   \r\n   Also, is there another way to test that it was actually done zero copy? (the writing to it and see if it was updated no longer works)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-13T18:50:42.614+0000",
                    "updated": "2019-11-13T18:50:42.614+0000",
                    "started": "2019-11-13T18:50:42.613+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "342785",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343274",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r346214342\n \n \n\n ##########\n File path: python/pyarrow/tests/test_array.py\n ##########\n @@ -116,9 +116,6 @@ def test_to_numpy_zero_copy():\n     old_refcount = sys.getrefcount(arr)\n \n     np_arr = arr.to_numpy()\n-    np_arr[0] = 1\n-    assert arr[0] == 1\n-\n     assert sys.getrefcount(arr) == old_refcount\n \n Review comment:\n   You could check the raw addresses:\r\n   ```python\r\n   >>> a = pa.array([1,2,3])                                                                                                                                         \r\n   >>> buf = a.buffers()[1]                                                                                                                                          \r\n   >>> buf.address                                                                                                                                                   \r\n   140489076547648\r\n   >>> arr = a.to_numpy()                                                                                                                                            \r\n   >>> arr.ctypes.data                                                                                                                                               \r\n   140489076547648\r\n   \r\n   ```\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T09:48:35.440+0000",
                    "updated": "2019-11-14T09:48:35.440+0000",
                    "started": "2019-11-14T09:48:35.440+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343274",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343277",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r346214707\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -951,26 +951,43 @@ cdef class Array(_PandasConvertible):\n             return values\n         return values.astype(dtype)\n \n-    def to_numpy(self):\n+    def to_numpy(self, zero_copy_only=True, writable=False):\n         \"\"\"\n         Experimental: return a NumPy view of this array. Only primitive\n         arrays with the same memory layout as NumPy (i.e. integers,\n         floating point), without any nulls, are supported.\n \n+        Parameters\n+        ----------\n+        zero_copy_only : bool, default True\n+            If True, an exception will be raised if the conversion to a numpy\n+            array would require copying the underlying data (e.g. in presence\n+            of nulls, or for non-primitive types).\n+        writable : bool, default False\n+            For numpy arrays created with zero copy (view on the Arrow data),\n+            the resulting array is not writable (Arrow data is immutable).\n+            By setting this to True, a copy of the array is made to ensure\n+            it is writable.\n+\n         Returns\n         -------\n         array : numpy.ndarray\n         \"\"\"\n-        if self.null_count:\n-            raise NotImplementedError('NumPy array view is only supported '\n-                                      'for arrays without nulls.')\n-        if not is_primitive(self.type.id) or self.type.id == _Type_BOOL:\n-            raise NotImplementedError('NumPy array view is only supported '\n-                                      'for primitive types.')\n-        buflist = self.buffers()\n-        assert len(buflist) == 2\n-        return np.frombuffer(buflist[-1], dtype=self.type.to_pandas_dtype())[\n-            self.offset:self.offset + len(self)]\n+        cdef:\n+            PyObject* out\n+            PandasOptions c_options\n+            object values\n+\n+        c_options.zero_copy_only = zero_copy_only\n+\n+        with nogil:\n+            check_status(ConvertArrayToPandas(c_options, self.sp_array,\n+                                              self, &out))\n+        array = PyObject_to_object(out)\n+        if writable and not array.flags[\"WRITEABLE\"]:\n \n Review comment:\n   `array.flags.writeable`, no? The dict lookup looks a bit gratuitous?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T09:52:00.253+0000",
                    "updated": "2019-11-14T09:52:00.253+0000",
                    "started": "2019-11-14T09:52:00.253+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343277",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343278",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#discussion_r346215115\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -951,26 +951,43 @@ cdef class Array(_PandasConvertible):\n             return values\n         return values.astype(dtype)\n \n-    def to_numpy(self):\n+    def to_numpy(self, zero_copy_only=True, writable=False):\n \n Review comment:\n   I think we should raise `ValueError` if both `zero_copy_only` and `writable` are true. This would prevent user errors or surprises.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T09:52:00.265+0000",
                    "updated": "2019-11-14T09:52:00.265+0000",
                    "started": "2019-11-14T09:52:00.265+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343278",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553909536\n \n \n   You should check the C++ linting failures, otherwise looks good.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T14:23:03.130+0000",
                    "updated": "2019-11-14T14:23:03.130+0000",
                    "started": "2019-11-14T14:23:03.130+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343437",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343474",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553940040\n \n \n   All green now (except waiting on appveyor)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T15:32:11.032+0000",
                    "updated": "2019-11-14T15:32:11.032+0000",
                    "started": "2019-11-14T15:32:11.032+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343474",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343475",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553940170\n \n \n   Do you have AppVeyor enabled on your fork?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T15:32:30.190+0000",
                    "updated": "2019-11-14T15:32:30.190+0000",
                    "started": "2019-11-14T15:32:30.189+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343475",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343478",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553941857\n \n \n   Yes, but it seems it failed there: https://ci.appveyor.com/project/jorisvandenbossche/arrow/builds/28859307 (build error related to flight)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T15:36:13.720+0000",
                    "updated": "2019-11-14T15:36:13.720+0000",
                    "started": "2019-11-14T15:36:13.719+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343478",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343479",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553942318\n \n \n   Ah, you should rebase, it was fixed on master :-)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T15:37:16.817+0000",
                    "updated": "2019-11-14T15:37:16.817+0000",
                    "started": "2019-11-14T15:37:16.817+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343479",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343518",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718#issuecomment-553973843\n \n \n   AppVeyor build: https://ci.appveyor.com/project/jorisvandenbossche/arrow/builds/28861094\r\n   Will merge if green.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T16:44:31.455+0000",
                    "updated": "2019-11-14T16:44:31.455+0000",
                    "started": "2019-11-14T16:44:31.455+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343518",
                    "issueId": "13259863"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/worklog/343557",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5718: ARROW-6749: [Python] Let Array.to_numpy use general conversion code with zero_copy_only=True\nURL: https://github.com/apache/arrow/pull/5718\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T17:19:05.638+0000",
                    "updated": "2019-11-14T17:19:05.638+0000",
                    "started": "2019-11-14T17:19:05.638+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343557",
                    "issueId": "13259863"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 11400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@66570e84[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7915d7a6[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1de9469[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@56a1db13[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2be04bd4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6811c635[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d997a82[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@45384361[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6caf0ef9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@ae95d37[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5c726b82[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5b560826[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 11400,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Nov 14 17:19:01 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-11-14T17:19:01.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6749/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2019-10-01T10:07:48.000+0000",
        "updated": "2021-02-17T16:30:25.000+0000",
        "timeoriginalestimate": null,
        "description": "{code}\r\nIn [25]: np_arr = np.arange(\"2012-01-01\", \"2012-01-06\", int(1e6)*60*60*24, dtype=\"datetime64[us]\")                                                                                                                 \r\n\r\nIn [26]: np_arr                                                                                                                                                                                                    \r\nOut[26]: \r\narray(['2012-01-01T00:00:00.000000', '2012-01-02T00:00:00.000000',\r\n       '2012-01-03T00:00:00.000000', '2012-01-04T00:00:00.000000',\r\n       '2012-01-05T00:00:00.000000'], dtype='datetime64[us]')\r\n\r\nIn [27]: arr = pa.array(np_arr)                                                                                                                                                                                    \r\n\r\nIn [28]: arr                                                                                                                                                                                                       \r\nOut[28]: \r\n<pyarrow.lib.TimestampArray object at 0x7f0b2ef07ee8>\r\n[\r\n  2012-01-01 00:00:00.000000,\r\n  2012-01-02 00:00:00.000000,\r\n  2012-01-03 00:00:00.000000,\r\n  2012-01-04 00:00:00.000000,\r\n  2012-01-05 00:00:00.000000\r\n]\r\n\r\nIn [29]: arr.type                                                                                                                                                                                                  \r\nOut[29]: TimestampType(timestamp[us])\r\n\r\nIn [30]: arr.to_numpy()                                                                                                                                                                                            \r\nOut[30]: \r\narray(['1970-01-16T08:09:36.000000000', '1970-01-16T08:11:02.400000000',\r\n       '1970-01-16T08:12:28.800000000', '1970-01-16T08:13:55.200000000',\r\n       '1970-01-16T08:15:21.600000000'], dtype='datetime64[ns]')\r\n{code}\r\n\r\nSo it seems to simply interpret the integer microsecond values as nanoseconds when converting to numpy.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 11400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Conversion of non-ns timestamp array to numpy gives wrong values",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/comment/16941724",
                    "id": "16941724",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "So the reason for this is that we are taking a view on the buffer using {{dtype=self.type.to_pandas_dtype()}}, which returns the \"wrong\" thing:\r\n\r\n{code}\r\nIn [48]: arr.type                                                                                                                                                                                                  \r\nOut[48]: TimestampType(timestamp[us])\r\n\r\nIn [49]: arr.type.to_pandas_dtype()                                                                                                                                                                                \r\nOut[49]: dtype('<M8[ns]')\r\n{code}\r\n\r\nI am putting \"wrong\" in quotes as it is correct that this is the dtype that pandas will use to store such values in a pandas dataframe (but, it will then convert the values of course). But if you use it here to construct a numpy array like that, it is of course the wrong dtype.\r\n\r\nJust to note here: this is only for {{to_numpy}}. The {{np.(as)array(..)}} (using {{\\_\\_array\\_\\_}}) works fine (this uses the {{ConvertArrayToPandas}} C++ functionality, which handles this correctly).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2019-10-01T10:32:25.490+0000",
                    "updated": "2019-10-01T10:32:25.490+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/comment/16941725",
                    "id": "16941725",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "We seem to explicitly test this right now that an arrow non-ns timestamp type gives datetime64[ns] in to_pandas_dtype ..",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2019-10-01T10:36:57.465+0000",
                    "updated": "2019-10-01T10:36:57.465+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13259863/comment/16974462",
                    "id": "16974462",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 5718\n[https://github.com/apache/arrow/pull/5718]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2019-11-14T17:19:01.792+0000",
                    "updated": "2019-11-14T17:19:01.792+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z076s0:",
        "customfield_12314139": null
    }
}