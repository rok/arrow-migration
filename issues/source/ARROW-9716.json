{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13322423",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423",
    "key": "ARROW-9716",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "aggregateprogress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9716/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 19,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470012",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove opened a new pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T00:21:07.653+0000",
                    "updated": "2020-08-13T00:21:07.653+0000",
                    "started": "2020-08-13T00:21:07.653+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470012",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470013",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673173406\n\n\n   @alamb This is a quick version of what we were discussing\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T00:22:11.345+0000",
                    "updated": "2020-08-13T00:22:11.345+0000",
                    "started": "2020-08-13T00:22:11.345+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470013",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470024",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r469629508\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -80,9 +82,16 @@ fn tuple_err<T, R>(value: (Result<T>, Result<R>)) -> Result<(T, R)> {\n impl ExecutionContext {\n     /// Create a new execution context for in-memory queries\n     pub fn new() -> Self {\n+        Self::with_max_concurrency(2)\n+    }\n+\n+    /// Create a new execution context for in-memory queries with the specified maximum\n+    /// concurrency\n+    pub fn with_max_concurrency(max_concurrency: usize) -> Self {\n\nReview comment:\n       This is lame. It is probably time we had a config struct to pass in.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T00:48:09.384+0000",
                    "updated": "2020-08-13T00:48:09.384+0000",
                    "started": "2020-08-13T00:48:09.384+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470024",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470026",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673183472\n\n\n   https://issues.apache.org/jira/browse/ARROW-9716\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T00:49:05.353+0000",
                    "updated": "2020-08-13T00:49:05.353+0000",
                    "started": "2020-08-13T00:49:05.352+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470026",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470242",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673495888\n\n\n   Actually this needs to happen in multipe operators, not just MergeExec, so I am exploring adding a thread pool crate now to avoid boilerplate code everywhere.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T13:59:42.630+0000",
                    "updated": "2020-08-13T13:59:42.630+0000",
                    "started": "2020-08-13T13:59:42.629+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470242",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470243",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove edited a comment on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673495888\n\n\n   Actually this needs to happen in multiple operators, not just MergeExec, so I am exploring adding a thread pool crate now to avoid boilerplate code everywhere.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T13:59:45.647+0000",
                    "updated": "2020-08-13T13:59:45.647+0000",
                    "started": "2020-08-13T13:59:45.647+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470243",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470273",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470019311\n\n\n\n##########\nFile path: rust/datafusion/src/execution/physical_plan/merge.rs\n##########\n@@ -64,33 +75,51 @@ struct MergePartition {\n     schema: SchemaRef,\n     /// Input partitions\n     partitions: Vec<Arc<dyn Partition>>,\n+    /// Maximum number of concurrent threads\n+    max_concurrency: usize,\n+}\n+\n+fn collect_from_thread(\n+    thread: JoinHandle<Result<Vec<RecordBatch>>>,\n+    combined_results: &mut Vec<Arc<RecordBatch>>,\n+) -> Result<()> {\n+    match thread.join() {\n+        Ok(join) => {\n+            join?\n+                .iter()\n+                .for_each(|batch| combined_results.push(Arc::new(batch.clone())));\n+            Ok(())\n+        }\n+        Err(e) => Err(ExecutionError::General(format!(\n+            \"Error collecting batches from thread: {:?}\",\n+            e\n+        ))),\n+    }\n }\n \n impl Partition for MergePartition {\n     fn execute(&self) -> Result<Arc<Mutex<dyn RecordBatchReader + Send + Sync>>> {\n-        let threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = self\n-            .partitions\n-            .iter()\n-            .map(|p| {\n-                let p = p.clone();\n-                thread::spawn(move || {\n-                    let it = p.execute()?;\n-                    common::collect(it)\n-                })\n-            })\n-            .collect();\n+        let mut combined_results: Vec<Arc<RecordBatch>> = vec![];\n+        let mut threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = vec![];\n+\n+        for partition in &self.partitions {\n+            // limit number of concurrent threads\n+            if threads.len() == self.max_concurrency {\n\nReview comment:\n       This approach (to wait for an arbitrary thread (thread 0) to be done) can lead to cases where the thread you are waiting on happens to have a large amount of work but other threads are waiting on the next partitions. Thus you can block here with only one thread working.\r\n   \r\n   Another approach that would avoid that starvation would be to put the partitions into a `Arc<Mutex<Channel>>` and then have the threads each read and process partitions from that channel. \r\n   \r\n   I can try and whip that up if you would like a specific code example of what I am talking about\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -62,10 +62,31 @@ use crate::sql::{\n };\n use crate::table::Table;\n \n+/// Configuration options for execution context\n+#[derive(Copy, Clone)]\n+pub struct ExecutionConfig {\n+    /// Maximum number of concurrent threads for query execution\n+    max_concurrency: usize,\n+}\n+\n+impl ExecutionConfig {\n+    /// Create an execution config with default settings\n+    pub fn new() -> Self {\n+        Self { max_concurrency: 2 }\n\nReview comment:\n       I think the canonical choice for default concurrency is \"number of CPU cores on the machine\", which is the approach that Rayon takes and I think you can use this Rust library: https://docs.rs/num_cpus/1.13.0/num_cpus/\n\n##########\nFile path: rust/datafusion/src/execution/physical_plan/merge.rs\n##########\n@@ -64,33 +75,51 @@ struct MergePartition {\n     schema: SchemaRef,\n     /// Input partitions\n     partitions: Vec<Arc<dyn Partition>>,\n+    /// Maximum number of concurrent threads\n+    max_concurrency: usize,\n+}\n+\n+fn collect_from_thread(\n\nReview comment:\n       \ud83d\udc4d  Nice refactor\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T15:02:51.237+0000",
                    "updated": "2020-08-13T15:02:51.237+0000",
                    "started": "2020-08-13T15:02:51.237+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470273",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470274",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673532846\n\n\n   > so I am exploring adding a thread pool crate now to avoid boilerplate code everywhere.\r\n   \r\n   @andygrove  -- FWIW I had great luck with Rayon (and its parallel iterators in particular) -- it took care of a lot of the mess I was talking about in https://github.com/apache/arrow/pull/7951#discussion_r470019311 -- in other words, using a rayon parallel iterator would behave well if you are willing to add a rayon dependency \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T15:05:34.507+0000",
                    "updated": "2020-08-13T15:05:34.507+0000",
                    "started": "2020-08-13T15:05:34.507+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470274",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470284",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470036542\n\n\n\n##########\nFile path: rust/datafusion/src/execution/physical_plan/merge.rs\n##########\n@@ -64,33 +75,51 @@ struct MergePartition {\n     schema: SchemaRef,\n     /// Input partitions\n     partitions: Vec<Arc<dyn Partition>>,\n+    /// Maximum number of concurrent threads\n+    max_concurrency: usize,\n+}\n+\n+fn collect_from_thread(\n+    thread: JoinHandle<Result<Vec<RecordBatch>>>,\n+    combined_results: &mut Vec<Arc<RecordBatch>>,\n+) -> Result<()> {\n+    match thread.join() {\n+        Ok(join) => {\n+            join?\n+                .iter()\n+                .for_each(|batch| combined_results.push(Arc::new(batch.clone())));\n+            Ok(())\n+        }\n+        Err(e) => Err(ExecutionError::General(format!(\n+            \"Error collecting batches from thread: {:?}\",\n+            e\n+        ))),\n+    }\n }\n \n impl Partition for MergePartition {\n     fn execute(&self) -> Result<Arc<Mutex<dyn RecordBatchReader + Send + Sync>>> {\n-        let threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = self\n-            .partitions\n-            .iter()\n-            .map(|p| {\n-                let p = p.clone();\n-                thread::spawn(move || {\n-                    let it = p.execute()?;\n-                    common::collect(it)\n-                })\n-            })\n-            .collect();\n+        let mut combined_results: Vec<Arc<RecordBatch>> = vec![];\n+        let mut threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = vec![];\n+\n+        for partition in &self.partitions {\n+            // limit number of concurrent threads\n+            if threads.len() == self.max_concurrency {\n\nReview comment:\n       Sure, I use that approach already in Ballista. I can make that change here as well. \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T15:26:52.770+0000",
                    "updated": "2020-08-13T15:26:52.770+0000",
                    "started": "2020-08-13T15:26:52.770+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470284",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470499",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-673768514\n\n\n   @alamb How would you feel about us merging this, and then you follow up with an improved approach? I did have a quick attempt at using Rayon but you would probably be able to do this faster and more correctly than I could right now.\r\n   \r\n   With this and the other pending PRs, I can run TPC-H query 1 against a 100 GB data set with 240 partitions with reasonable performance (about the same as Apache Spark).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T00:06:13.163+0000",
                    "updated": "2020-08-14T00:06:13.163+0000",
                    "started": "2020-08-14T00:06:13.163+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470499",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470586",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470421892\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -62,10 +62,31 @@ use crate::sql::{\n };\n use crate::table::Table;\n \n+/// Configuration options for execution context\n+#[derive(Copy, Clone)]\n+pub struct ExecutionConfig {\n+    /// Maximum number of concurrent threads for query execution\n+    max_concurrency: usize,\n\nReview comment:\n       Isn't it simpler to make this value public instead of having `with_max_concurrency` as a setter?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T05:45:21.383+0000",
                    "updated": "2020-08-14T05:45:21.383+0000",
                    "started": "2020-08-14T05:45:21.383+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470586",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470602850\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -62,10 +62,31 @@ use crate::sql::{\n };\n use crate::table::Table;\n \n+/// Configuration options for execution context\n+#[derive(Copy, Clone)]\n+pub struct ExecutionConfig {\n+    /// Maximum number of concurrent threads for query execution\n+    max_concurrency: usize,\n+}\n+\n+impl ExecutionConfig {\n+    /// Create an execution config with default settings\n+    pub fn new() -> Self {\n+        Self { max_concurrency: 2 }\n\nReview comment:\n       Thanks. I have made this change.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T12:48:43.465+0000",
                    "updated": "2020-08-14T12:48:43.465+0000",
                    "started": "2020-08-14T12:48:43.465+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470678",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470679",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470602921\n\n\n\n##########\nFile path: rust/datafusion/src/execution/physical_plan/merge.rs\n##########\n@@ -64,33 +75,51 @@ struct MergePartition {\n     schema: SchemaRef,\n     /// Input partitions\n     partitions: Vec<Arc<dyn Partition>>,\n+    /// Maximum number of concurrent threads\n+    max_concurrency: usize,\n+}\n+\n+fn collect_from_thread(\n+    thread: JoinHandle<Result<Vec<RecordBatch>>>,\n+    combined_results: &mut Vec<Arc<RecordBatch>>,\n+) -> Result<()> {\n+    match thread.join() {\n+        Ok(join) => {\n+            join?\n+                .iter()\n+                .for_each(|batch| combined_results.push(Arc::new(batch.clone())));\n+            Ok(())\n+        }\n+        Err(e) => Err(ExecutionError::General(format!(\n+            \"Error collecting batches from thread: {:?}\",\n+            e\n+        ))),\n+    }\n }\n \n impl Partition for MergePartition {\n     fn execute(&self) -> Result<Arc<Mutex<dyn RecordBatchReader + Send + Sync>>> {\n-        let threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = self\n-            .partitions\n-            .iter()\n-            .map(|p| {\n-                let p = p.clone();\n-                thread::spawn(move || {\n-                    let it = p.execute()?;\n-                    common::collect(it)\n-                })\n-            })\n-            .collect();\n+        let mut combined_results: Vec<Arc<RecordBatch>> = vec![];\n+        let mut threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = vec![];\n+\n+        for partition in &self.partitions {\n+            // limit number of concurrent threads\n+            if threads.len() == self.max_concurrency {\n\nReview comment:\n       This is now implemented.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T12:48:56.596+0000",
                    "updated": "2020-08-14T12:48:56.596+0000",
                    "started": "2020-08-14T12:48:56.596+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470679",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470680",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470603772\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -62,10 +62,31 @@ use crate::sql::{\n };\n use crate::table::Table;\n \n+/// Configuration options for execution context\n+#[derive(Copy, Clone)]\n+pub struct ExecutionConfig {\n+    /// Maximum number of concurrent threads for query execution\n+    max_concurrency: usize,\n\nReview comment:\n       I was following the builder pattern that @houqp introduced with `CsvReadOptions`. Once we have more configs we can chain them together, like this:\r\n   \r\n   ```\r\n   ExecutionConfig::new()\r\n     .with_concurrency(48)\r\n     .with_foo(...)\r\n     .with_bar(...)\r\n   ```\r\n   \r\n   We can also add validation logic in these methods. For example, I have now added an assertion in `with_concurrency` to assert that the argument is > 0.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T12:50:49.652+0000",
                    "updated": "2020-08-14T12:50:49.652+0000",
                    "started": "2020-08-14T12:50:49.652+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470680",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470691",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-674065115\n\n\n   @alamb @jorgecarleitao This is ready for re-review.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T13:06:39.134+0000",
                    "updated": "2020-08-14T13:06:39.134+0000",
                    "started": "2020-08-14T13:06:39.134+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470691",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470745",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470725832\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -62,10 +62,31 @@ use crate::sql::{\n };\n use crate::table::Table;\n \n+/// Configuration options for execution context\n+#[derive(Copy, Clone)]\n+pub struct ExecutionConfig {\n+    /// Maximum number of concurrent threads for query execution\n+    max_concurrency: usize,\n\nReview comment:\n       Thanks for the explanation. I agree.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T16:23:10.391+0000",
                    "updated": "2020-08-14T16:23:10.391+0000",
                    "started": "2020-08-14T16:23:10.390+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470745",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470753",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove closed pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T16:37:12.962+0000",
                    "updated": "2020-08-14T16:37:12.962+0000",
                    "started": "2020-08-14T16:37:12.961+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470753",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#issuecomment-674181449\n\n\n   > @alamb How would you feel about us merging this, and then you follow up with an improved approach? I did have a quick attempt at using Rayon but you would probably be able to do this faster and more correctly than I could right now.\r\n   \r\n   I think it is a good idea (for the record) :)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T17:28:48.620+0000",
                    "updated": "2020-08-14T17:28:48.620+0000",
                    "started": "2020-08-14T17:28:48.620+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470784",
                    "issueId": "13322423"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/worklog/470786",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #7951:\nURL: https://github.com/apache/arrow/pull/7951#discussion_r470759208\n\n\n\n##########\nFile path: rust/datafusion/src/execution/physical_plan/merge.rs\n##########\n@@ -64,39 +76,70 @@ struct MergePartition {\n     schema: SchemaRef,\n     /// Input partitions\n     partitions: Vec<Arc<dyn Partition>>,\n+    /// Maximum number of concurrent threads\n+    concurrency: usize,\n+}\n+\n+fn collect_from_thread(\n+    thread: JoinHandle<Result<Vec<RecordBatch>>>,\n+    combined_results: &mut Vec<Arc<RecordBatch>>,\n+) -> Result<()> {\n+    match thread.join() {\n+        Ok(join) => {\n+            join?\n+                .iter()\n+                .for_each(|batch| combined_results.push(Arc::new(batch.clone())));\n+            Ok(())\n+        }\n+        Err(e) => Err(ExecutionError::General(format!(\n+            \"Error collecting batches from thread: {:?}\",\n+            e\n+        ))),\n+    }\n }\n \n impl Partition for MergePartition {\n     fn execute(&self) -> Result<Arc<Mutex<dyn RecordBatchReader + Send + Sync>>> {\n-        let threads: Vec<JoinHandle<Result<Vec<RecordBatch>>>> = self\n-            .partitions\n-            .iter()\n-            .map(|p| {\n-                let p = p.clone();\n-                thread::spawn(move || {\n-                    let it = p.execute()?;\n-                    common::collect(it)\n-                })\n-            })\n-            .collect();\n-\n-        // combine the results from each thread\n-        let mut combined_results: Vec<Arc<RecordBatch>> = vec![];\n-        for thread in threads {\n-            match thread.join() {\n-                Ok(join) => {\n-                    join?\n-                        .iter()\n-                        .for_each(|batch| combined_results.push(Arc::new(batch.clone())));\n+        match self.partitions.len() {\n+            0 => Err(ExecutionError::General(\n+                \"MergeExec requires at least one input partition\".to_owned(),\n+            )),\n+            1 => {\n+                // bypass any threading if there is a single partition\n+                self.partitions[0].execute()\n+            }\n+            _ => {\n+                let partitions_per_thread =\n+                    (self.partitions.len() / self.concurrency).max(1);\n+                let chunks = self.partitions.chunks(partitions_per_thread);\n\nReview comment:\n       yeah, again this approach will work well as long as the work per partition (and thus chunks) is relatively even and well balanced. If we have imbalanced partitions then some threads may be idle when there is still work to do in chunks being processed by other threads\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T17:31:13.230+0000",
                    "updated": "2020-08-14T17:31:13.230+0000",
                    "started": "2020-08-14T17:31:13.229+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470786",
                    "issueId": "13322423"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 11400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6753f1ce[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@79ed5745[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@797a814e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6abeb65b[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@895d254[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@775c6861[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5a01f735[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@45928e40[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@63b3f3d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@77b880a3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@22d5693e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@73e413aa[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 11400,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Aug 17 12:05:46 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-08-14T16:37:00.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9716/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2020-08-13T00:19:32.000+0000",
        "updated": "2020-08-17T12:06:25.000+0000",
        "timeoriginalestimate": null,
        "description": "MergeExec currently spins up one thread per input partition which causes apps to effectively hang if there are substantially more partitions than available cores.\r\n\r\nWe can implement a configurable limit here pretty easily.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 11400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] [DataFusion] MergeExec  should have concurrency limit",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/comment/17177867",
                    "id": "17177867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "Issue resolved by pull request 7951\n[https://github.com/apache/arrow/pull/7951]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-08-14T16:37:00.391+0000",
                    "updated": "2020-08-14T16:37:00.391+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13322423/comment/17178941",
                    "id": "17178941",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "Depends on backward incompatible improvement https://github.com/apache/arrow/pull/7958 and https://github.com/apache/arrow/pull/7951 which also depends on the previous dependency, so I'm removing it from 1.0.1 patch release.\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2020-08-17T12:05:46.233+0000",
                    "updated": "2020-08-17T12:06:04.410+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0hq0g:",
        "customfield_12314139": null
    }
}