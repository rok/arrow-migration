{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13338721",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721",
    "key": "ARROW-10485",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12631222",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12631222",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13412366",
                    "key": "ARROW-14743",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13412366",
                    "fields": {
                        "summary": "[C++] Error reading in dataset when partitioning variable in schema",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12631088",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12631088",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13422220",
                    "key": "ARROW-15310",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422220",
                    "fields": {
                        "summary": "[C++][Python][Dataset] Detect (and warn?) when DirectoryPartitioning is parsing an actually hive-style file path?",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jms",
            "name": "jms",
            "key": "jms",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "John Sheffield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jms",
            "name": "jms",
            "key": "jms",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "John Sheffield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10485/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707541",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#issuecomment-1011114298\n\n\n   https://issues.apache.org/jira/browse/ARROW-10485\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T14:41:54.770+0000",
                    "updated": "2022-01-12T14:41:54.770+0000",
                    "started": "2022-01-12T14:41:54.770+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707541",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707542",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783138108\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -115,6 +165,10 @@ DatasetFactory$create <- function(x,\n #'    by [hive_partition()] which parses explicit or autodetected fields from\n #'    Hive-style path segments\n #'   * `NULL` for no partitioning\n+#' @param hive_style Logical: if `partitioning` is a character vector or a\n\nReview comment:\n       Still to do: update the docs for `partitioning` above to reflect the new behavior, and also propagate this to `open_dataset()`'s docs\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T14:42:22.088+0000",
                    "updated": "2022-01-12T14:42:22.088+0000",
                    "started": "2022-01-12T14:42:22.088+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707542",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707675",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783291608\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -397,6 +397,59 @@ test_that(\"Partitioning inference\", {\n   )\n })\n \n+test_that(\"Specifying partitioning when hive_style\", {\n+  expected_schema <- open_dataset(hive_dir)$schema\n+\n+  # If string and names match hive partition names, it's accepted silently\n+  ds_with_chr <- open_dataset(hive_dir, partitioning = c(\"group\", \"other\"))\n+  expect_equal(ds_with_chr$schema, expected_schema)\n+\n+  # If they don't match, we get an error\n+  expect_error(\n+    open_dataset(hive_dir, partitioning = c(\"asdf\", \"zxcv\")),\n+    '\"partitioning\" does not match the detected Hive-style partitions: c(\"group\", \"other\")',\n+    fixed = TRUE\n+  )\n+\n+  # If schema and names match, the schema is used to specify the types\n+  ds_with_sch <- open_dataset(\n+    hive_dir,\n+    partitioning = schema(group = int32(), other = utf8())\n+  )\n+  expect_equal(ds_with_sch$schema, expected_schema)\n+\n+  ds_with_int8 <- open_dataset(\n+    hive_dir,\n+    partitioning = schema(group = int8(), other = utf8())\n+  )\n+  expect_equal(ds_with_int8$schema[[\"group\"]]$type, int8())\n+\n+  # If they don't match, we get an error\n+  expect_error(\n+    open_dataset(hive_dir, partitioning = schema(a = int32(), b = utf8())),\n+    '\"partitioning\" does not match the detected Hive-style partitions: c(\"group\", \"other\")',\n+    fixed = TRUE\n+  )\n+\n+\n\nReview comment:\n       ```suggestion\r\n   \r\n   ```\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,65 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    # isFALSE() would be sufficient but that requires R >= 3.5\n+    assert_that(is.logical(hive_style), length(hive_style) == 1)\n+    if (hive_style %in% c(TRUE, NA)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          stop(\n+            '\"partitioning\" does not match the detected Hive-style partitions: ',\n+            deparse1(names(hive_schema)),\n\nReview comment:\n       Can we rephrase this a little to use \"must\"/\"should\" etc language to clarify further to the user what they should do?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T17:28:53.782+0000",
                    "updated": "2022-01-12T17:28:53.782+0000",
                    "started": "2022-01-12T17:28:53.781+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707675",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707705",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783301037\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,65 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    # isFALSE() would be sufficient but that requires R >= 3.5\n+    assert_that(is.logical(hive_style), length(hive_style) == 1)\n+    if (hive_style %in% c(TRUE, NA)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          stop(\n+            '\"partitioning\" does not match the detected Hive-style partitions: ',\n+            deparse1(names(hive_schema)),\n\nReview comment:\n       Yeah I'll come back to this after I write docs. I'm not sure how simple the \"should\" can be here but I'll try to come up with something.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T17:38:48.847+0000",
                    "updated": "2022-01-12T17:38:48.847+0000",
                    "started": "2022-01-12T17:38:48.846+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707705",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707924",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783479690\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -397,6 +397,59 @@ test_that(\"Partitioning inference\", {\n   )\n })\n \n+test_that(\"Specifying partitioning when hive_style\", {\n+  expected_schema <- open_dataset(hive_dir)$schema\n+\n+  # If string and names match hive partition names, it's accepted silently\n+  ds_with_chr <- open_dataset(hive_dir, partitioning = c(\"group\", \"other\"))\n+  expect_equal(ds_with_chr$schema, expected_schema)\n\nReview comment:\n       Do we want to test that the contents of the partitioning columns _don't_ have the partitioning bits in them too? Or maybe those are tested elsewhere?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T22:20:30.939+0000",
                    "updated": "2022-01-12T22:20:30.939+0000",
                    "started": "2022-01-12T22:20:30.939+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707924",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707939",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783506708\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -397,6 +397,59 @@ test_that(\"Partitioning inference\", {\n   )\n })\n \n+test_that(\"Specifying partitioning when hive_style\", {\n+  expected_schema <- open_dataset(hive_dir)$schema\n+\n+  # If string and names match hive partition names, it's accepted silently\n+  ds_with_chr <- open_dataset(hive_dir, partitioning = c(\"group\", \"other\"))\n+  expect_equal(ds_with_chr$schema, expected_schema)\n\nReview comment:\n       It's covered here in that `group` wouldn't be `int32` (what we detect, which is tested elsewhere), it would be `string`. This test fails on master.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T22:59:57.886+0000",
                    "updated": "2022-01-12T22:59:57.886+0000",
                    "started": "2022-01-12T22:59:57.886+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707939",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707940",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783506708\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -397,6 +397,59 @@ test_that(\"Partitioning inference\", {\n   )\n })\n \n+test_that(\"Specifying partitioning when hive_style\", {\n+  expected_schema <- open_dataset(hive_dir)$schema\n+\n+  # If string and names match hive partition names, it's accepted silently\n+  ds_with_chr <- open_dataset(hive_dir, partitioning = c(\"group\", \"other\"))\n+  expect_equal(ds_with_chr$schema, expected_schema)\n\nReview comment:\n       It's covered here in that `group` wouldn't be `int32` (what we detect, which is tested elsewhere), it would be `string`. This test fails on master, and the old behavior is still possible with `hive_style = FALSE`, which is tested on L442.\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T23:01:22.739+0000",
                    "updated": "2022-01-12T23:01:22.739+0000",
                    "started": "2022-01-12T23:01:22.738+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707940",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/707942",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783508235\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -397,6 +397,59 @@ test_that(\"Partitioning inference\", {\n   )\n })\n \n+test_that(\"Specifying partitioning when hive_style\", {\n+  expected_schema <- open_dataset(hive_dir)$schema\n+\n+  # If string and names match hive partition names, it's accepted silently\n+  ds_with_chr <- open_dataset(hive_dir, partitioning = c(\"group\", \"other\"))\n+  expect_equal(ds_with_chr$schema, expected_schema)\n\nReview comment:\n       Aaaah right, excellent\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-12T23:02:47.985+0000",
                    "updated": "2022-01-12T23:02:47.985+0000",
                    "started": "2022-01-12T23:02:47.984+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "707942",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708124",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783756457\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,63 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n\nReview comment:\n       I think it is great to make this check and help the user at the start, before it gets complicated to search for the cause of an error. Same for the line 93 ->.\r\n   \r\n   @jorisvandenbossche thought this would be interesting for you. If I understand correctly, in the R package the default partitioning will be set to NA and it will be checked (in `open_dataset`) if the partitioning is hive using `PartitioningFactory`, `Inspect`argument. If the user provides a list (vector) of partitioning names and the dataset is Hive-partitioned, an error will be raised if schemas do not match, or the list will be ignored if the schemas match. (idea for [ARROW-15310](https://issues.apache.org/jira/browse/ARROW-15310))\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T09:02:20.632+0000",
                    "updated": "2022-01-13T09:02:20.632+0000",
                    "started": "2022-01-13T09:02:20.631+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708124",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708314",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783981221\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,65 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    # isFALSE() would be sufficient but that requires R >= 3.5\n+    assert_that(is.logical(hive_style), length(hive_style) == 1)\n+    if (hive_style %in% c(TRUE, NA)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          stop(\n+            '\"partitioning\" does not match the detected Hive-style partitions: ',\n+            deparse1(names(hive_schema)),\n\nReview comment:\n       Done, PTAL @thisisnic \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T13:58:21.721+0000",
                    "updated": "2022-01-13T13:58:21.721+0000",
                    "started": "2022-01-13T13:58:21.721+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708314",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708331",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r783984955\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,71 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n+          ))\n+        }\n+        partitioning <- hive_factory$Finish(hive_schema)\n+      } else if (inherits(partitioning, \"Schema\")) {\n+        # This means we want to set the types of the hive-style partitions\n+        # to be exactly what we want them to be\n+        if (!identical(names(hive_schema), names(partitioning))) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n+          ))\n+        }\n\nReview comment:\n       Is it worth refactoring this into a function, given the repetition?\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,71 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n\nReview comment:\n       Even though we've not followed the \"must\"/\"should\" convention, I think this is totally fine as this is really explicit error messaging which clearly tells the user what's wrong and suggests possible solutions - nice!\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -23,8 +23,51 @@\n #' `open_dataset()` to point to a directory of data files and return a\n #' `Dataset`, then use `dplyr` methods to query it.\n #'\n+#' @section Partitioning:\n+#'\n+#' Data is often split into multiple files based on the value of one or more\n\nReview comment:\n       Do you think it's worth explicitly including terms like \"folders\" or \"directories\" here so that people don't get mixed up and think we have filename-based partitioning (ticket open to implement that is [ARROW-14612](https://issues.apache.org/jira/browse/ARROW-14612))?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T14:08:16.227+0000",
                    "updated": "2022-01-13T14:08:16.227+0000",
                    "started": "2022-01-13T14:08:16.227+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708331",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708350",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r784014538\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,71 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n\nReview comment:\n       I don't think I can must/should because it's not clear why the user got here, their intent could be one of these 3 things\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T14:35:00.091+0000",
                    "updated": "2022-01-13T14:35:00.091+0000",
                    "started": "2022-01-13T14:35:00.090+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708350",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708352",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r784016948\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,71 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n+          ))\n+        }\n+        partitioning <- hive_factory$Finish(hive_schema)\n+      } else if (inherits(partitioning, \"Schema\")) {\n+        # This means we want to set the types of the hive-style partitions\n+        # to be exactly what we want them to be\n+        if (!identical(names(hive_schema), names(partitioning))) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n+          ))\n+        }\n\nReview comment:\n       Not really IMO\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T14:37:29.100+0000",
                    "updated": "2022-01-13T14:37:29.100+0000",
                    "started": "2022-01-13T14:37:29.099+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708352",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708353",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r784018084\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -23,8 +23,51 @@\n #' `open_dataset()` to point to a directory of data files and return a\n #' `Dataset`, then use `dplyr` methods to query it.\n #'\n+#' @section Partitioning:\n+#'\n+#' Data is often split into multiple files based on the value of one or more\n\nReview comment:\n       How about this? \r\n   \r\n   ```suggestion\r\n   #' Data is often split into multiple files and nested in subdirectories based on the value of one or more\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T14:38:44.119+0000",
                    "updated": "2022-01-13T14:38:44.119+0000",
                    "started": "2022-01-13T14:38:44.119+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708353",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708390",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r784044260\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -23,8 +23,51 @@\n #' `open_dataset()` to point to a directory of data files and return a\n #' `Dataset`, then use `dplyr` methods to query it.\n #'\n+#' @section Partitioning:\n+#'\n+#' Data is often split into multiple files based on the value of one or more\n\nReview comment:\n       Cool cool\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T15:05:08.577+0000",
                    "updated": "2022-01-13T15:05:08.577+0000",
                    "started": "2022-01-13T15:05:08.577+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708390",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708538",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#issuecomment-1012374005\n\n\n   CI failures are unrelated\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T17:56:34.531+0000",
                    "updated": "2022-01-13T17:56:34.531+0000",
                    "started": "2022-01-13T17:56:34.530+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708538",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708653",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#issuecomment-1012503322\n\n\n   @jonkeane do you want to give this another look?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T20:48:07.404+0000",
                    "updated": "2022-01-13T20:48:07.404+0000",
                    "started": "2022-01-13T20:48:07.404+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708653",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708657",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#discussion_r784317194\n\n\n\n##########\nFile path: r/R/dataset-factory.R\n##########\n@@ -60,16 +61,71 @@ DatasetFactory$create <- function(x,\n     return(FileSystemDatasetFactory$create(path_and_fs$fs, NULL, path_and_fs$path, format))\n   }\n \n-  if (!is.null(partitioning)) {\n-    if (inherits(partitioning, \"Schema\")) {\n-      partitioning <- DirectoryPartitioning$create(partitioning)\n-    } else if (is.character(partitioning)) {\n-      # These are the column/field names, and we should autodetect their types\n-      partitioning <- DirectoryPartitioningFactory$create(partitioning)\n+  # Handle partitioning arg in cases where it is \"character\" or \"Schema\"\n+  if (!is.null(partitioning) && !inherits(partitioning, c(\"Partitioning\", \"PartitioningFactory\"))) {\n+    if (!is_false(hive_style)) {\n+      # Default is NA, which means check to see if the paths could be hive_style\n+      hive_factory <- HivePartitioningFactory$create()\n+      paths <- path_and_fs$fs$ls(\n+        path_and_fs$path,\n+        allow_not_found = FALSE,\n+        recursive = TRUE\n+      )\n+      hive_schema <- hive_factory$Inspect(paths)\n+      # This is length-0 if there are no hive segments\n+      if (is.na(hive_style)) {\n+        hive_style <- length(hive_schema) > 0\n+      }\n+    }\n+\n+    if (hive_style) {\n+      if (is.character(partitioning)) {\n+        # These are not needed, the user probably provided them because they\n+        # thought they needed to. Just make sure they aren't invalid.\n+        if (!identical(names(hive_schema), partitioning)) {\n+          abort(c(\n+            paste(\n+              '\"partitioning\" does not match the detected Hive-style partitions:',\n+              deparse1(names(hive_schema))\n+            ),\n+            i = 'Omit \"partitioning\" to use the Hive partitions',\n+            i = \"Set `hive_style = FALSE` to override what was detected\",\n+            i = \"Or, to rename partition columns, call `select()` or `rename()` after opening the dataset\"\n\nReview comment:\n       I might be very liberal in my interpretation of the must/should approach, but I think this message is fantastic and gives folks a few clear ideas of where they might be going wrong / how to fix that, so to me it satisfies that brief.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T21:00:43.746+0000",
                    "updated": "2022-01-13T21:00:43.746+0000",
                    "started": "2022-01-13T21:00:43.746+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708657",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708713",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T22:36:25.014+0000",
                    "updated": "2022-01-13T22:36:25.014+0000",
                    "started": "2022-01-13T22:36:25.014+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708713",
                    "issueId": "13338721"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/worklog/708717",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #12133:\nURL: https://github.com/apache/arrow/pull/12133#issuecomment-1012582936\n\n\n   Benchmark runs are scheduled for baseline = b4143d309c71c0247c056471a27fa7f03034cc76 and contender = 03219e21b42f17294fba3b3d2b22a9117fe0f080. 03219e21b42f17294fba3b3d2b22a9117fe0f080 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/6e68d610ae43427c8f36c0777c01220a...5dc9ab9b07334fab9bec4927d75f07cb/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/f5d2c165ca544080b808c14abbf339ca...01349efd70ee49588a118f7ee1a70778/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/95d95eb34121477b93c80ca66e5f4bbf...8862bb268f5f446991f6f447dd96e91b/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-13T22:41:10.684+0000",
                    "updated": "2022-01-13T22:41:10.684+0000",
                    "started": "2022-01-13T22:41:10.683+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "708717",
                    "issueId": "13338721"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 13800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4fb30727[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6418ca02[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2b56bc3a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@9bc3b88[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6eaa7a45[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4a30d7ad[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@549905bd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3c1114dd[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d42948[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4d951b60[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@51bd5b82[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@653e1a94[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13800,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jan 13 22:36:14 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-01-13T22:36:14.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10485/watchers",
            "watchCount": 6,
            "isWatching": false
        },
        "created": "2020-11-03T20:46:36.000+0000",
        "updated": "2022-01-15T00:21:21.000+0000",
        "timeoriginalestimate": null,
        "description": "When writing a dataset with hive_style = TRUE, now the default, that dataset has to be opened without an explicit definition of the partitions to work as expected. Even if the correct partition is specified, any query to the dataset on the partition field returns 0 rows.\r\n\r\n\u00a0\r\n\r\nFrom my eyes as a user, I'd want this to error out specifically (not just warn), probably when first calling open_dataset().\r\n\r\n{code:r}\r\ndata(\"mtcars\")\r\narrow::write_dataset(\r\n    dataset = mtcars, path = \"mtcarstest\", partitioning = \"cyl\",\r\n    format = \"parquet\", hive_style = TRUE)\r\n\r\nmtc1 <- arrow::open_dataset(\"mtcarstest\", partitioning = \"cyl\")\r\nmtc2 <- arrow::open_dataset(\"mtcarstest\")\r\n\r\nmtc1 %>%\r\n \u00a0 \u00a0 dplyr::filter(cyl == 4) %>%\r\n \u00a0 \u00a0 collect()\r\n\r\nmtc2 %>%\r\n \u00a0 \u00a0 dplyr::filter(cyl == 4) %>%\r\n \u00a0 \u00a0 collect()\r\n\r\n {code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Accept partitioning in open_dataset when file paths are hive-style",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "MacOS Catalina 10.15.7 (19H2), R 4.01, arrow R package v2.0.0",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/comment/17260817",
                    "id": "17260817",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "To be clear: the issue here stems from the dataset-on-disk being hive-partitioned, so directories look like /{{cyl=4/part-0.parquet}}. When reading with a *directory* partitioning (which what results when a character vector is specified), this results in string values like \"cyl=4\" for field \"cyl\"; obviously suspect to a human but technically valid. If you construct a {{HivePartitioning}} explicitly this issue should not arise\r\n\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-01-07T20:53:11.477+0000",
                    "updated": "2021-01-07T20:53:11.477+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/comment/17260835",
                    "id": "17260835",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "\"Constructing a {{HivePartitioning}}\" is what happens when you omit the \"partitioning\" argument. \r\n\r\nI agree with [~jms] that this isn't great. It's not unreasonable to expect that {{open_dataset(\"mtcarstest\", partitioning = \"cyl\")}} should do the right thing if the column name matches the hive key. As it turns out, that's not so trivial, and supporting that introduces some other API ambiguities. We'll need to think about this some more.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-01-07T21:22:53.419+0000",
                    "updated": "2021-01-07T21:22:53.419+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/comment/17440558",
                    "id": "17440558",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I wonder if it wouldn\u2019t be too bad performance-wise to check the first element of the partitioning column and see if the name is in it, if it is, at least flag that the specification is an issue?\r\n\r\nWe also might be encouraging this some since many (all?) of our examples use a non-hive NYC taxi dataset, so we always specify partitioning making that look obligatory. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-11-08T15:39:45.716+0000",
                    "updated": "2021-11-08T15:39:45.716+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/comment/17440691",
                    "id": "17440691",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Performance-wise it wouldn't be a difficult check though I think it'd have to be a warning and we don't have a mechanism for communicating those from C++.\u00a0 Technically, while odd, it should be valid for a user to have an \"=\" character in a directory partitioning scheme.\r\n\r\nWould the following be more intuitive to add a hive_style argument to open_dataset and, if set to true (the default), ignore partitioning if it is a character vector or, if it is a schema, construct a HivePartitioning and send that in.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-11-08T19:15:25.521+0000",
                    "updated": "2021-11-08T19:15:25.521+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338721/comment/17475813",
                    "id": "17475813",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 12133\n[https://github.com/apache/arrow/pull/12133]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-13T22:36:14.512+0000",
                    "updated": "2022-01-13T22:36:14.512+0000"
                }
            ],
            "maxResults": 5,
            "total": 5,
            "startAt": 0
        },
        "customfield_12311820": "0|z0k9iw:",
        "customfield_12314139": null
    }
}