{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13374921",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921",
    "key": "ARROW-12534",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jpedroantunes",
            "name": "jpedroantunes",
            "key": "jpedroantunes",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34060",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34060",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34060",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34060"
            },
            "displayName": "Jo\u00e3o Pedro Antunes Ferreira",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12334626",
                "id": "12334626",
                "name": "C++ - Gandiva"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jpedroantunes",
            "name": "jpedroantunes",
            "key": "jpedroantunes",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34060",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34060",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34060",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34060"
            },
            "displayName": "Jo\u00e3o Pedro Antunes Ferreira",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jpedroantunes",
            "name": "jpedroantunes",
            "key": "jpedroantunes",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34060",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34060",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34060",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34060"
            },
            "displayName": "Jo\u00e3o Pedro Antunes Ferreira",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 4800,
            "total": 4800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 4800,
            "total": 4800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12534/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 8,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/588523",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jpedroantunes opened a new pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155\n\n\n   Impleented functions:\r\n   \r\n   - LEFT (string, int):  Returns the x leftmost characters of giventext;\r\n   - RIGHT (string, int):  Returns the x rightmost characters of giventext;\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-25T14:15:02.650+0000",
                    "updated": "2021-04-25T14:15:02.650+0000",
                    "started": "2021-04-25T14:15:02.650+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "588523",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/588524",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155#issuecomment-826331792\n\n\n   https://issues.apache.org/jira/browse/ARROW-12534\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-25T14:15:27.932+0000",
                    "updated": "2021-04-25T14:15:27.932+0000",
                    "started": "2021-04-25T14:15:27.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "588524",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/588829",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jpedroantunes opened a new pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155\n\n\n   Impleented functions:\r\n   \r\n   - LEFT (string, int):  Returns the x leftmost characters of giventext;\r\n   - RIGHT (string, int):  Returns the x rightmost characters of giventext;\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-26T06:51:42.354+0000",
                    "updated": "2021-04-26T06:51:42.354+0000",
                    "started": "2021-04-26T06:51:42.353+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "588829",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/588949",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155#issuecomment-826331792\n\n\n   https://issues.apache.org/jira/browse/ARROW-12534\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-26T07:05:42.063+0000",
                    "updated": "2021-04-26T07:05:42.063+0000",
                    "started": "2021-04-26T07:05:42.063+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "588949",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/590346",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "projjal commented on a change in pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155#discussion_r622128465\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n\nReview comment:\n       Better to treat the invalid bytes as single char and pad accordingly instead of returning empty string i think\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t endCharPos;  // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where left('abc', 5) -> 'abc'\n+    endCharPos = (charCount < number) ? charCount : number;\n+  } else if (number < 0) {\n+    // case where left('abc', -5) ==> ''\n+    endCharPos = (charCount + number > 0) ? charCount + number : 0;\n+  } else {\n+    endCharPos = 0;\n+  }\n+\n+  *out_len = utf8_byte_pos(context, text, text_len, endCharPos);\n+  return text;\n+}\n+\n+FORCE_INLINE\n+const char* right(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                  gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t startCharPos;  // the char result start position (inclusive)\n+  int32_t endCharLen;    // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where right('abc', 5) ==> 'abc' startCharPos=1.\n+    startCharPos = (charCount - number + 1 > 1) ? charCount - number + 1 : 1;\n\nReview comment:\n       can be simplified to (charCount > number) . Also why doing 1-indexing here ?\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t endCharPos;  // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where left('abc', 5) -> 'abc'\n+    endCharPos = (charCount < number) ? charCount : number;\n+  } else if (number < 0) {\n+    // case where left('abc', -5) ==> ''\n+    endCharPos = (charCount + number > 0) ? charCount + number : 0;\n+  } else {\n+    endCharPos = 0;\n+  }\n+\n+  *out_len = utf8_byte_pos(context, text, text_len, endCharPos);\n+  return text;\n+}\n+\n+FORCE_INLINE\n+const char* right(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                  gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t startCharPos;  // the char result start position (inclusive)\n+  int32_t endCharLen;    // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where right('abc', 5) ==> 'abc' startCharPos=1.\n+    startCharPos = (charCount - number + 1 > 1) ? charCount - number + 1 : 1;\n+    endCharLen = charCount - startCharPos + 1;\n+  } else {\n+    startCharPos = ((number > 0) ? number : number * -1) + 1;\n+    endCharLen = charCount - startCharPos + 1;\n+  }\n\nReview comment:\n       Can you add a comment to the top of the functions detailing all the cases\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t endCharPos;  // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where left('abc', 5) -> 'abc'\n+    endCharPos = (charCount < number) ? charCount : number;\n+  } else if (number < 0) {\n+    // case where left('abc', -5) ==> ''\n+    endCharPos = (charCount + number > 0) ? charCount + number : 0;\n+  } else {\n+    endCharPos = 0;\n+  }\n+\n+  *out_len = utf8_byte_pos(context, text, text_len, endCharPos);\n+  return text;\n+}\n+\n+FORCE_INLINE\n+const char* right(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                  gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t startCharPos;  // the char result start position (inclusive)\n+  int32_t endCharLen;    // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where right('abc', 5) ==> 'abc' startCharPos=1.\n+    startCharPos = (charCount - number + 1 > 1) ? charCount - number + 1 : 1;\n+    endCharLen = charCount - startCharPos + 1;\n+  } else {\n+    startCharPos = ((number > 0) ? number : number * -1) + 1;\n\nReview comment:\n       number < 0 in this block why check again? also startCharPos may become negative if number is too large.\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  int32_t endCharPos;  // the char result end position (inclusive)\n+  if (number > 0) {\n+    // case where left('abc', 5) -> 'abc'\n+    endCharPos = (charCount < number) ? charCount : number;\n+  } else if (number < 0) {\n+    // case where left('abc', -5) ==> ''\n+    endCharPos = (charCount + number > 0) ? charCount + number : 0;\n+  } else {\n+    endCharPos = 0;\n+  }\n+\n+  *out_len = utf8_byte_pos(context, text, text_len, endCharPos);\n+  return text;\n+}\n+\n+FORCE_INLINE\n+const char* right(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                  gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n\nReview comment:\n       nit: keep consistent camel case or snake case\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n\nReview comment:\n       Instead of traversing twice you can do it once.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-28T12:41:26.437+0000",
                    "updated": "2021-04-28T12:41:26.437+0000",
                    "started": "2021-04-28T12:41:26.437+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "590346",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/590765",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jpedroantunes commented on a change in pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155#discussion_r622658277\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n\nReview comment:\n       I did to keep the compatibility with the function which we based. When UTF8 char is found, an error is set.\r\n   If you think it still makes sense to enforce this behavior, I can do it\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-29T00:32:34.134+0000",
                    "updated": "2021-04-29T00:32:34.134+0000",
                    "started": "2021-04-29T00:32:34.134+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "590765",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/591041",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jpedroantunes commented on a change in pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155#discussion_r622658277\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -1481,6 +1481,82 @@ const char* split_part(gdv_int64 context, const char* text, gdv_int32 text_len,\n   return \"\";\n }\n \n+FORCE_INLINE\n+const char* left(gdv_int64 context, const char* text, gdv_int32 text_len,\n+                 gdv_int32 number, gdv_int32* out_len) {\n+  // returns the 'number' left most characters of a given text\n+  if (text_len == 0 || number == 0) {\n+    *out_len = 0;\n+    return \"\";\n+  }\n+\n+  // initially counts the number of utf8 characters in the defined text\n+  int32_t charCount = utf8_length(context, text, text_len);\n+  // charCount is zero if input has invalid utf8 char\n+  if (charCount == 0) {\n\nReview comment:\n       I did to keep the compatibility with the function which we based. When UTF8 char is found, an error is set.\r\n   If you think it still makes sense to enforce this behavior, I can do it.\r\n   \r\n   Wait for confirmation if we should change the default behavior of setting an error instead of ignoring the invalid byte\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-29T14:56:31.455+0000",
                    "updated": "2021-04-29T14:56:31.455+0000",
                    "started": "2021-04-29T14:56:31.454+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "591041",
                    "issueId": "13374921"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/worklog/607758",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo closed pull request #10155:\nURL: https://github.com/apache/arrow/pull/10155\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-07T10:26:11.158+0000",
                    "updated": "2021-06-07T10:26:11.158+0000",
                    "started": "2021-06-07T10:26:11.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "607758",
                    "issueId": "13374921"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 4800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5b1b2d0b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@17adcd0d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@dcac82[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@79e0dc31[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2dd036fc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4247a91d[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@279aa56b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@58e4f4fd[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@74af4ecb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@bdf0e02[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@799c43ef[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6a0033d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 4800,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Jun 07 10:26:09 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-06-07T10:26:09.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12534/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-04-25T14:12:07.000+0000",
        "updated": "2021-06-07T10:26:12.000+0000",
        "timeoriginalestimate": null,
        "description": "* LEFT:\u00a0 Returns the x leftmost characters of giventext;\r\n * RIGHT:\u00a0 Returns the x rightmost characters of giventext;",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 4800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Gandiva] Implement LEFT and RIGHT functions on Gandiva for string input values",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13374921/comment/17358496",
                    "id": "17358496",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=praveenbingo",
                        "name": "praveenbingo",
                        "key": "praveenbingo",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Praveen Kumar",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 10155\n[https://github.com/apache/arrow/pull/10155]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=praveenbingo",
                        "name": "praveenbingo",
                        "key": "praveenbingo",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Praveen Kumar",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-06-07T10:26:09.559+0000",
                    "updated": "2021-06-07T10:26:09.559+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0qfg8:",
        "customfield_12314139": null
    }
}