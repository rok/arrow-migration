{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13160036",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036",
    "key": "ARROW-2603",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fjetter",
            "name": "fjetter",
            "key": "fjetter",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Florian Jetter",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fjetter",
            "name": "fjetter",
            "key": "fjetter",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Florian Jetter",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fjetter",
            "name": "fjetter",
            "key": "fjetter",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Florian Jetter",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2603/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 5,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/worklog/102919",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fjetter opened a new pull request #2061: ARROW-2603 [Python] Allow date and datetime subclassing\nURL: https://github.com/apache/arrow/pull/2061\n \n \n   When converting a pandas dataframe holding subclasses of date/datetime objects, arrow raises an ArrowInvalid exception\r\n   \r\n   ```\r\n   import pandas as pd\r\n   import pyarrow as pa\r\n   import datetime\r\n   \r\n   classMyDate(datetime.date):\r\n       pass\r\n   \r\n   date_array = [MyDate(2000, 1, 1)]\r\n   df = pd.DataFrame({\"date\": pd.Series(date_array, dtype=object)})\r\n   \r\n   table = pa.Table.from_pandas(df)\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-17T14:21:06.996+0000",
                    "updated": "2018-05-17T14:21:06.996+0000",
                    "started": "2018-05-17T14:21:06.995+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "102919",
                    "issueId": "13160036"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/worklog/103739",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fjetter commented on a change in pull request #2061: ARROW-2603: [Python] Allow date and datetime subclassing\nURL: https://github.com/apache/arrow/pull/2061#discussion_r189459958\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -814,6 +811,43 @@ def test_python_datetime(self):\n         })\n         tm.assert_frame_equal(expected_df, result)\n \n+    @pytest.mark.xfail(\n+        LooseVersion(pd.__version__) >= \"0.23.0\",\n \n Review comment:\n   For `pandas==0.22` the test works fine. I opened an issue https://github.com/pandas-dev/pandas/issues/21142 but I'm not sure how arrow wants to handle this cc @wesm \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-20T13:37:04.159+0000",
                    "updated": "2018-05-20T13:37:04.159+0000",
                    "started": "2018-05-20T13:37:04.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "103739",
                    "issueId": "13160036"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/worklog/104121",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on a change in pull request #2061: ARROW-2603: [Python] Allow date and datetime subclassing\nURL: https://github.com/apache/arrow/pull/2061#discussion_r189647254\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -814,6 +811,43 @@ def test_python_datetime(self):\n         })\n         tm.assert_frame_equal(expected_df, result)\n \n+    @pytest.mark.xfail(\n+        LooseVersion(pd.__version__) >= \"0.23.0\",\n \n Review comment:\n   This seems like a pure Pandas issue to me. We should adopt our expectation of the result to be independent of the underlying Pandas problem by adding `expected_df[\"datetime\"] = pd.to_datetime(expected_df[\"datetime\"])` before the failing assertion.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-21T16:47:31.958+0000",
                    "updated": "2018-05-21T16:47:31.958+0000",
                    "started": "2018-05-21T16:47:31.957+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "104121",
                    "issueId": "13160036"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/worklog/105867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #2061: ARROW-2603: [Python] Allow date and datetime subclassing\nURL: https://github.com/apache/arrow/pull/2061#issuecomment-392003250\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=h1) Report\n   > Merging [#2061](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/ce23c06469de9cf0c3e38e35cdb8d135f341b964?src=pr&el=desc) will **increase** coverage by `<.01%`.\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/2061/graphs/tree.svg?height=150&width=650&token=LpTCFbqVT1&src=pr)](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #2061      +/-   ##\n   ==========================================\n   + Coverage   86.35%   86.35%   +<.01%     \n   ==========================================\n     Files         242      230      -12     \n     Lines       41184    40345     -839     \n   ==========================================\n   - Hits        35564    34840     -724     \n   + Misses       5620     5505     -115\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/python/numpy\\_to\\_arrow.cc](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vbnVtcHlfdG9fYXJyb3cuY2M=) | `88.99% <100%> (\u00f8)` | :arrow_up: |\n   | [python/pyarrow/tests/test\\_convert\\_builtin.py](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvdGVzdHMvdGVzdF9jb252ZXJ0X2J1aWx0aW4ucHk=) | `99.59% <100%> (+0.02%)` | :arrow_up: |\n   | [cpp/src/arrow/python/python\\_to\\_arrow.cc](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vcHl0aG9uX3RvX2Fycm93LmNj) | `88.29% <100%> (\u00f8)` | :arrow_up: |\n   | [python/pyarrow/tests/test\\_convert\\_pandas.py](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvdGVzdHMvdGVzdF9jb252ZXJ0X3BhbmRhcy5weQ==) | `94.88% <100%> (+0.09%)` | :arrow_up: |\n   | [rust/src/buffer.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvYnVmZmVyLnJz) | | |\n   | [rust/src/error.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvZXJyb3IucnM=) | | |\n   | [rust/src/memory.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvbWVtb3J5LnJz) | | |\n   | [rust/src/list.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvbGlzdC5ycw==) | | |\n   | [rust/src/datatypes.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvZGF0YXR5cGVzLnJz) | | |\n   | [rust/src/builder.rs](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree#diff-cnVzdC9zcmMvYnVpbGRlci5ycw==) | | |\n   | ... and [7 more](https://codecov.io/gh/apache/arrow/pull/2061/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=footer). Last update [ce23c06...cd76b3e](https://codecov.io/gh/apache/arrow/pull/2061?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-25T09:53:51.168+0000",
                    "updated": "2018-05-25T09:53:51.168+0000",
                    "started": "2018-05-25T09:53:51.168+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "105867",
                    "issueId": "13160036"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/worklog/108423",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm closed pull request #2061: ARROW-2603: [Python] Allow date and datetime subclassing\nURL: https://github.com/apache/arrow/pull/2061\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/python/numpy_to_arrow.cc b/cpp/src/arrow/python/numpy_to_arrow.cc\nindex 2d4d91cde0..a1a48e22bf 100644\n--- a/cpp/src/arrow/python/numpy_to_arrow.cc\n+++ b/cpp/src/arrow/python/numpy_to_arrow.cc\n@@ -724,7 +724,7 @@ Status NumPyConverter::ConvertDates() {\n     obj = objects[i];\n     if ((have_mask && mask_values[i]) || internal::PandasObjectIsNull(obj)) {\n       RETURN_NOT_OK(builder.AppendNull());\n-    } else if (PyDate_CheckExact(obj)) {\n+    } else if (PyDate_Check(obj)) {\n       RETURN_NOT_OK(builder.Append(UnboxDate<ArrowType>::Unbox(obj)));\n     } else {\n       std::stringstream ss;\n@@ -1071,11 +1071,11 @@ Status NumPyConverter::ConvertObjectsInfer() {\n       return ConvertBooleans();\n     } else if (PyObject_is_integer(obj)) {\n       return ConvertObjectIntegers();\n-    } else if (PyDate_CheckExact(obj)) {\n+    } else if (PyDateTime_Check(obj)) {\n+      return ConvertDateTimes();\n+    } else if (PyDate_Check(obj)) {\n       // We could choose Date32 or Date64\n       return ConvertDates<Date32Type>();\n-    } else if (PyDateTime_CheckExact(obj)) {\n-      return ConvertDateTimes();\n     } else if (PyTime_Check(obj)) {\n       return ConvertTimes();\n     } else if (PyObject_IsInstance(obj, decimal_type_.obj()) == 1) {\ndiff --git a/cpp/src/arrow/python/python_to_arrow.cc b/cpp/src/arrow/python/python_to_arrow.cc\nindex 23445ee26d..f48d728046 100644\n--- a/cpp/src/arrow/python/python_to_arrow.cc\n+++ b/cpp/src/arrow/python/python_to_arrow.cc\n@@ -522,7 +522,7 @@ Status Append(PyObject* context, PyObject* elem, SequenceBuilder* builder,\n                                  subdicts, blobs_out));\n   } else if (elem == Py_None) {\n     RETURN_NOT_OK(builder->AppendNone());\n-  } else if (PyDateTime_CheckExact(elem)) {\n+  } else if (PyDateTime_Check(elem)) {\n     PyDateTime_DateTime* datetime = reinterpret_cast<PyDateTime_DateTime*>(elem);\n     RETURN_NOT_OK(builder->AppendDate64(PyDateTime_to_us(datetime)));\n   } else if (is_buffer(elem)) {\ndiff --git a/python/pyarrow/tests/test_convert_builtin.py b/python/pyarrow/tests/test_convert_builtin.py\nindex 8a8e5542ee..a4b2151bdf 100644\n--- a/python/pyarrow/tests/test_convert_builtin.py\n+++ b/python/pyarrow/tests/test_convert_builtin.py\n@@ -477,6 +477,55 @@ def test_sequence_timestamp_with_unit():\n                                                   23, 34, 123456)\n \n \n+def test_datetime_subclassing():\n+    class MyDate(datetime.date):\n+        pass\n+    data = [\n+        MyDate(2007, 7, 13),\n+    ]\n+    date_type = pa.date32()\n+    arr_date = pa.array(data, type=date_type)\n+    assert len(arr_date) == 1\n+    assert arr_date.type == date_type\n+    assert arr_date[0].as_py() == datetime.date(2007, 7, 13)\n+\n+    class MyDatetime(datetime.datetime):\n+        pass\n+\n+    data = [\n+        MyDatetime(2007, 7, 13, 1, 23, 34, 123456),\n+    ]\n+\n+    s = pa.timestamp('s')\n+    ms = pa.timestamp('ms')\n+    us = pa.timestamp('us')\n+    ns = pa.timestamp('ns')\n+\n+    arr_s = pa.array(data, type=s)\n+    assert len(arr_s) == 1\n+    assert arr_s.type == s\n+    assert arr_s[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                 23, 34, 0)\n+\n+    arr_ms = pa.array(data, type=ms)\n+    assert len(arr_ms) == 1\n+    assert arr_ms.type == ms\n+    assert arr_ms[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                  23, 34, 123000)\n+\n+    arr_us = pa.array(data, type=us)\n+    assert len(arr_us) == 1\n+    assert arr_us.type == us\n+    assert arr_us[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                  23, 34, 123456)\n+\n+    arr_ns = pa.array(data, type=ns)\n+    assert len(arr_ns) == 1\n+    assert arr_ns.type == ns\n+    assert arr_ns[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                  23, 34, 123456)\n+\n+\n def test_sequence_timestamp_from_int_with_unit():\n     data = [1]\n \ndiff --git a/python/pyarrow/tests/test_convert_pandas.py b/python/pyarrow/tests/test_convert_pandas.py\nindex 6bdbcca01c..bbe74ac16e 100644\n--- a/python/pyarrow/tests/test_convert_pandas.py\n+++ b/python/pyarrow/tests/test_convert_pandas.py\n@@ -15,24 +15,20 @@\n # KIND, either express or implied.  See the License for the\n # specific language governing permissions and limitations\n # under the License.\n-\n-from collections import OrderedDict\n-\n-from datetime import date, datetime, time, timedelta\n import decimal\n import json\n-\n-import pytest\n+from collections import OrderedDict\n+from datetime import date, datetime, time, timedelta\n \n import numpy as np\n import numpy.testing as npt\n-\n import pandas as pd\n import pandas.util.testing as tm\n+import pytest\n \n-from pyarrow.compat import PY2\n import pyarrow as pa\n import pyarrow.types as patypes\n+from pyarrow.compat import PY2\n \n from .pandas_examples import dataframe_with_arrays, dataframe_with_lists\n \n@@ -814,6 +810,43 @@ def test_python_datetime(self):\n         })\n         tm.assert_frame_equal(expected_df, result)\n \n+    def test_python_datetime_subclass(self):\n+\n+        class MyDatetime(datetime):\n+            # see https://github.com/pandas-dev/pandas/issues/21142\n+            nanosecond = 0.0\n+\n+        date_array = [MyDatetime(2000, 1, 1, 1, 1, 1)]\n+        df = pd.DataFrame({\"datetime\": pd.Series(date_array, dtype=object)})\n+\n+        table = pa.Table.from_pandas(df)\n+        assert isinstance(table[0].data.chunk(0), pa.TimestampArray)\n+\n+        result = table.to_pandas()\n+        expected_df = pd.DataFrame({\"datetime\": date_array})\n+\n+        # https://github.com/pandas-dev/pandas/issues/21142\n+        expected_df[\"datetime\"] = pd.to_datetime(expected_df[\"datetime\"])\n+\n+        tm.assert_frame_equal(expected_df, result)\n+\n+    def test_python_date_subclass(self):\n+\n+        class MyDate(date):\n+            pass\n+\n+        date_array = [MyDate(2000, 1, 1)]\n+        df = pd.DataFrame({\"date\": pd.Series(date_array, dtype=object)})\n+\n+        table = pa.Table.from_pandas(df)\n+        assert isinstance(table[0].data.chunk(0), pa.Date32Array)\n+\n+        result = table.to_pandas()\n+        expected_df = pd.DataFrame(\n+            {\"date\": np.array([\"2000-01-01\"], dtype=\"datetime64[ns]\")}\n+        )\n+        tm.assert_frame_equal(expected_df, result)\n+\n     def test_datetime64_to_date32(self):\n         # ARROW-1718\n         arr = pa.array([date(2017, 10, 23), None])\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-04T04:00:46.562+0000",
                    "updated": "2018-06-04T04:00:46.562+0000",
                    "started": "2018-06-04T04:00:46.562+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "108423",
                    "issueId": "13160036"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 3000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@76e26e20[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4fbb4319[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@79ae5986[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6c986e21[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1ceafddb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4551b3aa[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4eb8b0ef[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@61fe267f[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2ab10bbe[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@62b521a1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6981cad0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@79dcc441[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 3000,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Jun 04 04:00:39 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-06-04T04:00:39.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2603/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2018-05-17T14:10:48.000+0000",
        "updated": "2018-06-04T04:00:46.000+0000",
        "timeoriginalestimate": null,
        "description": "When converting a pandas dataframe holding subclasses of date/datetime objects, arrow raises an {{ArrowInvalid}} exception\r\n{code:java}\r\nimport pandas as pd\r\nimport pyarrow as pa\r\nimport datetime\r\n\r\nclassMyDate(datetime.date):\r\n    pass\r\n\r\ndate_array = [MyDate(2000, 1, 1)]\r\ndf = pd.DataFrame({\"date\": pd.Series(date_array, dtype=object)})\r\n\r\ntable = pa.Table.from_pandas(df){code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 3000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] from pandas raises ArrowInvalid for date(time) subclasses",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13160036/comment/16499720",
                    "id": "16499720",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 2061\n[https://github.com/apache/arrow/pull/2061]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-06-04T04:00:39.859+0000",
                    "updated": "2018-06-04T04:00:39.859+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|i3tu2n:",
        "customfield_12314139": null
    }
}