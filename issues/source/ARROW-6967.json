{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13263844",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844",
    "key": "ARROW-6967",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6967/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343570",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T17:42:11.881+0000",
                    "updated": "2019-11-14T17:42:11.881+0000",
                    "started": "2019-11-14T17:42:11.881+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343570",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343573",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#issuecomment-553999843\n \n \n   https://issues.apache.org/jira/browse/ARROW-6967\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T17:45:35.675+0000",
                    "updated": "2019-11-14T17:45:35.675+0000",
                    "started": "2019-11-14T17:45:35.675+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343573",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346468017\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -220,6 +221,23 @@ std::shared_ptr<Expression> Invert(const Expression& expr) {\n   return nullptr;\n }\n \n+std::shared_ptr<Expression> Expression::Assume(const Expression& given) const {\n+  if (given.type() == ExpressionType::COMPARISON) {\n+    const auto& cmp = checked_cast<const ComparisonExpression&>(given);\n+    if (cmp.op() == compute::CompareOperator::EQUAL) {\n+      if (this->Equals(cmp.left_operand())) {\n+        return cmp.right_operand();\n \n Review comment:\n   I'm not sure of the point of this. It seems to be assuming that `right_operand` is somehow simpler (and therefore more desirable) than `this`. But is it the case generally?\r\n   \r\n   Perhaps this should be restricted to constant comparands...\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:24.609+0000",
                    "updated": "2019-11-14T18:24:24.609+0000",
                    "started": "2019-11-14T18:24:24.608+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343616",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343617",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346467451\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -220,6 +221,23 @@ std::shared_ptr<Expression> Invert(const Expression& expr) {\n   return nullptr;\n }\n \n+std::shared_ptr<Expression> Expression::Assume(const Expression& given) const {\n+  if (given.type() == ExpressionType::COMPARISON) {\n+    const auto& cmp = checked_cast<const ComparisonExpression&>(given);\n+    if (cmp.op() == compute::CompareOperator::EQUAL) {\n+      if (this->Equals(cmp.left_operand())) {\n+        return cmp.right_operand();\n+      }\n+\n+      if (this->Equals(cmp.right_operand())) {\n+        return cmp.right_operand();\n \n Review comment:\n   `left_operand` perhaps?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:24.744+0000",
                    "updated": "2019-11-14T18:24:24.744+0000",
                    "started": "2019-11-14T18:24:24.743+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343617",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343618",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346468877\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.h\n ##########\n @@ -305,6 +310,37 @@ class ARROW_DS_EXPORT NotExpression final\n   Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n };\n \n+class ARROW_DS_EXPORT IsValidExpression final\n+    : public ExpressionImpl<UnaryExpression, IsValidExpression,\n+                            ExpressionType::IS_VALID> {\n+ public:\n+  using ExpressionImpl::ExpressionImpl;\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+};\n+\n+class ARROW_DS_EXPORT InExpression final\n+    : public ExpressionImpl<UnaryExpression, InExpression, ExpressionType::IN> {\n+ public:\n+  InExpression(std::shared_ptr<Array> set, std::shared_ptr<Expression> operand)\n+      : ExpressionImpl(std::move(operand)), set_(std::move(set)) {}\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+\n+  const std::shared_ptr<Array>& set() const { return set_; }\n \n Review comment:\n   Add a docstring?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:24.839+0000",
                    "updated": "2019-11-14T18:24:24.839+0000",
                    "started": "2019-11-14T18:24:24.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343618",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343619",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346469528\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.h\n ##########\n @@ -305,6 +310,37 @@ class ARROW_DS_EXPORT NotExpression final\n   Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n };\n \n+class ARROW_DS_EXPORT IsValidExpression final\n+    : public ExpressionImpl<UnaryExpression, IsValidExpression,\n+                            ExpressionType::IS_VALID> {\n+ public:\n+  using ExpressionImpl::ExpressionImpl;\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+};\n+\n+class ARROW_DS_EXPORT InExpression final\n+    : public ExpressionImpl<UnaryExpression, InExpression, ExpressionType::IN> {\n+ public:\n+  InExpression(std::shared_ptr<Array> set, std::shared_ptr<Expression> operand)\n \n Review comment:\n   Not important, but if it's \"operand IN set\", then perhaps `(operand, set)` would be a more natural argument order.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:24.964+0000",
                    "updated": "2019-11-14T18:24:24.964+0000",
                    "started": "2019-11-14T18:24:24.963+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343619",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343620",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346469692\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter_test.cc\n ##########\n @@ -108,6 +108,14 @@ TEST_F(ExpressionsTest, SimplificationOfCompoundQuery) {\n   AssertSimplifiesTo(\"b\"_ == 4, \"a\"_ == 0, \"b\"_ == 4);\n \n   AssertSimplifiesTo(\"a\"_ == 3 or \"b\"_ == 4, \"a\"_ == 0, \"b\"_ == 4);\n+\n+  // TODO(bkietz) the following simplifications should be possible:\n \n Review comment:\n   Which ones? This test fails?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:24.967+0000",
                    "updated": "2019-11-14T18:24:24.967+0000",
                    "started": "2019-11-14T18:24:24.967+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343620",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343621",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346470873\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -882,6 +963,36 @@ Result<Datum> TreeEvaluator::Evaluate(const NotExpression& expr,\n   return std::move(out);\n }\n \n+Result<Datum> TreeEvaluator::Evaluate(const InExpression& expr,\n+                                      const RecordBatch& batch) const {\n+  ARROW_ASSIGN_OR_RAISE(auto operand_values, Evaluate(*expr.operand(), batch));\n+  if (IsNullDatum(operand_values)) {\n+    return Datum(expr.set()->null_count() != 0);\n+  }\n+\n+  DCHECK(operand_values.is_array());\n+  Datum out;\n+  compute::FunctionContext ctx{pool_};\n+  RETURN_NOT_OK(arrow::compute::IsIn(&ctx, operand_values, expr.set(), &out));\n+  return std::move(out);\n+}\n+\n+Result<Datum> TreeEvaluator::Evaluate(const IsValidExpression& expr,\n+                                      const RecordBatch& batch) const {\n+  ARROW_ASSIGN_OR_RAISE(auto operand_values, Evaluate(*expr.operand(), batch));\n+  if (IsNullDatum(operand_values)) {\n+    return Datum(false);\n+  }\n+\n+  if (operand_values.is_scalar()) {\n+    return Datum(true);\n+  }\n+\n+  DCHECK(operand_values.is_array());\n+  return Datum(std::make_shared<BooleanArray>(operand_values.array()->length,\n+                                              operand_values.array()->buffers[0]));\n \n Review comment:\n   This may construct an array with null data, if the operand has no nulls.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T18:24:25.077+0000",
                    "updated": "2019-11-14T18:24:25.077+0000",
                    "started": "2019-11-14T18:24:25.077+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343621",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343682",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346499863\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -220,6 +221,23 @@ std::shared_ptr<Expression> Invert(const Expression& expr) {\n   return nullptr;\n }\n \n+std::shared_ptr<Expression> Expression::Assume(const Expression& given) const {\n+  if (given.type() == ExpressionType::COMPARISON) {\n+    const auto& cmp = checked_cast<const ComparisonExpression&>(given);\n+    if (cmp.op() == compute::CompareOperator::EQUAL) {\n+      if (this->Equals(cmp.left_operand())) {\n+        return cmp.right_operand();\n+      }\n+\n+      if (this->Equals(cmp.right_operand())) {\n+        return cmp.right_operand();\n \n Review comment:\n   yes, thanks\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:19:37.282+0000",
                    "updated": "2019-11-14T19:19:37.282+0000",
                    "started": "2019-11-14T19:19:37.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343682",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343683",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346499916\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -220,6 +221,23 @@ std::shared_ptr<Expression> Invert(const Expression& expr) {\n   return nullptr;\n }\n \n+std::shared_ptr<Expression> Expression::Assume(const Expression& given) const {\n+  if (given.type() == ExpressionType::COMPARISON) {\n+    const auto& cmp = checked_cast<const ComparisonExpression&>(given);\n+    if (cmp.op() == compute::CompareOperator::EQUAL) {\n+      if (this->Equals(cmp.left_operand())) {\n+        return cmp.right_operand();\n \n Review comment:\n   The point is to allow `\"beta\"_.Assume(\"beta\"_ == 3).Equals(3)`,\r\n   which in turn allows `\"beta\"_.In({1, 2, 3}).Assume(\"beta\"_ == 0).Equals(false)`.\r\n   \r\n   Restricting it to constant given.right_operand seems sensible\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:19:43.650+0000",
                    "updated": "2019-11-14T19:19:43.650+0000",
                    "started": "2019-11-14T19:19:43.650+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343683",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343684",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346499962\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.h\n ##########\n @@ -305,6 +310,37 @@ class ARROW_DS_EXPORT NotExpression final\n   Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n };\n \n+class ARROW_DS_EXPORT IsValidExpression final\n+    : public ExpressionImpl<UnaryExpression, IsValidExpression,\n+                            ExpressionType::IS_VALID> {\n+ public:\n+  using ExpressionImpl::ExpressionImpl;\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+};\n+\n+class ARROW_DS_EXPORT InExpression final\n+    : public ExpressionImpl<UnaryExpression, InExpression, ExpressionType::IN> {\n+ public:\n+  InExpression(std::shared_ptr<Array> set, std::shared_ptr<Expression> operand)\n+      : ExpressionImpl(std::move(operand)), set_(std::move(set)) {}\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+\n+  const std::shared_ptr<Array>& set() const { return set_; }\n \n Review comment:\n   will do\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:19:50.083+0000",
                    "updated": "2019-11-14T19:19:50.083+0000",
                    "started": "2019-11-14T19:19:50.083+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343684",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343685",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346500002\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.h\n ##########\n @@ -305,6 +310,37 @@ class ARROW_DS_EXPORT NotExpression final\n   Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n };\n \n+class ARROW_DS_EXPORT IsValidExpression final\n+    : public ExpressionImpl<UnaryExpression, IsValidExpression,\n+                            ExpressionType::IS_VALID> {\n+ public:\n+  using ExpressionImpl::ExpressionImpl;\n+\n+  std::string ToString() const override;\n+\n+  Result<std::shared_ptr<DataType>> Validate(const Schema& schema) const override;\n+\n+  std::shared_ptr<Expression> Assume(const Expression& given) const override;\n+};\n+\n+class ARROW_DS_EXPORT InExpression final\n+    : public ExpressionImpl<UnaryExpression, InExpression, ExpressionType::IN> {\n+ public:\n+  InExpression(std::shared_ptr<Array> set, std::shared_ptr<Expression> operand)\n \n Review comment:\n   will do\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:19:55.302+0000",
                    "updated": "2019-11-14T19:19:55.302+0000",
                    "started": "2019-11-14T19:19:55.301+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343685",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343686",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346500064\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter_test.cc\n ##########\n @@ -108,6 +108,14 @@ TEST_F(ExpressionsTest, SimplificationOfCompoundQuery) {\n   AssertSimplifiesTo(\"b\"_ == 4, \"a\"_ == 0, \"b\"_ == 4);\n \n   AssertSimplifiesTo(\"a\"_ == 3 or \"b\"_ == 4, \"a\"_ == 0, \"b\"_ == 4);\n+\n+  // TODO(bkietz) the following simplifications should be possible:\n \n Review comment:\n   no, just forgot to remove this comment\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:20:04.926+0000",
                    "updated": "2019-11-14T19:20:04.926+0000",
                    "started": "2019-11-14T19:20:04.925+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343686",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/343687",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#discussion_r346500157\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/filter.cc\n ##########\n @@ -882,6 +963,36 @@ Result<Datum> TreeEvaluator::Evaluate(const NotExpression& expr,\n   return std::move(out);\n }\n \n+Result<Datum> TreeEvaluator::Evaluate(const InExpression& expr,\n+                                      const RecordBatch& batch) const {\n+  ARROW_ASSIGN_OR_RAISE(auto operand_values, Evaluate(*expr.operand(), batch));\n+  if (IsNullDatum(operand_values)) {\n+    return Datum(expr.set()->null_count() != 0);\n+  }\n+\n+  DCHECK(operand_values.is_array());\n+  Datum out;\n+  compute::FunctionContext ctx{pool_};\n+  RETURN_NOT_OK(arrow::compute::IsIn(&ctx, operand_values, expr.set(), &out));\n+  return std::move(out);\n+}\n+\n+Result<Datum> TreeEvaluator::Evaluate(const IsValidExpression& expr,\n+                                      const RecordBatch& batch) const {\n+  ARROW_ASSIGN_OR_RAISE(auto operand_values, Evaluate(*expr.operand(), batch));\n+  if (IsNullDatum(operand_values)) {\n+    return Datum(false);\n+  }\n+\n+  if (operand_values.is_scalar()) {\n+    return Datum(true);\n+  }\n+\n+  DCHECK(operand_values.is_array());\n+  return Datum(std::make_shared<BooleanArray>(operand_values.array()->length,\n+                                              operand_values.array()->buffers[0]));\n \n Review comment:\n   thanks, I'll add a check for null_count == 0\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-14T19:20:17.577+0000",
                    "updated": "2019-11-14T19:20:17.577+0000",
                    "started": "2019-11-14T19:20:17.577+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "343687",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/344377",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on issue #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836#issuecomment-554420313\n \n \n   I've amended the JIRA and added a follow up for COALESCE https://issues.apache.org/jira/browse/ARROW-7179\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-15T16:04:49.004+0000",
                    "updated": "2019-11-15T16:04:49.004+0000",
                    "started": "2019-11-15T16:04:49.003+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "344377",
                    "issueId": "13263844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/worklog/344425",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5836: ARROW-6967: [C++][Dataset] IN, IS_VALID filter expressions\nURL: https://github.com/apache/arrow/pull/5836\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-15T17:14:24.266+0000",
                    "updated": "2019-11-15T17:14:24.266+0000",
                    "started": "2019-11-15T17:14:24.265+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "344425",
                    "issueId": "13263844"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@570c0ee0[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c40ab73[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7d9e0e99[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@443c296a[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@134ecf39[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4ad49467[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47b3a162[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@62e1a787[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7b39be5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@69aa40d8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33c8443e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5c7a105f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Nov 15 17:14:24 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-11-15T17:14:24.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6967/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-10-22T17:11:11.000+0000",
        "updated": "2019-11-15T17:14:24.000+0000",
        "timeoriginalestimate": null,
        "description": "Implement filter expressions for {{IN, IS_VALID}}\r\n\r\n{{IN}} should be backed in TreeEvaluator by the IsIn kernel. {{IS_VALID}} should be implementable by wrapping null bitmap into a BooleanArray.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Add filter expressions for IN, IS_VALID",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13263844/comment/16975256",
                    "id": "16975256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 5836\n[https://github.com/apache/arrow/pull/5836]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2019-11-15T17:14:24.218+0000",
                    "updated": "2019-11-15T17:14:24.218+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z07ugw:",
        "customfield_12314139": null
    }
}