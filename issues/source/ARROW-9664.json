{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13321319",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319",
    "key": "ARROW-9664",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12347769",
                "id": "12347769",
                "description": "",
                "name": "1.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-07-24"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12597151",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12597151",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "inwardIssue": {
                    "id": "13323391",
                    "key": "ARROW-9787",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323391",
                    "fields": {
                        "summary": "[Python] pa.array.to_pandas(types_mapper=...) doesn't change the dtype",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=alenka",
            "name": "alenka",
            "key": "alenkaf",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Alenka Frim",
            "active": true,
            "timeZone": "Europe/Ljubljana"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Adrien_",
            "name": "Adrien_",
            "key": "adrien_",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Adrien Hoarau",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Adrien_",
            "name": "Adrien_",
            "key": "adrien_",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Adrien Hoarau",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9664/votes",
            "votes": 1,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 25,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/710488",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF opened a new pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178\n\n\n   This PR tires to add `types_mapper` argument to Array and ChunkedArray `to_pandas` method. To be used like in `Table.to_pandas()` where `types_mapper` needs to be a function or a dictionary mapping (`dict.get`).\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T13:10:22.870+0000",
                    "updated": "2022-01-18T13:10:22.870+0000",
                    "started": "2022-01-18T13:10:22.870+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710488",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/710489",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1015397639\n\n\n   https://issues.apache.org/jira/browse/ARROW-9664\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T13:10:55.811+0000",
                    "updated": "2022-01-18T13:10:55.811+0000",
                    "started": "2022-01-18T13:10:55.811+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710489",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/711287",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r787630984\n\n\n\n##########\nFile path: python/pyarrow/tests/test_table.py\n##########\n@@ -339,6 +339,42 @@ def test_chunked_array_to_pandas_preserve_name():\n         tm.assert_series_equal(result, expected)\n \n \n+@pytest.mark.pandas\n+def test_array_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    import pandas as pd\n+    import numpy as np\n+\n+    # Extension types got introduced in later versions of Pandas\n+    if \"0.23\" < pd.__version__ < \"1.0.0\":\n+        types_mapper = {pa.int64(): np.int64}.get\n+    else:\n+        types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    data = pa.array([1, 2, 3], pa.int64())\n+    result = data.to_pandas(types_mapper=types_mapper)\n+\n+    assert result.dtype == types_mapper(data.type)\n+\n+\n+@pytest.mark.pandas\n+def test_chunked_array_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    import pandas as pd\n+\n+    # Extension types got introduced in later versions of Pandas\n+    if \"0.23\" < pd.__version__ < \"1.0.0\":\n+        types_mapper = {pa.int64(): np.int64}.get\n+    else:\n+        types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n\nReview comment:\n       I am not sure if this is the way to fix CI erroring for Pandas version 0.23. Happy to receive comments about it.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T10:58:38.260+0000",
                    "updated": "2022-01-19T10:58:38.260+0000",
                    "started": "2022-01-19T10:58:38.260+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711287",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/712809",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1018467474\n\n\n   @jorisvandenbossche Looking at the docstrings for the `types_mapper` I think item 1) from your list should test if `None` is added in the mapping function, then the default conversion is used. For example: `types_mapper = {pa.int8(): None}.get`. \r\n   \r\n   > The function receives a pyarrow DataType and is expected to return a pandas ExtensionDtype or None if the default conversion should be used for that type.\r\n   \r\n   Is that what you meant?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-21T12:34:31.220+0000",
                    "updated": "2022-01-21T12:34:31.220+0000",
                    "started": "2022-01-21T12:34:31.220+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "712809",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/713789",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1020153796\n\n\n   Yes, that's what I meant. So you need to test it with a function that will return None for a different type (such as the dict.get does), and then also do the `to_pandas` conversion with a type that is not specified by the types_mapper keyword.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-24T14:24:09.814+0000",
                    "updated": "2022-01-24T14:24:09.814+0000",
                    "started": "2022-01-24T14:24:09.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "713789",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/714506",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1021233071\n\n\n   Got it!\r\n   Will do it as soon as I am back (next week). Hope that's ok. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T14:23:49.350+0000",
                    "updated": "2022-01-25T14:23:49.350+0000",
                    "started": "2022-01-25T14:23:49.350+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714506",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/714696",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1021233071\n\n\n   Got it!\r\n   Will do it as soon as I am back (next week). Hope that's ok. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T16:40:08.220+0000",
                    "updated": "2022-01-25T16:40:08.220+0000",
                    "started": "2022-01-25T16:40:08.220+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714696",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/718495",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1026620180\n\n\n   @jorisvandenbossche I added the tests for:\r\n   \r\n   1. Mapper function returning None\r\n   2. Mapper function not containing the array dtype\r\n   3. Interval extension dtype -> in this case the code ignores the mapping and uses default conversion as in 1. and 2.\r\n   \r\n   I am not sure if the handling for case 3. is correct or should it behave differently?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-01T09:10:16.589+0000",
                    "updated": "2022-02-01T09:10:16.589+0000",
                    "started": "2022-02-01T09:10:16.588+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "718495",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/718644",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r796442124\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,6 +4082,66 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n+def test_to_pandas_types_mapper():\n\nReview comment:\n       ```suggestion\r\n   def test_array_to_pandas_types_mapper():\r\n   ```\r\n   \r\n   (to differentiate from table.to_pandas)\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,6 +4082,66 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n+def test_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    if Version(pd.__version__) < Version(\"1.0.0\"):\n+        pytest.skip(\"ExtensionDtype to_pandas method missing\")\n+\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test for the interval extension dtype\n+    # -> ignores mapping and uses default conversion\n+    types_mapper = {pa.float64(): pd.IntervalDtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n\nReview comment:\n       For this test, I think it would be good to see if we can actually roundtrip a pandas intervaldtype (now this test is basically the same as the case above). So if we start from \r\n   \r\n   ```\r\n   interval = pd.Series(pd.interval_range(0, 5, 5))\r\n   data = pa.array(interval)\r\n   ```\r\n   \r\n   Can we do `data.to_pandas(..)` in some way to get back the pandas `interval` series? \r\n   \r\n   This might actually not be super straightforward, as you need to know the exact struct type that has been created .. (which makes me wonder if we should change the interface a bit: while `types_mapper` makes sense for Table conversion where you can have many columns of a certain type, for Array there is simply one result dtype you might want to enforce).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-01T12:54:30.068+0000",
                    "updated": "2022-02-01T12:54:30.068+0000",
                    "started": "2022-02-01T12:54:30.068+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "718644",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/719245",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r797358139\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,6 +4082,66 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n+def test_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    if Version(pd.__version__) < Version(\"1.0.0\"):\n+        pytest.skip(\"ExtensionDtype to_pandas method missing\")\n+\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test for the interval extension dtype\n+    # -> ignores mapping and uses default conversion\n+    types_mapper = {pa.float64(): pd.IntervalDtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n\nReview comment:\n       I have been thinking about this before and am not sure what is the best way. I agree that it doesn't really makes that much sense to have `types_mapper` for Array as it does for the Table. `dtype` kind of a think should do.\r\n   \r\n   If I use the example for the intervaldtype you mentioned, it works fine without the need for a `types_mapper`, so I am not sure what should be done here (you can't change to any other dtype anyways?):\r\n   \r\n   ```\r\n   >>> interval = pd.Series(pd.interval_range(0, 5, 5))\r\n   >>> data = pa.array(interval)\r\n   >>> data.to_pandas()\r\n   0    (0, 1]\r\n   1    (1, 2]\r\n   2    (2, 3]\r\n   3    (3, 4]\r\n   4    (4, 5]\r\n   dtype: interval\r\n   ````\r\n   \r\n   I was thinking in general about intervaldtype or any other Pandas extension dtype and the only thing I could think of is to add:\r\n   ```\r\n   if hasattr(types_mapper(dtype), '__from_arrow__'):\r\n               array = types_mapper(dtype).__from_arrow__(array)\r\n   ```\r\n   but that didn't really work as the array is a numpy array at that point (`_array_like_to_pandas()`) - if I remember correctly.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-02T08:15:39.731+0000",
                    "updated": "2022-02-02T08:15:39.731+0000",
                    "started": "2022-02-02T08:15:39.731+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "719245",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/719955",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r798344287\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,6 +4082,66 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n+def test_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    if Version(pd.__version__) < Version(\"1.0.0\"):\n+        pytest.skip(\"ExtensionDtype to_pandas method missing\")\n+\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test for the interval extension dtype\n+    # -> ignores mapping and uses default conversion\n+    types_mapper = {pa.float64(): pd.IntervalDtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n\nReview comment:\n       > If I use the example for the intervaldtype you mentioned, it works fine without the need for a `types_mapper`, so I am not sure what should be done here (you can't change to any other dtype anyways?):\r\n   \r\n   Ah, yes, I forgot about that this already works. That's because it is also an extension type on the Arrow side. A way to test is would be to do `data.storage.to_pandas(..)`, but then it is the same as the other tests with Int64Dtype, so no need to include it.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-03T08:57:21.971+0000",
                    "updated": "2022-02-03T08:57:21.971+0000",
                    "started": "2022-02-03T08:57:21.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "719955",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/720010",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r798436243\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,6 +4082,66 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n+def test_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n+    if Version(pd.__version__) < Version(\"1.0.0\"):\n+        pytest.skip(\"ExtensionDtype to_pandas method missing\")\n+\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test for the interval extension dtype\n+    # -> ignores mapping and uses default conversion\n+    types_mapper = {pa.float64(): pd.IntervalDtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n\nReview comment:\n       So from an offline discussion: conclusion is that we can just remove this additional test case with interval dtype, since using the storage type would not work with pandas, and converting a plain pyarrow array to a pandas extension dtype is already covered by the int64 case above.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-03T10:46:26.974+0000",
                    "updated": "2022-02-03T10:46:26.974+0000",
                    "started": "2022-02-03T10:46:26.974+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "720010",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/724361",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r803432012\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,16 +4082,52 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n-def test_roundtrip_empty_table_with_extension_dtype_index():\n\nReview comment:\n       This might be a small rebase issue that this test is accidentally removed?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-10T08:51:02.540+0000",
                    "updated": "2022-02-10T08:51:02.540+0000",
                    "started": "2022-02-10T08:51:02.540+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "724361",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/724364",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r803433525\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,16 +4082,52 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n-def test_roundtrip_empty_table_with_extension_dtype_index():\n+def test_array_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n     if Version(pd.__version__) < Version(\"1.0.0\"):\n         pytest.skip(\"ExtensionDtype to_pandas method missing\")\n \n-    df = pd.DataFrame(index=pd.interval_range(start=0, end=3))\n-    table = pa.table(df)\n-    table.to_pandas().index == pd.Index([{'left': 0, 'right': 1},\n-                                         {'left': 1, 'right': 2},\n-                                         {'left': 2, 'right': 3}],\n-                                        dtype='object')\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n\nReview comment:\n       ```suggestion\r\n       assert result.dtype == np.dtype(\"int64\")\r\n   ```\r\n   \r\n   Just to make it a bit more explicit for someone reading the test \n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,16 +4082,52 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n-def test_roundtrip_empty_table_with_extension_dtype_index():\n+def test_array_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n     if Version(pd.__version__) < Version(\"1.0.0\"):\n         pytest.skip(\"ExtensionDtype to_pandas method missing\")\n \n-    df = pd.DataFrame(index=pd.interval_range(start=0, end=3))\n-    table = pa.table(df)\n-    table.to_pandas().index == pd.Index([{'left': 0, 'right': 1},\n-                                         {'left': 1, 'right': 2},\n-                                         {'left': 2, 'right': 3}],\n-                                        dtype='object')\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n\nReview comment:\n       ```suggestion\r\n       assert result.dtype == pd.Int64Dtype()\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-10T08:52:52.273+0000",
                    "updated": "2022-02-10T08:52:52.273+0000",
                    "started": "2022-02-10T08:52:52.272+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "724364",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/724394",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r803482613\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,16 +4082,52 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n-def test_roundtrip_empty_table_with_extension_dtype_index():\n+def test_array_to_pandas_types_mapper():\n+    # https://issues.apache.org/jira/browse/ARROW-9664\n     if Version(pd.__version__) < Version(\"1.0.0\"):\n         pytest.skip(\"ExtensionDtype to_pandas method missing\")\n \n-    df = pd.DataFrame(index=pd.interval_range(start=0, end=3))\n-    table = pa.table(df)\n-    table.to_pandas().index == pd.Index([{'left': 0, 'right': 1},\n-                                         {'left': 1, 'right': 2},\n-                                         {'left': 2, 'right': 3}],\n-                                        dtype='object')\n+    data = pa.array([1, 2, 3], pa.int64())\n+\n+    # Test with mapper function\n+    types_mapper = {pa.int64(): pd.Int64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == types_mapper(data.type)\n+\n+    # Test mapper function returning None\n+    types_mapper = {pa.int64(): None}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n+\n+    # Test mapper function not containing the dtype\n+    types_mapper = {pa.float64(): pd.Float64Dtype()}.get\n+    result = data.to_pandas(types_mapper=types_mapper)\n+    assert result.dtype == data.type.to_pandas_dtype()\n\nReview comment:\n       Oh, sorry. Totally forgot I needed to correct this. Thank you for making the change!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-10T09:44:42.483+0000",
                    "updated": "2022-02-10T09:44:42.483+0000",
                    "started": "2022-02-10T09:44:42.483+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "724394",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/724395",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#discussion_r803483303\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -4082,16 +4082,52 @@ def test_array_to_pandas():\n         # tm.assert_series_equal(result, expected)\n \n \n-def test_roundtrip_empty_table_with_extension_dtype_index():\n\nReview comment:\n       Yes, I remember doing it. Thanks again, will correct.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-10T09:45:26.196+0000",
                    "updated": "2022-02-10T09:45:26.196+0000",
                    "started": "2022-02-10T09:45:26.196+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "724395",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/726937",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche closed pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T10:14:58.343+0000",
                    "updated": "2022-02-15T10:14:58.343+0000",
                    "started": "2022-02-15T10:14:58.343+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726937",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/726945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1040099351\n\n\n   Benchmark runs are scheduled for baseline = 7b5efe47ba5a31f9850e5cdbf47feea4e0f6c455 and contender = 26d6e6217ff79451a3fe366bcc88293c7ae67417. 26d6e6217ff79451a3fe366bcc88293c7ae67417 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/5c1815f5b8d14b279a5b4bd02cc78b7d...7c53a11b8113455595d2d7f39e8c440a/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/378e96c52d5d434eb5df1abae372504e...91309ca8576e48f09aab5d5d00525b2e/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/22c6a613866149f08b7dcd3228c812b5...e575dd5dc3a3411cb9ab41641914218a/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/efbab4850339488c8ed58ac7f9982021...a51c0a81d07e44219faef88362a11195/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T10:21:48.152+0000",
                    "updated": "2022-02-15T10:21:48.152+0000",
                    "started": "2022-02-15T10:21:48.152+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726945",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/726956",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1040099351\n\n\n   Benchmark runs are scheduled for baseline = 7b5efe47ba5a31f9850e5cdbf47feea4e0f6c455 and contender = 26d6e6217ff79451a3fe366bcc88293c7ae67417. 26d6e6217ff79451a3fe366bcc88293c7ae67417 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/5c1815f5b8d14b279a5b4bd02cc78b7d...7c53a11b8113455595d2d7f39e8c440a/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/378e96c52d5d434eb5df1abae372504e...91309ca8576e48f09aab5d5d00525b2e/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/22c6a613866149f08b7dcd3228c812b5...e575dd5dc3a3411cb9ab41641914218a/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/efbab4850339488c8ed58ac7f9982021...a51c0a81d07e44219faef88362a11195/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T10:41:31.076+0000",
                    "updated": "2022-02-15T10:41:31.076+0000",
                    "started": "2022-02-15T10:41:31.075+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726956",
                    "issueId": "13321319"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/worklog/727061",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12178:\nURL: https://github.com/apache/arrow/pull/12178#issuecomment-1040099351\n\n\n   Benchmark runs are scheduled for baseline = 7b5efe47ba5a31f9850e5cdbf47feea4e0f6c455 and contender = 26d6e6217ff79451a3fe366bcc88293c7ae67417. 26d6e6217ff79451a3fe366bcc88293c7ae67417 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/5c1815f5b8d14b279a5b4bd02cc78b7d...7c53a11b8113455595d2d7f39e8c440a/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/378e96c52d5d434eb5df1abae372504e...91309ca8576e48f09aab5d5d00525b2e/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/22c6a613866149f08b7dcd3228c812b5...e575dd5dc3a3411cb9ab41641914218a/)\n   [Finished :arrow_down:0.26% :arrow_up:0.04%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/efbab4850339488c8ed58ac7f9982021...a51c0a81d07e44219faef88362a11195/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T14:51:31.432+0000",
                    "updated": "2022-02-15T14:51:31.432+0000",
                    "started": "2022-02-15T14:51:31.432+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727061",
                    "issueId": "13321319"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 15000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@303f845b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24ec6973[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@577506d6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@10955aba[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4af59794[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@73cd6393[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c71888a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@368b4334[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@50a42b46[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@48ed1b3a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4858ff75[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@242697a9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Feb 15 10:14:52 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-02-15T10:14:52.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9664/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2020-08-06T14:33:49.000+0000",
        "updated": "2022-02-16T04:42:02.000+0000",
        "timeoriginalestimate": null,
        "description": "Arrow structures (Array, ChunkedArray, Table) have a types_mapper argument in their to_pandas method. It works for Table, but doesn't seem to get called for Array or ChunkedArray:\r\n{code:java}\r\nimport pandas as pd\r\nimport pyarrow\r\n\r\ndata = pd.Series([0, None, 2], dtype=pd.Int32Dtype(), name='foo')\r\n\r\ndef convert_types(arrow_type):\r\n     raise ValueError(\"Function got called\")\r\n\r\n\r\npyarrow.Table.from_pandas(data.to_frame()).to_pandas(types_mapper=convert_types)\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/adrien/.pyenv/versions/complete/lib/python3.8/site-packages/IPython/core/interactiveshell.py\", line 3331, in run_code\r\n    exec(code_obj, self.user_global_ns, self.user_ns)\r\n  File \"<ipython-input-6-d1e3e1f45f69>\", line 1, in <module>\r\n    pyarrow.Table.from_pandas(data.to_frame()).to_pandas(types_mapper=convert_types)\r\n  File \"pyarrow/array.pxi\", line 715, in pyarrow.lib._PandasConvertible.to_pandas\r\n  File \"pyarrow/table.pxi\", line 1565, in pyarrow.lib.Table._to_pandas\r\n  File \"/home/adrien/.pyenv/versions/complete/lib/python3.8/site-packages/pyarrow/pandas_compat.py\", line 771, in table_to_blockmanager\r\n    ext_columns_dtypes = _get_extension_dtypes(\r\n  File \"/home/adrien/.pyenv/versions/complete/lib/python3.8/site-packages/pyarrow/pandas_compat.py\", line 840, in _get_extension_dtypes\r\n    pandas_dtype = types_mapper(typ)\r\n  File \"<ipython-input-5-5a9760e8753f>\", line 2, in convert_types\r\n    raise ValueError(\"Function got called\")\r\nValueError: Function got called\r\n\r\npyarrow.Int32Array.from_pandas(data).to_pandas(types_mapper=convert_types)\r\n\r\n0    0.0\r\n1    NaN\r\n2    2.0\r\ndtype: float64{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Array/ChunkedArray.to_pandas do not support types_mapper keyword",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "pyarrow: 1.0.0\r\npandas: 1.0.5\r\npython: sys.version_info(major=3, minor=8, micro=2, releaselevel='final', serial=0)",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/comment/17173130",
                    "id": "17173130",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "[~Adrien_] thanks for the report! That's indeed currently a limitation. We should at least update the docstring entry of this keyword to indicate that. \r\nAnd further contributions to extend the support are certainly welcome.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-08-07T13:10:30.520+0000",
                    "updated": "2020-08-07T13:10:30.520+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/comment/17173133",
                    "id": "17173133",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "The current handling of {{types_mapper}} is tightly linked to the conversion to a pandas DataFrame, combining with dealing with the pandas metadata stored in the table's schema.\r\n\r\nFor Array/ChunkedArray it would thus need some custom logic (it doesn't involve pandas metadata here), but it should also be relatively straightforward to add (since it's just the type of the array that needs to be checked with the {{types_mapper}} function).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-08-07T13:14:09.260+0000",
                    "updated": "2020-08-07T13:14:09.260+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13321319/comment/17492497",
                    "id": "17492497",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Issue resolved by pull request 12178\n[https://github.com/apache/arrow/pull/12178]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-02-15T10:14:52.586+0000",
                    "updated": "2022-02-15T10:14:52.586+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z0hj8o:",
        "customfield_12314139": null
    }
}