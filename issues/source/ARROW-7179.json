{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13268606",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606",
    "key": "ARROW-7179",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "analytics",
            "kernel",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12346358",
                "id": "12346358",
                "description": "",
                "name": "0.15.1",
                "archived": false,
                "released": true,
                "releaseDate": "2019-11-01"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12589362",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12589362",
                "type": {
                    "id": "12310460",
                    "name": "Child-Issue",
                    "inward": "is a child of",
                    "outward": "is a parent of",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310460"
                },
                "inwardIssue": {
                    "id": "13306872",
                    "key": "ARROW-8894",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306872",
                    "fields": {
                        "summary": "[C++] C++ array kernels framework and execution buildout (umbrella issue)",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12620763",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12620763",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "outwardIssue": {
                    "id": "13384941",
                    "key": "ARROW-13136",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384941",
                    "fields": {
                        "summary": "[C++] Add a \"coalesce\" variadic scalar kernel",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7179/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 20,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641176",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987\n\n\n   This removes fill_null in favor of coalesce. \r\n   \r\n   A few points:\r\n   - This leaves behind the Python aliases for convenience.\r\n   - This is about 25% slower than fill_null for the (Array, Scalar) case for fixed-width types. As far as I can see, this is mostly because the handwritten fill_null only unboxes the scalar once (and does so cheaply), while the generic implementation here unboxes the scalar on every loop (the compiler doesn't manage to hoist it) *and* UnboxScalar is relatively expensive (requiring a virtual call). I tried to make UnboxScalar less expensive but couldn't avoid undefined behavior/incorrect results for the DayTimeIntervalType case.\r\n   - This specializes all the two-argument cases for fixed-width types but it might not really be worth it except for the (Array, Scalar) case.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-24T16:14:04.717+0000",
                    "updated": "2021-08-24T16:14:04.717+0000",
                    "started": "2021-08-24T16:14:04.717+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641176",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641177",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-904781611\n\n\n   https://issues.apache.org/jira/browse/ARROW-7179\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-24T16:14:32.077+0000",
                    "updated": "2021-08-24T16:14:32.077+0000",
                    "started": "2021-08-24T16:14:32.077+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641177",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641740",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r695841734\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       Have you tried using `BitRunReader` instead?\r\n   \r\n   (er, perhaps we already had this conversation? :-S)\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n+                                                       left_arr.length);\n+  int64_t offset = 0;\n+\n+  const uint8_t* left_values = left_arr.buffers[1]->data();\n+  const Scalar& right_scalar = *right.scalar();\n+  while (offset < length) {\n+    const auto block = bit_counter.NextWord();\n+    if (block.AllSet()) {\n+      // All from left\n+      CopyFixedWidth<Type>::CopyArray(*left_arr.type, left_values,\n+                                      left_arr.offset + offset, block.length, out_values,\n+                                      out_offset + offset);\n+    } else if (block.NoneSet()) {\n+      // All from right\n+      CopyFixedWidth<Type>::CopyScalar(right_scalar, block.length, out_values,\n+                                       out_offset + offset);\n+    } else if (block.popcount) {\n+      // One by one\n+      for (int64_t j = 0; j < block.length; ++j) {\n+        if (BitUtil::GetBit(left_valid, left_arr.offset + offset + j)) {\n+          CopyFixedWidth<Type>::CopyArray(\n+              *left_arr.type, left_values, left_arr.offset + offset + j,\n+              /*length=*/1, out_values, out_offset + offset + j);\n+        } else {\n+          CopyFixedWidth<Type>::CopyScalar(right_scalar, /*length=*/1, out_values,\n+                                           out_offset + offset + j);\n+        }\n+      }\n+    }\n+    offset += block.length;\n+  }\n+\n+  if (right_scalar.is_valid || !left_valid) {\n+    BitUtil::SetBitsTo(out_valid, out_offset, length, true);\n+  } else {\n+    arrow::internal::CopyBitmap(left_valid, left_arr.offset, length, out_valid,\n+                                out_offset);\n+  }\n+  return Status::OK();\n+}\n+\n+// Special case: implement 'coalesce' for any 2 arguments for any fixed-width\n+// type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecBinaryCoalesce(KernelContext* ctx, Datum left, Datum right, int64_t length,\n+                          Datum* out) {\n+  if (left.is_scalar() && right.is_scalar()) {\n+    // Both scalar\n+    *out = left.scalar()->is_valid ? left : right;\n+    return Status::OK();\n+  }\n+\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  if (left.is_scalar()) {\n+    // LHS is scalar\n+    CopyValues<Type>(left.scalar()->is_valid ? left : right, /*in_offset=*/0, length,\n+                     out_valid, out_values, out_offset);\n+    return Status::OK();\n+  }\n+\n+  // Array with nulls\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n+                                                       left_arr.length);\n+  int64_t offset = 0;\n+\n+  if (right.is_scalar()) {\n\nReview comment:\n       Shouldn't this be moved up before `// Array with nulls`?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n+                                                       left_arr.length);\n+  int64_t offset = 0;\n+\n+  const uint8_t* left_values = left_arr.buffers[1]->data();\n+  const Scalar& right_scalar = *right.scalar();\n+  while (offset < length) {\n+    const auto block = bit_counter.NextWord();\n+    if (block.AllSet()) {\n+      // All from left\n+      CopyFixedWidth<Type>::CopyArray(*left_arr.type, left_values,\n+                                      left_arr.offset + offset, block.length, out_values,\n+                                      out_offset + offset);\n+    } else if (block.NoneSet()) {\n+      // All from right\n+      CopyFixedWidth<Type>::CopyScalar(right_scalar, block.length, out_values,\n+                                       out_offset + offset);\n+    } else if (block.popcount) {\n+      // One by one\n+      for (int64_t j = 0; j < block.length; ++j) {\n+        if (BitUtil::GetBit(left_valid, left_arr.offset + offset + j)) {\n+          CopyFixedWidth<Type>::CopyArray(\n+              *left_arr.type, left_values, left_arr.offset + offset + j,\n+              /*length=*/1, out_values, out_offset + offset + j);\n+        } else {\n+          CopyFixedWidth<Type>::CopyScalar(right_scalar, /*length=*/1, out_values,\n+                                           out_offset + offset + j);\n+        }\n+      }\n+    }\n+    offset += block.length;\n+  }\n+\n+  if (right_scalar.is_valid || !left_valid) {\n+    BitUtil::SetBitsTo(out_valid, out_offset, length, true);\n+  } else {\n+    arrow::internal::CopyBitmap(left_valid, left_arr.offset, length, out_valid,\n+                                out_offset);\n+  }\n+  return Status::OK();\n+}\n+\n+// Special case: implement 'coalesce' for any 2 arguments for any fixed-width\n+// type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecBinaryCoalesce(KernelContext* ctx, Datum left, Datum right, int64_t length,\n+                          Datum* out) {\n+  if (left.is_scalar() && right.is_scalar()) {\n+    // Both scalar\n+    *out = left.scalar()->is_valid ? left : right;\n+    return Status::OK();\n+  }\n+\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  if (left.is_scalar()) {\n+    // LHS is scalar\n+    CopyValues<Type>(left.scalar()->is_valid ? left : right, /*in_offset=*/0, length,\n+                     out_valid, out_values, out_offset);\n+    return Status::OK();\n+  }\n+\n+  // Array with nulls\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n\nReview comment:\n       Is it possible for `left_valid` to be null? If there are no nulls in the left argument, I would expect this to shortcut.\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n\nReview comment:\n       Is it possible for `left_valid` to be null?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else_benchmark.cc\n##########\n@@ -386,8 +441,13 @@ BENCHMARK(CaseWhenBenchString)->Args({kFewItems, 99});\n BENCHMARK(CaseWhenBenchStringContiguous)->Args({kFewItems, 0});\n BENCHMARK(CaseWhenBenchStringContiguous)->Args({kFewItems, 99});\n \n-BENCHMARK(CoalesceBench64)->Args({kNumItems, 0});\n-BENCHMARK(CoalesceBench64)->Args({kNumItems, 99});\n+BENCHMARK(CoalesceBench64)->Args({kNumItems, 0, 2});\n+BENCHMARK(CoalesceBench64)->Args({kNumItems, 0, 4});\n+BENCHMARK(CoalesceBench64)->Args({kNumItems, 99, 2});\n+BENCHMARK(CoalesceBench64)->Args({kNumItems, 99, 4});\n+\n+BENCHMARK(CoalesceScalarBench64)->Args({kNumItems, 0});\n+BENCHMARK(CoalesceScalarStringBench)->Args({kNumItems, 0});\n \n BENCHMARK(CoalesceNonNullBench64)->Args({kNumItems, 0});\n BENCHMARK(CoalesceNonNullBench64)->Args({kNumItems, 99});\n\nReview comment:\n       It is possible to also parametrize the null_probability used in the coalesce benchmarks? I think we have some logic to do this (see e.g. RegressionArgs and the Take benchmarks).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T15:18:45.894+0000",
                    "updated": "2021-08-25T15:18:45.894+0000",
                    "started": "2021-08-25T15:18:45.894+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641740",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641790",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r695913702\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       It was not helpful in case_when but might be useful here, I can give it a try.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T16:22:35.829+0000",
                    "updated": "2021-08-25T16:22:35.829+0000",
                    "started": "2021-08-25T16:22:35.829+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641790",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641795",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r695918177\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       It may largely depend on the clustering of nulls/non-nulls, hence the suggestion to benchmark different null probabilites.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T16:28:06.643+0000",
                    "updated": "2021-08-25T16:28:06.643+0000",
                    "started": "2021-08-25T16:28:06.643+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641795",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/641856",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r695973782\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       In this case it does better, though I could imagine it doing badly at ~50% nulls.\r\n   ```\r\n   --------------------------------------------------------------------------------------\r\n   Benchmark                            Time             CPU   Iterations UserCounters...\r\n   --------------------------------------------------------------------------------------\r\n   Before:\r\n   CoalesceScalarBench64/0        1321249 ns      1321175 ns          508 bytes_per_second=5.9133G/s items_per_second=793.67M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarBench64/2        5049228 ns      5049073 ns          133 bytes_per_second=1.54731G/s items_per_second=207.677M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarStringBench/0   87407512 ns     87404678 ns            7 bytes_per_second=5.70364G/s items_per_second=11.9968M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarStringBench/2   77686321 ns     77685936 ns            8 bytes_per_second=4.87622G/s items_per_second=13.4976M/s length=1048.58k null%=25 num_args=2\r\n   After:\r\n   CoalesceScalarBench64/0         988642 ns       988606 ns          664 bytes_per_second=7.90255G/s items_per_second=1060.66M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarBench64/2        4537487 ns      4537432 ns          154 bytes_per_second=1.72179G/s items_per_second=231.095M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarStringBench/0  103582667 ns    103575544 ns            6 bytes_per_second=4.81315G/s items_per_second=10.1238M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarStringBench/2   79813292 ns     79807705 ns            8 bytes_per_second=4.74658G/s items_per_second=13.1388M/s length=1048.58k null%=25 num_args=2\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T17:35:30.622+0000",
                    "updated": "2021-08-25T17:35:30.622+0000",
                    "started": "2021-08-25T17:35:30.621+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641856",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642319",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r696610595\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       Just for completeness, I tested 50% and 99% nulls too. BitRunReader is still faster overall, maybe a bit slower with 50% nulls with strings.\r\n   \r\n   ```\r\n   --------------------------------------------------------------------------------------\r\n   Benchmark                            Time             CPU   Iterations UserCounters...\r\n   --------------------------------------------------------------------------------------\r\n   BitBlockCounter:\r\n   CoalesceScalarBench64/0        1488163 ns      1488088 ns          457 bytes_per_second=5.25003G/s items_per_second=704.647M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarBench64/2        5307719 ns      5307520 ns          133 bytes_per_second=1.47197G/s items_per_second=197.564M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarBench64/4        8338070 ns      8337713 ns           83 bytes_per_second=959.496M/s items_per_second=125.763M/s length=1048.58k null%=50 num_args=2\r\n   CoalesceScalarBench64/6        2187502 ns      2187409 ns          323 bytes_per_second=3.57158G/s items_per_second=479.369M/s length=1048.58k null%=99 num_args=2\r\n   CoalesceScalarStringBench/0  112844773 ns    112838638 ns            5 bytes_per_second=4.41803G/s items_per_second=9.2927M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarStringBench/2   94380710 ns     94376399 ns            8 bytes_per_second=4.01386G/s items_per_second=11.1106M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarStringBench/4   54766774 ns     54766616 ns           10 bytes_per_second=4.64332G/s items_per_second=19.1463M/s length=1048.58k null%=50 num_args=2\r\n   CoalesceScalarStringBench/6    6268787 ns      6268586 ns          108 bytes_per_second=1.41205G/s items_per_second=167.275M/s length=1048.58k null%=99 num_args=2\r\n   BitRunReader:\r\n   CoalesceScalarBench64/0         994000 ns       994007 ns          717 bytes_per_second=7.8596G/s items_per_second=1054.9M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarBench64/2        4624991 ns      4625012 ns          153 bytes_per_second=1.68918G/s items_per_second=226.719M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarBench64/4        7016190 ns      7016189 ns          102 bytes_per_second=1.1135G/s items_per_second=149.451M/s length=1048.58k null%=50 num_args=2\r\n   CoalesceScalarBench64/6        1013352 ns      1013358 ns          672 bytes_per_second=7.70952G/s items_per_second=1034.75M/s length=1048.58k null%=99 num_args=2\r\n   CoalesceScalarStringBench/0  110433694 ns    110433042 ns            5 bytes_per_second=4.51427G/s items_per_second=9.49513M/s length=1048.58k null%=1 num_args=2\r\n   CoalesceScalarStringBench/2   79904343 ns     79904642 ns            7 bytes_per_second=4.74082G/s items_per_second=13.1228M/s length=1048.58k null%=25 num_args=2\r\n   CoalesceScalarStringBench/4   61812967 ns     61813273 ns           10 bytes_per_second=4.11398G/s items_per_second=16.9636M/s length=1048.58k null%=50 num_args=2\r\n   CoalesceScalarStringBench/6    6219633 ns      6219571 ns          105 bytes_per_second=1.42317G/s items_per_second=168.593M/s length=1048.58k null%=99 num_args=2\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T13:07:12.344+0000",
                    "updated": "2021-08-26T13:07:12.344+0000",
                    "started": "2021-08-26T13:07:12.343+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642319",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642374",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#discussion_r696696745\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_if_else.cc\n##########\n@@ -1827,9 +1827,131 @@ Status ExecArrayCoalesce(KernelContext* ctx, const ExecBatch& batch, Datum* out)\n   return Status::OK();\n }\n \n+// Special case: implement 'coalesce' for an array and a scalar for any\n+// fixed-width type (a 'fill_null' operation)\n+template <typename Type>\n+Status ExecArrayScalarCoalesce(KernelContext* ctx, Datum left, Datum right,\n+                               int64_t length, Datum* out) {\n+  ArrayData* output = out->mutable_array();\n+  const int64_t out_offset = output->offset;\n+  uint8_t* out_valid = output->buffers[0]->mutable_data();\n+  uint8_t* out_values = output->buffers[1]->mutable_data();\n+\n+  const ArrayData& left_arr = *left.array();\n+  const uint8_t* left_valid =\n+      left_arr.MayHaveNulls() ? left_arr.buffers[0]->data() : nullptr;\n+  arrow::internal::OptionalBitBlockCounter bit_counter(left_valid, left_arr.offset,\n\nReview comment:\n       Thanks for the numbers!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T14:39:08.974+0000",
                    "updated": "2021-08-26T14:39:08.974+0000",
                    "started": "2021-08-26T14:39:08.974+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642374",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642457",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906586422\n\n\n   I've submitted a PR to your branch to improve performance:\r\n   https://github.com/lidavidm/arrow/pull/4\r\n   \r\n   I think the same approach may be used for other conditional kernels, but that would be a separate JIRA.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T17:05:03.189+0000",
                    "updated": "2021-08-26T17:05:03.189+0000",
                    "started": "2021-08-26T17:05:03.189+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642457",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642483",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dianaclarke commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906612083\n\n\n   @ursabot please benchmark\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T17:43:27.296+0000",
                    "updated": "2021-08-26T17:43:27.296+0000",
                    "started": "2021-08-26T17:43:27.296+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642483",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642484",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906612798\n\n\n   Benchmark runs are scheduled for baseline = 20885df121266a8519692c7630c98beb570f3b47 and contender = 43a44500991e2193a99e582d50f669ab1f6beeea. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b0b82bffb57d4625b61eeb1d913c6373...dff104776e154921b3494fb1709d8eaf/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/7e6b3303b2c4441bab00c2f4aacd238d...e6aca9e032be4c0caa030c0dfa726d69/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/5d7f13b26a47454f9337081a24b98b6e...47a8ef6a5e2e4569bcde6bc342177410/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T17:44:31.932+0000",
                    "updated": "2021-08-26T17:44:31.932+0000",
                    "started": "2021-08-26T17:44:31.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642484",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642487",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906615407\n\n\n   I think the benchmarks changed from git master, so I'm not sure there will be meaningful changes shown by conbench.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T17:48:30.102+0000",
                    "updated": "2021-08-26T17:48:30.102+0000",
                    "started": "2021-08-26T17:48:30.101+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642487",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642492",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906612798\n\n\n   Benchmark runs are scheduled for baseline = 20885df121266a8519692c7630c98beb570f3b47 and contender = 43a44500991e2193a99e582d50f669ab1f6beeea. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b0b82bffb57d4625b61eeb1d913c6373...dff104776e154921b3494fb1709d8eaf/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/7e6b3303b2c4441bab00c2f4aacd238d...e6aca9e032be4c0caa030c0dfa726d69/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/5d7f13b26a47454f9337081a24b98b6e...47a8ef6a5e2e4569bcde6bc342177410/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T17:56:23.939+0000",
                    "updated": "2021-08-26T17:56:23.939+0000",
                    "started": "2021-08-26T17:56:23.939+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642492",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642608",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906612798\n\n\n   Benchmark runs are scheduled for baseline = 20885df121266a8519692c7630c98beb570f3b47 and contender = 43a44500991e2193a99e582d50f669ab1f6beeea. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b0b82bffb57d4625b61eeb1d913c6373...dff104776e154921b3494fb1709d8eaf/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/7e6b3303b2c4441bab00c2f4aacd238d...e6aca9e032be4c0caa030c0dfa726d69/)\n   [Finished :arrow_down:0.55% :arrow_up:0.51%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/5d7f13b26a47454f9337081a24b98b6e...47a8ef6a5e2e4569bcde6bc342177410/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T22:12:22.194+0000",
                    "updated": "2021-08-26T22:12:22.194+0000",
                    "started": "2021-08-26T22:12:22.194+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642608",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642609",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-906612798\n\n\n   Benchmark runs are scheduled for baseline = 20885df121266a8519692c7630c98beb570f3b47 and contender = 43a44500991e2193a99e582d50f669ab1f6beeea. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b0b82bffb57d4625b61eeb1d913c6373...dff104776e154921b3494fb1709d8eaf/)\n   [Finished :arrow_down:1.46% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/7e6b3303b2c4441bab00c2f4aacd238d...e6aca9e032be4c0caa030c0dfa726d69/)\n   [Finished :arrow_down:0.55% :arrow_up:0.51%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/5d7f13b26a47454f9337081a24b98b6e...47a8ef6a5e2e4569bcde6bc342177410/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-26T22:19:28.633+0000",
                    "updated": "2021-08-26T22:19:28.633+0000",
                    "started": "2021-08-26T22:19:28.632+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642609",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642761",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-907076442\n\n\n   > I think the benchmarks changed from git master, so I'm not sure there will be meaningful changes shown by conbench.\r\n   \r\n   Indeed, it seems there are no significant changes in the already existing benchmarks.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-27T09:50:47.304+0000",
                    "updated": "2021-08-27T09:50:47.304+0000",
                    "started": "2021-08-27T09:50:47.304+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642761",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642762",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-27T09:51:11.057+0000",
                    "updated": "2021-08-27T09:51:11.057+0000",
                    "started": "2021-08-27T09:51:11.056+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642762",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642763",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-907077297\n\n\n   > I've submitted a PR to your branch to improve performance:\r\n   > [lidavidm#4](https://github.com/lidavidm/arrow/pull/4)\r\n   > \r\n   > I think the same approach may be used for other conditional kernels, but that would be a separate JIRA.\r\n   \r\n   Apparently `if_else` is already quite optimized, so I'm not sure there's anything to be done. I didn't look at `case_when`.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-27T09:52:15.650+0000",
                    "updated": "2021-08-27T09:52:15.650+0000",
                    "started": "2021-08-27T09:52:15.649+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642763",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642809",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-907164879\n\n\n   Thanks! case_when could probably use some work, though I'm currently in the middle of digging into it to get dictionary support. select also could use some work (though the task there is harder).\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-27T12:26:17.546+0000",
                    "updated": "2021-08-27T12:26:17.546+0000",
                    "started": "2021-08-27T12:26:17.546+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642809",
                    "issueId": "13268606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/worklog/642810",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm edited a comment on pull request #10987:\nURL: https://github.com/apache/arrow/pull/10987#issuecomment-907164879\n\n\n   Thanks! case_when could probably use some work, though I'm currently in the middle of digging into it to get dictionary support. select also could use some work (though the task there is harder). I'll file issues/take a look when I get a chance.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-27T12:26:32.107+0000",
                    "updated": "2021-08-27T12:26:32.107+0000",
                    "started": "2021-08-27T12:26:32.106+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "642810",
                    "issueId": "13268606"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 12000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@577f01dd[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@ff0cdfd[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@37c5f762[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3ed35b42[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@64cef3ab[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@27f4d223[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3f124f58[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1bbf1ab3[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@8ffe1c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@91b4f32[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@245eb9c6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@47d7457c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Aug 27 09:52:05 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-08-27T09:52:05.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7179/watchers",
            "watchCount": 6,
            "isWatching": false
        },
        "created": "2019-11-15T16:04:00.000+0000",
        "updated": "2021-08-27T12:26:33.000+0000",
        "timeoriginalestimate": null,
        "description": "fill_null and coalesce are essentially the same kernel, except the former is binary and doesn't support an array fill value, and the latter is variadic and supports scalar and array fill values.\r\n\r\nWe should consolidate them into one kernel, picking the faster implementation.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Compute] Consolidate fill_null and coalesce",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17116227",
                    "id": "17116227",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "We can implement this either as a Binary or VarArgs scalar kernel",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-05-25T20:02:22.912+0000",
                    "updated": "2020-05-25T20:02:22.912+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17394150",
                    "id": "17394150",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "cc [~lidavidm]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-08-05T16:05:57.894+0000",
                    "updated": "2021-08-05T16:05:57.894+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17394152",
                    "id": "17394152",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I think this is exactly the same as Coalesce in ARROW-13136?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-08-05T16:06:49.146+0000",
                    "updated": "2021-08-05T16:06:49.146+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17394162",
                    "id": "17394162",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Uh, perhaps :-) Those SQL names are so \"obvious\"...",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-08-05T16:29:40.182+0000",
                    "updated": "2021-08-05T16:29:40.182+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17396118",
                    "id": "17396118",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Comparing the two issues, the kernels look identical, so I'm going to close as duplicate.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-08-09T15:38:56.998+0000",
                    "updated": "2021-08-09T15:38:56.998+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17396577",
                    "id": "17396577",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "We actually already have a \"fill_null\" kernel for filling with a scalar (added in ), so this issue was about expanding that kernel to also support array fill values. That's indeed the same as coalesce. But, \"fill_null\" is currently a fully separate implementation (scalar_fill_null.cc), while I suppose \"coalesce\" might also have a specialized path for scalar fill values? That could potentially be consolidated?\r\n\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2021-08-10T09:56:28.571+0000",
                    "updated": "2021-08-10T09:56:28.571+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17396652",
                    "id": "17396652",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Ah, I see, thanks Joris. It looks like coalesce has slightly more complete type support; it's also variadic instead of binary. Maybe the path here then should be to benchmark the common implementations and choose the faster one, then consolidate both into one kernel. (And maybe provide aliases from one to the other?)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-08-10T12:44:55.088+0000",
                    "updated": "2021-08-10T12:44:55.088+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17396656",
                    "id": "17396656",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Yes, that sounds good",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2021-08-10T12:49:32.451+0000",
                    "updated": "2021-08-10T12:49:32.451+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17397448",
                    "id": "17397448",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "So fill_null is quite a bit faster than coalesce, as being able to assume there are only two arguments (one of which is an array) means it can just make one pass through the input and do block copies from one of the arguments. To get coalesce up to the same speed in the same cases, we'd essentially special-case this in coalesce anyways. Would it be preferable to implement that special case and drop fill_null, or keep fill_null as a convenient alias/optimized case much like we have if_else and case_when?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-08-11T16:09:06.741+0000",
                    "updated": "2021-08-11T16:09:06.741+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268606/comment/17405723",
                    "id": "17405723",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 10987\n[https://github.com/apache/arrow/pull/10987]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-08-27T09:52:05.632+0000",
                    "updated": "2021-08-27T09:52:05.632+0000"
                }
            ],
            "maxResults": 10,
            "total": 10,
            "startAt": 0
        },
        "customfield_12311820": "0|z08nv4:",
        "customfield_12314139": null
    }
}