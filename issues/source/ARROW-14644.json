{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13410900",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900",
    "key": "ARROW-14644",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12628183",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12628183",
                "type": {
                    "id": "12310560",
                    "name": "Problem/Incident",
                    "inward": "is caused by",
                    "outward": "causes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310560"
                },
                "outwardIssue": {
                    "id": "13416243",
                    "key": "ARROW-15041",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13416243",
                    "fields": {
                        "summary": "[R] Flaky BOM removal test",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=willjones127",
            "name": "willjones127",
            "key": "willjones127",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Will Jones",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ateucher",
            "name": "ateucher",
            "key": "JIRAUSER279940",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34043",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34043",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34043",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34043"
            },
            "displayName": "Andy Teucher",
            "active": true,
            "timeZone": "America/Vancouver"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=ateucher",
            "name": "ateucher",
            "key": "JIRAUSER279940",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34043",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34043",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34043",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34043"
            },
            "displayName": "Andy Teucher",
            "active": true,
            "timeZone": "America/Vancouver"
        },
        "aggregateprogress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14644/votes",
            "votes": 1,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/691105",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871#issuecomment-986870683\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T15:15:16.547+0000",
                    "updated": "2021-12-06T15:15:16.547+0000",
                    "started": "2021-12-06T15:15:16.546+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691105",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/691982",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871#issuecomment-988200736\n\n\n   I've found the particular line where things are going wrong, but I'm not sure how to fix.\r\n   \r\n   Column \"a\" isn't being added to convert options, as it is somehow triggering the condition on line 120. \r\n   \r\n   https://github.com/apache/arrow/blob/9cf4275a19c994879172e5d3b03ade9a96a10721/cpp/src/arrow/dataset/file_csv.cc#L117-L120\r\n   \r\n   I'm pretty baffled as it seems like the field name is clearly in the column set. Here's my debugger output from a breakpoint at line 120:\r\n   \r\n   ```\r\n   print column_names.find(field->name())\r\n   (std::unordered_set<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >::iterator) $0 = {\r\n     __node_ = nullptr\r\n   }\r\n   print column_names\r\n   (std::unordered_set<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::hash<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >) $1 = size=1 {\r\n     [0] = \"\ufeffa\"\r\n   }\r\n   print field->name()\r\n   (const std::string) $2 = \"a\"\r\n   print (*column_names.begin())\r\n   (const std::__hash_const_iterator<std::__hash_node<std::basic_string<char, std::char_traits<char>, std::allocator<char> >, void *> *>::value_type) $4 = \"\ufeffa\"\r\n   ```\r\n   \r\n   (I altered the test so it just contains column \"a\" to make it easier to grab the value in the set; I get similar results with the original test that has both columns.)\r\n   \r\n   I'm fairly sure this is the root problem because when I run `column_names.insert(field->name())` at the breakpoint and continue, the test passes.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T19:18:35.840+0000",
                    "updated": "2021-12-07T19:18:35.840+0000",
                    "started": "2021-12-07T19:18:35.840+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691982",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/691996",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871#issuecomment-988214158\n\n\n   Found it: Looks like `column_names` still contains BOM, while the field names do not, hence the mismatch.\r\n   \r\n   ```\r\n   x/20bc &(*column_names.begin())\r\n   0x286780300: \\xef\\xbb\\xbfa\\0\\0\\0\\0pb\\xe0o\\x01\\0\\0\\0\\xb0c\\xe0o\r\n   x/20bc field->name().data()\r\n   0x28765f660: a\\0\\0\\0\\0\\0\\0p\\x17'v(\\0\\0\\0P\\x02\\0]\\x80\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T19:41:52.146+0000",
                    "updated": "2021-12-07T19:41:52.146+0000",
                    "started": "2021-12-07T19:41:52.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691996",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692052",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871#issuecomment-988249677\n\n\n   @dragosmg Would you be willing to give me permission to push to your repo? I have a fix in C++ I can push to this branch.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T20:42:15.985+0000",
                    "updated": "2021-12-07T20:42:15.985+0000",
                    "started": "2021-12-07T20:42:15.985+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692052",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692077",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 opened a new pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892\n\n\n   `arrow::csv::StreamingReader` already has handling for byte order marks (BOM). However, #7896 introduced `arrow::dataset::GetColumnNames` which is called prior to instantiating the reader and was missing BOM handling. This PR adds BOM handling to that method.\r\n   \r\n   Without BOM handling, the first column as parsed by `arrow::dataset::GetColumnNames` contained the BOM (e.g. was `\"<BOM>a\"` instead of `\"a\"`). Because of this, it failed the test on line 120 below and was not added to `convert_options.include_columns`. \r\n   \r\n   https://github.com/apache/arrow/blob/9cf4275a19c994879172e5d3b03ade9a96a10721/cpp/src/arrow/dataset/file_csv.cc#L117-L122\r\n   \r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T21:29:51.537+0000",
                    "updated": "2021-12-07T21:29:51.537+0000",
                    "started": "2021-12-07T21:29:51.537+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692077",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692078",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#issuecomment-988276105\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T21:30:14.270+0000",
                    "updated": "2021-12-07T21:30:14.270+0000",
                    "started": "2021-12-07T21:30:14.270+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692078",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692079",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871#issuecomment-988276203\n\n\n   @dragosmg nvm. Let's just close this in favor of #11892\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T21:30:27.041+0000",
                    "updated": "2021-12-07T21:30:27.041+0000",
                    "started": "2021-12-07T21:30:27.041+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692079",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692084",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg closed pull request #11871:\nURL: https://github.com/apache/arrow/pull/11871\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T21:32:09.465+0000",
                    "updated": "2021-12-07T21:32:09.465+0000",
                    "started": "2021-12-07T21:32:09.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692084",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692093",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764388441\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_csv.cc\n##########\n@@ -85,7 +86,13 @@ Result<std::unordered_set<std::string>> GetColumnNames(\n \n   RETURN_NOT_OK(\n       parser.VisitLastRow([&](const uint8_t* data, uint32_t size, bool quoted) -> Status {\n-        util::string_view view{reinterpret_cast<const char*>(data), size};\n+        // Skip BOM when reading column names (ARROW-14644)\n+        ARROW_ASSIGN_OR_RAISE(auto data2, util::SkipUTF8BOM(data, size));\n\nReview comment:\n       Minor nit: I don't love `data2` as a name.  Maybe `data_no_bom` or `sliced_data`.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T21:50:17.795+0000",
                    "updated": "2021-12-07T21:50:17.795+0000",
                    "started": "2021-12-07T21:50:17.795+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692093",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692147",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764437960\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_csv.cc\n##########\n@@ -85,7 +86,13 @@ Result<std::unordered_set<std::string>> GetColumnNames(\n \n   RETURN_NOT_OK(\n       parser.VisitLastRow([&](const uint8_t* data, uint32_t size, bool quoted) -> Status {\n-        util::string_view view{reinterpret_cast<const char*>(data), size};\n+        // Skip BOM when reading column names (ARROW-14644)\n+        ARROW_ASSIGN_OR_RAISE(auto data_no_bom, util::SkipUTF8BOM(data, size));\n+        int32_t offset = data_no_bom - data;\n+        DCHECK_GE(offset, 0);\n+        size = size - offset;\n\nReview comment:\n       ```suggestion\r\n           ptrdiff_t offset = data_no_bom - data;\r\n           DCHECK_GE(offset, 0);\r\n           size = size - static_cast<uint32_t>(offset);\r\n   ```\r\n   The Windows CI job is failing.\r\n   \r\n   I think this will make windows happy but I never know and I don't have this in my IDE at the moment so I may be way off base here.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T23:28:32.644+0000",
                    "updated": "2021-12-07T23:28:32.644+0000",
                    "started": "2021-12-07T23:28:32.644+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692147",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692150",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764441816\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_csv.cc\n##########\n@@ -85,7 +86,13 @@ Result<std::unordered_set<std::string>> GetColumnNames(\n \n   RETURN_NOT_OK(\n       parser.VisitLastRow([&](const uint8_t* data, uint32_t size, bool quoted) -> Status {\n-        util::string_view view{reinterpret_cast<const char*>(data), size};\n+        // Skip BOM when reading column names (ARROW-14644)\n+        ARROW_ASSIGN_OR_RAISE(auto data_no_bom, util::SkipUTF8BOM(data, size));\n+        int32_t offset = data_no_bom - data;\n+        DCHECK_GE(offset, 0);\n+        size = size - offset;\n\nReview comment:\n       Thanks, I wasn't sure what the best way to explicitly cast was. Those changes work locally on my Mac; hopefully will work in Windows builds.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-07T23:37:56.138+0000",
                    "updated": "2021-12-07T23:37:56.138+0000",
                    "started": "2021-12-07T23:37:56.138+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692150",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692171",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764459729\n\n\n\n##########\nFile path: r/tests/testthat/test-csv.R\n##########\n@@ -447,5 +447,13 @@ test_that(\"write_csv_arrow deals with duplication in include_headers/col_names\",\n   )\n   expect_true(file.exists(csv_file))\n   expect_identical(tbl_no_dates, written_tbl)\n+})\n+\n+test_that(\"read_csv_arrow() deals with BOMs (bite-order-marks) correctly\", {\n+  writeLines('\\xef\\xbb\\xbfa,b\\n1,2\\n', con = csv_file)\n\nReview comment:\n       Sorry, I should have noticed this before but it looks like there are some R style violations\r\n   ```suggestion\r\n     writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T00:25:44.057+0000",
                    "updated": "2021-12-08T00:25:44.057+0000",
                    "started": "2021-12-08T00:25:44.057+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692171",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692173",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764459811\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (bite-order-marks) correctly\", {\n+  writeLines('\\xef\\xbb\\xbfa,b\\n1,2\\n', con = csv_file)\n\nReview comment:\n       ```suggestion\r\n     writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T00:25:59.166+0000",
                    "updated": "2021-12-08T00:25:59.166+0000",
                    "started": "2021-12-08T00:25:59.166+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692173",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692445",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r764762662\n\n\n\n##########\nFile path: r/tests/testthat/test-csv.R\n##########\n@@ -447,5 +447,13 @@ test_that(\"write_csv_arrow deals with duplication in include_headers/col_names\",\n   )\n   expect_true(file.exists(csv_file))\n   expect_identical(tbl_no_dates, written_tbl)\n+})\n+\n+test_that(\"read_csv_arrow() deals with BOMs (bite-order-marks) correctly\", {\n\nReview comment:\n       \"byte\"\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (bite-order-marks) correctly\", {\n\nReview comment:\n       \"byte\"\n\n##########\nFile path: cpp/src/arrow/dataset/file_csv.cc\n##########\n@@ -85,7 +86,13 @@ Result<std::unordered_set<std::string>> GetColumnNames(\n \n   RETURN_NOT_OK(\n       parser.VisitLastRow([&](const uint8_t* data, uint32_t size, bool quoted) -> Status {\n-        util::string_view view{reinterpret_cast<const char*>(data), size};\n+        // Skip BOM when reading column names (ARROW-14644)\n+        ARROW_ASSIGN_OR_RAISE(auto data_no_bom, util::SkipUTF8BOM(data, size));\n+        ptrdiff_t offset = data_no_bom - data;\n+        DCHECK_GE(offset, 0);\n\nReview comment:\n       This doesn't seem useful. You can therefore shorten this to:\r\n   ```c++\r\n           size = size - static_cast<uint32_t>(data_no_bom - data);\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T11:02:29.992+0000",
                    "updated": "2021-12-08T11:02:29.992+0000",
                    "started": "2021-12-08T11:02:29.992+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692445",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692795",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r765138850\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (byte-order-marks) correctly\", {\n+  writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\n+\n+  expect_equal(\n+    open_dataset(csv_file, format = \"csv\") %>% collect(),\n+    tibble(a = 1, b = 2)\n+  )\n\nReview comment:\n       Would it be possible to make two csv files and read those in as a dataset? This _should_ work just the same, but it would be good to confirm that the second csv has the proper BOM handling as well.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T18:46:01.394+0000",
                    "updated": "2021-12-08T18:46:01.394+0000",
                    "started": "2021-12-08T18:46:01.394+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692795",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692797",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wjones127 commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r765144252\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (byte-order-marks) correctly\", {\n+  writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\n+\n+  expect_equal(\n+    open_dataset(csv_file, format = \"csv\") %>% collect(),\n+    tibble(a = 1, b = 2)\n+  )\n\nReview comment:\n       Oh that's a good idea. I'll add that really quick.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T18:47:56.148+0000",
                    "updated": "2021-12-08T18:47:56.148+0000",
                    "started": "2021-12-08T18:47:56.147+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692797",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane closed pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T20:48:23.336+0000",
                    "updated": "2021-12-08T20:48:23.336+0000",
                    "started": "2021-12-08T20:48:23.336+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692867",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692868",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#issuecomment-989185185\n\n\n   Benchmark runs are scheduled for baseline = 001f47eb05f722d8e34b123e6673eeb8be836965 and contender = 62db4b6a2545da29279ee5c138b5f531067d802a. 62db4b6a2545da29279ee5c138b5f531067d802a is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/7d4611d9b3d14d94a37da1fce8494cd8...10e7ff5e4dae441ea25cff4add4096d3/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/8ef159c8011c41c8ade5b1c7be946449...0be9d7e3c3d14e16ad47f942b5a5941a/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/8481284679d04731ab18e4a95360c1b0...aac2c1901c974a06a274b4c165ce99fa/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T20:51:20.121+0000",
                    "updated": "2021-12-08T20:51:20.121+0000",
                    "started": "2021-12-08T20:51:20.120+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692868",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/692875",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#issuecomment-989185185\n\n\n   Benchmark runs are scheduled for baseline = 001f47eb05f722d8e34b123e6673eeb8be836965 and contender = 62db4b6a2545da29279ee5c138b5f531067d802a. 62db4b6a2545da29279ee5c138b5f531067d802a is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/7d4611d9b3d14d94a37da1fce8494cd8...10e7ff5e4dae441ea25cff4add4096d3/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/8ef159c8011c41c8ade5b1c7be946449...0be9d7e3c3d14e16ad47f942b5a5941a/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/8481284679d04731ab18e4a95360c1b0...aac2c1901c974a06a274b4c165ce99fa/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-08T21:01:11.861+0000",
                    "updated": "2021-12-08T21:01:11.861+0000",
                    "started": "2021-12-08T21:01:11.861+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "692875",
                    "issueId": "13410900"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/worklog/693248",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #11892:\nURL: https://github.com/apache/arrow/pull/11892#discussion_r765803093\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (byte-order-marks) correctly\", {\n+  writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\n+\n+  expect_equal(\n+    open_dataset(csv_file, format = \"csv\") %>% collect(),\n+    tibble(a = 1, b = 2)\n+  )\n\nReview comment:\n       @wjones127 @jonkeane I think the additional tests are now failing. I got [this](https://github.com/apache/arrow/runs/4470780115?check_suite_focus=true) in a different PR. I haven't yet rebased so I don't even have those tests in my branch.\n\n##########\nFile path: r/tests/testthat/test-dataset-csv.R\n##########\n@@ -288,3 +289,12 @@ test_that(\"Column names inferred from schema for headerless CSVs (ARROW-14063)\",\n   ds <- open_dataset(headerless_csv_dir, format = \"csv\", schema = schema(int = int32(), dbl = float64()))\n   expect_equal(ds %>% collect(), tbl)\n })\n+\n+test_that(\"open_dataset() deals with BOMs (byte-order-marks) correctly\", {\n+  writeLines(\"\\xef\\xbb\\xbfa,b\\n1,2\\n\", con = csv_file)\n+\n+  expect_equal(\n+    open_dataset(csv_file, format = \"csv\") %>% collect(),\n+    tibble(a = 1, b = 2)\n+  )\n\nReview comment:\n       @wjones127 @jonkeane I think the additional tests are now failing. I got [this](https://github.com/apache/arrow/runs/4470780115?check_suite_focus=true) CI failure in a different PR. I haven't yet rebased so I don't even have those tests in my branch.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-09T13:47:21.941+0000",
                    "updated": "2021-12-09T13:47:21.941+0000",
                    "started": "2021-12-09T13:47:21.941+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "693248",
                    "issueId": "13410900"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 13800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1d20f68e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@66c484e1[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@64083f1a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@26a95cf6[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@598701f5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@16d828b5[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@330d359b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5f2f91e0[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e46bb59[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@690cb1a4[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33f7f0f3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1074c7fc[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13800,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Dec 08 20:48:15 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": [
            "C++"
        ],
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-12-08T20:48:15.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14644/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2021-11-09T17:41:15.000+0000",
        "updated": "2021-12-10T12:41:28.000+0000",
        "timeoriginalestimate": null,
        "description": "DragosMG: I believe this is a bug that should be fixed in the C++ code as there isn't an option we could leverage on the R side.\r\n\r\nI have draft PR with a failing test, but it's identical to Andy's _reproducible example_ below.\r\n\r\nOriginal description below:\r\n======================\r\nWhen a CSV file starts with byte order mark, {{arrow::open_dataset()}} reads the file but populates the first column with {{NA}} values. It appears a similar issue was raised and fixed here: https://issues.apache.org/jira/browse/ARROW-5413. {{read_csv_arrow()}} deals with the BOM correctly.\r\n\r\nReproducible Example:\r\n{code:java}\r\nlibrary(arrow)\r\nlibrary(dplyr)\r\n\r\nwriteLines('\\xef\\xbb\\xbfa,b\\n1,2\\n', con = \"testfile.csv\")\r\n\r\nread_csv_arrow(\"testfile.csv\") # works\r\n#> # A tibble: 1 \u00d7 2\r\n#> a b\r\n#> <int> <int>\r\n#> 1 1 2\r\n\r\nopen_dataset(\"testfile.csv\", format = \"csv\") |> \r\n\u00a0 collect()\r\n#> # A tibble: 1 \u00d7 2\r\n#> a b\r\n#> <int> <int>\r\n#> 1 NA 2 {code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] open_dataset doesn't ignore BOM in csv file",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "macOS Mojave, R 4.1.1",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/comment/17454307",
                    "id": "17454307",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "[~willjones127] Sorry for the assignment dance.  I hadn't realized you had assigned this as I had earmarked it this morning.  I did a bit of investigation.  I agree it is a C++ issue.  The following python reproduction runs into the same problem:\r\n\r\n{noformat}\r\nimport pyarrow.csv as csv\r\nimport pyarrow.dataset as ds\r\n\r\nwith open('/tmp/my_dataset/blah.csv', mode='wb') as f:\r\n    f.write(b'\\xef\\xbb\\xbfa,b\\n1,2\\n3,4\\n')\r\n\r\nprint(csv.read_csv('/tmp/my_dataset/blah.csv').to_pydict())\r\ndataset = ds.dataset('/tmp/my_dataset', format='csv')\r\nprint(dataset.to_table().to_pydict())\r\nprint(dataset.to_table())\r\n{noformat}\r\n\r\nI had thought that maybe it was a streaming / file reader issue but I tested both the streaming and file readers and they seem to be properly skipping the BOM.  Here are those tests if you want them: https://github.com/apache/arrow/compare/master...westonpace:experiment/ARROW-14644-investigation?expand=1\r\n\r\nHowever, that didn't seem to be the problem either.  So then I thought that maybe it was the fact that the datasets API will specify the schema when reading the data (instead of inferring it) but some initial testing there wasn't very fruitful either.\r\n\r\nSo I'll let you take this, I'm still not quite sure the root cause.  My guess would be that it is still some option getting passed when the reader is called from the datasets API but I don't know which one it would be.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-12-07T00:25:35.377+0000",
                    "updated": "2021-12-07T00:25:35.377+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410900/comment/17455985",
                    "id": "17455985",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 11892\n[https://github.com/apache/arrow/pull/11892]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-08T20:48:15.578+0000",
                    "updated": "2021-12-08T20:48:15.578+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0wl2o:",
        "customfield_12314139": null
    }
}