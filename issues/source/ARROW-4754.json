{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13219208",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208",
    "key": "ARROW-4754",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343937",
                "id": "12343937",
                "description": "",
                "name": "0.13.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-04-01"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/1",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/blocker.svg",
            "name": "Blocker",
            "id": "1"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333244",
                "id": "12333244",
                "name": "Continuous Integration"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12334621",
                "id": "12334621",
                "name": "FlightRPC"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328933",
                "id": "12328933",
                "name": "Java"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4754/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 14,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207011",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801\n \n \n   Also, random cleanups to make intellij happy.\r\n   \r\n   Should prevent reoccurences of  recent master build failure: https://travis-ci.org/apache/arrow/jobs/501310887\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T05:47:46.299+0000",
                    "updated": "2019-03-04T05:47:46.299+0000",
                    "started": "2019-03-04T05:47:46.298+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207011",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207013",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469132163\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=h1) Report\n   > Merging [#3801](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/c80e6859eb4d9498d6bb5c74da656801a228fb62?src=pr&el=desc) will **increase** coverage by `0.81%`.\n   > The diff coverage is `n/a`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3801/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff            @@\n   ##           master   #3801      +/-   ##\n   =========================================\n   + Coverage   87.79%   88.6%   +0.81%     \n   =========================================\n     Files         708     576     -132     \n     Lines       86591   77123    -9468     \n     Branches     1233       0    -1233     \n   =========================================\n   - Hits        76019   68338    -7681     \n   + Misses      10459    8785    -1674     \n   + Partials      113       0     -113\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/csv/column-builder.cc](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvY29sdW1uLWJ1aWxkZXIuY2M=) | `95.39% <0%> (-1.98%)` | :arrow_down: |\n   | [cpp/src/arrow/util/bpacking.h](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2JwYWNraW5nLmg=) | `99.84% <0%> (-0.01%)` | :arrow_down: |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [js/src/enum.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL2VudW0udHM=) | | |\n   | [go/arrow/array/builder.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvYnVpbGRlci5nbw==) | | |\n   | [js/src/Arrow.node.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL0Fycm93Lm5vZGUudHM=) | | |\n   | [js/src/schema.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL3NjaGVtYS50cw==) | | |\n   | [go/arrow/type\\_traits\\_boolean.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvdHlwZV90cmFpdHNfYm9vbGVhbi5nbw==) | | |\n   | [js/src/ipc/node/writer.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL2lwYy9ub2RlL3dyaXRlci50cw==) | | |\n   | ... and [124 more](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=footer). Last update [c80e685...9e455f7](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T06:18:02.748+0000",
                    "updated": "2019-03-04T06:18:02.748+0000",
                    "started": "2019-03-04T06:18:02.747+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207013",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207019",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r261937154\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   do we need to start the server for each test? can we do it once for the class and create new clients for each test?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T06:46:55.087+0000",
                    "updated": "2019-03-04T06:46:55.087+0000",
                    "started": "2019-03-04T06:46:55.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207019",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207027",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r261944529\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   In general I would prefer not to do that as long as server start is quick (which I think it should be).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T07:29:33.181+0000",
                    "updated": "2019-03-04T07:29:33.181+0000",
                    "started": "2019-03-04T07:29:33.180+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207027",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207028",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469146677\n \n \n     I pushed the fix for JIRA-4755 to this PR as well (sorry if this is a randomization).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T07:29:38.760+0000",
                    "updated": "2019-03-04T07:29:38.760+0000",
                    "started": "2019-03-04T07:29:38.759+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207028",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207038",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469132163\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=h1) Report\n   > Merging [#3801](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/c80e6859eb4d9498d6bb5c74da656801a228fb62?src=pr&el=desc) will **increase** coverage by `0.82%`.\n   > The diff coverage is `n/a`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3801/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3801      +/-   ##\n   ==========================================\n   + Coverage   87.79%   88.61%   +0.82%     \n   ==========================================\n     Files         708      576     -132     \n     Lines       86591    77125    -9466     \n     Branches     1233        0    -1233     \n   ==========================================\n   - Hits        76019    68343    -7676     \n   + Misses      10459     8782    -1677     \n   + Partials      113        0     -113\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [js/src/enum.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL2VudW0udHM=) | | |\n   | [go/arrow/array/builder.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvYnVpbGRlci5nbw==) | | |\n   | [js/src/Arrow.node.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL0Fycm93Lm5vZGUudHM=) | | |\n   | [js/src/schema.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL3NjaGVtYS50cw==) | | |\n   | [go/arrow/type\\_traits\\_boolean.go](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-Z28vYXJyb3cvdHlwZV90cmFpdHNfYm9vbGVhbi5nbw==) | | |\n   | [js/src/ipc/node/writer.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL2lwYy9ub2RlL3dyaXRlci50cw==) | | |\n   | [js/src/visitor/vectorloader.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL3Zpc2l0b3IvdmVjdG9ybG9hZGVyLnRz) | | |\n   | [js/src/visitor.ts](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree#diff-anMvc3JjL3Zpc2l0b3IudHM=) | | |\n   | ... and [122 more](https://codecov.io/gh/apache/arrow/pull/3801/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=footer). Last update [c80e685...393338d](https://codecov.io/gh/apache/arrow/pull/3801?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T08:01:09.514+0000",
                    "updated": "2019-03-04T08:01:09.514+0000",
                    "started": "2019-03-04T08:01:09.513+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207038",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207039",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r261951794\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   hmm ok..would that not be the actual real world scenario though? (should we have another test for that else?)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-04T08:03:00.971+0000",
                    "updated": "2019-03-04T08:03:00.971+0000",
                    "started": "2019-03-04T08:03:00.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207039",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207567",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469509157\n \n \n   @praveenbingo any more comments on this?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T02:23:41.496+0000",
                    "updated": "2019-03-05T02:23:41.496+0000",
                    "started": "2019-03-05T02:23:41.495+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207567",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207592",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r262338421\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   Yes, I think another test would be better for that.  I haven't been involved in flight development but I'll leave up to the community members that have to open a JIRA if one already isn't open for more integration testing like scenarios.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T03:48:35.859+0000",
                    "updated": "2019-03-05T03:48:35.859+0000",
                    "started": "2019-03-05T03:48:35.858+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207592",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r262348681\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   Ok i am not sure i agree :) but either ways the test is in much better shape than it was..we can refactor more later. \r\n   \r\n   Thanks again !\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T05:06:22.901+0000",
                    "updated": "2019-03-05T05:06:22.901+0000",
                    "started": "2019-03-05T05:06:22.900+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207616",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207618",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469539466\n \n \n   @wesm No, please help in merging this.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T05:06:38.792+0000",
                    "updated": "2019-03-05T05:06:38.792+0000",
                    "started": "2019-03-05T05:06:38.791+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207618",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207619",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#discussion_r262348681\n \n \n\n ##########\n File path: java/flight/src/test/java/org/apache/arrow/flight/auth/TestAuth.java\n ##########\n @@ -94,22 +95,38 @@ public boolean isValid(byte[] token) {\n       }\n     };\n \n-    server = new FlightServer(\n-        allocator,\n-        l.getPort(),\n-        new NoOpFlightProducer() {\n-          @Override\n-          public void listFlights(Criteria criteria, StreamListener<FlightInfo> listener) {\n-            listener.onCompleted();\n-          }\n-        },\n-        new BasicServerAuthHandler(validator));\n-\n-    server.start();\n-    client = new FlightClient(allocator, l);\n-  }\n-\n+    // choose a port from the random/private range (https://en.wikipedia.org/wiki/Registered_port)\n+    // we see flakiness when we use the same port each time.\n+    Location location = null;\n+    IOException lastThrown = null;\n+    Random random = new Random();\n+    for (int x = 0; x < 3; x++) {\n+      final int port = 49152 + random.nextInt(5000);\n+      location = new Location(\"localhost\", port);\n+      lastThrown = null;\n+      try {\n+        server = new FlightServer(\n \n Review comment:\n   Ok i am not sure i agree :) but either ways the test is now in much better shape than it was..we can refactor more later. \r\n   \r\n   Thanks again !\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T05:07:18.782+0000",
                    "updated": "2019-03-05T05:07:18.782+0000",
                    "started": "2019-03-05T05:07:18.781+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207619",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207634",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "praveenbingo commented on issue #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801#issuecomment-469548484\n \n \n   @pravindra - please help merge..\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T05:52:16.559+0000",
                    "updated": "2019-03-05T05:52:16.559+0000",
                    "started": "2019-03-05T05:52:16.558+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207634",
                    "issueId": "13219208"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/worklog/207638",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on pull request #3801: ARROW-4754: [Java] Randomize port and retry binding server when bind fails\nURL: https://github.com/apache/arrow/pull/3801\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-05T06:06:20.578+0000",
                    "updated": "2019-03-05T06:06:20.578+0000",
                    "started": "2019-03-05T06:06:20.578+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "207638",
                    "issueId": "13219208"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 8400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4caefa3[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5ceefafa[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@183702e7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@33251231[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4f406b31[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1e1cec13[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e9ce50d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2533cc75[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@69663201[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1063374a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@490e0cc6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@72e521f6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 8400,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 05 06:06:17 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-03-05T06:06:17.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4754/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-03-04T05:34:45.000+0000",
        "updated": "2019-03-05T06:06:20.000+0000",
        "timeoriginalestimate": null,
        "description": "org.apache.arrow.flight.auth.TestAuth\r\n[ERROR] invalidAuth(org.apache.arrow.flight.auth.TestAuth) Time elapsed: 0.013 s <<< ERROR!\r\njava.io.IOException: Failed to bind\r\n at org.apache.arrow.flight.auth.TestAuth.setup(TestAuth.java:108)\r\nCaused by: java.net.BindException: Address already in use",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 8400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[CI][Java] Flaky TestAuth Flight test",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13219208/comment/16784129",
                    "id": "16784129",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pravindra",
                        "name": "pravindra",
                        "key": "pravindra",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Pindikura Ravindra",
                        "active": true,
                        "timeZone": "Asia/Kolkata"
                    },
                    "body": "Issue resolved by pull request 3801\n[https://github.com/apache/arrow/pull/3801]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pravindra",
                        "name": "pravindra",
                        "key": "pravindra",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Pindikura Ravindra",
                        "active": true,
                        "timeZone": "Asia/Kolkata"
                    },
                    "created": "2019-03-05T06:06:17.490+0000",
                    "updated": "2019-03-05T06:06:17.490+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z00abs:",
        "customfield_12314139": null
    }
}