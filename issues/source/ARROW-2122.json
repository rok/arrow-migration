{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13137366",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366",
    "key": "ARROW-2122",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
            "name": "adshieh",
            "key": "adshieh",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Albert Shieh",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
            "name": "robertnishihara",
            "key": "robertnishihara",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robert Nishihara",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
            "name": "robertnishihara",
            "key": "robertnishihara",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robert Nishihara",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2122/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2b9d3dd1[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@48af0c27[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@245694a9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@14a87a30[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@36ceb0ea[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6a8567f4[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a6655d1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2dc8c957[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6e4265e4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2f39051f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@673915f4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@cd0fa35[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Apr 03 04:39:44 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-04-03T04:39:44.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2122/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2018-02-09T07:51:43.000+0000",
        "updated": "2018-04-03T04:39:44.000+0000",
        "timeoriginalestimate": null,
        "description": "The bug can be\u00a0reproduced as follows.\r\n{code:java}\r\nimport pyarrow as pa\r\nimport pandas as pd\r\n\r\ndf = pd.DataFrame({'A': [pd.Timestamp('2012-11-11 00:00:00+01:00'), pd.NaT]}) \r\n\r\ns = pa.serialize(df).to_buffer()\r\nnew_df = pa.deserialize(s) # this fails{code}\r\nThe last line fails with\r\n{code:java}\r\nTraceback (most recent call last):\r\n\u00a0 File \"<stdin>\", line 1, in <module>\r\n\u00a0 File \"serialization.pxi\", line 441, in pyarrow.lib.deserialize\r\n\u00a0 File \"serialization.pxi\", line 404, in pyarrow.lib.deserialize_from\r\n\u00a0 File \"serialization.pxi\", line 257, in pyarrow.lib.SerializedPyObject.deserialize\r\n\u00a0 File \"serialization.pxi\", line 174, in pyarrow.lib.SerializationContext._deserialize_callback\r\n\u00a0 File \"/home/ubuntu/arrow/python/pyarrow/serialization.py\", line 77, in _deserialize_pandas_dataframe\r\n\u00a0 \u00a0 return pdcompat.serialized_dict_to_dataframe(data)\r\n\u00a0 File \"/home/ubuntu/arrow/python/pyarrow/pandas_compat.py\", line 446, in serialized_dict_to_dataframe\r\n\u00a0 \u00a0 for block in data['blocks']]\r\n\u00a0 File \"/home/ubuntu/arrow/python/pyarrow/pandas_compat.py\", line 446, in <listcomp>\r\n\u00a0 \u00a0 for block in data['blocks']]\r\n\u00a0 File \"/home/ubuntu/arrow/python/pyarrow/pandas_compat.py\", line 466, in _reconstruct_block\r\n\u00a0 \u00a0 dtype = _make_datetimetz(item['timezone'])\r\n\u00a0 File \"/home/ubuntu/arrow/python/pyarrow/pandas_compat.py\", line 481, in _make_datetimetz\r\n\u00a0 \u00a0 return DatetimeTZDtype('ns', tz=tz)\r\n\u00a0 File \"/home/ubuntu/anaconda3/lib/python3.5/site-packages/pandas/core/dtypes/dtypes.py\", line 409, in __new__\r\n\u00a0 \u00a0 raise ValueError(\"DatetimeTZDtype constructor must have a tz \"\r\nValueError: DatetimeTZDtype constructor must have a tz supplied{code}\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Pyarrow fails to serialize dataframe with timestamp.",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16386217",
                    "id": "16386217",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
                        "name": "adshieh",
                        "key": "adshieh",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Albert Shieh",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "The issue is that the timestamp has a pytz.FixedOffset timezone, which has a zone attribute of None where arrow expects a string.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
                        "name": "adshieh",
                        "key": "adshieh",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Albert Shieh",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-03-05T15:35:27.113+0000",
                    "updated": "2018-03-05T15:35:27.113+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16386274",
                    "id": "16386274",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Ah, sounds like we need a convention to handle FixedOffset in Arrow so that things can be properly coerced going in and out of Python",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-03-05T16:04:54.416+0000",
                    "updated": "2018-03-05T16:04:54.416+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16386615",
                    "id": "16386615",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
                        "name": "adshieh",
                        "key": "adshieh",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Albert Shieh",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "How about \r\n{code}\r\n'+{:d}'.format(tz._minutes)\r\n{code}\r\nor some other prefix?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=adshieh",
                        "name": "adshieh",
                        "key": "adshieh",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Albert Shieh",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-03-05T19:31:04.271+0000",
                    "updated": "2018-03-05T19:31:54.688+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16387039",
                    "id": "16387039",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh opened a new pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707\n \n \n   Fixes [ARROW-2122](https://issues.apache.org/jira/browse/ARROW-2122).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-06T00:30:29.303+0000",
                    "updated": "2018-03-06T00:30:29.303+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16387042",
                    "id": "16387042",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r172375593\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +847,25 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+FIXED_OFFSET_PREFIX = '+'\n \n Review comment:\n   @wesm suggestions?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-06T00:31:14.110+0000",
                    "updated": "2018-03-06T00:31:14.110+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16396530",
                    "id": "16396530",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#issuecomment-372543159\n \n \n   This needs a little more scrutiny (cc @jreback @cpcloud @pitrou) before we commit to something for 0.9.0 we might have to break later. I'm going to move this issue off 0.9.0 so we aren't blocking\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-13T04:26:43.934+0000",
                    "updated": "2018-03-13T04:26:43.934+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16396844",
                    "id": "16396844",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r174097132\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +847,25 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+FIXED_OFFSET_PREFIX = '+'\n \n Review comment:\n   We probably want the offset to be encoded as `[+-]HH:MM`.\r\n   See https://github.com/apache/arrow/blob/master/format/Schema.fbs#L162-L166\r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-13T11:34:14.706+0000",
                    "updated": "2018-03-13T11:34:14.706+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16396845",
                    "id": "16396845",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r174097194\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +847,25 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+FIXED_OFFSET_PREFIX = '+'\n+\n+\n+def tzinfo_to_string(tz):\n \n Review comment:\n   These two functions would deserve a docstring, and appropriate unit tests.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-13T11:34:32.982+0000",
                    "updated": "2018-03-13T11:34:32.982+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16396847",
                    "id": "16396847",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r174097652\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -1001,6 +1001,17 @@ def test_array_from_pandas_date_with_mask(self):\n         assert pa.Array.from_pandas(expected).equals(result)\n \n \n+def test_fixed_offset_timezone():\n \n Review comment:\n   Please put this under the class above.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-03-13T11:36:35.560+0000",
                    "updated": "2018-03-13T11:36:35.560+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16421774",
                    "id": "16421774",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r178466964\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +847,25 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+FIXED_OFFSET_PREFIX = '+'\n \n Review comment:\n   Done!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-01T19:32:22.264+0000",
                    "updated": "2018-04-01T19:32:22.264+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16421775",
                    "id": "16421775",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r178466966\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +847,25 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+FIXED_OFFSET_PREFIX = '+'\n+\n+\n+def tzinfo_to_string(tz):\n \n Review comment:\n   Done!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-01T19:32:24.857+0000",
                    "updated": "2018-04-01T19:32:24.857+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16421776",
                    "id": "16421776",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r178466968\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_pandas.py\n ##########\n @@ -1001,6 +1001,17 @@ def test_array_from_pandas_date_with_mask(self):\n         assert pa.Array.from_pandas(expected).equals(result)\n \n \n+def test_fixed_offset_timezone():\n \n Review comment:\n   Done!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-01T19:32:31.103+0000",
                    "updated": "2018-04-01T19:32:31.103+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16422080",
                    "id": "16422080",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r178472077\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +849,63 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+_FIXED_OFFSET_RE = re.compile(r'([+-])(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])')\n \n Review comment:\n   I *think* this needs a `$` at the end to avoid ignoring any trailing text.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-02T09:58:46.895+0000",
                    "updated": "2018-04-02T09:58:46.895+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16422475",
                    "id": "16422475",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "adshieh commented on a change in pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707#discussion_r178545777\n \n \n\n ##########\n File path: python/pyarrow/types.pxi\n ##########\n @@ -847,6 +849,63 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+_FIXED_OFFSET_RE = re.compile(r'([+-])(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])')\n \n Review comment:\n   Good catch, thanks!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-02T13:42:45.808+0000",
                    "updated": "2018-04-02T13:42:45.808+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16423461",
                    "id": "16423461",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy closed pull request #1707: ARROW-2122: [Python] Pyarrow fails to serialize dataframe with timestamp.\nURL: https://github.com/apache/arrow/pull/1707\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/pyarrow/pandas_compat.py b/python/pyarrow/pandas_compat.py\nindex 0bc47fc0d..fad943cce 100644\n--- a/python/pyarrow/pandas_compat.py\n+++ b/python/pyarrow/pandas_compat.py\n@@ -128,7 +128,7 @@ def get_extension_dtype_info(column):\n         }\n         physical_dtype = str(cats.codes.dtype)\n     elif hasattr(dtype, 'tz'):\n-        metadata = {'timezone': str(dtype.tz)}\n+        metadata = {'timezone': pa.lib.tzinfo_to_string(dtype.tz)}\n         physical_dtype = 'datetime64[ns]'\n     else:\n         metadata = None\n@@ -418,7 +418,7 @@ def dataframe_to_serialized_dict(frame):\n         block_data = {}\n \n         if isinstance(block, _int.DatetimeTZBlock):\n-            block_data['timezone'] = values.tz.zone\n+            block_data['timezone'] = pa.lib.tzinfo_to_string(values.tz)\n             values = values.values\n         elif isinstance(block, _int.CategoricalBlock):\n             block_data.update(dictionary=values.categories,\n@@ -482,6 +482,7 @@ def _reconstruct_block(item):\n \n def _make_datetimetz(tz):\n     from pyarrow.compat import DatetimeTZDtype\n+    tz = pa.lib.string_to_tzinfo(tz)\n     return DatetimeTZDtype('ns', tz=tz)\n \n \ndiff --git a/python/pyarrow/scalar.pxi b/python/pyarrow/scalar.pxi\nindex a801acd69..64d44a967 100644\n--- a/python/pyarrow/scalar.pxi\n+++ b/python/pyarrow/scalar.pxi\n@@ -235,8 +235,7 @@ cdef class TimestampValue(ArrayValue):\n         value = self.value\n \n         if not dtype.timezone().empty():\n-            import pytz\n-            tzinfo = pytz.timezone(frombytes(dtype.timezone()))\n+            tzinfo = string_to_tzinfo(frombytes(dtype.timezone()))\n         else:\n             tzinfo = None\n \ndiff --git a/python/pyarrow/table.pxi b/python/pyarrow/table.pxi\nindex c27c0edd9..de7ddefc5 100644\n--- a/python/pyarrow/table.pxi\n+++ b/python/pyarrow/table.pxi\n@@ -300,9 +300,11 @@ cdef class Column:\n         result = pd.Series(values, name=self.name)\n \n         if isinstance(self.type, TimestampType):\n-            if self.type.tz is not None:\n+            tz = self.type.tz\n+            if tz is not None:\n+                tz = string_to_tzinfo(tz)\n                 result = (result.dt.tz_localize('utc')\n-                          .dt.tz_convert(self.type.tz))\n+                          .dt.tz_convert(tz))\n \n         return result\n \ndiff --git a/python/pyarrow/tests/test_convert_builtin.py b/python/pyarrow/tests/test_convert_builtin.py\nindex 19b59a49b..988d512a8 100644\n--- a/python/pyarrow/tests/test_convert_builtin.py\n+++ b/python/pyarrow/tests/test_convert_builtin.py\n@@ -26,6 +26,7 @@\n import itertools\n import numpy as np\n import six\n+import pytz\n \n \n int_type_pairs = [\n@@ -649,3 +650,14 @@ def test_decimal_array_with_none_and_nan():\n \n     array = pa.array(values, type=pa.decimal128(10, 4))\n     assert array.to_pylist() == [decimal.Decimal('1.2340'), None, None, None]\n+\n+\n+@pytest.mark.parametrize('tz,name', [\n+    (pytz.FixedOffset(90), '+01:30'),\n+    (pytz.FixedOffset(-90), '-01:30'),\n+    (pytz.utc, 'UTC'),\n+    (pytz.timezone('America/New_York'), 'America/New_York')\n+])\n+def test_timezone_string(tz, name):\n+    assert pa.lib.tzinfo_to_string(tz) == name\n+    assert pa.lib.string_to_tzinfo(name) == tz\ndiff --git a/python/pyarrow/tests/test_convert_pandas.py b/python/pyarrow/tests/test_convert_pandas.py\nindex 5abc026bf..f90d805be 100644\n--- a/python/pyarrow/tests/test_convert_pandas.py\n+++ b/python/pyarrow/tests/test_convert_pandas.py\n@@ -1000,6 +1000,16 @@ def test_array_from_pandas_date_with_mask(self):\n         expected = pd.Series([None, date(1991, 1, 1), None])\n         assert pa.Array.from_pandas(expected).equals(result)\n \n+    def test_fixed_offset_timezone(self):\n+        df = pd.DataFrame({\n+            'a': [\n+                pd.Timestamp('2012-11-11 00:00:00+01:00'),\n+                pd.NaT\n+                ]\n+             })\n+        _check_pandas_roundtrip(df)\n+        _check_serialize_components_roundtrip(df)\n+\n \n class TestConvertStringLikeTypes(object):\n     \"\"\"\ndiff --git a/python/pyarrow/types.pxi b/python/pyarrow/types.pxi\nindex 5f962901c..1ff42d70f 100644\n--- a/python/pyarrow/types.pxi\n+++ b/python/pyarrow/types.pxi\n@@ -15,6 +15,8 @@\n # specific language governing permissions and limitations\n # under the License.\n \n+import re\n+\n # These are imprecise because the type (in pandas 0.x) depends on the presence\n # of nulls\n cdef dict _pandas_type_map = {\n@@ -847,6 +849,63 @@ cdef timeunit_to_string(TimeUnit unit):\n         return 'ns'\n \n \n+_FIXED_OFFSET_RE = re.compile(r'([+-])(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$')\n+\n+\n+def tzinfo_to_string(tz):\n+    \"\"\"\n+    Converts a time zone object into a string indicating the name of a time\n+    zone, one of:\n+    * As used in the Olson time zone database (the \"tz database\" or\n+      \"tzdata\"), such as \"America/New_York\"\n+    * An absolute time zone offset of the form +XX:XX or -XX:XX, such as +07:30\n+\n+    Parameters\n+    ----------\n+      tz : datetime.tzinfo\n+        Time zone object\n+\n+    Returns\n+    -------\n+      name : string\n+        Time zone name\n+    \"\"\"\n+    if tz.zone is None:\n+        sign = '+' if tz._minutes >= 0 else '-'\n+        hours, minutes = divmod(abs(tz._minutes), 60)\n+        return '{}{:02d}:{:02d}'.format(sign, hours, minutes)\n+    else:\n+        return tz.zone\n+\n+\n+def string_to_tzinfo(name):\n+    \"\"\"\n+    Converts a string indicating the name of a time zone into a time zone\n+    object, one of:\n+    * As used in the Olson time zone database (the \"tz database\" or\n+      \"tzdata\"), such as \"America/New_York\"\n+    * An absolute time zone offset of the form +XX:XX or -XX:XX, such as +07:30\n+\n+    Parameters\n+    ----------\n+      name: string\n+        Time zone name\n+\n+    Returns\n+    -------\n+      tz : datetime.tzinfo\n+        Time zone object\n+    \"\"\"\n+    import pytz\n+    m = _FIXED_OFFSET_RE.match(name)\n+    if m:\n+        sign = 1 if m.group(1) == '+' else -1\n+        hours, minutes = map(int, m.group(2, 3))\n+        return pytz.FixedOffset(sign * (hours * 60 + minutes))\n+    else:\n+        return pytz.timezone(name)\n+\n+\n def timestamp(unit, tz=None):\n     \"\"\"\n     Create instance of timestamp type with resolution and optional time zone\n@@ -894,7 +953,7 @@ def timestamp(unit, tz=None):\n         _timestamp_type_cache[unit_code] = out\n     else:\n         if not isinstance(tz, six.string_types):\n-            tz = tz.zone\n+            tz = tzinfo_to_string(tz)\n \n         c_timezone = tobytes(tz)\n         out.init(ctimestamp(unit_code, c_timezone))\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-03T04:39:36.876+0000",
                    "updated": "2018-04-03T04:39:36.876+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137366/comment/16423462",
                    "id": "16423462",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 1707\n[https://github.com/apache/arrow/pull/1707]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2018-04-03T04:39:44.358+0000",
                    "updated": "2018-04-03T04:39:44.358+0000"
                }
            ],
            "maxResults": 16,
            "total": 16,
            "startAt": 0
        },
        "customfield_12311820": "0|i3pzin:",
        "customfield_12314139": null
    }
}