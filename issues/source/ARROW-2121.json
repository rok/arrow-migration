{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13137344",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344",
    "key": "ARROW-2121",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
            "name": "robertnishihara",
            "key": "robertnishihara",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robert Nishihara",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
            "name": "robertnishihara",
            "key": "robertnishihara",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robert Nishihara",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
            "name": "robertnishihara",
            "key": "robertnishihara",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robert Nishihara",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2121/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3d73834a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@79a25303[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1cded60f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@778fb4dc[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@57419000[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@59800e17[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3384c586[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3927be7e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@623df8ca[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3b94b22c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2e29e82d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2a7977d8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Feb 20 01:55:29 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-02-20T01:55:26.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2121/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-02-09T05:41:13.000+0000",
        "updated": "2018-02-21T20:29:13.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Consider special casing object arrays in pandas serializers.",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16357951",
                    "id": "16357951",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara opened a new pull request #1581: [WIP] ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581\n \n \n   The goal here is to get the best of both the `pandas_serialization_context` (speed at serializing pandas dataframes containing strings and other objects) and the `default_serialization_context` (correctly serializing a large class of numpy object arrays).\r\n   \r\n   This PR sort of messes up the function `pa.pandas_compat.dataframe_to_serialized_dict`. Is that function just a helper function for implementing the custom pandas serializers? Or is it intended to be used in other places.\r\n   \r\n   TODO in this PR (assuming you think this approach is reasonable):\r\n   \r\n   - [ ] remove `pandas_serialization_context`\r\n   - [ ] make sure this code path is tested\r\n   - [ ] double check that performance is good\r\n   \r\n   cc @wesm @pcmoritz @devin-petersohn \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T05:46:28.107+0000",
                    "updated": "2018-02-09T05:46:28.107+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16357967",
                    "id": "16357967",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1581: [WIP] ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-364344672\n \n \n   Well, we need to preserve the zero-copy pandas reads. Now that our ASV benchmarking setup has been rehabilitated we should be able to do that in this patch to verify performance\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T06:10:26.390+0000",
                    "updated": "2018-02-09T06:10:26.390+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16357976",
                    "id": "16357976",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1581: [WIP] ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#discussion_r167148817\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -421,11 +421,16 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead.\n+        if isinstance(block, _int.ObjectBlock):\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(values)\n \n Review comment:\n   Should we be using `_pickle_to_buffer` here? Does that make a difference?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T06:26:44.523+0000",
                    "updated": "2018-02-09T06:26:44.523+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16358037",
                    "id": "16358037",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#discussion_r167148817\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -421,11 +421,16 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead.\n+        if isinstance(block, _int.ObjectBlock):\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(values)\n \n Review comment:\n   Should we be using `_pickle_to_buffer` here? Does that make a difference?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T07:34:07.153+0000",
                    "updated": "2018-02-09T07:34:07.153+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16358038",
                    "id": "16358038",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#discussion_r167156435\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -421,11 +421,18 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead. Note that\n+        # we do not use isinstance here because _int.CategoricalBlock is a\n+        # subclass of _int.ObjectBlock.\n+        if type(block) == _int.ObjectBlock:\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(values)\n \n Review comment:\n   Should we be using `_pickle_to_buffer` here? Does that make a difference?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T07:34:14.708+0000",
                    "updated": "2018-02-09T07:34:14.708+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16358990",
                    "id": "16358990",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-364573786\n \n \n   Some performance numbers. The numbers are somewhat variable if you run the benchmarks multiple times.\r\n   \r\n   ```python\r\n   import pyarrow as pa\r\n   import pandas as pd\r\n   df = pd.DataFrame(data={str(i): [i, str(i)] for i in range(10 ** 6)})\r\n   ```\r\n   \r\n   Before this PR\r\n   \r\n   ```python\r\n   context = pa.pandas_serialization_context()\r\n   \r\n   %time s = pa.serialize(df, context=context).to_buffer()  # 570ms\r\n   %time d = pa.deserialize(s, context=context)  # 485ms\r\n   \r\n   %timeit s = pa.serialize(df, context=context).to_buffer()  # 482ms\r\n   %timeit d = pa.deserialize(s, context=context)  # 376ms\r\n   ```\r\n   \r\n   After this PR\r\n   \r\n   ```python\r\n   %time s = pa.serialize(df).to_buffer()  # 577ms\r\n   %time d = pa.deserialize(s)  # 672ms\r\n   \r\n   %timeit s = pa.serialize(df).to_buffer()  # 467ms\r\n   %timeit d = pa.deserialize(s)  # 349ms\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T21:30:03.107+0000",
                    "updated": "2018-02-09T21:30:03.107+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16358991",
                    "id": "16358991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#discussion_r167156435\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -421,11 +421,18 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead. Note that\n+        # we do not use isinstance here because _int.CategoricalBlock is a\n+        # subclass of _int.ObjectBlock.\n+        if type(block) == _int.ObjectBlock:\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(values)\n \n Review comment:\n   Should we be using `_pickle_to_buffer` here? Does that make a difference?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T21:30:23.612+0000",
                    "updated": "2018-02-09T21:30:23.612+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16358992",
                    "id": "16358992",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#discussion_r167350906\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -421,11 +421,19 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead. Note that\n+        # we do not use isinstance here because _int.CategoricalBlock is a\n+        # subclass of _int.ObjectBlock.\n+        if type(block) == _int.ObjectBlock:\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(\n+                values, protocol=builtin_pickle.HIGHEST_PROTOCOL)\n \n Review comment:\n   Should we be using `_pickle_to_buffer` here? Does that make a difference?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T21:30:30.539+0000",
                    "updated": "2018-02-09T21:30:30.539+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16359080",
                    "id": "16359080",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-364595801\n \n \n   Let's not merge this just yet, I'd like to brainstorm other approaches a little.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T23:10:14.675+0000",
                    "updated": "2018-02-09T23:10:14.675+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16359097",
                    "id": "16359097",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-364599769\n \n \n   Ok, I'm pretty happy with this now. @wesm @pcmoritz let me know if you have any comments.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-09T23:34:09.096+0000",
                    "updated": "2018-02-09T23:34:09.096+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16360836",
                    "id": "16360836",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-364946568\n \n \n   Yep, I have this on deck to look at today\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-12T14:56:21.821+0000",
                    "updated": "2018-02-12T14:56:21.821+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369590",
                    "id": "16369590",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-366821860\n \n \n   Sorry for the delay, looking now, and may as well add a benchmark for zero-copy DataFrame while I'm at it\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-19T22:55:48.168+0000",
                    "updated": "2018-02-19T22:55:48.168+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369606",
                    "id": "16369606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-366831288\n \n \n   @robertnishihara would you mind enabling appveyor on your fork when you have a chance? \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-20T00:07:39.361+0000",
                    "updated": "2018-02-20T00:07:39.361+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369616",
                    "id": "16369616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-366835235\n \n \n   Thanks @wesm I *think* I've enabled it now.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-20T00:38:53.166+0000",
                    "updated": "2018-02-20T00:38:53.166+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369638",
                    "id": "16369638",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581#issuecomment-366845422\n \n \n   Merging this, since the last Appveyor build had passed\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-20T01:55:07.990+0000",
                    "updated": "2018-02-20T01:55:07.990+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369639",
                    "id": "16369639",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1581\n[https://github.com/apache/arrow/pull/1581]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-02-20T01:55:26.923+0000",
                    "updated": "2018-02-20T01:55:26.923+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13137344/comment/16369640",
                    "id": "16369640",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1581: ARROW-2121: [Python] Handle object arrays directly in pandas serializer.\nURL: https://github.com/apache/arrow/pull/1581\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/README-benchmarks.md b/python/README-benchmarks.md\nindex 3fecb35cb..60fa88f4a 100644\n--- a/python/README-benchmarks.md\n+++ b/python/README-benchmarks.md\n@@ -41,8 +41,6 @@ First you have to install ASV's development version:\n pip install git+https://github.com/airspeed-velocity/asv.git\n ```\n \n-<!--- TODO remove the above once https://github.com/airspeed-velocity/asv/pull/611 is merged -->\n-\n Then you need to set up a few environment variables:\n \n ```shell\ndiff --git a/python/benchmarks/convert_pandas.py b/python/benchmarks/convert_pandas.py\nindex c4a7a59cb..244b3dcc8 100644\n--- a/python/benchmarks/convert_pandas.py\n+++ b/python/benchmarks/convert_pandas.py\n@@ -48,3 +48,23 @@ def setup(self, n, dtype):\n \n     def time_to_series(self, n, dtype):\n         self.arrow_data.to_pandas()\n+\n+\n+class ZeroCopyPandasRead(object):\n+\n+    def setup(self):\n+        # Transpose to make column-major\n+        values = np.random.randn(10, 100000)\n+\n+        df = pd.DataFrame(values.T)\n+        ctx = pa.default_serialization_context()\n+\n+        self.serialized = ctx.serialize(df)\n+        self.as_buffer = self.serialized.to_buffer()\n+        self.as_components = self.serialized.to_components()\n+\n+    def time_deserialize_from_buffer(self):\n+        pa.deserialize(self.as_buffer)\n+\n+    def time_deserialize_from_components(self):\n+        pa.deserialize_components(self.as_components)\ndiff --git a/python/doc/source/ipc.rst b/python/doc/source/ipc.rst\nindex 9bf93ffe8..bce8b1ed1 100644\n--- a/python/doc/source/ipc.rst\n+++ b/python/doc/source/ipc.rst\n@@ -317,9 +317,8 @@ An object can be reconstructed from its component-based representation using\n Serializing pandas Objects\n --------------------------\n \n-We provide a serialization context that has optimized handling of pandas\n-objects like ``DataFrame`` and ``Series``. This can be created with\n-``pyarrow.pandas_serialization_context()``. Combined with component-based\n+The default serialization context has optimized handling of pandas\n+objects like ``DataFrame`` and ``Series``. Combined with component-based\n serialization above, this enables zero-copy transport of pandas DataFrame\n objects not containing any Python objects:\n \n@@ -327,7 +326,7 @@ objects not containing any Python objects:\n \n    import pandas as pd\n    df = pd.DataFrame({'a': [1, 2, 3, 4, 5]})\n-   context = pa.pandas_serialization_context()\n+   context = pa.default_serialization_context()\n    serialized_df = context.serialize(df)\n    df_components = serialized_df.to_components()\n    original_df = context.deserialize_components(df_components)\ndiff --git a/python/pyarrow/__init__.py b/python/pyarrow/__init__.py\nindex d95954ed3..15a37ca10 100644\n--- a/python/pyarrow/__init__.py\n+++ b/python/pyarrow/__init__.py\n@@ -125,7 +125,6 @@\n localfs = LocalFileSystem.get_instance()\n \n from pyarrow.serialization import (default_serialization_context,\n-                                   pandas_serialization_context,\n                                    register_default_serialization_handlers,\n                                    register_torch_serialization_handlers)\n \ndiff --git a/python/pyarrow/pandas_compat.py b/python/pyarrow/pandas_compat.py\nindex e8fa83fe7..6d4bf5e78 100644\n--- a/python/pyarrow/pandas_compat.py\n+++ b/python/pyarrow/pandas_compat.py\n@@ -27,7 +27,7 @@\n import six\n \n import pyarrow as pa\n-from pyarrow.compat import PY2, zip_longest  # noqa\n+from pyarrow.compat import builtin_pickle, PY2, zip_longest  # noqa\n \n \n def infer_dtype(column):\n@@ -424,11 +424,19 @@ def dataframe_to_serialized_dict(frame):\n             block_data.update(dictionary=values.categories,\n                               ordered=values.ordered)\n             values = values.codes\n-\n         block_data.update(\n             placement=block.mgr_locs.as_array,\n             block=values\n         )\n+\n+        # If we are dealing with an object array, pickle it instead. Note that\n+        # we do not use isinstance here because _int.CategoricalBlock is a\n+        # subclass of _int.ObjectBlock.\n+        if type(block) == _int.ObjectBlock:\n+            block_data['object'] = None\n+            block_data['block'] = builtin_pickle.dumps(\n+                values, protocol=builtin_pickle.HIGHEST_PROTOCOL)\n+\n         blocks.append(block_data)\n \n     return {\n@@ -463,6 +471,9 @@ def _reconstruct_block(item):\n         block = _int.make_block(block_arr, placement=placement,\n                                 klass=_int.DatetimeTZBlock,\n                                 dtype=dtype)\n+    elif 'object' in item:\n+        block = _int.make_block(builtin_pickle.loads(block_arr),\n+                                placement=placement, klass=_int.ObjectBlock)\n     else:\n         block = _int.make_block(block_arr, placement=placement)\n \ndiff --git a/python/pyarrow/serialization.py b/python/pyarrow/serialization.py\nindex c8b72b748..bdf753579 100644\n--- a/python/pyarrow/serialization.py\n+++ b/python/pyarrow/serialization.py\n@@ -57,10 +57,6 @@ def _load_pickle_from_buffer(data):\n         return builtin_pickle.loads(as_memoryview)\n \n \n-_serialize_numpy_array_pickle = _pickle_to_buffer\n-_deserialize_numpy_array_pickle = _load_pickle_from_buffer\n-\n-\n # ----------------------------------------------------------------------\n # pandas-specific serialization matters\n \n@@ -190,11 +186,3 @@ def default_serialization_context():\n \n \n register_default_serialization_handlers(_default_serialization_context)\n-\n-\n-def pandas_serialization_context():\n-    context = default_serialization_context()\n-    context.register_type(np.ndarray, 'np.array',\n-                          custom_serializer=_serialize_numpy_array_pickle,\n-                          custom_deserializer=_deserialize_numpy_array_pickle)\n-    return context\ndiff --git a/python/pyarrow/tests/test_convert_pandas.py b/python/pyarrow/tests/test_convert_pandas.py\nindex 95137ffb2..f7718f06a 100644\n--- a/python/pyarrow/tests/test_convert_pandas.py\n+++ b/python/pyarrow/tests/test_convert_pandas.py\n@@ -1613,7 +1613,7 @@ def _fully_loaded_dataframe_example():\n \n \n def _check_serialize_components_roundtrip(df):\n-    ctx = pa.pandas_serialization_context()\n+    ctx = pa.default_serialization_context()\n \n     components = ctx.serialize(df).to_components()\n     deserialized = ctx.deserialize_components(components)\ndiff --git a/python/pyarrow/tests/test_serialization.py b/python/pyarrow/tests/test_serialization.py\nindex 20c195a4b..0917172d2 100644\n--- a/python/pyarrow/tests/test_serialization.py\n+++ b/python/pyarrow/tests/test_serialization.py\n@@ -284,8 +284,6 @@ def custom_deserializer(serialized_obj):\n def test_primitive_serialization(large_buffer):\n     for obj in PRIMITIVE_OBJECTS:\n         serialization_roundtrip(obj, large_buffer)\n-        serialization_roundtrip(obj, large_buffer,\n-                                pa.pandas_serialization_context())\n \n \n def test_serialize_to_buffer():\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-20T01:55:29.894+0000",
                    "updated": "2018-02-20T01:55:29.894+0000"
                }
            ],
            "maxResults": 17,
            "total": 17,
            "startAt": 0
        },
        "customfield_12311820": "0|i3pzdr:",
        "customfield_12314139": null
    }
}