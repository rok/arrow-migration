{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13187257",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257",
    "key": "ARROW-3324",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343858",
                "id": "12343858",
                "description": "",
                "name": "0.12.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-01-20"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "parquet",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "1.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3324/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178607",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "tanyaschlusser commented on pull request #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261\n \n \n   Reset unique pointers and clear the `column_builders_` vector during `RowGroupMetaDataBuilderImpl.Finish()`\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T02:01:09.021+0000",
                    "updated": "2018-12-26T02:01:09.021+0000",
                    "started": "2018-12-26T02:01:09.021+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178607",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178608",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "tanyaschlusser commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-449887996\n \n \n   I could not think of a unit test to add; something that could access and assert the total count for one of the `shared_ptr` values maybe in the `cpp/src/parquet/file-serialize-test.cc`?\r\n   \r\n   Also, (noted in the [Jira comment](https://issues.apache.org/jira/browse/ARROW-3324?focusedCommentId=16728819&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-16728819)) this does not address the leaking other users reported on read, which I could not duplicate.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T02:05:10.532+0000",
                    "updated": "2018-12-26T02:05:10.532+0000",
                    "started": "2018-12-26T02:05:10.531+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178608",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-449896157\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=h1) Report\n   > Merging [#3261](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/cfaea429d0f2d3d9baa2a10d6da759ffd0f9d7f8?src=pr&el=desc) will **increase** coverage by `1.21%`.\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3261/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3261      +/-   ##\n   ==========================================\n   + Coverage   88.46%   89.68%   +1.21%     \n   ==========================================\n     Files         539      481      -58     \n     Lines       72845    68837    -4008     \n   ==========================================\n   - Hits        64444    61734    -2710     \n   + Misses       8294     7103    -1191     \n   + Partials      107        0     -107\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/parquet/metadata.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLmNj) | `90.72% <100%> (+0.07%)` | :arrow_up: |\n   | [cpp/src/arrow/csv/column-builder.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvY29sdW1uLWJ1aWxkZXIuY2M=) | `95.45% <0%> (-1.95%)` | :arrow_down: |\n   | [go/arrow/array/table.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvdGFibGUuZ28=) | | |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/internal/testing/tools/bool.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvdGVzdGluZy90b29scy9ib29sLmdv) | | |\n   | [go/arrow/internal/bitutil/bitutil.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvYml0dXRpbC9iaXR1dGlsLmdv) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [go/arrow/array/null.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvbnVsbC5nbw==) | | |\n   | [go/arrow/datatype\\_nested.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvZGF0YXR5cGVfbmVzdGVkLmdv) | | |\n   | [go/arrow/array/string.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvc3RyaW5nLmdv) | | |\n   | ... and [51 more](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=footer). Last update [cfaea42...b7051bc](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T03:26:23.445+0000",
                    "updated": "2018-12-26T03:26:23.445+0000",
                    "started": "2018-12-26T03:26:23.444+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178616",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178717",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-449992429\n \n \n   Thanks @tanyaschlusser for looking into this. I haven't been able to dig into this memory use issue yet, were you able to replicate some kind of memory leak? I will try to take a closer look also today \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T16:48:51.252+0000",
                    "updated": "2018-12-26T16:48:51.252+0000",
                    "started": "2018-12-26T16:48:51.251+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178717",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178734",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "tanyaschlusser commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450005238\n \n \n   Yes but this is out of my comfort zone so I am not confident of what I was seeing. I couldn't set up Valgrind on my laptop so I instead used [memory_profiler](https://pypi.org/project/memory-profiler/), copying what is in [arrow/python/scripts/test_leak.py](https://github.com/apache/arrow/blob/master/python/scripts/test_leak.py) but with the stackoverflow code. (added to the JIRA ticket. [link here](https://issues.apache.org/jira/secure/attachment/12953078/arrow_3324_leak_on_write.py)).\r\n   \r\n   I also added `std::cout << properties_.use_count() << \"\\n\";` statements inside the method linked below, before line 284 and after line 287.\r\n   \r\n   https://github.com/apache/arrow/blob/91c585d54b635212c78106790cf0ebed020fc758/cpp/src/parquet/file_writer.cc#L279-L289\r\n   \r\n   - `use_count()` increments twice: once before the first print statement somewhere, and once between the two print statements.\r\n   - The code in this PR does not stabilize the `use_count()` completely; it still increments once, with each call to `AppendRowGroup` ...\r\n   - maybe that's OK because the total number of row groups also keeps incrementing.\r\n   \r\n   With the debug-by-printf method the Python code was no longer necessary and it was possible to further debug by running the `file-serialize-test`.\r\n   \r\n   I apologize if it was poor etiquette to do a PR without being 100% sure of what I was doing. I felt that communicating directly through code was more useful than trying to explain all of this in comments on the Jira.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T18:27:04.060+0000",
                    "updated": "2018-12-26T18:27:04.060+0000",
                    "started": "2018-12-26T18:27:04.060+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178734",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178797",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450034350\n \n \n   Thanks @tanyaschlusser -- having the repro / investigation is very helpful. I'll take a closer look and let you know what I find out. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T22:18:54.680+0000",
                    "updated": "2018-12-26T22:18:54.680+0000",
                    "started": "2018-12-26T22:18:54.679+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178797",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178806",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324:  [Python] Users reporting memory leaks using pa.pq.ParquetDataset\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450039258\n \n \n   Taking a closer look at this -- the file writer class does indeed accumulate metadata in-memory, so can have memory use problems if you are writing very big files with many row groups, because there's no way to flush the metadata to disk because it's in a temporary Thrift C++ object.\r\n   \r\n   It seems we can definitely improve memory use by destroying the metadata builders once we're done with them, which is partly what you've done here. Let me have a hack at that and I'll push my changes here\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T23:10:41.658+0000",
                    "updated": "2018-12-26T23:10:41.658+0000",
                    "started": "2018-12-26T23:10:41.658+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178806",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178817",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450042848\n \n \n   I couldn't replicate the memory leak in the script attached to ARROW-3324. I checked on both 0.11.1 and master. See `test_leak3` function in `scripts/test_leak.py`:\r\n   \r\n   ```\r\n   $ python scripts/test_leak.py \r\n   450: 11.97265625\r\n   Memory increased by 13.26171875 megabytes after 500 iterations\r\n   ```\r\n   \r\n   Here I wrote 500 row groups, where each row group has 50 columns. In this case this means about 27K in buffered metadata per row group. `sizeof(format::ColumnChunk)` is 376 bytes, so the memory increase should be _at least_\r\n   \r\n   ```\r\n   >>> (376 * 50 * 500) / (1 << 20)\r\n   8.96453857421875\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T23:54:37.534+0000",
                    "updated": "2018-12-26T23:54:37.534+0000",
                    "started": "2018-12-26T23:54:37.533+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178817",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178818",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450042848\n \n \n   I couldn't replicate the memory leak in the script attached to ARROW-3324. I checked on both 0.11.1 and master. See `test_leak3` function in `scripts/test_leak.py`:\r\n   \r\n   ```\r\n   $ python scripts/test_leak.py \r\n   450: 11.97265625\r\n   Memory increased by 13.26171875 megabytes after 500 iterations\r\n   ```\r\n   \r\n   Here I wrote 500 row groups, where each row group has 50 columns. In this case this means about 27K in buffered metadata per row group. `sizeof(format::ColumnChunk)` is 376 bytes, so the memory increase should be _at least_ this many megabytes:\r\n   \r\n   ```\r\n   >>> (376 * 50 * 500) / (1 << 20)\r\n   8.96453857421875\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-26T23:54:56.532+0000",
                    "updated": "2018-12-26T23:54:56.532+0000",
                    "started": "2018-12-26T23:54:56.531+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178818",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178822",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-449896157\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=h1) Report\n   > Merging [#3261](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/46ecbb64e13d942803a21b23e5d7b7eff46bc752?src=pr&el=desc) will **increase** coverage by `1.2%`.\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3261/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree)\n   \n   ```diff\n   @@           Coverage Diff            @@\n   ##           master   #3261     +/-   ##\n   ========================================\n   + Coverage    88.5%   89.7%   +1.2%     \n   ========================================\n     Files         540     482     -58     \n     Lines       72917   68900   -4017     \n   ========================================\n   - Hits        64535   61809   -2726     \n   + Misses       8279    7091   -1188     \n   + Partials      103       0    -103\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/parquet/metadata.h](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLmg=) | `100% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/metadata-test.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLXRlc3QuY2M=) | `100% <100%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/metadata.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLmNj) | `90.54% <100%> (-0.1%)` | :arrow_down: |\n   | [go/arrow/array/table.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvdGFibGUuZ28=) | | |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/internal/testing/tools/bool.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvdGVzdGluZy90b29scy9ib29sLmdv) | | |\n   | [go/arrow/internal/bitutil/bitutil.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvYml0dXRpbC9iaXR1dGlsLmdv) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [go/arrow/array/null.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvbnVsbC5nbw==) | | |\n   | [go/arrow/datatype\\_nested.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvZGF0YXR5cGVfbmVzdGVkLmdv) | | |\n   | ... and [53 more](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=footer). Last update [46ecbb6...5f38767](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T00:20:56.474+0000",
                    "updated": "2018-12-27T00:20:56.474+0000",
                    "started": "2018-12-27T00:20:56.473+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178822",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178823",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-449896157\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=h1) Report\n   > Merging [#3261](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/46ecbb64e13d942803a21b23e5d7b7eff46bc752?src=pr&el=desc) will **increase** coverage by `1.2%`.\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3261/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree)\n   \n   ```diff\n   @@           Coverage Diff            @@\n   ##           master   #3261     +/-   ##\n   ========================================\n   + Coverage    88.5%   89.7%   +1.2%     \n   ========================================\n     Files         540     482     -58     \n     Lines       72917   68900   -4017     \n   ========================================\n   - Hits        64535   61809   -2726     \n   + Misses       8279    7091   -1188     \n   + Partials      103       0    -103\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/parquet/metadata.h](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLmg=) | `100% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/metadata-test.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLXRlc3QuY2M=) | `100% <100%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/metadata.cc](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L21ldGFkYXRhLmNj) | `90.54% <100%> (-0.1%)` | :arrow_down: |\n   | [go/arrow/array/table.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvdGFibGUuZ28=) | | |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/internal/testing/tools/bool.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvdGVzdGluZy90b29scy9ib29sLmdv) | | |\n   | [go/arrow/internal/bitutil/bitutil.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaW50ZXJuYWwvYml0dXRpbC9iaXR1dGlsLmdv) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [go/arrow/array/null.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvYXJyYXkvbnVsbC5nbw==) | | |\n   | [go/arrow/datatype\\_nested.go](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree#diff-Z28vYXJyb3cvZGF0YXR5cGVfbmVzdGVkLmdv) | | |\n   | ... and [53 more](https://codecov.io/gh/apache/arrow/pull/3261/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=footer). Last update [46ecbb6...5f38767](https://codecov.io/gh/apache/arrow/pull/3261?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T00:20:57.834+0000",
                    "updated": "2018-12-27T00:20:57.834+0000",
                    "started": "2018-12-27T00:20:57.832+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178823",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178836",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450051302\n \n \n   +1. Thanks for your help on this @tanyaschlusser!!\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T01:28:05.039+0000",
                    "updated": "2018-12-27T01:28:05.039+0000",
                    "started": "2018-12-27T01:28:05.038+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178836",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178837",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450051417\n \n \n   Actually, I will wait for @xhochy or @majetideepak to review, there's no need to rush this one\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T01:29:05.663+0000",
                    "updated": "2018-12-27T01:29:05.663+0000",
                    "started": "2018-12-27T01:29:05.662+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178837",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178899",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "majetideepak commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450069528\n \n \n   So far, this looks good to me.\r\n   I think we can further reduce the memory use by removing the redundant copy of `format::RowGroup` inside `FileMetaDataBuilder::Finish()`. I will submit a patch tomorrow.\r\n   \r\n   On a side note, Parquet files with many RowGroups (and many columns) are very bad for the read performance. The thrift metadata can grow to the order of hundreds of MBs. I also observed that the thrift deserialization time increases exponentially after a point as metadata size grows. I am yet to investigate the cause of this behavior. A better approach is to create multiple parquet files with a decent number of RowGroups per file and decent RowGroup (compressed) sizes.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T04:08:46.046+0000",
                    "updated": "2018-12-27T04:08:46.046+0000",
                    "started": "2018-12-27T04:08:46.046+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178899",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178915",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261#issuecomment-450072353\n \n \n   OK, I'll go ahead and merge this.\r\n   \r\n   My understanding it is fairly well known that Parquet performs badly when the file metadata is very large\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T04:37:47.033+0000",
                    "updated": "2018-12-27T04:37:47.033+0000",
                    "started": "2018-12-27T04:37:47.032+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178915",
                    "issueId": "13187257"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/worklog/178916",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #3261: ARROW-3324: [Python] Destroy temporary metadata builder classes more eagerly when building files to reduce memory usage\nURL: https://github.com/apache/arrow/pull/3261\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-12-27T04:38:20.001+0000",
                    "updated": "2018-12-27T04:38:20.001+0000",
                    "started": "2018-12-27T04:38:20.000+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "178916",
                    "issueId": "13187257"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@8811359[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e698cd2[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2c9ffa34[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5e62ec69[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@d278acb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@57e946[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@53caed22[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1a024296[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2bc2f2cf[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@14e03328[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@10476f6b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@18d98907[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Dec 27 04:38:09 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-12-27T04:38:09.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3324/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-09-25T11:11:02.000+0000",
        "updated": "2018-12-27T04:38:57.000+0000",
        "timeoriginalestimate": null,
        "description": "See:\r\n\r\n* https://github.com/apache/arrow/issues/2614\r\n* https://github.com/apache/arrow/issues/2624\r\n\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12953078",
                "id": "12953078",
                "filename": "arrow_3324_leak_on_write.py",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=tanya",
                    "name": "tanya",
                    "key": "tanya",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tanya&avatarId=37360",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tanya&avatarId=37360",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tanya&avatarId=37360",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tanya&avatarId=37360"
                    },
                    "displayName": "Tanya Schlusser",
                    "active": true,
                    "timeZone": "America/Chicago"
                },
                "created": "2018-12-26T17:47:31.535+0000",
                "size": 1528,
                "mimeType": "text/x-python-script",
                "content": "https://issues.apache.org/jira/secure/attachment/12953078/arrow_3324_leak_on_write.py"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Parquet] Free more internal resources when writing multiple row groups",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/comment/16665729",
                    "id": "16665729",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Here's another memory leak report\r\n\r\n{code}\r\nimport resource\r\nimport random\r\nimport string\r\nimport pyarrow as pa\r\nimport pyarrow.parquet as pq\r\nimport pandas as pd\r\n\r\n\r\ndef id_generator(size=6, chars=string.ascii_uppercase + string.digits):\r\n    return ''.join(random.choice(chars) for _ in range(size))\r\n\r\nschema = pa.schema([\r\n                        pa.field('test', pa.string()),\r\n                    ])\r\n\r\nresource.setrlimit(resource.RLIMIT_NOFILE, (1000000, 1000000))\r\nnumber_files = 10000\r\nnumber_rows_increment = 1000\r\nnumber_iterations = 100\r\n\r\nwriters = [pq.ParquetWriter('test_'+id_generator()+'.parquet', schema) for i in range(number_files)]\r\n\r\nfor i in range(number_iterations):\r\n    for writer in writers:\r\n        table_to_write = pa.Table.from_pandas(\r\n                            pd.DataFrame({'test': [id_generator() for i in range(number_rows_increment)]}),\r\n                            preserve_index=False,\r\n                            schema = schema,\r\n                            nthreads = 1)\r\n        table_to_write = table_to_write.replace_schema_metadata(None)\r\n        writer.write_table(table_to_write)\r\n    print(i)\r\n\r\nfor writer in writers:\r\n    writer.close()\r\n{code}\r\n\r\nhttps://stackoverflow.com/questions/53016802/memory-leak-from-pyarrow",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-10-26T22:40:53.131+0000",
                    "updated": "2018-10-26T22:40:53.131+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/comment/16728819",
                    "id": "16728819",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=tanya",
                        "name": "tanya",
                        "key": "tanya",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tanya&avatarId=37360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tanya&avatarId=37360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tanya&avatarId=37360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tanya&avatarId=37360"
                        },
                        "displayName": "Tanya Schlusser",
                        "active": true,
                        "timeZone": "America/Chicago"
                    },
                    "body": "I could not reproduce either of the two GitHub issues above, but could identify a leak using {{memory_profiler}} on the stackoverflow code (copied [this|https://github.com/apache/arrow/blob/master/python/scripts/test_leak.py])\r\n\r\nI observed that {{FileSerializer.properties_.use_count()}} increments more than expected whenever {{FileSerializer.AppendRowGroup}} is called. The offending line is {{FileSerializer.metadata_->AppendRowGroup()}}. I believe that the count should only go up once per new row group, instead of once per column plus once per row group.\r\n\r\nI think the root cause is that in {{RowGroupMetaDataBuilder::RowGroupMetaDataBuilderImpl.Finish}}, the vector of {{column_builders_}} ought to be reset and cleared each time before it is repopulated. I hope to submit a pull request for this even though it may not address all of the issues stated here. Since the GitHub issues were about memory leaks on \"read\", and the fix is related only to \"write\", this observation certainly doesn't address everything in this JIRA issue.\r\n\r\nEven after the fix I'll post, my memory_profiler code still shows an increase in memory use upon additional calls to {{pq.ParquetWriter.write_table}}, which I think is OK because the row group is incrementing with each write too. So I may be wrong or have still missed something. Regardless, I hope\u00a0these notes\u00a0are\u00a0useful to someone.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=tanya",
                        "name": "tanya",
                        "key": "tanya",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tanya&avatarId=37360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tanya&avatarId=37360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tanya&avatarId=37360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tanya&avatarId=37360"
                        },
                        "displayName": "Tanya Schlusser",
                        "active": true,
                        "timeZone": "America/Chicago"
                    },
                    "created": "2018-12-25T21:59:53.238+0000",
                    "updated": "2018-12-25T21:59:53.238+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/comment/16729131",
                    "id": "16729131",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=tanya",
                        "name": "tanya",
                        "key": "tanya",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tanya&avatarId=37360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tanya&avatarId=37360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tanya&avatarId=37360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tanya&avatarId=37360"
                        },
                        "displayName": "Tanya Schlusser",
                        "active": true,
                        "timeZone": "America/Chicago"
                    },
                    "body": "The file [arrow_3324_leak_on_write.py|https://issues.apache.org/jira/secure/attachment/12953078/arrow_3324_leak_on_write.py] contains a modified version of the stackoverflow post in Wes's comment above, with {{memory_profiler}} to show the memory use. The memory use does increase as the code cycles through multiple calls to {{write_table}}.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=tanya",
                        "name": "tanya",
                        "key": "tanya",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=tanya&avatarId=37360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=tanya&avatarId=37360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=tanya&avatarId=37360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=tanya&avatarId=37360"
                        },
                        "displayName": "Tanya Schlusser",
                        "active": true,
                        "timeZone": "America/Chicago"
                    },
                    "created": "2018-12-26T18:30:52.285+0000",
                    "updated": "2018-12-26T18:30:52.285+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13187257/comment/16729320",
                    "id": "16729320",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 3261\n[https://github.com/apache/arrow/pull/3261]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-12-27T04:38:09.240+0000",
                    "updated": "2018-12-27T04:38:09.240+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|i3ygkv:",
        "customfield_12314139": null
    }
}