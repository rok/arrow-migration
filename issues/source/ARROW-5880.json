{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13243799",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799",
    "key": "ARROW-5880",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "Parquet",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield%40gmail.com",
            "name": "emkornfield@gmail.com",
            "key": "emkornfield@gmail.com",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Micah Kornfield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5880/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 15,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/273658",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827\n \n \n   - Other small cleanups/comments based on my grokking of the code.\r\n   - Vectorize inner loop of List based LevelBuilder where possible\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T02:48:01.452+0000",
                    "updated": "2019-07-09T02:48:01.452+0000",
                    "started": "2019-07-09T02:48:01.451+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "273658",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274253",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301696424\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -49,8 +49,7 @@ using arrow::ChunkedArray;\n using arrow::Decimal128Array;\n using arrow::Field;\n using arrow::FixedSizeBinaryArray;\n-using arrow::Int16Array;\n-using arrow::Int16Builder;\n+using Int16BufferBuilder = arrow::TypedBufferBuilder<uint16_t>;\n \n Review comment:\n   Alternatively,\r\n   ```suggestion\r\n   using UInt16BufferBuilder = arrow::TypedBufferBuilder<uint16_t>;\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:47.278+0000",
                    "updated": "2019-07-09T17:42:47.278+0000",
                    "started": "2019-07-09T17:42:47.276+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274253",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274254",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301700833\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -307,7 +310,8 @@ struct ColumnWriterContext {\n Status GetLeafType(const ::arrow::DataType& type, ::arrow::Type::type* leaf_type) {\n   if (type.id() == ::arrow::Type::LIST || type.id() == ::arrow::Type::STRUCT) {\n     if (type.num_children() != 1) {\n-      return Status::Invalid(\"Nested column branch had multiple children\");\n+      return Status::Invalid(\"Nested column branch had multiple children: \",\n \n Review comment:\n   `DataType` is ostreamable:\r\n   ```suggestion\r\n         return Status::Invalid(\"Nested column branch had multiple children: \", *type);\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:47.289+0000",
                    "updated": "2019-07-09T17:42:47.289+0000",
                    "started": "2019-07-09T17:42:47.288+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274254",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274255",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301699957\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -223,30 +221,35 @@ class LevelBuilder {\n       const int64_t level_null_count = null_counts_[recursion_level];\n       const uint8_t* level_valid_bitmap = valid_bitmaps_[recursion_level];\n \n-      for (int64_t i = 0; i < inner_length; i++) {\n-        if (i > 0) {\n-          RETURN_NOT_OK(rep_levels_.Append(static_cast<int16_t>(rep_level + 1)));\n-        }\n-        if (level_null_count && level_valid_bitmap == nullptr) {\n-          // Special case: this is a null array (all elements are null)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n-        } else if (nullable_level &&\n-                   ((level_null_count == 0) ||\n-                    BitUtil::GetBit(\n-                        level_valid_bitmap,\n-                        inner_offset + i + array_offsets_[recursion_level]))) {\n-          // Non-null element in a null level\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 2)));\n-        } else {\n-          // This can be produced in two case:\n-          //  * elements are nullable and this one is null (i.e. max_def_level = def_level\n-          //  + 2)\n-          //  * elements are non-nullable (i.e. max_def_level = def_level + 1)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n+      if (inner_length >= 1) {\n+        RETURN_NOT_OK(\n+            rep_levels_.Append(inner_length - 1, static_cast<int16_t>(rep_level + 1)));\n+      }\n+\n+      // Special case: this is a null array (all elements are null)\n+      if (level_null_count && level_valid_bitmap == nullptr) {\n+        RETURN_NOT_OK(\n+            def_levels_.Append(inner_length, static_cast<int16_t>(def_level + 1)));\n+      } else {\n+        for (int64_t i = 0; i < inner_length; i++) {\n+          if (nullable_level &&\n+              ((level_null_count == 0) ||\n+               BitUtil::GetBit(level_valid_bitmap,\n+                               inner_offset + i + array_offsets_[recursion_level]))) {\n+            // Non-null element in a null level\n+            RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 2)));\n+          } else {\n+            // This can be produced in two case:\n+            //  * elements are nullable and this one is null (i.e. max_def_level =\n \n Review comment:\n   This isn't readable\r\n   ```suggestion\r\n               //  * elements are nullable and this one is null\r\n               //    (i.e. max_def_level = def_level + 2)\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:47.296+0000",
                    "updated": "2019-07-09T17:42:47.296+0000",
                    "started": "2019-07-09T17:42:47.296+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274255",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274257",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301698105\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -176,18 +175,17 @@ class LevelBuilder {\n       }\n       *num_levels = array.length();\n     } else {\n+      // Note it is hard to estimate memory consumption due to zero length\n+      // arrays otherwise we would preallocate.  An upper boun on memory\n \n Review comment:\n   ```suggestion\r\n         // arrays otherwise we would preallocate.  An upper bound on memory\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:47.300+0000",
                    "updated": "2019-07-09T17:42:47.300+0000",
                    "started": "2019-07-09T17:42:47.299+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274257",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301702131\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -223,30 +221,35 @@ class LevelBuilder {\n       const int64_t level_null_count = null_counts_[recursion_level];\n       const uint8_t* level_valid_bitmap = valid_bitmaps_[recursion_level];\n \n-      for (int64_t i = 0; i < inner_length; i++) {\n-        if (i > 0) {\n-          RETURN_NOT_OK(rep_levels_.Append(static_cast<int16_t>(rep_level + 1)));\n-        }\n-        if (level_null_count && level_valid_bitmap == nullptr) {\n-          // Special case: this is a null array (all elements are null)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n-        } else if (nullable_level &&\n-                   ((level_null_count == 0) ||\n-                    BitUtil::GetBit(\n-                        level_valid_bitmap,\n-                        inner_offset + i + array_offsets_[recursion_level]))) {\n-          // Non-null element in a null level\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 2)));\n-        } else {\n-          // This can be produced in two case:\n-          //  * elements are nullable and this one is null (i.e. max_def_level = def_level\n-          //  + 2)\n-          //  * elements are non-nullable (i.e. max_def_level = def_level + 1)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n+      if (inner_length >= 1) {\n+        RETURN_NOT_OK(\n+            rep_levels_.Append(inner_length - 1, static_cast<int16_t>(rep_level + 1)));\n+      }\n+\n+      // Special case: this is a null array (all elements are null)\n+      if (level_null_count && level_valid_bitmap == nullptr) {\n+        RETURN_NOT_OK(\n \n Review comment:\n   Instead of following this block with an `else`, just return here:\r\n   ```suggestion\r\n           return def_levels_.Append(inner_length, static_cast<int16_t>(def_level + 1));\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:47.300+0000",
                    "updated": "2019-07-09T17:42:47.300+0000",
                    "started": "2019-07-09T17:42:47.299+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274256",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274258",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301696301\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -49,8 +49,7 @@ using arrow::ChunkedArray;\n using arrow::Decimal128Array;\n using arrow::Field;\n using arrow::FixedSizeBinaryArray;\n-using arrow::Int16Array;\n-using arrow::Int16Builder;\n+using Int16BufferBuilder = arrow::TypedBufferBuilder<uint16_t>;\n \n Review comment:\n   ```suggestion\r\n   using Int16BufferBuilder = arrow::TypedBufferBuilder<int16_t>;\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:42:48.175+0000",
                    "updated": "2019-07-09T17:42:48.175+0000",
                    "started": "2019-07-09T17:42:48.175+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274258",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274262",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301713052\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -223,30 +221,35 @@ class LevelBuilder {\n       const int64_t level_null_count = null_counts_[recursion_level];\n       const uint8_t* level_valid_bitmap = valid_bitmaps_[recursion_level];\n \n-      for (int64_t i = 0; i < inner_length; i++) {\n-        if (i > 0) {\n-          RETURN_NOT_OK(rep_levels_.Append(static_cast<int16_t>(rep_level + 1)));\n-        }\n-        if (level_null_count && level_valid_bitmap == nullptr) {\n-          // Special case: this is a null array (all elements are null)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n-        } else if (nullable_level &&\n-                   ((level_null_count == 0) ||\n-                    BitUtil::GetBit(\n-                        level_valid_bitmap,\n-                        inner_offset + i + array_offsets_[recursion_level]))) {\n-          // Non-null element in a null level\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 2)));\n-        } else {\n-          // This can be produced in two case:\n-          //  * elements are nullable and this one is null (i.e. max_def_level = def_level\n-          //  + 2)\n-          //  * elements are non-nullable (i.e. max_def_level = def_level + 1)\n-          RETURN_NOT_OK(def_levels_.Append(static_cast<int16_t>(def_level + 1)));\n+      if (inner_length >= 1) {\n+        RETURN_NOT_OK(\n+            rep_levels_.Append(inner_length - 1, static_cast<int16_t>(rep_level + 1)));\n+      }\n+\n+      // Special case: this is a null array (all elements are null)\n+      if (level_null_count && level_valid_bitmap == nullptr) {\n+        RETURN_NOT_OK(\n \n Review comment:\n   Could you also delete the superfluous else on line 218?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:44:48.809+0000",
                    "updated": "2019-07-09T17:44:48.809+0000",
                    "started": "2019-07-09T17:44:48.808+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274262",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274263",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301713293\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -176,18 +175,17 @@ class LevelBuilder {\n       }\n       *num_levels = array.length();\n     } else {\n+      // Note it is hard to estimate memory consumption due to zero length\n+      // arrays otherwise we would preallocate.  An upper boun on memory\n+      // is the sum of the length of each list array  + number of elements\n+      // but this might be too loose of an upper bound so we choose to use\n+      // safe methods.\n       RETURN_NOT_OK(rep_levels_.Append(0));\n       RETURN_NOT_OK(HandleListEntries(0, 0, 0, array.length()));\n \n-      std::shared_ptr<Array> def_levels_array;\n-      std::shared_ptr<Array> rep_levels_array;\n-\n-      RETURN_NOT_OK(def_levels_.Finish(&def_levels_array));\n-      RETURN_NOT_OK(rep_levels_.Finish(&rep_levels_array));\n-\n-      *def_levels_out = static_cast<PrimitiveArray*>(def_levels_array.get())->values();\n-      *rep_levels_out = static_cast<PrimitiveArray*>(rep_levels_array.get())->values();\n-      *num_levels = rep_levels_array->length();\n+      RETURN_NOT_OK(def_levels_.Finish(def_levels_out));\n \n Review comment:\n   Nice simplification here\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:45:21.511+0000",
                    "updated": "2019-07-09T17:45:21.511+0000",
                    "started": "2019-07-09T17:45:21.510+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274263",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274265",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #4827: ARROW-5880: Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#discussion_r301714137\n \n \n\n ##########\n File path: cpp/src/parquet/arrow/writer.cc\n ##########\n @@ -176,18 +175,17 @@ class LevelBuilder {\n       }\n       *num_levels = array.length();\n     } else {\n+      // Note it is hard to estimate memory consumption due to zero length\n+      // arrays otherwise we would preallocate.  An upper boun on memory\n+      // is the sum of the length of each list array  + number of elements\n+      // but this might be too loose of an upper bound so we choose to use\n+      // safe methods.\n       RETURN_NOT_OK(rep_levels_.Append(0));\n       RETURN_NOT_OK(HandleListEntries(0, 0, 0, array.length()));\n \n-      std::shared_ptr<Array> def_levels_array;\n-      std::shared_ptr<Array> rep_levels_array;\n-\n-      RETURN_NOT_OK(def_levels_.Finish(&def_levels_array));\n-      RETURN_NOT_OK(rep_levels_.Finish(&rep_levels_array));\n-\n-      *def_levels_out = static_cast<PrimitiveArray*>(def_levels_array.get())->values();\n-      *rep_levels_out = static_cast<PrimitiveArray*>(rep_levels_array.get())->values();\n-      *num_levels = rep_levels_array->length();\n+      RETURN_NOT_OK(def_levels_.Finish(def_levels_out));\n \n Review comment:\n   The CI failures look spurious: Travis is in a re-run cmake loop and appveyor failed to build googletest\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-09T17:47:22.904+0000",
                    "updated": "2019-07-09T17:47:22.904+0000",
                    "started": "2019-07-09T17:47:22.903+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274265",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/274703",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on issue #4827: ARROW-5880: [C++][Parquet] Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#issuecomment-509942106\n \n \n   @bkietz thanks for the review, all good suggestions.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-10T07:21:18.719+0000",
                    "updated": "2019-07-10T07:21:18.719+0000",
                    "started": "2019-07-10T07:21:18.718+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "274703",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/275032",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #4827: ARROW-5880: [C++][Parquet] Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#issuecomment-510206573\n \n \n   Added some missing exports.\r\n   \r\n   Beware as you make more changes on the Parquet codebase that my patch https://github.com/apache/arrow/pull/4841 is slightly disruptive to the src/parquet/arrow directory (but should not be too bad to rebase)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-10T20:00:51.464+0000",
                    "updated": "2019-07-10T20:00:51.464+0000",
                    "started": "2019-07-10T20:00:51.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "275032",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/275625",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on issue #4827: ARROW-5880: [C++][Parquet] Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#issuecomment-510718449\n \n \n   @wesm thanks for the fixes.  I will look more closely as I modify code to watch out for potential merge conflicts (I have enough other things on my plate that it might be a few days anyways before I get back to this).\r\n   \r\n   I restarted the failing travis-CI job which looked spurious\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-12T02:17:58.928+0000",
                    "updated": "2019-07-12T02:17:58.928+0000",
                    "started": "2019-07-12T02:17:58.927+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "275625",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/278805",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #4827: ARROW-5880: [C++][Parquet] Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827#issuecomment-512713657\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=h1) Report\n   > Merging [#4827](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/1abf18ff902e82fee0f23646f12011cbdc9b64d8?src=pr&el=desc) will **increase** coverage by `1.74%`.\n   > The diff coverage is `95.45%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/4827/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #4827      +/-   ##\n   ==========================================\n   + Coverage   87.31%   89.05%   +1.74%     \n   ==========================================\n     Files         894      718     -176     \n     Lines      134066   100316   -33750     \n   ==========================================\n   - Hits       117055    89334   -27721     \n   + Misses      16659    10982    -5677     \n   + Partials      352        0     -352\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/type.h](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy90eXBlLmg=) | `92.69% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/arrow/buffer-builder.h](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9idWZmZXItYnVpbGRlci5o) | `100% <100%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/arrow/writer.cc](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2Fycm93L3dyaXRlci5jYw==) | `96.71% <95%> (-0.04%)` | :arrow_down: |\n   | [cpp/src/plasma/thirdparty/ae/ae.c](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvdGhpcmRwYXJ0eS9hZS9hZS5j) | `70.75% <0%> (-0.95%)` | :arrow_down: |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | | |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | | |\n   | [rust/datafusion/src/execution/filter.rs](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9leGVjdXRpb24vZmlsdGVyLnJz) | | |\n   | [rust/arrow/src/csv/writer.rs](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY3N2L3dyaXRlci5ycw==) | | |\n   | [rust/datafusion/src/bin/main.rs](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9iaW4vbWFpbi5ycw==) | | |\n   | ... and [171 more](https://codecov.io/gh/apache/arrow/pull/4827/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=footer). Last update [1abf18f...2f77313](https://codecov.io/gh/apache/arrow/pull/4827?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-18T08:13:45.994+0000",
                    "updated": "2019-07-18T08:13:45.994+0000",
                    "started": "2019-07-18T08:13:45.994+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "278805",
                    "issueId": "13243799"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/worklog/279263",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #4827: ARROW-5880: [C++][Parquet] Use TypedBufferBuilder instead of ArrayBuilder in writer.cc\nURL: https://github.com/apache/arrow/pull/4827\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-07-18T19:17:27.580+0000",
                    "updated": "2019-07-18T19:17:27.580+0000",
                    "started": "2019-07-18T19:17:27.579+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "279263",
                    "issueId": "13243799"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 7200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@55096766[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@74b41745[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b907eeb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6fca48e3[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@351d37d7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@709f016e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@48405eb0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@75f08a0b[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@298fa8ed[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@211358c3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6bec278f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1abd482b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 7200,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jul 18 19:17:20 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-07-18T19:17:20.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5880/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-07-09T02:44:55.000+0000",
        "updated": "2019-08-01T22:39:23.000+0000",
        "timeoriginalestimate": null,
        "description": "In looking at the code it seems the writer.cc hasn't been updated to use the latest classes.  there is also what appears to be a small performance bug in TypedBufferBuilder",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 7200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Update arrow parquet writer to use TypedBufferBuilder ",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243799/comment/16888265",
                    "id": "16888265",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 4827\n[https://github.com/apache/arrow/pull/4827]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-07-18T19:17:20.592+0000",
                    "updated": "2019-07-18T19:17:20.592+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z04h9k:",
        "customfield_12314139": null
    }
}