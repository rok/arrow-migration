{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13326917",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917",
    "key": "ARROW-9969",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348647",
                "id": "12348647",
                "name": "1.0.1",
                "archived": false,
                "released": true,
                "releaseDate": "2020-08-21"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=troels",
            "name": "troels",
            "key": "troels",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Troels Nielsen",
            "active": true,
            "timeZone": "Europe/Copenhagen"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=belzilep",
            "name": "belzilep",
            "key": "belzilep",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Pierre Belzile",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=belzilep",
            "name": "belzilep",
            "key": "belzilep",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Pierre Belzile",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9969/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 14,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/483628",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels opened a new pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178\n\n\n   Some types, such as some dictionary types, can not be fully determined\r\n   before a RecordBatch has been built.\r\n   \r\n   Ensure that the RecordBatch schema contains the correct types, when\r\n   the RecordBatchBuilder has finished building the RecordBatch.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-13T10:14:09.211+0000",
                    "updated": "2020-09-13T10:14:09.211+0000",
                    "started": "2020-09-13T10:14:09.211+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "483628",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/483630",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#issuecomment-691652260\n\n\n   https://issues.apache.org/jira/browse/ARROW-9969\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-13T10:22:44.661+0000",
                    "updated": "2020-09-13T10:22:44.661+0000",
                    "started": "2020-09-13T10:22:44.661+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "483630",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/483797",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r487674576\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n+  for (int i = 0; i < this->num_fields(); ++i) {\n+    if (!schema_fields[i]->type()->Equals(fields[i]->type())) {\n+      auto new_type(schema_fields[i]->WithType(fields[i]->type()));\n\nReview comment:\n       small nit: please don't use auto (spell out the type).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-14T06:20:19.176+0000",
                    "updated": "2020-09-14T06:20:19.176+0000",
                    "started": "2020-09-14T06:20:19.176+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "483797",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/483831",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r487712100\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n+  for (int i = 0; i < this->num_fields(); ++i) {\n+    if (!schema_fields[i]->type()->Equals(fields[i]->type())) {\n+      auto new_type(schema_fields[i]->WithType(fields[i]->type()));\n\nReview comment:\n       Sure thing.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-14T07:41:36.512+0000",
                    "updated": "2020-09-14T07:41:36.512+0000",
                    "started": "2020-09-14T07:41:36.512+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "483831",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/484940",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#issuecomment-693182492\n\n\n   @pitrou or @bkietz I think one or both of you might have touched this code recently, the change looks reasonable to me but could you validate?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T05:37:19.215+0000",
                    "updated": "2020-09-16T05:37:19.215+0000",
                    "started": "2020-09-16T05:37:19.215+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484940",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485001",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489250800\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n+  for (int i = 0; i < this->num_fields(); ++i) {\n+    if (!schema_fields[i]->type()->Equals(fields[i]->type())) {\n+      std::shared_ptr<Field> new_type(schema_fields[i]->WithType(fields[i]->type()));\n+      ARROW_ASSIGN_OR_RAISE(schema, schema->SetField(i, new_type));\n+    }\n+  }\n\nReview comment:\n       For the record, the entire loop may be O(N^2) if there are N types to replace.\r\n   It may be better to do it in two steps:\r\n   1. detect if at least one type needs replacing\r\n   2. if so, create a new schema with a new fields vector\r\n   \r\n   Or you could always create a new schema anyway...\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T08:17:48.594+0000",
                    "updated": "2020-09-16T08:17:48.594+0000",
                    "started": "2020-09-16T08:17:48.594+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485001",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485002",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489251187\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n\nReview comment:\n       No need to copy the vector around. Just:\r\n   ```c++\r\n   const auto& schema_fields = schema->fields();\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T08:18:21.533+0000",
                    "updated": "2020-09-16T08:18:21.533+0000",
                    "started": "2020-09-16T08:18:21.533+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485002",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485004",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489252433\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder_test.cc\n##########\n@@ -151,4 +151,31 @@ TEST_F(TestRecordBatchBuilder, InvalidFieldLength) {\n   ASSERT_RAISES(Invalid, builder->Flush(&dummy));\n }\n \n+// In #ARROW-9969 dictionary types were not updated\n+// in schema when the index width grew.\n+TEST_F(TestRecordBatchBuilder, DictionaryTypes) {\n+  const int num_rows = static_cast<int>(UINT8_MAX) + 2;\n+  std::vector<std::string> f0_values;\n+  std::vector<bool> is_valid(num_rows, true);\n+  for (int i = 0; i < num_rows; i++) {\n+    f0_values.push_back(std::to_string(i));\n+  }\n+\n+  auto f0 = field(\"f0\", dictionary(int8(), utf8()));\n+\n+  auto schema = ::arrow::schema({f0});\n+\n+  std::unique_ptr<RecordBatchBuilder> builder;\n+  ASSERT_OK(RecordBatchBuilder::Make(schema, pool_, &builder));\n+\n+  auto b0 = builder->GetFieldAs<StringDictionaryBuilder>(0);\n+\n+  AppendValues<StringDictionaryBuilder, std::string>(b0, f0_values, is_valid);\n+\n+  std::shared_ptr<RecordBatch> batch;\n+  ASSERT_OK(builder->Flush(&batch));\n+\n+  ASSERT_TRUE(batch->column(0)->type()->Equals(batch->schema()->field(0)->type()));\n\nReview comment:\n       Please use `AssertTypeEqual`.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T08:20:22.466+0000",
                    "updated": "2020-09-16T08:20:22.466+0000",
                    "started": "2020-09-16T08:20:22.466+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485004",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485409",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489772747\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n+  for (int i = 0; i < this->num_fields(); ++i) {\n+    if (!schema_fields[i]->type()->Equals(fields[i]->type())) {\n+      std::shared_ptr<Field> new_type(schema_fields[i]->WithType(fields[i]->type()));\n+      ARROW_ASSIGN_OR_RAISE(schema, schema->SetField(i, new_type));\n+    }\n+  }\n\nReview comment:\n       Hi @pitrou \r\n   \r\n   I've changed the logic to what you suggested, just building a vector of fields to use for creating a new schema.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T21:46:29.693+0000",
                    "updated": "2020-09-16T21:46:29.693+0000",
                    "started": "2020-09-16T21:46:29.693+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485409",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485410",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489773087\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n\nReview comment:\n       I've changed the logic so that the vector might be modified, and now it need to be copied.\n\n##########\nFile path: cpp/src/arrow/table_builder_test.cc\n##########\n@@ -151,4 +151,31 @@ TEST_F(TestRecordBatchBuilder, InvalidFieldLength) {\n   ASSERT_RAISES(Invalid, builder->Flush(&dummy));\n }\n \n+// In #ARROW-9969 dictionary types were not updated\n+// in schema when the index width grew.\n+TEST_F(TestRecordBatchBuilder, DictionaryTypes) {\n+  const int num_rows = static_cast<int>(UINT8_MAX) + 2;\n+  std::vector<std::string> f0_values;\n+  std::vector<bool> is_valid(num_rows, true);\n+  for (int i = 0; i < num_rows; i++) {\n+    f0_values.push_back(std::to_string(i));\n+  }\n+\n+  auto f0 = field(\"f0\", dictionary(int8(), utf8()));\n+\n+  auto schema = ::arrow::schema({f0});\n+\n+  std::unique_ptr<RecordBatchBuilder> builder;\n+  ASSERT_OK(RecordBatchBuilder::Make(schema, pool_, &builder));\n+\n+  auto b0 = builder->GetFieldAs<StringDictionaryBuilder>(0);\n+\n+  AppendValues<StringDictionaryBuilder, std::string>(b0, f0_values, is_valid);\n+\n+  std::shared_ptr<RecordBatch> batch;\n+  ASSERT_OK(builder->Flush(&batch));\n+\n+  ASSERT_TRUE(batch->column(0)->type()->Equals(batch->schema()->field(0)->type()));\n\nReview comment:\n       Ok\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T21:47:22.795+0000",
                    "updated": "2020-09-16T21:47:22.795+0000",
                    "started": "2020-09-16T21:47:22.795+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485410",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485412",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels commented on pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#issuecomment-693683451\n\n\n   Thanks @pitrou \r\n   \r\n   I've modified the patch according to your suggestions.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T21:48:19.245+0000",
                    "updated": "2020-09-16T21:48:19.245+0000",
                    "started": "2020-09-16T21:48:19.244+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485412",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/485750",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "troels commented on a change in pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178#discussion_r489773087\n\n\n\n##########\nFile path: cpp/src/arrow/table_builder.cc\n##########\n@@ -62,7 +62,21 @@ Status RecordBatchBuilder::Flush(bool reset_builders,\n     }\n     length = fields[i]->length();\n   }\n-  *batch = RecordBatch::Make(schema_, length, std::move(fields));\n+\n+  // For certain types like dictionaries, types may not be fully\n+  // determined before we have flushed. Make sure that the RecordBatch\n+  // gets the correct types in schema.\n+  // See: #ARROW-9969\n+  std::shared_ptr<Schema> schema(schema_);\n+  std::vector<std::shared_ptr<Field>> schema_fields(schema->fields());\n\nReview comment:\n       I've changed the logic so that the vector might be modified, and now it needs to be copied.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-17T13:51:15.206+0000",
                    "updated": "2020-09-17T13:51:15.206+0000",
                    "started": "2020-09-17T13:51:15.206+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485750",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/486900",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-21T13:00:48.461+0000",
                    "updated": "2020-09-21T13:00:48.461+0000",
                    "started": "2020-09-21T13:00:48.460+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "486900",
                    "issueId": "13326917"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/worklog/487567",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #8178:\nURL: https://github.com/apache/arrow/pull/8178\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-22T03:16:56.512+0000",
                    "updated": "2020-09-22T03:16:56.512+0000",
                    "started": "2020-09-22T03:16:56.512+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "487567",
                    "issueId": "13326917"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 8400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@577b6e56[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@43972881[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@d848ee7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@77ad7cf6[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21f3b31d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2a33dd5d[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e99d4a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1f3f1b0d[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@236838ac[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1705c0a9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@58490cce[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3fc993b9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 8400,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Sep 21 13:00:34 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-09-21T13:00:34.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9969/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-09-10T17:37:46.000+0000",
        "updated": "2020-09-22T03:16:57.000+0000",
        "timeoriginalestimate": null,
        "description": "The record batch builder takes a schema as input and uses that schema when creating the record batch.\r\n\r\nHowever when one or more fields are dictionaries, the data type is unknown until the dictionary builder flushes and the initial schema often does not match. The builder needs to modify the schema for the actual data type generated.\r\n\r\nThis problem is easily reproduced by providing a schema with a field dictionary(int16(), utf8()) and adding a single row. This yields a data type of dictionary(int8(),utf8()).",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 8400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] RecordBatchBuilder yields invalid result with dictionary fields",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326917/comment/17199375",
                    "id": "17199375",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 8178\n[https://github.com/apache/arrow/pull/8178]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-09-21T13:00:34.909+0000",
                    "updated": "2020-09-21T13:00:34.909+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0ihpk:",
        "customfield_12314139": null
    }
}