{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13133651",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651",
    "key": "ARROW-2033",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2033/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@f666e0f[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d4d27d7[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@304626aa[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@401dcea[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1c7dc608[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7145c77e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@70b7cc8a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7adbb8fa[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@8e47c2f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@57c5347a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@19587194[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3ee3062d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jan 30 15:17:03 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-01-30T15:17:03.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2033/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-01-25T10:52:33.000+0000",
        "updated": "2018-01-30T15:17:03.000+0000",
        "timeoriginalestimate": null,
        "description": "pa.array handles iterables fine, but not iterators if size isn't passed:\r\n{code:java}\r\n>>> arr = pa.array(range(5))\r\n>>> arr\r\n<pyarrow.lib.Int64Array object at 0x7f4652a05318>\r\n[\r\n  0,\r\n  1,\r\n  2,\r\n  3,\r\n  4\r\n]\r\n>>> arr = pa.array(iter(range(5)))\r\n>>> arr\r\n<pyarrow.lib.NullArray object at 0x7f4633c1d638>\r\n[\r\n\u00a0 NA,\r\n\u00a0 NA,\r\n\u00a0 NA,\r\n\u00a0 NA,\r\n\u00a0 NA\r\n]\r\n{code}\r\n\r\nThis is because InferArrowSize() first exhausts the iterator.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "pa.array() doesn't work with iterators",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16339231",
                    "id": "16339231",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou opened a new pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513\n \n \n   Iterator (not iterable) input was broken with pa.array() unless both type and size were explicitly passed.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-25T13:47:51.580+0000",
                    "updated": "2018-01-25T13:47:51.580+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16343246",
                    "id": "16343246",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361217636\n \n \n   There are (probably unrelated) build errors against the thrift header files:\r\n   ```\r\n   In file included from src/parquet/column_reader.cc:34:0:\r\n   src/parquet/thrift.h: In function \u2018void parquet::DeserializeThriftMsg(const uint8_t*, uint32_t*, T*)\u2019:\r\n   src/parquet/thrift.h:103:48: error: no matching function for call to \u2018apache::thrift::protocol::TCompactProtocolFactoryT<apache::thrift::transport::TMemoryBuffer>::getProtocol(std::shared_ptr<apache::thrift::transport::TMemoryBuffer>&)\u2019\r\n          tproto_factory.getProtocol(tmem_transport);\r\n                                                   ^\r\n   src/parquet/thrift.h:103:48: note: candidate is:\r\n   In file included from src/parquet/thrift.h:28:0,\r\n                    from src/parquet/column_reader.cc:34:\r\n   /usr/include/thrift/protocol/TCompactProtocol.h:242:32: note: boost::shared_ptr<apache::thrift::protocol::TProtocol> apache::thrift::protocol::TCompactProtocolFactoryT<Transport_>::getProtocol(boost::shared_ptr<apache::thrift::transport::TTransport>) [with Transport_ = apache::thrift::transport::TMemoryBuffer]\r\n      boost::shared_ptr<TProtocol> getProtocol(boost::shared_ptr<TTransport> trans) {\r\n                                   ^\r\n   ```\r\n   \r\n   How should I go about those?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T11:28:51.503+0000",
                    "updated": "2018-01-29T11:28:51.503+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16343260",
                    "id": "16343260",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361222238\n \n \n   Actually, PR #1528 is probably needed to get rid of the build errors.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T11:50:28.561+0000",
                    "updated": "2018-01-29T11:50:28.561+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16343280",
                    "id": "16343280",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361225514\n \n \n   @pitrou Ignore all Parquet or Thrift related errors for now, at the moment all of them boil down that they wait for https://github.com/conda-forge/thrift-cpp-feedstock/pull/17\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T12:05:07.130+0000",
                    "updated": "2018-01-29T12:05:07.130+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16343282",
                    "id": "16343282",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361225657\n \n \n   Ok, then I think this PR is basically ready.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T12:05:50.874+0000",
                    "updated": "2018-01-29T12:05:50.874+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16343574",
                    "id": "16343574",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361298944\n \n \n   Will review this today -- hope to get the PR backlog under control this week\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T16:20:12.946+0000",
                    "updated": "2018-01-29T16:20:12.946+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344146",
                    "id": "16344146",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164588591\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -285,25 +273,44 @@ class SeqVisitor {\n   }\n };\n \n-Status InferArrowSize(PyObject* obj, int64_t* size) {\n+// Convert *obj* to a sequence if necessary\n+// Fill *size* to its length.  If >= 0 on entry, *size* is an upper size\n+// bound that may lead to truncation.\n+Status ConvertToSequenceAndInferSize(PyObject* obj, PyObject** seq, int64_t* size) {\n   if (PySequence_Check(obj)) {\n-    *size = static_cast<int64_t>(PySequence_Size(obj));\n-  } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n+    // obj is already a sequence\n+    int64_t real_size = static_cast<int64_t>(PySequence_Size(obj));\n+    if (*size < 0)\n+      *size = real_size;\n+    else\n+      *size = std::min(real_size, *size);\n+    Py_INCREF(obj);\n+    *seq = obj;\n+  } else if (*size < 0) {\n+    // unknown size, exhaust iterator\n+    *seq = PySequence_List(obj);\n+    RETURN_IF_PYERROR();\n+    *size = static_cast<int64_t>(PyList_GET_SIZE(*seq));\n+  } else {\n+    // size is known but iterator could be infinite\n+    Py_ssize_t i, n = *size;\n     PyObject* iter = PyObject_GetIter(obj);\n+    RETURN_IF_PYERROR();\n     OwnedRef iter_ref(iter);\n-    *size = 0;\n-    PyObject* item;\n-    while ((item = PyIter_Next(iter))) {\n-      OwnedRef item_ref(item);\n-      *size += 1;\n+    PyObject* lst = PyList_New(n);\n+    RETURN_IF_PYERROR();\n+    for (i = 0; i < n; i++) {\n+      PyObject* item = PyIter_Next(iter);\n+      if (!item) break;\n+      PyList_SET_ITEM(lst, i, item);\n     }\n-  } else {\n-    return Status::TypeError(\"Object is not a sequence or iterable\");\n-  }\n-  if (PyErr_Occurred()) {\n-    // Not a sequence\n-    PyErr_Clear();\n-    return Status::TypeError(\"Object is not a sequence or iterable\");\n+    // Shrink list if len(iterator) < size\n+    if (i < n && PyList_SetSlice(lst, i, n, NULL)) {\n+      Py_DECREF(lst);\n+      return Status::UnknownError(\"failed to resize list\");\n+    }\n+    *seq = lst;\n+    *size = std::min(static_cast<int64_t>(i), *size);\n \n Review comment:\n   NB. you can also indicate what `std::min` you want, e.g. `std::min<int64_t>`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.559+0000",
                    "updated": "2018-01-29T22:50:45.559+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344147",
                    "id": "16344147",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164589586\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -830,38 +821,51 @@ Status AppendPySequence(PyObject* obj, int64_t size,\n   return converter->AppendData(obj, size);\n }\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out) {\n+static Status ConvertPySequenceReal(PyObject* obj, MemoryPool* pool,\n+                                    std::shared_ptr<Array>* out,\n+                                    const std::shared_ptr<DataType>* type, int64_t size) {\n   PyAcquireGIL lock;\n-  std::shared_ptr<DataType> type;\n-  int64_t size;\n-  RETURN_NOT_OK(InferArrowTypeAndSize(obj, &size, &type));\n-  return ConvertPySequence(obj, pool, out, type, size);\n-}\n+  ScopedRef seqref;\n+  std::shared_ptr<DataType> real_type;\n+\n+  RETURN_NOT_OK(ConvertToSequenceAndInferSize(obj, seqref.ref(), &size));\n \n Review comment:\n   I think `seqref.ref()` is only writable on account of `const PyObject*` being unwieldy -- it might be less awkward to pass a mutable pointer to `seqref`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.561+0000",
                    "updated": "2018-01-29T22:50:45.561+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344148",
                    "id": "16344148",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164587632\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -285,25 +273,44 @@ class SeqVisitor {\n   }\n };\n \n-Status InferArrowSize(PyObject* obj, int64_t* size) {\n+// Convert *obj* to a sequence if necessary\n+// Fill *size* to its length.  If >= 0 on entry, *size* is an upper size\n+// bound that may lead to truncation.\n+Status ConvertToSequenceAndInferSize(PyObject* obj, PyObject** seq, int64_t* size) {\n   if (PySequence_Check(obj)) {\n-    *size = static_cast<int64_t>(PySequence_Size(obj));\n-  } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n+    // obj is already a sequence\n+    int64_t real_size = static_cast<int64_t>(PySequence_Size(obj));\n+    if (*size < 0)\n+      *size = real_size;\n+    else\n+      *size = std::min(real_size, *size);\n \n Review comment:\n   These should have braces -- I would have thought that clang-format would add them but maybe not\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.562+0000",
                    "updated": "2018-01-29T22:50:45.562+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344149",
                    "id": "16344149",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164589964\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.h\n ##########\n @@ -53,7 +53,12 @@ ARROW_EXPORT arrow::Status AppendPySequence(PyObject* obj, int64_t size,\n ARROW_EXPORT\n Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out);\n \n-// Size inference\n+// Type inference only\n+ARROW_EXPORT\n+Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out,\n+                         int64_t size);\n \n Review comment:\n   Nit: argument order\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.563+0000",
                    "updated": "2018-01-29T22:50:45.563+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344150",
                    "id": "16344150",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164589629\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -830,38 +821,51 @@ Status AppendPySequence(PyObject* obj, int64_t size,\n   return converter->AppendData(obj, size);\n }\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out) {\n+static Status ConvertPySequenceReal(PyObject* obj, MemoryPool* pool,\n+                                    std::shared_ptr<Array>* out,\n+                                    const std::shared_ptr<DataType>* type, int64_t size) {\n \n Review comment:\n   This `size` argument should precede the \"out\" arguments (https://google.github.io/styleguide/cppguide.html#Function_Parameter_Ordering)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.564+0000",
                    "updated": "2018-01-29T22:50:45.564+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344151",
                    "id": "16344151",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164588063\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -285,25 +273,44 @@ class SeqVisitor {\n   }\n };\n \n-Status InferArrowSize(PyObject* obj, int64_t* size) {\n+// Convert *obj* to a sequence if necessary\n+// Fill *size* to its length.  If >= 0 on entry, *size* is an upper size\n+// bound that may lead to truncation.\n+Status ConvertToSequenceAndInferSize(PyObject* obj, PyObject** seq, int64_t* size) {\n   if (PySequence_Check(obj)) {\n-    *size = static_cast<int64_t>(PySequence_Size(obj));\n-  } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n+    // obj is already a sequence\n+    int64_t real_size = static_cast<int64_t>(PySequence_Size(obj));\n+    if (*size < 0)\n+      *size = real_size;\n+    else\n+      *size = std::min(real_size, *size);\n+    Py_INCREF(obj);\n+    *seq = obj;\n+  } else if (*size < 0) {\n+    // unknown size, exhaust iterator\n+    *seq = PySequence_List(obj);\n \n Review comment:\n   I'm not sure how esoteric infinite iterators are in practice; at some point we might want some kind of \"maximum size\" to prevent hanging here\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.577+0000",
                    "updated": "2018-01-29T22:50:45.577+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344152",
                    "id": "16344152",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#discussion_r164589820\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -830,38 +821,51 @@ Status AppendPySequence(PyObject* obj, int64_t size,\n   return converter->AppendData(obj, size);\n }\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out) {\n+static Status ConvertPySequenceReal(PyObject* obj, MemoryPool* pool,\n+                                    std::shared_ptr<Array>* out,\n+                                    const std::shared_ptr<DataType>* type, int64_t size) {\n   PyAcquireGIL lock;\n-  std::shared_ptr<DataType> type;\n-  int64_t size;\n-  RETURN_NOT_OK(InferArrowTypeAndSize(obj, &size, &type));\n-  return ConvertPySequence(obj, pool, out, type, size);\n-}\n+  ScopedRef seqref;\n+  std::shared_ptr<DataType> real_type;\n+\n+  RETURN_NOT_OK(ConvertToSequenceAndInferSize(obj, seqref.ref(), &size));\n+  if (type == nullptr) {\n+    RETURN_NOT_OK(InferArrowType(seqref.get(), &real_type));\n+  } else {\n+    real_type = *type;\n+  }\n+  assert(size >= 0);\n \n Review comment:\n   If this is a \"can't fail\" check; use `DCHECK_GE`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-29T22:50:45.701+0000",
                    "updated": "2018-01-29T22:50:45.701+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344464",
                    "id": "16344464",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361469505\n \n \n   I'm going to try to fix these issues right now so we can get this merged, and then your other PR rebased tomorrow\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T03:55:38.936+0000",
                    "updated": "2018-01-30T03:55:38.936+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344465",
                    "id": "16344465",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361469793\n \n \n   @pitrou for future reference -- we prefer rebase to merge when updating from upstream, as it makes incremental PR maintenance a little bit easier\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T03:57:42.142+0000",
                    "updated": "2018-01-30T03:57:42.142+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344478",
                    "id": "16344478",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361472638\n \n \n   @xhochy @pitrou OK this is good to go once the build runs\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T04:19:30.485+0000",
                    "updated": "2018-01-30T04:19:30.485+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344820",
                    "id": "16344820",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361548019\n \n \n   > @pitrou for future reference -- we prefer rebase to merge when updating from upstream, as it makes incremental PR maintenance a little bit easier\r\n   \r\n   Hmm, that's weird. IME rebasing produces lots of spurious conflicts when trying to reconcile other changes.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T10:21:18.697+0000",
                    "updated": "2018-01-30T10:21:18.697+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344829",
                    "id": "16344829",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361550291\n \n \n   Unrelated, but FTR, the Travis-CI connectivity issues have an issue open at https://github.com/travis-ci/travis-ci/issues/9112\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T10:29:19.805+0000",
                    "updated": "2018-01-30T10:29:19.805+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344860",
                    "id": "16344860",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361548019\n \n \n   > @pitrou for future reference -- we prefer rebase to merge when updating from upstream, as it makes incremental PR maintenance a little bit easier\r\n   \r\n   Hmm, that's weird. IME rebasing produces lots of spurious conflicts when trying to reconcile other changes.\r\n   \r\n   For example trying to rebase or merge PR #1530 over the latest changes in this PR now produces lots of conflicts.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T10:48:11.637+0000",
                    "updated": "2018-01-30T10:48:11.637+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344950",
                    "id": "16344950",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361572341\n \n \n   @pitrou Thank you for the reference to the Travis issue. I've retrigged all tests that were failed because of that, we're still waiting for AppVeyor. Once that is done, I'll merge.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T11:59:29.900+0000",
                    "updated": "2018-01-30T11:59:29.900+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16344984",
                    "id": "16344984",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361583301\n \n \n   One Travis-CI job has failed with `pyarrow.lib.ArrowIOError: Could not connect to socket /tmp/plasma_store47336278`. Also that job was unexpected slow:\r\n   https://travis-ci.org/apache/arrow/jobs/335088022\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T12:48:05.526+0000",
                    "updated": "2018-01-30T12:48:05.526+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16345068",
                    "id": "16345068",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361583301\n \n \n   One Travis-CI job has failed with `pyarrow.lib.ArrowIOError: Could not connect to socket /tmp/plasma_store47336278`. Also that job was unexpectedly slow:\r\n   https://travis-ci.org/apache/arrow/jobs/335088022\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T14:01:46.044+0000",
                    "updated": "2018-01-30T14:01:46.044+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16345199",
                    "id": "16345199",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513#issuecomment-361624360\n \n \n   That was https://issues.apache.org/jira/browse/ARROW-1880 striking again. We haven't figured out yet what causes that, but it seems to be the Travis CI VMs having limited resources\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T15:14:54.091+0000",
                    "updated": "2018-01-30T15:14:54.091+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16345202",
                    "id": "16345202",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1513: ARROW-2033: [Python] Fix pa.array() with iterator input\nURL: https://github.com/apache/arrow/pull/1513\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/python/builtin_convert.cc b/cpp/src/arrow/python/builtin_convert.cc\nindex f7a370cdc..b41c55d9c 100644\n--- a/cpp/src/arrow/python/builtin_convert.cc\n+++ b/cpp/src/arrow/python/builtin_convert.cc\n@@ -172,38 +172,26 @@ class SeqVisitor {\n   Status Visit(PyObject* obj, int level = 0) {\n     max_nesting_level_ = std::max(max_nesting_level_, level);\n \n-    // Loop through either a sequence or an iterator.\n-    if (PySequence_Check(obj)) {\n-      Py_ssize_t size = PySequence_Size(obj);\n-      for (int64_t i = 0; i < size; ++i) {\n-        OwnedRef ref;\n-        if (PyArray_Check(obj)) {\n-          auto array = reinterpret_cast<PyArrayObject*>(obj);\n-          auto ptr = reinterpret_cast<const char*>(PyArray_GETPTR1(array, i));\n-\n-          ref.reset(PyArray_GETITEM(array, ptr));\n-          RETURN_IF_PYERROR();\n+    // Loop through a sequence\n+    if (!PySequence_Check(obj))\n+      return Status::TypeError(\"Object is not a sequence or iterable\");\n \n-          RETURN_NOT_OK(VisitElem(ref, level));\n-        } else {\n-          ref.reset(PySequence_GetItem(obj, i));\n-          RETURN_IF_PYERROR();\n-          RETURN_NOT_OK(VisitElem(ref, level));\n-        }\n-      }\n-    } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n-      OwnedRef iter(PyObject_GetIter(obj));\n-      RETURN_IF_PYERROR();\n+    Py_ssize_t size = PySequence_Size(obj);\n+    for (int64_t i = 0; i < size; ++i) {\n+      OwnedRef ref;\n+      if (PyArray_Check(obj)) {\n+        auto array = reinterpret_cast<PyArrayObject*>(obj);\n+        auto ptr = reinterpret_cast<const char*>(PyArray_GETPTR1(array, i));\n \n-      PyObject* item = NULLPTR;\n-      while ((item = PyIter_Next(iter.obj()))) {\n+        ref.reset(PyArray_GETITEM(array, ptr));\n         RETURN_IF_PYERROR();\n \n-        OwnedRef ref(item);\n+        RETURN_NOT_OK(VisitElem(ref, level));\n+      } else {\n+        ref.reset(PySequence_GetItem(obj, i));\n+        RETURN_IF_PYERROR();\n         RETURN_NOT_OK(VisitElem(ref, level));\n       }\n-    } else {\n-      return Status::TypeError(\"Object is not a sequence or iterable\");\n     }\n     return Status::OK();\n   }\n@@ -285,25 +273,45 @@ class SeqVisitor {\n   }\n };\n \n-Status InferArrowSize(PyObject* obj, int64_t* size) {\n+// Convert *obj* to a sequence if necessary\n+// Fill *size* to its length.  If >= 0 on entry, *size* is an upper size\n+// bound that may lead to truncation.\n+Status ConvertToSequenceAndInferSize(PyObject* obj, PyObject** seq, int64_t* size) {\n   if (PySequence_Check(obj)) {\n-    *size = static_cast<int64_t>(PySequence_Size(obj));\n-  } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n+    // obj is already a sequence\n+    int64_t real_size = static_cast<int64_t>(PySequence_Size(obj));\n+    if (*size < 0) {\n+      *size = real_size;\n+    } else {\n+      *size = std::min(real_size, *size);\n+    }\n+    Py_INCREF(obj);\n+    *seq = obj;\n+  } else if (*size < 0) {\n+    // unknown size, exhaust iterator\n+    *seq = PySequence_List(obj);\n+    RETURN_IF_PYERROR();\n+    *size = static_cast<int64_t>(PyList_GET_SIZE(*seq));\n+  } else {\n+    // size is known but iterator could be infinite\n+    Py_ssize_t i, n = *size;\n     PyObject* iter = PyObject_GetIter(obj);\n+    RETURN_IF_PYERROR();\n     OwnedRef iter_ref(iter);\n-    *size = 0;\n-    PyObject* item;\n-    while ((item = PyIter_Next(iter))) {\n-      OwnedRef item_ref(item);\n-      *size += 1;\n+    PyObject* lst = PyList_New(n);\n+    RETURN_IF_PYERROR();\n+    for (i = 0; i < n; i++) {\n+      PyObject* item = PyIter_Next(iter);\n+      if (!item) break;\n+      PyList_SET_ITEM(lst, i, item);\n     }\n-  } else {\n-    return Status::TypeError(\"Object is not a sequence or iterable\");\n-  }\n-  if (PyErr_Occurred()) {\n-    // Not a sequence\n-    PyErr_Clear();\n-    return Status::TypeError(\"Object is not a sequence or iterable\");\n+    // Shrink list if len(iterator) < size\n+    if (i < n && PyList_SetSlice(lst, i, n, NULL)) {\n+      Py_DECREF(lst);\n+      return Status::UnknownError(\"failed to resize list\");\n+    }\n+    *seq = lst;\n+    *size = std::min<int64_t>(i, *size);\n   }\n   return Status::OK();\n }\n@@ -325,7 +333,10 @@ Status InferArrowType(PyObject* obj, std::shared_ptr<DataType>* out_type) {\n \n Status InferArrowTypeAndSize(PyObject* obj, int64_t* size,\n                              std::shared_ptr<DataType>* out_type) {\n-  RETURN_NOT_OK(InferArrowSize(obj, size));\n+  if (!PySequence_Check(obj)) {\n+    return Status::TypeError(\"Object is not a sequence\");\n+  }\n+  *size = static_cast<int64_t>(PySequence_Size(obj));\n \n   // For 0-length sequences, refuse to guess\n   if (*size == 0) {\n@@ -382,27 +393,8 @@ class TypedConverterVisitor : public TypedConverter<BuilderType> {\n           RETURN_NOT_OK(static_cast<Derived*>(this)->AppendItem(ref));\n         }\n       }\n-    } else if (PyObject_HasAttrString(obj, \"__iter__\")) {\n-      PyObject* iter = PyObject_GetIter(obj);\n-      OwnedRef iter_ref(iter);\n-      PyObject* item;\n-      int64_t i = 0;\n-      // To allow people with long generators to only convert a subset, stop\n-      // consuming at size.\n-      while ((item = PyIter_Next(iter)) && i < size) {\n-        OwnedRef ref(item);\n-        if (ref.obj() == Py_None) {\n-          RETURN_NOT_OK(this->typed_builder_->AppendNull());\n-        } else {\n-          RETURN_NOT_OK(static_cast<Derived*>(this)->AppendItem(ref));\n-        }\n-        ++i;\n-      }\n-      if (size != i) {\n-        RETURN_NOT_OK(this->typed_builder_->Resize(i));\n-      }\n     } else {\n-      return Status::TypeError(\"Object is not a sequence or iterable\");\n+      return Status::TypeError(\"Object is not a sequence\");\n     }\n     return Status::OK();\n   }\n@@ -830,38 +822,56 @@ Status AppendPySequence(PyObject* obj, int64_t size,\n   return converter->AppendData(obj, size);\n }\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out) {\n+static Status ConvertPySequenceReal(PyObject* obj, int64_t size,\n+                                    const std::shared_ptr<DataType>* type,\n+                                    MemoryPool* pool, std::shared_ptr<Array>* out) {\n   PyAcquireGIL lock;\n-  std::shared_ptr<DataType> type;\n-  int64_t size;\n-  RETURN_NOT_OK(InferArrowTypeAndSize(obj, &size, &type));\n-  return ConvertPySequence(obj, pool, out, type, size);\n-}\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out,\n-                         const std::shared_ptr<DataType>& type, int64_t size) {\n-  PyAcquireGIL lock;\n+  PyObject* seq;\n+  ScopedRef tmp_seq_nanny;\n+\n+  std::shared_ptr<DataType> real_type;\n+\n+  RETURN_NOT_OK(ConvertToSequenceAndInferSize(obj, &seq, &size));\n+  tmp_seq_nanny.reset(seq);\n+  if (type == nullptr) {\n+    RETURN_NOT_OK(InferArrowType(seq, &real_type));\n+  } else {\n+    real_type = *type;\n+  }\n+  DCHECK_GE(size, 0);\n+\n   // Handle NA / NullType case\n-  if (type->id() == Type::NA) {\n+  if (real_type->id() == Type::NA) {\n     out->reset(new NullArray(size));\n     return Status::OK();\n   }\n \n   // Give the sequence converter an array builder\n   std::unique_ptr<ArrayBuilder> builder;\n-  RETURN_NOT_OK(MakeBuilder(pool, type, &builder));\n-  RETURN_NOT_OK(AppendPySequence(obj, size, type, builder.get()));\n+  RETURN_NOT_OK(MakeBuilder(pool, real_type, &builder));\n+  RETURN_NOT_OK(AppendPySequence(seq, size, real_type, builder.get()));\n   return builder->Finish(out);\n }\n \n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out,\n-                         const std::shared_ptr<DataType>& type) {\n-  int64_t size;\n-  {\n-    PyAcquireGIL lock;\n-    RETURN_NOT_OK(InferArrowSize(obj, &size));\n-  }\n-  return ConvertPySequence(obj, pool, out, type, size);\n+Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out) {\n+  return ConvertPySequenceReal(obj, -1, nullptr, pool, out);\n+}\n+\n+Status ConvertPySequence(PyObject* obj, const std::shared_ptr<DataType>& type,\n+                         MemoryPool* pool, std::shared_ptr<Array>* out) {\n+  return ConvertPySequenceReal(obj, -1, &type, pool, out);\n+}\n+\n+Status ConvertPySequence(PyObject* obj, int64_t size, MemoryPool* pool,\n+                         std::shared_ptr<Array>* out) {\n+  return ConvertPySequenceReal(obj, size, nullptr, pool, out);\n+}\n+\n+Status ConvertPySequence(PyObject* obj, int64_t size,\n+                         const std::shared_ptr<DataType>& type, MemoryPool* pool,\n+                         std::shared_ptr<Array>* out) {\n+  return ConvertPySequenceReal(obj, size, &type, pool, out);\n }\n \n Status CheckPythonBytesAreFixedLength(PyObject* obj, Py_ssize_t expected_length) {\ndiff --git a/cpp/src/arrow/python/builtin_convert.h b/cpp/src/arrow/python/builtin_convert.h\nindex cde7a1bd4..4bd3f08ed 100644\n--- a/cpp/src/arrow/python/builtin_convert.h\n+++ b/cpp/src/arrow/python/builtin_convert.h\n@@ -39,11 +39,11 @@ class Status;\n \n namespace py {\n \n+// These three functions take a sequence input, not arbitrary iterables\n ARROW_EXPORT arrow::Status InferArrowType(PyObject* obj,\n                                           std::shared_ptr<arrow::DataType>* out_type);\n ARROW_EXPORT arrow::Status InferArrowTypeAndSize(\n     PyObject* obj, int64_t* size, std::shared_ptr<arrow::DataType>* out_type);\n-ARROW_EXPORT arrow::Status InferArrowSize(PyObject* obj, int64_t* size);\n \n ARROW_EXPORT arrow::Status AppendPySequence(PyObject* obj, int64_t size,\n                                             const std::shared_ptr<arrow::DataType>& type,\n@@ -53,15 +53,21 @@ ARROW_EXPORT arrow::Status AppendPySequence(PyObject* obj, int64_t size,\n ARROW_EXPORT\n Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out);\n \n-// Size inference\n+// Type inference only\n ARROW_EXPORT\n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out,\n-                         const std::shared_ptr<DataType>& type);\n+Status ConvertPySequence(PyObject* obj, int64_t size, MemoryPool* pool,\n+                         std::shared_ptr<Array>* out);\n+\n+// Size inference only\n+ARROW_EXPORT\n+Status ConvertPySequence(PyObject* obj, const std::shared_ptr<DataType>& type,\n+                         MemoryPool* pool, std::shared_ptr<Array>* out);\n \n // No inference\n ARROW_EXPORT\n-Status ConvertPySequence(PyObject* obj, MemoryPool* pool, std::shared_ptr<Array>* out,\n-                         const std::shared_ptr<DataType>& type, int64_t size);\n+Status ConvertPySequence(PyObject* obj, int64_t size,\n+                         const std::shared_ptr<DataType>& type, MemoryPool* pool,\n+                         std::shared_ptr<Array>* out);\n \n ARROW_EXPORT\n Status InvalidConversion(PyObject* obj, const std::string& expected_type_name,\ndiff --git a/python/pyarrow/array.pxi b/python/pyarrow/array.pxi\nindex cca942588..caeefd2ff 100644\n--- a/python/pyarrow/array.pxi\n+++ b/python/pyarrow/array.pxi\n@@ -21,14 +21,21 @@ cdef _sequence_to_array(object sequence, object size, DataType type,\n     cdef shared_ptr[CArray] out\n     cdef int64_t c_size\n     if type is None:\n-        with nogil:\n-            check_status(ConvertPySequence(sequence, pool, &out))\n+        if size is None:\n+            with nogil:\n+                check_status(ConvertPySequence(sequence, pool, &out))\n+        else:\n+            c_size = size\n+            with nogil:\n+                check_status(\n+                    ConvertPySequence(sequence, c_size, pool, &out)\n+                )\n     else:\n         if size is None:\n             with nogil:\n                 check_status(\n                     ConvertPySequence(\n-                        sequence, pool, &out, type.sp_type\n+                        sequence, type.sp_type, pool, &out,\n                     )\n                 )\n         else:\n@@ -36,7 +43,7 @@ cdef _sequence_to_array(object sequence, object size, DataType type,\n             with nogil:\n                 check_status(\n                     ConvertPySequence(\n-                        sequence, pool, &out, type.sp_type, c_size\n+                        sequence, c_size, type.sp_type, pool, &out,\n                     )\n                 )\n \ndiff --git a/python/pyarrow/includes/libarrow.pxd b/python/pyarrow/includes/libarrow.pxd\nindex 91bc96dc6..2e83f0701 100644\n--- a/python/pyarrow/includes/libarrow.pxd\n+++ b/python/pyarrow/includes/libarrow.pxd\n@@ -852,13 +852,14 @@ cdef extern from \"arrow/python/api.h\" namespace \"arrow::py\" nogil:\n     shared_ptr[CDataType] GetTimestampType(TimeUnit unit)\n     CStatus ConvertPySequence(object obj, CMemoryPool* pool,\n                               shared_ptr[CArray]* out)\n-    CStatus ConvertPySequence(object obj, CMemoryPool* pool,\n-                              shared_ptr[CArray]* out,\n-                              const shared_ptr[CDataType]& type)\n-    CStatus ConvertPySequence(object obj, CMemoryPool* pool,\n-                              shared_ptr[CArray]* out,\n+    CStatus ConvertPySequence(object obj, const shared_ptr[CDataType]& type,\n+                              CMemoryPool* pool, shared_ptr[CArray]* out)\n+    CStatus ConvertPySequence(object obj, int64_t size, CMemoryPool* pool,\n+                              shared_ptr[CArray]* out)\n+    CStatus ConvertPySequence(object obj, int64_t size,\n                               const shared_ptr[CDataType]& type,\n-                              int64_t size)\n+                              CMemoryPool* pool,\n+                              shared_ptr[CArray]* out)\n \n     CStatus NumPyDtypeToArrow(object dtype, shared_ptr[CDataType]* type)\n \ndiff --git a/python/pyarrow/tests/test_convert_builtin.py b/python/pyarrow/tests/test_convert_builtin.py\nindex fa603b1a9..2b317dfbc 100644\n--- a/python/pyarrow/tests/test_convert_builtin.py\n+++ b/python/pyarrow/tests/test_convert_builtin.py\n@@ -23,6 +23,7 @@\n \n import datetime\n import decimal\n+import itertools\n import numpy as np\n import six\n \n@@ -68,6 +69,24 @@ def test_limited_iterator_size_underflow():\n     assert arr1.equals(arr2)\n \n \n+def test_iterator_without_size():\n+    expected = pa.array((0, 1, 2))\n+    arr1 = pa.array(iter(range(3)))\n+    assert arr1.equals(expected)\n+    # Same with explicit type\n+    arr1 = pa.array(iter(range(3)), type=pa.int64())\n+    assert arr1.equals(expected)\n+\n+\n+def test_infinite_iterator():\n+    expected = pa.array((0, 1, 2))\n+    arr1 = pa.array(itertools.count(0), size=3)\n+    assert arr1.equals(expected)\n+    # Same with explicit type\n+    arr1 = pa.array(itertools.count(0), type=pa.int64(), size=3)\n+    assert arr1.equals(expected)\n+\n+\n def _as_list(xs):\n     return xs\n \n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-30T15:17:01.709+0000",
                    "updated": "2018-01-30T15:17:01.709+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13133651/comment/16345203",
                    "id": "16345203",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1513\n[https://github.com/apache/arrow/pull/1513]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-01-30T15:17:03.469+0000",
                    "updated": "2018-01-30T15:17:03.469+0000"
                }
            ],
            "maxResults": 25,
            "total": 25,
            "startAt": 0
        },
        "customfield_12311820": "0|i3pcn3:",
        "customfield_12314139": null
    }
}