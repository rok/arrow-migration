{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13312272",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272",
    "key": "ARROW-9176",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12347769",
                "id": "12347769",
                "description": "",
                "name": "1.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-07-24"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=m18e",
            "name": "m18e",
            "key": "m18e",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Max Burke",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "name": "Closed",
            "id": "6",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=m18e",
            "name": "m18e",
            "key": "m18e",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Max Burke",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=m18e",
            "name": "m18e",
            "key": "m18e",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Max Burke",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9176/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 12,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/447904",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke opened a new pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480\n\n\n   If realloc is passed a block of size zero, free the block and return the\r\n   address of the bypass block.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-18T16:28:31.639+0000",
                    "updated": "2020-06-18T16:28:31.639+0000",
                    "started": "2020-06-18T16:28:31.638+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "447904",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/447906",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#issuecomment-646148492\n\n\n   https://issues.apache.org/jira/browse/ARROW-9176\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-18T16:32:30.730+0000",
                    "updated": "2020-06-18T16:32:30.730+0000",
                    "started": "2020-06-18T16:32:30.730+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "447906",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448014",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#discussion_r442475621\n\n\n\n##########\nFile path: rust/arrow/src/memory.rs\n##########\n@@ -150,25 +150,32 @@ pub fn allocate_aligned(size: usize) -> *mut u8 {\n }\n \n pub unsafe fn free_aligned(ptr: *mut u8, size: usize) {\n-    if size != 0x00 && ptr != BYPASS_PTR.as_ptr() {\n+    if ptr != BYPASS_PTR.as_ptr() {\n         std::alloc::dealloc(ptr, Layout::from_size_align_unchecked(size, ALIGNMENT));\n     }\n }\n \n pub unsafe fn reallocate(ptr: *mut u8, old_size: usize, new_size: usize) -> *mut u8 {\n     if ptr == BYPASS_PTR.as_ptr() {\n-        allocate_aligned(new_size)\n-    } else {\n-        let new_ptr = std::alloc::realloc(\n-            ptr,\n-            Layout::from_size_align_unchecked(old_size, ALIGNMENT),\n-            new_size,\n-        );\n-        if !new_ptr.is_null() && new_size > old_size {\n-            new_ptr.add(old_size).write_bytes(0, new_size - old_size);\n-        }\n-        new_ptr\n+        return allocate_aligned(new_size);\n+    }\n+\n+    if new_size == 0 {\n+        free_aligned(ptr, old_size);\n+        return BYPASS_PTR.as_ptr();\n\nReview comment:\n       good catch, would be good to add a test for this.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-18T20:10:23.194+0000",
                    "updated": "2020-06-18T20:10:23.194+0000",
                    "started": "2020-06-18T20:10:23.194+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448014",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448258",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke closed pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-19T04:48:58.406+0000",
                    "updated": "2020-06-19T04:48:58.406+0000",
                    "started": "2020-06-19T04:48:58.406+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448258",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448259",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke commented on pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#issuecomment-646432538\n\n\n   Seeing some weird issues in long running applications; there are no leaks as reported by valgrind anymore, but memory use is up. I'm going to close this PR for now.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-19T04:49:01.342+0000",
                    "updated": "2020-06-19T04:49:01.342+0000",
                    "started": "2020-06-19T04:49:01.342+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448259",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448595",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke opened a new pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480\n\n\n   If realloc is passed a block of size zero, free the block and return the\r\n   address of the bypass block.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-19T17:17:53.636+0000",
                    "updated": "2020-06-19T17:17:53.636+0000",
                    "started": "2020-06-19T17:17:53.636+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448595",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448596",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke commented on pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#issuecomment-646766294\n\n\n   Re-opening this PR because the memory use changes are related to our use of the underlying system allocator, not this change.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-19T17:17:56.346+0000",
                    "updated": "2020-06-19T17:17:56.346+0000",
                    "started": "2020-06-19T17:17:56.346+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448596",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448791",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "maxburke commented on a change in pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#discussion_r443139838\n\n\n\n##########\nFile path: rust/arrow/src/memory.rs\n##########\n@@ -150,25 +150,32 @@ pub fn allocate_aligned(size: usize) -> *mut u8 {\n }\n \n pub unsafe fn free_aligned(ptr: *mut u8, size: usize) {\n-    if size != 0x00 && ptr != BYPASS_PTR.as_ptr() {\n+    if ptr != BYPASS_PTR.as_ptr() {\n         std::alloc::dealloc(ptr, Layout::from_size_align_unchecked(size, ALIGNMENT));\n     }\n }\n \n pub unsafe fn reallocate(ptr: *mut u8, old_size: usize, new_size: usize) -> *mut u8 {\n     if ptr == BYPASS_PTR.as_ptr() {\n-        allocate_aligned(new_size)\n-    } else {\n-        let new_ptr = std::alloc::realloc(\n-            ptr,\n-            Layout::from_size_align_unchecked(old_size, ALIGNMENT),\n-            new_size,\n-        );\n-        if !new_ptr.is_null() && new_size > old_size {\n-            new_ptr.add(old_size).write_bytes(0, new_size - old_size);\n-        }\n-        new_ptr\n+        return allocate_aligned(new_size);\n+    }\n+\n+    if new_size == 0 {\n+        free_aligned(ptr, old_size);\n+        return BYPASS_PTR.as_ptr();\n\nReview comment:\n       What kind of test are you looking for? Running valgrind on the tests to validate there are no leaked blocks?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-20T15:40:25.455+0000",
                    "updated": "2020-06-20T15:40:25.455+0000",
                    "started": "2020-06-20T15:40:25.455+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448791",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448795",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#discussion_r443140804\n\n\n\n##########\nFile path: rust/arrow/src/memory.rs\n##########\n@@ -150,25 +150,32 @@ pub fn allocate_aligned(size: usize) -> *mut u8 {\n }\n \n pub unsafe fn free_aligned(ptr: *mut u8, size: usize) {\n-    if size != 0x00 && ptr != BYPASS_PTR.as_ptr() {\n+    if ptr != BYPASS_PTR.as_ptr() {\n         std::alloc::dealloc(ptr, Layout::from_size_align_unchecked(size, ALIGNMENT));\n     }\n }\n \n pub unsafe fn reallocate(ptr: *mut u8, old_size: usize, new_size: usize) -> *mut u8 {\n     if ptr == BYPASS_PTR.as_ptr() {\n-        allocate_aligned(new_size)\n-    } else {\n-        let new_ptr = std::alloc::realloc(\n-            ptr,\n-            Layout::from_size_align_unchecked(old_size, ALIGNMENT),\n-            new_size,\n-        );\n-        if !new_ptr.is_null() && new_size > old_size {\n-            new_ptr.add(old_size).write_bytes(0, new_size - old_size);\n-        }\n-        new_ptr\n+        return allocate_aligned(new_size);\n+    }\n+\n+    if new_size == 0 {\n+        free_aligned(ptr, old_size);\n+        return BYPASS_PTR.as_ptr();\n\nReview comment:\n       At first i thought there is straightforward api from the global allocator we can use to access memory allocation metadata. This turned out not to be the case, which means we will either have to introduce valgrind or change rust global allocator to a custom one for tests. Both approaches will expand the scope of this PR too much, so scratch what I said, I think it's better to be done as a separate PRs.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-20T15:55:57.542+0000",
                    "updated": "2020-06-20T15:55:57.542+0000",
                    "started": "2020-06-20T15:55:57.541+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448795",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448796",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#discussion_r443140804\n\n\n\n##########\nFile path: rust/arrow/src/memory.rs\n##########\n@@ -150,25 +150,32 @@ pub fn allocate_aligned(size: usize) -> *mut u8 {\n }\n \n pub unsafe fn free_aligned(ptr: *mut u8, size: usize) {\n-    if size != 0x00 && ptr != BYPASS_PTR.as_ptr() {\n+    if ptr != BYPASS_PTR.as_ptr() {\n         std::alloc::dealloc(ptr, Layout::from_size_align_unchecked(size, ALIGNMENT));\n     }\n }\n \n pub unsafe fn reallocate(ptr: *mut u8, old_size: usize, new_size: usize) -> *mut u8 {\n     if ptr == BYPASS_PTR.as_ptr() {\n-        allocate_aligned(new_size)\n-    } else {\n-        let new_ptr = std::alloc::realloc(\n-            ptr,\n-            Layout::from_size_align_unchecked(old_size, ALIGNMENT),\n-            new_size,\n-        );\n-        if !new_ptr.is_null() && new_size > old_size {\n-            new_ptr.add(old_size).write_bytes(0, new_size - old_size);\n-        }\n-        new_ptr\n+        return allocate_aligned(new_size);\n+    }\n+\n+    if new_size == 0 {\n+        free_aligned(ptr, old_size);\n+        return BYPASS_PTR.as_ptr();\n\nReview comment:\n       At first i thought there are straightforward apis from the global allocator we can use to access memory allocation metadata. This turned out not to be the case, which means we will either have to introduce valgrind or change rust global allocator to a custom one for tests. Both approaches will expand the scope of this PR too much, so scratch what I said, I think it's better to be done as a separate PRs.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-20T15:56:10.090+0000",
                    "updated": "2020-06-20T15:56:10.090+0000",
                    "started": "2020-06-20T15:56:10.090+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448796",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448917",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran commented on a change in pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480#discussion_r443242626\n\n\n\n##########\nFile path: rust/arrow/src/memory.rs\n##########\n@@ -150,25 +150,32 @@ pub fn allocate_aligned(size: usize) -> *mut u8 {\n }\n \n pub unsafe fn free_aligned(ptr: *mut u8, size: usize) {\n-    if size != 0x00 && ptr != BYPASS_PTR.as_ptr() {\n+    if ptr != BYPASS_PTR.as_ptr() {\n         std::alloc::dealloc(ptr, Layout::from_size_align_unchecked(size, ALIGNMENT));\n     }\n }\n \n pub unsafe fn reallocate(ptr: *mut u8, old_size: usize, new_size: usize) -> *mut u8 {\n     if ptr == BYPASS_PTR.as_ptr() {\n-        allocate_aligned(new_size)\n-    } else {\n-        let new_ptr = std::alloc::realloc(\n-            ptr,\n-            Layout::from_size_align_unchecked(old_size, ALIGNMENT),\n-            new_size,\n-        );\n-        if !new_ptr.is_null() && new_size > old_size {\n-            new_ptr.add(old_size).write_bytes(0, new_size - old_size);\n-        }\n-        new_ptr\n+        return allocate_aligned(new_size);\n+    }\n+\n+    if new_size == 0 {\n+        free_aligned(ptr, old_size);\n+        return BYPASS_PTR.as_ptr();\n\nReview comment:\n       I guess we could start running valgrind in CI for Rust?  I don't use Valgrind but I created an [issue](https://issues.apache.org/jira/browse/ARROW-9200) if anyone wants to pick it up.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-21T18:03:41.628+0000",
                    "updated": "2020-06-21T18:03:41.628+0000",
                    "started": "2020-06-21T18:03:41.628+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448917",
                    "issueId": "13312272"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13312272/worklog/448918",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran closed pull request #7480:\nURL: https://github.com/apache/arrow/pull/7480\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-21T18:05:54.401+0000",
                    "updated": "2020-06-21T18:05:54.401+0000",
                    "started": "2020-06-21T18:05:54.401+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "448918",
                    "issueId": "13312272"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 7200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4f582733[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6c78912f[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@797c82d2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5125853b[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@60e37fe3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@d084761[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@107f2e00[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6d0e6d69[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@16690b4c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@599565af[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@30f34fb3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2e0809e1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 7200,
        "customfield_12312520": null,
        "customfield_12312521": "2020-06-18 16:28:07.0",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-06-21T18:07:36.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9176/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2020-06-18T16:28:07.000+0000",
        "updated": "2020-06-21T18:07:36.000+0000",
        "timeoriginalestimate": null,
        "description": "See Github PR:\u00a0[https://github.com/apache/arrow/pull/7480]",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 7200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] Fix for memory leaks in Arrow allocator",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [],
            "maxResults": 0,
            "total": 0,
            "startAt": 0
        },
        "customfield_12311820": "0|z0fzqo:",
        "customfield_12314139": null
    }
}