{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13103232",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232",
    "key": "ARROW-1555",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/5",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/trivial.svg",
            "name": "Trivial",
            "id": "5"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341141",
                "id": "12341141",
                "name": "0.7.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-09-17"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=benjigoldberg",
            "name": "benjigoldberg",
            "key": "benjigoldberg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=benjigoldberg&avatarId=33360",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=benjigoldberg&avatarId=33360",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=benjigoldberg&avatarId=33360",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=benjigoldberg&avatarId=33360"
            },
            "displayName": "Benjamin Goldberg",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=yjk21",
            "name": "yjk21",
            "key": "yjk21",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Young-Jun Ko",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=yjk21",
            "name": "yjk21",
            "key": "yjk21",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Young-Jun Ko",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1555/votes",
            "votes": 1,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6d9be17d[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4233c95c[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@10236ae4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4c863895[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@13e770c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3e752a0f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@350a036f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@48b5c7cb[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@60fcff49[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@77ce840b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@123ae0e6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7457e6f5[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Oct 27 11:31:33 UTC 2017",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2017-10-27T02:59:02.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1555/watchers",
            "watchCount": 6,
            "isWatching": false
        },
        "created": "2017-09-19T13:12:25.000+0000",
        "updated": "2019-06-03T12:48:59.000+0000",
        "timeoriginalestimate": null,
        "description": "When writing a arrow table to s3, I get an NotImplemented Exception.\nThe root cause is in _ensure_filesystem and can be reproduced as follows:\n\nimport pyarrow\nimport pyarrow.parquet as pqa\nimport s3fs\n\ns3 = s3fs.S3FileSystem()\n\npqa._ensure_filesystem(s3).exists(\"anything\")\n\nIt appears that the S3FSWrapper that is instantiated in _ensure_filesystem does not expose the exist method of s3.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] write_to_dataset on s3",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16171755",
                    "id": "16171755",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "cc [~fjetter]\n\nThis may not be too hard to fix -- I don't think that {{parquet.write_to_dataset}} has been tested with S3, so a patch to make this S3-friendly would be welcome. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-09-19T14:01:56.402+0000",
                    "updated": "2017-09-19T14:01:56.402+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16172076",
                    "id": "16172076",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fjetter",
                        "name": "fjetter",
                        "key": "fjetter",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Florian Jetter",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~wesmckinn] Yes, it seems like some abstract methods of the FileSystem class (exists, open, etc.)  were not implemented in the wrapper. I'll take care of it",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fjetter",
                        "name": "fjetter",
                        "key": "fjetter",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Florian Jetter",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-09-19T17:42:21.359+0000",
                    "updated": "2017-09-19T17:42:21.359+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16172142",
                    "id": "16172142",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "{{exists}} is a hard one. It may be better to try to fix the implementation of {{write_to_dataset}} to not use methods like {{exists}} that are not S3-friendly\n\nhttps://github.com/apache/arrow/blob/master/python/pyarrow/parquet.py#L920",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-09-19T18:34:31.052+0000",
                    "updated": "2017-09-19T18:34:31.052+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16172932",
                    "id": "16172932",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=yjk21",
                        "name": "yjk21",
                        "key": "yjk21",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Young-Jun Ko",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I think the simplest way to fix this would be to just expose the fs functions implemented by `s3fs`, `exists` being one of them. I suppose that's what Florian had in mind.\n\nThanks guys for looking into this!\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=yjk21",
                        "name": "yjk21",
                        "key": "yjk21",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Young-Jun Ko",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-09-20T09:05:34.850+0000",
                    "updated": "2017-09-20T09:05:34.850+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215275",
                    "id": "16215275",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=benjigoldberg",
                        "name": "benjigoldberg",
                        "key": "benjigoldberg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=benjigoldberg&avatarId=33360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=benjigoldberg&avatarId=33360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=benjigoldberg&avatarId=33360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=benjigoldberg&avatarId=33360"
                        },
                        "displayName": "Benjamin Goldberg",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I created a PR to resolve this issue:\r\nhttps://github.com/apache/arrow/pull/1240",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=benjigoldberg",
                        "name": "benjigoldberg",
                        "key": "benjigoldberg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=benjigoldberg&avatarId=33360",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=benjigoldberg&avatarId=33360",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=benjigoldberg&avatarId=33360",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=benjigoldberg&avatarId=33360"
                        },
                        "displayName": "Benjamin Goldberg",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T15:10:39.549+0000",
                    "updated": "2017-10-23T15:10:39.549+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215362",
                    "id": "16215362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146317602\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   Does this need to be `self.fs.exists(path)`?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T16:11:45.818+0000",
                    "updated": "2017-10-23T16:11:45.818+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215371",
                    "id": "16215371",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146318772\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   @wesm yes \ud83e\udd26\u200d\u2642\ufe0f \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T16:16:07.008+0000",
                    "updated": "2017-10-23T16:16:07.008+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215401",
                    "id": "16215401",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "johnjiang commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146322137\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   I wrote my own wrapper to get around this issue and I realised that pyarrow would try and create a directory if 'exists' returns False. This is an issue on s3 since there's no concept of directories. So what ends up happening is that there's a duplicate file with the same name as the directory.\r\n   You almost need to remove the `exists()` check for s3 filesystem.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T16:28:51.645+0000",
                    "updated": "2017-10-23T16:28:51.645+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215413",
                    "id": "16215413",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146323847\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   Yeah, I did not implement exists because of this issue. This needs to be tested against S3 before being merged\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T16:35:47.550+0000",
                    "updated": "2017-10-23T16:35:47.550+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215465",
                    "id": "16215465",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146332399\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   Oh thats interesting @johnjiang \r\n   \r\n   I will test this with S3 as @wesm suggested and see if I can come up with a solution that is satisfactory.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T17:09:09.659+0000",
                    "updated": "2017-10-23T17:09:09.659+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215645",
                    "id": "16215645",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146360160\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -251,6 +251,10 @@ def isfile(self, path):\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return os.path.exists(path)\n \n Review comment:\n   @wesm @johnjiang I added a new attribute to `FileSystem` which simply indicates whether the FileSystem is an object-store or a file-store. Then added an additional param to the mkdir conditional in `write_to_dataset` to check if the `FileSystem` is a File store before attempting to call `mkdir`. I imagine that tiny method could come in handy to distinguish other features between object/file stores later. Let me know if that addresses your concerns, otherwise happy to try something else out.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T18:53:04.750+0000",
                    "updated": "2017-10-23T18:53:04.750+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215665",
                    "id": "16215665",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "johnjiang commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146362289\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -985,7 +985,7 @@ def write_to_dataset(table, root_path, partition_cols=None,\n     else:\n         fs = _ensure_filesystem(filesystem)\n \n-    if not fs.exists(root_path):\n+    if not fs.exists(root_path) and fs.isfilestore():\n \n Review comment:\n   Would be better to switch the checks around\r\n   \r\n   ```\r\n    if fs.isfilestore() and not fs.exists(root_path) :\r\n   ```\r\n   \r\n   That way we don't do an unnecessary `exists()` check if it's not a file store.`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T19:00:45.051+0000",
                    "updated": "2017-10-23T19:00:45.051+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16215670",
                    "id": "16215670",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r146362868\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -985,7 +985,7 @@ def write_to_dataset(table, root_path, partition_cols=None,\n     else:\n         fs = _ensure_filesystem(filesystem)\n \n-    if not fs.exists(root_path):\n+    if not fs.exists(root_path) and fs.isfilestore():\n \n Review comment:\n   Yes, great point! Updated.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-23T19:02:57.311+0000",
                    "updated": "2017-10-23T19:02:57.311+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16219911",
                    "id": "16219911",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r147039732\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -135,6 +135,12 @@ def isfile(self, path):\n         \"\"\"\n         raise NotImplementedError\n \n+    def isfilestore(self):\n \n Review comment:\n   Can you make this a private API (`_isfilestore`)? Unclear if normal users would need this\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T03:40:12.577+0000",
                    "updated": "2017-10-26T03:40:12.577+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16219913",
                    "id": "16219913",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#issuecomment-339542169\n \n \n   Build looks ok, the failure is unrelated (I restarted the failing job anyway so we can get a green build)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T03:41:00.940+0000",
                    "updated": "2017-10-26T03:41:00.940+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16220597",
                    "id": "16220597",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on a change in pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#discussion_r147173669\n \n \n\n ##########\n File path: python/pyarrow/filesystem.py\n ##########\n @@ -135,6 +135,12 @@ def isfile(self, path):\n         \"\"\"\n         raise NotImplementedError\n \n+    def isfilestore(self):\n \n Review comment:\n   \ud83d\udc4d  updated\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T15:12:17.646+0000",
                    "updated": "2017-10-26T15:12:17.646+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16220999",
                    "id": "16220999",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#issuecomment-339761765\n \n \n   Rebased and fixed flake8 warnings\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:45:50.296+0000",
                    "updated": "2017-10-26T18:45:50.296+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16221632",
                    "id": "16221632",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#issuecomment-339858655\n \n \n   +1\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-27T02:55:11.194+0000",
                    "updated": "2017-10-27T02:55:11.194+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16221635",
                    "id": "16221635",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/pyarrow/filesystem.py b/python/pyarrow/filesystem.py\nindex 8d2d8fcd3..926df0e30 100644\n--- a/python/pyarrow/filesystem.py\n+++ b/python/pyarrow/filesystem.py\n@@ -135,6 +135,13 @@ def isfile(self, path):\n         \"\"\"\n         raise NotImplementedError\n \n+    def _isfilestore(self):\n+        \"\"\"\n+        Returns True if this FileSystem is a unix-style file store with\n+        directories.\n+        \"\"\"\n+        raise NotImplementedError\n+\n     def read_parquet(self, path, columns=None, metadata=None, schema=None,\n                      nthreads=1, use_pandas_metadata=False):\n         \"\"\"\n@@ -209,6 +216,10 @@ def isdir(self, path):\n     def isfile(self, path):\n         return os.path.isfile(path)\n \n+    @implements(FileSystem._isfilestore)\n+    def _isfilestore(self):\n+        return True\n+\n     @implements(FileSystem.exists)\n     def exists(self, path):\n         return os.path.exists(path)\n@@ -247,10 +258,22 @@ def isdir(self, path):\n     def isfile(self, path):\n         raise NotImplementedError(\"Unsupported file system API\")\n \n+    @implements(FileSystem._isfilestore)\n+    def _isfilestore(self):\n+        \"\"\"\n+        Object Stores like S3 and GCSFS are based on key lookups, not true\n+        file-paths\n+        \"\"\"\n+        return False\n+\n     @implements(FileSystem.delete)\n     def delete(self, path, recursive=False):\n         return self.fs.rm(path, recursive=recursive)\n \n+    @implements(FileSystem.exists)\n+    def exists(self, path):\n+        return self.fs.exists(path)\n+\n     @implements(FileSystem.mkdir)\n     def mkdir(self, path):\n         return self.fs.mkdir(path)\ndiff --git a/python/pyarrow/parquet.py b/python/pyarrow/parquet.py\nindex 0a40f5fb7..9dcc30c8a 100644\n--- a/python/pyarrow/parquet.py\n+++ b/python/pyarrow/parquet.py\n@@ -985,7 +985,7 @@ def write_to_dataset(table, root_path, partition_cols=None,\n     else:\n         fs = _ensure_filesystem(filesystem)\n \n-    if not fs.exists(root_path):\n+    if fs._isfilestore() and not fs.exists(root_path):\n         fs.mkdir(root_path)\n \n     if partition_cols is not None and len(partition_cols) > 0:\n@@ -1004,7 +1004,7 @@ def write_to_dataset(table, root_path, partition_cols=None,\n             subtable = Table.from_pandas(subgroup,\n                                          preserve_index=preserve_index)\n             prefix = \"/\".join([root_path, subdir])\n-            if not fs.exists(prefix):\n+            if fs._isfilestore() and not fs.exists(prefix):\n                 fs.mkdir(prefix)\n             outfile = compat.guid() + \".parquet\"\n             full_path = \"/\".join([prefix, outfile])\ndiff --git a/python/pyarrow/tests/test_parquet.py b/python/pyarrow/tests/test_parquet.py\nindex 09184cc05..a7fe98ce7 100644\n--- a/python/pyarrow/tests/test_parquet.py\n+++ b/python/pyarrow/tests/test_parquet.py\n@@ -978,6 +978,7 @@ def _visit_level(base_dir, level, part_keys):\n                 part_table = pa.Table.from_pandas(filtered_df)\n                 with fs.open(file_path, 'wb') as f:\n                     _write_table(part_table, f)\n+                assert fs.exists(file_path)\n             else:\n                 _visit_level(level_dir, level + 1, this_part_keys)\n \n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-27T02:59:01.597+0000",
                    "updated": "2017-10-27T02:59:01.597+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16221636",
                    "id": "16221636",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1240\n[https://github.com/apache/arrow/pull/1240]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-10-27T02:59:02.617+0000",
                    "updated": "2017-10-27T02:59:02.617+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16221637",
                    "id": "16221637",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#issuecomment-339859299\n \n \n   @benjigoldberg thanks for your contribution. Could you let me know your JIRA id (or create an ID if you don't have one) so I can assign this issue to you on https://issues.apache.org/jira/browse/ARROW-1555?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-27T03:00:15.759+0000",
                    "updated": "2017-10-27T03:00:15.759+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13103232/comment/16222196",
                    "id": "16222196",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "benjigoldberg commented on issue #1240: ARROW-1555 [Python] Implement Dask exists function\nURL: https://github.com/apache/arrow/pull/1240#issuecomment-339946849\n \n \n   @wesm my username on JIRA is `benjigoldberg`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-27T11:31:33.126+0000",
                    "updated": "2017-10-27T11:31:33.126+0000"
                }
            ],
            "maxResults": 22,
            "total": 22,
            "startAt": 0
        },
        "customfield_12311820": "0|i3k8gf:",
        "customfield_12314139": null
    }
}