{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13357660",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660",
    "key": "ARROW-11565",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12614950",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12614950",
                "type": {
                    "id": "12310361",
                    "name": "Blocked",
                    "inward": "Blocked",
                    "outward": "Blocked",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310361"
                },
                "outwardIssue": {
                    "id": "13375669",
                    "key": "ARROW-12592",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13375669",
                    "fields": {
                        "summary": "[C++][Gandiva] Implement INIT_CAP function",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/5",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/trivial.svg",
                            "name": "Trivial",
                            "id": "5"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sagnikc",
            "name": "sagnikc",
            "key": "sagnikc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Sagnik Chakraborty",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12334626",
                "id": "12334626",
                "name": "C++ - Gandiva"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sagnikc",
            "name": "sagnikc",
            "key": "sagnikc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Sagnik Chakraborty",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sagnikc",
            "name": "sagnikc",
            "key": "sagnikc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Sagnik Chakraborty",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 19800,
            "total": 19800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 19800,
            "total": 19800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11565/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 33,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/553375",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-780292793\n\n\n   https://issues.apache.org/jira/browse/ARROW-11565\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-17T04:39:38.526+0000",
                    "updated": "2021-02-17T04:39:38.526+0000",
                    "started": "2021-02-17T04:39:38.525+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553375",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556307",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pprudhvi commented on a change in pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#discussion_r581000055\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -219,28 +225,74 @@ const char* upper_utf8(gdv_int64 context, const char* data, gdv_int32 data_len,\n     return \"\";\n   }\n \n-  char* ret = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, data_len));\n-  if (ret == nullptr) {\n+  // If it is a single-byte character (ASCII), corresponding uppercase is always 1-byte\n+  // long; if it is >= 2 bytes long, uppercase can be at most 4 bytes long, so length of\n+  // the output can be at most twice the length of the input\n+  char* out = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, 2 * data_len));\n+  if (out == nullptr) {\n     gdv_fn_context_set_error_msg(context, \"Could not allocate memory for output string\");\n     *out_len = 0;\n     return \"\";\n   }\n-  for (gdv_int32 i = 0; i < data_len; ++i) {\n-    char cur = data[i];\n \n-    // 'A- - 'Z' : 0x41 - 0x5a\n-    // 'a' - 'z' : 0x61 - 0x7a\n-    if (cur >= 0x61 && cur <= 0x7a) {\n-      cur = static_cast<char>(cur - 0x20);\n+  gdv_int32 char_len, out_char_len, out_idx = 0;\n+  gdv_uint32 char_codepoint;\n+\n+  for (gdv_int32 i = 0; i < data_len; i += char_len) {\n+    char_len = utf8_char_length(data[i]);\n+    // For single byte characters:\n+    // If it is a lowercase ASCII character, set the output to its corresponding uppercase\n+    // character; else, set the output to the read character\n+    if (char_len == 1) {\n+      char cur = data[i];\n+      // 'A' - 'Z' : 0x41 - 0x5a\n+      // 'a' - 'z' : 0x61 - 0x7a\n+      if (cur >= 0x61 && cur <= 0x7a) {\n+        out[out_idx++] = static_cast<char>(cur - 0x20);\n+      } else {\n+        out[out_idx++] = cur;\n+      }\n+      continue;\n+    }\n+\n+    // Control reaches here when we encounter a multibyte character\n+    gdv_uint8* in_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, char_len));\n+    memcpy(in_char, data + i, char_len);\n\nReview comment:\n       can we avoid this by passing reference to data+i to UTF8Decode? similarily while encoding\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T12:37:32.319+0000",
                    "updated": "2021-02-23T12:37:32.319+0000",
                    "started": "2021-02-23T12:37:32.318+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556307",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556754",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio commented on a change in pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#discussion_r581644640\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -219,28 +225,74 @@ const char* upper_utf8(gdv_int64 context, const char* data, gdv_int32 data_len,\n     return \"\";\n   }\n \n-  char* ret = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, data_len));\n-  if (ret == nullptr) {\n+  // If it is a single-byte character (ASCII), corresponding uppercase is always 1-byte\n+  // long; if it is >= 2 bytes long, uppercase can be at most 4 bytes long, so length of\n+  // the output can be at most twice the length of the input\n+  char* out = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, 2 * data_len));\n+  if (out == nullptr) {\n     gdv_fn_context_set_error_msg(context, \"Could not allocate memory for output string\");\n     *out_len = 0;\n     return \"\";\n   }\n-  for (gdv_int32 i = 0; i < data_len; ++i) {\n-    char cur = data[i];\n \n-    // 'A- - 'Z' : 0x41 - 0x5a\n-    // 'a' - 'z' : 0x61 - 0x7a\n-    if (cur >= 0x61 && cur <= 0x7a) {\n-      cur = static_cast<char>(cur - 0x20);\n+  gdv_int32 char_len, out_char_len, out_idx = 0;\n+  gdv_uint32 char_codepoint;\n+\n+  for (gdv_int32 i = 0; i < data_len; i += char_len) {\n+    char_len = utf8_char_length(data[i]);\n+    // For single byte characters:\n+    // If it is a lowercase ASCII character, set the output to its corresponding uppercase\n+    // character; else, set the output to the read character\n+    if (char_len == 1) {\n+      char cur = data[i];\n+      // 'A' - 'Z' : 0x41 - 0x5a\n+      // 'a' - 'z' : 0x61 - 0x7a\n+      if (cur >= 0x61 && cur <= 0x7a) {\n+        out[out_idx++] = static_cast<char>(cur - 0x20);\n+      } else {\n+        out[out_idx++] = cur;\n+      }\n+      continue;\n+    }\n+\n+    // Control reaches here when we encounter a multibyte character\n+    gdv_uint8* in_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, char_len));\n+    memcpy(in_char, data + i, char_len);\n\nReview comment:\n       Done.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T05:54:08.168+0000",
                    "updated": "2021-02-24T05:54:08.168+0000",
                    "started": "2021-02-24T05:54:08.167+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556754",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556762",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pprudhvi commented on a change in pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#discussion_r581658737\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -249,25 +297,73 @@ const char* lower_utf8(gdv_int64 context, const char* data, gdv_int32 data_len,\n     return \"\";\n   }\n \n-  char* ret = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, data_len));\n-  if (ret == nullptr) {\n+  // If it is a single-byte character (ASCII), corresponding lowercase is always 1-byte\n+  // long; if it is >= 2 bytes long, lowercase can be at most 4 bytes long, so length of\n+  // the output can be at most twice the length of the input\n+  char* out = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, 2 * data_len));\n+  if (out == nullptr) {\n     gdv_fn_context_set_error_msg(context, \"Could not allocate memory for output string\");\n     *out_len = 0;\n     return \"\";\n   }\n-  for (gdv_int32 i = 0; i < data_len; ++i) {\n-    char cur = data[i];\n \n-    // 'A' - 'Z' : 0x41 - 0x5a\n-    // 'a' - 'z' : 0x61 - 0x7a\n-    if (cur >= 0x41 && cur <= 0x5a) {\n-      cur = static_cast<char>(cur + 0x20);\n+  gdv_int32 char_len, out_char_len, out_idx = 0;\n+  gdv_uint32 char_codepoint;\n+\n+  for (gdv_int32 i = 0; i < data_len; i += char_len) {\n+    char_len = utf8_char_length(data[i]);\n+    // For single byte characters:\n+    // If it is an uppercase ASCII character, set the output to its corresponding\n+    // lowercase character; else, set the output to the read character\n+    if (char_len == 1) {\n+      char cur = data[i];\n+      // 'A' - 'Z' : 0x41 - 0x5a\n+      // 'a' - 'z' : 0x61 - 0x7a\n+      if (cur >= 0x41 && cur <= 0x5a) {\n+        out[out_idx++] = static_cast<char>(cur + 0x20);\n+      } else {\n+        out[out_idx++] = cur;\n+      }\n+      continue;\n+    }\n+\n+    // Control reaches here when we encounter a multibyte character\n+    gdv_uint8* in_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, char_len));\n\nReview comment:\n       this can be avoided\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -249,25 +297,73 @@ const char* lower_utf8(gdv_int64 context, const char* data, gdv_int32 data_len,\n     return \"\";\n   }\n \n-  char* ret = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, data_len));\n-  if (ret == nullptr) {\n+  // If it is a single-byte character (ASCII), corresponding lowercase is always 1-byte\n+  // long; if it is >= 2 bytes long, lowercase can be at most 4 bytes long, so length of\n+  // the output can be at most twice the length of the input\n+  char* out = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, 2 * data_len));\n+  if (out == nullptr) {\n     gdv_fn_context_set_error_msg(context, \"Could not allocate memory for output string\");\n     *out_len = 0;\n     return \"\";\n   }\n-  for (gdv_int32 i = 0; i < data_len; ++i) {\n-    char cur = data[i];\n \n-    // 'A' - 'Z' : 0x41 - 0x5a\n-    // 'a' - 'z' : 0x61 - 0x7a\n-    if (cur >= 0x41 && cur <= 0x5a) {\n-      cur = static_cast<char>(cur + 0x20);\n+  gdv_int32 char_len, out_char_len, out_idx = 0;\n+  gdv_uint32 char_codepoint;\n+\n+  for (gdv_int32 i = 0; i < data_len; i += char_len) {\n+    char_len = utf8_char_length(data[i]);\n+    // For single byte characters:\n+    // If it is an uppercase ASCII character, set the output to its corresponding\n+    // lowercase character; else, set the output to the read character\n+    if (char_len == 1) {\n+      char cur = data[i];\n+      // 'A' - 'Z' : 0x41 - 0x5a\n+      // 'a' - 'z' : 0x61 - 0x7a\n+      if (cur >= 0x41 && cur <= 0x5a) {\n+        out[out_idx++] = static_cast<char>(cur + 0x20);\n+      } else {\n+        out[out_idx++] = cur;\n+      }\n+      continue;\n+    }\n+\n+    // Control reaches here when we encounter a multibyte character\n+    gdv_uint8* in_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, char_len));\n+    memcpy(in_char, data + i, char_len);\n+\n+    // Decode the multibyte character\n+    bool is_valid_utf8_char =\n+        arrow::util::UTF8Decode((const uint8_t**)&in_char, &char_codepoint);\n+\n+    // If it is an invalid utf8 character, UTF8Decode evaluates to false\n+    if (!is_valid_utf8_char) {\n+      set_error_for_invalid_utf(context, data[i]);\n+      *out_len = 0;\n+      return \"\";\n     }\n-    ret[i] = cur;\n+\n+    // Convert the encoded codepoint to its lowercase codepoint\n+    gdv_int32 lower_codepoint = utf8proc_tolower(char_codepoint);\n+\n+    // UTF8Encode advances the pointer by the number of bytes present in the lowercase\n+    // character\n+    gdv_uint8* out_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, 4));\n\nReview comment:\n       this too\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T06:16:09.728+0000",
                    "updated": "2021-02-24T06:16:09.728+0000",
                    "started": "2021-02-24T06:16:09.727+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556762",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556763",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio commented on a change in pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#discussion_r581661888\n\n\n\n##########\nFile path: cpp/src/gandiva/precompiled/string_ops.cc\n##########\n@@ -249,25 +297,73 @@ const char* lower_utf8(gdv_int64 context, const char* data, gdv_int32 data_len,\n     return \"\";\n   }\n \n-  char* ret = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, data_len));\n-  if (ret == nullptr) {\n+  // If it is a single-byte character (ASCII), corresponding lowercase is always 1-byte\n+  // long; if it is >= 2 bytes long, lowercase can be at most 4 bytes long, so length of\n+  // the output can be at most twice the length of the input\n+  char* out = reinterpret_cast<char*>(gdv_fn_context_arena_malloc(context, 2 * data_len));\n+  if (out == nullptr) {\n     gdv_fn_context_set_error_msg(context, \"Could not allocate memory for output string\");\n     *out_len = 0;\n     return \"\";\n   }\n-  for (gdv_int32 i = 0; i < data_len; ++i) {\n-    char cur = data[i];\n \n-    // 'A' - 'Z' : 0x41 - 0x5a\n-    // 'a' - 'z' : 0x61 - 0x7a\n-    if (cur >= 0x41 && cur <= 0x5a) {\n-      cur = static_cast<char>(cur + 0x20);\n+  gdv_int32 char_len, out_char_len, out_idx = 0;\n+  gdv_uint32 char_codepoint;\n+\n+  for (gdv_int32 i = 0; i < data_len; i += char_len) {\n+    char_len = utf8_char_length(data[i]);\n+    // For single byte characters:\n+    // If it is an uppercase ASCII character, set the output to its corresponding\n+    // lowercase character; else, set the output to the read character\n+    if (char_len == 1) {\n+      char cur = data[i];\n+      // 'A' - 'Z' : 0x41 - 0x5a\n+      // 'a' - 'z' : 0x61 - 0x7a\n+      if (cur >= 0x41 && cur <= 0x5a) {\n+        out[out_idx++] = static_cast<char>(cur + 0x20);\n+      } else {\n+        out[out_idx++] = cur;\n+      }\n+      continue;\n+    }\n+\n+    // Control reaches here when we encounter a multibyte character\n+    gdv_uint8* in_char =\n+        reinterpret_cast<gdv_uint8*>(gdv_fn_context_arena_malloc(context, char_len));\n\nReview comment:\n       Yeah I'm sorry, I missed that one. Made the changes.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T06:24:20.848+0000",
                    "updated": "2021-02-24T06:24:20.848+0000",
                    "started": "2021-02-24T06:24:20.847+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556763",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556787",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-784875144\n\n\n   @maartenbreddels @kou\r\n   \r\n   Hi Maarten/Sutou, I am facing some difficulties with respect to adding the utf8proc dependency for the case conversion of utf8 strings. Can you please review this PR and let me know what changes need to be made to address the above build failures?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T07:58:26.284+0000",
                    "updated": "2021-02-24T07:58:26.284+0000",
                    "started": "2021-02-24T07:58:26.283+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556787",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556794",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-784895034\n\n\n   Could you try the following patch?\r\n   \r\n   ```diff\r\n   diff --git a/cpp/cmake_modules/DefineOptions.cmake b/cpp/cmake_modules/DefineOptions.cmake\r\n   index e4df40d61..c0abea7a2 100644\r\n   --- a/cpp/cmake_modules/DefineOptions.cmake\r\n   +++ b/cpp/cmake_modules/DefineOptions.cmake\r\n   @@ -363,7 +363,7 @@ if(\"${CMAKE_SOURCE_DIR}\" STREQUAL \"${CMAKE_CURRENT_SOURCE_DIR}\")\r\n    \r\n      define_option(\r\n        ARROW_WITH_UTF8PROC\r\n   -    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON)\"\r\n   +    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON or ARROW_GANDIVA is ON)\"\r\n        ON)\r\n      define_option(\r\n        ARROW_WITH_RE2\r\n   diff --git a/cpp/src/gandiva/precompiled/CMakeLists.txt b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   index 7343bc052..bc87c5ee6 100644\r\n   --- a/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   +++ b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   @@ -77,6 +77,9 @@ foreach(SRC_FILE ${PRECOMPILED_SRCS})\r\n               ${ARROW_GANDIVA_PC_CXX_FLAGS}\r\n               -I${CMAKE_SOURCE_DIR}/src\r\n               -I${ARROW_BINARY_DIR}/src)\r\n   +  if(ARROW_WITH_UTF8PROC)\r\n   +    list(APPEND PRECOMPILE_COMMAND -DARROW_WITH_UTF8PROC)\r\n   +  endif()\r\n      if(NOT ARROW_USE_NATIVE_INT128)\r\n        list(APPEND PRECOMPILE_COMMAND -I${Boost_INCLUDE_DIR})\r\n      endif()\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T08:17:59.146+0000",
                    "updated": "2021-02-24T08:17:59.146+0000",
                    "started": "2021-02-24T08:17:59.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556794",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556804",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-784925792\n\n\n   > Could you try the following patch?\r\n   > \r\n   > ```diff\r\n   > diff --git a/cpp/cmake_modules/DefineOptions.cmake b/cpp/cmake_modules/DefineOptions.cmake\r\n   > index e4df40d61..c0abea7a2 100644\r\n   > --- a/cpp/cmake_modules/DefineOptions.cmake\r\n   > +++ b/cpp/cmake_modules/DefineOptions.cmake\r\n   > @@ -363,7 +363,7 @@ if(\"${CMAKE_SOURCE_DIR}\" STREQUAL \"${CMAKE_CURRENT_SOURCE_DIR}\")\r\n   >  \r\n   >    define_option(\r\n   >      ARROW_WITH_UTF8PROC\r\n   > -    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON)\"\r\n   > +    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON or ARROW_GANDIVA is ON)\"\r\n   >      ON)\r\n   >    define_option(\r\n   >      ARROW_WITH_RE2\r\n   > diff --git a/cpp/src/gandiva/precompiled/CMakeLists.txt b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   > index 7343bc052..bc87c5ee6 100644\r\n   > --- a/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   > +++ b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   > @@ -77,6 +77,9 @@ foreach(SRC_FILE ${PRECOMPILED_SRCS})\r\n   >             ${ARROW_GANDIVA_PC_CXX_FLAGS}\r\n   >             -I${CMAKE_SOURCE_DIR}/src\r\n   >             -I${ARROW_BINARY_DIR}/src)\r\n   > +  if(ARROW_WITH_UTF8PROC)\r\n   > +    list(APPEND PRECOMPILE_COMMAND -DARROW_WITH_UTF8PROC)\r\n   > +  endif()\r\n   >    if(NOT ARROW_USE_NATIVE_INT128)\r\n   >      list(APPEND PRECOMPILE_COMMAND -I${Boost_INCLUDE_DIR})\r\n   >    endif()\r\n   > ```\r\n   \r\n   @kou The above patch does not seem to work. After adding the option in precompiled/CMakeLists.txt, compilation fails with:\r\n   \r\n   `fatal error: 'utf8proc.h' file not found`\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T09:09:38.138+0000",
                    "updated": "2021-02-24T09:09:38.138+0000",
                    "started": "2021-02-24T09:09:38.137+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556804",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/556805",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio edited a comment on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-784925792\n\n\n   @kou The above patch does not seem to work. After adding the option in precompiled/CMakeLists.txt, compilation fails with:\r\n   \r\n   `fatal error: 'utf8proc.h' file not found`\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T09:10:01.117+0000",
                    "updated": "2021-02-24T09:10:01.117+0000",
                    "started": "2021-02-24T09:10:01.117+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556805",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/557537",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-785413747\n\n\n   How about this?\r\n   \r\n   ```diff\r\n   diff --git a/cpp/cmake_modules/DefineOptions.cmake b/cpp/cmake_modules/DefineOptions.cmake\r\n   index e4df40d61..c0abea7a2 100644\r\n   --- a/cpp/cmake_modules/DefineOptions.cmake\r\n   +++ b/cpp/cmake_modules/DefineOptions.cmake\r\n   @@ -363,7 +363,7 @@ if(\"${CMAKE_SOURCE_DIR}\" STREQUAL \"${CMAKE_CURRENT_SOURCE_DIR}\")\r\n    \r\n      define_option(\r\n        ARROW_WITH_UTF8PROC\r\n   -    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON)\"\r\n   +    \"Build with support for Unicode properties using the utf8proc library;(only used if ARROW_COMPUTE is ON or ARROW_GANDIVA is ON)\"\r\n        ON)\r\n      define_option(\r\n        ARROW_WITH_RE2\r\n   diff --git a/cpp/src/gandiva/precompiled/CMakeLists.txt b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   index 7343bc052..76148a3c7 100644\r\n   --- a/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   +++ b/cpp/src/gandiva/precompiled/CMakeLists.txt\r\n   @@ -77,6 +77,16 @@ foreach(SRC_FILE ${PRECOMPILED_SRCS})\r\n               ${ARROW_GANDIVA_PC_CXX_FLAGS}\r\n               -I${CMAKE_SOURCE_DIR}/src\r\n               -I${ARROW_BINARY_DIR}/src)\r\n   +  if(ARROW_WITH_UTF8PROC)\r\n   +    list(APPEND PRECOMPILE_COMMAND -DARROW_WITH_UTF8PROC)\r\n   +    if(UTF8PROC_COMPILER_DEFINITIONS)\r\n   +      # This doesn't work when multiple definitions exist.\r\n   +      list(APPEND PRECOMPILE_COMMAND \"-D${UTF8PROC_COMPILER_DEFINITIONS}\")\r\n   +    endif()\r\n   +    if(UTF8PROC_INCLUDE_DIR)\r\n   +      list(APPEND PRECOMPILE_COMMAND \"-I${UTF8PROC_INCLUDE_DIR}\")\r\n   +    endif()\r\n   +  endif()\r\n      if(NOT ARROW_USE_NATIVE_INT128)\r\n        list(APPEND PRECOMPILE_COMMAND -I${Boost_INCLUDE_DIR})\r\n      endif()\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T22:01:56.235+0000",
                    "updated": "2021-02-24T22:01:56.235+0000",
                    "started": "2021-02-24T22:01:56.235+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "557537",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/557851",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sagnikc-dremio commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-785798201\n\n\n   @kou This patch seems to resolve the dependency issue. Thanks again.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-25T10:42:05.305+0000",
                    "updated": "2021-02-25T10:42:05.305+0000",
                    "started": "2021-02-25T10:42:05.305+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "557851",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/561895",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "li-wu commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-792167454\n\n\n   Any update for the PR?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-07T02:13:17.633+0000",
                    "updated": "2021-03-07T02:13:17.633+0000",
                    "started": "2021-03-07T02:13:17.633+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "561895",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/561913",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "li-wu edited a comment on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-792167454\n\n\n   Any update for the PR?\r\n   \r\n   I tried with the the code change and build arrow with option `-DARROW_WITH_UTF8PROC=ON` and `-DARROW_GANDIVA=ON`  with  `vcpkg`. When compiling my project with arrow it reports error:\r\n   ```\r\n     \"_utf8proc_tolower\", referenced from:\r\n         arrow::compute::internal::(anonymous namespace)::EnsureLookupTablesFilled()::$_0::operator()() const in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::UTF8Lower<arrow::StringType>::TransformCodepoint(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::UTF8Lower<arrow::LargeStringType>::TransformCodepoint(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsCasedCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsLowerCaseCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsUpperCaseCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n     \"_utf8proc_toupper\", referenced from:\r\n         arrow::compute::internal::(anonymous namespace)::EnsureLookupTablesFilled()::$_0::operator()() const in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::UTF8Upper<arrow::StringType>::TransformCodepoint(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::UTF8Upper<arrow::LargeStringType>::TransformCodepoint(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsCasedCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsLowerCaseCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n         arrow::compute::internal::(anonymous namespace)::IsUpperCaseCharacterUnicode(unsigned int) in libarrow.a(scalar_string.cc.o)\r\n   ld: symbol(s) not found for architecture x86_64\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-07T06:25:20.004+0000",
                    "updated": "2021-03-07T06:25:20.004+0000",
                    "started": "2021-03-07T06:25:20.004+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "561913",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/561953",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "li-wu edited a comment on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-792167454\n\n\n   Any update for the PR? Thanks.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-07T11:45:10.011+0000",
                    "updated": "2021-03-07T11:45:10.011+0000",
                    "started": "2021-03-07T11:45:10.010+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "561953",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/573852",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "projjal commented on pull request #9450:\nURL: https://github.com/apache/arrow/pull/9450#issuecomment-809860443\n\n\n   @sagnikc-dremio The failing test might be because the generated jit code can't resolve the symbols corresponding to the utf8 library. Can you add the function in gdv_fn_stubs and check.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-30T02:37:59.686+0000",
                    "updated": "2021-03-30T02:37:59.686+0000",
                    "started": "2021-03-30T02:37:59.686+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "573852",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/582908",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anthonylouisbsb opened a new pull request #10040:\nURL: https://github.com/apache/arrow/pull/10040\n\n\n   It finishes the implementation that started in the https://github.com/apache/arrow/pull/9450 pull request\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-14T21:08:03.839+0000",
                    "updated": "2021-04-14T21:08:03.839+0000",
                    "started": "2021-04-14T21:08:03.838+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582908",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/582997",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10040:\nURL: https://github.com/apache/arrow/pull/10040#issuecomment-819904003\n\n\n   https://issues.apache.org/jira/browse/ARROW-11565\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-14T23:02:45.025+0000",
                    "updated": "2021-04-14T23:02:45.025+0000",
                    "started": "2021-04-14T23:02:45.025+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582997",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/583403",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anthonylouisbsb commented on pull request #10040:\nURL: https://github.com/apache/arrow/pull/10040#issuecomment-820426704\n\n\n   @projjal The [JNI build](https://github.com/apache/arrow/pull/10040/checks?check_run_id=2352789853) is always failing with a message that the LLVM dependency could not be found. I notice that the same build is not failing in other Pull Requests.\r\n   \r\n   I only added the **utf8proc** dependency inside the Cmake files. I did not remove any dependency from CmakeLists.txt, so do you have any idea why only this building is failing?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-15T13:35:09.008+0000",
                    "updated": "2021-04-15T13:35:09.008+0000",
                    "started": "2021-04-15T13:35:09.008+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "583403",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/586933",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anthonylouisbsb commented on pull request #10040:\nURL: https://github.com/apache/arrow/pull/10040#issuecomment-824388970\n\n\n   @projjal can you close the https://github.com/apache/arrow/pull/9450 Pull Request?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-21T22:07:03.086+0000",
                    "updated": "2021-04-21T22:07:03.086+0000",
                    "started": "2021-04-21T22:07:03.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "586933",
                    "issueId": "13357660"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/worklog/590821",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "projjal commented on a change in pull request #10040:\nURL: https://github.com/apache/arrow/pull/10040#discussion_r622727913\n\n\n\n##########\nFile path: cpp/src/gandiva/gdv_function_stubs.cc\n##########\n@@ -1000,5 +1172,47 @@ void ExportedStubFunctions::AddMappings(Engine* engine) const {\n   engine->AddGlobalMappingForFunc(\"gdv_fn_sha256_decimal128\",\n                                   types->i8_ptr_type() /*return_type*/, args,\n                                   reinterpret_cast<void*>(gdv_fn_sha256_decimal128));\n+\n+  // gdv_fn_utf8_char_length\n+  args = {\n\nReview comment:\n       you don't need to register these here. only upper/lower is enough.\n\n##########\nFile path: ci/scripts/python_wheel_manylinux_build.sh\n##########\n@@ -64,6 +64,7 @@ echo \"=== (${PYTHON_VERSION}) Building Arrow C++ libraries ===\"\n : ${ARROW_WITH_LZ4:=ON}\n : ${ARROW_WITH_SNAPPY:=ON}\n : ${ARROW_WITH_ZLIB:=ON}\n+: ${ARROW_WITH_UTF8PROC:=ON}\n\nReview comment:\n       Are these necessary?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-29T04:39:11.666+0000",
                    "updated": "2021-04-29T04:39:11.666+0000",
                    "started": "2021-04-29T04:39:11.666+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "590821",
                    "issueId": "13357660"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/3",
            "id": "3",
            "description": "A task that needs to be done.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype",
            "name": "Task",
            "subtask": false,
            "avatarId": 21148
        },
        "timespent": 19800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7a0e7388[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@70db7ca1[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20704deb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@be51330[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@68a7a2a0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1e710e48[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c4c0778[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1f13ef52[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4a74fcb2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@5ce1a8fa[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@ca13d9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2305ed[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 19800,
        "customfield_12312520": null,
        "customfield_12312521": "Tue May 25 04:05:19 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-05-25T04:05:19.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11565/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2021-02-09T02:49:21.000+0000",
        "updated": "2021-05-25T05:37:04.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 19800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Gandiva] Modify upper()/lower() to work with UTF8 and add INIT_CAP function",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357660/comment/17350779",
                    "id": "17350779",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=praveenbingo",
                        "name": "praveenbingo",
                        "key": "praveenbingo",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Praveen Kumar",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 10040\n[https://github.com/apache/arrow/pull/10040]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=praveenbingo",
                        "name": "praveenbingo",
                        "key": "praveenbingo",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Praveen Kumar",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-05-25T04:05:19.947+0000",
                    "updated": "2021-05-25T04:05:19.947+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nih4:",
        "customfield_12314139": null
    }
}