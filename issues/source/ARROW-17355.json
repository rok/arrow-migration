{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13475972",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972",
    "key": "ARROW-17355",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351947",
                "id": "12351947",
                "description": "",
                "name": "10.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12648526",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12648526",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13477017",
                    "key": "ARROW-17429",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13477017",
                    "fields": {
                        "summary": "[R] Error messages are not helpful of read_csv_arrow with col_types option",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-17355/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 18,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/805705",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1235303383\n\n   :warning: Ticket **has not been started in JIRA**, please click 'Start Progress'.\n\n\n",
                    "created": "2022-09-02T09:54:14.974+0000",
                    "updated": "2022-09-02T09:54:14.974+0000",
                    "started": "2022-09-02T09:54:14.973+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "805705",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/805706",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1235303353\n\n   https://issues.apache.org/jira/browse/ARROW-17355\n\n\n",
                    "created": "2022-09-02T09:54:16.406+0000",
                    "updated": "2022-09-02T09:54:16.406+0000",
                    "started": "2022-09-02T09:54:16.405+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "805706",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/805708",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r961512745\n\n\n##########\nr/R/util.R:\n##########\n@@ -251,3 +238,19 @@ handle_augmented_field_misuse <- function(e, call) {\n is_compressed <- function(compression) {\n   !identical(compression, \"uncompressed\")\n }\n+\n+# handler function which checks for a number of different read errors\n+augment_io_error_msg <- function(e, call, ...){\n+  dots <- list2(...)\n+  msg <- conditionMessage(e)\n+\n+  if (!is.null(dots[[\"schema\"]])) {\n+    handle_csv_read_error(msg, call, dots[[\"schema\"]])\n+  }\n+  if (!is.null(dots[[\"format\"]])) {\n+    handle_parquet_io_error(msg, call, dots[[\"format\"]])\n+  }\n+\n+  handle_augmented_field_misuse(msg, call)\n+  abort(msg, call = call)\n+}\n\nReview Comment:\n   Not sure if this approach of calling functions conditionally based on which optional arguments are supplied is reasonable or a bit of an anti-pattern.\n\n\n\n",
                    "created": "2022-09-02T10:01:32.655+0000",
                    "updated": "2022-09-02T10:01:32.655+0000",
                    "started": "2022-09-02T10:01:32.655+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "805708",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/806512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1238576314\n\n   Would something even more generic work? Something like \r\n   \r\n   ```\r\n   try_arrow <- function(expr, error_handlers = list()) {\r\n     tryCatch(expr, error = function(e) {\r\n       call <- caller_env(n = 5)\r\n       for (fun in error_handlers) {\r\n         fun(e)\r\n       }\r\n       abort(e, call = call)\r\n     })\r\n   }\r\n   ```\r\n   \r\n   You'd pass a list of functions to check for those error conditions, like:\r\n   \r\n   ```\r\n   try_arrow(\r\n     out <- as_arrow_table(x),\r\n     error_handlers = list(\r\n       handle_csv_read_error, \r\n       handle_augmented_field_misuse\r\n     )\r\n   )\r\n   ```\r\n   \r\n   \n\n\n",
                    "created": "2022-09-06T19:40:38.928+0000",
                    "updated": "2022-09-06T19:40:38.928+0000",
                    "started": "2022-09-06T19:40:38.928+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "806512",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/811570",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1256130557\n\n   > Would something even more generic work? Something like\r\n   > \r\n   > ```\r\n   > try_arrow <- function(expr, error_handlers = list()) {\r\n   >   tryCatch(expr, error = function(e) {\r\n   >     call <- caller_env(n = 5)\r\n   >     for (fun in error_handlers) {\r\n   >       fun(e)\r\n   >     }\r\n   >     abort(e, call = call)\r\n   >   })\r\n   > }\r\n   > ```\r\n   > \r\n   > You'd pass a list of functions to check for those error conditions, like:\r\n   > \r\n   > ```\r\n   > try_arrow(\r\n   >   out <- as_arrow_table(x),\r\n   >   error_handlers = list(\r\n   >     handle_csv_read_error, \r\n   >     handle_augmented_field_misuse\r\n   >   )\r\n   > )\r\n   > ```\r\n   \r\n   I don't think that would work as those functions have different arguments which also need passing in, to provide more context for if the error should be triggered.\n\n\n",
                    "created": "2022-09-23T12:09:16.306+0000",
                    "updated": "2022-09-23T12:09:16.306+0000",
                    "started": "2022-09-23T12:09:16.306+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "811570",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812089",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1257965065\n\n   Thank you for taking this on...I frequently find myself putting a breakpoint in the `handle_csv_read_error()` to figure this kind of stuff out.\r\n   \r\n   I wonder if classed errors can help us here? We `abort(..., class = \"something\")` then `tryCatch(..., something = function(e) { ...handle the special error with a nicer message but with a reference to the original }`. rlang has some tooling to make this relatively straightforward:\r\n   \r\n   ``` r\r\n   rlang::local_interactive()\r\n   \r\n   read_csv <- function() {\r\n     rlang::abort(\"Some message\", class = \"special_csv_read_error\")\r\n   }\r\n   \r\n   some_other_fun <- function() {\r\n     tryCatch({\r\n       read_csv()\r\n     }, special_csv_read_error = function(e) {\r\n       rlang::abort(\"Some new message\", parent = e)\r\n     })\r\n   }\r\n   \r\n   some_other_fun()\r\n   #> Error in `some_other_fun()`:\r\n   #> ! Some new message\r\n   #> Caused by error in `read_csv()`:\r\n   #> ! Some message\r\n   \r\n   rlang::last_error()\r\n   #> Error: Can't show last error because no error was recorded yet\r\n   ```\r\n   \r\n   <sup>Created on 2022-09-26 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n",
                    "created": "2022-09-26T12:32:22.522+0000",
                    "updated": "2022-09-26T12:32:22.522+0000",
                    "started": "2022-09-26T12:32:22.522+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812089",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812091",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1257967614\n\n   (Whoops, in my interactive session I get a nice traceback from `rlang::last_error()`)\n\n\n",
                    "created": "2022-09-26T12:33:53.511+0000",
                    "updated": "2022-09-26T12:33:53.511+0000",
                    "started": "2022-09-26T12:33:53.511+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812091",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812896",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r982375265\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   In the `abort()` below, we should probably be using `abort(msg, call = call, parent = e)`. This will print out the original error, too, in addition to the pretty helpful message. For development it's nice because we generally *are* interested in the error coming from C++.\n\n\n\n##########\nr/R/util.R:\n##########\n@@ -251,3 +235,19 @@ handle_augmented_field_misuse <- function(e, call) {\n is_compressed <- function(compression) {\n   !identical(compression, \"uncompressed\")\n }\n+\n+# handler function which checks for a number of different read errors\n+augment_io_error_msg <- function(e, call, ...) {\n\nReview Comment:\n   ```suggestion\r\n   augment_io_error_msg <- function(e, call, ..., schema = NULL, format = NULL) {\r\n   ```\r\n   \r\n   (then below it becomes `!is.null(schema)` and `!is.null(format)`)\n\n\n\n##########\nr/R/util.R:\n##########\n@@ -209,13 +204,7 @@ repeat_value_as_array <- function(object, n) {\n   return(Scalar$create(object)$as_array(n))\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_csv_read_error <- function(e, schema, call) {\n-  msg <- conditionMessage(e)\n-\n+handle_csv_read_error <- function(msg, call, schema) {\n\nReview Comment:\n   Same as for parquet...I think `abort(msg, call = call, parent = e)` will give a pretty looking error message *and* include the original error.\n\n\n\n##########\nr/R/util.R:\n##########\n@@ -229,12 +218,7 @@ handle_csv_read_error <- function(e, schema, call) {\n   }\n }\n \n-# This function only raises an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_augmented_field_misuse <- function(e, call) {\n-  msg <- conditionMessage(e)\n+handle_augmented_field_misuse <- function(msg, call) {\n\nReview Comment:\n   Maybe use `abort(..., parent = e)` here, too.\n\n\n\n##########\nr/R/util.R:\n##########\n@@ -251,3 +235,19 @@ handle_augmented_field_misuse <- function(e, call) {\n is_compressed <- function(compression) {\n   !identical(compression, \"uncompressed\")\n }\n+\n+# handler function which checks for a number of different read errors\n+augment_io_error_msg <- function(e, call, ...) {\n+  dots <- list2(...)\n+  msg <- conditionMessage(e)\n+\n+  if (!is.null(dots[[\"schema\"]])) {\n+    handle_csv_read_error(msg, call, dots[[\"schema\"]])\n+  }\n+  if (!is.null(dots[[\"format\"]])) {\n+    handle_parquet_io_error(msg, call, dots[[\"format\"]])\n+  }\n+\n+  handle_augmented_field_misuse(msg, call)\n+  abort(msg, call = call)\n\nReview Comment:\n   (no need for parent here since we're not modifying the error)\n\n\n\n",
                    "created": "2022-09-28T13:05:59.012+0000",
                    "updated": "2022-09-28T13:05:59.012+0000",
                    "started": "2022-09-28T13:05:59.012+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812896",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812961",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r982515552\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   The original message is already printed out as we append the helpful message to it.\n\n\n\n",
                    "created": "2022-09-28T14:55:54.782+0000",
                    "updated": "2022-09-28T14:55:54.782+0000",
                    "started": "2022-09-28T14:55:54.782+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812961",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812995",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r982556651\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   OK, I've tried it out both ways, and see what `parent = e` does, but I think it makes more sense the way it prints currently.  What do you think?\r\n   \r\n   The way it looks now:\r\n   ```\r\n   Error in `open_dataset()`:\r\n   ! Invalid: Error creating dataset. Could not read schema from 'file1.csv': Could not open Parquet input source '/tmp/RtmpLed3En/filebe14261f95ab2/5/file1.csv': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/file_parquet.cc:338  GetReader(source, scan_options). Is this a 'parquet' file?\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/discovery.cc:40  InspectSchemas(std::move(options))\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/discovery.cc:262  Inspect(options.inspect_options)\r\n   \u2139 Did you mean to specify a 'format' other than the default (parquet)?\r\n   ```\r\n   \r\n   With `parent = e`:\r\n   \r\n   ```\r\n   Error in `open_dataset()`:\r\n   ! \u2139 Did you mean to specify a 'format' other than the default (parquet)?\r\n   Caused by error:\r\n   ! Invalid: Error creating dataset. Could not read schema from 'file1.csv': Could not open Parquet input source '/tmp/RtmpLed3En/filebe14261f95ab2/5/file1.csv': Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/file_parquet.cc:338  GetReader(source, scan_options). Is this a 'parquet' file?\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/discovery.cc:40  InspectSchemas(std::move(options))\r\n   /home/nic2/arrow/cpp/src/arrow/dataset/discovery.cc:262  Inspect(options.inspect_options)\r\n   Run `rlang::last_error()` to see where the error occurred.\r\n   ```\n\n\n\n",
                    "created": "2022-09-28T15:30:03.776+0000",
                    "updated": "2022-09-28T15:30:03.776+0000",
                    "started": "2022-09-28T15:30:03.776+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812995",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/812996",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1261087203\n\n   > `stop_for_XXXX`\r\n   \r\n   Do you have any examples of these? I did have a look but couldn't find anything.\n\n\n",
                    "created": "2022-09-28T15:31:05.264+0000",
                    "updated": "2022-09-28T15:31:05.264+0000",
                    "started": "2022-09-28T15:31:05.264+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "812996",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813008",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r982581797\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   I rather like the `parent = e` version? The error relevant to the user is  front and centre with a possible cause suggested under. Normally `Caused by error:` contains the `call` from the original error, but we're messing with that. I think that `rlang::last_error()` and `rlang::last_trace()` are both improved with the `parent = e` version, too (I can play with it given a reprex, too).\n\n\n\n",
                    "created": "2022-09-28T15:51:55.551+0000",
                    "updated": "2022-09-28T15:51:55.551+0000",
                    "started": "2022-09-28T15:51:55.550+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813008",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813279",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r983315400\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   My concern here is that this error can be triggered both in the case we test for - the user omits a format specification - and also in the case that they are trying to read from a corrupted file.  If the latter is true, the additional message is not actually helpful and may be misleading.  The additional message coming second helps frame it as a suggestion rather than as the definitive solution to the problem.  \n\n\n\n",
                    "created": "2022-09-29T09:42:17.840+0000",
                    "updated": "2022-09-29T09:42:17.840+0000",
                    "started": "2022-09-29T09:42:17.840+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813279",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813280",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r983315400\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   My concern here is that this error can be triggered both in the case we test for - the user omits a format specification - and also in the case that they are trying to read from a corrupted Parquet file.  If the latter is true, the additional message is not actually helpful and may be misleading.  The additional message coming second helps frame it as a suggestion rather than as the definitive solution to the problem.  \n\n\n\n",
                    "created": "2022-09-29T09:42:52.872+0000",
                    "updated": "2022-09-29T09:42:52.872+0000",
                    "started": "2022-09-29T09:42:52.872+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813280",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813292",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r983315400\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   My concern here is that this error can be triggered both in the case we test for - the user omits the correct format specification and so we use the default (Parquet) - but also in the case that they are trying to read from a corrupted Parquet file.  If the latter is true, the additional message is not actually helpful and may be misleading.  The additional message coming second helps frame it as a suggestion rather than as the definitive solution to the problem.  \n\n\n\n",
                    "created": "2022-09-29T10:22:11.707+0000",
                    "updated": "2022-09-29T10:22:11.707+0000",
                    "started": "2022-09-29T10:22:11.707+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813292",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813324",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on code in PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#discussion_r983499360\n\n\n##########\nr/R/util.R:\n##########\n@@ -134,12 +134,7 @@ read_compressed_error <- function(e) {\n   stop(e)\n }\n \n-# This function was refactored in ARROW-15260 to only raise an error if\n-# the appropriate string was found and so errors must be raised manually after\n-# calling this if matching error not found\n-# TODO: Refactor as part of ARROW-17355 to prevent potential missed errors\n-handle_parquet_io_error <- function(e, format, call) {\n-  msg <- conditionMessage(e)\n+handle_parquet_io_error <- function(msg, call, format) {\n\nReview Comment:\n   Both are a substantial improvement over what we have now...no need to have this PR hung up on that! I tend to be on the debugging end of these error handlers, where I really *do* want to know what the original stack trace was, and I'd hoped that attaching the original error as the `parent` might help with that.\n\n\n\n",
                    "created": "2022-09-29T12:50:40.545+0000",
                    "updated": "2022-09-29T12:50:40.545+0000",
                    "started": "2022-09-29T12:50:40.545+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813324",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813837",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic merged PR #14030:\nURL: https://github.com/apache/arrow/pull/14030\n\n\n",
                    "created": "2022-10-01T08:13:09.456+0000",
                    "updated": "2022-10-01T08:13:09.456+0000",
                    "started": "2022-10-01T08:13:09.455+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813837",
                    "issueId": "13475972"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/worklog/813842",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on PR #14030:\nURL: https://github.com/apache/arrow/pull/14030#issuecomment-1264320640\n\n   Benchmark runs are scheduled for baseline = d60d8c6dd497a7a648ede550f1c7fb9ec63b3d42 and contender = 4dfa61767095b42822293f29b76e97474dbd3aa3. 4dfa61767095b42822293f29b76e97474dbd3aa3 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/cff08f6956f4433db1d699baf1da0778...da2ef2dac94d4ab9bde0d49be05c065b/)\n   [Failed :arrow_down:0.17% :arrow_up:0.0%] [test-mac-arm](https://conbench.ursa.dev/compare/runs/d38270f4004b4c24ae24316dcb45b5b8...f8b03dce6db64816b0dc1d459186bf2e/)\n   [Failed :arrow_down:0.27% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b59bcc9c165a4045b5c9954ce8c9225f...8cbf6645f5d44bbd8ae69d686c2e1ba0/)\n   [Finished :arrow_down:0.32% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/457a055197b54e408b8b9fe9831d9ac4...939abc4912574890942e7311d13719ab/)\n   Buildkite builds:\n   [Finished] [`4dfa6176` ec2-t3-xlarge-us-east-2](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/1607)\n   [Failed] [`4dfa6176` test-mac-arm](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/1626)\n   [Failed] [`4dfa6176` ursa-i9-9960x](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/1609)\n   [Finished] [`4dfa6176` ursa-thinkcentre-m75q](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/1620)\n   [Finished] [`d60d8c6d` ec2-t3-xlarge-us-east-2](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/1606)\n   [Failed] [`d60d8c6d` test-mac-arm](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/1625)\n   [Failed] [`d60d8c6d` ursa-i9-9960x](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/1608)\n   [Finished] [`d60d8c6d` ursa-thinkcentre-m75q](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/1619)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python, R. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n",
                    "created": "2022-10-01T10:31:41.099+0000",
                    "updated": "2022-10-01T10:31:41.099+0000",
                    "started": "2022-10-01T10:31:41.098+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "813842",
                    "issueId": "13475972"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 10800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@756914d4[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76c365d7[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1da8ac0f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@70289fb0[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d117055[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6ba6c1e0[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3336c04f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7d71c86[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@115247f1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4c263dfa[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4917b889[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@761bae01[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10800,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Oct 01 08:13:18 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-10-01T08:13:18.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-17355/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2022-08-09T13:03:31.000+0000",
        "updated": "2022-10-01T10:31:41.000+0000",
        "timeoriginalestimate": null,
        "description": "In ARROW-15260, the utility functions for handling different kinds of reading errors (handle_parquet_io_error, handle_csv_read_error, and handle_augmented_field_misuse) were refactored so that multiple ones could be chained together. An issue with this is that other errors may be swallowed if they're used without any errors that they don't capture being raised manually afterwards.  We should update the code to prevent this from being possible.\r\n\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Refactor the handle_* utility functions for a better dev experience",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13475972/comment/17611838",
                    "id": "17611838",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "Issue resolved by pull request 14030\n[https://github.com/apache/arrow/pull/14030]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2022-10-01T08:13:18.664+0000",
                    "updated": "2022-10-01T08:13:18.664+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z17m3c:",
        "customfield_12314139": null
    }
}