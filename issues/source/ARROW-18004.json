{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13485891",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891",
    "key": "ARROW-18004",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351947",
                "id": "12351947",
                "description": "",
                "name": "10.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12649442",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12649442",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13486167",
                    "key": "ARROW-18037",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13486167",
                    "fields": {
                        "summary": "[C++] Acero/dataset relies on ExecBatch::ToRecordBatch truncating excess columns",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rtpsw",
            "name": "rtpsw",
            "key": "JIRAUSER284707",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER284707&avatarId=49322",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER284707&avatarId=49322",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER284707&avatarId=49322",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER284707&avatarId=49322"
            },
            "displayName": "Yaron Gvili",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rtpsw",
            "name": "rtpsw",
            "key": "JIRAUSER284707",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER284707&avatarId=49322",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER284707&avatarId=49322",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER284707&avatarId=49322",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER284707&avatarId=49322"
            },
            "displayName": "Yaron Gvili",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rtpsw",
            "name": "rtpsw",
            "key": "JIRAUSER284707",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER284707&avatarId=49322",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER284707&avatarId=49322",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER284707&avatarId=49322",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER284707&avatarId=49322"
            },
            "displayName": "Yaron Gvili",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 24000,
            "total": 24000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 24000,
            "total": 24000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-18004/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 40,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816159",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw opened a new pull request, #14386:\nURL: https://github.com/apache/arrow/pull/14386\n\n   See https://issues.apache.org/jira/browse/ARROW-18004\n\n\n",
                    "created": "2022-10-12T13:24:59.766+0000",
                    "updated": "2022-10-12T13:24:59.766+0000",
                    "started": "2022-10-12T13:24:59.765+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816159",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816161",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276179877\n\n   cc @icexelloss @westonpace\n\n\n",
                    "created": "2022-10-12T13:31:32.457+0000",
                    "updated": "2022-10-12T13:31:32.457+0000",
                    "started": "2022-10-12T13:31:32.457+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816161",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816164",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276183261\n\n   Same problem as #14347: this is basically adding a partial, incomplete guard for a condition the caller is supposed to check for themselves.\n\n\n",
                    "created": "2022-10-12T13:34:09.904+0000",
                    "updated": "2022-10-12T13:34:09.904+0000",
                    "started": "2022-10-12T13:34:09.904+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816164",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276185070\n\n   If we wanted to check that the ExecBatch values corresponding to the Schema, we should check for schema equality on each of the Datum values. That can unfortunately be expensive.\n\n\n",
                    "created": "2022-10-12T13:35:28.541+0000",
                    "updated": "2022-10-12T13:35:28.541+0000",
                    "started": "2022-10-12T13:35:28.540+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816165",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816169",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276201896\n\n   > Same problem as #14347: this is basically adding a partial, incomplete guard for a condition the caller is supposed to check for themselves.\r\n   \r\n   > If we wanted to check that the ExecBatch values corresponding to the Schema, we should check for schema equality on each of the Datum values. That can unfortunately be expensive.\r\n   \r\n   To be sure, I understand that by partial incomplete guard you mean not checking for full schema equality. My goal here (and in the PR you linked) is not to fully guard, and I understand the cost of trying to do so. My goal is to avoid runtime crashes that are hard to debug when the cost of doing so is small. IMHO, this PR is a good tradeoff because it uses a cheap check to transform a crash failure to a raised error, which is easier to debug. I run into such crash failures while developing test cases. I agree that when a test case is correct then the failure cases do not occur, yet during development test cases are frequently not correct. Another reason is that developers of large apps would generally prefer an error the app can handle, and perhaps raise to its user, over crashing the app.\n\n\n",
                    "created": "2022-10-12T13:47:45.563+0000",
                    "updated": "2022-10-12T13:47:45.563+0000",
                    "started": "2022-10-12T13:47:45.562+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816169",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816175",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276210638\n\n   > Another reason is that developers of large apps would generally prefer an error the app can handle, and perhaps raise to its user, over crashing the app.\r\n   \r\n   I agree with this, but it is actually misleading here, because we're only checking a single condition and otherwise let errors crash silently (or corrupt memory etc.).\n\n\n",
                    "created": "2022-10-12T13:53:17.678+0000",
                    "updated": "2022-10-12T13:53:17.678+0000",
                    "started": "2022-10-12T13:53:17.677+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816175",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816178",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993497169\n\n\n##########\ncpp/src/arrow/compute/exec_test.cc:\n##########\n@@ -55,6 +55,19 @@ using ::arrow::internal::BitmapEquals;\n using ::arrow::internal::CopyBitmap;\n using ::arrow::internal::CountSetBits;\n \n+TEST(ExecBatch, Basics) {\n+  auto i32_array = ArrayFromJSON(int32(), \"[0, 1, 2]\");\n+  auto utf8_array = ArrayFromJSON(utf8(), R\"([\"a\", \"b\", \"c\"])\");\n+  ExecBatch exec_batch({Datum(i32_array), Datum(utf8_array)}, 3);\n+  auto right_schema = schema({field(\"a\", int32()), field(\"b\", utf8())});\n+  ASSERT_OK_AND_ASSIGN(auto right_record_batch, exec_batch.ToRecordBatch(right_schema));\n+  auto accept_schema = schema({field(\"a\", int32())});\n+  ASSERT_OK_AND_ASSIGN(auto accept_record_batch, exec_batch.ToRecordBatch(accept_schema));\n\nReview Comment:\n   Why would this succeed and produce a truncated result here?\n\n\n\n",
                    "created": "2022-10-12T13:54:32.349+0000",
                    "updated": "2022-10-12T13:54:32.349+0000",
                    "started": "2022-10-12T13:54:32.349+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816178",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816180",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276220334\n\n   Edit: if this avoids an immediate crash and allows you to see `Validate` failing afterwards, then I would be ok with this (but let's not silently truncate output columns either).\n\n\n",
                    "created": "2022-10-12T13:57:14.313+0000",
                    "updated": "2022-10-12T13:57:14.313+0000",
                    "started": "2022-10-12T13:57:14.313+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816180",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816186",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276240482\n\n   >  (but let's not silently truncate output columns either).\r\n   \r\n   Before coding the condition `if (static_cast<size_t>(schema->num_fields()) > values.size())` with `>` I tried coding it with `!=` but got test failures elsewhere:\r\n   ```\r\n   [ RUN      ] ExecPlanExecution.StressSourceOrderBy\r\n   /mnt/user1/tscontract/github/rtpsw/arrow/cpp/src/arrow/compute/exec/plan_test.cc:739: Failure\r\n   Failed\r\n   '_error_or_value56.status()' failed with Invalid: mismatching schema size\r\n   Google Test trace:\r\n   /mnt/user1/tscontract/github/rtpsw/arrow/cpp/src/arrow/compute/exec/plan_test.cc:720: single threaded\r\n   /mnt/user1/tscontract/github/rtpsw/arrow/cpp/src/arrow/compute/exec/plan_test.cc:717: unslowed\r\n   [  FAILED  ] ExecPlanExecution.StressSourceOrderBy (1 ms)\r\n   ```\r\n   and\r\n   ```\r\n   [ RUN      ] Substrait.BasicPlanRoundTrippingEndToEnd\r\n   /mnt/user1/tscontract/github/rtpsw/arrow/cpp/src/arrow/compute/exec/exec_plan.cc:58: Plan was destroyed before finishing\r\n   /mnt/user1/tscontract/github/rtpsw/arrow/cpp/src/arrow/engine/substrait/serde_test.cc:2083: Failure\r\n   Failed\r\n   '_error_or_value131.status()' failed with Invalid: mismatching schema size\r\n   [  FAILED  ] Substrait.BasicPlanRoundTrippingEndToEnd (1 ms)\r\n   ```\r\n   \r\n   If we'd like to fix these test failures, I'd suggest doing so separately.\n\n\n",
                    "created": "2022-10-12T14:05:39.543+0000",
                    "updated": "2022-10-12T14:05:39.543+0000",
                    "started": "2022-10-12T14:05:39.543+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816186",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816188",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276242123\n\n   @westonpace Are the failures mentioned above (mismatching schema size) legitimate?\n\n\n",
                    "created": "2022-10-12T14:06:50.918+0000",
                    "updated": "2022-10-12T14:06:50.918+0000",
                    "started": "2022-10-12T14:06:50.917+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816188",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816191",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276246581\n\n   > Edit: if this avoids an immediate crash and allows you to see `Validate` failing afterwards, then I would be ok with this\r\n   \r\n   With the current PR code, `exec_batch.ToRecordBatch(reject_schema)` just raises an error, i.e., it does not let an invalid record batch get created. Should I add some other check, and which?\n\n\n",
                    "created": "2022-10-12T14:10:04.222+0000",
                    "updated": "2022-10-12T14:10:04.222+0000",
                    "started": "2022-10-12T14:10:04.221+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816191",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816192",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276247931\n\n   > @westonpace Are the failures mentioned above (mismatching schema size) legitimate?\r\n   \r\n   Don't know yet; I'll need to examine. If I manage to do so quickly, I'll report here.\n\n\n",
                    "created": "2022-10-12T14:10:56.939+0000",
                    "updated": "2022-10-12T14:10:56.939+0000",
                    "started": "2022-10-12T14:10:56.938+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816192",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816194",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993520835\n\n\n##########\ncpp/src/arrow/compute/exec_test.cc:\n##########\n@@ -55,6 +55,19 @@ using ::arrow::internal::BitmapEquals;\n using ::arrow::internal::CopyBitmap;\n using ::arrow::internal::CountSetBits;\n \n+TEST(ExecBatch, Basics) {\n+  auto i32_array = ArrayFromJSON(int32(), \"[0, 1, 2]\");\n+  auto utf8_array = ArrayFromJSON(utf8(), R\"([\"a\", \"b\", \"c\"])\");\n+  ExecBatch exec_batch({Datum(i32_array), Datum(utf8_array)}, 3);\n+  auto right_schema = schema({field(\"a\", int32()), field(\"b\", utf8())});\n+  ASSERT_OK_AND_ASSIGN(auto right_record_batch, exec_batch.ToRecordBatch(right_schema));\n+  auto accept_schema = schema({field(\"a\", int32())});\n+  ASSERT_OK_AND_ASSIGN(auto accept_record_batch, exec_batch.ToRecordBatch(accept_schema));\n\nReview Comment:\n   [This comment](https://github.com/apache/arrow/pull/14386#issuecomment-1276240482) gives the background.\n\n\n\n",
                    "created": "2022-10-12T14:12:38.839+0000",
                    "updated": "2022-10-12T14:12:38.839+0000",
                    "started": "2022-10-12T14:12:38.838+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816194",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816197",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rtpsw commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276261064\n\n   > I agree with this, but it is actually misleading here, because we're only checking a single condition and otherwise let errors crash silently (or corrupt memory etc.).\r\n   \r\n   I agree the leniency of the checks, as compared to validation, could be unexpected to some developers and therefore misleading. I'd suggest adding doc strings to clarify this. OTOH, I'm not sure which crash condition you mean could still occur. Since the current PR code check the number of values and their types before applying type-specific operations, I believe it can only crash on the `DCHECK(false)` line. I could fix this to return an error.\n\n\n",
                    "created": "2022-10-12T14:20:07.361+0000",
                    "updated": "2022-10-12T14:20:07.361+0000",
                    "started": "2022-10-12T14:20:07.361+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816197",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816227",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#issuecomment-1276340243\n\n   Ok, it looks like Acero relies on being able to silently truncate the number of fields in that method. Which is quite unfortunate.\n\n\n",
                    "created": "2022-10-12T15:10:19.245+0000",
                    "updated": "2022-10-12T15:10:19.245+0000",
                    "started": "2022-10-12T15:10:19.244+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816227",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816228",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993595985\n\n\n##########\ncpp/src/arrow/compute/exec.cc:\n##########\n@@ -156,15 +156,22 @@ Result<ExecBatch> ExecBatch::Make(std::vector<Datum> values) {\n \n Result<std::shared_ptr<RecordBatch>> ExecBatch::ToRecordBatch(\n     std::shared_ptr<Schema> schema, MemoryPool* pool) const {\n+  if (static_cast<size_t>(schema->num_fields()) > values.size()) {\n+    return Status::Invalid(\"mismatching schema size\");\n+  }\n   ArrayVector columns(schema->num_fields());\n \n   for (size_t i = 0; i < columns.size(); ++i) {\n     const Datum& value = values[i];\n     if (value.is_array()) {\n       columns[i] = value.make_array();\n       continue;\n+    } else if (value.is_scalar()) {\n+      ARROW_ASSIGN_OR_RAISE(columns[i],\n+                            MakeArrayFromScalar(*value.scalar(), length, pool));\n+    } else {\n+      DCHECK(false);\n\nReview Comment:\n   ```suggestion\r\n         Unreachable();\r\n   ```\n\n\n\n",
                    "created": "2022-10-12T15:13:58.040+0000",
                    "updated": "2022-10-12T15:13:58.040+0000",
                    "started": "2022-10-12T15:13:58.039+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816228",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816230",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993597997\n\n\n##########\ncpp/src/arrow/compute/exec_test.cc:\n##########\n@@ -55,6 +55,19 @@ using ::arrow::internal::BitmapEquals;\n using ::arrow::internal::CopyBitmap;\n using ::arrow::internal::CountSetBits;\n \n+TEST(ExecBatch, Basics) {\n+  auto i32_array = ArrayFromJSON(int32(), \"[0, 1, 2]\");\n+  auto utf8_array = ArrayFromJSON(utf8(), R\"([\"a\", \"b\", \"c\"])\");\n+  ExecBatch exec_batch({Datum(i32_array), Datum(utf8_array)}, 3);\n+  auto right_schema = schema({field(\"a\", int32()), field(\"b\", utf8())});\n+  ASSERT_OK_AND_ASSIGN(auto right_record_batch, exec_batch.ToRecordBatch(right_schema));\n+  auto accept_schema = schema({field(\"a\", int32())});\n+  ASSERT_OK_AND_ASSIGN(auto accept_record_batch, exec_batch.ToRecordBatch(accept_schema));\n\nReview Comment:\n   Yes, I checked this locally and it occurs in multiple places unfortunately. However, I don't think this is a behavior that we want to set in stone, so I think we should remove this particular test.\n\n\n\n",
                    "created": "2022-10-12T15:15:43.168+0000",
                    "updated": "2022-10-12T15:15:43.168+0000",
                    "started": "2022-10-12T15:15:43.167+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816230",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816231",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993598429\n\n\n##########\ncpp/src/arrow/compute/exec_test.cc:\n##########\n@@ -55,6 +55,19 @@ using ::arrow::internal::BitmapEquals;\n using ::arrow::internal::CopyBitmap;\n using ::arrow::internal::CountSetBits;\n \n+TEST(ExecBatch, Basics) {\n\nReview Comment:\n   Nit :-)\r\n   ```suggestion\r\n   TEST(ExecBatch, ToRecordBatch) {\r\n   ```\n\n\n\n",
                    "created": "2022-10-12T15:16:03.171+0000",
                    "updated": "2022-10-12T15:16:03.171+0000",
                    "started": "2022-10-12T15:16:03.171+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816231",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816232",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993599193\n\n\n##########\ncpp/src/arrow/compute/exec.cc:\n##########\n@@ -156,15 +156,22 @@ Result<ExecBatch> ExecBatch::Make(std::vector<Datum> values) {\n \n Result<std::shared_ptr<RecordBatch>> ExecBatch::ToRecordBatch(\n     std::shared_ptr<Schema> schema, MemoryPool* pool) const {\n+  if (static_cast<size_t>(schema->num_fields()) > values.size()) {\n+    return Status::Invalid(\"mismatching schema size\");\n+  }\n   ArrayVector columns(schema->num_fields());\n \n   for (size_t i = 0; i < columns.size(); ++i) {\n     const Datum& value = values[i];\n     if (value.is_array()) {\n       columns[i] = value.make_array();\n       continue;\n+    } else if (value.is_scalar()) {\n+      ARROW_ASSIGN_OR_RAISE(columns[i],\n+                            MakeArrayFromScalar(*value.scalar(), length, pool));\n+    } else {\n+      DCHECK(false);\n\nReview Comment:\n   Let's instead return `Status::TypeError` with a nice error message.\n\n\n\n",
                    "created": "2022-10-12T15:16:43.323+0000",
                    "updated": "2022-10-12T15:16:43.323+0000",
                    "started": "2022-10-12T15:16:43.322+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816232",
                    "issueId": "13485891"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/worklog/816233",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #14386:\nURL: https://github.com/apache/arrow/pull/14386#discussion_r993600098\n\n\n##########\ncpp/src/arrow/compute/exec.cc:\n##########\n@@ -156,15 +156,22 @@ Result<ExecBatch> ExecBatch::Make(std::vector<Datum> values) {\n \n Result<std::shared_ptr<RecordBatch>> ExecBatch::ToRecordBatch(\n     std::shared_ptr<Schema> schema, MemoryPool* pool) const {\n+  if (static_cast<size_t>(schema->num_fields()) > values.size()) {\n+    return Status::Invalid(\"mismatching schema size\");\n+  }\n   ArrayVector columns(schema->num_fields());\n \n   for (size_t i = 0; i < columns.size(); ++i) {\n     const Datum& value = values[i];\n     if (value.is_array()) {\n       columns[i] = value.make_array();\n       continue;\n+    } else if (value.is_scalar()) {\n+      ARROW_ASSIGN_OR_RAISE(columns[i],\n+                            MakeArrayFromScalar(*value.scalar(), length, pool));\n+    } else {\n+      DCHECK(false);\n\nReview Comment:\n   Well, it's not really unreachable :-)\n\n\n\n",
                    "created": "2022-10-12T15:17:33.308+0000",
                    "updated": "2022-10-12T15:17:33.308+0000",
                    "started": "2022-10-12T15:17:33.307+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "816233",
                    "issueId": "13485891"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 24000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@605c26ef[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@537dba9e[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2a046ea7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@14139833[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ba04e53[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1264ccca[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1b9cf977[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@13c62837[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5a5d3eca[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6eebbbd7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1240a03c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3065a5d3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 24000,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Oct 13 17:10:34 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": [
            "C++"
        ],
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-10-13T17:10:34.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-18004/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2022-10-12T12:59:01.000+0000",
        "updated": "2022-10-14T19:34:09.000+0000",
        "timeoriginalestimate": null,
        "description": "When the schema given to `ExecBatch::ToRecordBatch` is wider than the `ExecBatch` values vector, an out-of-bounds index is accessed.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "6h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 24000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] ExecBatch conversion to RecordBatch may go out of bounds",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13485891/comment/17617200",
                    "id": "17617200",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 14386\n[https://github.com/apache/arrow/pull/14386]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-10-13T17:10:34.778+0000",
                    "updated": "2022-10-13T17:10:34.778+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z19ars:",
        "customfield_12314139": null
    }
}