{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13199104",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104",
    "key": "ARROW-3829",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12570592",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12570592",
                "type": {
                    "id": "10032",
                    "name": "Blocker",
                    "inward": "is blocked by",
                    "outward": "blocks",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"
                },
                "outwardIssue": {
                    "id": "13234380",
                    "key": "ARROW-5379",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13234380",
                    "fields": {
                        "summary": "[Python] support pandas' nullable Integer type in from_pandas",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            },
            {
                "id": "12567894",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12567894",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "outwardIssue": {
                    "id": "13231858",
                    "key": "ARROW-5271",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13231858",
                    "fields": {
                        "summary": "[Python] Interface for converting pandas ExtensionArray / other custom array objects to pyarrow Array",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
            "name": "uwe",
            "key": "xhochy",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
            },
            "displayName": "Uwe Korn",
            "active": true,
            "timeZone": "Europe/Berlin"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
            "name": "uwe",
            "key": "xhochy",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
            },
            "displayName": "Uwe Korn",
            "active": true,
            "timeZone": "Europe/Berlin"
        },
        "aggregateprogress": {
            "progress": 18600,
            "total": 18600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18600,
            "total": 18600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3829/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 32,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/296299",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106\n \n \n   https://issues.apache.org/jira/browse/ARROW-3829 & https://issues.apache.org/jira/browse/ARROW-5271. And as illustration for the mailing list discussion (will post there in a bit).\r\n   \r\n   TODO: compatibility for older pandas versions (where ExtensionArray/IntegerArray is not yet available)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-16T14:09:53.230+0000",
                    "updated": "2019-08-16T14:09:53.230+0000",
                    "started": "2019-08-16T14:09:53.229+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "296299",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/296519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lihalite commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r314860894\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,50 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n+\n+    # with latest pandas/arrow, trying to convert nullable integer errors\n+    with pytest.raises(TypeError):\n+        pa.table(df)\n+\n+    # patch IntegerArray with the protocol\n+    pd.arrays.IntegerArray.__arrow_array__ = __arrow_array__\n+\n+    # default conversion\n+    result = pa.table(df)\n+    expected = pa.array([1, 2, None], pa.int64())\n+    assert result[0].chunk(0).equals(expected)\n+\n+    # with specifying schema\n+    schema = pa.schema([('a', pa.float64())])\n+    result = pa.table(df, schema=schema)\n+    expected2 = pa.array([1, 2, None], pa.float64())\n+    assert result[0].chunk(0).equals(expected2)\n+\n+    # pass Series to pa.array\n+    result = pa.array(df['a'])\n+    assert result.equals(expected)\n+    result = pa.array(df['a'], type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    # pass actual ExtensionArray to pa.array\n+    result = pa.array(df['a'].values)\n+    assert result.equals(expected)\n+    result = pa.array(df['a'].values, type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    del pd.arrays.IntegerArray.__arrow_array__\n \n Review comment:\n   Maybe this could go in a try-finally to avoid a failure here possibly contaminating other tests.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-16T19:29:08.580+0000",
                    "updated": "2019-08-16T19:29:08.580+0000",
                    "started": "2019-08-16T19:29:08.579+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "296519",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/296522",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lihalite commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r314861318\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -161,7 +161,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n     else:\n         c_from_pandas = from_pandas\n \n-    if _is_array_like(obj):\n+    if hasattr(obj, '__arrow_array__'):\n+        return obj.__arrow_array__(type=type)\n \n Review comment:\n   Would it make sense to check for a return value of `NotImplemented` and fall back to the default path?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-16T19:30:23.028+0000",
                    "updated": "2019-08-16T19:30:23.028+0000",
                    "started": "2019-08-16T19:30:23.027+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "296522",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297042",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315132212\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -161,7 +161,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n     else:\n         c_from_pandas = from_pandas\n \n-    if _is_array_like(obj):\n+    if hasattr(obj, '__arrow_array__'):\n+        return obj.__arrow_array__(type=type)\n \n Review comment:\n   I don't think so. Why would you define `__arrow_array__` just to return `NotImplemented`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:03:07.088+0000",
                    "updated": "2019-08-19T10:03:07.088+0000",
                    "started": "2019-08-19T10:03:07.088+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297042",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297049",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315132653\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -161,7 +161,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n     else:\n         c_from_pandas = from_pandas\n \n-    if _is_array_like(obj):\n+    if hasattr(obj, '__arrow_array__'):\n+        return obj.__arrow_array__(type=type)\n \n Review comment:\n   Should we raise if non-default `size` and `mask` arguments are passed here?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:09:19.567+0000",
                    "updated": "2019-08-19T10:09:19.567+0000",
                    "started": "2019-08-19T10:09:19.567+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297049",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297050",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315132929\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -178,7 +180,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n                 mask = values.mask\n                 values = values.data\n \n-        if pandas_api.is_categorical(values):\n+        if hasattr(values, '__arrow_array__'):\n+            return values.__arrow_array__(type=type)\n \n Review comment:\n   Same here: raise if `size` or `mask` is given?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:09:19.633+0000",
                    "updated": "2019-08-19T10:09:19.633+0000",
                    "started": "2019-08-19T10:09:19.633+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297050",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297051",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315133613\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,50 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n \n Review comment:\n   \"Int64\" (capitalized) is a Pandas-specific type name?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:09:19.649+0000",
                    "updated": "2019-08-19T10:09:19.649+0000",
                    "started": "2019-08-19T10:09:19.648+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297051",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297060",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315141284\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -161,7 +161,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n     else:\n         c_from_pandas = from_pandas\n \n-    if _is_array_like(obj):\n+    if hasattr(obj, '__arrow_array__'):\n+        return obj.__arrow_array__(type=type)\n \n Review comment:\n   Yes, I think if you don't want to implement this, the user should simply not define `__arrow_array__`. \r\n   \r\n   But we should probably add a check to ensure that was is returned from `__arrow_array__` is actually a pyarrow Array (that is something that numpy also does).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:27:38.431+0000",
                    "updated": "2019-08-19T10:27:38.431+0000",
                    "started": "2019-08-19T10:27:38.431+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297060",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297062",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315141600\n \n \n\n ##########\n File path: python/pyarrow/array.pxi\n ##########\n @@ -161,7 +161,9 @@ def array(object obj, type=None, mask=None, size=None, from_pandas=None,\n     else:\n         c_from_pandas = from_pandas\n \n-    if _is_array_like(obj):\n+    if hasattr(obj, '__arrow_array__'):\n+        return obj.__arrow_array__(type=type)\n \n Review comment:\n   Yes, that sounds as a good idea.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:28:36.553+0000",
                    "updated": "2019-08-19T10:28:36.553+0000",
                    "started": "2019-08-19T10:28:36.553+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297062",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297063",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315142861\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,50 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n \n Review comment:\n   Yes, that's the (rather subtle) way to distinguish between default numpy `'int64'` (in string form)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:32:20.027+0000",
                    "updated": "2019-08-19T10:32:20.027+0000",
                    "started": "2019-08-19T10:32:20.027+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297063",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297067",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#issuecomment-522512574\n \n \n   > Question: if the Pandas series or dataframe column is backed by an Arrow array, does this allow pa.array() to extract the array without copying?\r\n   \r\n   Yes, that would be the idea (also `pa.array(numpy_array)` does not create a copy of the data if possible). In that case the `__arrow_array__` should return that backing Arrow array (which is what fletcher could do). \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-19T10:36:29.394+0000",
                    "updated": "2019-08-19T10:36:29.394+0000",
                    "started": "2019-08-19T10:36:29.394+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297067",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297725",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#issuecomment-522940416\n \n \n   Updated the PR and added some docs for it.\r\n   \r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T09:47:48.529+0000",
                    "updated": "2019-08-20T09:47:48.529+0000",
                    "started": "2019-08-20T09:47:48.529+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297725",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297727",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315602179\n \n \n\n ##########\n File path: docs/source/python/extending2.rst\n ##########\n @@ -0,0 +1,46 @@\n+.. Licensed to the Apache Software Foundation (ASF) under one\n+.. or more contributor license agreements.  See the NOTICE file\n+.. distributed with this work for additional information\n+.. regarding copyright ownership.  The ASF licenses this file\n+.. to you under the Apache License, Version 2.0 (the\n+.. \"License\"); you may not use this file except in compliance\n+.. with the License.  You may obtain a copy of the License at\n+\n+..   http://www.apache.org/licenses/LICENSE-2.0\n+\n+.. Unless required by applicable law or agreed to in writing,\n+.. software distributed under the License is distributed on an\n+.. \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+.. KIND, either express or implied.  See the License for the\n+.. specific language governing permissions and limitations\n+.. under the License.\n+\n+.. currentmodule:: pyarrow\n+.. _extending:\n+\n+Extending pyarrow\n+=================\n \n Review comment:\n   The idea is that this file can also contain the documentation about creating your own `ExtensionType` (documentation which is missing at the moment), so therefore I think `extending.rst` would be a good name. \r\n   However, we already have `extending.rst` which is about using the pyarrow C++ / cython APIs. Anybody an idea for another name for this file? (\"extending2\" is not meant to keep :))\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T09:49:54.387+0000",
                    "updated": "2019-08-20T09:49:54.387+0000",
                    "started": "2019-08-20T09:49:54.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297727",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297818",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lihalite commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315653113\n \n \n\n ##########\n File path: docs/source/python/extending2.rst\n ##########\n @@ -0,0 +1,46 @@\n+.. Licensed to the Apache Software Foundation (ASF) under one\n+.. or more contributor license agreements.  See the NOTICE file\n+.. distributed with this work for additional information\n+.. regarding copyright ownership.  The ASF licenses this file\n+.. to you under the Apache License, Version 2.0 (the\n+.. \"License\"); you may not use this file except in compliance\n+.. with the License.  You may obtain a copy of the License at\n+\n+..   http://www.apache.org/licenses/LICENSE-2.0\n+\n+.. Unless required by applicable law or agreed to in writing,\n+.. software distributed under the License is distributed on an\n+.. \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+.. KIND, either express or implied.  See the License for the\n+.. specific language governing permissions and limitations\n+.. under the License.\n+\n+.. currentmodule:: pyarrow\n+.. _extending:\n+\n+Extending pyarrow\n+=================\n \n Review comment:\n   Maybe `extending_types.rst`? Or `user_defined_types.rst`, since ultimately `__arrow_array__`, `ExtensionType`, and (eventually) custom Arrow-to-Pandas conversions are all about user-defined types.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T12:11:10.965+0000",
                    "updated": "2019-08-20T12:11:10.965+0000",
                    "started": "2019-08-20T12:11:10.965+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297818",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297848",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315674244\n \n \n\n ##########\n File path: docs/source/python/extending2.rst\n ##########\n @@ -0,0 +1,46 @@\n+.. Licensed to the Apache Software Foundation (ASF) under one\n+.. or more contributor license agreements.  See the NOTICE file\n+.. distributed with this work for additional information\n+.. regarding copyright ownership.  The ASF licenses this file\n+.. to you under the Apache License, Version 2.0 (the\n+.. \"License\"); you may not use this file except in compliance\n+.. with the License.  You may obtain a copy of the License at\n+\n+..   http://www.apache.org/licenses/LICENSE-2.0\n+\n+.. Unless required by applicable law or agreed to in writing,\n+.. software distributed under the License is distributed on an\n+.. \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+.. KIND, either express or implied.  See the License for the\n+.. specific language governing permissions and limitations\n+.. under the License.\n+\n+.. currentmodule:: pyarrow\n+.. _extending:\n+\n+Extending pyarrow\n+=================\n \n Review comment:\n   Thanks, renamed to `extending_types.rst` (the title can still include \"user defined types\" once we add documentation about that)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T13:01:17.273+0000",
                    "updated": "2019-08-20T13:01:17.273+0000",
                    "started": "2019-08-20T13:01:17.272+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297848",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297955",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315756192\n \n \n\n ##########\n File path: docs/source/python/extending2.rst\n ##########\n @@ -0,0 +1,46 @@\n+.. Licensed to the Apache Software Foundation (ASF) under one\n+.. or more contributor license agreements.  See the NOTICE file\n+.. distributed with this work for additional information\n+.. regarding copyright ownership.  The ASF licenses this file\n+.. to you under the Apache License, Version 2.0 (the\n+.. \"License\"); you may not use this file except in compliance\n+.. with the License.  You may obtain a copy of the License at\n+\n+..   http://www.apache.org/licenses/LICENSE-2.0\n+\n+.. Unless required by applicable law or agreed to in writing,\n+.. software distributed under the License is distributed on an\n+.. \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+.. KIND, either express or implied.  See the License for the\n+.. specific language governing permissions and limitations\n+.. under the License.\n+\n+.. currentmodule:: pyarrow\n+.. _extending:\n+\n+Extending pyarrow\n+=================\n \n Review comment:\n   The original document could also be renamed `extending_cpp.rst` or something.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T15:27:16.664+0000",
                    "updated": "2019-08-20T15:27:16.664+0000",
                    "started": "2019-08-20T15:27:16.664+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297955",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297960",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315757347\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,55 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+@pytest.mark.skipif(LooseVersion(pd.__version__) < '0.24.0',\n+                    reason='IntegerArray only introduced in 0.24')\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n+\n+    # with latest pandas/arrow, trying to convert nullable integer errors\n+    with pytest.raises(TypeError):\n+        pa.table(df)\n+\n+    # patch IntegerArray with the protocol\n+    pd.arrays.IntegerArray.__arrow_array__ = __arrow_array__\n+\n+    # default conversion\n+    result = pa.table(df)\n+    expected = pa.array([1, 2, None], pa.int64())\n+    assert result[0].chunk(0).equals(expected)\n+\n+    # with specifying schema\n+    schema = pa.schema([('a', pa.float64())])\n+    result = pa.table(df, schema=schema)\n+    expected2 = pa.array([1, 2, None], pa.float64())\n+    assert result[0].chunk(0).equals(expected2)\n+\n+    # pass Series to pa.array\n+    result = pa.array(df['a'])\n+    assert result.equals(expected)\n+    result = pa.array(df['a'], type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    # pass actual ExtensionArray to pa.array\n+    result = pa.array(df['a'].values)\n+    assert result.equals(expected)\n+    result = pa.array(df['a'].values, type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    try:\n+        del pd.arrays.IntegerArray.__arrow_array__\n \n Review comment:\n   This cleanup clause should be in a `try..finally` block IMHO.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T15:29:26.380+0000",
                    "updated": "2019-08-20T15:29:26.380+0000",
                    "started": "2019-08-20T15:29:26.380+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297960",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297963",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315759043\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,55 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+@pytest.mark.skipif(LooseVersion(pd.__version__) < '0.24.0',\n+                    reason='IntegerArray only introduced in 0.24')\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n+\n+    # with latest pandas/arrow, trying to convert nullable integer errors\n+    with pytest.raises(TypeError):\n+        pa.table(df)\n+\n+    # patch IntegerArray with the protocol\n+    pd.arrays.IntegerArray.__arrow_array__ = __arrow_array__\n+\n+    # default conversion\n+    result = pa.table(df)\n+    expected = pa.array([1, 2, None], pa.int64())\n+    assert result[0].chunk(0).equals(expected)\n+\n+    # with specifying schema\n+    schema = pa.schema([('a', pa.float64())])\n+    result = pa.table(df, schema=schema)\n+    expected2 = pa.array([1, 2, None], pa.float64())\n+    assert result[0].chunk(0).equals(expected2)\n+\n+    # pass Series to pa.array\n+    result = pa.array(df['a'])\n+    assert result.equals(expected)\n+    result = pa.array(df['a'], type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    # pass actual ExtensionArray to pa.array\n+    result = pa.array(df['a'].values)\n+    assert result.equals(expected)\n+    result = pa.array(df['a'].values, type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    try:\n+        del pd.arrays.IntegerArray.__arrow_array__\n \n Review comment:\n   Sorry, I am not sure I follow. What should be in the `finally` block? \r\n   You mean putting the whole testing code above in the \"try\" block and the cleanup in the finally?\r\n   \r\n   In that case, I could maybe use a pytest fixture with yield instead? \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T15:32:02.982+0000",
                    "updated": "2019-08-20T15:32:02.982+0000",
                    "started": "2019-08-20T15:32:02.981+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297963",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/297983",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315774375\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,55 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+@pytest.mark.skipif(LooseVersion(pd.__version__) < '0.24.0',\n+                    reason='IntegerArray only introduced in 0.24')\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n+\n+    # with latest pandas/arrow, trying to convert nullable integer errors\n+    with pytest.raises(TypeError):\n+        pa.table(df)\n+\n+    # patch IntegerArray with the protocol\n+    pd.arrays.IntegerArray.__arrow_array__ = __arrow_array__\n+\n+    # default conversion\n+    result = pa.table(df)\n+    expected = pa.array([1, 2, None], pa.int64())\n+    assert result[0].chunk(0).equals(expected)\n+\n+    # with specifying schema\n+    schema = pa.schema([('a', pa.float64())])\n+    result = pa.table(df, schema=schema)\n+    expected2 = pa.array([1, 2, None], pa.float64())\n+    assert result[0].chunk(0).equals(expected2)\n+\n+    # pass Series to pa.array\n+    result = pa.array(df['a'])\n+    assert result.equals(expected)\n+    result = pa.array(df['a'], type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    # pass actual ExtensionArray to pa.array\n+    result = pa.array(df['a'].values)\n+    assert result.equals(expected)\n+    result = pa.array(df['a'].values, type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    try:\n+        del pd.arrays.IntegerArray.__arrow_array__\n \n Review comment:\n   > You mean putting the whole testing code above in the \"try\" block and the cleanup in the finally?\r\n   \r\n   Yes.\r\n   \r\n   > In that case, I could maybe use a pytest fixture with yield instead?\r\n   \r\n   I kindof hate pytest fixtures :-S\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T16:01:41.089+0000",
                    "updated": "2019-08-20T16:01:41.089+0000",
                    "started": "2019-08-20T16:01:41.088+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "297983",
                    "issueId": "13199104"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/worklog/298100",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5106: ARROW-3829: [Python] add __arrow_array__ protocol to support third-party array classes in conversion to Arrow\nURL: https://github.com/apache/arrow/pull/5106#discussion_r315841923\n \n \n\n ##########\n File path: python/pyarrow/tests/test_pandas.py\n ##########\n @@ -2882,6 +2882,55 @@ def test_variable_dictionary_with_pandas():\n         a.to_pandas()\n \n \n+# ----------------------------------------------------------------------\n+# Array protocol in pandas conversions tests\n+\n+\n+@pytest.mark.skipif(LooseVersion(pd.__version__) < '0.24.0',\n+                    reason='IntegerArray only introduced in 0.24')\n+def test_array_protocol():\n+\n+    def __arrow_array__(self, type=None):\n+        return pa.array(self._data, mask=self._mask, type=type)\n+\n+    df = pd.DataFrame({'a': pd.Series([1, 2, None], dtype='Int64')})\n+\n+    # with latest pandas/arrow, trying to convert nullable integer errors\n+    with pytest.raises(TypeError):\n+        pa.table(df)\n+\n+    # patch IntegerArray with the protocol\n+    pd.arrays.IntegerArray.__arrow_array__ = __arrow_array__\n+\n+    # default conversion\n+    result = pa.table(df)\n+    expected = pa.array([1, 2, None], pa.int64())\n+    assert result[0].chunk(0).equals(expected)\n+\n+    # with specifying schema\n+    schema = pa.schema([('a', pa.float64())])\n+    result = pa.table(df, schema=schema)\n+    expected2 = pa.array([1, 2, None], pa.float64())\n+    assert result[0].chunk(0).equals(expected2)\n+\n+    # pass Series to pa.array\n+    result = pa.array(df['a'])\n+    assert result.equals(expected)\n+    result = pa.array(df['a'], type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    # pass actual ExtensionArray to pa.array\n+    result = pa.array(df['a'].values)\n+    assert result.equals(expected)\n+    result = pa.array(df['a'].values, type=pa.float64())\n+    assert result.equals(expected2)\n+\n+    try:\n+        del pd.arrays.IntegerArray.__arrow_array__\n \n Review comment:\n   OK, updated with a try/finally\r\n   \r\n   > I kindof hate pytest fixtures :-S\r\n   \r\n   I also dislike over-use of them (certainly if they are magically coming from other files), but for within a single file, they can have their use :-) But since I am only using the pattern a single time, not worth to create a function for it this time.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T18:34:12.218+0000",
                    "updated": "2019-08-20T18:34:12.218+0000",
                    "started": "2019-08-20T18:34:12.217+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "298100",
                    "issueId": "13199104"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 18600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6b87596[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7659d52e[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6d5899f9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5510d1d9[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@10756a7d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@72f3195d[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5b4dd1ab[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@8005d02[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@339de8fd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@594e2622[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6cbb7429[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@66d9ccf1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18600,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Aug 27 23:00:25 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-08-27T23:00:25.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3829/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2018-11-17T18:42:51.000+0000",
        "updated": "2019-09-24T20:25:22.000+0000",
        "timeoriginalestimate": null,
        "description": "In the style of NumPy's {{__array__}}, we should be able to ask inputs to {{pa.array}}, {{pa.Table.from_X}}, ... whether they can convert themselves to Arrow objects. This would allow for example to turn objects that hold an Arrow object internally to expose them directly instead of going a conversion path.\r\n\r\nMy current use case involves Pandas {{ExtensionArray}} instances that internally have Arrow objects and should be reused when we pass the whole {{DataFrame}} to {{pa.Table.from_pandas}}.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Support protocols to extract Arrow objects from third-party classes",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/comment/16721917",
                    "id": "16721917",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I'm moving this to 0.13. If you submit an alpha / experimental version of this for 0.12, please go ahead =) ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-12-15T00:54:33.741+0000",
                    "updated": "2018-12-15T00:54:33.741+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13199104/comment/16917214",
                    "id": "16917214",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 5106\n[https://github.com/apache/arrow/pull/5106]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-27T23:00:25.111+0000",
                    "updated": "2019-08-27T23:00:25.111+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|s00m4w:",
        "customfield_12314139": null
    }
}