{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13258160",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160",
    "key": "ARROW-6657",
    "fields": {
        "parent": {
            "id": "13230559",
            "key": "ARROW-5227",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13230559",
            "fields": {
                "summary": "[Rust] [DataFusion] Re-implement query execution with an extensible physical query plan",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                    "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                    "name": "Closed",
                    "id": "6",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                    "id": "2",
                    "description": "A new feature of the product, which has yet to be developed.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                    "name": "New Feature",
                    "subtask": false,
                    "avatarId": 21141
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "beginner",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6657/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/319035",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513\n \n \n   Hi, I added this code, and the tests pass. I still need to actually test it using a real example, so I would say its not completely ready for merge yet.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-26T15:15:46.433+0000",
                    "updated": "2019-09-26T15:15:46.433+0000",
                    "started": "2019-09-26T15:15:46.432+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "319035",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/319049",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-535573097\n \n \n   Hi @sinistersnare thanks for this!  Just let us know when you think it is ready for review (or if you have any questions)?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-26T16:03:16.002+0000",
                    "updated": "2019-09-26T16:03:16.002+0000",
                    "started": "2019-09-26T16:03:16.001+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "319049",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/319097",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-535602935\n \n \n   Those are exactly the tests I was looking for. Thanks, I will push an update tonight!\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-26T17:19:36.653+0000",
                    "updated": "2019-09-26T17:19:36.653+0000",
                    "started": "2019-09-26T17:19:36.652+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "319097",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/319135",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-535633860\n \n \n   @sinistersnare I see you merged master into your branch .. that can lead to issues because we don't use a merging model on this repo. See https://andygrove.io/apache_arrow_git_tips/ for more info.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-26T18:39:42.999+0000",
                    "updated": "2019-09-26T18:39:42.999+0000",
                    "started": "2019-09-26T18:39:42.998+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "319135",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/319946",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-536153103\n \n \n   Took a bit longer than expected (moving currently), but I added some SQL tests! Aside from my worry from above, I think I am ready for this.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-28T04:41:18.497+0000",
                    "updated": "2019-09-28T04:41:18.497+0000",
                    "started": "2019-09-28T04:41:18.497+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "319946",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320015",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-536196536\n \n \n   Fixed the style errors too, @andygrove @paddyhoran this should be good-to-go!\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-28T14:54:24.856+0000",
                    "updated": "2019-09-28T14:54:24.856+0000",
                    "started": "2019-09-28T14:54:24.856+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320015",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320029",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r329316921\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -199,6 +200,66 @@ pub fn sum(expr: Arc<dyn PhysicalExpr>) -> Arc<dyn AggregateExpr> {\n     Arc::new(Sum::new(expr))\n }\n \n+/// COUNT aggregate expression\n+/// If given something like `SELECT COUNT(*) FROM table`, the number of rows in the table will be returned.\n+/// If given a specific column, `SELECT COUNT(column_name) FROM table`, the number of *non-null*\n+/// rows in that column will be returned.\n+pub struct Count {\n+    expr: Arc<dyn PhysicalExpr>,\n+}\n+\n+impl Count {\n+    /// Create a new COUNT aggregate function.\n+    pub fn new(expr: Arc<dyn PhysicalExpr>) -> Self {\n+        Self { expr: expr }\n+    }\n+}\n+\n+impl AggregateExpr for Count {\n+    fn name(&self) -> String {\n+        \"COUNT\".to_string()\n+    }\n+\n+    fn data_type(&self, _input_schema: &Schema) -> Result<DataType> {\n+        Ok(DataType::UInt64)\n+    }\n+\n+    fn create_accumulator(&self) -> Rc<RefCell<dyn Accumulator>> {\n+        Rc::new(RefCell::new(CountAccumulator {\n+            expr: self.expr.clone(),\n+            count: 0,\n+        }))\n+    }\n+\n+    fn create_combiner(&self, column_index: usize) -> Arc<dyn AggregateExpr> {\n+        Arc::new(Sum::new(Arc::new(Column::new(column_index))))\n+    }\n+}\n+\n+struct CountAccumulator {\n+    expr: Arc<dyn PhysicalExpr>,\n+    count: u64,\n+}\n+\n+impl Accumulator for CountAccumulator {\n+    fn accumulate(&mut self, batch: &RecordBatch, row_index: usize) -> Result<()> {\n+        let array = self.expr.evaluate(batch)?;\n \n Review comment:\n   I just spotted an issue with this, and I have the same issue with the `SumExpr` implementation ... we are evaluating the expression against the whole batch multiple times (once for every row in the batch). This is a design flaw in the accumulator trait I guess. I'll give this some thought today.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-28T16:27:59.646+0000",
                    "updated": "2019-09-28T16:27:59.646+0000",
                    "started": "2019-09-28T16:27:59.644+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320029",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320073",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r328736127\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -607,6 +670,42 @@ mod tests {\n         }\n     }\n \n+    #[test]\n+    fn count_elements() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n+        let a = Int32Array::from(vec![1,2,3,4,5]);\n+        let batch = RecordBatch::try_new(Arc::new(schema.clone()), vec![Arc::new(a)])?;\n+        assert_eq!(do_count(&batch)?, Some(ScalarValue::UInt64(5)));\n+        Ok(())\n+    }\n+\n+    #[test]\n+    fn count_with_nulls() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n \n Review comment:\n   It seems like we are ignoring nullability here, the field is marked non-nullable, but the nulls below seem to contradict that. \r\n   \r\n   I thought about adding an optimization that check for null if the field can not be null, but it seems like nullability isn't checked yet. Is that something we would want to do?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-28T22:09:33.773+0000",
                    "updated": "2019-09-28T22:09:33.773+0000",
                    "started": "2019-09-28T22:09:33.773+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320073",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320274",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-536329787\n \n \n   https://issues.apache.org/jira/browse/ARROW-6657\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-29T18:46:13.487+0000",
                    "updated": "2019-09-29T18:46:13.487+0000",
                    "started": "2019-09-29T18:46:13.487+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320274",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320302",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r329375278\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -199,6 +200,66 @@ pub fn sum(expr: Arc<dyn PhysicalExpr>) -> Arc<dyn AggregateExpr> {\n     Arc::new(Sum::new(expr))\n }\n \n+/// COUNT aggregate expression\n+/// If given something like `SELECT COUNT(*) FROM table`, the number of rows in the table will be returned.\n+/// If given a specific column, `SELECT COUNT(column_name) FROM table`, the number of *non-null*\n+/// rows in that column will be returned.\n+pub struct Count {\n+    expr: Arc<dyn PhysicalExpr>,\n+}\n+\n+impl Count {\n+    /// Create a new COUNT aggregate function.\n+    pub fn new(expr: Arc<dyn PhysicalExpr>) -> Self {\n+        Self { expr: expr }\n+    }\n+}\n+\n+impl AggregateExpr for Count {\n+    fn name(&self) -> String {\n+        \"COUNT\".to_string()\n+    }\n+\n+    fn data_type(&self, _input_schema: &Schema) -> Result<DataType> {\n+        Ok(DataType::UInt64)\n+    }\n+\n+    fn create_accumulator(&self) -> Rc<RefCell<dyn Accumulator>> {\n+        Rc::new(RefCell::new(CountAccumulator {\n+            expr: self.expr.clone(),\n+            count: 0,\n+        }))\n+    }\n+\n+    fn create_combiner(&self, column_index: usize) -> Arc<dyn AggregateExpr> {\n+        Arc::new(Sum::new(Arc::new(Column::new(column_index))))\n+    }\n+}\n+\n+struct CountAccumulator {\n+    expr: Arc<dyn PhysicalExpr>,\n+    count: u64,\n+}\n+\n+impl Accumulator for CountAccumulator {\n+    fn accumulate(&mut self, batch: &RecordBatch, row_index: usize) -> Result<()> {\n+        let array = self.expr.evaluate(batch)?;\n \n Review comment:\n   I think it would be best if we merge this in without this optimization/fix, so you can simply fix both instances at the same time?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-29T23:00:23.206+0000",
                    "updated": "2019-09-29T23:00:23.206+0000",
                    "started": "2019-09-29T23:00:23.205+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320302",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320304",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r329377765\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -607,6 +670,42 @@ mod tests {\n         }\n     }\n \n+    #[test]\n+    fn count_elements() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n+        let a = Int32Array::from(vec![1,2,3,4,5]);\n+        let batch = RecordBatch::try_new(Arc::new(schema.clone()), vec![Arc::new(a)])?;\n+        assert_eq!(do_count(&batch)?, Some(ScalarValue::UInt64(5)));\n+        Ok(())\n+    }\n+\n+    #[test]\n+    fn count_with_nulls() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n \n Review comment:\n   You are correct that nullability as defined by the schema is not checked anywhere yet (at least AFAIK).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-29T23:55:24.221+0000",
                    "updated": "2019-09-29T23:55:24.221+0000",
                    "started": "2019-09-29T23:55:24.220+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320304",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/320309",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r329378902\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -199,6 +200,66 @@ pub fn sum(expr: Arc<dyn PhysicalExpr>) -> Arc<dyn AggregateExpr> {\n     Arc::new(Sum::new(expr))\n }\n \n+/// COUNT aggregate expression\n+/// If given something like `SELECT COUNT(*) FROM table`, the number of rows in the table will be returned.\n+/// If given a specific column, `SELECT COUNT(column_name) FROM table`, the number of *non-null*\n+/// rows in that column will be returned.\n+pub struct Count {\n+    expr: Arc<dyn PhysicalExpr>,\n+}\n+\n+impl Count {\n+    /// Create a new COUNT aggregate function.\n+    pub fn new(expr: Arc<dyn PhysicalExpr>) -> Self {\n+        Self { expr: expr }\n+    }\n+}\n+\n+impl AggregateExpr for Count {\n+    fn name(&self) -> String {\n+        \"COUNT\".to_string()\n+    }\n+\n+    fn data_type(&self, _input_schema: &Schema) -> Result<DataType> {\n+        Ok(DataType::UInt64)\n+    }\n+\n+    fn create_accumulator(&self) -> Rc<RefCell<dyn Accumulator>> {\n+        Rc::new(RefCell::new(CountAccumulator {\n+            expr: self.expr.clone(),\n+            count: 0,\n+        }))\n+    }\n+\n+    fn create_combiner(&self, column_index: usize) -> Arc<dyn AggregateExpr> {\n+        Arc::new(Sum::new(Arc::new(Column::new(column_index))))\n+    }\n+}\n+\n+struct CountAccumulator {\n+    expr: Arc<dyn PhysicalExpr>,\n+    count: u64,\n+}\n+\n+impl Accumulator for CountAccumulator {\n+    fn accumulate(&mut self, batch: &RecordBatch, row_index: usize) -> Result<()> {\n+        let array = self.expr.evaluate(batch)?;\n \n Review comment:\n   Please take a look at the proposed fix in https://github.com/apache/arrow/pull/5542 and let me know what you think. I'd prefer to get this reviewed and merged first, then you can rebase this PR and implement the changes.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-30T00:16:45.635+0000",
                    "updated": "2019-09-30T00:16:45.635+0000",
                    "started": "2019-09-30T00:16:45.635+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "320309",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/321022",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#discussion_r329851008\n \n \n\n ##########\n File path: rust/datafusion/src/execution/physical_plan/expressions.rs\n ##########\n @@ -607,6 +670,42 @@ mod tests {\n         }\n     }\n \n+    #[test]\n+    fn count_elements() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n+        let a = Int32Array::from(vec![1,2,3,4,5]);\n+        let batch = RecordBatch::try_new(Arc::new(schema.clone()), vec![Arc::new(a)])?;\n+        assert_eq!(do_count(&batch)?, Some(ScalarValue::UInt64(5)));\n+        Ok(())\n+    }\n+\n+    #[test]\n+    fn count_with_nulls() -> Result<()> {\n+        let schema = Schema::new(vec![Field::new(\"a\", DataType::Int32, false)]);\n \n Review comment:\n   Ok, I will mark this resolved. Should I add a TODO in the code, or an issue on the tracker, or is that handled already?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-01T01:38:47.574+0000",
                    "updated": "2019-10-01T01:38:47.574+0000",
                    "started": "2019-10-01T01:38:47.573+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "321022",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/323081",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-538177700\n \n \n   @sinistersnare Please rebase against the latest master and I can approve and merge\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-04T00:17:56.385+0000",
                    "updated": "2019-10-04T00:17:56.385+0000",
                    "started": "2019-10-04T00:17:56.384+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "323081",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/323091",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sinistersnare commented on issue #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513#issuecomment-538181237\n \n \n   @andygrove updated! \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-04T00:34:40.603+0000",
                    "updated": "2019-10-04T00:34:40.603+0000",
                    "started": "2019-10-04T00:34:40.602+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "323091",
                    "issueId": "13258160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/worklog/323437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #5513: ARROW-6657: [Rust] [DataFusion] Add Count Aggregate Expression\nURL: https://github.com/apache/arrow/pull/5513\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-04T14:27:56.745+0000",
                    "updated": "2019-10-04T14:27:56.745+0000",
                    "started": "2019-10-04T14:27:56.744+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "323437",
                    "issueId": "13258160"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2d8924fc[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2d6ca2b0[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4cec94be[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@45dd6b1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@301054e2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2ff5c399[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@714ebbd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6d164db0[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5f93b3b4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@5efb5ad4[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7e920bb5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2136a21a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Oct 04 14:27:57 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-10-04T14:27:57.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6657/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2019-09-22T16:32:27.000+0000",
        "updated": "2019-10-08T17:54:38.000+0000",
        "timeoriginalestimate": null,
        "description": "Implement COUNT aggregate expressions. See the SUM implementation for inspiration.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] [DataFusion] Implement COUNT aggregate expression",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/comment/16937766",
                    "id": "16937766",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=sinistersnare",
                        "name": "sinistersnare",
                        "key": "sinistersnare",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=sinistersnare&avatarId=40591",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sinistersnare&avatarId=40591",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sinistersnare&avatarId=40591",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sinistersnare&avatarId=40591"
                        },
                        "displayName": "Davis Silverman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Hi, I would be interested in completing this. I have it almost implemented, need to do null checking on the value at each row. Is the submit/review process documented anywhere? Thanks!",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=sinistersnare",
                        "name": "sinistersnare",
                        "key": "sinistersnare",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=sinistersnare&avatarId=40591",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sinistersnare&avatarId=40591",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sinistersnare&avatarId=40591",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sinistersnare&avatarId=40591"
                        },
                        "displayName": "Davis Silverman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-09-25T14:09:24.906+0000",
                    "updated": "2019-09-25T14:09:24.906+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/comment/16937775",
                    "id": "16937775",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I'm actually not sure if it is documented or not ... but basically all you need to do is create a PR from your fork and use a title like \"ARROW-6657: [Rust] [DataFusion] Implement COUNT in physical query plan\" and add the labels \"lang-rust\" and \"datafusion\".\r\n\r\nYou can request reviews too from the Rust committers ... for the DataFusion crate that is mostly me, Paddy Horan and nevi-me right now.\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2019-09-25T14:16:44.716+0000",
                    "updated": "2019-09-25T14:16:44.716+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/comment/16939006",
                    "id": "16939006",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "https://github.com/apache/arrow/blob/master/docs/source/developers/contributing.rst",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-09-26T22:31:39.335+0000",
                    "updated": "2019-09-26T22:31:39.335+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258160/comment/16944547",
                    "id": "16944547",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "Issue resolved by pull request 5513\n[https://github.com/apache/arrow/pull/5513]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2019-10-04T14:27:57.480+0000",
                    "updated": "2019-10-04T14:27:57.480+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z06w9c:",
        "customfield_12314139": null
    }
}