{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13370694",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694",
    "key": "ARROW-12315",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348823",
                "id": "12348823",
                "description": "",
                "name": "3.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-01-25"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12613560",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12613560",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "inwardIssue": {
                    "id": "13372049",
                    "key": "ARROW-12363",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13372049",
                    "fields": {
                        "summary": "Write tests for max_partitions argument",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pachamaltese",
            "name": "pachamaltese",
            "key": "pachamaltese",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pachamaltese&avatarId=45930",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pachamaltese&avatarId=45930",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pachamaltese&avatarId=45930",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pachamaltese&avatarId=45930"
            },
            "displayName": "Mauricio 'Pach\u00e1' Vargas Sep\u00falveda",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pachamaltese",
            "name": "pachamaltese",
            "key": "pachamaltese",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pachamaltese&avatarId=45930",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pachamaltese&avatarId=45930",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pachamaltese&avatarId=45930",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pachamaltese&avatarId=45930"
            },
            "displayName": "Mauricio 'Pach\u00e1' Vargas Sep\u00falveda",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12315/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 21,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pachamaltese commented on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-817873691\n\n\n   @github-actions autotune\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-12T14:46:14.653+0000",
                    "updated": "2021-04-12T14:46:14.653+0000",
                    "started": "2021-04-12T14:46:14.653+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581056",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581267",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-818065644\n\n\n   https://issues.apache.org/jira/browse/ARROW-12315\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-12T19:13:25.192+0000",
                    "updated": "2021-04-12T19:13:25.192+0000",
                    "started": "2021-04-12T19:13:25.192+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581267",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581813",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612498334\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n\nReview comment:\n       We should assert what each of these errors contain. We don't need to do the full thing, but let's make sure that they are erroring with something useful about partitions\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = -3)\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = 1)\n+  )\n\nReview comment:\n       We especially want to make sure that this error is clear + actionable\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -60,8 +62,13 @@ write_dataset <- function(dataset,\n                           format = c(\"parquet\", \"feather\", \"arrow\", \"ipc\"),\n                           partitioning = dplyr::group_vars(dataset),\n                           basename_template = paste0(\"part-{i}.\", as.character(format)),\n-                          hive_style = TRUE,\n+                          hive_style = TRUE, max_partitions = 1024L,\n\nReview comment:\n       Minor: in the .R code, we should follow the style here with each argument on a new line.\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -60,8 +62,13 @@ write_dataset <- function(dataset,\n                           format = c(\"parquet\", \"feather\", \"arrow\", \"ipc\"),\n                           partitioning = dplyr::group_vars(dataset),\n                           basename_template = paste0(\"part-{i}.\", as.character(format)),\n-                          hive_style = TRUE,\n+                          hive_style = TRUE, max_partitions = 1024L,\n                           ...) {\n+  stopifnot(\n+    max_partitions == round(max_partitions, 0),\n+    max_partitions == abs(max_partitions),\n+    !is.null(max_partitions)\n+  )\n\nReview comment:\n       Have you tried to leave this checking off and seen what errors the c++ code returns? If those errors are reasonable, we should use them instead of writing our own here.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T14:32:50.810+0000",
                    "updated": "2021-04-13T14:32:50.810+0000",
                    "started": "2021-04-13T14:32:50.809+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581813",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581965",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pachamaltese commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612692056\n\n\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -60,8 +62,13 @@ write_dataset <- function(dataset,\n                           format = c(\"parquet\", \"feather\", \"arrow\", \"ipc\"),\n                           partitioning = dplyr::group_vars(dataset),\n                           basename_template = paste0(\"part-{i}.\", as.character(format)),\n-                          hive_style = TRUE,\n+                          hive_style = TRUE, max_partitions = 1024L,\n                           ...) {\n+  stopifnot(\n+    max_partitions == round(max_partitions, 0),\n+    max_partitions == abs(max_partitions),\n+    !is.null(max_partitions)\n+  )\n\nReview comment:\n       yes, I wrote that because I can pass max_partitions = -3\r\n   and it's gonna create 3 partitions, which is very confusing\r\n   also, NA works, and goes to the default 1024L, but NULL fails\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T18:42:50.146+0000",
                    "updated": "2021-04-13T18:42:50.146+0000",
                    "started": "2021-04-13T18:42:50.145+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581965",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581968",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pachamaltese commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612693329\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = -3)\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = 1)\n+  )\n\nReview comment:\n       the error in this case is \r\n   ```\r\n    Error: Invalid: Fragment would be written into 3 partitions. This exceeds the maximum of 1 \r\n   ```\r\n   \r\n   I think this is quite clear\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T18:45:02.146+0000",
                    "updated": "2021-04-13T18:45:02.146+0000",
                    "started": "2021-04-13T18:45:02.145+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581968",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/581995",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pachamaltese commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612716840\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n\nReview comment:\n       in this other case, the error is \r\n   ```\r\n    Error: Expected single integer value \r\n   ```\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T19:24:17.912+0000",
                    "updated": "2021-04-13T19:24:17.912+0000",
                    "started": "2021-04-13T19:24:17.912+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581995",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/582011",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612729383\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = -3)\n+  )\n+\n+  # max_partitions < 3 => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = 1)\n+  )\n\nReview comment:\n       Yeah, this looks fine too me, let's use the c++ error. If the error is coming directly from c++ (and it's tested there), we don't actually need to test it here as well.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T19:46:15.728+0000",
                    "updated": "2021-04-13T19:46:15.728+0000",
                    "started": "2021-04-13T19:46:15.728+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582011",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/582013",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612729965\n\n\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -60,8 +62,13 @@ write_dataset <- function(dataset,\n                           format = c(\"parquet\", \"feather\", \"arrow\", \"ipc\"),\n                           partitioning = dplyr::group_vars(dataset),\n                           basename_template = paste0(\"part-{i}.\", as.character(format)),\n-                          hive_style = TRUE,\n+                          hive_style = TRUE, max_partitions = 1024L,\n                           ...) {\n+  stopifnot(\n+    max_partitions == round(max_partitions, 0),\n+    max_partitions == abs(max_partitions),\n+    !is.null(max_partitions)\n+  )\n\nReview comment:\n       Can you tell if that's a feature or a bug in c++? This partitions parameter is pretty low-level so I think we should stick with what c++ allows (and fix this if it's a bug in c++, though I'm not certain it is)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T19:47:11.805+0000",
                    "updated": "2021-04-13T19:47:11.805+0000",
                    "started": "2021-04-13T19:47:11.805+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582013",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/582014",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612730467\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -1778,3 +1778,60 @@ test_that(\"Collecting zero columns from a dataset doesn't return entire dataset\"\n     c(32, 0)\n   )\n })\n+\n+# see https://issues.apache.org/jira/browse/ARROW-12315\n+test_that(\"Max partitions fails with non-integer values and less than required partitions values\", {\n+  skip_if_not_available(\"parquet\")\n+  tmp <- tempfile()\n+\n+  # this example needs 3 partitions\n+\n+  # max_partitions = chr => error\n+  expect_error(\n+    mtcars %>%\n+      group_by(cyl) %>%\n+      write_dataset(tmp, format = \"parquet\", max_partitions = \"foobar\")\n+  )\n\nReview comment:\n       And like I mention below: if we are using the error handling from c++, we don't need to test it in R as well if it has tests in c++ and there's no other indirection going on.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T19:48:04.912+0000",
                    "updated": "2021-04-13T19:48:04.912+0000",
                    "started": "2021-04-13T19:48:04.912+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582014",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/582083",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pachamaltese commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r612806301\n\n\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -60,8 +62,13 @@ write_dataset <- function(dataset,\n                           format = c(\"parquet\", \"feather\", \"arrow\", \"ipc\"),\n                           partitioning = dplyr::group_vars(dataset),\n                           basename_template = paste0(\"part-{i}.\", as.character(format)),\n-                          hive_style = TRUE,\n+                          hive_style = TRUE, max_partitions = 1024L,\n                           ...) {\n+  stopifnot(\n+    max_partitions == round(max_partitions, 0),\n+    max_partitions == abs(max_partitions),\n+    !is.null(max_partitions)\n+  )\n\nReview comment:\n       related https://issues.apache.org/jira/browse/ARROW-12373\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T22:05:49.426+0000",
                    "updated": "2021-04-13T22:05:49.426+0000",
                    "started": "2021-04-13T22:05:49.426+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582083",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/601174",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r637918633\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -450,6 +450,12 @@ Status WriteNextBatch(WriteState& state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state.write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n+  if (static_cast<int>(state.write_options.max_partitions) < static_cast<int>(0)) {\n\nReview comment:\n       There's no need to cast here since max_partitions is already an int. (The other place had to cast since one side was an int and the other side was size_t.)\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -450,6 +450,12 @@ Status WriteNextBatch(WriteState& state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state.write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n+  if (static_cast<int>(state.write_options.max_partitions) < static_cast<int>(0)) {\n+    return Status::Invalid(\"A number of \", state.write_options.max_partitions,\n+                           \" partitions is not feasible.\",\n+                           \" Try with max_partitions = 200, 100 or any other positive integer.\");\n\nReview comment:\n       ```suggestion\r\n       return Status::Invalid(\"max_partitions must be positive (was \",\r\n                              state.write_options.max_partitions, \")\");\r\n   ```\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -450,6 +450,12 @@ Status WriteNextBatch(WriteState& state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state.write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n+  if (static_cast<int>(state.write_options.max_partitions) < static_cast<int>(0)) {\n\nReview comment:\n       ```suggestion\r\n     if (state.write_options.max_partitions <= 0) {\r\n   ```\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -450,6 +450,12 @@ Status WriteNextBatch(WriteState& state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state.write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n+  if (static_cast<int>(state.write_options.max_partitions) < static_cast<int>(0)) {\n\nReview comment:\n       Also, I'd probably put this validation in WriteInternal() below so it gets checked immediately.\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -40,6 +40,8 @@\n #' will yield `\"part-0.feather\", ...`.\n #' @param hive_style logical: write partition segments as Hive-style\n #' (`key1=value1/key2=value2/file.ext`) or as just bare values. Default is `TRUE`.\n+#' @param max_partitions maximum number of partitions any batch may be\n+#' written into. Default is default 1024L (integer).\n\nReview comment:\n       ```suggestion\r\n   #' written into. Default is 1024L (integer).\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-24T12:50:13.001+0000",
                    "updated": "2021-05-24T12:50:13.001+0000",
                    "started": "2021-05-24T12:50:13.001+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "601174",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/616114",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r660563003\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -451,7 +451,12 @@ Status WriteNextBatch(WriteState* state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state->write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n-  if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\n+  if (state.write_options.max_partitions <= 0) {\n+    return Status::Invalid(\"max_partitions must be positive (was \",\n+                           state.write_options.max_partitions, \")\");\n+  }\n+\n+  if (groups.batches.size() > static_cast<size_t>(state.write_options.max_partitions)) {\n\nReview comment:\n       ```suggestion\r\n     if (state->write_options.max_partitions <= 0) {\r\n       return Status::Invalid(\"max_partitions must be positive (was \",\r\n                              state->write_options.max_partitions, \")\");\r\n     }\r\n   \r\n     if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\r\n   ```\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -451,7 +451,12 @@ Status WriteNextBatch(WriteState* state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state->write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n-  if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\n+  if (state.write_options.max_partitions <= 0) {\n+    return Status::Invalid(\"max_partitions must be positive (was \",\n+                           state.write_options.max_partitions, \")\");\n+  }\n+\n+  if (groups.batches.size() > static_cast<size_t>(state.write_options.max_partitions)) {\n\nReview comment:\n       Just to fix the build errors.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-29T12:24:43.363+0000",
                    "updated": "2021-06-29T12:24:43.363+0000",
                    "started": "2021-06-29T12:24:43.363+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "616114",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/616372",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r660563003\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -451,7 +451,12 @@ Status WriteNextBatch(WriteState* state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state->write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n-  if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\n+  if (state.write_options.max_partitions <= 0) {\n+    return Status::Invalid(\"max_partitions must be positive (was \",\n+                           state.write_options.max_partitions, \")\");\n+  }\n+\n+  if (groups.batches.size() > static_cast<size_t>(state.write_options.max_partitions)) {\n\nReview comment:\n       ```suggestion\r\n     if (state->write_options.max_partitions <= 0) {\r\n       return Status::Invalid(\"max_partitions must be positive (was \",\r\n                              state->write_options.max_partitions, \")\");\r\n     }\r\n   \r\n     if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\r\n   ```\n\n##########\nFile path: cpp/src/arrow/dataset/file_base.cc\n##########\n@@ -451,7 +451,12 @@ Status WriteNextBatch(WriteState* state, const std::shared_ptr<Fragment>& fragme\n   ARROW_ASSIGN_OR_RAISE(auto groups, state->write_options.partitioning->Partition(batch));\n   batch.reset();  // drop to hopefully conserve memory\n \n-  if (groups.batches.size() > static_cast<size_t>(state->write_options.max_partitions)) {\n+  if (state.write_options.max_partitions <= 0) {\n+    return Status::Invalid(\"max_partitions must be positive (was \",\n+                           state.write_options.max_partitions, \")\");\n+  }\n+\n+  if (groups.batches.size() > static_cast<size_t>(state.write_options.max_partitions)) {\n\nReview comment:\n       Just to fix the build errors.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-29T13:50:18.156+0000",
                    "updated": "2021-06-29T13:50:18.156+0000",
                    "started": "2021-06-29T13:50:18.156+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "616372",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/679590",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r746550848\n\n\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -136,9 +139,13 @@ write_dataset <- function(dataset,\n   existing_data_behavior_opts <- c(\"delete_matching\", \"overwrite\", \"error\")\n   existing_data_behavior <- match(match.arg(existing_data_behavior), existing_data_behavior_opts) - 1L\n \n+  if (!is_integerish(max_partitions) || is.na(max_partitions) || max_partitions < 0) {\n\nReview comment:\n       ```suggestion\r\n     if (!is_integerish(max_partitions, n = 1) || is.na(max_partitions) || max_partitions < 0) {\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T12:45:34.598+0000",
                    "updated": "2021-11-10T12:45:34.598+0000",
                    "started": "2021-11-10T12:45:34.598+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679590",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/679616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#discussion_r746596046\n\n\n\n##########\nFile path: r/R/dataset-write.R\n##########\n@@ -136,9 +139,13 @@ write_dataset <- function(dataset,\n   existing_data_behavior_opts <- c(\"delete_matching\", \"overwrite\", \"error\")\n   existing_data_behavior <- match(match.arg(existing_data_behavior), existing_data_behavior_opts) - 1L\n \n+  if (!is_integerish(max_partitions) || is.na(max_partitions) || max_partitions < 0) {\n\nReview comment:\n       TIL about the `n` argument, thanks!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T13:40:23.793+0000",
                    "updated": "2021-11-10T13:40:23.793+0000",
                    "started": "2021-11-10T13:40:23.793+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679616",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/679633",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane closed pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T14:01:33.474+0000",
                    "updated": "2021-11-10T14:01:33.474+0000",
                    "started": "2021-11-10T14:01:33.474+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679633",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/679634",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-965213525\n\n\n   Benchmark runs are scheduled for baseline = f51dc3475273d2cb5f571b534283faf892a4d701 and contender = 3c1f702e0542290c089b94bdf24e8315e1f95655. 3c1f702e0542290c089b94bdf24e8315e1f95655 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b355e096096145128976c30dc0f2eca6...fbf5ce4aff3c4efabeff619fd30f449d/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/1cc4faada3244badbb70284d7daf60cb...6c77f74992144b15b77746189950c26b/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/dc3ac8fe359041f4bf665c45aa9a9b57...553c3156a5b245378e3c5ea40887e9de/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T14:02:18.198+0000",
                    "updated": "2021-11-10T14:02:18.198+0000",
                    "started": "2021-11-10T14:02:18.198+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679634",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/679658",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-965213525\n\n\n   Benchmark runs are scheduled for baseline = f51dc3475273d2cb5f571b534283faf892a4d701 and contender = 3c1f702e0542290c089b94bdf24e8315e1f95655. 3c1f702e0542290c089b94bdf24e8315e1f95655 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b355e096096145128976c30dc0f2eca6...fbf5ce4aff3c4efabeff619fd30f449d/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/1cc4faada3244badbb70284d7daf60cb...6c77f74992144b15b77746189950c26b/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/dc3ac8fe359041f4bf665c45aa9a9b57...553c3156a5b245378e3c5ea40887e9de/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T14:36:27.194+0000",
                    "updated": "2021-11-10T14:36:27.194+0000",
                    "started": "2021-11-10T14:36:27.193+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679658",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/680054",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-965213525\n\n\n   Benchmark runs are scheduled for baseline = f51dc3475273d2cb5f571b534283faf892a4d701 and contender = 3c1f702e0542290c089b94bdf24e8315e1f95655. 3c1f702e0542290c089b94bdf24e8315e1f95655 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b355e096096145128976c30dc0f2eca6...fbf5ce4aff3c4efabeff619fd30f449d/)\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/1cc4faada3244badbb70284d7daf60cb...6c77f74992144b15b77746189950c26b/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/dc3ac8fe359041f4bf665c45aa9a9b57...553c3156a5b245378e3c5ea40887e9de/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T23:56:22.676+0000",
                    "updated": "2021-11-10T23:56:22.676+0000",
                    "started": "2021-11-10T23:56:22.675+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "680054",
                    "issueId": "13370694"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/worklog/680056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #9972:\nURL: https://github.com/apache/arrow/pull/9972#issuecomment-965213525\n\n\n   Benchmark runs are scheduled for baseline = f51dc3475273d2cb5f571b534283faf892a4d701 and contender = 3c1f702e0542290c089b94bdf24e8315e1f95655. 3c1f702e0542290c089b94bdf24e8315e1f95655 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/b355e096096145128976c30dc0f2eca6...fbf5ce4aff3c4efabeff619fd30f449d/)\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/1cc4faada3244badbb70284d7daf60cb...6c77f74992144b15b77746189950c26b/)\n   [Finished :arrow_down:0.18% :arrow_up:0.04%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/dc3ac8fe359041f4bf665c45aa9a9b57...553c3156a5b245378e3c5ea40887e9de/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-11T00:00:28.678+0000",
                    "updated": "2021-11-11T00:00:28.678+0000",
                    "started": "2021-11-11T00:00:28.678+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "680056",
                    "issueId": "13370694"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 12600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2cfd9674[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@360351fc[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@38d6745c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@14f65e0b[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1325d164[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2bdd28be[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20a2cd0d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@602c914[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b118641[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@794bc145[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4fb7b1c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5f6d8b4f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12600,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Nov 10 14:01:19 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-11-10T14:01:19.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12315/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-04-09T15:42:32.000+0000",
        "updated": "2021-12-06T01:10:34.000+0000",
        "timeoriginalestimate": null,
        "description": "the Python docs show that we can pass, say, 1025 partitions\r\nhttps://arrow.apache.org/docs/_modules/pyarrow/dataset.html\r\n\r\nbut in R this argument doesn't exist, it would be good to add this for arrow v4.0.0\r\n\r\nthis is useful, for example, with intl trade datasets:\r\n\r\n{code:java}\r\n# d = UN COMTRADE - World's bilateral flows 2019\r\n# 13,050,535 x 22 data.frame\r\nd %>%\r\n          group_by(Year, `Reporter ISO`, `Partner ISO`) %>%\r\n          write_dataset(\"parquet\", hive_style = F)\r\n\r\nError: Invalid: Fragment would be written into 12808 partitions. This exceeds the maximum of 1024\r\n\r\n{code}\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] add max_partitions argument to write_dataset()",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/comment/17349564",
                    "id": "17349564",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pachamaltese",
                        "name": "pachamaltese",
                        "key": "pachamaltese",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pachamaltese&avatarId=45930",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pachamaltese&avatarId=45930",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pachamaltese&avatarId=45930",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pachamaltese&avatarId=45930"
                        },
                        "displayName": "Mauricio 'Pach\u00e1' Vargas Sep\u00falveda",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "related to ARROW-12373, the PR for this ticket adds a verification so that instead of converting values of -n, ..., -3, -2, -1 max partitions to 18,446,744,073,709,551,613, it returns an error message about feasibility.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pachamaltese",
                        "name": "pachamaltese",
                        "key": "pachamaltese",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pachamaltese&avatarId=45930",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pachamaltese&avatarId=45930",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pachamaltese&avatarId=45930",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pachamaltese&avatarId=45930"
                        },
                        "displayName": "Mauricio 'Pach\u00e1' Vargas Sep\u00falveda",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-05-21T23:47:36.679+0000",
                    "updated": "2021-05-21T23:47:36.679+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/comment/17435101",
                    "id": "17435101",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=matmat",
                        "name": "matmat",
                        "key": "matmat",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Matt Matolcsi",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Hello, I am running into this issue with Arrow 6.0.0.9000, would it be possible to implement the max_partitions argument for write_dataset()?\r\n\r\nThanks everyone for your hard work on Arrow, it is really great to be able to use it, especially in R.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=matmat",
                        "name": "matmat",
                        "key": "matmat",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Matt Matolcsi",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-27T23:48:30.786+0000",
                    "updated": "2021-10-27T23:48:30.786+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370694/comment/17441756",
                    "id": "17441756",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 9972\n[https://github.com/apache/arrow/pull/9972]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-11-10T14:01:19.590+0000",
                    "updated": "2021-11-10T14:01:19.590+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z0pq2g:",
        "customfield_12314139": null
    }
}