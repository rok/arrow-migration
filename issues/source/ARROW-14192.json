{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13404476",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476",
    "key": "ARROW-14192",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available",
            "query-engine"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14192/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 17,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/659173",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace opened a new pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294\n\n\n   While scanning we do our best to readahead multiple files so we will read files 1, 2, 3, and 4 all at the same time.  This helps to maintain bandwidth when some files hit a snag (sometimes happens on AWS).  However, when doing an ordered scan, this can cause backpressure to explode when there is a slow consumer.\r\n   \r\n   The sequencer (placed at the end of the pipeline) can get into a situation where it pulls aggressively from files 2, 3, and 4 while waiting for the next chunk from file 1.  Since the sequencer is consuming the batches the backpressure mechanism thinks they are being consumed.  However, the actual consumer is leaving the batches piling up at the sequencer.\r\n   \r\n   This PR introduces one possible solution (and it may be the only possible solution) which is to sequence the batches at merge time (early in the pipeline).  The sequencer won't need to pull aggressively and backpressure will be maintained.  This pretty significantly reduces (but does not eliminate) the amount of file readahead we do in ordered scans.  We can worry about that if it ends up being a bottleneck at some point but for now I think it is better we do not explode RAM.\r\n   \r\n   This builds on ARROW-13611 and will remain in draft until that PR has merged.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-02T02:56:35.937+0000",
                    "updated": "2021-10-02T02:56:35.937+0000",
                    "started": "2021-10-02T02:56:35.937+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "659173",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/659174",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-932670036\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-02T02:56:49.693+0000",
                    "updated": "2021-10-02T02:56:49.693+0000",
                    "started": "2021-10-02T02:56:49.693+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "659174",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731284492\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -422,6 +422,42 @@ def test_scanner(dataset, dataset_reader):\n     assert table.num_rows == scanner.count_rows()\n \n \n+def test_scanner_backpressure():\n+    batch = pa.record_batch([pa.array([1, 2, 3])], names=['data'])\n+    num_read = 0\n+    min_read = 64  # From kDefaultBackpressureHigh in scanner.h\n+    end = 200\n+\n+    def counting_generator():\n+        nonlocal num_read\n+        while num_read < end:\n+            time.sleep(0.01)\n+            num_read += 1\n+            yield batch\n+\n+    scanner = ds.Scanner.from_batches(\n+        counting_generator(), batch.schema, use_threads=True, use_async=True)\n+\n+    _batch_iter = scanner.to_batches()  # This line starts the scan\n+\n+    start = time.time()\n+\n+    def duration():\n+        return time.time() - start\n+\n+    last_num_read = 0\n+    backpressure_probably_hit = False\n+    while duration() < 10:\n+        if num_read > min_read and num_read == last_num_read:\n+            backpressure_probably_hit = True\n+            break\n+        last_num_read = num_read\n+        time.sleep(0.5)\n\nReview comment:\n       I suppose we have a good number of these now, but timing-based tests always make me feel somewhat icky. Is there value to testing this in Python as well as C++?\n\n##########\nFile path: cpp/src/arrow/util/async_generator.h\n##########\n@@ -711,6 +711,26 @@ AsyncGenerator<T> MakeSerialReadaheadGenerator(AsyncGenerator<T> source_generato\n   return SerialReadaheadGenerator<T>(std::move(source_generator), max_readahead);\n }\n \n+template <typename T>\n\nReview comment:\n       nit: add a doc comment like for the others? This is an \"eagerly evaluated\" (\"hot\" I think ReactiveX calls it?) generator?\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.cc\n##########\n@@ -1175,8 +1179,15 @@ Result<compute::ExecNode*> MakeScanNode(compute::ExecPlan* plan,\n   ARROW_ASSIGN_OR_RAISE(auto batch_gen_gen,\n                         FragmentsToBatches(std::move(fragment_gen), scan_options));\n \n-  auto merged_batch_gen =\n-      MakeMergedGenerator(std::move(batch_gen_gen), scan_options->fragment_readahead);\n+  AsyncGenerator<EnumeratedRecordBatch> merged_batch_gen;\n+  if (require_sequenced_output) {\n+    ARROW_ASSIGN_OR_RAISE(merged_batch_gen,\n+                          MakeSequencedMergedGenerator(std::move(batch_gen_gen),\n+                                                       scan_options->fragment_readahead));\n\nReview comment:\n       (Though I suppose it shouldn't hurt.)\n\n##########\nFile path: cpp/src/arrow/util/async_generator.h\n##########\n@@ -1156,6 +1176,23 @@ AsyncGenerator<T> MakeMergedGenerator(AsyncGenerator<AsyncGenerator<T>> source,\n   return MergedGenerator<T>(std::move(source), max_subscriptions);\n }\n \n+template <typename T>\n+Result<AsyncGenerator<T>> MakeSequencedMergedGenerator(\n+    AsyncGenerator<AsyncGenerator<T>> source, int max_subscriptions) {\n+  if (max_subscriptions < 0) {\n+    return Status::Invalid(\"max_subscriptions must be a positive integer\");\n+  }\n+  if (max_subscriptions == 1) {\n+    return Status::Invalid(\"Use MakeConcatenatedGenerator is max_subscriptions is 1\");\n\nReview comment:\n       ```suggestion\r\n       return Status::Invalid(\"Use MakeConcatenatedGenerator if max_subscriptions is 1\");\r\n   ```\n\n##########\nFile path: cpp/src/arrow/util/async_generator.h\n##########\n@@ -1156,6 +1176,23 @@ AsyncGenerator<T> MakeMergedGenerator(AsyncGenerator<AsyncGenerator<T>> source,\n   return MergedGenerator<T>(std::move(source), max_subscriptions);\n }\n \n+template <typename T>\n+Result<AsyncGenerator<T>> MakeSequencedMergedGenerator(\n\nReview comment:\n       So just to make sure I get this right, this will \"kick off\" some number of sub-generators (so they start doing work), but will only actually pull from the first one (so the others shouldn't queue up too much)?\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.cc\n##########\n@@ -1175,8 +1179,15 @@ Result<compute::ExecNode*> MakeScanNode(compute::ExecPlan* plan,\n   ARROW_ASSIGN_OR_RAISE(auto batch_gen_gen,\n                         FragmentsToBatches(std::move(fragment_gen), scan_options));\n \n-  auto merged_batch_gen =\n-      MakeMergedGenerator(std::move(batch_gen_gen), scan_options->fragment_readahead);\n+  AsyncGenerator<EnumeratedRecordBatch> merged_batch_gen;\n+  if (require_sequenced_output) {\n+    ARROW_ASSIGN_OR_RAISE(merged_batch_gen,\n+                          MakeSequencedMergedGenerator(std::move(batch_gen_gen),\n+                                                       scan_options->fragment_readahead));\n\nReview comment:\n       Does this mean MakeSequencingGenerator is now redundant, since we pull from subgenerators sequentially?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T20:19:30.374+0000",
                    "updated": "2021-10-18T20:19:30.374+0000",
                    "started": "2021-10-18T20:19:30.373+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666519",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666553",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731321783\n\n\n\n##########\nFile path: cpp/src/arrow/util/async_generator.h\n##########\n@@ -1156,6 +1176,23 @@ AsyncGenerator<T> MakeMergedGenerator(AsyncGenerator<AsyncGenerator<T>> source,\n   return MergedGenerator<T>(std::move(source), max_subscriptions);\n }\n \n+template <typename T>\n+Result<AsyncGenerator<T>> MakeSequencedMergedGenerator(\n\nReview comment:\n       Yes.  After implementing it I realized it may be a bit of a premature optimization (we could probably just use a concatenated generator) but it will do exactly as you describe.  So it has a slight advantage over the concatenated generator in that it \"primes\" future generators even if it doesn't start reading from them.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:15:09.600+0000",
                    "updated": "2021-10-18T21:15:09.600+0000",
                    "started": "2021-10-18T21:15:09.599+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666553",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666556",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731323572\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.cc\n##########\n@@ -1175,8 +1179,15 @@ Result<compute::ExecNode*> MakeScanNode(compute::ExecPlan* plan,\n   ARROW_ASSIGN_OR_RAISE(auto batch_gen_gen,\n                         FragmentsToBatches(std::move(fragment_gen), scan_options));\n \n-  auto merged_batch_gen =\n-      MakeMergedGenerator(std::move(batch_gen_gen), scan_options->fragment_readahead);\n+  AsyncGenerator<EnumeratedRecordBatch> merged_batch_gen;\n+  if (require_sequenced_output) {\n+    ARROW_ASSIGN_OR_RAISE(merged_batch_gen,\n+                          MakeSequencedMergedGenerator(std::move(batch_gen_gen),\n+                                                       scan_options->fragment_readahead));\n\nReview comment:\n       No, it is not redundant.  We still need to resequence at the end (currently MakeSequencingGenerator is used after the plan) because there is no guarantee operations like filter or project will maintain the ordering.  Although, we could introduce a sequenced sink which would allow us to get rid of MakeSequencingGenerator.  We can tackle that when we tackle general sequencing.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:18:22.252+0000",
                    "updated": "2021-10-18T21:18:22.252+0000",
                    "started": "2021-10-18T21:18:22.252+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666556",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666558",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731326001\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.cc\n##########\n@@ -1175,8 +1179,15 @@ Result<compute::ExecNode*> MakeScanNode(compute::ExecPlan* plan,\n   ARROW_ASSIGN_OR_RAISE(auto batch_gen_gen,\n                         FragmentsToBatches(std::move(fragment_gen), scan_options));\n \n-  auto merged_batch_gen =\n-      MakeMergedGenerator(std::move(batch_gen_gen), scan_options->fragment_readahead);\n+  AsyncGenerator<EnumeratedRecordBatch> merged_batch_gen;\n+  if (require_sequenced_output) {\n+    ARROW_ASSIGN_OR_RAISE(merged_batch_gen,\n+                          MakeSequencedMergedGenerator(std::move(batch_gen_gen),\n+                                                       scan_options->fragment_readahead));\n\nReview comment:\n       Ah, indeed, you're right. Thanks.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:22:21.423+0000",
                    "updated": "2021-10-18T21:22:21.423+0000",
                    "started": "2021-10-18T21:22:21.423+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666558",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666560",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731329143\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -422,6 +422,42 @@ def test_scanner(dataset, dataset_reader):\n     assert table.num_rows == scanner.count_rows()\n \n \n+def test_scanner_backpressure():\n+    batch = pa.record_batch([pa.array([1, 2, 3])], names=['data'])\n+    num_read = 0\n+    min_read = 64  # From kDefaultBackpressureHigh in scanner.h\n+    end = 200\n+\n+    def counting_generator():\n+        nonlocal num_read\n+        while num_read < end:\n+            time.sleep(0.01)\n+            num_read += 1\n+            yield batch\n+\n+    scanner = ds.Scanner.from_batches(\n+        counting_generator(), batch.schema, use_threads=True, use_async=True)\n+\n+    _batch_iter = scanner.to_batches()  # This line starts the scan\n+\n+    start = time.time()\n+\n+    def duration():\n+        return time.time() - start\n+\n+    last_num_read = 0\n+    backpressure_probably_hit = False\n+    while duration() < 10:\n+        if num_read > min_read and num_read == last_num_read:\n+            backpressure_probably_hit = True\n+            break\n+        last_num_read = num_read\n+        time.sleep(0.5)\n\nReview comment:\n       If we do something like https://issues.apache.org/jira/browse/ARROW-14367 we can remove the timing dependency.  That being said, I understand the concern, and there was similar concern in the dataset write backpressure PR: https://github.com/apache/arrow/pull/11286#discussion_r728555922\r\n   \r\n   I will remove this test from this PR and rely on the existing python test.  When ARROW-14367 is implemented the timing dependency can be removed from the other test (and we can maybe reintroduce this test at that point).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:28:10.693+0000",
                    "updated": "2021-10-18T21:28:10.693+0000",
                    "started": "2021-10-18T21:28:10.693+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666560",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666564",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731338714\n\n\n\n##########\nFile path: cpp/src/arrow/util/async_generator.h\n##########\n@@ -711,6 +711,26 @@ AsyncGenerator<T> MakeSerialReadaheadGenerator(AsyncGenerator<T> source_generato\n   return SerialReadaheadGenerator<T>(std::move(source_generator), max_readahead);\n }\n \n+template <typename T>\n\nReview comment:\n       Added, thanks for the catch.  I also realized our grammar was a bit mixed on these comments so I cleaned that up which introduced a bit of noise to the PR.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:45:56.890+0000",
                    "updated": "2021-10-18T21:45:56.890+0000",
                    "started": "2021-10-18T21:45:56.890+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666564",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666565",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#discussion_r731338879\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -422,6 +422,42 @@ def test_scanner(dataset, dataset_reader):\n     assert table.num_rows == scanner.count_rows()\n \n \n+def test_scanner_backpressure():\n+    batch = pa.record_batch([pa.array([1, 2, 3])], names=['data'])\n+    num_read = 0\n+    min_read = 64  # From kDefaultBackpressureHigh in scanner.h\n+    end = 200\n+\n+    def counting_generator():\n+        nonlocal num_read\n+        while num_read < end:\n+            time.sleep(0.01)\n+            num_read += 1\n+            yield batch\n+\n+    scanner = ds.Scanner.from_batches(\n+        counting_generator(), batch.schema, use_threads=True, use_async=True)\n+\n+    _batch_iter = scanner.to_batches()  # This line starts the scan\n+\n+    start = time.time()\n+\n+    def duration():\n+        return time.time() - start\n+\n+    last_num_read = 0\n+    backpressure_probably_hit = False\n+    while duration() < 10:\n+        if num_read > min_read and num_read == last_num_read:\n+            backpressure_probably_hit = True\n+            break\n+        last_num_read = num_read\n+        time.sleep(0.5)\n\nReview comment:\n       The test has been removed.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:46:10.035+0000",
                    "updated": "2021-10-18T21:46:10.035+0000",
                    "started": "2021-10-18T21:46:10.035+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666565",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666566",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946193222\n\n\n   Rebased and addressed PR comments.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-18T21:47:23.425+0000",
                    "updated": "2021-10-18T21:47:23.425+0000",
                    "started": "2021-10-18T21:47:23.425+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666566",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666662",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946342174\n\n\n   CI failures are unrelated (could not find LLVM) and these tests passed on earlier versions.  I will proceed with merging.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T03:44:15.364+0000",
                    "updated": "2021-10-19T03:44:15.364+0000",
                    "started": "2021-10-19T03:44:15.363+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666662",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666663",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace closed pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T03:45:30.163+0000",
                    "updated": "2021-10-19T03:45:30.163+0000",
                    "started": "2021-10-19T03:45:30.162+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666663",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666664",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946342917\n\n\n   Benchmark runs are scheduled for baseline = f2f663be0a87e13c9cd5403dea51379deb4cf04d and contender = 9abd2b140813dfa941a592764ea07d38d2f0644e. 9abd2b140813dfa941a592764ea07d38d2f0644e is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/9b557e9d7ecf475aa5994d697ce6d05e...aba975bddbc940ceb08491d8e5687ed3/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/936d3a66840e49fc87988b3ae9ac8d25...ce938484130d40c19153d605d377a2c0/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/62b718ae16a64feead06fc207e71faea...b7dc6303e083457494557b6856992323/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T03:46:25.921+0000",
                    "updated": "2021-10-19T03:46:25.921+0000",
                    "started": "2021-10-19T03:46:25.921+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666664",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666666",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946342917\n\n\n   Benchmark runs are scheduled for baseline = f2f663be0a87e13c9cd5403dea51379deb4cf04d and contender = 9abd2b140813dfa941a592764ea07d38d2f0644e. 9abd2b140813dfa941a592764ea07d38d2f0644e is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/9b557e9d7ecf475aa5994d697ce6d05e...aba975bddbc940ceb08491d8e5687ed3/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/936d3a66840e49fc87988b3ae9ac8d25...ce938484130d40c19153d605d377a2c0/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/62b718ae16a64feead06fc207e71faea...b7dc6303e083457494557b6856992323/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T03:58:21.482+0000",
                    "updated": "2021-10-19T03:58:21.482+0000",
                    "started": "2021-10-19T03:58:21.482+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666666",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666690",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946342917\n\n\n   Benchmark runs are scheduled for baseline = f2f663be0a87e13c9cd5403dea51379deb4cf04d and contender = 9abd2b140813dfa941a592764ea07d38d2f0644e. 9abd2b140813dfa941a592764ea07d38d2f0644e is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/9b557e9d7ecf475aa5994d697ce6d05e...aba975bddbc940ceb08491d8e5687ed3/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/936d3a66840e49fc87988b3ae9ac8d25...ce938484130d40c19153d605d377a2c0/)\n   [Finished :arrow_down:0.4% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/62b718ae16a64feead06fc207e71faea...b7dc6303e083457494557b6856992323/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T05:31:25.936+0000",
                    "updated": "2021-10-19T05:31:25.936+0000",
                    "started": "2021-10-19T05:31:25.936+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666690",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666691",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946342917\n\n\n   Benchmark runs are scheduled for baseline = f2f663be0a87e13c9cd5403dea51379deb4cf04d and contender = 9abd2b140813dfa941a592764ea07d38d2f0644e. 9abd2b140813dfa941a592764ea07d38d2f0644e is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/9b557e9d7ecf475aa5994d697ce6d05e...aba975bddbc940ceb08491d8e5687ed3/)\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/936d3a66840e49fc87988b3ae9ac8d25...ce938484130d40c19153d605d377a2c0/)\n   [Finished :arrow_down:0.4% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/62b718ae16a64feead06fc207e71faea...b7dc6303e083457494557b6856992323/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T05:41:31.016+0000",
                    "updated": "2021-10-19T05:41:31.016+0000",
                    "started": "2021-10-19T05:41:31.016+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666691",
                    "issueId": "13404476"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/worklog/666773",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on pull request #11294:\nURL: https://github.com/apache/arrow/pull/11294#issuecomment-946474635\n\n\n   @westonpace It seems that \"C++ / AMD64 Ubuntu 20.04 C++ ASAN UBSAN\" is failed by this.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-19T08:20:05.916+0000",
                    "updated": "2021-10-19T08:20:05.916+0000",
                    "started": "2021-10-19T08:20:05.915+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "666773",
                    "issueId": "13404476"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 10200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3a253898[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32982090[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6262e5f7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@118dc58b[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d5532d6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4b26fa93[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e9ee35d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@41c0c898[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@551781f4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@29991ba7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@605491c2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@27971158[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 19 03:45:20 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-10-19T03:45:20.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14192/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-10-01T11:27:55.000+0000",
        "updated": "2021-10-19T08:20:07.000+0000",
        "timeoriginalestimate": null,
        "description": "ARROW-13611 adds a backpressure mechanism that works for unordered scans.  However, this backpressure is not properly applied on ordered (i.e. ScanBatches and not ScanBatchedUnordered) scans.  \r\n\r\nThe fix will be to modify the merge generator used on ordered scans so that, while it still will read ahead somewhat on several files, it will never deliver batches except from the currently read file.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Dataset] Backpressure broken on ordered scans",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13404476/comment/17430301",
                    "id": "17430301",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 11294\n[https://github.com/apache/arrow/pull/11294]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-19T03:45:20.286+0000",
                    "updated": "2021-10-19T03:45:20.286+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0vhls:",
        "customfield_12314139": null
    }
}