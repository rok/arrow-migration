{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13426704",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704",
    "key": "ARROW-15580",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12635873",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12635873",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13434449",
                    "key": "ARROW-15966",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13434449",
                    "fields": {
                        "summary": "pytz required by pyarrow but not included in package metadata requirements.",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12636279",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12636279",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "outwardIssue": {
                    "id": "13434449",
                    "key": "ARROW-15966",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13434449",
                    "fields": {
                        "summary": "pytz required by pyarrow but not included in package metadata requirements.",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12635874",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12635874",
                "type": {
                    "id": "12310040",
                    "name": "Required",
                    "inward": "is required by",
                    "outward": "requires",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310040"
                },
                "outwardIssue": {
                    "id": "13432866",
                    "key": "ARROW-15882",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432866",
                    "fields": {
                        "summary": "[Ci][Python] Nightly hypothesis build is not actually running the hypothesis tests",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=alenka",
            "name": "alenka",
            "key": "alenkaf",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Alenka Frim",
            "active": true,
            "timeZone": "Europe/Ljubljana"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333001",
                "id": "12333001",
                "name": "Packaging"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=woodmd",
            "name": "woodmd",
            "key": "JIRAUSER284723",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Mark Wood",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=woodmd",
            "name": "woodmd",
            "key": "JIRAUSER284723",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Mark Wood",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 32400,
            "total": 32400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 32400,
            "total": 32400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15580/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 54,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/733817",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF opened a new pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522\n\n\n   This PR tries to change `pytz` module to be an optional dependency.\r\n   \r\n   The tests that install/use `pytz` had to be changed. \r\n   \r\n   I ran all `pyarrow` tests locally with and without `pytz` installed. We could update the build without Pandas to not include `pytz` either so the code could be checked on the CI also.\r\n   \r\n   - [ ] Change `pytz` to an optional dependency\r\n   - [ ] Change the use of `PyObject_HasAttrString` to use `PyObject_IsInstance`\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-28T12:30:09.181+0000",
                    "updated": "2022-02-28T12:30:09.181+0000",
                    "started": "2022-02-28T12:30:09.181+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "733817",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/733818",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#issuecomment-1054208912\n\n\n   https://issues.apache.org/jira/browse/ARROW-15580\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-28T12:30:33.650+0000",
                    "updated": "2022-02-28T12:30:33.650+0000",
                    "started": "2022-02-28T12:30:33.650+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "733818",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/734553",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r816755156\n\n\n\n##########\nFile path: cpp/src/arrow/python/datetime.cc\n##########\n@@ -391,37 +391,43 @@ Result<std::string> PyTZInfo_utcoffset_hhmm(PyObject* pytzinfo) {\n Result<PyObject*> StringToTzinfo(const std::string& tz) {\n   util::string_view sign_str, hour_str, minute_str;\n   OwnedRef pytz;\n-  RETURN_NOT_OK(internal::ImportModule(\"pytz\", &pytz));\n \n-  if (MatchFixedOffset(tz, &sign_str, &hour_str, &minute_str)) {\n-    int sign = -1;\n-    if (sign_str == \"+\") {\n-      sign = 1;\n-    }\n-    OwnedRef fixed_offset;\n-    RETURN_NOT_OK(internal::ImportFromModule(pytz.obj(), \"FixedOffset\", &fixed_offset));\n-    uint32_t minutes, hours;\n-    if (!::arrow::internal::ParseUnsigned(hour_str.data(), hour_str.size(), &hours) ||\n-        !::arrow::internal::ParseUnsigned(minute_str.data(), minute_str.size(),\n-                                          &minutes)) {\n-      return Status::Invalid(\"Invalid timezone: \", tz);\n-    }\n-    OwnedRef total_minutes(PyLong_FromLong(\n-        sign * ((static_cast<int>(hours) * 60) + static_cast<int>(minutes))));\n-    RETURN_IF_PYERROR();\n-    auto tzinfo =\n-        PyObject_CallFunctionObjArgs(fixed_offset.obj(), total_minutes.obj(), NULL);\n-    RETURN_IF_PYERROR();\n-    return tzinfo;\n+  if (internal::ImportModule(\"pytz\", &pytz).ok()) {\n+    RETURN_NOT_OK(internal::ImportModule(\"pytz\", &pytz));\n+\n+    if (MatchFixedOffset(tz, &sign_str, &hour_str, &minute_str)) {\n+      int sign = -1;\n+      if (sign_str == \"+\") {\n+        sign = 1;\n+      }\n+      OwnedRef fixed_offset;\n+      RETURN_NOT_OK(internal::ImportFromModule(pytz.obj(), \"FixedOffset\", &fixed_offset));\n+      uint32_t minutes, hours;\n+      if (!::arrow::internal::ParseUnsigned(hour_str.data(), hour_str.size(), &hours) ||\n+          !::arrow::internal::ParseUnsigned(minute_str.data(), minute_str.size(),\n+                                            &minutes)) {\n+        return Status::Invalid(\"Invalid timezone: \", tz);\n+      }\n+      OwnedRef total_minutes(PyLong_FromLong(\n+          sign * ((static_cast<int>(hours) * 60) + static_cast<int>(minutes))));\n+      RETURN_IF_PYERROR();\n+      auto tzinfo =\n+          PyObject_CallFunctionObjArgs(fixed_offset.obj(), total_minutes.obj(), NULL);\n+      RETURN_IF_PYERROR();\n+      return tzinfo;\n+      }\n+\n+      OwnedRef timezone;\n\nReview comment:\n       This part needs to be indented one level less?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-01T13:12:48.303+0000",
                    "updated": "2022-03-01T13:12:48.303+0000",
                    "started": "2022-03-01T13:12:48.303+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "734553",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/734556",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r816758132\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       We might want to change this to use `zoneinfo` for recent Python versions, so we don't skip this full test just when pytz is not present.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-01T13:16:52.780+0000",
                    "updated": "2022-03-01T13:16:52.780+0000",
                    "started": "2022-03-01T13:16:52.780+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "734556",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/734557",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r816758829\n\n\n\n##########\nFile path: cpp/src/arrow/python/datetime.cc\n##########\n@@ -391,37 +391,43 @@ Result<std::string> PyTZInfo_utcoffset_hhmm(PyObject* pytzinfo) {\n Result<PyObject*> StringToTzinfo(const std::string& tz) {\n   util::string_view sign_str, hour_str, minute_str;\n   OwnedRef pytz;\n-  RETURN_NOT_OK(internal::ImportModule(\"pytz\", &pytz));\n \n-  if (MatchFixedOffset(tz, &sign_str, &hour_str, &minute_str)) {\n-    int sign = -1;\n-    if (sign_str == \"+\") {\n-      sign = 1;\n-    }\n-    OwnedRef fixed_offset;\n-    RETURN_NOT_OK(internal::ImportFromModule(pytz.obj(), \"FixedOffset\", &fixed_offset));\n-    uint32_t minutes, hours;\n-    if (!::arrow::internal::ParseUnsigned(hour_str.data(), hour_str.size(), &hours) ||\n-        !::arrow::internal::ParseUnsigned(minute_str.data(), minute_str.size(),\n-                                          &minutes)) {\n-      return Status::Invalid(\"Invalid timezone: \", tz);\n-    }\n-    OwnedRef total_minutes(PyLong_FromLong(\n-        sign * ((static_cast<int>(hours) * 60) + static_cast<int>(minutes))));\n-    RETURN_IF_PYERROR();\n-    auto tzinfo =\n-        PyObject_CallFunctionObjArgs(fixed_offset.obj(), total_minutes.obj(), NULL);\n-    RETURN_IF_PYERROR();\n-    return tzinfo;\n+  if (internal::ImportModule(\"pytz\", &pytz).ok()) {\n+    RETURN_NOT_OK(internal::ImportModule(\"pytz\", &pytz));\n+\n+    if (MatchFixedOffset(tz, &sign_str, &hour_str, &minute_str)) {\n+      int sign = -1;\n+      if (sign_str == \"+\") {\n+        sign = 1;\n+      }\n+      OwnedRef fixed_offset;\n+      RETURN_NOT_OK(internal::ImportFromModule(pytz.obj(), \"FixedOffset\", &fixed_offset));\n+      uint32_t minutes, hours;\n+      if (!::arrow::internal::ParseUnsigned(hour_str.data(), hour_str.size(), &hours) ||\n+          !::arrow::internal::ParseUnsigned(minute_str.data(), minute_str.size(),\n+                                            &minutes)) {\n+        return Status::Invalid(\"Invalid timezone: \", tz);\n+      }\n+      OwnedRef total_minutes(PyLong_FromLong(\n+          sign * ((static_cast<int>(hours) * 60) + static_cast<int>(minutes))));\n+      RETURN_IF_PYERROR();\n+      auto tzinfo =\n+          PyObject_CallFunctionObjArgs(fixed_offset.obj(), total_minutes.obj(), NULL);\n+      RETURN_IF_PYERROR();\n+      return tzinfo;\n+      }\n+\n+      OwnedRef timezone;\n\nReview comment:\n       Yes indeed. Will correct - it will resolve the liner CI error also.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-01T13:17:47.289+0000",
                    "updated": "2022-03-01T13:17:47.289+0000",
                    "started": "2022-03-01T13:17:47.289+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "734557",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/735189",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r817522143\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       There are couple of issues I am tying to solve to make this work:\r\n   1. It seems all the tests in `test_strategies.py` are being skipped?\r\n   2. The code I need to change to use `zoneinfo` is here:\r\n   https://github.com/apache/arrow/blob/69682ec944d053a60316c0af903a167eca0f24db/python/pyarrow/tests/strategies.py#L263-L274\r\n   \r\n   but: * I would need to install `timedelta,` which we do not depend on currently, to get the offset into a `timedelta` instance. ** The current code for the offset doesn't seem to work if I play with it locally. Example:\r\n   \r\n   ```python\r\n   >>> import pyarrow as pa\r\n   >>> \r\n   >>> ty = pa.timestamp('s', tz='+07:30')\r\n   >>> pa.types.is_timestamp(ty)\r\n   True\r\n   \r\n   >>> offset_hours = int(ty.tz) # This errors\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   ValueError: invalid literal for int() with base 10: '+07:30'\r\n   \r\n   >>> import pytz\r\n   >>> tz = pytz.timezone(ty.tz) # This also errors\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n     File \"/Users/alenkafrim/repos/pyarrow-dev-9/lib/python3.9/site-packages/pytz/__init__.py\", line 188, in timezone\r\n       raise UnknownTimeZoneError(zone)\r\n   pytz.exceptions.UnknownTimeZoneError: '+07:30'\r\n   ```\r\n   This works:\r\n   ```python\r\n   >>> ty = pa.timestamp('s', tz='America/New_York')\r\n   >>> pa.types.is_timestamp(ty)\r\n   True\r\n   >>> pytz.timezone(ty.tz)\r\n   <DstTzInfo 'America/New_York' LMT-1 day, 19:04:00 STD>\r\n   ```\r\n   \r\n   My idea for a current change would be as follows. But it uses `timedelta` and the tests are being skipped so I am not sure if this works.\r\n   ```python\r\n     elif pa.types.is_timestamp(ty):\r\n         min_int64 = -(2**63)\r\n         max_int64 = 2**63 - 1\r\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\r\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\r\n         try:\r\n             offset = ty.tz.split(\":\")\r\n             offset_hours = int(offset[0])\r\n             offset_min = int(offset[1])\r\n             tz = timedelta(hours=offset_hours, minutes=offset_min)\r\n         except ValueError:\r\n             tz = ZoneInfo(ty.tz)\r\n         value = st.datetimes(timezones=st.just(tz), min_value=min_datetime,\r\n                              max_value=max_datetime)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-02T09:50:38.139+0000",
                    "updated": "2022-03-02T09:50:38.139+0000",
                    "started": "2022-03-02T09:50:38.139+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "735189",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/735811",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r818420435\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       > It seems all the tests in `test_strategies.py` are being skipped?\r\n   \r\n   Yeah, it seems you need to manually enable them by passing `--enable-hypothesis` flag to pytest (I struggled with this in the past as well, I remember. This is documented .. but easy to miss: https://arrow.apache.org/docs/dev/developers/python.html#test-groups\r\n   \r\n   > I would need to install `timedelta`,\r\n   \r\n   That's not about the standard library `datetime.timedelta`?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-03T08:31:11.839+0000",
                    "updated": "2022-03-03T08:31:11.839+0000",
                    "started": "2022-03-03T08:31:11.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "735811",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/735819",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r818433297\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       Thanks for the suggestion! I have totally missed the Test Groups part of the documentation.\r\n   \r\n   As for the `timedelta` I got a bit confused, yes, you are absolutely right. Will add the change today.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-03T08:47:45.714+0000",
                    "updated": "2022-03-03T08:47:45.714+0000",
                    "started": "2022-03-03T08:47:45.713+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "735819",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/735896",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r818590997\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       With  `--enable-hypothesis` flag in pytest 5 tests are still being skipped and I wasn't able to check the code change from the `test_arrays`. Any clue what is causing them to get skipped? \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-03T12:05:23.346+0000",
                    "updated": "2022-03-03T12:05:23.346+0000",
                    "started": "2022-03-03T12:05:23.345+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "735896",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/736530",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r819366943\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +233,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"ZoneInfo\")\n+    import ZoneInfo\n\nReview comment:\n       ```suggestion\r\n       zoneinfo = pytest.importorskip(\"zoneinfo\")\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T08:38:13.077+0000",
                    "updated": "2022-03-04T08:38:13.077+0000",
                    "started": "2022-03-04T08:38:13.077+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736530",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/736532",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r819367694\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +278,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n         except ValueError:\n-            tz = pytz.timezone(ty.tz)\n+            tz = ZoneInfo(ty.tz)\n\nReview comment:\n       ```suggestion\r\n               tz = zoneinfo.ZoneInfo(ty.tz)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T08:39:18.225+0000",
                    "updated": "2022-03-04T08:39:18.225+0000",
                    "started": "2022-03-04T08:39:18.224+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736532",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/736534",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r819369771\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +231,9 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    pytest.importorskip(\"pytz\")\n\nReview comment:\n       > 5 tests are still being skipped and I wasn't able to check the code change from the `test_arrays`\r\n   \r\n   For seeing the reason something is skipped, you can pass `-r S` to pytest:\r\n   \r\n   ```\r\n   $ pytest python/pyarrow/tests/test_array.py --enable-hypothesis -r S\r\n   ..\r\n   ====================================== short test summary info ==============================\r\n   SKIPPED [1] python/pyarrow/tests/conftest.py:221: nopandas NOT enabled\r\n   SKIPPED [1] python/pyarrow/tests/strategies.py:236: could not import 'ZoneInfo': No module named 'ZoneInfo'\r\n   SKIPPED [2] python/pyarrow/tests/conftest.py:221: large_memory NOT enabled\r\n   ====================================== 213 passed, 4 skipped in 0.87s =========================\r\n   ```\r\n   \r\n   So one test is skipped because of pandas being present, and two tests are skipped by default because they are \"large memory\" tests. One because `ZoneInfo` could not be imported, but so that was actually because of a bug here (the module name is lowercase, see the inline comment below).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T08:42:15.561+0000",
                    "updated": "2022-03-04T08:42:15.561+0000",
                    "started": "2022-03-04T08:42:15.561+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736534",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738670",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#issuecomment-1062799778\n\n\n   @github-actions crossbow submit test-conda-python-3.8-hypothesis\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T10:57:54.863+0000",
                    "updated": "2022-03-09T10:57:54.863+0000",
                    "started": "2022-03-09T10:57:54.863+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738670",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738672",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#issuecomment-1062800945\n\n\n   Revision: 5e531a0ddb23d927f9f9edefc7e13a50ca973e95\n   \n   Submitted crossbow builds: [ursacomputing/crossbow @ actions-1733](https://github.com/ursacomputing/crossbow/branches/all?query=actions-1733)\n   \n   |Task|Status|\n   |----|------|\n   |test-conda-python-3.8-hypothesis|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1733-github-test-conda-python-3.8-hypothesis)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1733-github-test-conda-python-3.8-hypothesis)|\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T10:59:32.174+0000",
                    "updated": "2022-03-09T10:59:32.174+0000",
                    "started": "2022-03-09T10:59:32.174+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738672",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738673",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r822521291\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -224,6 +233,8 @@ def _pymap(draw, key_type, value_type, size, nullable=True):\n \n @st.composite\n def arrays(draw, type, size=None, nullable=True):\n+    zoneinfo = pytest.importorskip(\"zoneinfo\")\n\nReview comment:\n       I _think_ we can move this import to the `elif pa.types.is_timestamp(ty):` block, so the test gets only skipped when using a timestamp type \n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -96,10 +99,16 @@\n     pa.time64('us'),\n     pa.time64('ns')\n ])\n+if tzst:\n+    timezones = st.one_of(st.none(), tzst.timezones())\n+elif zoneinfo:\n\nReview comment:\n       `zoneinfo` is not yet defined or imported at this point?\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n\nReview comment:\n       We are not actually using this, I think? (since the `tz` that gets generated above is either None or a zone, but never a fixed offset string?)\r\n   \r\n   (we could update the `timezones` strategy to also included fixed offsets, but since that's not supported out of the box by hypothesis, I think it is fine to leave this as a potential follow-up)\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n         except ValueError:\n-            tz = pytz.timezone(ty.tz)\n+            tz = zoneinfo.ZoneInfo(ty.tz)\n\nReview comment:\n       This might need a `if ty.tz is not None:` ? (since the timezone strategy can now also return None)\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -25,12 +25,14 @@\n from datetime import date, datetime, time, timedelta, timezone\n \n import hypothesis as h\n-import hypothesis.extra.pytz as tzst\n+try:\n+    import hypothesis.extra.pytz as tzst\n\nReview comment:\n       I _think_ we could also use the `timezones` strategy from `pyarrow.tests.strategies` (which is already import as `past`), so then we don't have to redefine it here with the `if tzst: .. else: ..`\n\n##########\nFile path: python/pyarrow/tests/test_convert_builtin.py\n##########\n@@ -995,6 +994,9 @@ def test_sequence_timestamp():\n     'ns'\n ])\n def test_sequence_timestamp_with_timezone(timezone, unit):\n+    pytest.importorskip(\"pytz\")\n+    import pytz\n\nReview comment:\n       I think you can simplify this to a single line as `pytz = pytest.importorskip(\"pytz\")`\r\n   \r\n   (and the same for all other occurrences)\n\n##########\nFile path: python/pyarrow/tests/test_types.py\n##########\n@@ -23,10 +23,12 @@\n \n import pickle\n import pytest\n-import pytz\n import hypothesis as h\n import hypothesis.strategies as st\n-import hypothesis.extra.pytz as tzst\n+try:\n+    import hypothesis.extra.pytz as tzst\n\nReview comment:\n       same here\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T11:04:57.389+0000",
                    "updated": "2022-03-09T11:04:57.389+0000",
                    "started": "2022-03-09T11:04:57.388+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738673",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738728",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#issuecomment-1062905029\n\n\n   It seems it is not actually running the hypothesis tests in CI -> https://github.com/apache/arrow/pull/12588\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T13:10:02.450+0000",
                    "updated": "2022-03-09T13:10:02.450+0000",
                    "started": "2022-03-09T13:10:02.449+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738728",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738731",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r822637011\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n         except ValueError:\n-            tz = pytz.timezone(ty.tz)\n+            tz = zoneinfo.ZoneInfo(ty.tz)\n\nReview comment:\n       Yes, I wasn't able to get to this correction till today.\r\n   \r\n   Trouble is that in case of `tz=None` the method `tzinfo_to_string` errors with `Not an instance of datetime.tzinfo` which I think is correct behaviour. Putting an extra skip in the test seems off. I will try to use the `timezones` from `pyarrow.tests.strategies` as you suggested in another comment and see if it works.\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T13:17:01.282+0000",
                    "updated": "2022-03-09T13:17:01.282+0000",
                    "started": "2022-03-09T13:17:01.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738731",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738746",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r822674499\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n\nReview comment:\n       Yes, that is correct, this isn't actually tested. But it would be good to update the `timezone` strategy to include fixed offsets. Will make a JIRA for it and leave this part of the code as is.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T13:58:00.142+0000",
                    "updated": "2022-03-09T13:58:00.142+0000",
                    "started": "2022-03-09T13:58:00.142+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738746",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738753",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r822679857\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-15887\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T14:03:15.489+0000",
                    "updated": "2022-03-09T14:03:15.489+0000",
                    "started": "2022-03-09T14:03:15.489+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738753",
                    "issueId": "13426704"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/worklog/738754",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AlenkaF commented on a change in pull request #12522:\nURL: https://github.com/apache/arrow/pull/12522#discussion_r822683300\n\n\n\n##########\nFile path: python/pyarrow/tests/strategies.py\n##########\n@@ -266,10 +277,12 @@ def arrays(draw, type, size=None, nullable=True):\n         min_datetime = datetime.datetime.fromtimestamp(min_int64 // 10**9)\n         max_datetime = datetime.datetime.fromtimestamp(max_int64 // 10**9)\n         try:\n-            offset_hours = int(ty.tz)\n-            tz = pytz.FixedOffset(offset_hours * 60)\n+            offset = ty.tz.split(\":\")\n+            offset_hours = int(offset[0])\n+            offset_min = int(offset[1])\n+            tz = datetime.timedelta(hours=offset_hours, minutes=offset_min)\n         except ValueError:\n-            tz = pytz.timezone(ty.tz)\n+            tz = zoneinfo.ZoneInfo(ty.tz)\n\nReview comment:\n       I added a `pytest.skip()` in case timezone is None and also used `timezones` from `pyarrow.tests.strategies` instead of `hypothesis.extra.pytz` (`tzst`) where relevant.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T14:06:51.180+0000",
                    "updated": "2022-03-09T14:06:51.180+0000",
                    "started": "2022-03-09T14:06:51.180+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738754",
                    "issueId": "13426704"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 32400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@289a061e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7235d24d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@71e7708f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2d1c7344[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4e1d636[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@249ebc5e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6e37d34a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@20ff1b9b[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2a2539d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7b880c82[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2b753d3a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@730ec80c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 32400,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 29 16:01:40 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-03-29T16:01:40.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15580/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2022-02-04T21:00:17.000+0000",
        "updated": "2022-04-01T11:12:20.000+0000",
        "timeoriginalestimate": null,
        "description": "When install pyarrow via poetry and executing same, a ModuleNotFoundError error can result.\r\n\r\nPyarrow has a dependency on pytz, but this dependency is not declared (the only dependency I see declared is numpy, see [https://github.com/apache/arrow/blob/47d55752172af99fce629f8fe6177df6b41af1d3/python/setup.py#L576)]\r\n\r\nIt would be helpful if pyarrow could declare its dependencies in such a way that tools such as poetry could automatically ensure they were present.\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "9h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 32400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Make pytz an actual optional dependency of PyArrow",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/comment/17488096",
                    "id": "17488096",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Can you show the error you get? (and with which code snippet you get it) \r\nI would assume that pytz is only an optional dependency (i.e. only used when installed), which doesn't require it being added to setup.py install_requires. And if we accidentally depend on it unconditionally, that sounds as a bug.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-02-07T13:19:13.261+0000",
                    "updated": "2022-02-07T13:19:13.261+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/comment/17488102",
                    "id": "17488102",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Actually, looking at the code, we indeed seem to import pytz unconditionally and assume it to be present, if you have timestamp data with a timezone, see eg https://github.com/apache/arrow/blob/4144c1739ec2e58d5f076fa63a0b61653324dc02/cpp/src/arrow/python/datetime.cc#L394",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-02-07T13:22:31.950+0000",
                    "updated": "2022-02-07T13:22:31.950+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/comment/17509760",
                    "id": "17509760",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=amol-",
                        "name": "amol-",
                        "key": "amol-",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=amol-&avatarId=46461",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amol-&avatarId=46461",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amol-&avatarId=46461",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amol-&avatarId=46461"
                        },
                        "displayName": "Alessandro Molina",
                        "active": true,
                        "timeZone": "Europe/Rome"
                    },
                    "body": "The linked issue https://issues.apache.org/jira/browse/ARROW-15966 also adds additional examples and info regarding the problem.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=amol-",
                        "name": "amol-",
                        "key": "amol-",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=amol-&avatarId=46461",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=amol-&avatarId=46461",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=amol-&avatarId=46461",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=amol-&avatarId=46461"
                        },
                        "displayName": "Alessandro Molina",
                        "active": true,
                        "timeZone": "Europe/Rome"
                    },
                    "created": "2022-03-21T10:41:25.955+0000",
                    "updated": "2022-03-21T10:41:25.955+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13426704/comment/17514168",
                    "id": "17514168",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Issue resolved by pull request 12522\n[https://github.com/apache/arrow/pull/12522]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-03-29T16:01:40.177+0000",
                    "updated": "2022-03-29T16:01:40.177+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z0z9w8:",
        "customfield_12314139": null
    }
}