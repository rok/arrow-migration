{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13384484",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484",
    "key": "ARROW-13112",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 36000,
            "total": 36000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 36000,
            "total": 36000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13112/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 60,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/651559",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois opened a new pull request #11168:\nURL: https://github.com/apache/arrow/pull/11168\n\n\n   Currently work in progress to deal with converting string Arrays into R altrep vectors. \r\n   \r\n   This needs more work, and other altrep vectors perhaps need to change as well. The string implementation is mostly inspired from the `R_deferred_string_class` in base R. \r\n   \r\n   This uses static methods because things like `Dataptr()` or even `Elt()` might jump and so we need to correctly unwind. This right now creates a dissymmetry. Perhaps all classes should just use static methods, like it used to be, and like things are usually done. \r\n   \r\n   Once this experiment is finished, we can start being more ambitious about converting more things to altrep, i.e. have altrep classes that uses the (potentially redesigned `Converter` code from `array_to_vector.cpp`). \r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-16T09:18:08.914+0000",
                    "updated": "2021-09-16T09:18:08.914+0000",
                    "started": "2021-09-16T09:18:08.914+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "651559",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/651561",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11168:\nURL: https://github.com/apache/arrow/pull/11168#issuecomment-920732735\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-16T09:18:29.120+0000",
                    "updated": "2021-09-16T09:18:29.120+0000",
                    "started": "2021-09-16T09:18:29.120+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "651561",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654740",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on pull request #11168:\nURL: https://github.com/apache/arrow/pull/11168#issuecomment-926140895\n\n\n   Could you use your fork https://github.com/romainfrancois/arrow instead of https://github.com/apache/arrow for creating a feature branch?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-23T20:46:02.456+0000",
                    "updated": "2021-09-23T20:46:02.456+0000",
                    "started": "2021-09-23T20:46:02.456+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654740",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654891",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois opened a new pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225\n\n\n   Adds implementation for delayed strings vectors, i.e. when converting an Array of StringType or LargeStringType. \r\n   \r\n   replaces #11168 (which was wrongly using a branch on `apache/arrow` rather than a branch of my fork. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T08:39:41.631+0000",
                    "updated": "2021-09-24T08:39:41.631+0000",
                    "started": "2021-09-24T08:39:41.631+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654891",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654892",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois closed pull request #11168:\nURL: https://github.com/apache/arrow/pull/11168\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T08:39:54.883+0000",
                    "updated": "2021-09-24T08:39:54.883+0000",
                    "started": "2021-09-24T08:39:54.882+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654892",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654893",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-926452256\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T08:40:07.869+0000",
                    "updated": "2021-09-24T08:40:07.869+0000",
                    "started": "2021-09-24T08:40:07.868+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654893",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654905",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-926476673\n\n\n   switch to only 2 states for altrep strings: materialized and not materialized (similar to the int and double). \r\n   \r\n   Elt() no longer forces initialisation of data2 with a hybrid vector full of NULLs. The materialized (`data2`) is only generated when needed (by `DATAPTR()`). \r\n   \r\n   This is safer than having the possibility of a STRSXP with NULLs. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T09:17:05.566+0000",
                    "updated": "2021-09-24T09:17:05.566+0000",
                    "started": "2021-09-24T09:17:05.566+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654905",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654956",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-926613285\n\n\n   One thing I had not paid attention to is that list types benefit from altrep too (when the type can be managed by an altrep vector): \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   ```\r\n   \r\n   an Array of type list(int32())\r\n   \r\n   ``` r\r\n   a <- Array$create(list(1:10, 11:20))\r\n   ```\r\n   \r\n   under the hood, an Array of int32() is stored:\r\n   \r\n   ``` r\r\n   a$values()\r\n   #> Array\r\n   #> <int32>\r\n   #> [\r\n   #>   1,\r\n   #>   2,\r\n   #>   3,\r\n   #>   4,\r\n   #>   5,\r\n   #>   6,\r\n   #>   7,\r\n   #>   8,\r\n   #>   9,\r\n   #>   10,\r\n   #>   11,\r\n   #>   12,\r\n   #>   13,\r\n   #>   14,\r\n   #>   15,\r\n   #>   16,\r\n   #>   17,\r\n   #>   18,\r\n   #>   19,\r\n   #>   20\r\n   #> ]\r\n   ```\r\n   \r\n   so converting a to an R vector still benefits from altrep\r\n   \r\n   ``` r\r\n   .Internal(inspect( a$as_vector() ))\r\n   #> @7fc8453ebd88 19 VECSXP g0c2 [OBJ,REF(1),ATT] (len=2, tl=0)\r\n   #>   @7fc848c440f0 13 INTSXP g0c0 [REF(65535)] arrow::Array<int32, 0 nulls> len=10, Array=<0x7fc84481d538>\r\n   #>     @7fc848c44160 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #>   @7fc848c43de0 13 INTSXP g0c0 [REF(65535)] arrow::Array<int32, 0 nulls> len=10, Array=<0x7fc84480be58>\r\n   #>     @7fc848c43e50 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #> ATTRIB:\r\n   #>   @7fc848c446d8 02 LISTSXP g0c0 [REF(1)] \r\n   #>     TAG: @7fc84000d1d0 01 SYMSXP g1c0 [MARK,REF(45102),LCK,gp=0x6000] \"class\" (has value)\r\n   #>     @7fc845c07738 16 STRSXP g0c3 [MARK,REF(3)] (len=4, tl=0)\r\n   #>       @7fc842f5b988 09 CHARSXP g0c2 [MARK,REF(16),gp=0x60] [ASCII] [cached] \"arrow_list\"\r\n   #>       @7fc842a57c88 09 CHARSXP g1c2 [MARK,REF(149),gp=0x60] [ASCII] [cached] \"vctrs_list_of\"\r\n   #>       @7fc842a57c48 09 CHARSXP g1c2 [MARK,REF(562),gp=0x60] [ASCII] [cached] \"vctrs_vctr\"\r\n   #>       @7fc840026650 09 CHARSXP g1c1 [MARK,REF(1365),gp=0x61] [ASCII] [cached] \"list\"\r\n   #>     TAG: @7fc843a1dc10 01 SYMSXP g1c0 [MARK,REF(2)] \"ptype\"\r\n   #>     @7fc848c44438 13 INTSXP g0c0 [REF(1)] (len=0, tl=0)\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-24 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T13:11:38.749+0000",
                    "updated": "2021-09-24T13:11:38.749+0000",
                    "started": "2021-09-24T13:11:38.749+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654956",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654957",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois edited a comment on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-926613285\n\n\n   One thing I had not paid attention to is that list types benefit from altrep too (when the type can be managed by an altrep vector): \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   ```\r\n   \r\n   an Array of type list(int32())\r\n   \r\n   ``` r\r\n   a <- Array$create(list(1:10, 11:20))\r\n   ```\r\n   \r\n   under the hood, an Array of int32() is stored:\r\n   \r\n   ``` r\r\n   a$values()\r\n   #> Array\r\n   #> <int32>\r\n   #> [\r\n   #>   1,\r\n   #>   2,\r\n   #>   3,\r\n   #>   4,\r\n   #>   5,\r\n   #>   6,\r\n   #>   7,\r\n   #>   8,\r\n   #>   9,\r\n   #>   10,\r\n   #>   11,\r\n   #>   12,\r\n   #>   13,\r\n   #>   14,\r\n   #>   15,\r\n   #>   16,\r\n   #>   17,\r\n   #>   18,\r\n   #>   19,\r\n   #>   20\r\n   #> ]\r\n   ```\r\n   \r\n   so converting a to an R vector still benefits from altrep\r\n   \r\n   ``` r\r\n   .Internal(inspect( a$as_vector() ))\r\n   #> @7fc8453ebd88 19 VECSXP g0c2 [OBJ,REF(1),ATT] (len=2, tl=0)\r\n   #>   @7fc848c440f0 13 INTSXP g0c0 [REF(65535)] arrow::Array<int32, 0 nulls> len=10, Array=<0x7fc84481d538>\r\n   #>     @7fc848c44160 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #>   @7fc848c43de0 13 INTSXP g0c0 [REF(65535)] arrow::Array<int32, 0 nulls> len=10, Array=<0x7fc84480be58>\r\n   #>     @7fc848c43e50 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #> ATTRIB:\r\n   #>   @7fc848c446d8 02 LISTSXP g0c0 [REF(1)] \r\n   #>     TAG: @7fc84000d1d0 01 SYMSXP g1c0 [MARK,REF(45102),LCK,gp=0x6000] \"class\" (has value)\r\n   #>     @7fc845c07738 16 STRSXP g0c3 [MARK,REF(3)] (len=4, tl=0)\r\n   #>       @7fc842f5b988 09 CHARSXP g0c2 [MARK,REF(16),gp=0x60] [ASCII] [cached] \"arrow_list\"\r\n   #>       @7fc842a57c88 09 CHARSXP g1c2 [MARK,REF(149),gp=0x60] [ASCII] [cached] \"vctrs_list_of\"\r\n   #>       @7fc842a57c48 09 CHARSXP g1c2 [MARK,REF(562),gp=0x60] [ASCII] [cached] \"vctrs_vctr\"\r\n   #>       @7fc840026650 09 CHARSXP g1c1 [MARK,REF(1365),gp=0x61] [ASCII] [cached] \"list\"\r\n   #>     TAG: @7fc843a1dc10 01 SYMSXP g1c0 [MARK,REF(2)] \"ptype\"\r\n   #>     @7fc848c44438 13 INTSXP g0c0 [REF(1)] (len=0, tl=0)\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-24 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\r\n   \r\n   This compensates a little bit for the fact that there are no altrep classes for `VECSXP` objects (lists) in R. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T13:12:52.270+0000",
                    "updated": "2021-09-24T13:12:52.270+0000",
                    "started": "2021-09-24T13:12:52.270+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654957",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/654960",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-926616517\n\n\n   However, struct types don't benefit: \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   \r\n   st <- Array$create(data.frame(x = 1:10, y = runif(10)))\r\n   st\r\n   #> StructArray\r\n   #> <struct<x: int32, y: double>>\r\n   #> -- is_valid: all not null\r\n   #> -- child 0 type: int32\r\n   #>   [\r\n   #>     1,\r\n   #>     2,\r\n   #>     3,\r\n   #>     4,\r\n   #>     5,\r\n   #>     6,\r\n   #>     7,\r\n   #>     8,\r\n   #>     9,\r\n   #>     10\r\n   #>   ]\r\n   #> -- child 1 type: double\r\n   #>   [\r\n   #>     0.669298,\r\n   #>     0.75282,\r\n   #>     0.408692,\r\n   #>     0.784959,\r\n   #>     0.108236,\r\n   #>     0.354329,\r\n   #>     0.30033,\r\n   #>     0.251092,\r\n   #>     0.0811526,\r\n   #>     0.898208\r\n   #>   ]\r\n   .Internal(inspect( st$as_vector() ))\r\n   #> @7fe931327548 19 VECSXP g0c2 [OBJ,REF(1),ATT] (len=2, tl=0)\r\n   #>   @7fe92a7d3188 13 INTSXP g0c4 [REF(1)] (len=10, tl=0) 1,2,3,4,5,...\r\n   #>   @7fe92a7db608 14 REALSXP g0c5 [REF(1)] (len=10, tl=0) 0.669298,0.75282,0.408692,0.784959,0.108236,...\r\n   #> ATTRIB:\r\n   #>   @7fe9309aab40 02 LISTSXP g0c0 [REF(1)] \r\n   #>     TAG: @7fe92900b460 01 SYMSXP g1c0 [MARK,REF(65535),LCK,gp=0x4000] \"row.names\" (has value)\r\n   #>     @7fe9308afb58 13 INTSXP g0c1 [REF(1)] (len=2, tl=0) -2147483648,-10\r\n   #>     TAG: @7fe92900b690 01 SYMSXP g1c0 [MARK,REF(65535),LCK,gp=0x4000] \"names\" (has value)\r\n   #>     @7fe931327408 16 STRSXP g0c2 [REF(3)] (len=2, tl=0)\r\n   #>       @7fe92904ed18 09 CHARSXP g1c1 [MARK,REF(250),gp=0x61] [ASCII] [cached] \"x\"\r\n   #>       @7fe92908e588 09 CHARSXP g1c1 [MARK,REF(36),gp=0x61] [ASCII] [cached] \"y\"\r\n   #>     TAG: @7fe92900bbd0 01 SYMSXP g1c0 [MARK,REF(44995),LCK,gp=0x6000] \"class\" (has value)\r\n   #>     @7fe92a6c10e8 16 STRSXP g0c3 [MARK,REF(3)] (len=3, tl=0)\r\n   #>       @7fe92c4cdf00 09 CHARSXP g1c1 [MARK,REF(105),gp=0x61] [ASCII] [cached] \"tbl_df\"\r\n   #>       @7fe92c4cdec8 09 CHARSXP g1c1 [MARK,REF(117),gp=0x61] [ASCII] [cached] \"tbl\"\r\n   #>       @7fe92a825048 09 CHARSXP g1c2 [MARK,REF(476),gp=0x61,ATT] [ASCII] [cached] \"data.frame\"\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-24 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-24T13:16:23.556+0000",
                    "updated": "2021-09-24T13:16:23.556+0000",
                    "started": "2021-09-24T13:16:23.555+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "654960",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655498",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-927877782\n\n\n   Reworked the internals so that the error message related to null strings is promoted: \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   \r\n   a <- Array$create(\r\n     list(as.raw(c(0x6d, 0x61, 0x00, 0x6e))), \r\n     binary()\r\n   )$cast(utf8())\r\n   \r\n   # the vector is created\r\n   v <- a$as_vector()\r\n   \r\n   # and this errors \"later\"\r\n   v[]\r\n   #> Error: embedded nul in string: 'ma\\0n'; to strip nuls when converting from Arrow to R, set options(arrow.skip_nul = TRUE)\r\n   v[1]\r\n   #> Error: embedded nul in string: 'ma\\0n'; to strip nuls when converting from Arrow to R, set options(arrow.skip_nul = TRUE)\r\n   ```\r\n   \r\n   However, previously we would fail as soon as `a$as_vector()`. \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   \r\n   a <- Array$create(\r\n     list(as.raw(c(0x6d, 0x61, 0x00, 0x6e))), \r\n     binary()\r\n   )$cast(utf8())\r\n   \r\n   # this errors now\r\n   v <- a$as_vector()\r\n   #> Error in Array__as_vector(self): embedded nul in string: 'ma\\0n'\r\n   \r\n   # and v does not exist\r\n   v[]\r\n   #> Error in eval(expr, envir, enclos): object 'v' not found\r\n   v[1]\r\n   #> Error in eval(expr, envir, enclos): object 'v' not found\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-27 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\r\n   \r\n   We could have a premature fail with this implementation too (which would simplify the tests) if we would check for `nuls` on creation of the altrep vector, i.e. in `AltrepVectorString<>::Make()` ? cc @nealrichardson \r\n   \r\n   We only have to search for `\\0`, i.e. we don't need to build the CHARSXP\r\n   \r\n   \r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T13:30:25.029+0000",
                    "updated": "2021-09-27T13:30:25.029+0000",
                    "started": "2021-09-27T13:30:25.029+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655498",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655630",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-928085858\n\n\n   individual columns of struct types may now be altrep (still in the case of a single Array, not yet for ChunkedArray). \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   \r\n   st <- Array$create(data.frame(x = 1:10, y = runif(10)))\r\n   .Internal(inspect( \r\n     st$as_vector() \r\n   ))\r\n   #> @7ffb06350fc8 19 VECSXP g0c2 [OBJ,REF(1),ATT] (len=2, tl=0)\r\n   #>   @7ffb04e9aa10 13 INTSXP g0c0 [REF(65535)] arrow::Array<int32, 0 nulls> len=10, Array=<0x7ffb057572d8>\r\n   #>     @7ffb04e9aa80 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #>   @7ffb04e9a700 14 REALSXP g0c0 [REF(65535)] arrow::Array<double, 0 nulls> len=10, Array=<0x7ffb0575ba58>\r\n   #>     @7ffb04e9a770 22 EXTPTRSXP g0c0 [REF(4)] \r\n   #> ATTRIB:\r\n   #>   @7ffb04e9a508 02 LISTSXP g0c0 [REF(1)] \r\n   #>     TAG: @7ffafd00ca60 01 SYMSXP g1c0 [MARK,REF(65535),LCK,gp=0x4000] \"row.names\" (has value)\r\n   #>     @7ffb07c49388 13 INTSXP g0c1 [REF(1)] (len=2, tl=0) -2147483648,-10\r\n   #>     TAG: @7ffafd00cc90 01 SYMSXP g1c0 [MARK,REF(65535),LCK,gp=0x4000] \"names\" (has value)\r\n   #>     @7ffb06350e88 16 STRSXP g0c2 [REF(3)] (len=2, tl=0)\r\n   #>       @7ffafd050318 09 CHARSXP g1c1 [MARK,REF(253),gp=0x61] [ASCII] [cached] \"x\"\r\n   #>       @7ffafd12e788 09 CHARSXP g1c1 [MARK,REF(36),gp=0x61] [ASCII] [cached] \"y\"\r\n   #>     TAG: @7ffafd00d1d0 01 SYMSXP g1c0 [MARK,REF(45977),LCK,gp=0x6000] \"class\" (has value)\r\n   #>     @7ffb04f58888 16 STRSXP g0c3 [REF(3)] (len=3, tl=0)\r\n   #>       @7ffb00d67ec8 09 CHARSXP g1c1 [MARK,REF(105),gp=0x61] [ASCII] [cached] \"tbl_df\"\r\n   #>       @7ffb00d67e90 09 CHARSXP g1c1 [MARK,REF(117),gp=0x61] [ASCII] [cached] \"tbl\"\r\n   #>       @7ffafd087648 09 CHARSXP g1c2 [MARK,REF(504),gp=0x61,ATT] [ASCII] [cached] \"data.frame\"\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-27 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T17:15:57.212+0000",
                    "updated": "2021-09-27T17:15:57.212+0000",
                    "started": "2021-09-27T17:15:57.211+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655630",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655789",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-928256318\n\n\n   Ok, I've finally had a chance to run these. The results for strings are super impressive. The difference was so much I had to widen some of these plots to even see the difference between no altrep and altrep versions.\r\n   \r\n   Interestingly(?) it looks like dictionaries are also using altrep too (though there doesn't seem to be any performance difference between them). _Note_ the @HEAD and @7f7f72d branches did not return successfully not because there was a failure, but because the objects didn't pass [the altrep checking that {arrowbench} does](https://github.com/ursacomputing/arrowbench/blob/main/R/bm-array-to-vector.R#L67-L76). I need to dig more in and manually investigate what's going on there.\r\n   \r\n   [altvec-with-strings.html.zip](https://github.com/apache/arrow/files/7239176/altvec-with-strings.html.zip)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:38:50.344+0000",
                    "updated": "2021-09-27T20:38:50.344+0000",
                    "started": "2021-09-27T20:38:50.343+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655789",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655791",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane edited a comment on pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#issuecomment-928256318\n\n\n   Ok, I've finally had a chance to run these. The results for strings are super impressive. The difference was so much I had to widen some of these plots to even see the difference between no altrep and altrep versions.\r\n   \r\n   ~Interestingly(?) it looks like dictionaries are also using altrep too (though there doesn't seem to be any performance difference between them).~ I should have refreshed this page before posting, you noted that structs can now be altrep up above (sorry about that!). I'm not seeing a huge performance increase with them though.   _Note_ the @HEAD and @7f7f72d branches did not return successfully not because there was a failure, but because the objects didn't pass [the altrep checking that {arrowbench} does](https://github.com/ursacomputing/arrowbench/blob/main/R/bm-array-to-vector.R#L67-L76).\r\n   \r\n   [altvec-with-strings.html.zip](https://github.com/apache/arrow/files/7239176/altvec-with-strings.html.zip)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:40:44.882+0000",
                    "updated": "2021-09-27T20:40:44.882+0000",
                    "started": "2021-09-27T20:40:44.882+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655791",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655796",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717030814\n\n\n\n##########\nFile path: r/tests/testthat/test-altrep.R\n##########\n@@ -193,15 +195,33 @@ test_that(\"altrep min/max/sum identical to R versions for int\", {\n test_that(\"altrep vectors handle serialization\", {\n   ints <- c(1L, 2L, NA_integer_)\n   dbls <- c(1, 2, NA_real_)\n+  strs <- c(\"un\", \"deux\" , NA_character_)\n\nReview comment:\n       ```suggestion\r\n     strs <- c(\"un\", \"deux\", NA_character_)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:43:01.150+0000",
                    "updated": "2021-09-27T20:43:01.150+0000",
                    "started": "2021-09-27T20:43:01.149+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655796",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655797",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717030936\n\n\n\n##########\nFile path: r/tests/testthat/test-altrep.R\n##########\n@@ -193,15 +195,33 @@ test_that(\"altrep min/max/sum identical to R versions for int\", {\n test_that(\"altrep vectors handle serialization\", {\n   ints <- c(1L, 2L, NA_integer_)\n   dbls <- c(1, 2, NA_real_)\n+  strs <- c(\"un\", \"deux\" , NA_character_)\n \n   expect_identical(ints, unserialize(serialize(Array$create(ints)$as_vector(), NULL)))\n   expect_identical(dbls, unserialize(serialize(Array$create(dbls)$as_vector(), NULL)))\n+  expect_identical(strs, unserialize(serialize(Array$create(strs)$as_vector(), NULL)))\n+  expect_identical(strs, unserialize(serialize(Array$create(strs, large_utf8())$as_vector(), NULL)))\n })\n \n test_that(\"altrep vectors handle coercion\", {\n   ints <- c(1L, 2L, NA_integer_)\n   dbls <- c(1, 2, NA_real_)\n+  strs <- c(\"1\", \"2\" , NA_character_)\n\nReview comment:\n       ```suggestion\r\n     strs <- c(\"1\", \"2\", NA_character_)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:43:14.310+0000",
                    "updated": "2021-09-27T20:43:14.310+0000",
                    "started": "2021-09-27T20:43:14.310+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655797",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655798",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717031142\n\n\n\n##########\nFile path: r/tests/testthat/test-chunked-array.R\n##########\n@@ -442,13 +444,12 @@ test_that(\"Handling string data with embedded nuls\", {\n   )\n \n   withr::with_options(list(arrow.skip_nul = TRUE), {\n+    v <- expect_warning(as.vector(chunked_array_with_nul), NA)\n     expect_warning(\n-      expect_identical(\n-        as.vector(chunked_array_with_nul),\n-        c(\"person\", \"woman\", \"man\", \"fan\", \"camera\", \"tv\")\n-      ),\n+      expect_identical(v[3], \"man\"),\n       \"Stripping '\\\\0' (nul) from character vector\",\n       fixed = TRUE\n     )\n   })\n })\n+\n\nReview comment:\n       ```suggestion\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:43:37.750+0000",
                    "updated": "2021-09-27T20:43:37.750+0000",
                    "started": "2021-09-27T20:43:37.750+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655798",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655799",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717032712\n\n\n\n##########\nFile path: r/src/altrep.cpp\n##########\n@@ -70,135 +69,125 @@ R_xlen_t Standard_Get_region<int>(SEXP data2, R_xlen_t i, R_xlen_t n, int* buf)\n   return INTEGER_GET_REGION(data2, i, n, buf);\n }\n \n-// altrep R vector shadowing an Array.\n+void DeleteArray(std::shared_ptr<Array>* ptr) { delete ptr; }\n+using Pointer = cpp11::external_pointer<std::shared_ptr<Array>, DeleteArray>;\n+\n+// base class for all altrep vectors\n+//\n+// The altrep vector stores the Array as an external pointer in data1\n+// Implementation classes AltrepVectorPrimitive<> and AltrepVectorString\n+// also use data2\n+struct AltrepVectorBase {\n+  // store the Array as an external pointer in data1, mark as immutable\n+  static SEXP Make(R_altrep_class_t class_t, const std::shared_ptr<Array>& array) {\n+    SEXP alt_ =\n+        R_new_altrep(class_t, Pointer(new std::shared_ptr<Array>(array)), R_NilValue);\n+    MARK_NOT_MUTABLE(alt_);\n+\n+    return alt_;\n+  }\n+\n+  // the Array that is being wrapped by the altrep object\n+  static const std::shared_ptr<Array>& array(SEXP alt_) {\n+    return *Pointer(R_altrep_data1(alt_));\n+  }\n+\n+  // Is the vector materialized, i.e. does the data2 slot contain a\n+  // standard R vector with the same data as the array.\n+  static bool IsMaterialized(SEXP alt_) { return !Rf_isNull(R_altrep_data2(alt_)); }\n+\n+  static R_xlen_t Length(SEXP alt_) { return array(alt_)->length(); }\n+\n+  static int No_NA(SEXP alt_) { return array(alt_)->null_count() == 0; }\n+\n+  static int Is_sorted(SEXP alt_) { return UNKNOWN_SORTEDNESS; }\n+\n+  // What gets printed on .Internal(inspect(<the altrep object>))\n+  static Rboolean Inspect(SEXP alt_, int pre, int deep, int pvec,\n+                          void (*inspect_subtree)(SEXP, int, int, int)) {\n+    const auto& array_ = array(alt_);\n+    Rprintf(\"arrow::Array<%s, %d nulls> len=%d, Array=<%p>\\n\",\n\nReview comment:\n       We are using [this in {arrowbench} to confirm that the conversion is truly working](https://github.com/ursacomputing/arrowbench/blob/main/R/bm-array-to-vector.R#L67-L76). Is this reasonably stable / reasonable itself? Or should be do something else here?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:45:53.996+0000",
                    "updated": "2021-09-27T20:45:53.996+0000",
                    "started": "2021-09-27T20:45:53.995+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655799",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/655803",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717034478\n\n\n\n##########\nFile path: r/tests/testthat/test-altrep.R\n##########\n@@ -97,15 +97,17 @@ test_that(\"empty vectors are not altrep\", {\n test_that(\"as.data.frame(<Table>, <RecordBatch>) can create altrep vectors\", {\n   withr::local_options(list(arrow.use_altrep = TRUE))\n \n-  table <- Table$create(int = c(1L, 2L, 3L), dbl = c(1, 2, 3))\n+  table <- Table$create(int = c(1L, 2L, 3L), dbl = c(1, 2, 3), str = c(\"un\", \"deux\", \"trois\"))\n\nReview comment:\n       \ud83c\uddeb\ud83c\uddf7 \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-27T20:48:48.379+0000",
                    "updated": "2021-09-27T20:48:48.379+0000",
                    "started": "2021-09-27T20:48:48.378+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655803",
                    "issueId": "13384484"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/worklog/656028",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #11225:\nURL: https://github.com/apache/arrow/pull/11225#discussion_r717314213\n\n\n\n##########\nFile path: r/src/altrep.cpp\n##########\n@@ -70,135 +69,125 @@ R_xlen_t Standard_Get_region<int>(SEXP data2, R_xlen_t i, R_xlen_t n, int* buf)\n   return INTEGER_GET_REGION(data2, i, n, buf);\n }\n \n-// altrep R vector shadowing an Array.\n+void DeleteArray(std::shared_ptr<Array>* ptr) { delete ptr; }\n+using Pointer = cpp11::external_pointer<std::shared_ptr<Array>, DeleteArray>;\n+\n+// base class for all altrep vectors\n+//\n+// The altrep vector stores the Array as an external pointer in data1\n+// Implementation classes AltrepVectorPrimitive<> and AltrepVectorString\n+// also use data2\n+struct AltrepVectorBase {\n+  // store the Array as an external pointer in data1, mark as immutable\n+  static SEXP Make(R_altrep_class_t class_t, const std::shared_ptr<Array>& array) {\n+    SEXP alt_ =\n+        R_new_altrep(class_t, Pointer(new std::shared_ptr<Array>(array)), R_NilValue);\n+    MARK_NOT_MUTABLE(alt_);\n+\n+    return alt_;\n+  }\n+\n+  // the Array that is being wrapped by the altrep object\n+  static const std::shared_ptr<Array>& array(SEXP alt_) {\n+    return *Pointer(R_altrep_data1(alt_));\n+  }\n+\n+  // Is the vector materialized, i.e. does the data2 slot contain a\n+  // standard R vector with the same data as the array.\n+  static bool IsMaterialized(SEXP alt_) { return !Rf_isNull(R_altrep_data2(alt_)); }\n+\n+  static R_xlen_t Length(SEXP alt_) { return array(alt_)->length(); }\n+\n+  static int No_NA(SEXP alt_) { return array(alt_)->null_count() == 0; }\n+\n+  static int Is_sorted(SEXP alt_) { return UNKNOWN_SORTEDNESS; }\n+\n+  // What gets printed on .Internal(inspect(<the altrep object>))\n+  static Rboolean Inspect(SEXP alt_, int pre, int deep, int pvec,\n+                          void (*inspect_subtree)(SEXP, int, int, int)) {\n+    const auto& array_ = array(alt_);\n+    Rprintf(\"arrow::Array<%s, %d nulls> len=%d, Array=<%p>\\n\",\n\nReview comment:\n       We have the `arrow:::is_altrep()` function that is mostly meant for unit tests: \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   #> See arrow_info() for available features\r\n   \r\n   v <- Array$create(1:10)$as_vector()\r\n   arrow:::is_altrep(v)\r\n   #> [1] TRUE\r\n   \r\n   v <- ChunkedArray$create(1:10, 11:20)$as_vector()\r\n   arrow:::is_altrep(v)\r\n   #> [1] FALSE\r\n   ```\r\n   \r\n   <sup>Created on 2021-09-28 by the [reprex package](https://reprex.tidyverse.org) (v2.0.0)</sup>\r\n   \r\n   This could be promoted to something that gives more information, maybe the altrep class name or something. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-28T07:48:18.894+0000",
                    "updated": "2021-09-28T07:48:18.894+0000",
                    "started": "2021-09-28T07:48:18.894+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "656028",
                    "issueId": "13384484"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 36000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@54136eeb[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@be361db[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@97f30e2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@198265af[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@75f7bdbc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@10116235[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6019b8f5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6abc1644[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@22ee4cf2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@39759250[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@14865b9b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1e826179[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 36000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 05 14:10:27 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-10-05T14:10:27.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13112/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-06-18T08:33:12.000+0000",
        "updated": "2021-10-05T14:10:56.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "10h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 36000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] altrep vectors for strings and other types",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13384484/comment/17424489",
                    "id": "17424489",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 11225\n[https://github.com/apache/arrow/pull/11225]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-05T14:10:27.846+0000",
                    "updated": "2021-10-05T14:10:27.846+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0s2c8:",
        "customfield_12314139": null
    }
}