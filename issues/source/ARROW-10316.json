{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13335636",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636",
    "key": "ARROW-10316",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10316/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 14,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/614073",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou opened a new pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581\n\n\n   Generate a signature for compute functions that better reflects the accepted arguments.\r\n   \r\n   Example before:\r\n   ```python\r\n   >>> pc.sum?\r\n   Signature: pc.sum(array, *, options=None, memory_pool=None, **kwargs)\r\n   Docstring:\r\n   Compute the sum of a numeric array.\r\n   [...]\r\n   ```\r\n   \r\n   Same example after:\r\n   ```python\r\n   >>> ?pc.sum\r\n   Signature:\r\n   pc.sum(\r\n       array,\r\n       *,\r\n       memory_pool=None,\r\n       options=None,\r\n       skip_nulls=True,\r\n       min_count=1,\r\n   )\r\n   Docstring:\r\n   Compute the sum of a numeric array.\r\n   [...]\r\n   ```\r\n   \r\n   One caveat is that the individual options are not explicitly documented (yet):\r\n   ```\r\n   Parameters\r\n   ----------\r\n   array : Array-like\r\n       Argument to compute function\r\n   memory_pool : pyarrow.MemoryPool, optional\r\n       If not passed, will allocate memory from the default memory pool.\r\n   options : pyarrow.compute.ScalarAggregateOptions, optional\r\n       Parameters altering compute function semantics\r\n   **kwargs : optional\r\n       Parameters for ScalarAggregateOptions constructor. Either `options`\r\n       or `**kwargs` can be passed, but not both at the same time.\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-23T15:31:41.578+0000",
                    "updated": "2021-06-23T15:31:41.578+0000",
                    "started": "2021-06-23T15:31:41.578+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614073",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/614074",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#issuecomment-866940044\n\n\n   https://issues.apache.org/jira/browse/ARROW-10316\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-23T15:31:56.238+0000",
                    "updated": "2021-06-23T15:31:56.238+0000",
                    "started": "2021-06-23T15:31:56.237+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614074",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/614075",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#issuecomment-866940079\n\n\n   @amol- Do you want to review this?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-23T15:32:10.705+0000",
                    "updated": "2021-06-23T15:32:10.705+0000",
                    "started": "2021-06-23T15:32:10.705+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614075",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617172",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#issuecomment-871591499\n\n\n   Ping @amol- \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-30T17:23:31.269+0000",
                    "updated": "2021-06-30T17:23:31.269+0000",
                    "started": "2021-06-30T17:23:31.268+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617172",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617248",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r661765127\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -173,22 +176,37 @@ def _handle_options(name, option_class, options, kwargs):\n     return options\n \n \n-_wrapper_template = dedent(\"\"\"\\\n-    def make_wrapper(func, option_class):\n-        def {func_name}({args_sig}{kwonly}, memory_pool=None):\n-            return func.call([{args_sig}], None, memory_pool)\n-        return {func_name}\n-    \"\"\")\n-\n-_wrapper_options_template = dedent(\"\"\"\\\n-    def make_wrapper(func, option_class):\n-        def {func_name}({args_sig}{kwonly}, options=None, memory_pool=None,\n-                        **kwargs):\n-            options = _handle_options({func_name!r}, option_class, options,\n+def _make_generic_wrapper(func_name, func, option_class):\n+    if option_class is None:\n+        def wrapper(*args, memory_pool=None):\n+            return func.call(args, None, memory_pool)\n+    else:\n+        def wrapper(*args, memory_pool=None, options=None, **kwargs):\n+            options = _handle_options(func_name, option_class, options,\n                                       kwargs)\n-            return func.call([{args_sig}], options, memory_pool)\n-        return {func_name}\n-    \"\"\")\n+            return func.call(args, options, memory_pool)\n+    return wrapper\n+\n+\n+def _make_dummy_equivalent(args_sig, kwonly, option_class):\n+    # Make a dummy callable with the signature that we want to expose\n+    # as the real function's signature.\n+    str_sig = f\"{args_sig}{kwonly}, memory_pool=None\"\n+    if option_class is not None:\n+        str_sig += \", options=None\"\n+        sig = inspect.signature(option_class)\n+        for p in sig.parameters.values():\n+            p_default = p.default if p.default is not p.empty else None\n+            try:\n+                # If the default value cannot be represented accurately,\n+                # use None instead\n\nReview comment:\n       Is there an example of this? If possible it seems better to avoid an inaccurate signature, could we just `assert eval(repr(p_default)) == p_default`? Otherwise please add a test showing the overwritten default\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-30T19:56:39.782+0000",
                    "updated": "2021-06-30T19:56:39.782+0000",
                    "started": "2021-06-30T19:56:39.781+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617248",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617500",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "amol- commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662143862\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       While I do see how it can work, I'm not sure I got the benefit of building a dummy function with the right signature wrapped in the real function with the wrong signature.\r\n   \r\n   I mean, if you are building the function with the right signature in `make_dummy_equivalent`, while not make that one not dummy, have it invoke the real compute function and directly return it?\r\n   \r\n   The only reason I could think of is that in reality the signature you want to expose is not the real one you want to use.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T10:02:11.553+0000",
                    "updated": "2021-07-01T10:02:11.553+0000",
                    "started": "2021-07-01T10:02:11.553+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617500",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617514",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662174383\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       > The only reason I could think of is that in reality the signature you want to expose is not the real one you want to use.\r\n   \r\n   This is exactly the case here: the function definition mostly forwards `*args` and `**kwargs` to the function kernel and the function options constructor, respectively. See the `wrapper` definitions above.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T11:06:57.622+0000",
                    "updated": "2021-07-01T11:06:57.622+0000",
                    "started": "2021-07-01T11:06:57.622+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617514",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662174593\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -173,22 +176,37 @@ def _handle_options(name, option_class, options, kwargs):\n     return options\n \n \n-_wrapper_template = dedent(\"\"\"\\\n-    def make_wrapper(func, option_class):\n-        def {func_name}({args_sig}{kwonly}, memory_pool=None):\n-            return func.call([{args_sig}], None, memory_pool)\n-        return {func_name}\n-    \"\"\")\n-\n-_wrapper_options_template = dedent(\"\"\"\\\n-    def make_wrapper(func, option_class):\n-        def {func_name}({args_sig}{kwonly}, options=None, memory_pool=None,\n-                        **kwargs):\n-            options = _handle_options({func_name!r}, option_class, options,\n+def _make_generic_wrapper(func_name, func, option_class):\n+    if option_class is None:\n+        def wrapper(*args, memory_pool=None):\n+            return func.call(args, None, memory_pool)\n+    else:\n+        def wrapper(*args, memory_pool=None, options=None, **kwargs):\n+            options = _handle_options(func_name, option_class, options,\n                                       kwargs)\n-            return func.call([{args_sig}], options, memory_pool)\n-        return {func_name}\n-    \"\"\")\n+            return func.call(args, options, memory_pool)\n+    return wrapper\n+\n+\n+def _make_dummy_equivalent(args_sig, kwonly, option_class):\n+    # Make a dummy callable with the signature that we want to expose\n+    # as the real function's signature.\n+    str_sig = f\"{args_sig}{kwonly}, memory_pool=None\"\n+    if option_class is not None:\n+        str_sig += \", options=None\"\n+        sig = inspect.signature(option_class)\n+        for p in sig.parameters.values():\n+            p_default = p.default if p.default is not p.empty else None\n+            try:\n+                # If the default value cannot be represented accurately,\n+                # use None instead\n\nReview comment:\n       Hmm, I'm not sure there's an example of this, no. We can probably simply assert for now.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T11:11:07.353+0000",
                    "updated": "2021-07-01T11:11:07.353+0000",
                    "started": "2021-07-01T11:11:07.353+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617519",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617551",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662216060\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       The other benefit here is to confine the scope of `eval()`: now instead of using it to create the whole wrapper function we're only using it to get the signature right\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T11:43:26.928+0000",
                    "updated": "2021-07-01T11:43:26.928+0000",
                    "started": "2021-07-01T11:43:26.928+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617551",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617568",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "amol- commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662228994\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       Uhm, if our only goal is to fake the signature, why not just use ``__signature__`` or ``__text_signature__`` which are available to expose signatures of C functions?\r\n   \r\n   Like\r\n   \r\n   ```\r\n   def create_function(f_name, args):\r\n       real_func = getattr(__builtins__, f_name)\r\n       def f_impl(*args, **kwargs):\r\n           return real_func(*args)\r\n       f_impl.__name__ = f_name\r\n       f_impl.__text_signature__ = \"(a, b)\"\r\n       return f_impl\r\n   \r\n   import inspect\r\n   f = create_function(\"min\", (\"a\", \"b\"))\r\n   print(f.__name__, inspect.signature(f), f(1, 2))\r\n   ```\r\n   \r\n   That seem to achieve the same goal without any compile or ``__wrapped__`` magic\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T12:04:46.603+0000",
                    "updated": "2021-07-01T12:04:46.603+0000",
                    "started": "2021-07-01T12:04:46.603+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617568",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617580",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662242293\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       `__text_signature__` is not really specified AFAICT, it's mostly for internal use by Argument Clinic (though other C generators may use it). We can try to set `__signature__`, however.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T12:25:08.083+0000",
                    "updated": "2021-07-01T12:25:08.083+0000",
                    "started": "2021-07-01T12:25:08.083+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617580",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617635",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#discussion_r662367890\n\n\n\n##########\nFile path: python/pyarrow/compute.py\n##########\n@@ -197,16 +215,13 @@ def _wrap_function(name, func):\n     args_sig = ', '.join(arg_names)\n     kwonly = '' if arg_names[-1].startswith('*') else ', *'\n \n-    # Generate templated wrapper, so that the signature matches\n-    # the documented argument names.\n-    ns = {}\n-    if option_class is not None:\n-        template = _wrapper_options_template\n-    else:\n-        template = _wrapper_template\n-    exec(template.format(func_name=name, args_sig=args_sig, kwonly=kwonly),\n-         globals(), ns)\n-    wrapper = ns['make_wrapper'](func, option_class)\n+    # We make a generic wrapper with a simple argument-handling\n+    # machinery, but we also add a __wrapped__ attribute pointing\n+    # to a dummy callable with the desired signature for introspection\n+    # and documentation.\n+    wrapper = _make_generic_wrapper(name, func, option_class)\n+    wrapper.__wrapped__ = _make_dummy_equivalent(args_sig, kwonly,\n+                                                 option_class)\n\nReview comment:\n       Ok, it worked with `__signature__`. Thanks for the suggestion!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T15:00:26.424+0000",
                    "updated": "2021-07-01T15:00:26.424+0000",
                    "started": "2021-07-01T15:00:26.424+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617635",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617659",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581#issuecomment-872356997\n\n\n   Will merge now. Thank you for the reviews!\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T15:50:40.237+0000",
                    "updated": "2021-07-01T15:50:40.237+0000",
                    "started": "2021-07-01T15:50:40.236+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617659",
                    "issueId": "13335636"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/worklog/617663",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #10581:\nURL: https://github.com/apache/arrow/pull/10581\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-01T15:52:53.296+0000",
                    "updated": "2021-07-01T15:52:53.296+0000",
                    "started": "2021-07-01T15:52:53.296+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617663",
                    "issueId": "13335636"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/3",
            "id": "3",
            "description": "A task that needs to be done.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype",
            "name": "Task",
            "subtask": false,
            "avatarId": 21148
        },
        "timespent": 8400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1ca614b4[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1301a16e[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@ac24263[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@14d68884[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@386b3ef7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@71c248d5[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@698bddd4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4939eac9[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2844f99f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4b2388a2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7c71996f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7a985b8a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 8400,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jul 01 15:52:41 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-07-01T15:52:41.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10316/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2020-10-15T16:45:22.000+0000",
        "updated": "2021-07-01T15:52:54.000+0000",
        "timeoriginalestimate": null,
        "description": "As suggested by [~bkietz] here:\r\nhttps://github.com/apache/arrow/pull/8457#discussion_r504966207\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 8400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Consider using __wrapped__ for compute function introspection",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13335636/comment/17372904",
                    "id": "17372904",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 10581\n[https://github.com/apache/arrow/pull/10581]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-07-01T15:52:41.578+0000",
                    "updated": "2021-07-01T15:52:41.578+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0jqio:",
        "customfield_12314139": null
    }
}