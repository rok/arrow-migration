{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13154424",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424",
    "key": "ARROW-2494",
    "fields": {
        "parent": {
            "id": "13148900",
            "key": "ARROW-2365",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13148900",
            "fields": {
                "summary": "[Plasma] Return status codes instead of crashing",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                    "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                    "name": "Closed",
                    "id": "6",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                    "id": "1",
                    "description": "A problem which impairs or prevents the functions of the product.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                    "name": "Bug",
                    "subtask": false,
                    "avatarId": 21133
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2494/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3a6bf428[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@733ba0df[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3219d7bc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@1c8aa478[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@693666f2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@b7c4001[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@77a4d2e5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3e44110d[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@649fe1c1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@d0ac91b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5c6801a5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@42babf5c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Apr 23 16:08:49 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-04-23T16:08:49.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2494/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-04-23T09:13:49.000+0000",
        "updated": "2018-04-23T16:08:49.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "Return status codes from PlasmaClient::Seal",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447815",
                    "id": "16447815",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "kszucs opened a new pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932\n \n \n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:15:53.153+0000",
                    "updated": "2018-04-23T09:15:53.153+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447826",
                    "id": "16447826",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183327354\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   I'm not a native English speaker, but while we're at it, perhaps we could fix the grammar in this error message and the one below?\r\n   Something like \"Seal() called on an object without a reference to it\".\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:26:40.311+0000",
                    "updated": "2018-04-23T09:26:40.311+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447827",
                    "id": "16447827",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183327690\n \n \n\n ##########\n File path: cpp/src/plasma/test/client_tests.cc\n ##########\n @@ -90,6 +90,21 @@ class TestPlasmaStore : public ::testing::Test {\n   PlasmaClient client2_;\n };\n \n+TEST_F(TestPlasmaStore, SealErrorsTest) {\n+  ObjectID object_id = ObjectID::from_random();\n+\n+  Status result = client_.Seal(object_id);\n+  ASSERT_EQ(result.IsPlasmaObjectNonexistent(), true);\n \n Review comment:\n   You can use ASSERT_TRUE().\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:26:40.314+0000",
                    "updated": "2018-04-23T09:26:40.314+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447828",
                    "id": "16447828",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183327738\n \n \n\n ##########\n File path: cpp/src/plasma/test/client_tests.cc\n ##########\n @@ -90,6 +90,21 @@ class TestPlasmaStore : public ::testing::Test {\n   PlasmaClient client2_;\n };\n \n+TEST_F(TestPlasmaStore, SealErrorsTest) {\n+  ObjectID object_id = ObjectID::from_random();\n+\n+  Status result = client_.Seal(object_id);\n+  ASSERT_EQ(result.IsPlasmaObjectNonexistent(), true);\n+\n+  // Create object.\n+  std::vector<uint8_t> data(100, 0);\n+  CreateObject(client_, object_id, {42}, data);\n+\n+  // Trying to seal it again.\n+  result = client_.Seal(object_id);\n+  ASSERT_EQ(result.IsPlasmaObjectAlreadySealed(), true);\n \n Review comment:\n   Same here.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:26:40.377+0000",
                    "updated": "2018-04-23T09:26:40.377+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447848",
                    "id": "16447848",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "kszucs commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183331248\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   Me neither :) Shouldn't we incorporate the object ID in the message?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:37:26.023+0000",
                    "updated": "2018-04-23T09:37:26.023+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447852",
                    "id": "16447852",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "kszucs commented on issue #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#issuecomment-383516365\n \n \n   @pitrou I've created a subtask in JIRA. Generally We should replace all occurrences of `ARROW_CHECK`, right?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:41:04.506+0000",
                    "updated": "2018-04-23T09:41:04.506+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447853",
                    "id": "16447853",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "kszucs commented on issue #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#issuecomment-383516365\n \n \n   @pitrou Generally We should replace all occurrences of `ARROW_CHECK`, right? I've created a subtask in JIRA, should I do the same with the remaining ones?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:41:23.807+0000",
                    "updated": "2018-04-23T09:41:23.807+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447855",
                    "id": "16447855",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183333281\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   If there's a function to pretty-print object IDs when why not :-)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:44:31.312+0000",
                    "updated": "2018-04-23T09:44:31.312+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447856",
                    "id": "16447856",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183333281\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   If there's a function to pretty-print object IDs then why not :-)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:44:38.345+0000",
                    "updated": "2018-04-23T09:44:38.345+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447858",
                    "id": "16447858",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on issue #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#issuecomment-383517652\n \n \n   When `ARROW_CHECK` checks for an internal invariant, we can keep it. But in other cases (such as non-existent object ID or IO error), it would be better to replace it with an error return, yes.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T09:45:26.011+0000",
                    "updated": "2018-04-23T09:45:26.011+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447983",
                    "id": "16447983",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "kszucs commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183360587\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   @pitrou I guess pretty printing of plasma object should follow the API of [arrow::pretty_print](https://github.com/apache/arrow/blob/master/cpp/src/arrow/pretty_print.h), if so should I create a JIRA ticket instead?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T11:26:46.768+0000",
                    "updated": "2018-04-23T11:26:46.768+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16447992",
                    "id": "16447992",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932#discussion_r183360950\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -604,10 +604,16 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Plasma client called seal an object without a reference to it\");\n \n Review comment:\n   I'm not sure, but that sounds reasonable, and can be discussed on a JIRA issue indeed.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T11:28:15.130+0000",
                    "updated": "2018-04-23T11:28:15.130+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16448362",
                    "id": "16448362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou closed pull request #1932: ARROW-2494: [C++] Return status codes from PlasmaClient::Seal instead of crashing\nURL: https://github.com/apache/arrow/pull/1932\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/status.h b/cpp/src/arrow/status.h\nindex ed524ae6c..8b82e2ab7 100644\n--- a/cpp/src/arrow/status.h\n+++ b/cpp/src/arrow/status.h\n@@ -80,7 +80,8 @@ enum class StatusCode : char {\n   PythonError = 12,\n   PlasmaObjectExists = 20,\n   PlasmaObjectNonexistent = 21,\n-  PlasmaStoreFull = 22\n+  PlasmaStoreFull = 22,\n+  PlasmaObjectAlreadySealed = 23,\n };\n \n #if defined(__clang__)\n@@ -144,6 +145,10 @@ class ARROW_EXPORT Status {\n     return Status(StatusCode::PlasmaObjectNonexistent, msg);\n   }\n \n+  static Status PlasmaObjectAlreadySealed(const std::string& msg) {\n+    return Status(StatusCode::PlasmaObjectAlreadySealed, msg);\n+  }\n+\n   static Status PlasmaStoreFull(const std::string& msg) {\n     return Status(StatusCode::PlasmaStoreFull, msg);\n   }\n@@ -168,6 +173,10 @@ class ARROW_EXPORT Status {\n   bool IsPlasmaObjectNonexistent() const {\n     return code() == StatusCode::PlasmaObjectNonexistent;\n   }\n+  // An already sealed object is tried to be sealed again.\n+  bool IsPlasmaObjectAlreadySealed() const {\n+    return code() == StatusCode::PlasmaObjectAlreadySealed;\n+  }\n   // An object is too large to fit into the plasma store.\n   bool IsPlasmaStoreFull() const { return code() == StatusCode::PlasmaStoreFull; }\n \ndiff --git a/cpp/src/plasma/client.cc b/cpp/src/plasma/client.cc\nindex 0d44b1135..015c9731a 100644\n--- a/cpp/src/plasma/client.cc\n+++ b/cpp/src/plasma/client.cc\n@@ -604,10 +604,15 @@ Status PlasmaClient::Seal(const ObjectID& object_id) {\n   // Make sure this client has a reference to the object before sending the\n   // request to Plasma.\n   auto object_entry = objects_in_use_.find(object_id);\n-  ARROW_CHECK(object_entry != objects_in_use_.end())\n-      << \"Plasma client called seal an object without a reference to it\";\n-  ARROW_CHECK(!object_entry->second->is_sealed)\n-      << \"Plasma client called seal an already sealed object\";\n+\n+  if (object_entry == objects_in_use_.end()) {\n+    return Status::PlasmaObjectNonexistent(\n+        \"Seal() called on an object without a reference to it\");\n+  }\n+  if (object_entry->second->is_sealed) {\n+    return Status::PlasmaObjectAlreadySealed(\"Seal() called on an already sealed object\");\n+  }\n+\n   object_entry->second->is_sealed = true;\n   /// Send the seal request to Plasma.\n   static unsigned char digest[kDigestSize];\ndiff --git a/cpp/src/plasma/test/client_tests.cc b/cpp/src/plasma/test/client_tests.cc\nindex 10e4e4f64..dad7688ba 100644\n--- a/cpp/src/plasma/test/client_tests.cc\n+++ b/cpp/src/plasma/test/client_tests.cc\n@@ -90,12 +90,27 @@ class TestPlasmaStore : public ::testing::Test {\n   PlasmaClient client2_;\n };\n \n+TEST_F(TestPlasmaStore, SealErrorsTest) {\n+  ObjectID object_id = ObjectID::from_random();\n+\n+  Status result = client_.Seal(object_id);\n+  ASSERT_TRUE(result.IsPlasmaObjectNonexistent());\n+\n+  // Create object.\n+  std::vector<uint8_t> data(100, 0);\n+  CreateObject(client_, object_id, {42}, data);\n+\n+  // Trying to seal it again.\n+  result = client_.Seal(object_id);\n+  ASSERT_TRUE(result.IsPlasmaObjectAlreadySealed());\n+}\n+\n TEST_F(TestPlasmaStore, DeleteTest) {\n   ObjectID object_id = ObjectID::from_random();\n \n   // Test for deleting non-existance object.\n   Status result = client_.Delete(object_id);\n-  ASSERT_EQ(result.IsPlasmaObjectNonexistent(), true);\n+  ASSERT_TRUE(result.IsPlasmaObjectNonexistent());\n \n   // Test for the object being in local Plasma store.\n   // First create object.\n@@ -108,7 +123,7 @@ TEST_F(TestPlasmaStore, DeleteTest) {\n \n   // Object is in use, can't be delete.\n   result = client_.Delete(object_id);\n-  ASSERT_EQ(result.IsUnknownError(), true);\n+  ASSERT_TRUE(result.IsUnknownError());\n \n   // Avoid race condition of Plasma Manager waiting for notification.\n   ARROW_CHECK_OK(client_.Release(object_id));\n@@ -121,7 +136,7 @@ TEST_F(TestPlasmaStore, ContainsTest) {\n   // Test for object non-existence.\n   bool has_object;\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, false);\n+  ASSERT_FALSE(has_object);\n \n   // Test for the object being in local Plasma store.\n   // First create object.\n@@ -131,7 +146,7 @@ TEST_F(TestPlasmaStore, ContainsTest) {\n   std::vector<ObjectBuffer> object_buffers;\n   ARROW_CHECK_OK(client_.Get({object_id}, -1, &object_buffers));\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, true);\n+  ASSERT_TRUE(has_object);\n }\n \n TEST_F(TestPlasmaStore, GetTest) {\n@@ -277,7 +292,7 @@ TEST_F(TestPlasmaStore, MultipleClientTest) {\n   // Test for object non-existence on the first client.\n   bool has_object;\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, false);\n+  ASSERT_FALSE(has_object);\n \n   // Test for the object being in local Plasma store.\n   // First create and seal object on the second client.\n@@ -291,7 +306,7 @@ TEST_F(TestPlasmaStore, MultipleClientTest) {\n   ARROW_CHECK_OK(client_.Get({object_id}, -1, &object_buffers));\n   ASSERT_TRUE(object_buffers[0].data);\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, true);\n+  ASSERT_TRUE(has_object);\n \n   // Test that one client disconnecting does not interfere with the other.\n   // First create object on the second client.\n@@ -304,7 +319,7 @@ TEST_F(TestPlasmaStore, MultipleClientTest) {\n   ARROW_CHECK_OK(client2_.Get({object_id}, -1, &object_buffers));\n   ASSERT_TRUE(object_buffers[0].data);\n   ARROW_CHECK_OK(client2_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, true);\n+  ASSERT_TRUE(has_object);\n }\n \n TEST_F(TestPlasmaStore, ManyObjectTest) {\n@@ -318,7 +333,7 @@ TEST_F(TestPlasmaStore, ManyObjectTest) {\n     // Test for object non-existence on the first client.\n     bool has_object;\n     ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-    ASSERT_EQ(has_object, false);\n+    ASSERT_FALSE(has_object);\n \n     // Test for the object being in local Plasma store.\n     // First create and seal object on the first client.\n@@ -333,7 +348,7 @@ TEST_F(TestPlasmaStore, ManyObjectTest) {\n       ARROW_CHECK_OK(client_.Seal(object_id));\n       // Test that the first client can get the object.\n       ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-      ASSERT_EQ(has_object, true);\n+      ASSERT_TRUE(has_object);\n     } else if (i % 3 == 1) {\n       // Abort one third of the objects.\n       ARROW_CHECK_OK(client_.Release(object_id));\n@@ -351,10 +366,10 @@ TEST_F(TestPlasmaStore, ManyObjectTest) {\n     ARROW_CHECK_OK(client2_.Contains(object_id, &has_object));\n     if (i % 3 == 0) {\n       // The first third should be sealed.\n-      ASSERT_EQ(has_object, true);\n+      ASSERT_TRUE(has_object);\n     } else {\n       // The rest were aborted, so the object is not in the store.\n-      ASSERT_EQ(has_object, false);\n+      ASSERT_FALSE(has_object);\n     }\n     i++;\n   }\n@@ -429,7 +444,7 @@ TEST_F(TestPlasmaStore, MultipleClientGPUTest) {\n   // Test for object non-existence on the first client.\n   bool has_object;\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, false);\n+  ASSERT_FALSE(has_object);\n \n   // Test for the object being in local Plasma store.\n   // First create and seal object on the second client.\n@@ -443,7 +458,7 @@ TEST_F(TestPlasmaStore, MultipleClientGPUTest) {\n   // Test that the first client can get the object.\n   ARROW_CHECK_OK(client_.Get({object_id}, -1, &object_buffers));\n   ARROW_CHECK_OK(client_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, true);\n+  ASSERT_TRUE(has_object);\n \n   // Test that one client disconnecting does not interfere with the other.\n   // First create object on the second client.\n@@ -456,7 +471,7 @@ TEST_F(TestPlasmaStore, MultipleClientGPUTest) {\n   ARROW_CHECK_OK(client2_.Seal(object_id));\n   object_buffers.clear();\n   ARROW_CHECK_OK(client2_.Contains(object_id, &has_object));\n-  ASSERT_EQ(has_object, true);\n+  ASSERT_TRUE(has_object);\n   ARROW_CHECK_OK(client2_.Get({object_id}, -1, &object_buffers));\n   ASSERT_EQ(object_buffers.size(), 1);\n   ASSERT_EQ(object_buffers[0].device_num, 1);\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-23T16:08:45.716+0000",
                    "updated": "2018-04-23T16:08:45.716+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13154424/comment/16448363",
                    "id": "16448363",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 1932\n[https://github.com/apache/arrow/pull/1932]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2018-04-23T16:08:49.333+0000",
                    "updated": "2018-04-23T16:08:49.333+0000"
                }
            ],
            "maxResults": 14,
            "total": 14,
            "startAt": 0
        },
        "customfield_12311820": "0|i3sw0f:",
        "customfield_12314139": null
    }
}