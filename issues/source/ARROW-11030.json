{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13347774",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774",
    "key": "ARROW-11030",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348823",
                "id": "12348823",
                "description": "",
                "name": "3.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-01-25"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "aggregateprogress": {
            "progress": 28200,
            "total": 28200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 28200,
            "total": 28200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11030/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 47,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530015",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan opened a new pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070\n\n\n   This is based on a earlier PR and is meant to help discussing a solution for https://issues.apache.org/jira/browse/ARROW-11030\r\n   \r\n   The benchmark results look very promising, mostly removing the overhead of small bathes. For a very small batch size of 64, on tcph q 12:\r\n   \r\n   ```\r\n   Query 12 iteration 0 took 1726.5 ms\r\n   Query 12 iteration 1 took 1722.5 ms\r\n   Query 12 iteration 2 took 1781.3 ms\r\n   Query 12 iteration 3 took 1830.6 ms\r\n   ```\r\n   \r\n   Master\r\n   \r\n   ```\r\n   Query 12 iteration 0 took 11925.1 ms\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T12:41:24.438+0000",
                    "updated": "2021-01-01T12:41:24.438+0000",
                    "started": "2021-01-01T12:41:24.438+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530015",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530017",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753312905\n\n\n   https://issues.apache.org/jira/browse/ARROW-11030\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T12:52:55.949+0000",
                    "updated": "2021-01-01T12:52:55.949+0000",
                    "started": "2021-01-01T12:52:55.949+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530017",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530018",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (54b9c3a) into [master](https://codecov.io/gh/apache/arrow/commit/cc0ee5efcf9f6a67bcc407a11e8553a0409275c1?el=desc) (cc0ee5e) will **increase** coverage by `0.00%`.\n   > The diff coverage is `88.57%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@           Coverage Diff           @@\n   ##           master    #9070   +/-   ##\n   =======================================\n     Coverage   82.55%   82.55%           \n   =======================================\n     Files         203      203           \n     Lines       50043    50055   +12     \n   =======================================\n   + Hits        41313    41323   +10     \n   - Misses       8730     8732    +2     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `89.71% <88.23%> (-0.23%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [cc0ee5e...54b9c3a](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T12:56:10.155+0000",
                    "updated": "2021-01-01T12:56:10.155+0000",
                    "started": "2021-01-01T12:56:10.154+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530018",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530019",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313633\n\n\n   FYI @jorgecarleitao @andygrove \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T13:01:08.397+0000",
                    "updated": "2021-01-01T13:01:08.397+0000",
                    "started": "2021-01-01T13:01:08.397+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530019",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530021",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (2db270c) into [master](https://codecov.io/gh/apache/arrow/commit/cc0ee5efcf9f6a67bcc407a11e8553a0409275c1?el=desc) (cc0ee5e) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `86.11%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.55%   82.55%   -0.01%     \n   ==========================================\n     Files         203      203              \n     Lines       50043    50056      +13     \n   ==========================================\n   + Hits        41313    41323      +10     \n   - Misses       8730     8733       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `89.45% <85.71%> (-0.49%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [cc0ee5e...2db270c](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T13:17:09.815+0000",
                    "updated": "2021-01-01T13:17:09.815+0000",
                    "started": "2021-01-01T13:17:09.815+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530021",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530040",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753330627\n\n\n   I'm seeing a 2x improvement in performance for q12 @ SF=100 with batch size 4096 :rocket: \r\n   \r\n   This should allow us to reduce the default batch size and reduce memory pressure.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T15:38:59.201+0000",
                    "updated": "2021-01-01T15:38:59.201+0000",
                    "started": "2021-01-01T15:38:59.201+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530040",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530055",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (1511f0e) into [master](https://codecov.io/gh/apache/arrow/commit/cc0ee5efcf9f6a67bcc407a11e8553a0409275c1?el=desc) (cc0ee5e) will **increase** coverage by `0.00%`.\n   > The diff coverage is `92.06%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@           Coverage Diff           @@\n   ##           master    #9070   +/-   ##\n   =======================================\n     Coverage   82.55%   82.55%           \n   =======================================\n     Files         203      203           \n     Lines       50043    50055   +12     \n   =======================================\n   + Hits        41313    41324   +11     \n   - Misses       8730     8731    +1     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `89.42% <91.93%> (-0.52%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/arrow/schema.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9hcnJvdy9zY2hlbWEucnM=) | `90.93% <0.00%> (+0.31%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [cc0ee5e...1511f0e](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-01T19:00:52.966+0000",
                    "updated": "2021-01-01T19:00:52.966+0000",
                    "started": "2021-01-01T19:00:52.965+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530055",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530221",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (bc5bdfa) into [master](https://codecov.io/gh/apache/arrow/commit/4b7cdcb9220b6d94b251aef32c21ef9b4097ecfa?el=desc) (4b7cdcb) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `92.18%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.61%   82.61%   -0.01%     \n   ==========================================\n     Files         203      203              \n     Lines       50140    50152      +12     \n   ==========================================\n   + Hits        41422    41431       +9     \n   - Misses       8718     8721       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `89.04% <92.06%> (-0.49%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [4b7cdcb...bc5bdfa](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-02T16:54:42.746+0000",
                    "updated": "2021-01-02T16:54:42.746+0000",
                    "started": "2021-01-02T16:54:42.745+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530221",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530238",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (797ffb6) into [master](https://codecov.io/gh/apache/arrow/commit/4b7cdcb9220b6d94b251aef32c21ef9b4097ecfa?el=desc) (4b7cdcb) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `92.18%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.61%   82.61%   -0.01%     \n   ==========================================\n     Files         203      203              \n     Lines       50140    50152      +12     \n   ==========================================\n   + Hits        41422    41431       +9     \n   - Misses       8718     8721       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `89.04% <92.06%> (-0.49%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [4b7cdcb...797ffb6](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-02T18:34:52.114+0000",
                    "updated": "2021-01-02T18:34:52.114+0000",
                    "started": "2021-01-02T18:34:52.114+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530238",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530332",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (bbec070) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `85.52%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.59%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50179      +10     \n   ==========================================\n   + Hits        41436    41443       +7     \n   - Misses       8733     8736       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `86.16% <85.33%> (-0.17%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.24% <0.00%> (-0.20%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...6d182c9](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T04:34:26.961+0000",
                    "updated": "2021-01-03T04:34:26.961+0000",
                    "started": "2021-01-03T04:34:26.961+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530332",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530333",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (2418113) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `84.00%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.58%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50181      +12     \n   ==========================================\n   + Hits        41436    41444       +8     \n   - Misses       8733     8737       +4     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `85.97% <83.78%> (-0.36%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.24% <0.00%> (-0.20%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...6d182c9](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T04:34:40.478+0000",
                    "updated": "2021-01-03T04:34:40.478+0000",
                    "started": "2021-01-03T04:34:40.478+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530333",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530334",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (0efb5a7) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `85.13%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.59%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50179      +10     \n   ==========================================\n   + Hits        41436    41443       +7     \n   - Misses       8733     8736       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `86.16% <84.93%> (-0.17%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.24% <0.00%> (-0.20%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...6d182c9](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T04:35:54.198+0000",
                    "updated": "2021-01-03T04:35:54.198+0000",
                    "started": "2021-01-03T04:35:54.198+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530334",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530335",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (6d182c9) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `85.52%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.59%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50179      +10     \n   ==========================================\n   + Hits        41436    41443       +7     \n   - Misses       8733     8736       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `86.16% <85.33%> (-0.17%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.24% <0.00%> (-0.20%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...6d182c9](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T04:42:59.647+0000",
                    "updated": "2021-01-03T04:42:59.647+0000",
                    "started": "2021-01-03T04:42:59.647+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530335",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530338",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#discussion_r550959005\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -48,23 +54,15 @@ use super::{\n use crate::error::{DataFusionError, Result};\n \n use super::{ExecutionPlan, Partitioning, RecordBatchStream, SendableRecordBatchStream};\n+use crate::physical_plan::coalesce_batches::concat_batches;\n\nReview comment:\n       Is there a place to put this?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:31:34.561+0000",
                    "updated": "2021-01-03T05:31:34.561+0000",
                    "started": "2021-01-03T05:31:34.561+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530338",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530339",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (d58abf6) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `85.71%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.59%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50180      +11     \n   ==========================================\n   + Hits        41436    41444       +8     \n   - Misses       8733     8736       +3     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `86.19% <85.52%> (-0.13%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.24% <0.00%> (-0.20%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...69d3286](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:31:48.095+0000",
                    "updated": "2021-01-03T05:31:48.095+0000",
                    "started": "2021-01-03T05:31:48.095+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530339",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530340",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#discussion_r550959182\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -479,37 +490,40 @@ fn build_batch(\n fn build_join_indexes(\n     left: &JoinHashMap,\n     right: &RecordBatch,\n-    join_type: &JoinType,\n+    join_type: JoinType,\n     right_on: &HashSet<String>,\n-) -> Result<Vec<(JoinIndex, RightIndex)>> {\n+) -> Result<(UInt64Array, UInt32Array)> {\n     let keys_values = right_on\n         .iter()\n         .map(|name| Ok(col(name).evaluate(right)?.into_array(right.num_rows())))\n         .collect::<Result<Vec<_>>>()?;\n \n     let mut key = Vec::with_capacity(keys_values.len());\n \n+    let mut left_indices = UInt64Builder::new(0);\n\nReview comment:\n       Seems better for inner join to *not* use builder / allocate bitmap for nulls? What is the current most ergonomic way to do this? \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:34:11.980+0000",
                    "updated": "2021-01-03T05:34:11.980+0000",
                    "started": "2021-01-03T05:34:11.980+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530340",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530341",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#discussion_r550959459\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -479,37 +490,40 @@ fn build_batch(\n fn build_join_indexes(\n     left: &JoinHashMap,\n     right: &RecordBatch,\n-    join_type: &JoinType,\n+    join_type: JoinType,\n     right_on: &HashSet<String>,\n-) -> Result<Vec<(JoinIndex, RightIndex)>> {\n+) -> Result<(UInt64Array, UInt32Array)> {\n     let keys_values = right_on\n         .iter()\n         .map(|name| Ok(col(name).evaluate(right)?.into_array(right.num_rows())))\n         .collect::<Result<Vec<_>>>()?;\n \n     let mut key = Vec::with_capacity(keys_values.len());\n \n+    let mut left_indices = UInt64Builder::new(0);\n+    let mut right_indices = UInt32Builder::new(0);\n+\n     match join_type {\n         JoinType::Inner => {\n-            let mut indexes = Vec::new(); // unknown a prior size\n-\n             // Visit all of the right rows\n             for row in 0..right.num_rows() {\n                 // Get the key and find it in the build index\n                 create_key(&keys_values, row, &mut key)?;\n                 let left_indexes = left.get(&key);\n-\n                 // for every item on the left and right with this key, add the respective pair\n-                left_indexes.unwrap_or(&vec![]).iter().for_each(|x| {\n-                    // on an inner join, left and right indices are present\n-                    indexes.push((Some(*x), Some(row as u32)));\n-                })\n+\n+                if let Some(indices) = left_indexes {\n+                    left_indices.append_slice(&indices)?;\n+\n+                    for _ in 0..indices.len() {\n+                        // on an inner join, left and right indices are present\n+                        right_indices.append_value(row as u32)?;\n\nReview comment:\n       this could use something like fill\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -479,37 +490,40 @@ fn build_batch(\n fn build_join_indexes(\n     left: &JoinHashMap,\n     right: &RecordBatch,\n-    join_type: &JoinType,\n+    join_type: JoinType,\n     right_on: &HashSet<String>,\n-) -> Result<Vec<(JoinIndex, RightIndex)>> {\n+) -> Result<(UInt64Array, UInt32Array)> {\n     let keys_values = right_on\n         .iter()\n         .map(|name| Ok(col(name).evaluate(right)?.into_array(right.num_rows())))\n         .collect::<Result<Vec<_>>>()?;\n \n     let mut key = Vec::with_capacity(keys_values.len());\n \n+    let mut left_indices = UInt64Builder::new(0);\n+    let mut right_indices = UInt32Builder::new(0);\n+\n     match join_type {\n         JoinType::Inner => {\n-            let mut indexes = Vec::new(); // unknown a prior size\n-\n             // Visit all of the right rows\n             for row in 0..right.num_rows() {\n                 // Get the key and find it in the build index\n                 create_key(&keys_values, row, &mut key)?;\n                 let left_indexes = left.get(&key);\n-\n                 // for every item on the left and right with this key, add the respective pair\n-                left_indexes.unwrap_or(&vec![]).iter().for_each(|x| {\n-                    // on an inner join, left and right indices are present\n-                    indexes.push((Some(*x), Some(row as u32)));\n-                })\n+\n+                if let Some(indices) = left_indexes {\n+                    left_indices.append_slice(&indices)?;\n+\n+                    for _ in 0..indices.len() {\n+                        // on an inner join, left and right indices are present\n+                        right_indices.append_value(row as u32)?;\n\nReview comment:\n       this could use something like append_n\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:37:27.283+0000",
                    "updated": "2021-01-03T05:37:27.283+0000",
                    "started": "2021-01-03T05:37:27.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530341",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530342",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#discussion_r550959638\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -119,6 +125,36 @@ impl HashJoinExec {\n             build_side: Arc::new(Mutex::new(None)),\n         })\n     }\n+\n+    /// Calculates column indices and left/right placement on input / output schemas and jointype\n+    fn column_indices_from_schema(&self) -> ArrowResult<Vec<ColumnIndex>> {\n\nReview comment:\n       This is now calculated upfront\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:40:12.903+0000",
                    "updated": "2021-01-03T05:40:12.903+0000",
                    "started": "2021-01-03T05:40:12.903+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530342",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530344",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#issuecomment-753313211\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=h1) Report\n   > Merging [#9070](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=desc) (69d3286) into [master](https://codecov.io/gh/apache/arrow/commit/5228ede9abf8ecf9b4bb68a06075cd16af3523e9?el=desc) (5228ede) will **decrease** coverage by `0.00%`.\n   > The diff coverage is `85.71%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9070/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9070      +/-   ##\n   ==========================================\n   - Coverage   82.59%   82.59%   -0.01%     \n   ==========================================\n     Files         204      204              \n     Lines       50169    50180      +11     \n   ==========================================\n   + Hits        41436    41445       +9     \n   - Misses       8733     8735       +2     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `86.19% <85.52%> (-0.13%)` | :arrow_down: |\n   | [...t/datafusion/src/physical\\_plan/coalesce\\_batches.rs](https://codecov.io/gh/apache/arrow/pull/9070/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2NvYWxlc2NlX2JhdGNoZXMucnM=) | `88.23% <100.00%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=footer). Last update [5228ede...c96ba9f](https://codecov.io/gh/apache/arrow/pull/9070?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:48:50.598+0000",
                    "updated": "2021-01-03T05:48:50.598+0000",
                    "started": "2021-01-03T05:48:50.598+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530344",
                    "issueId": "13347774"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/worklog/530345",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9070:\nURL: https://github.com/apache/arrow/pull/9070#discussion_r550960259\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/hash_join.rs\n##########\n@@ -297,69 +340,28 @@ impl RecordBatchStream for HashJoinStream {\n /// *\n fn build_batch_from_indices(\n     schema: &Schema,\n-    left: &Vec<RecordBatch>,\n+    left: &RecordBatch,\n     right: &RecordBatch,\n-    join_type: &JoinType,\n-    indices: &[(JoinIndex, RightIndex)],\n+    left_indices: UInt64Array,\n+    right_indices: UInt32Array,\n+    column_indices: &Vec<ColumnIndex>,\n ) -> ArrowResult<RecordBatch> {\n-    if left.is_empty() {\n-        todo!(\"Create empty record batch\");\n-    }\n-\n-    let (primary_is_left, primary_schema, secondary_schema) = match join_type {\n-        JoinType::Inner | JoinType::Left => (true, left[0].schema(), right.schema()),\n-        JoinType::Right => (false, right.schema(), left[0].schema()),\n-    };\n-\n     // build the columns of the new [RecordBatch]:\n     // 1. pick whether the column is from the left or right\n-    // 2. based on the pick, `take` items from the different recordBatches\n+    // 2. based on the pick, `take` items from the different RecordBatches\n     let mut columns: Vec<Arc<dyn Array>> = Vec::with_capacity(schema.fields().len());\n \n-    let right_indices: UInt32Array =\n-        indices.iter().map(|(_, join_index)| join_index).collect();\n-\n-    for field in schema.fields() {\n-        // pick the column (left or right) based on the field name.\n-        let (is_primary, column_index) = match primary_schema.index_of(field.name()) {\n-            Ok(i) => Ok((true, i)),\n-            Err(_) => {\n-                match secondary_schema.index_of(field.name()) {\n-                    Ok(i) => Ok((false, i)),\n-                    _ => Err(DataFusionError::Internal(\n-                        format!(\"During execution, the column {} was not found in neither the left or right side of the join\", field.name()).to_string()\n-                    ))\n-                }\n-            }\n-        }.map_err(DataFusionError::into_arrow_external_error)?;\n-\n-        let is_left =\n-            (is_primary && primary_is_left) || (!is_primary && !primary_is_left);\n-\n-        let array = if is_left {\n-            // Note that we take `.data_ref()` to gather the [ArrayData] of each array.\n-            let arrays = left\n-                .iter()\n-                .map(|batch| batch.column(column_index).data_ref().as_ref())\n-                .collect::<Vec<_>>();\n-\n-            let mut mutable = MutableArrayData::new(arrays, true, indices.len());\n-            // use the left indices\n-            for (join_index, _) in indices {\n-                match join_index {\n-                    Some((batch, row)) => mutable.extend(*batch, *row, *row + 1),\n-                    None => mutable.extend_nulls(1),\n-                }\n-            }\n-            make_array(Arc::new(mutable.freeze()))\n+    for column_index in column_indices {\n+        let array = if column_index.is_left {\n+            let array = left.column(column_index.index);\n+            compute::take(array.as_ref(), &left_indices, None)?\n         } else {\n-            // use the right indices\n-            let array = right.column(column_index);\n+            let array = right.column(column_index.index);\n             compute::take(array.as_ref(), &right_indices, None)?\n         };\n         columns.push(array);\n     }\n-    Ok(RecordBatch::try_new(Arc::new(schema.clone()), columns)?)\n+    RecordBatch::try_new(Arc::new(schema.clone()), columns)\n }\n \n /// Create a key `Vec<u8>` that is used as key for the hashmap\n\nReview comment:\n       Currently looks like creating this key / hashing is most expensive part of the queries.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-03T05:49:04.038+0000",
                    "updated": "2021-01-03T05:49:04.038+0000",
                    "started": "2021-01-03T05:49:04.037+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "530345",
                    "issueId": "13347774"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 28200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2ffa6c84[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@9f2cb9[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d0c04ea[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@240f0116[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4813014b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1f3acc6c[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@22aca035[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7ef712c7[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2e3e5d0b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@672ebd0c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20c404d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@66635b21[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 28200,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Feb 24 01:51:49 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-01-07T14:02:29.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11030/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2020-12-24T16:36:24.000+0000",
        "updated": "2021-02-24T01:51:49.000+0000",
        "timeoriginalestimate": null,
        "description": "Performance of joins slows down dramatically with smaller batches.\r\n\r\nThe issue is related to slow performance of MutableDataArray::new() when passed a high number of batches. This happens when passing in all of the batches from the build side of the join and this happens once per build-side join key for each probe-side batch.\r\n\r\nIt seems to get exponentially slower as the number of arrays increases even though the number of rows is the same.\r\n\r\nI modified hash_join.rs to have this debug code:\r\n{code:java}\r\nlet start = Instant::now();\r\nlet row_count: usize = arrays.iter().map(|arr| arr.len()).sum();\r\nlet num_arrays = arrays.len();\r\nlet mut mutable = MutableArrayData::new(arrays, true, capacity);\r\nif num_arrays > 0 {\r\n    debug!(\"MutableArrayData::new() with {} arrays containing {} rows took {} ms\", num_arrays, row_count, start.elapsed().as_millis());\r\n} {code}\r\nBatch size 131072:\r\n{code:java}\r\nMutableArrayData::new() with 4584 arrays containing 3115341 rows took 1 ms\r\nMutableArrayData::new() with 4584 arrays containing 3115341 rows took 1 ms\r\nMutableArrayData::new() with 4584 arrays containing 3115341 rows took 1 ms {code}\r\nBatch size 16384:\r\n{code:java}\r\nMutableArrayData::new() with 36624 arrays containing 3115341 rows took 19 ms\r\nMutableArrayData::new() with 36624 arrays containing 3115341 rows took 16 ms\r\nMutableArrayData::new() with 36624 arrays containing 3115341 rows took 17 ms {code}\r\nBatch size 4096:\r\n{code:java}\r\nMutableArrayData::new() with 146496 arrays containing 3115341 rows took 88 ms\r\nMutableArrayData::new() with 146496 arrays containing 3115341 rows took 89 ms\r\nMutableArrayData::new() with 146496 arrays containing 3115341 rows took 88 ms {code}\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "7h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 28200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] [DataFusion] HashJoinExec slow with many batches",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17255771",
                    "id": "17255771",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "[~jorgecarleitao]I have more time tomorrow to work on this but please let me know if you have any ideas that may help me.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-29T02:22:12.237+0000",
                    "updated": "2020-12-29T02:22:12.237+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17255780",
                    "id": "17255780",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I am going to work on https://issues.apache.org/jira/browse/ARROW-11058 next and this will likely help with this issue.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-29T02:47:36.410+0000",
                    "updated": "2020-12-29T02:47:36.410+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17255842",
                    "id": "17255842",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "No idea why: I cannot find a N*N operation in `new`, so AFAI can tell, it should not even be polynomial. :/\r\n\r\nI agree that having an average of 20 rows per batch may be breaking some of the assumption we make about the performance of arrays.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-29T07:02:41.792+0000",
                    "updated": "2020-12-29T07:02:41.792+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256105",
                    "id": "17256105",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I have a theory on what might be happening here but I am struggling to really understand this.\r\n\r\nIt looks like we create a buffer and for each input array, we extend this buffer. Each time we extend it, the buffer is larger so the cost of extending it again gets higher each time?\r\n\r\nIs there a way we can compute upfront how much to extend it by and do one extend operation?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-29T18:42:30.880+0000",
                    "updated": "2020-12-29T18:42:30.880+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256109",
                    "id": "17256109",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "One comment I put in a PR, which is I think part of the problem:\r\n\r\nI think part of a further speed up could be moving the building of the left / build-side Vec<&ArrayData> arrays so that it is only created once instead of for each right batch in build_batch_from_indices. Currently when making the batch size smaller, the build-side Vec is built more times, but also contains more (smaller) batches itself, which could explain (part of the) big / exponential slowdown on smaller batches.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-29T18:46:45.886+0000",
                    "updated": "2020-12-29T18:46:45.886+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256115",
                    "id": "17256115",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "It's not directly related to the mutablearraydata::new(), but still makes the hash join having a part with exponential time.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-29T18:50:18.350+0000",
                    "updated": "2020-12-29T18:50:18.350+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256138",
                    "id": "17256138",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "But the same is applicable for mutablearraydata: for the left side of the join it generates n batches, which are iterated n times in mutablearraydata::new().",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-29T19:25:34.667+0000",
                    "updated": "2020-12-29T19:25:34.667+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256141",
                    "id": "17256141",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~andygrove], the MutableArrayData is basically:\r\n # bound to a bunch of existing Arrays (of the same type), so that it can \"copy slices of slots\" from any of those arrays\r\n # It uses the arrays' DataType to extend the buffers and child_data according to the spec\r\n\r\nThe parameter \"capacity\" (in number of slots) is used to reserve all buffers that we can reserve upfront (e.g. primitive types and offsets). In the case of a concat, we can compute that parameter exactly, since it is the sum of all arrays lens: https://github.com/apache/arrow/blob/f4ccceb2536bb6ed5bf584843c55c6628ad23494/rust/arrow/src/compute/kernels/concat.rs#L57\r\n\r\nThe `new` function allocates closures (one per array without child data) that are optimized to extend buffers accordingly.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-29T19:30:34.973+0000",
                    "updated": "2020-12-29T19:30:34.973+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256172",
                    "id": "17256172",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "Thanks [~jorgecarleitao] and [~Dandandan]\u00a0 for the information. It looks like I may have misunderstood the issue a bit. I am going to unassign this for now and change the title back to being specific to hash join.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-29T21:25:03.387+0000",
                    "updated": "2020-12-29T21:25:03.387+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256456",
                    "id": "17256456",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "So in summary, what looks like is the problem here:\r\n * for the left side of the join we\u00a0.iter()\u00a0on the left side batches each iteration (a couple of times, in the join implementation itself and in\u00a0MutableDataArray) when we process a probe-side batch.\r\n * if we halve the batch size, the number of items in the build-side array grows by two, but also the number of probe-side batches we process in the join, thus the\u00a0n*n\u00a0slowdown. (the MutableArrayData structure also itself seems not super efficient, making it already visible at bigger batch sizes)\r\n\r\nI am not sure what way best to solve it. I think we have to have something for the left-side batches so we can reuse a \"prepared\" structure which can be used in O(1) time in\u00a0build_batch_from_indices.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-30T11:09:29.132+0000",
                    "updated": "2020-12-30T11:11:50.774+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256575",
                    "id": "17256575",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I just did an experiment where I concatenated all the batches when building the build-side, so we always have a single batch on that side. It did not make any noticeable difference to performance.\r\n\r\nThe work is in [https://github.com/andygrove/arrow/tree/coalesce-left]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-30T16:02:56.235+0000",
                    "updated": "2020-12-30T16:02:56.235+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256609",
                    "id": "17256609",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~andygrove], interesting take, will check it out! Doesn't that branch already have the coalesce batches optimization though, so it shouldn't be it a small difference now anyway as it doesn't generate the tiny batches like before?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-30T17:11:13.733+0000",
                    "updated": "2020-12-30T17:11:13.733+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256945",
                    "id": "17256945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I think it would be nice to further experiment with concatenating the build side into a single batch.\r\n\r\nThoughts:\r\n * copying is very fast per element (compared to hashing, random access indexing, etc) so it seems a small penalty to pay upfront\r\n\r\n * indexing can use arrows take, which is relatively fast as it can avoid the overhead of the extra indirection, the less efficient MutableDataArray structure and the current remaining exponential behavior (small batches will always be slower though as we always have some constant overhead to pay per batch). take also has the potential for further optimization I think (e.g. SIMD), I think that is hard/impossible to do for something like MutableArrayData.\r\n * Makes code for left / right side more similar\r\n * Allows other simplifications / speed ups / avoiding extra copies utilizing the simplified structure and arrows kernels more.\r\n\r\nI added a PR for extending take\u00a0to support u64 here [https://github.com/apache/arrow/pull/9057]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-31T11:08:36.156+0000",
                    "updated": "2020-12-31T11:21:04.240+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17256972",
                    "id": "17256972",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~Dandandan], I agree with that approach.\r\n\r\nI originally implemented the `MutableArrayData` under the assumption that we had to \"hash-merge\" multiple arrays into a single array, building a new array out of N arrays. The original use-cases were \"hash-merge\" and \"sort-merge\". If we can merge all batches in a single batch prior to the join, then I think we should do it and use take instead.\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-31T12:38:16.152+0000",
                    "updated": "2020-12-31T12:38:16.152+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17257050",
                    "id": "17257050",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Thanks [~jorgecarleitao]\u00a0for the context & your opinion\u00a0(y)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-31T16:57:23.520+0000",
                    "updated": "2020-12-31T16:57:23.520+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17257086",
                    "id": "17257086",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "One other thing to note here is that we may not always be able to merge into a single batch due to size restrictions on arrays, so technically we should talk about merging into as few batches as possible, rather than a single batch.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-31T19:37:54.777+0000",
                    "updated": "2020-12-31T19:37:54.777+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17257094",
                    "id": "17257094",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Are you referring to maximum 2 ^ 64 elements in an array (because of the length) or some other restriction in Arrow? The only thing I can find is that for multi language it is recommended to keep it at 2 ^ 31 max, but I assumed we can use the full 64 bits here?\r\n\r\nIf the limit is 2 ^ 64, maybe at this length at this time we could say at this point that a higher limit is not realistic yet for an in memory hash join? I think technically you could make it a Vec<RecordBatch> and group/append indices by the first index to be still using the \"direct index\" approach as mentioned instead and still utilizing take, etc. But if technically not possible, is it necessary?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-12-31T20:04:30.903+0000",
                    "updated": "2020-12-31T20:04:30.903+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17257187",
                    "id": "17257187",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Added a PR here, still with\u00a0MutableArrayData (so some optimization opportunities left) but with batches merged to one batch https://github.com/apache/arrow/pull/9070\r\n Collecting to one batch seems very promising, and removes a large amount of the remaining overhead when using smaller batches.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
                        "name": "Dandandan",
                        "key": "dandandan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Dani\u00ebl Heres",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-01-01T12:49:28.911+0000",
                    "updated": "2021-01-01T13:11:49.386+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17260517",
                    "id": "17260517",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9070\n[https://github.com/apache/arrow/pull/9070]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-01-07T14:02:29.483+0000",
                    "updated": "2021-01-07T14:02:29.483+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13347774/comment/17289510",
                    "id": "17289510",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "Yes, that is what I am referring to, as well as the limit on data length in\nvariable-width arrays.\n\nI am specifically thinking about the 32-bit variants, which will be\nimportant on some hardware platforms even when just using the Rust\nimplementation.\n\n\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2021-02-24T01:51:49.373+0000",
                    "updated": "2021-02-24T01:51:49.373+0000"
                }
            ],
            "maxResults": 20,
            "total": 20,
            "startAt": 0
        },
        "customfield_12311820": "0|z0ltbs:",
        "customfield_12314139": null
    }
}