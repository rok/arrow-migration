{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13445495",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495",
    "key": "ARROW-16599",
    "fields": {
        "parent": {
            "id": "13438319",
            "key": "ARROW-16138",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13438319",
            "fields": {
                "summary": "[C++] Improve performance of ExecuteScalarExpression",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                    "description": "The issue is open and ready for the assignee to start work on it.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                    "name": "Open",
                    "id": "1",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                        "id": 2,
                        "key": "new",
                        "colorName": "blue-gray",
                        "name": "To Do"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                    "id": "4",
                    "description": "An improvement or enhancement to an existing feature or task.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                    "name": "Improvement",
                    "subtask": false,
                    "avatarId": 21140
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351550",
                "id": "12351550",
                "name": "9.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-08-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "1.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zagto",
            "name": "zagto",
            "key": "JIRAUSER286565",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Tobias Zagorni",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zagto",
            "name": "zagto",
            "key": "JIRAUSER286565",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Tobias Zagorni",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zagto",
            "name": "zagto",
            "key": "JIRAUSER286565",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Tobias Zagorni",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16599/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 9,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/771543",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1129261859\n\n   https://issues.apache.org/jira/browse/ARROW-16599\n\n\n",
                    "created": "2022-05-17T19:57:13.754+0000",
                    "updated": "2022-05-17T19:57:13.754+0000",
                    "started": "2022-05-17T19:57:13.753+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771543",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/776661",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on code in PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#discussion_r886316520\n\n\n##########\ncpp/src/arrow/compute/exec/expression_benchmark.cc:\n##########\n@@ -152,20 +176,96 @@ BENCHMARK_CAPTURE(BindAndEvaluate, nested_array,\n BENCHMARK_CAPTURE(BindAndEvaluate, nested_scalar,\n                   field_ref(FieldRef(\"struct_scalar\", \"float\")));\n \n+/// \\brief Baseline benchmark for complex_expression implemented without arrow\n+struct ComplexExpressionBaseline {\n+ public:\n+  ComplexExpressionBaseline(size_t input_size) {\n+    /* hack - cuts off a few elemets if the input size is not a multiple of 64 for\n+     * simplicity. We can't use std::vector<bool> here since it slows down things\n+     * massively */\n+    less_20.resize(input_size / 64);\n+    greater_0.resize(input_size / 64);\n+    output.resize(input_size / 64);\n+  }\n+  void Exec(const std::vector<int64_t>& input) {\n+    size_t input_size = input.size();\n+\n+    for (size_t index = 0; index < input_size / 64; index++) {\n+      size_t value = 0;\n+      for (size_t bit = 0; bit < 64; bit++) {\n+        value |= input[index * 64 + bit] > 0;\n+      }\n\nReview Comment:\n   ```suggestion\r\n           value |= input[index * 64 + bit] > 0;\r\n           value <<= 1;\r\n         }\r\n   ```\r\n   \r\n   I think you need to shift this or else it will just overwrite (and I think the compiler might be simplifying to skip every 63 of every 64 iterations).\n\n\n\n##########\ncpp/src/arrow/compute/exec/expression_benchmark.cc:\n##########\n@@ -152,20 +176,96 @@ BENCHMARK_CAPTURE(BindAndEvaluate, nested_array,\n BENCHMARK_CAPTURE(BindAndEvaluate, nested_scalar,\n                   field_ref(FieldRef(\"struct_scalar\", \"float\")));\n \n+/// \\brief Baseline benchmark for complex_expression implemented without arrow\n+struct ComplexExpressionBaseline {\n+ public:\n+  ComplexExpressionBaseline(size_t input_size) {\n+    /* hack - cuts off a few elemets if the input size is not a multiple of 64 for\n+     * simplicity. We can't use std::vector<bool> here since it slows down things\n+     * massively */\n+    less_20.resize(input_size / 64);\n+    greater_0.resize(input_size / 64);\n+    output.resize(input_size / 64);\n+  }\n+  void Exec(const std::vector<int64_t>& input) {\n+    size_t input_size = input.size();\n+\n+    for (size_t index = 0; index < input_size / 64; index++) {\n+      size_t value = 0;\n+      for (size_t bit = 0; bit < 64; bit++) {\n+        value |= input[index * 64 + bit] > 0;\n+      }\n+      greater_0[index] = value;\n+    }\n+    for (size_t index = 0; index < input_size / 64; index++) {\n+      size_t value = 0;\n+      for (size_t bit = 0; bit < 64; bit++) {\n+        value |= input[index * 64 + bit] < 20;\n+      }\n\nReview Comment:\n   ```suggestion\r\n           value |= input[index * 64 + bit] < 20;\r\n           value <<= 1;\r\n         }\r\n   ```\n\n\n\n",
                    "created": "2022-06-01T04:54:01.933+0000",
                    "updated": "2022-06-01T04:54:01.933+0000",
                    "started": "2022-06-01T04:54:01.933+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776661",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/776662",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1143117625\n\n   It seems like 10k is good enough for cache usage (on my machine at least, this is reflected in the third subplot).  I'm guessing 1k will be too low to really shoot for.  The simple baseline at 1k is unrealistic (fully using L1 cache) for actual use cases (to truly simulate a real use case we'd need to allocate one giant array and then iterate on different offsets into it).\r\n   \r\n   However, based on the 10k test it seems like we are about 50-75% of where we want to be.\n\n\n",
                    "created": "2022-06-01T04:56:45.892+0000",
                    "updated": "2022-06-01T04:56:45.892+0000",
                    "started": "2022-06-01T04:56:45.891+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776662",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/776805",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zagto commented on code in PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#discussion_r886694270\n\n\n##########\ncpp/src/arrow/compute/exec/expression_benchmark.cc:\n##########\n@@ -152,20 +176,96 @@ BENCHMARK_CAPTURE(BindAndEvaluate, nested_array,\n BENCHMARK_CAPTURE(BindAndEvaluate, nested_scalar,\n                   field_ref(FieldRef(\"struct_scalar\", \"float\")));\n \n+/// \\brief Baseline benchmark for complex_expression implemented without arrow\n+struct ComplexExpressionBaseline {\n+ public:\n+  ComplexExpressionBaseline(size_t input_size) {\n+    /* hack - cuts off a few elemets if the input size is not a multiple of 64 for\n+     * simplicity. We can't use std::vector<bool> here since it slows down things\n+     * massively */\n+    less_20.resize(input_size / 64);\n+    greater_0.resize(input_size / 64);\n+    output.resize(input_size / 64);\n+  }\n+  void Exec(const std::vector<int64_t>& input) {\n+    size_t input_size = input.size();\n+\n+    for (size_t index = 0; index < input_size / 64; index++) {\n+      size_t value = 0;\n+      for (size_t bit = 0; bit < 64; bit++) {\n+        value |= input[index * 64 + bit] > 0;\n+      }\n\nReview Comment:\n   you're right\n\n\n\n",
                    "created": "2022-06-01T11:27:59.504+0000",
                    "updated": "2022-06-01T11:27:59.504+0000",
                    "started": "2022-06-01T11:27:59.504+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776805",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/776809",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zagto commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1143492183\n\n   > for actual use cases (to truly simulate a real use case we'd need to allocate one giant array and then iterate on different offsets into it).\r\n   makes sense. I remember playing with that, and the problem is the existing ExecuteScalarExpressionOverhead benchmarks also allocate a small array they use multiple times. So they would have an adventage over the baseline. Maybe we should change them too.\n\n\n",
                    "created": "2022-06-01T11:37:58.016+0000",
                    "updated": "2022-06-01T11:37:58.016+0000",
                    "started": "2022-06-01T11:37:58.016+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776809",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/777171",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1144154293\n\n   Changing both would be more realistic if it isn't too much trouble.  I wouldn't expect it to show too much new information but I've long since learned to assume I know anything when it comes to this kind of performance :laughing: \n\n\n",
                    "created": "2022-06-01T21:26:27.852+0000",
                    "updated": "2022-06-01T21:26:27.852+0000",
                    "started": "2022-06-01T21:26:27.851+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "777171",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/779246",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zagto commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1149122524\n\n   > Changing both would be more realistic if it isn't too much trouble. I wouldn't expect it to show too much new information but I've long since learned to assume I know anything when it comes to this kind of performance laughing\r\n   \r\n   I now changed them both now.\r\n   I noticed another interesting effect here. Intuitively, it would make sense to also use separate output/intermediate buffers for each batch, since especially simple_expression benefits a lot from just writing to the same buffer each time. Turns out arrow already benefits from the same effect, probably due to the allocator giving it back the same memory each time. Without this effect, simple_expression does not benefit from small batch sizes at all:\r\n   ```\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:1000/real_time/threads:1          401312 ns       400307 ns         1735 batches_per_second=2.49183M/s rows_per_second=2.49183G/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:1000/real_time/threads:16        1065807 ns     16879539 ns          656 batches_per_second=938.256k/s rows_per_second=938.256M/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:10000/real_time/threads:1         397138 ns       396141 ns         1752 batches_per_second=251.802k/s rows_per_second=2.51802G/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:10000/real_time/threads:16       1056364 ns     16569094 ns          640 batches_per_second=94.6644k/s rows_per_second=946.644M/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:100000/real_time/threads:1        380833 ns       380450 ns         1832 batches_per_second=26.2583k/s rows_per_second=2.62583G/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:100000/real_time/threads:16      1061477 ns     16735682 ns          640 batches_per_second=9.42083k/s rows_per_second=942.083M/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:1000000/real_time/threads:1       369300 ns       368976 ns         1882 batches_per_second=2.70783k/s rows_per_second=2.70783G/s\r\n   ExecuteScalarExpressionBaseline<SimpleExpressionBaseline>/rows_per_batch:1000000/real_time/threads:16     1075881 ns     16966905 ns          624 batches_per_second=929.47/s rows_per_second=929.47M/s\r\n   ```\n\n\n",
                    "created": "2022-06-07T20:16:43.220+0000",
                    "updated": "2022-06-07T20:16:43.220+0000",
                    "started": "2022-06-07T20:16:43.220+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "779246",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/788095",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on PR #13179:\nURL: https://github.com/apache/arrow/pull/13179#issuecomment-1175648192\n\n   >  I noticed another interesting effect here. Intuitively, it would make sense to also use separate output/intermediate buffers for each batch, since especially simple_expression benefits a lot from just writing to the same buffer each time. Turns out arrow already benefits from the same effect, probably due to the allocator giving it back the same memory each time. Without this effect, simple_expression does not benefit from small batch sizes at all:\r\n   \r\n   I think we can someday get to a place where these output buffers are thread local temporaries and are not re-allocated each time so let's keep it how it is.\n\n\n",
                    "created": "2022-07-06T00:56:40.597+0000",
                    "updated": "2022-07-06T00:56:40.597+0000",
                    "started": "2022-07-06T00:56:40.596+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "788095",
                    "issueId": "13445495"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/worklog/788097",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace merged PR #13179:\nURL: https://github.com/apache/arrow/pull/13179\n\n\n",
                    "created": "2022-07-06T01:01:22.595+0000",
                    "updated": "2022-07-06T01:01:22.595+0000",
                    "started": "2022-07-06T01:01:22.594+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "788097",
                    "issueId": "13445495"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 5400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5d862708[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6ea91c81[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5a4df9c2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7ca6ab1e[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@163a11c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@595969ab[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6cef18ab[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@25d8a073[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@63aa213d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@71ac18d2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@65126c0c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@52983e5[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 5400,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Jul 06 01:01:29 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-07-06T01:01:29.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16599/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2022-05-17T19:18:47.000+0000",
        "updated": "2022-07-06T01:01:29.000+0000",
        "timeoriginalestimate": null,
        "description": "The ExecuteScalarExpressionOverhead group of benchmarks for now gives us values we can compare to different batch sizes, or to different expressions. But we don't really see how well arrow does compared to what is possible in general.\r\n\r\nThe simple_expression and (negate x) complex_expression (x>0 and x<20) benchmarks, which perform an actual operation on data, can be implemented in pure C++ for comparison.\r\n\r\nI implemented complex_expression benchmark using technically unnecessary intermediate buffers for the > and < operator results, to match what happens in the arrow expression.\r\n\r\nWhat may seem unfair is that I currently re-use the input/output/intermediate buffers over all iterations. I also tried using new and delete each time, but could not measure a difference in performance. Reusing allowes to use std::vector for sightly cleaner code. Re-creating a vector each time would results in a lot of overhead initializing the vector values and is therefore not useful.\r\n\r\nExample output: [^example-output-baseline.txt]",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 5400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/13043810",
                "id": "13043810",
                "filename": "example-output-baseline.txt",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=zagto",
                    "name": "zagto",
                    "key": "JIRAUSER286565",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                    },
                    "displayName": "Tobias Zagorni",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2022-05-17T19:21:26.584+0000",
                "size": 6987,
                "mimeType": "text/plain",
                "content": "https://issues.apache.org/jira/secure/attachment/13043810/example-output-baseline.txt"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Implementation of ExecuteScalarExpressionOverhead benchmarks without arrow for comparision",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13445495/comment/17562912",
                    "id": "17562912",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 13179\n[https://github.com/apache/arrow/pull/13179]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-07-06T01:01:29.788+0000",
                    "updated": "2022-07-06T01:01:29.788+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z12gds:",
        "customfield_12314139": null
    }
}