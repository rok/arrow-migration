{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13385814",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814",
    "key": "ARROW-13174",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available",
            "timestamp"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12618147",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12618147",
                "type": {
                    "id": "12310460",
                    "name": "Child-Issue",
                    "inward": "is a child of",
                    "outward": "is a parent of",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310460"
                },
                "inwardIssue": {
                    "id": "13306872",
                    "key": "ARROW-8894",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306872",
                    "fields": {
                        "summary": "[C++] C++ array kernels framework and execution buildout (umbrella issue)",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12618792",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12618792",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "inwardIssue": {
                    "id": "13354482",
                    "key": "ARROW-11378",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13354482",
                    "fields": {
                        "summary": "[C++][Dataset] Writing partitions with timestamp type give mis-formatted (integers) directory names",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12621369",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12621369",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "inwardIssue": {
                    "id": "13395938",
                    "key": "ARROW-13666",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13395938",
                    "fields": {
                        "summary": "[R] strftime bindings",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
            "name": "rokm",
            "key": "rokm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Rok Mihevc",
            "active": true,
            "timeZone": "Europe/Amsterdam"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
            "name": "rokm",
            "key": "rokm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Rok Mihevc",
            "active": true,
            "timeZone": "Europe/Amsterdam"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
            "name": "rokm",
            "key": "rokm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Rok Mihevc",
            "active": true,
            "timeZone": "Europe/Amsterdam"
        },
        "aggregateprogress": {
            "progress": 49200,
            "total": 49200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 49200,
            "total": 49200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13174/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 82,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/617932",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok opened a new pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647\n\n\n   This is to resolve [ARROW-13174](https://issues.apache.org/jira/browse/ARROW-13174).\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-02T00:52:31.145+0000",
                    "updated": "2021-07-02T00:52:31.145+0000",
                    "started": "2021-07-02T00:52:31.145+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617932",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/617933",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-872637340\n\n\n   https://issues.apache.org/jira/browse/ARROW-13174\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-02T00:52:54.887+0000",
                    "updated": "2021-07-02T00:52:54.887+0000",
                    "started": "2021-07-02T00:52:54.887+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "617933",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621202",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-877493031\n\n\n   @westonpace [strftime kernel](https://github.com/apache/arrow/pull/10647/files#diff-53850537a2f3f7977473b30241fdd3ddb35aa97269284c06471d9b0c599e2c59R347) is almost ready for review.\r\n   I do need to take care of the string encoding.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-09T22:41:01.273+0000",
                    "updated": "2021-07-09T22:41:01.273+0000",
                    "started": "2021-07-09T22:41:01.273+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621202",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621783",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668370637\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -602,6 +685,15 @@ const FunctionDoc subsecond_doc{\n      \"Returns an error if timestamp has a defined timezone. Null values return null.\"),\n     {\"values\"}};\n \n+const FunctionDoc strftime_doc{\n+    \"Convert timestamps to a string representation with an arbitrary format\",\n+    (\"Strftime returns a string representation with an arbitrary format.\\n\"\n+     \"Returns an error if timestamp has a defined timezone.\\n\"\n\nReview comment:\n       What does this mean?  I don't see code anywhere that errors if the timestamp has a timezone but I might just not be seeing it.\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.cc\n##########\n@@ -240,6 +243,15 @@ StrptimeOptions::StrptimeOptions(std::string format, TimeUnit::type unit)\n StrptimeOptions::StrptimeOptions() : StrptimeOptions(\"\", TimeUnit::SECOND) {}\n constexpr char StrptimeOptions::kTypeName[];\n \n+StrftimeOptions::StrftimeOptions(std::string format, std::string timezone)\n+    : FunctionOptions(internal::kStrftimeOptionsType),\n+      format(std::move(format)),\n+      timezone(std::move(timezone)) {\n+  tz = arrow_vendored::date::locate_zone(this->timezone);\n+}\n+StrftimeOptions::StrftimeOptions() : StrftimeOptions(\"%Y-%m-%dT%H:%M:%S\", \"UTC\") {}\n\nReview comment:\n       Should the default format string include the trailing `%z` so that it is ISO-8601 compliant?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -321,6 +322,53 @@ struct Nanosecond {\n   }\n };\n \n+// ----------------------------------------------------------------------\n+// Convert timestamps to a string representation with an arbitrary format\n+\n+template <typename Duration>\n+inline std::string get_timestamp(int64_t arg, const StrftimeOptions* options) {\n+  auto zt = arrow_vendored::date::zoned_time<Duration>{options->tz,\n+                                                       sys_time<Duration>(Duration{arg})};\n+  return arrow_vendored::date::format(options->format, zt.get_local_time());\n+}\n+\n+template <typename Duration>\n+struct Strftime {\n+  static Status Call(KernelContext* ctx, const Scalar& in, Scalar* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    if (in.is_valid) {\n+      const auto& in_val = internal::UnboxScalar<const TimestampType>::Unbox(in);\n+      *checked_cast<StringScalar*>(out) =\n+          StringScalar(get_timestamp<Duration>(in_val, &options));\n+    } else {\n+      out->is_valid = false;\n+    }\n+    return Status::OK();\n+  }\n+\n+  static Status Call(KernelContext* ctx, const ArrayData& in, ArrayData* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    std::unique_ptr<ArrayBuilder> array_builder;\n+    RETURN_NOT_OK(MakeBuilder(ctx->memory_pool(), utf8(), &array_builder));\n+    StringBuilder* string_builder = checked_cast<StringBuilder*>(array_builder.get());\n+    RETURN_NOT_OK(string_builder->Reserve(in.length * 30));\n\nReview comment:\n       Nit: How precise is this 30?  Is it based on the default format string?  If I look at 2021-07-12T23:55:41+00:00 I would think you only need ~25, maybe more if subsecond resolution.  Could we base this on the resolution?  It's not a big deal so if it seems like too much don't worry.\n\n##########\nFile path: python/pyarrow/tests/test_compute.py\n##########\n@@ -1347,6 +1351,32 @@ def test_strptime():\n     assert got == expected\n \n \n+# TODO: We should test on windows once ARROW-13168 is resolved.\n+@pytest.mark.pandas\n+@pytest.mark.skipif(sys.platform == 'win32',\n+                    reason=\"Timezone database is not available on Windows yet\")\n+def test_strftime():\n\nReview comment:\n       Can you add some examples with `%z`/`%Z` on both naive/local timestamps and UTC timestamps.  It looks like python emits an empty string for `%z`/`%Z` if the timestamp is naive but I don't know what the vendored tz lib will do.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T01:58:31.968+0000",
                    "updated": "2021-07-13T01:58:31.968+0000",
                    "started": "2021-07-13T01:58:31.968+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621783",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621884",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668588512\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -602,6 +685,15 @@ const FunctionDoc subsecond_doc{\n      \"Returns an error if timestamp has a defined timezone. Null values return null.\"),\n     {\"values\"}};\n \n+const FunctionDoc strftime_doc{\n+    \"Convert timestamps to a string representation with an arbitrary format\",\n+    (\"Strftime returns a string representation with an arbitrary format.\\n\"\n+     \"Returns an error if timestamp has a defined timezone.\\n\"\n\nReview comment:\n       Oh, sorry forgot to delete that.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:25:57.695+0000",
                    "updated": "2021-07-13T09:25:57.695+0000",
                    "started": "2021-07-13T09:25:57.694+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621884",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621886",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668589540\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -321,6 +322,53 @@ struct Nanosecond {\n   }\n };\n \n+// ----------------------------------------------------------------------\n+// Convert timestamps to a string representation with an arbitrary format\n+\n+template <typename Duration>\n+inline std::string get_timestamp(int64_t arg, const StrftimeOptions* options) {\n+  auto zt = arrow_vendored::date::zoned_time<Duration>{options->tz,\n+                                                       sys_time<Duration>(Duration{arg})};\n+  return arrow_vendored::date::format(options->format, zt.get_local_time());\n+}\n+\n+template <typename Duration>\n+struct Strftime {\n+  static Status Call(KernelContext* ctx, const Scalar& in, Scalar* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    if (in.is_valid) {\n+      const auto& in_val = internal::UnboxScalar<const TimestampType>::Unbox(in);\n+      *checked_cast<StringScalar*>(out) =\n+          StringScalar(get_timestamp<Duration>(in_val, &options));\n+    } else {\n+      out->is_valid = false;\n+    }\n+    return Status::OK();\n+  }\n+\n+  static Status Call(KernelContext* ctx, const ArrayData& in, ArrayData* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    std::unique_ptr<ArrayBuilder> array_builder;\n+    RETURN_NOT_OK(MakeBuilder(ctx->memory_pool(), utf8(), &array_builder));\n+    StringBuilder* string_builder = checked_cast<StringBuilder*>(array_builder.get());\n+    RETURN_NOT_OK(string_builder->Reserve(in.length * 30));\n\nReview comment:\n       How about a random string size times a fudge factor? :)\r\n   ```\r\n   int expected_string_size = round(get_timestamp<Duration>(0, &options).size() * 1.2);\r\n   RETURN_NOT_OK(string_builder->Reserve(in.length * expected_string_size));\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:27:13.267+0000",
                    "updated": "2021-07-13T09:27:13.267+0000",
                    "started": "2021-07-13T09:27:13.267+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621886",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621887",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668589894\n\n\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.cc\n##########\n@@ -240,6 +243,15 @@ StrptimeOptions::StrptimeOptions(std::string format, TimeUnit::type unit)\n StrptimeOptions::StrptimeOptions() : StrptimeOptions(\"\", TimeUnit::SECOND) {}\n constexpr char StrptimeOptions::kTypeName[];\n \n+StrftimeOptions::StrftimeOptions(std::string format, std::string timezone)\n+    : FunctionOptions(internal::kStrftimeOptionsType),\n+      format(std::move(format)),\n+      timezone(std::move(timezone)) {\n+  tz = arrow_vendored::date::locate_zone(this->timezone);\n+}\n+StrftimeOptions::StrftimeOptions() : StrftimeOptions(\"%Y-%m-%dT%H:%M:%S\", \"UTC\") {}\n\nReview comment:\n       Indeed. Will add.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:27:39.821+0000",
                    "updated": "2021-07-13T09:27:39.821+0000",
                    "started": "2021-07-13T09:27:39.821+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621887",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621888",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668593700\n\n\n\n##########\nFile path: python/pyarrow/tests/test_compute.py\n##########\n@@ -1347,6 +1351,32 @@ def test_strptime():\n     assert got == expected\n \n \n+# TODO: We should test on windows once ARROW-13168 is resolved.\n+@pytest.mark.pandas\n+@pytest.mark.skipif(sys.platform == 'win32',\n+                    reason=\"Timezone database is not available on Windows yet\")\n+def test_strftime():\n\nReview comment:\n       date.h will fail on naive timestamp:\r\n   > ***%z*** | The offset from UTC in the ISO 8601 format. For example\u00a0-0430\u00a0refers to 4 hours 30 minutes behind UTC. If the offset is zero,\u00a0+0000\u00a0is used. The modified commands\u00a0%Ez\u00a0and\u00a0%Oz\u00a0insert a\u00a0:\u00a0between the hours and minutes:\u00a0-04:30. If the offset information is not available,\u00a0failbit\u00a0will be set.\r\n   \r\n   I'll see if I can make it pandas-like.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:32:29.146+0000",
                    "updated": "2021-07-13T09:32:29.146+0000",
                    "started": "2021-07-13T09:32:29.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621888",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621903",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668589540\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -321,6 +322,53 @@ struct Nanosecond {\n   }\n };\n \n+// ----------------------------------------------------------------------\n+// Convert timestamps to a string representation with an arbitrary format\n+\n+template <typename Duration>\n+inline std::string get_timestamp(int64_t arg, const StrftimeOptions* options) {\n+  auto zt = arrow_vendored::date::zoned_time<Duration>{options->tz,\n+                                                       sys_time<Duration>(Duration{arg})};\n+  return arrow_vendored::date::format(options->format, zt.get_local_time());\n+}\n+\n+template <typename Duration>\n+struct Strftime {\n+  static Status Call(KernelContext* ctx, const Scalar& in, Scalar* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    if (in.is_valid) {\n+      const auto& in_val = internal::UnboxScalar<const TimestampType>::Unbox(in);\n+      *checked_cast<StringScalar*>(out) =\n+          StringScalar(get_timestamp<Duration>(in_val, &options));\n+    } else {\n+      out->is_valid = false;\n+    }\n+    return Status::OK();\n+  }\n+\n+  static Status Call(KernelContext* ctx, const ArrayData& in, ArrayData* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    std::unique_ptr<ArrayBuilder> array_builder;\n+    RETURN_NOT_OK(MakeBuilder(ctx->memory_pool(), utf8(), &array_builder));\n+    StringBuilder* string_builder = checked_cast<StringBuilder*>(array_builder.get());\n+    RETURN_NOT_OK(string_builder->Reserve(in.length * 30));\n\nReview comment:\n       How about a random string size times a fudge factor? :)\r\n   ```\r\n   int expected_string_size = round(get_timestamp<Duration>(0, &options).size() * 1.1);\r\n   RETURN_NOT_OK(string_builder->Reserve(in.length * expected_string_size));\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:54:01.975+0000",
                    "updated": "2021-07-13T09:54:01.975+0000",
                    "started": "2021-07-13T09:54:01.975+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621903",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/621904",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668589540\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -321,6 +322,53 @@ struct Nanosecond {\n   }\n };\n \n+// ----------------------------------------------------------------------\n+// Convert timestamps to a string representation with an arbitrary format\n+\n+template <typename Duration>\n+inline std::string get_timestamp(int64_t arg, const StrftimeOptions* options) {\n+  auto zt = arrow_vendored::date::zoned_time<Duration>{options->tz,\n+                                                       sys_time<Duration>(Duration{arg})};\n+  return arrow_vendored::date::format(options->format, zt.get_local_time());\n+}\n+\n+template <typename Duration>\n+struct Strftime {\n+  static Status Call(KernelContext* ctx, const Scalar& in, Scalar* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    if (in.is_valid) {\n+      const auto& in_val = internal::UnboxScalar<const TimestampType>::Unbox(in);\n+      *checked_cast<StringScalar*>(out) =\n+          StringScalar(get_timestamp<Duration>(in_val, &options));\n+    } else {\n+      out->is_valid = false;\n+    }\n+    return Status::OK();\n+  }\n+\n+  static Status Call(KernelContext* ctx, const ArrayData& in, ArrayData* out) {\n+    const StrftimeOptions options = StrftimeState::Get(ctx);\n+\n+    std::unique_ptr<ArrayBuilder> array_builder;\n+    RETURN_NOT_OK(MakeBuilder(ctx->memory_pool(), utf8(), &array_builder));\n+    StringBuilder* string_builder = checked_cast<StringBuilder*>(array_builder.get());\n+    RETURN_NOT_OK(string_builder->Reserve(in.length * 30));\n\nReview comment:\n       How about a random date's string size times a fudge factor? :)\r\n   ```\r\n   int expected_string_size = round(get_timestamp<Duration>(0, &options).size() * 1.1);\r\n   RETURN_NOT_OK(string_builder->Reserve(in.length * expected_string_size));\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T09:54:15.416+0000",
                    "updated": "2021-07-13T09:54:15.416+0000",
                    "started": "2021-07-13T09:54:15.416+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "621904",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622022",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r668820043\n\n\n\n##########\nFile path: python/pyarrow/tests/test_compute.py\n##########\n@@ -1347,6 +1351,32 @@ def test_strptime():\n     assert got == expected\n \n \n+# TODO: We should test on windows once ARROW-13168 is resolved.\n+@pytest.mark.pandas\n+@pytest.mark.skipif(sys.platform == 'win32',\n+                    reason=\"Timezone database is not available on Windows yet\")\n+def test_strftime():\n\nReview comment:\n       Done.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T14:29:20.360+0000",
                    "updated": "2021-07-13T14:29:20.360+0000",
                    "started": "2021-07-13T14:29:20.360+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622022",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622031",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-879143370\n\n\n   Thanks for the review @westonpace!\r\n   I've gone through it and pushed appropriate changes.\r\n   \r\n   One thing I'm not sure about is if we should be using `date.h` for formatting here or would it be better to use system / c++ equivalents.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T14:35:26.230+0000",
                    "updated": "2021-07-13T14:35:26.230+0000",
                    "started": "2021-07-13T14:35:26.229+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622031",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622232",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r669098242\n\n\n\n##########\nFile path: r/configure.win\n##########\n@@ -44,7 +44,7 @@ else\n   RWINLIB=\"../windows/$(ls windows/ | grep ^arrow- | tail -n 1)\"\n fi\n OPENSSL_LIBS=\"-lcrypto -lcrypt32\"\n-MIMALLOC_LIBS=\"-lbcrypt -lpsapi\"\n+MIMALLOC_LIBS=\"-lbcrypt -lpsapi -lole32\"\n\nReview comment:\n       Is this related?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T20:55:15.366+0000",
                    "updated": "2021-07-13T20:55:15.366+0000",
                    "started": "2021-07-13T20:55:15.366+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622232",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622238",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r669107412\n\n\n\n##########\nFile path: r/configure.win\n##########\n@@ -44,7 +44,7 @@ else\n   RWINLIB=\"../windows/$(ls windows/ | grep ^arrow- | tail -n 1)\"\n fi\n OPENSSL_LIBS=\"-lcrypto -lcrypt32\"\n-MIMALLOC_LIBS=\"-lbcrypt -lpsapi\"\n+MIMALLOC_LIBS=\"-lbcrypt -lpsapi -lole32\"\n\nReview comment:\n       Yeah, without it RTools40 fails on mingw32 build:\r\n   ```\r\n   C:/rtools40/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe: ../windows/arrow-4.0.1.9000/lib/i386/libarrow.a(tz.cpp.obj):(.text+0x725): undefined reference to `_imp__CoTaskMemFree@4'\r\n   C:/rtools40/mingw32/bin/../lib/gcc/i686-w64-mingw32/8.3.0/../../../../i686-w64-mingw32/bin/ld.exe: ../windows/arrow-4.0.1.9000/lib/i386/libarrow.a(tz.cpp.obj):(.text.unlikely+0x3e): undefined reference to `_imp__CoTaskMemFree@4'\r\n   ```\r\n    [Fix source here](https://github.com/HowardHinnant/date/issues/272). I don't really know what it really does. I'm also not sure if this is the place to put it. :)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T21:01:26.055+0000",
                    "updated": "2021-07-13T21:01:26.055+0000",
                    "started": "2021-07-13T21:01:26.055+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622238",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622240",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-879403748\n\n\n   > Thanks for the changes. This looks good. I'm afraid I don't know the differences between `date.h` and the system equivalents. By system equivalents do you mean `ctime`? In that case does strftime support time zones?\r\n   \r\n   I meant like [cpp](https://en.cppreference.com/w/cpp/chrono/c/strftime) or [linux](https://man7.org/linux/man-pages/man3/strftime.3.html) strftimes. It seems they support timezones but one still needs to go from UTC to local time etc.\r\n   \r\n   > Since we already have the vendored lib in I suppose it comes down to readability, simplicity, and performance. What you have here seems plenty readable and simple. We can always benchmark the two approaches later.\r\n   \r\n   Fully agreed. Without benchmarking alternatives it's a moot discussion anyway. I just wanted to check if I missed something obvious.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-13T21:07:28.074+0000",
                    "updated": "2021-07-13T21:07:28.074+0000",
                    "started": "2021-07-13T21:07:28.073+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622240",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/622987",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-880628622\n\n\n   @jorisvandenbossche Could you take a look if this PR makes sense?\r\n   \r\n   @thisisnic this should unblock [ARROW-13133](https://issues.apache.org/jira/browse/ARROW-13133). Does the [R wrapper look ok](https://github.com/apache/arrow/pull/10647/files#diff-a138b87f0da58d824c72293eab62d9f352718dcb7f41a47ea7e1c3c84bbe27dd)? Note that `StrftimeOptions()` returns by default `StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"UTC\")`.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-15T11:46:53.215+0000",
                    "updated": "2021-07-15T11:46:53.215+0000",
                    "started": "2021-07-15T11:46:53.215+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "622987",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/623002",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r670405431\n\n\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.cc\n##########\n@@ -240,6 +243,15 @@ StrptimeOptions::StrptimeOptions(std::string format, TimeUnit::type unit)\n StrptimeOptions::StrptimeOptions() : StrptimeOptions(\"\", TimeUnit::SECOND) {}\n constexpr char StrptimeOptions::kTypeName[];\n \n+StrftimeOptions::StrftimeOptions(std::string format, std::string timezone)\n+    : FunctionOptions(internal::kStrftimeOptionsType),\n+      format(std::move(format)),\n+      timezone(std::move(timezone)) {\n+  tz = arrow_vendored::date::locate_zone(this->timezone);\n+}\n+StrftimeOptions::StrftimeOptions() : StrftimeOptions(\"%Y-%m-%dT%H:%M:%S\", \"UTC\") {}\n\nReview comment:\n       I don't think that `%z` adds a trailing z as in the ISO format. It adds a numeric offset (eg https://www.cplusplus.com/reference/ctime/strftime/):\r\n   \r\n   ```\r\n   In [44]: datetime.datetime(2012, 1, 1, tzinfo=datetime.timezone.utc).strftime(\"%Y-%m-%dT%H:%M:%S%z\")\r\n   Out[44]: '2012-01-01T00:00:00+0000'\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-15T12:15:14.303+0000",
                    "updated": "2021-07-15T12:15:14.303+0000",
                    "started": "2021-07-15T12:15:14.303+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623002",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/623009",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r670410454\n\n\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.cc\n##########\n@@ -240,6 +243,15 @@ StrptimeOptions::StrptimeOptions(std::string format, TimeUnit::type unit)\n StrptimeOptions::StrptimeOptions() : StrptimeOptions(\"\", TimeUnit::SECOND) {}\n constexpr char StrptimeOptions::kTypeName[];\n \n+StrftimeOptions::StrftimeOptions(std::string format, std::string timezone)\n+    : FunctionOptions(internal::kStrftimeOptionsType),\n+      format(std::move(format)),\n+      timezone(std::move(timezone)) {\n+  tz = arrow_vendored::date::locate_zone(this->timezone);\n+}\n+StrftimeOptions::StrftimeOptions() : StrftimeOptions(\"%Y-%m-%dT%H:%M:%S\", \"UTC\") {}\n\nReview comment:\n       According to [wikipedia](https://en.wikipedia.org/wiki/ISO_8601) these are valid formats: \r\n   1. 2021-07-15T11:24:54+00:00\r\n   1. 2021-07-15T11:24:54Z\r\n   1. 20210715T112454Z\r\n   \r\n   `%z` will give us option 1. I don't have a strong preference and pandas doesn't seem to have a default.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-15T12:22:12.304+0000",
                    "updated": "2021-07-15T12:22:12.304+0000",
                    "started": "2021-07-15T12:22:12.304+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623009",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/623011",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#issuecomment-880650445\n\n\n   > @thisisnic this should unblock [ARROW-13133](https://issues.apache.org/jira/browse/ARROW-13133). Does the [R wrapper look ok](https://github.com/apache/arrow/pull/10647/files#diff-a138b87f0da58d824c72293eab62d9f352718dcb7f41a47ea7e1c3c84bbe27dd)? Note that `StrftimeOptions()` returns by default `StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"UTC\")`.\r\n   \r\n   LGTM.\r\n   \r\n   Naive question: how does strftime return the correct local-specific time when using the format that outputs days of week? I see that in the base R implementation of strftime, it's not a parameter that's passed in; is this something that here is detected by the vendored date libraries that we're using?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-15T12:23:13.817+0000",
                    "updated": "2021-07-15T12:23:13.817+0000",
                    "started": "2021-07-15T12:23:13.817+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623011",
                    "issueId": "13385814"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/worklog/623017",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10647:\nURL: https://github.com/apache/arrow/pull/10647#discussion_r670406295\n\n\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.cc\n##########\n@@ -240,6 +243,15 @@ StrptimeOptions::StrptimeOptions(std::string format, TimeUnit::type unit)\n StrptimeOptions::StrptimeOptions() : StrptimeOptions(\"\", TimeUnit::SECOND) {}\n constexpr char StrptimeOptions::kTypeName[];\n \n+StrftimeOptions::StrftimeOptions(std::string format, std::string timezone)\n+    : FunctionOptions(internal::kStrftimeOptionsType),\n+      format(std::move(format)),\n+      timezone(std::move(timezone)) {\n+  tz = arrow_vendored::date::locate_zone(this->timezone);\n+}\n+StrftimeOptions::StrftimeOptions() : StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"UTC\") {}\n\nReview comment:\n       The default is set to UTC, but for timestamp with timezone input, can we default to using the type's timezone?\r\n   \r\n   Also for timestamp without timezone, it should probably not use `%z` by default?\r\n   \r\n   And see my other comment, I suppose the default should rather be a literal `Z` instead of `%z` (or `%Z`) ?\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.h\n##########\n@@ -178,6 +179,20 @@ class ARROW_EXPORT StrptimeOptions : public FunctionOptions {\n   TimeUnit::type unit;\n };\n \n+class ARROW_EXPORT StrftimeOptions : public FunctionOptions {\n+ public:\n+  explicit StrftimeOptions(std::string format, std::string timezone);\n+  StrftimeOptions();\n+  constexpr static char const kTypeName[] = \"StrftimeOptions\";\n+\n+  /// The desired format string.\n+  std::string format;\n+  /// Timezone to output the time in.\n+  std::string timezone;\n\nReview comment:\n       How does this keyword behave if the type already has a timezone (then a simple conversion I assume) or if the type has no time zone?\r\n   \r\n   (alternative could be to leave out this option and require users first to explicitly convert from one timezone to another (which is a cheap metadata only change) or localize timezone-naive data)\n\n##########\nFile path: cpp/src/arrow/compute/api_scalar.h\n##########\n@@ -178,6 +179,20 @@ class ARROW_EXPORT StrptimeOptions : public FunctionOptions {\n   TimeUnit::type unit;\n };\n \n+class ARROW_EXPORT StrftimeOptions : public FunctionOptions {\n+ public:\n+  explicit StrftimeOptions(std::string format, std::string timezone);\n+  StrftimeOptions();\n+  constexpr static char const kTypeName[] = \"StrftimeOptions\";\n+\n+  /// The desired format string.\n+  std::string format;\n+  /// Timezone to output the time in.\n+  std::string timezone;\n\nReview comment:\n       Although for local timestamp without timezone, requiring the user to first localize it to a timezone-aware type might give additional overhead, as `strftime` would then convert it back to a local timestamp?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_test.cc\n##########\n@@ -216,5 +216,40 @@ TEST_F(ScalarTemporalTest, DayOfWeek) {\n                 DayOfWeek(timestamps, DayOfWeekOptions(/*one_based_numbering=*/false,\n                                                        /*week_start=*/8)));\n }\n+\n+#ifndef _WIN32\n+TEST_F(ScalarTemporalTest, Strftime) {\n+  auto options_seconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"UTC\");\n+  auto options_milliseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"GMT\");\n+  auto options_microseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"Asia/Kolkata\");\n+  auto options_nanoseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"US/Hawaii\");\n+\n+  const char* times_seconds = R\"([\"1970-01-01T00:00:59\", null])\";\n+  const char* times_milliseconds = R\"([\"1970-01-01T00:00:59.123\", null])\";\n+  const char* times_microseconds = R\"([\"1970-01-01T00:00:59.123456\", null])\";\n+  const char* times_nanoseconds = R\"([\"1970-01-01T00:00:59.123456789\", null])\";\n+\n+  const char* zoned_seconds = R\"([\"1970-01-01T00:00:59+0000\", null])\";\n+  const char* zoned_milliseconds = R\"([\"1970-01-01T00:00:59.123+0000\", null])\";\n\nReview comment:\n       With a default format of `%S`, I don't expect sub-second values to be shown (since there is a `%f` for this) ?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal.cc\n##########\n@@ -321,6 +322,82 @@ struct Nanosecond {\n   }\n };\n \n+// ----------------------------------------------------------------------\n+// Convert timestamps to a string representation with an arbitrary format\n+\n+template <typename Duration>\n+inline std::string get_timestamp(int64_t arg, const StrftimeOptions* options) {\n+  auto zt = arrow_vendored::date::zoned_time<Duration>{options->tz,\n+                                                       sys_time<Duration>(Duration{arg})};\n+  return arrow_vendored::date::format(options->format, zt);\n+}\n+\n+// If source timestamp is timezone naive we do not print timezone info\n+inline StrftimeOptions get_options(KernelContext* ctx, const bool timezone_known) {\n+  const StrftimeOptions options = StrftimeState::Get(ctx);\n+  if (timezone_known) {\n+    return options;\n+  }\n+\n+  std::string new_format = std::move(options.format);\n+  for (std::string str : {\"%z\", \"%Z\"}) {\n+    size_t pos = std::string::npos;\n+    while ((pos = new_format.find(str)) != std::string::npos) {\n+      new_format.erase(pos, str.length());\n+    }\n+  }\n+  return StrftimeOptions(new_format, options.timezone);\n+}\n+\n+template <typename Duration>\n+struct Strftime {\n+  static Status Call(KernelContext* ctx, const Scalar& in, Scalar* out) {\n+    const auto& timezone = GetInputTimezone(in);\n+    const StrftimeOptions options = get_options(ctx, !timezone.empty());\n+    if (timezone.empty() && options.timezone != \"UTC\") {\n+      return Status::Invalid(\"Timezone naive timestamp can only be printed in UTC. Got: \",\n\nReview comment:\n       Why allow UTC here (and not other timezones, or disallow any timezone including UTC) ?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_test.cc\n##########\n@@ -216,5 +216,40 @@ TEST_F(ScalarTemporalTest, DayOfWeek) {\n                 DayOfWeek(timestamps, DayOfWeekOptions(/*one_based_numbering=*/false,\n                                                        /*week_start=*/8)));\n }\n+\n+#ifndef _WIN32\n+TEST_F(ScalarTemporalTest, Strftime) {\n+  auto options_seconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"UTC\");\n+  auto options_milliseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"GMT\");\n+  auto options_microseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"Asia/Kolkata\");\n+  auto options_nanoseconds = StrftimeOptions(\"%Y-%m-%dT%H:%M:%S%z\", \"US/Hawaii\");\n+\n+  const char* times_seconds = R\"([\"1970-01-01T00:00:59\", null])\";\n+  const char* times_milliseconds = R\"([\"1970-01-01T00:00:59.123\", null])\";\n+  const char* times_microseconds = R\"([\"1970-01-01T00:00:59.123456\", null])\";\n+  const char* times_nanoseconds = R\"([\"1970-01-01T00:00:59.123456789\", null])\";\n+\n+  const char* zoned_seconds = R\"([\"1970-01-01T00:00:59+0000\", null])\";\n+  const char* zoned_milliseconds = R\"([\"1970-01-01T00:00:59.123+0000\", null])\";\n\nReview comment:\n       I see you commented about this in the python/pandas tests below as well. \r\n   Is this the default behaviour of `date.h` (which seems a strange deviation from the standard?)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-15T12:29:14.112+0000",
                    "updated": "2021-07-15T12:29:14.112+0000",
                    "started": "2021-07-15T12:29:14.112+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623017",
                    "issueId": "13385814"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 49200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@71633e42[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@fa9a949[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21f80ac[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@40be8247[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21276046[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7a0ec42c[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ea3121[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@30f23741[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2acd4449[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@26eeca98[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7358945d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@52b1fd48[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 49200,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Aug 18 16:04:55 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-08-18T16:04:55.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13174/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2021-06-25T10:02:20.000+0000",
        "updated": "2021-08-25T13:56:20.000+0000",
        "timeoriginalestimate": null,
        "description": "To convert timestamps to a string representation with an arbitrary format we require a strftime kernel (the inverse operation of the {{strptime}} kernel we already have).\r\n\r\n\r\nSee [comments here|https://github.com/apache/arrow/pull/10598#issuecomment-868358466].",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "13h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 49200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Compute] Add strftime kernel",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/comment/17369653",
                    "id": "17369653",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "body": "This should also implement\u00a0TemporalStrftimeOptions with format and locale properties.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "created": "2021-06-25T18:47:29.592+0000",
                    "updated": "2021-06-25T18:47:29.592+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385814/comment/17401169",
                    "id": "17401169",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 10647\n[https://github.com/apache/arrow/pull/10647]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-08-18T16:04:55.198+0000",
                    "updated": "2021-08-18T16:04:55.198+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0sajk:",
        "customfield_12314139": null
    }
}