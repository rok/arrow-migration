{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13120677",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677",
    "key": "ARROW-1854",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "1.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12520860",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12520860",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13117346",
                    "key": "ARROW-1784",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13117346",
                    "fields": {
                        "summary": "[Python] Read and write pandas.DataFrame in pyarrow.serialize by decomposing the BlockManager rather than coercing to Arrow format",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1854/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@491505f[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7f2c6864[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1117bb31[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@de49e3f[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7fb60730[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@30ea30da[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1c88dbc5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3534ab0d[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7af4b51c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1b792678[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41758021[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@510927c1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Dec 15 22:15:02 UTC 2017",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2017-11-29T01:06:25.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1854/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2017-11-24T20:15:12.000+0000",
        "updated": "2017-12-15T22:15:03.000+0000",
        "timeoriginalestimate": null,
        "description": "I haven't looked carefully at the hot path for this, but I would expect these statements to have roughly the same performance (offloading the ndarray serialization to pickle)\r\n\r\n{code}\r\nIn [1]: import pickle\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: import pyarrow as pa\r\na\r\nIn [4]: arr = np.array(['foo', 'bar', None] * 100000, dtype=object)\r\n\r\nIn [5]: timeit serialized = pa.serialize(arr).to_buffer()\r\n10 loops, best of 3: 27.1 ms per loop\r\n\r\nIn [6]: timeit pickled = pickle.dumps(arr)\r\n100 loops, best of 3: 6.03 ms per loop\r\n{code}\r\n\r\n[~robertnishihara] [~pcmoritz] I encountered this while working on ARROW-1783, but it can likely be resolved independently",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12902458",
                "id": "12902458",
                "filename": "text.html",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=Brian.Bowman%40sas.com",
                    "name": "Brian.Bowman@sas.com",
                    "key": "brian.bowman@sas.com",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                    },
                    "displayName": "Brian Bowman",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2017-12-15T22:15:03.185+0000",
                "size": 2492,
                "mimeType": "text/html",
                "content": "https://issues.apache.org/jira/secure/attachment/12902458/text.html"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Improve performance of serializing object dtype ndarrays",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16265525",
                    "id": "16265525",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Your numbers are much better than what I'm seeing. It looks like the poor performance comes from our handling of lists. Since pyarrow handles the numpy array or objects by first converting it to a list and then serializing it, we can't do better than the list case.\r\n\r\nEDIT: Actually I'm seeing similar numbers (updated below). I think I had compiled without optimizations.\r\n\r\n{code}\r\nimport pickle\r\nimport pyarrow as pa\r\nimport numpy as np\r\n\r\nprint(pa.__version__)  # '0.7.2.dev165+ga446fbd.d20171116'\r\n\r\narr = np.array(['foo', 'bar', None] * 100000, dtype=object)\r\narr_list = arr.tolist()\r\n\r\n# Serializing the array.\r\n%timeit pa.serialize(arr).to_buffer()\r\n29.1 ms \u00b1 535 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n\r\n%timeit pickle.dumps(arr)\r\n7.43 ms \u00b1 196 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\r\n\r\n\r\n# Serializing the list.\r\n%timeit pa.serialize(arr_list).to_buffer()\r\n27.5 ms \u00b1 669 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n\r\n%timeit pickle.dumps(arr_list)\r\n5.87 ms \u00b1 160 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-24T20:40:09.575+0000",
                    "updated": "2017-11-24T20:43:22.316+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16265876",
                    "id": "16265876",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I'm quite confident we can do better. I think instead of converting an ndarray to a list, we should pickle it and send the pickle as a buffer along with any other buffers that are produced during the serialization pass",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-11-25T22:50:34.155+0000",
                    "updated": "2017-11-25T22:50:34.155+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16265914",
                    "id": "16265914",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "That would certainly work. It wouldn't give us any of the benefits of using Arrow, but for numpy arrays of general Python objects, we probably shouldn't expect that anyway.\r\n\r\nIt may be as simple as changing the custom serializer/deserializer. I'll take a quick look at that.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T05:36:03.379+0000",
                    "updated": "2017-11-26T05:36:03.379+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16265919",
                    "id": "16265919",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "We may run into problems when the numpy array can't be pickled/unpickled but it can be cloudpickled/cloudunpickled. E.g.,\r\n\r\n{code}\r\nimport numpy as np\r\nimport pickle\r\nimport cloudpickle\r\n\r\nclass Foo(object):\r\n    pass\r\n\r\na = np.array([Foo()])\r\n{code}\r\n\r\nPickle will succeed at pickling {{a}}, but it won't be able to unpickle it (in a different process). Cloudpickle will succeed but will be much slower. Our current approach will succeed and will be faster than cloudpickle.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=robertnishihara",
                        "name": "robertnishihara",
                        "key": "robertnishihara",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robert Nishihara",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T05:51:22.205+0000",
                    "updated": "2017-11-26T05:51:22.205+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266134",
                    "id": "16266134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347029430\n \n \n   I made some minor tweaks to send the pickle as a buffer rather than packing the bytes into the union:\r\n   \r\n   ```\r\n   >>> arr = np.array(['foo', 'bar', None] * 100000, dtype=object)\r\n   \r\n   >>> %timeit serialized = pa.serialize(arr)\r\n   4.66 ms \u00b1 28.1 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\r\n   \r\n   >>> %timeit pickle.dumps(arr, protocol=pickle.HIGHEST_PROTOCOL)\r\n   4.53 ms \u00b1 6.4 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 100 loops each)\r\n   ```\r\n   \r\n   This seems pretty acceptable to me. Without this patch we have on my machine\r\n   \r\n   ```\r\n   >>> %timeit serialized = pa.serialize(arr)\r\n   24.1 ms \u00b1 253 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n   ```\r\n   \r\n   The savings become more significant when there are repeated Python objects, I presume.\r\n   \r\n   How significant is the non-importable user-defined class issue? \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T18:47:07.077+0000",
                    "updated": "2017-11-26T18:47:07.077+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266194",
                    "id": "16266194",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347040022\n \n \n   That's a very nice speedup!\r\n   \r\n   However, I'd vote against merging this for now. It seems not that crucial for numpy arrays of custom objects to be fast and it is better to be general. Also I'd like to fall back to pickle as little as possible so we can transfer data between languages easily in the future.\r\n   \r\n   If somebody runs into this being too slow of course we should reinvestigate. There are some speedups possible even if we don't fall back to pickle (like getting rid of the temporary copy of the list and using an iterator instead).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T21:31:31.514+0000",
                    "updated": "2017-11-26T21:31:31.514+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266198",
                    "id": "16266198",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347040364\n \n \n   So the context is ARROW-1783 and ARROW-1784. The goal is to be able to send pandas objects over the wire, and these frequently (anytime you have strings, for example) have object arrays internally. So having object arrays going 3-4x slower than pickle is a significant issue. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T21:37:14.994+0000",
                    "updated": "2017-11-26T21:37:14.994+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266199",
                    "id": "16266199",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347040364\n \n \n   So the context is ARROW-1783 and ARROW-1784. The goal is to be able to send pandas objects over the wire, and these frequently (anytime you have strings, for example) have object arrays internally. So having object arrays going 3-6x slower than pickle is a significant issue. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T21:37:54.621+0000",
                    "updated": "2017-11-26T21:37:54.621+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266209",
                    "id": "16266209",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347042165\n \n \n   Ok, that is reasonable. Let me see if I can speed this up without falling back to pickle.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T22:03:34.642+0000",
                    "updated": "2017-11-26T22:03:34.642+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266216",
                    "id": "16266216",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347042779\n \n \n   Probably the bigger issue is that Python objects are not being deduplicated like they are in pickle. I would at least like to have the option of using pickle for these arrays if we cannot get within 20% or the performance of pickle\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T22:12:28.992+0000",
                    "updated": "2017-11-26T22:12:28.992+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266222",
                    "id": "16266222",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347043316\n \n \n   Yeah I agree with this! Ideally we would also do the deduplication, this is coming up from time to time, see also https://issues.apache.org/jira/browse/ARROW-1382.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-26T22:20:52.587+0000",
                    "updated": "2017-11-26T22:20:52.587+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266349",
                    "id": "16266349",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347075327\n \n \n   @wesm, you're right, the overhead comes from the fact that `pyarrow.serialize` doesn't handle duplication well. In the case where there is little or no duplication, `pyarrow.serialize` seems to outperform `pickle.dumps`. For example, see the following:\r\n   \r\n   ```python\r\n   import numpy as np\r\n   import pickle\r\n   import pyarrow as pa\r\n   \r\n   arr = np.array([str(i) for i in range(300000)], dtype=object)\r\n   \r\n   %timeit pickle.dumps(arr)\r\n   41.9 ms \u00b1 750 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n   \r\n   %timeit pa.serialize(arr).to_buffer()\r\n   30.9 ms \u00b1 270 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n   ```\r\n   \r\n   Given that the current code works in all cases (as far as I can tell) and is more performant in some cases, I still prefer the current code.\r\n   \r\n   However, if duplication is the common case for dataframes, then your optimization makes sense. In that case, would it be possible to move this code into the custom serializer for pandas dataframes instead of for numpy arrays? Or is that infeasible? If that is infeasible, I'd prefer to enable/disable this optimization with some sort of configuration flag because any reasonable cases that we can't handle will lead to complaints.\r\n   \r\n   Longer term, maybe this will all be solved by handling duplication properly.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:20:02.804+0000",
                    "updated": "2017-11-27T04:20:02.804+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266351",
                    "id": "16266351",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347075469\n \n \n   Do you have some object arrays where this might cause incompatibilities? I am fine with a flag to turn on this behavior, will have to think about what to call it\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:21:36.236+0000",
                    "updated": "2017-11-27T04:21:36.236+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266352",
                    "id": "16266352",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347075553\n \n \n   Yeah I came to the same conclusion, I'd like to implement duplication at some point on the serialization level but it certainly won't happen before the release.\r\n   \r\n   Meanwhile a custom serialization context or a flag are both good solutions.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:22:34.013+0000",
                    "updated": "2017-11-27T04:22:34.013+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266353",
                    "id": "16266353",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347075553\n \n \n   Yeah I came to the same conclusion. I'd like to implement duplication at some point on the serialization level but it certainly won't happen before the release.\r\n   \r\n   Meanwhile a custom serialization context or a flag are both good solutions.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:22:43.434+0000",
                    "updated": "2017-11-27T04:22:43.434+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266362",
                    "id": "16266362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347077436\n \n \n   I don't have any example arrays at the moment. However, it feels like the kind of thing that will come up.\r\n   \r\n   A custom serialization context makes sense to me (or having the downstream application register a more performant but less general custom serializer/deserializer).\r\n   \r\n   @wesm In the scenario you're working on, are these numpy arrays of objects only being created by the pandas custom serializers? Or are they coming from somewhere else? If this mostly arises from pandas, handling this in the custom pandas serializers might solve the problem.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:42:37.785+0000",
                    "updated": "2017-11-27T04:42:37.785+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16266363",
                    "id": "16266363",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347077638\n \n \n   Right, the idea is that we're serializing the internal NumPy arrays in a pandas DataFrame. So the downside is that Dask will have to bother with custom serializers, but it's not such a big deal (since it will need to feature some custom handling of `pyarrow.Buffer` anyway)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T04:44:34.617+0000",
                    "updated": "2017-11-27T04:44:34.617+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16267653",
                    "id": "16267653",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347341788\n \n \n   OK, I added a `pandas_serialization_context` variable, if that sounds OK\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T21:56:03.790+0000",
                    "updated": "2017-11-27T21:56:03.790+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16267656",
                    "id": "16267656",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347342049\n \n \n   Looks good to me!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T21:57:04.544+0000",
                    "updated": "2017-11-27T21:57:04.544+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16267764",
                    "id": "16267764",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360#issuecomment-347360270\n \n \n   +1 LGTM once the test failure is fixed\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-27T23:11:42.820+0000",
                    "updated": "2017-11-27T23:11:42.820+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16269851",
                    "id": "16269851",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1360\n[https://github.com/apache/arrow/pull/1360]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-11-29T01:06:25.344+0000",
                    "updated": "2017-11-29T01:06:25.344+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16269852",
                    "id": "16269852",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1360: ARROW-1854: [Python] Use pickle to serialize numpy arrays of objects.\nURL: https://github.com/apache/arrow/pull/1360\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/pyarrow/__init__.py b/python/pyarrow/__init__.py\nindex bd31b21c1..a245fe679 100644\n--- a/python/pyarrow/__init__.py\n+++ b/python/pyarrow/__init__.py\n@@ -125,6 +125,7 @@\n localfs = LocalFileSystem.get_instance()\n \n from pyarrow.serialization import (_default_serialization_context,\n+                                   pandas_serialization_context,\n                                    register_default_serialization_handlers)\n \n import pyarrow.types as types\ndiff --git a/python/pyarrow/serialization.pxi b/python/pyarrow/serialization.pxi\nindex bb266b2f9..faf164b3e 100644\n--- a/python/pyarrow/serialization.pxi\n+++ b/python/pyarrow/serialization.pxi\n@@ -57,6 +57,22 @@ cdef class SerializationContext:\n         self.custom_serializers = dict()\n         self.custom_deserializers = dict()\n \n+    def clone(self):\n+        \"\"\"\n+        Return copy of this SerializationContext\n+\n+        Returns\n+        -------\n+        clone : SerializationContext\n+        \"\"\"\n+        result = SerializationContext()\n+        result.type_to_type_id = self.type_to_type_id.copy()\n+        result.whitelisted_types = self.whitelisted_types.copy()\n+        result.custom_serializers = self.custom_serializers.copy()\n+        result.custom_deserializers = self.custom_deserializers.copy()\n+\n+        return result\n+\n     def register_type(self, type_, type_id,\n                       custom_serializer=None, custom_deserializer=None):\n         \"\"\"EXPERIMENTAL: Add type to the list of types we can serialize.\ndiff --git a/python/pyarrow/serialization.py b/python/pyarrow/serialization.py\nindex ab25b63d5..08e6cce75 100644\n--- a/python/pyarrow/serialization.py\n+++ b/python/pyarrow/serialization.py\n@@ -22,7 +22,7 @@\n import numpy as np\n \n from pyarrow import serialize_pandas, deserialize_pandas\n-from pyarrow.lib import _default_serialization_context\n+from pyarrow.lib import _default_serialization_context, frombuffer\n \n try:\n     import cloudpickle\n@@ -30,6 +30,28 @@\n     cloudpickle = pickle\n \n \n+# ----------------------------------------------------------------------\n+# Set up serialization for numpy with dtype object (primitive types are\n+# handled efficiently with Arrow's Tensor facilities, see\n+# python_to_arrow.cc)\n+\n+def _serialize_numpy_array_list(obj):\n+    return obj.tolist(), obj.dtype.str\n+\n+\n+def _deserialize_numpy_array_list(data):\n+    return np.array(data[0], dtype=np.dtype(data[1]))\n+\n+\n+def _serialize_numpy_array_pickle(obj):\n+    pickled = pickle.dumps(obj, protocol=pickle.HIGHEST_PROTOCOL)\n+    return frombuffer(pickled)\n+\n+\n+def _deserialize_numpy_array_pickle(data):\n+    return pickle.loads(memoryview(data))\n+\n+\n def register_default_serialization_handlers(serialization_context):\n \n     # ----------------------------------------------------------------------\n@@ -80,21 +102,10 @@ def _deserialize_default_dict(data):\n                                         custom_serializer=cloudpickle.dumps,\n                                         custom_deserializer=cloudpickle.loads)\n \n-    # ----------------------------------------------------------------------\n-    # Set up serialization for numpy with dtype object (primitive types are\n-    # handled efficiently with Arrow's Tensor facilities, see\n-    # python_to_arrow.cc)\n-\n-    def _serialize_numpy_array(obj):\n-        return obj.tolist(), obj.dtype.str\n-\n-    def _deserialize_numpy_array(data):\n-        return np.array(data[0], dtype=np.dtype(data[1]))\n-\n     serialization_context.register_type(\n         np.ndarray, 'np.array',\n-        custom_serializer=_serialize_numpy_array,\n-        custom_deserializer=_deserialize_numpy_array)\n+        custom_serializer=_serialize_numpy_array_list,\n+        custom_deserializer=_deserialize_numpy_array_list)\n \n     # ----------------------------------------------------------------------\n     # Set up serialization for pandas Series and DataFrame\n@@ -153,3 +164,10 @@ def _deserialize_torch_tensor(data):\n \n \n register_default_serialization_handlers(_default_serialization_context)\n+\n+pandas_serialization_context = _default_serialization_context.clone()\n+\n+pandas_serialization_context.register_type(\n+    np.ndarray, 'np.array',\n+    custom_serializer=_serialize_numpy_array_pickle,\n+    custom_deserializer=_deserialize_numpy_array_pickle)\ndiff --git a/python/pyarrow/tests/test_serialization.py b/python/pyarrow/tests/test_serialization.py\nindex d06beeac9..6d85621d4 100644\n--- a/python/pyarrow/tests/test_serialization.py\n+++ b/python/pyarrow/tests/test_serialization.py\n@@ -212,11 +212,11 @@ def make_serialization_context():\n serialization_context = make_serialization_context()\n \n \n-def serialization_roundtrip(value, f):\n+def serialization_roundtrip(value, f, ctx=serialization_context):\n     f.seek(0)\n-    pa.serialize_to(value, f, serialization_context)\n+    pa.serialize_to(value, f, ctx)\n     f.seek(0)\n-    result = pa.deserialize_from(f, None, serialization_context)\n+    result = pa.deserialize_from(f, None, ctx)\n     assert_equal(value, result)\n \n     _check_component_roundtrip(value)\n@@ -249,6 +249,7 @@ def test_primitive_serialization(large_memory_map):\n     with pa.memory_map(large_memory_map, mode=\"r+\") as mmap:\n         for obj in PRIMITIVE_OBJECTS:\n             serialization_roundtrip(obj, mmap)\n+            serialization_roundtrip(obj, mmap, pa.pandas_serialization_context)\n \n \n def test_serialize_to_buffer():\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T01:06:26.887+0000",
                    "updated": "2017-11-29T01:06:26.887+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13120677/comment/16293350",
                    "id": "16293350",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Brian.Bowman%40sas.com",
                        "name": "Brian.Bowman@sas.com",
                        "key": "brian.bowman@sas.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Brian Bowman",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I\u2019m out of the office for vacation, followed by the SAS Winter Holiday until Tuesay January 2nd 2018.\r\n\r\n-Brian\r\n\r\nOn Nov 24, 2017, at 3:16 PM, Wes McKinney (JIRA) <jira@apache.org> wrote:\r\n\r\nEXTERNAL\r\n\r\nWes McKinney created ARROW-1854:\r\n-----------------------------------\r\n\r\n            Summary: [Python] Improve performance of serializing object dtype ndarrays\r\n                Key: ARROW-1854\r\n                URL: https://issues.apache.org/jira/browse/ARROW-1854\r\n            Project: Apache Arrow\r\n         Issue Type: Improvement\r\n         Components: Python\r\n           Reporter: Wes McKinney\r\n            Fix For: 0.8.0\r\n\r\n\r\nI haven't looked carefully at the hot path for this, but I would expect these statements to have roughly the same performance (offloading the ndarray serialization to pickle)\r\n\r\n{code}\r\nIn [1]: import pickle\r\n\r\nIn [2]: import numpy as np\r\n\r\nIn [3]: import pyarrow as pa\r\na\r\nIn [4]: arr = np.array(['foo', 'bar', None] * 100000, dtype=object)\r\n\r\nIn [5]: timeit serialized = pa.serialize(arr).to_buffer()\r\n10 loops, best of 3: 27.1 ms per loop\r\n\r\nIn [6]: timeit pickled = pickle.dumps(arr)\r\n100 loops, best of 3: 6.03 ms per loop\r\n{code}\r\n\r\n[~robertnishihara] [~pcmoritz] I encountered this while working on ARROW-1783, but it can likely be resolved independently\r\n\r\n\r\n\r\n--\r\nThis message was sent by Atlassian JIRA\r\n(v6.4.14#64029)\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Brian.Bowman%40sas.com",
                        "name": "Brian.Bowman@sas.com",
                        "key": "brian.bowman@sas.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Brian Bowman",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-15T22:15:02.974+0000",
                    "updated": "2017-12-15T22:15:02.974+0000"
                }
            ],
            "maxResults": 23,
            "total": 23,
            "startAt": 0
        },
        "customfield_12311820": "0|i3n6br:",
        "customfield_12314139": null
    }
}