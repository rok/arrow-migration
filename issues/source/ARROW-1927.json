{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13125052",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052",
    "key": "ARROW-1927",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jinhai",
            "name": "jinhai",
            "key": "jinhai",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "JinHai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12332956",
                "id": "12332956",
                "name": "C++ - Plasma"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pcmoritz",
            "name": "pcmoritz",
            "key": "pcmoritz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Philipp Moritz",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pcmoritz",
            "name": "pcmoritz",
            "key": "pcmoritz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Philipp Moritz",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1927/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1707bd9c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5c5af1c5[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1b8a5675[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@10555818[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6f4c4e2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6865352f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2115ffa8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1b3af60a[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3bc9e25b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7a447440[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@74223c1f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@38e41e37[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Jan 15 14:09:58 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-01-10T23:32:29.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1927/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2017-12-14T23:00:26.000+0000",
        "updated": "2018-01-16T03:04:56.000+0000",
        "timeoriginalestimate": null,
        "description": "The function should check if the reference count of the object is zero and if yes, delete it from the store. If no, it should raise an exception or return a status value.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Plasma] Implement delete function",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293982",
                    "id": "16293982",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN opened a new pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427\n \n \n   Hi, I just add the delete function for Plasma and tested. JIRA ticked:\r\n   https://issues.apache.org/jira/browse/ARROW-1927\r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:17:35.185+0000",
                    "updated": "2017-12-17T03:17:35.185+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293990",
                    "id": "16293990",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356844\n \n \n\n ##########\n File path: cpp/src/plasma/store.cc\n ##########\n @@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n+    auto entry = get_object_table_entry(&store_info_, object_id);\n+    // TODO(rkn): This should probably not fail, but should instead throw an\n+    // error. Maybe we should also support deleting objects that have been\n+    // created but not sealed.\n+    if(entry == NULL) {\n+    // To delete an object it must be in the object table.\n \n Review comment:\n   comment should be indented as much as the following line\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:33:08.372+0000",
                    "updated": "2017-12-17T03:33:08.372+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293991",
                    "id": "16293991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356837\n \n \n\n ##########\n File path: cpp/src/plasma/store.cc\n ##########\n @@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n \n Review comment:\n   Given that we already have a `delete_objects` method, does it make sense to also have a `delete_object` method? Is the behavior of this method different from calling `delete_objects` on a vector of one object ID?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:33:22.406+0000",
                    "updated": "2017-12-17T03:33:22.406+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293992",
                    "id": "16293992",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356846\n \n \n\n ##########\n File path: cpp/src/plasma/store.cc\n ##########\n @@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n+    auto entry = get_object_table_entry(&store_info_, object_id);\n+    // TODO(rkn): This should probably not fail, but should instead throw an\n+    // error. Maybe we should also support deleting objects that have been\n+    // created but not sealed.\n+    if(entry == NULL) {\n+    // To delete an object it must be in the object table.\n+      return PlasmaError_ObjectNonexistent;\n+    }\n+\n+    if(entry->state != PLASMA_SEALED) {\n+    // To delete an object it must have been sealed.\n \n Review comment:\n   comment indentation\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:33:35.391+0000",
                    "updated": "2017-12-17T03:33:35.391+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293993",
                    "id": "16293993",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356806\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,19 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n \n Review comment:\n   In `client.h` we should probably clarify the behavior of this method. In particular, if a client calls `Delete`, that does not guarantee that the object will be deleted. In particular, if the object is in use by another client, then the `Delete` call is a no-op, right? Can you mention this in the documentation for this method in `client.h`?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:33:39.841+0000",
                    "updated": "2017-12-17T03:33:39.841+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293994",
                    "id": "16293994",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356848\n \n \n\n ##########\n File path: cpp/src/plasma/store.cc\n ##########\n @@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n+    auto entry = get_object_table_entry(&store_info_, object_id);\n+    // TODO(rkn): This should probably not fail, but should instead throw an\n+    // error. Maybe we should also support deleting objects that have been\n+    // created but not sealed.\n+    if(entry == NULL) {\n+    // To delete an object it must be in the object table.\n+      return PlasmaError_ObjectNonexistent;\n+    }\n+\n+    if(entry->state != PLASMA_SEALED) {\n+    // To delete an object it must have been sealed.\n+      return PlasmaError_ObjectNotSealed;\n+    }\n+\n+    if(entry->clients.size() != 0) {\n+    // To delete an object, there must be no clients currently using it.\n \n Review comment:\n   comment indentation\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:33:47.933+0000",
                    "updated": "2017-12-17T03:33:47.933+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293996",
                    "id": "16293996",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356867\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,19 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n \n Review comment:\n   Shall we create a custom error for this so it can be caught in Python?\r\n   \r\n   cc @wesm \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:36:42.418+0000",
                    "updated": "2017-12-17T03:36:42.418+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293997",
                    "id": "16293997",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356903\n \n \n\n ##########\n File path: cpp/src/plasma/store.cc\n ##########\n @@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n \n Review comment:\n   To be honest, they are similar. But in delete_object will issue the error status to client if delete object failed. As for delete_objects used by evict objects function, I don't want to impact it too much.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:42:01.081+0000",
                    "updated": "2017-12-17T03:42:01.081+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293998",
                    "id": "16293998",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-352229791\n \n \n   Yes, I will try to create the unit test cases in next commitment.\n   \n   > On 17 Dec 2017, at 11:40 AM, Philipp Moritz <notifications@github.com> wrote:\n   > \n   > @pcmoritz commented on this pull request.\n   > \n   > Hey, this looks good, thanks for the contribution! Can you please also create a unit test that tests the following two scenarios:\n   > \n   > make sure an error is raised if the object is in use\n   > test the \"normal\" case where the object is not in use and make sure it was actually deleted (maybe by trying to create an object with the same object id)\n   > maybe test what happens if an object is deleted that doesn't exist yet.\n   > \u2014\n   > You are receiving this because you authored the thread.\n   > Reply to this email directly, view it on GitHub <https://github.com/apache/arrow/pull/1427#pullrequestreview-83989260>, or mute the thread <https://github.com/notifications/unsubscribe-auth/Afm26VC0v8ihrTN7qCYl8g60TEQ7M519ks5tBI0hgaJpZM4REiBf>.\n   > \n   \n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:45:09.310+0000",
                    "updated": "2017-12-17T03:45:09.310+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16293999",
                    "id": "16293999",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157356941\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,19 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n \n Review comment:\n   No, it doesn't guarantee the object will be deleted for some reasons.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-17T03:47:00.708+0000",
                    "updated": "2017-12-17T03:47:00.708+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297699",
                    "id": "16297699",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157910600\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n \n Review comment:\n   What do you think about not having the plasma store reply to the client? The client could just continue on. If it really wants to know whether the object was deleted or not, it can call `Contains` to check.\r\n   \r\n   Are there use cases where you really want to know if the object was deleted or not?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T00:27:01.938+0000",
                    "updated": "2017-12-20T00:27:01.938+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297700",
                    "id": "16297700",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157910215\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n \n Review comment:\n   The error should probably just be `\"Object is in use.\"`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T00:27:02.004+0000",
                    "updated": "2017-12-20T00:27:02.004+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297701",
                    "id": "16297701",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157910818\n \n \n\n ##########\n File path: cpp/src/plasma/eviction_policy.cc\n ##########\n @@ -102,4 +102,9 @@ void EvictionPolicy::end_object_access(const ObjectID& object_id,\n   cache_.add(object_id, entry->info.data_size + entry->info.metadata_size);\n }\n \n+void EvictionPolicy::remove_object(const ObjectID& object_id) {\n+  /* If the object is in the LRU cache, remove it. */\n+  cache_.remove(object_id);\n \n Review comment:\n   I think we also need to update the `memory_used_` field.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T00:27:02.041+0000",
                    "updated": "2017-12-20T00:27:02.041+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297721",
                    "id": "16297721",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157914175\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n \n Review comment:\n   Yes, fixed\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T00:49:07.647+0000",
                    "updated": "2017-12-20T00:49:07.647+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297726",
                    "id": "16297726",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157914936\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n \n Review comment:\n   Providing a blocked API is the most common thinking. If delete operation failed,  client also need to know why the delete operation failed and do the next step according to the reason.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T00:55:38.967+0000",
                    "updated": "2017-12-20T00:55:38.967+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297735",
                    "id": "16297735",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157916187\n \n \n\n ##########\n File path: cpp/src/plasma/eviction_policy.cc\n ##########\n @@ -102,4 +102,9 @@ void EvictionPolicy::end_object_access(const ObjectID& object_id,\n   cache_.add(object_id, entry->info.data_size + entry->info.metadata_size);\n }\n \n+void EvictionPolicy::remove_object(const ObjectID& object_id) {\n+  /* If the object is in the LRU cache, remove it. */\n+  cache_.remove(object_id);\n \n Review comment:\n   Yes, fixed.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T01:05:53.676+0000",
                    "updated": "2017-12-20T01:05:53.676+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297742",
                    "id": "16297742",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157917179\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n \n Review comment:\n   Can you describe the use case?\r\n   \r\n   If you view the command as more of a \"hint\" that doesn't necessarily do anything but simply gives the plasma store more information that it can make use of, then a non-blocking API is natural.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T01:14:23.784+0000",
                    "updated": "2017-12-20T01:14:23.784+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16297790",
                    "id": "16297790",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r157923946\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n \n Review comment:\n   Yes, just update operation. And it can be implemented as: check contains, delete, check contains again to make it happen. \r\n   Currently, only two reasons: not sealed object and object is in use will make the DELETE operation failed. We can make it as non-blocking API. But when I look at other APIs such as CREATE, they also will provide the reply to the client. I think DELETE operation should follow the same way as CREATE operation.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T02:15:53.936+0000",
                    "updated": "2017-12-20T02:15:53.936+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16299179",
                    "id": "16299179",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on a change in pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#discussion_r158150766\n \n \n\n ##########\n File path: cpp/src/plasma/client.cc\n ##########\n @@ -501,9 +501,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in used.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n \n Review comment:\n   Ok, let's try out this approach and see if it's useful, though I think we should consider switching to \"hint\" semantics at some point.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-20T22:16:15.743+0000",
                    "updated": "2017-12-20T22:16:15.743+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16321340",
                    "id": "16321340",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-356773007\n \n \n   +1 This looks good. The test failure looks unrelated (the node.js tests are failing a lot)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-10T23:31:12.715+0000",
                    "updated": "2018-01-10T23:31:12.715+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16321343",
                    "id": "16321343",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz closed pull request #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/plasma/client.cc b/cpp/src/plasma/client.cc\nindex 0dd1c44d7..d74c0f412 100644\n--- a/cpp/src/plasma/client.cc\n+++ b/cpp/src/plasma/client.cc\n@@ -513,9 +513,20 @@ Status PlasmaClient::Abort(const ObjectID& object_id) {\n }\n \n Status PlasmaClient::Delete(const ObjectID& object_id) {\n-  // TODO(rkn): In the future, we can use this method to give hints to the\n-  // eviction policy about when an object will no longer be needed.\n-  return Status::NotImplemented(\"PlasmaClient::Delete is not implemented.\");\n+  RETURN_NOT_OK(FlushReleaseHistory());\n+  // If the object is in used, client can't send the remove message.\n+  if (objects_in_use_.count(object_id) > 0) {\n+    return Status::UnknownError(\"PlasmaClient::Object is in use.\");\n+  } else {\n+    // If we don't already have a reference to the object, we can try to remove the object\n+    RETURN_NOT_OK(SendDeleteRequest(store_conn_, object_id));\n+    std::vector<uint8_t> buffer;\n+    RETURN_NOT_OK(PlasmaReceive(store_conn_, MessageType_PlasmaDeleteReply, &buffer));\n+    ObjectID object_id2;\n+    DCHECK_GT(buffer.size(), 0);\n+    RETURN_NOT_OK(ReadDeleteReply(buffer.data(), buffer.size(), &object_id2));\n+    return Status::OK();\n+  }\n }\n \n Status PlasmaClient::Evict(int64_t num_bytes, int64_t& num_bytes_evicted) {\ndiff --git a/cpp/src/plasma/client.h b/cpp/src/plasma/client.h\nindex 78793f1a7..35182f840 100644\n--- a/cpp/src/plasma/client.h\n+++ b/cpp/src/plasma/client.h\n@@ -174,7 +174,8 @@ class ARROW_EXPORT PlasmaClient {\n   Status Seal(const ObjectID& object_id);\n \n   /// Delete an object from the object store. This currently assumes that the\n-  /// object is present and has been sealed.\n+  /// object is present, has been sealed and not used by another client. Otherwise,\n+  /// it is a no operation.\n   ///\n   /// @todo We may want to allow the deletion of objects that are not present or\n   ///       haven't been sealed.\ndiff --git a/cpp/src/plasma/eviction_policy.cc b/cpp/src/plasma/eviction_policy.cc\nindex a7758fd2c..66a3b2ea2 100644\n--- a/cpp/src/plasma/eviction_policy.cc\n+++ b/cpp/src/plasma/eviction_policy.cc\n@@ -102,4 +102,14 @@ void EvictionPolicy::end_object_access(const ObjectID& object_id,\n   cache_.add(object_id, entry->info.data_size + entry->info.metadata_size);\n }\n \n+void EvictionPolicy::remove_object(const ObjectID& object_id) {\n+  /* If the object is in the LRU cache, remove it. */\n+  cache_.remove(object_id);\n+\n+  auto entry = store_info_->objects[object_id].get();\n+  int64_t size = entry->info.data_size + entry->info.metadata_size;\n+  ARROW_CHECK(memory_used_ >= size);\n+  memory_used_ -= size;\n+}\n+\n }  // namespace plasma\ndiff --git a/cpp/src/plasma/eviction_policy.h b/cpp/src/plasma/eviction_policy.h\nindex cebf35b1c..b07630955 100644\n--- a/cpp/src/plasma/eviction_policy.h\n+++ b/cpp/src/plasma/eviction_policy.h\n@@ -120,6 +120,11 @@ class EvictionPolicy {\n   int64_t choose_objects_to_evict(int64_t num_bytes_required,\n                                   std::vector<ObjectID>* objects_to_evict);\n \n+  /// This method will be called when an object is going to be removed\n+  ///\n+  /// @param object_id The ID of the object that is now being used.\n+  void remove_object(const ObjectID& object_id);\n+\n  private:\n   /// The amount of memory (in bytes) currently being used.\n   int64_t memory_used_;\ndiff --git a/cpp/src/plasma/format/plasma.fbs b/cpp/src/plasma/format/plasma.fbs\nindex b6d03b8a3..ea6dc8bb9 100644\n--- a/cpp/src/plasma/format/plasma.fbs\n+++ b/cpp/src/plasma/format/plasma.fbs\n@@ -76,7 +76,11 @@ enum PlasmaError:int {\n   // Trying to access an object that doesn't exist.\n   ObjectNonexistent,\n   // Trying to create an object but there isn't enough space in the store.\n-  OutOfMemory\n+  OutOfMemory,\n+  // Trying to delete an object but it's not sealed.\n+  ObjectNotSealed,\n+  // Trying to delete an object but it's in use.\n+  ObjectInUse\n }\n \n // Plasma store messages\ndiff --git a/cpp/src/plasma/store.cc b/cpp/src/plasma/store.cc\nindex c6a19a547..dde7f9cdf 100644\n--- a/cpp/src/plasma/store.cc\n+++ b/cpp/src/plasma/store.cc\n@@ -411,6 +411,39 @@ int PlasmaStore::abort_object(const ObjectID& object_id, Client* client) {\n   }\n }\n \n+int PlasmaStore::delete_object(ObjectID& object_id) {\n+  auto entry = get_object_table_entry(&store_info_, object_id);\n+  // TODO(rkn): This should probably not fail, but should instead throw an\n+  // error. Maybe we should also support deleting objects that have been\n+  // created but not sealed.\n+  if (entry == NULL) {\n+    // To delete an object it must be in the object table.\n+    return PlasmaError_ObjectNonexistent;\n+  }\n+\n+  if (entry->state != PLASMA_SEALED) {\n+    // To delete an object it must have been sealed.\n+    return PlasmaError_ObjectNotSealed;\n+  }\n+\n+  if (entry->clients.size() != 0) {\n+    // To delete an object, there must be no clients currently using it.\n+    return PlasmaError_ObjectInUse;\n+  }\n+\n+  eviction_policy_.remove_object(object_id);\n+\n+  dlfree(entry->pointer);\n+  store_info_.objects.erase(object_id);\n+  // Inform all subscribers that the object has been deleted.\n+  ObjectInfoT notification;\n+  notification.object_id = object_id.binary();\n+  notification.is_deletion = true;\n+  push_notification(&notification);\n+\n+  return PlasmaError_OK;\n+}\n+\n void PlasmaStore::delete_objects(const std::vector<ObjectID>& object_ids) {\n   for (const auto& object_id : object_ids) {\n     ARROW_LOG(DEBUG) << \"deleting object \" << object_id.hex();\n@@ -626,18 +659,23 @@ Status PlasmaStore::process_message(Client* client) {\n       RETURN_NOT_OK(ReadGetRequest(input, input_size, object_ids_to_get, &timeout_ms));\n       process_get_request(client, object_ids_to_get, timeout_ms);\n     } break;\n-    case MessageType_PlasmaReleaseRequest:\n+    case MessageType_PlasmaReleaseRequest: {\n       RETURN_NOT_OK(ReadReleaseRequest(input, input_size, &object_id));\n       release_object(object_id, client);\n-      break;\n-    case MessageType_PlasmaContainsRequest:\n+    } break;\n+    case MessageType_PlasmaDeleteRequest: {\n+      RETURN_NOT_OK(ReadDeleteRequest(input, input_size, &object_id));\n+      int error_code = delete_object(object_id);\n+      HANDLE_SIGPIPE(SendDeleteReply(client->fd, object_id, error_code), client->fd);\n+    } break;\n+    case MessageType_PlasmaContainsRequest: {\n       RETURN_NOT_OK(ReadContainsRequest(input, input_size, &object_id));\n       if (contains_object(object_id) == OBJECT_FOUND) {\n         HANDLE_SIGPIPE(SendContainsReply(client->fd, object_id, 1), client->fd);\n       } else {\n         HANDLE_SIGPIPE(SendContainsReply(client->fd, object_id, 0), client->fd);\n       }\n-      break;\n+    } break;\n     case MessageType_PlasmaSealRequest: {\n       unsigned char digest[kDigestSize];\n       RETURN_NOT_OK(ReadSealRequest(input, input_size, &object_id, &digest[0]));\ndiff --git a/cpp/src/plasma/store.h b/cpp/src/plasma/store.h\nindex a72c6259a..7eada5a12 100644\n--- a/cpp/src/plasma/store.h\n+++ b/cpp/src/plasma/store.h\n@@ -83,6 +83,15 @@ class PlasmaStore {\n   /// @return 1 if the abort succeeds, else 0.\n   int abort_object(const ObjectID& object_id, Client* client);\n \n+  /// Delete an specific object by object_id that have been created in the hash table.\n+  ///\n+  /// @param object_id Object ID of the object to be deleted.\n+  /// @return One of the following error codes:\n+  ///  - PlasmaError_OK, if the object was delete successfully.\n+  ///  - PlasmaError_ObjectNonexistent, if ths object isn't existed.\n+  ///  - PlasmaError_ObjectInUse, if the object is in use.\n+  int delete_object(ObjectID& object_id);\n+\n   /// Delete objects that have been created in the hash table. This should only\n   /// be called on objects that are returned by the eviction policy to evict.\n   ///\ndiff --git a/cpp/src/plasma/test/client_tests.cc b/cpp/src/plasma/test/client_tests.cc\nindex 5cd3063bb..f19c2bfbd 100644\n--- a/cpp/src/plasma/test/client_tests.cc\n+++ b/cpp/src/plasma/test/client_tests.cc\n@@ -58,6 +58,31 @@ class TestPlasmaStore : public ::testing::Test {\n   PlasmaClient client2_;\n };\n \n+TEST_F(TestPlasmaStore, DeleteTest) {\n+  ObjectID object_id = ObjectID::from_random();\n+\n+  // Test for deleting non-existance object.\n+  Status result = client_.Delete(object_id);\n+  ASSERT_EQ(result.IsPlasmaObjectNonexistent(), true);\n+\n+  // Test for the object being in local Plasma store.\n+  // First create object.\n+  int64_t data_size = 100;\n+  uint8_t metadata[] = {5};\n+  int64_t metadata_size = sizeof(metadata);\n+  std::shared_ptr<Buffer> data;\n+  ARROW_CHECK_OK(client_.Create(object_id, data_size, metadata, metadata_size, &data));\n+  ARROW_CHECK_OK(client_.Seal(object_id));\n+\n+  // Object is in use, can't be delete.\n+  result = client_.Delete(object_id);\n+  ASSERT_EQ(result.IsUnknownError(), true);\n+\n+  // Avoid race condition of Plasma Manager waiting for notification.\n+  ARROW_CHECK_OK(client_.Release(object_id));\n+  ARROW_CHECK_OK(client_.Delete(object_id));\n+}\n+\n TEST_F(TestPlasmaStore, ContainsTest) {\n   ObjectID object_id = ObjectID::from_random();\n \n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-10T23:32:23.581+0000",
                    "updated": "2018-01-10T23:32:23.581+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16321344",
                    "id": "16321344",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pcmoritz",
                        "name": "pcmoritz",
                        "key": "pcmoritz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Philipp Moritz",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 1427\n[https://github.com/apache/arrow/pull/1427]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=pcmoritz",
                        "name": "pcmoritz",
                        "key": "pcmoritz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Philipp Moritz",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-10T23:32:29.313+0000",
                    "updated": "2018-01-10T23:32:29.313+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16321346",
                    "id": "16321346",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "robertnishihara commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-356773400\n \n \n   We should also expose this through Python and add Python tests.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-10T23:32:49.022+0000",
                    "updated": "2018-01-10T23:32:49.022+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16321350",
                    "id": "16321350",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pcmoritz commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-356773804\n \n \n   Yeah, let's do this as a followup PR\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-10T23:34:37.107+0000",
                    "updated": "2018-01-10T23:34:37.107+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16323225",
                    "id": "16323225",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-357097036\n \n \n   @JinHai-CN could you let me know your JIRA id on the ASF JIRA so I can assign this issue to you?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-11T23:37:33.396+0000",
                    "updated": "2018-01-11T23:37:33.396+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13125052/comment/16326266",
                    "id": "16326266",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "JinHai-CN commented on issue #1427: ARROW-1927: [Plasma] Add delete function\nURL: https://github.com/apache/arrow/pull/1427#issuecomment-357692885\n \n \n   @wesm ID: jinhai\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-01-15T14:09:58.134+0000",
                    "updated": "2018-01-15T14:09:58.134+0000"
                }
            ],
            "maxResults": 26,
            "total": 26,
            "startAt": 0
        },
        "customfield_12311820": "0|i3nx6v:",
        "customfield_12314139": null
    }
}