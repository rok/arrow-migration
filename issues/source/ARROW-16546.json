{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13444645",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645",
    "key": "ARROW-16546",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351550",
                "id": "12351550",
                "name": "9.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-08-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "1.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12337837",
                "id": "12337837",
                "name": "Parquet"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=urmanbm",
            "name": "urmanbm",
            "key": "JIRAUSER289400",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Boris Urman",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=urmanbm",
            "name": "urmanbm",
            "key": "JIRAUSER289400",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Boris Urman",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16546/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 21,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/776422",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou opened a new pull request, #13275:\nURL: https://github.com/apache/arrow/pull/13275\n\n   In fringe cases, users may have Parquet files where deserializing exceeds our default Thrift size limits.\n\n\n",
                    "created": "2022-05-31T16:18:43.153+0000",
                    "updated": "2022-05-31T16:18:43.153+0000",
                    "started": "2022-05-31T16:18:43.153+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776422",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/776424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r885842956\n\n\n##########\ncpp/src/parquet/metadata.h:\n##########\n@@ -126,6 +126,12 @@ class PARQUET_EXPORT ColumnChunkMetaData {\n       const ApplicationVersion* writer_version = NULLPTR, int16_t row_group_ordinal = -1,\n       int16_t column_ordinal = -1,\n       std::shared_ptr<InternalFileDecryptor> file_decryptor = NULLPTR);\n\nReview Comment:\n   I kept the old `*MetaData::Make` signatures for compatibility, but perhaps that's not important? @emkornfield @lidavidm \n\n\n\n",
                    "created": "2022-05-31T16:21:58.448+0000",
                    "updated": "2022-05-31T16:21:58.448+0000",
                    "started": "2022-05-31T16:21:58.448+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776424",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/776434",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#issuecomment-1142363955\n\n   https://issues.apache.org/jira/browse/ARROW-16546\n\n\n",
                    "created": "2022-05-31T16:33:04.173+0000",
                    "updated": "2022-05-31T16:33:04.173+0000",
                    "started": "2022-05-31T16:33:04.172+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776434",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/776437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r885867888\n\n\n##########\ncpp/src/parquet/metadata.h:\n##########\n@@ -126,6 +126,12 @@ class PARQUET_EXPORT ColumnChunkMetaData {\n       const ApplicationVersion* writer_version = NULLPTR, int16_t row_group_ordinal = -1,\n       int16_t column_ordinal = -1,\n       std::shared_ptr<InternalFileDecryptor> file_decryptor = NULLPTR);\n\nReview Comment:\n   I think we can just keep it. Maybe put a deprecation on it?\n\n\n\n",
                    "created": "2022-05-31T16:38:54.840+0000",
                    "updated": "2022-05-31T16:38:54.840+0000",
                    "started": "2022-05-31T16:38:54.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "776437",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/777598",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r888009120\n\n\n##########\npython/pyarrow/_dataset_parquet.pyx:\n##########\n@@ -654,17 +668,49 @@ cdef class ParquetFragmentScanOptions(FragmentScanOptions):\n     def pre_buffer(self, bint pre_buffer):\n         self.arrow_reader_properties().set_pre_buffer(pre_buffer)\n \n+    @property\n+    def thrift_string_size_limit(self):\n+        return self.reader_properties().thrift_string_size_limit()\n+\n+    @thrift_string_size_limit.setter\n+    def thrift_string_size_limit(self, size):\n+        if size <= 0:\n+            raise ValueError(\"size must be larger than zero\")\n+        self.reader_properties().set_thrift_string_size_limit(size)\n+\n+    @property\n+    def thrift_container_size_limit(self):\n+        return self.reader_properties().thrift_container_size_limit()\n+\n+    @thrift_container_size_limit.setter\n+    def thrift_container_size_limit(self, size):\n+        if size <= 0:\n+            raise ValueError(\"size must be larger than zero\")\n\nReview Comment:\n   Should such a check be included in `_parquet.pyx` as well?\n\n\n\n##########\npython/pyarrow/parquet/__init__.py:\n##########\n@@ -2258,11 +2269,13 @@ class _ParquetDatasetV2:\n     1       4  Horse  2022\n     \"\"\"\n \n-    def __init__(self, path_or_paths, filesystem=None, filters=None,\n+    def __init__(self, path_or_paths, filesystem=None, *, filters=None,\n                  partitioning=\"hive\", read_dictionary=None, buffer_size=None,\n                  memory_map=False, ignore_prefixes=None, pre_buffer=True,\n                  coerce_int96_timestamp_unit=None, schema=None,\n-                 decryption_properties=None, **kwargs):\n+                 decryption_properties=None, thrift_string_size_limit=None,\n+                 thrift_container_size_limit=None,\n\nReview Comment:\n   Although if the tests pass ..\n\n\n\n##########\npython/pyarrow/parquet/__init__.py:\n##########\n@@ -2258,11 +2269,13 @@ class _ParquetDatasetV2:\n     1       4  Horse  2022\n     \"\"\"\n \n-    def __init__(self, path_or_paths, filesystem=None, filters=None,\n+    def __init__(self, path_or_paths, filesystem=None, *, filters=None,\n                  partitioning=\"hive\", read_dictionary=None, buffer_size=None,\n                  memory_map=False, ignore_prefixes=None, pre_buffer=True,\n                  coerce_int96_timestamp_unit=None, schema=None,\n-                 decryption_properties=None, **kwargs):\n+                 decryption_properties=None, thrift_string_size_limit=None,\n+                 thrift_container_size_limit=None,\n\nReview Comment:\n   I think you need to add it to the signature of `class ParquetDataset.__new__` as well, to pass it through\n\n\n\n",
                    "created": "2022-06-02T14:27:45.612+0000",
                    "updated": "2022-06-02T14:27:45.612+0000",
                    "started": "2022-06-02T14:27:45.611+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "777598",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/777621",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r888047022\n\n\n##########\npython/pyarrow/_dataset_parquet.pyx:\n##########\n@@ -654,17 +668,49 @@ cdef class ParquetFragmentScanOptions(FragmentScanOptions):\n     def pre_buffer(self, bint pre_buffer):\n         self.arrow_reader_properties().set_pre_buffer(pre_buffer)\n \n+    @property\n+    def thrift_string_size_limit(self):\n+        return self.reader_properties().thrift_string_size_limit()\n+\n+    @thrift_string_size_limit.setter\n+    def thrift_string_size_limit(self, size):\n+        if size <= 0:\n+            raise ValueError(\"size must be larger than zero\")\n+        self.reader_properties().set_thrift_string_size_limit(size)\n+\n+    @property\n+    def thrift_container_size_limit(self):\n+        return self.reader_properties().thrift_container_size_limit()\n+\n+    @thrift_container_size_limit.setter\n+    def thrift_container_size_limit(self, size):\n+        if size <= 0:\n+            raise ValueError(\"size must be larger than zero\")\n\nReview Comment:\n   Will do.\n\n\n\n",
                    "created": "2022-06-02T14:54:12.282+0000",
                    "updated": "2022-06-02T14:54:12.282+0000",
                    "started": "2022-06-02T14:54:12.281+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "777621",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/777625",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r888048009\n\n\n##########\npython/pyarrow/parquet/__init__.py:\n##########\n@@ -2258,11 +2269,13 @@ class _ParquetDatasetV2:\n     1       4  Horse  2022\n     \"\"\"\n \n-    def __init__(self, path_or_paths, filesystem=None, filters=None,\n+    def __init__(self, path_or_paths, filesystem=None, *, filters=None,\n                  partitioning=\"hive\", read_dictionary=None, buffer_size=None,\n                  memory_map=False, ignore_prefixes=None, pre_buffer=True,\n                  coerce_int96_timestamp_unit=None, schema=None,\n-                 decryption_properties=None, **kwargs):\n+                 decryption_properties=None, thrift_string_size_limit=None,\n+                 thrift_container_size_limit=None,\n\nReview Comment:\n   Yeah, `pq.read_table` invokes dataset directly.\n\n\n\n",
                    "created": "2022-06-02T14:55:02.585+0000",
                    "updated": "2022-06-02T14:55:02.585+0000",
                    "started": "2022-06-02T14:55:02.585+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "777625",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/777629",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r888058952\n\n\n##########\npython/pyarrow/parquet/__init__.py:\n##########\n@@ -2258,11 +2269,13 @@ class _ParquetDatasetV2:\n     1       4  Horse  2022\n     \"\"\"\n \n-    def __init__(self, path_or_paths, filesystem=None, filters=None,\n+    def __init__(self, path_or_paths, filesystem=None, *, filters=None,\n                  partitioning=\"hive\", read_dictionary=None, buffer_size=None,\n                  memory_map=False, ignore_prefixes=None, pre_buffer=True,\n                  coerce_int96_timestamp_unit=None, schema=None,\n-                 decryption_properties=None, **kwargs):\n+                 decryption_properties=None, thrift_string_size_limit=None,\n+                 thrift_container_size_limit=None,\n\nReview Comment:\n   Ah, yes, I see\n\n\n\n",
                    "created": "2022-06-02T15:05:32.866+0000",
                    "updated": "2022-06-02T15:05:32.866+0000",
                    "started": "2022-06-02T15:05:32.866+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "777629",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778897",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#issuecomment-1148304010\n\n   @github-actions crossbow submit -g cpp\n\n\n",
                    "created": "2022-06-07T07:33:27.673+0000",
                    "updated": "2022-06-07T07:33:27.673+0000",
                    "started": "2022-06-07T07:33:27.673+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778897",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778904",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890880747\n\n\n##########\ncpp/src/parquet/column_reader.cc:\n##########\n@@ -223,14 +223,15 @@ EncodedStatistics ExtractStatsFromHeader(const H& header) {\n class SerializedPageReader : public PageReader {\n  public:\n   SerializedPageReader(std::shared_ptr<ArrowInputStream> stream, int64_t total_num_rows,\n-                       Compression::type codec, ::arrow::MemoryPool* pool,\n+                       Compression::type codec, const ReaderProperties& properties,\n\nReview Comment:\n   is properties a movable type?  should we pass by value and move?\n\n\n\n",
                    "created": "2022-06-07T07:52:12.915+0000",
                    "updated": "2022-06-07T07:52:12.915+0000",
                    "started": "2022-06-07T07:52:12.915+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778904",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778905",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890883558\n\n\n##########\ncpp/src/parquet/metadata.h:\n##########\n@@ -126,6 +126,12 @@ class PARQUET_EXPORT ColumnChunkMetaData {\n       const ApplicationVersion* writer_version = NULLPTR, int16_t row_group_ordinal = -1,\n       int16_t column_ordinal = -1,\n       std::shared_ptr<InternalFileDecryptor> file_decryptor = NULLPTR);\n\nReview Comment:\n   +1 to deprecation.\n\n\n\n",
                    "created": "2022-06-07T07:55:03.170+0000",
                    "updated": "2022-06-07T07:55:03.170+0000",
                    "started": "2022-06-07T07:55:03.170+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778905",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778906",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890885939\n\n\n##########\ncpp/src/parquet/thrift_internal.h:\n##########\n@@ -350,74 +351,84 @@ static inline format::EncryptionAlgorithm ToThrift(EncryptionAlgorithm encryptio\n \n using ThriftBuffer = apache::thrift::transport::TMemoryBuffer;\n \n-// On Thrift 0.14.0+, we want to use TConfiguration to raise the max message size\n-// limit (ARROW-13655).  If we wanted to protect against huge messages, we could\n-// do it ourselves since we know the message size up front.\n+class ThriftDeserializer {\n+ public:\n+  explicit ThriftDeserializer(const ReaderProperties& properties)\n+      : ThriftDeserializer(properties.thrift_string_size_limit(),\n+                           properties.thrift_container_size_limit()) {}\n+\n+  ThriftDeserializer(int32_t string_size_limit, int32_t container_size_limit)\n+      : string_size_limit_(string_size_limit),\n+        container_size_limit_(container_size_limit) {}\n \n-inline std::shared_ptr<ThriftBuffer> CreateReadOnlyMemoryBuffer(uint8_t* buf,\n-                                                                uint32_t len) {\n+  // Deserialize a thrift message from buf/len.  buf/len must at least contain\n+  // all the bytes needed to store the thrift message.  On return, len will be\n+  // set to the actual length of the header.\n+  template <class T>\n+  void DeserializeMessage(const uint8_t* buf, uint32_t* len, T* deserialized_msg,\n+                          const std::shared_ptr<Decryptor>& decryptor = NULLPTR) {\n\nReview Comment:\n   why shared_ptr here?  If this is needed for async operations doesn't a copy of the shared_ptr need to be taken?  If it isn't pass by normal pointer?\n\n\n\n",
                    "created": "2022-06-07T07:57:28.292+0000",
                    "updated": "2022-06-07T07:57:28.292+0000",
                    "started": "2022-06-07T07:57:28.292+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778906",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778908",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890887947\n\n\n##########\npython/pyarrow/_dataset_parquet.pyx:\n##########\n@@ -654,17 +668,49 @@ cdef class ParquetFragmentScanOptions(FragmentScanOptions):\n     def pre_buffer(self, bint pre_buffer):\n         self.arrow_reader_properties().set_pre_buffer(pre_buffer)\n \n+    @property\n+    def thrift_string_size_limit(self):\n+        return self.reader_properties().thrift_string_size_limit()\n+\n+    @thrift_string_size_limit.setter\n+    def thrift_string_size_limit(self, size):\n+        if size <= 0:\n\nReview Comment:\n   should these checks be pushed into C++?\n\n\n\n",
                    "created": "2022-06-07T07:59:28.503+0000",
                    "updated": "2022-06-07T07:59:28.503+0000",
                    "started": "2022-06-07T07:59:28.503+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778908",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778909",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890888658\n\n\n##########\ncpp/src/parquet/column_reader.cc:\n##########\n@@ -223,14 +223,15 @@ EncodedStatistics ExtractStatsFromHeader(const H& header) {\n class SerializedPageReader : public PageReader {\n  public:\n   SerializedPageReader(std::shared_ptr<ArrowInputStream> stream, int64_t total_num_rows,\n-                       Compression::type codec, ::arrow::MemoryPool* pool,\n+                       Compression::type codec, const ReaderProperties& properties,\n\nReview Comment:\n   Yes, we probably can.\n\n\n\n",
                    "created": "2022-06-07T08:00:08.519+0000",
                    "updated": "2022-06-07T08:00:08.519+0000",
                    "started": "2022-06-07T08:00:08.519+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778909",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778910",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890888928\n\n\n##########\ncpp/src/parquet/thrift_internal.h:\n##########\n@@ -350,74 +351,84 @@ static inline format::EncryptionAlgorithm ToThrift(EncryptionAlgorithm encryptio\n \n using ThriftBuffer = apache::thrift::transport::TMemoryBuffer;\n \n-// On Thrift 0.14.0+, we want to use TConfiguration to raise the max message size\n-// limit (ARROW-13655).  If we wanted to protect against huge messages, we could\n-// do it ourselves since we know the message size up front.\n+class ThriftDeserializer {\n+ public:\n+  explicit ThriftDeserializer(const ReaderProperties& properties)\n+      : ThriftDeserializer(properties.thrift_string_size_limit(),\n+                           properties.thrift_container_size_limit()) {}\n+\n+  ThriftDeserializer(int32_t string_size_limit, int32_t container_size_limit)\n+      : string_size_limit_(string_size_limit),\n+        container_size_limit_(container_size_limit) {}\n \n-inline std::shared_ptr<ThriftBuffer> CreateReadOnlyMemoryBuffer(uint8_t* buf,\n-                                                                uint32_t len) {\n+  // Deserialize a thrift message from buf/len.  buf/len must at least contain\n+  // all the bytes needed to store the thrift message.  On return, len will be\n+  // set to the actual length of the header.\n+  template <class T>\n+  void DeserializeMessage(const uint8_t* buf, uint32_t* len, T* deserialized_msg,\n+                          const std::shared_ptr<Decryptor>& decryptor = NULLPTR) {\n\nReview Comment:\n   I see this is just moving around code.\n\n\n\n",
                    "created": "2022-06-07T08:00:23.568+0000",
                    "updated": "2022-06-07T08:00:23.568+0000",
                    "started": "2022-06-07T08:00:23.568+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778910",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778911",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890889197\n\n\n##########\ncpp/src/parquet/thrift_internal.h:\n##########\n@@ -350,74 +351,84 @@ static inline format::EncryptionAlgorithm ToThrift(EncryptionAlgorithm encryptio\n \n using ThriftBuffer = apache::thrift::transport::TMemoryBuffer;\n \n-// On Thrift 0.14.0+, we want to use TConfiguration to raise the max message size\n-// limit (ARROW-13655).  If we wanted to protect against huge messages, we could\n-// do it ourselves since we know the message size up front.\n+class ThriftDeserializer {\n+ public:\n+  explicit ThriftDeserializer(const ReaderProperties& properties)\n+      : ThriftDeserializer(properties.thrift_string_size_limit(),\n+                           properties.thrift_container_size_limit()) {}\n+\n+  ThriftDeserializer(int32_t string_size_limit, int32_t container_size_limit)\n+      : string_size_limit_(string_size_limit),\n+        container_size_limit_(container_size_limit) {}\n \n-inline std::shared_ptr<ThriftBuffer> CreateReadOnlyMemoryBuffer(uint8_t* buf,\n-                                                                uint32_t len) {\n+  // Deserialize a thrift message from buf/len.  buf/len must at least contain\n+  // all the bytes needed to store the thrift message.  On return, len will be\n+  // set to the actual length of the header.\n+  template <class T>\n+  void DeserializeMessage(const uint8_t* buf, uint32_t* len, T* deserialized_msg,\n+                          const std::shared_ptr<Decryptor>& decryptor = NULLPTR) {\n\nReview Comment:\n   It is just the original signature in the previous code, but I can change it.\n\n\n\n",
                    "created": "2022-06-07T08:00:43.653+0000",
                    "updated": "2022-06-07T08:00:43.653+0000",
                    "started": "2022-06-07T08:00:43.653+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778911",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778912",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#discussion_r890889476\n\n\n##########\npython/pyarrow/_dataset_parquet.pyx:\n##########\n@@ -654,17 +668,49 @@ cdef class ParquetFragmentScanOptions(FragmentScanOptions):\n     def pre_buffer(self, bint pre_buffer):\n         self.arrow_reader_properties().set_pre_buffer(pre_buffer)\n \n+    @property\n+    def thrift_string_size_limit(self):\n+        return self.reader_properties().thrift_string_size_limit()\n+\n+    @thrift_string_size_limit.setter\n+    def thrift_string_size_limit(self, size):\n+        if size <= 0:\n\nReview Comment:\n   We don't seem to validate Parquet properties values on the C++ side. \n\n\n\n",
                    "created": "2022-06-07T08:00:59.764+0000",
                    "updated": "2022-06-07T08:00:59.764+0000",
                    "started": "2022-06-07T08:00:59.764+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778912",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778914",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#issuecomment-1148332322\n\n   > any plans to add a sample file with overrides that would pass/fail to verify end-to-end functionality (sorry if I missed this)\r\n   \r\n   The Python tests generate such a file on the fly.\n\n\n",
                    "created": "2022-06-07T08:02:38.859+0000",
                    "updated": "2022-06-07T08:02:38.859+0000",
                    "started": "2022-06-07T08:02:38.859+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778914",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778916",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #13275:\nURL: https://github.com/apache/arrow/pull/13275#issuecomment-1148335033\n\n   Revision: c47ddb6ac26d6916e07e0aa84596e81c797bba65\n   \n   Submitted crossbow builds: [ursacomputing/crossbow @ actions-1775fb24b1](https://github.com/ursacomputing/crossbow/branches/all?query=actions-1775fb24b1)\n   \n   |Task|Status|\n   |----|------|\n   |test-build-cpp-fuzz|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-build-cpp-fuzz)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-build-cpp-fuzz)|\n   |test-conda-cpp|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-conda-cpp)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-conda-cpp)|\n   |test-conda-cpp-valgrind|[![Azure](https://dev.azure.com/ursacomputing/crossbow/_apis/build/status/ursacomputing.crossbow?branchName=actions-1775fb24b1-azure-test-conda-cpp-valgrind)](https://dev.azure.com/ursacomputing/crossbow/_build/latest?definitionId=1&branchName=actions-1775fb24b1-azure-test-conda-cpp-valgrind)|\n   |test-debian-10-cpp-amd64|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-debian-10-cpp-amd64)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-debian-10-cpp-amd64)|\n   |test-debian-10-cpp-i386|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-debian-10-cpp-i386)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-debian-10-cpp-i386)|\n   |test-debian-11-cpp-amd64|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-debian-11-cpp-amd64)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-debian-11-cpp-amd64)|\n   |test-debian-11-cpp-i386|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-debian-11-cpp-i386)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-debian-11-cpp-i386)|\n   |test-fedora-35-cpp|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-fedora-35-cpp)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-fedora-35-cpp)|\n   |test-ubuntu-18.04-cpp|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-18.04-cpp)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-18.04-cpp)|\n   |test-ubuntu-18.04-cpp-release|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-18.04-cpp-release)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-18.04-cpp-release)|\n   |test-ubuntu-18.04-cpp-static|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-18.04-cpp-static)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-18.04-cpp-static)|\n   |test-ubuntu-20.04-cpp|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-20.04-cpp)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-20.04-cpp)|\n   |test-ubuntu-20.04-cpp-14|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-20.04-cpp-14)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-20.04-cpp-14)|\n   |test-ubuntu-20.04-cpp-17|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-20.04-cpp-17)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-20.04-cpp-17)|\n   |test-ubuntu-20.04-cpp-bundled|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-20.04-cpp-bundled)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-20.04-cpp-bundled)|\n   |test-ubuntu-20.04-cpp-thread-sanitizer|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-20.04-cpp-thread-sanitizer)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-20.04-cpp-thread-sanitizer)|\n   |test-ubuntu-22.04-cpp|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-1775fb24b1-github-test-ubuntu-22.04-cpp)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-1775fb24b1-github-test-ubuntu-22.04-cpp)|\n\n\n",
                    "created": "2022-06-07T08:05:14.683+0000",
                    "updated": "2022-06-07T08:05:14.683+0000",
                    "started": "2022-06-07T08:05:14.682+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778916",
                    "issueId": "13444645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/worklog/778998",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou merged PR #13275:\nURL: https://github.com/apache/arrow/pull/13275\n\n\n",
                    "created": "2022-06-07T11:29:08.460+0000",
                    "updated": "2022-06-07T11:29:08.460+0000",
                    "started": "2022-06-07T11:29:08.459+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "778998",
                    "issueId": "13444645"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 12600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3734ce16[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@572bf752[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@701ef996[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@788711a0[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3db62ab0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@23c6f36[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e9f4ae[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4523efa2[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@494cbe1c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@28e82ddc[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@62eef0eb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@386a4deb[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12600,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jun 07 11:29:08 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-06-07T11:29:08.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16546/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2022-05-12T15:02:55.000+0000",
        "updated": "2022-06-07T14:20:18.000+0000",
        "timeoriginalestimate": null,
        "description": "When loading parquet file \"OSError: Couldn't deserialize thrift: TProtocolException: Exceeded size limit\" is raised. This seems to be related to memory usage of table header. The issue may be coming from C code part. Also pyarrow 0.16 version is capable to read that parquet file.\r\n\r\nBelow is code snippet to reproduce the issue. Screenshot of jupyter-notebook with more details is in attachments.\r\n\r\nCode snippet creates 2 pandas dataframes which only differ in column names. One with short column names is stored and read without problem while the other dataframe with long column names is stored but raises Exception during reading.\r\n\r\n\r\n{code:java}\r\nimport pandas as pd\r\nimport numpy as np\r\n\r\ndata = np.random.randn(10, 250000)\r\nindex = range(10)\r\nshort_column_names = [f\"col_{i}\" for i in range(250000)]\r\nlong_column_names = [f\"some_really_long_column_name_ending_with_integer_number_{i}\" for i in range(250000)]\r\n\r\ndf_short_cols = pd.DataFrame(columns=short_column_names, data=data, index=index)\r\ndf_long_cols = pd.DataFrame(columns=long_column_names, data=data, index=index)# Identical dataframes only column names are different\r\n\r\n# Storing dataframe with long column names works OK but reading fails\r\ndf_long_cols.to_parquet(\"long_cols.parquet\", engine=\"pyarrow\") # Storing works\r\ndf_long_cols_loaded = pd.read_parquet(\"long_cols.parquet\", engine=\"pyarrow\") # <--- Fails here{code}\r\n\u00a0\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/13043584",
                "id": "13043584",
                "filename": "Screenshot from 2022-05-12 16-59-10.png",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=urmanbm",
                    "name": "urmanbm",
                    "key": "JIRAUSER289400",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                    },
                    "displayName": "Boris Urman",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2022-05-12T14:59:37.344+0000",
                "size": 887666,
                "mimeType": "image/png",
                "content": "https://issues.apache.org/jira/secure/attachment/13043584/Screenshot+from+2022-05-12+16-59-10.png"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Pyarrow fails to loads parquet file with long column names",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "Ubuntu 20.04, pandas 1.4.2",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/comment/17536262",
                    "id": "17536262",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "There are limits in place to avoid space/time bombs using Parquet files, but we need to make these limits configurable:\r\nhttps://github.com/apache/arrow/blob/90aac16761b7dbf5fe931bc8837cad5116939270/cpp/src/parquet/thrift_internal.h#L388-L394\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-05-12T17:45:44.768+0000",
                    "updated": "2022-05-12T17:45:44.768+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/comment/17538109",
                    "id": "17538109",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "We had another issue in the past about too large metadata (ARROW-13655), but I suppose that was about the total message size",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-05-17T10:53:20.206+0000",
                    "updated": "2022-05-17T10:53:20.206+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13444645/comment/17550946",
                    "id": "17550946",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 13275\n[https://github.com/apache/arrow/pull/13275]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-06-07T11:29:08.757+0000",
                    "updated": "2022-06-07T11:29:08.757+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z12b68:",
        "customfield_12314139": null
    }
}