{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13422281",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281",
    "key": "ARROW-15312",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "dataset",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350712",
                "id": "12350712",
                "description": "",
                "name": "6.0.1",
                "archived": false,
                "released": true,
                "releaseDate": "2021-11-18"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12633413",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12633413",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13412072",
                    "key": "ARROW-14725",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13412072",
                    "fields": {
                        "summary": "[C++][Compute] Extract Expression simplification passes to an extensible registry",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            },
            {
                "id": "12633412",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12633412",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13376844",
                    "key": "ARROW-12659",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13376844",
                    "fields": {
                        "summary": "[C++][Compute] Support SimplifyWithGuarantee(is_null(foo), is_valid(foo))",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
            "name": "jonkeane",
            "key": "jonkeane",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Jonathan Keane",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Pierre+Gramme",
            "name": "Pierre Gramme",
            "key": "pierre gramme",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Pierre Gramme",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Pierre+Gramme",
            "name": "Pierre Gramme",
            "key": "pierre gramme",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Pierre Gramme",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 3600,
            "total": 3600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 3600,
            "total": 3600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15312/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 6,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/760344",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane opened a new pull request, #12950:\nURL: https://github.com/apache/arrow/pull/12950\n\n   The real fix was in https://github.com/apache/arrow/pull/12891 ([ARROW-12659](https://issues.apache.org/jira/browse/ARROW-12659)) but this adds integration tests from the ticket to confirm this works in R + we don't run into this in the future\n\n\n",
                    "created": "2022-04-21T19:22:06.527+0000",
                    "updated": "2022-04-21T19:22:06.527+0000",
                    "started": "2022-04-21T19:22:06.527+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "760344",
                    "issueId": "13422281"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/760423",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #12950:\nURL: https://github.com/apache/arrow/pull/12950#issuecomment-1105751337\n\n   https://issues.apache.org/jira/browse/ARROW-15312\n\n\n",
                    "created": "2022-04-21T20:56:33.880+0000",
                    "updated": "2022-04-21T20:56:33.880+0000",
                    "started": "2022-04-21T20:56:33.880+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "760423",
                    "issueId": "13422281"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/760765",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #12950:\nURL: https://github.com/apache/arrow/pull/12950#discussion_r856153177\n\n\n##########\nr/tests/testthat/test-dataset.R:\n##########\n@@ -966,3 +966,29 @@ test_that(\"dataset to C-interface to arrow_dplyr_query with proj/filter\", {\n   # must clean up the pointer or we leak\n   delete_arrow_array_stream(stream_ptr)\n })\n+\n+\n+test_that(\"Filter parquet dataset with is.na ARROW-15312\", {\n+  ds_path <- make_temp_dir()\n+\n+  df <- tibble(x = 1:3, y = c(0L, 0L, NA_integer_), z = c(0L, 1L, NA_integer_))\n+  write_dataset(df, ds_path)\n+\n+  # OK: Collect then filter: returns row 3, as expected\n+  expect_identical(\n+    open_dataset(ds_path) %>% collect() %>% filter(is.na(y)),\n+    df %>% collect() %>% filter(is.na(y))\n+  )\n+\n+  # ERROR: Filter then collect (on y) returns a tibble with no row\n\nReview Comment:\n   ```suggestion\r\n     # Before the fix: Filter then collect (on y) returned a tibble with no row\r\n   ```\n\n\n\n",
                    "created": "2022-04-22T11:50:27.140+0000",
                    "updated": "2022-04-22T11:50:27.140+0000",
                    "started": "2022-04-22T11:50:27.140+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "760765",
                    "issueId": "13422281"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/760766",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #12950:\nURL: https://github.com/apache/arrow/pull/12950#discussion_r856153177\n\n\n##########\nr/tests/testthat/test-dataset.R:\n##########\n@@ -966,3 +966,29 @@ test_that(\"dataset to C-interface to arrow_dplyr_query with proj/filter\", {\n   # must clean up the pointer or we leak\n   delete_arrow_array_stream(stream_ptr)\n })\n+\n+\n+test_that(\"Filter parquet dataset with is.na ARROW-15312\", {\n+  ds_path <- make_temp_dir()\n+\n+  df <- tibble(x = 1:3, y = c(0L, 0L, NA_integer_), z = c(0L, 1L, NA_integer_))\n+  write_dataset(df, ds_path)\n+\n+  # OK: Collect then filter: returns row 3, as expected\n+  expect_identical(\n+    open_dataset(ds_path) %>% collect() %>% filter(is.na(y)),\n+    df %>% collect() %>% filter(is.na(y))\n+  )\n+\n+  # ERROR: Filter then collect (on y) returns a tibble with no row\n\nReview Comment:\n   ```suggestion\r\n     # Before the fix: Filter then collect on y returned a 0-row tibble\r\n   ```\n\n\n\n",
                    "created": "2022-04-22T11:51:12.185+0000",
                    "updated": "2022-04-22T11:51:12.185+0000",
                    "started": "2022-04-22T11:51:12.185+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "760766",
                    "issueId": "13422281"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/760767",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #12950: ARROW-15312: [R][C++] filtering a Parquet dataset with is.na() misses some rows\nURL: https://github.com/apache/arrow/pull/12950\n\n\n",
                    "created": "2022-04-22T11:51:44.135+0000",
                    "updated": "2022-04-22T11:51:44.135+0000",
                    "started": "2022-04-22T11:51:44.135+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "760767",
                    "issueId": "13422281"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/worklog/761740",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on PR #12950:\nURL: https://github.com/apache/arrow/pull/12950#issuecomment-1108490042\n\n   Benchmark runs are scheduled for baseline = a6296cb53d2a2a05d3dac49152a2db7aee8953ba and contender = 285667cc88e22433c72842f1a37f1f95cccff656. 285667cc88e22433c72842f1a37f1f95cccff656 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/6078fffdad204ac3a9a4c692b9bd299c...d560ea2e7d954668bca6dcedba1a5eba/)\n   [Failed] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a3363e99659b423fa87128e97fdf7c1f...ce11ba31a80b4f099d8a07a7eebea61a/)\n   [Failed :arrow_down:4.14% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/31b1f0171e9e479286b9ee282b691eee...0a478d0e592d4caf99c000e84a2b8242/)\n   [Finished :arrow_down:0.84% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/5fa54bd5bf124681a161ce9b6b28d190...9630b1f38dbb45c0a55b03806fcd5065/)\n   Buildkite builds:\n   [Finished] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/584| `285667cc` ec2-t3-xlarge-us-east-2>\n   [Failed] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/572| `285667cc` test-mac-arm>\n   [Failed] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/570| `285667cc` ursa-i9-9960x>\n   [Finished] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/582| `285667cc` ursa-thinkcentre-m75q>\n   [Finished] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/583| `a6296cb5` ec2-t3-xlarge-us-east-2>\n   [Failed] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/571| `a6296cb5` test-mac-arm>\n   [Failed] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/569| `a6296cb5` ursa-i9-9960x>\n   [Finished] <https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/581| `a6296cb5` ursa-thinkcentre-m75q>\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python, R. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n",
                    "created": "2022-04-25T12:11:10.268+0000",
                    "updated": "2022-04-25T12:11:10.268+0000",
                    "started": "2022-04-25T12:11:10.267+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761740",
                    "issueId": "13422281"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 3600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@552d099b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@51338f69[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@63a12d28[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2e24bef2[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@409f5864[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7265f6a4[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@18475dad[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@139fb379[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@29798516[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@74f4864b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@56fc174d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@38967290[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 3600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Apr 22 11:51:44 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": [
            "C++",
            "R"
        ],
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-04-22T11:51:44.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15312/watchers",
            "watchCount": 6,
            "isWatching": false
        },
        "created": "2022-01-12T16:21:27.000+0000",
        "updated": "2022-04-25T12:11:10.000+0000",
        "timeoriginalestimate": null,
        "description": "Hi !\r\n\r\nI just found an issue when querying an Arrow dataset with dplyr, filtering on is.na(...)\r\n\r\nIt seems linked to columns containing only one distinct value and some NA's.\r\n\r\nCan you also reproduce the following?\r\n\r\n\u00a0\r\n{code:java}\r\n  library(arrow)\r\n\u00a0 library(dplyr)\r\n\u00a0\u00a0\r\n\u00a0 ds_path = \"test-arrow-na\"\r\n\u00a0 df = tibble(x=1:3, y=c(0L, 0L, NA_integer_), z=c(0L, 1L, NA_integer_))\r\n\u00a0\u00a0\r\n\u00a0 df %>% arrow::write_dataset(ds_path)\r\n\u00a0\u00a0\r\n\u00a0 # OK: Collect then filter: returns row 3, as expected\r\n\u00a0 arrow::open_dataset(ds_path) %>% collect() %>% filter(is.na(y))\r\n\r\n  # ERROR: Filter then collect (on y) returns a tibble with no row\r\n\u00a0 arrow::open_dataset(ds_path) %>% filter(is.na(y)) %>% collect()\r\n\u00a0\u00a0\r\n\u00a0 # OK: Filter then collect (on z) returns row 3, as expected\r\n\u00a0 arrow::open_dataset(ds_path) %>% filter(is.na(z)) %>% collect() {code}\r\n\u00a0\r\n\r\nThanks\r\n\r\nPierre",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 3600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R][C++] filtering a Parquet dataset with is.na() misses some rows",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "R 4.1.2 on Windows\r\narrow 6.0.1\r\ndplyr 1.0.7",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17482567",
                    "id": "17482567",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "Thanks for reporting this [~Pierre Gramme] !\u00a0\r\n\r\nI am able to reproduce this bug on the dev version of Arrow, and it seems to be something to do with how this is being executed on datasets as I get the correct results if I then run:\r\n{code:java}\r\narrow::read_parquet(\"test-arrow-na/part-0.parquet\", as_data_frame = FALSE) %>%\r\n\u00a0 filter(is.na(y)) %>%\r\n\u00a0 collect() {code}\r\nI'll see if anyone else has any idea what's going on here.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2022-01-26T15:29:43.458+0000",
                    "updated": "2022-01-26T15:29:43.458+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17482584",
                    "id": "17482584",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "Here are the results with both code and output:\r\n\r\n{code:r}\r\nlibrary(arrow)\r\n#>\u00a0\r\n#> Attaching package: 'arrow'\r\n#> The following object is masked from 'package:utils':\r\n#>\u00a0\r\n#> \u00a0 \u00a0 timestamp\r\n\r\nlibrary(dplyr)\r\n#>\u00a0\r\n#> Attaching package: 'dplyr'\r\n#> The following objects are masked from 'package:stats':\r\n#>\u00a0\r\n#> \u00a0 \u00a0 filter, lag\r\n#> The following objects are masked from 'package:base':\r\n#>\u00a0\r\n#> \u00a0 \u00a0 intersect, setdiff, setequal, unionds_path = \"test-arrow-na\"\r\n\r\ndf = tibble(x=1:3, y=c(0L, 0L, NA_integer_), z=c(0L, 1L, NA_integer_))df %>%\r\n    arrow::write_dataset(ds_path)\r\n\r\n# OK: Collect then filter: returns row 3, as expected\r\narrow::open_dataset(ds_path) %>% collect() %>% filter(is.na(y))\r\n#> # A tibble: 1 \u00d7 3\r\n#> \u00a0 \u00a0 \u00a0 x \u00a0 \u00a0 y \u00a0 \u00a0 z\r\n#> \u00a0 <int> <int> <int>\r\n#> 1 \u00a0 \u00a0 3 \u00a0 \u00a0NA \u00a0 \u00a0NA\r\n\r\n# ERROR: Filter then collect (on y) returns a tibble with no row\r\narrow::open_dataset(ds_path) %>% filter(is.na(y)) %>% collect()\r\n#> # A tibble: 0 \u00d7 3\r\n#> # \u2026 with 3 variables: x <int>, y <int>, z <int>\r\n\r\n# OK: Filter then collect (on z) returns row 3, as expected\r\narrow::open_dataset(ds_path) %>% filter(is.na(z)) %>% collect()\u00a0\r\n#> # A tibble: 1 \u00d7 3\r\n#> \u00a0 \u00a0 \u00a0 x \u00a0 \u00a0 y \u00a0 \u00a0 z\r\n#> \u00a0 <int> <int> <int>\r\n#> 1 \u00a0 \u00a0 3 \u00a0 \u00a0NA \u00a0 \u00a0NA\r\n\r\n# This is as expected\r\narrow::read_parquet(\"test-arrow-na/part-0.parquet\", as_data_frame = FALSE) %>%\r\n\u00a0 filter(is.na(y)) %>%\r\n\u00a0 collect()\r\n#> # A tibble: 1 \u00d7 3\r\n#> \u00a0 \u00a0 \u00a0 x \u00a0 \u00a0 y \u00a0 \u00a0 z\r\n#> \u00a0 <int> <int> <int>\r\n#> 1 \u00a0 \u00a0 3 \u00a0 \u00a0NA \u00a0 \u00a0NA\r\n\r\n {code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2022-01-26T15:46:22.882+0000",
                    "updated": "2022-01-26T15:46:22.882+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17482600",
                    "id": "17482600",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "After further investigation, it looks a lot like this is to do with the number of unique values in a column; if there is only 1 unique value other than NA, nothing is returned; see the smaller reprex below.\r\n\r\n\r\n{code:r}\r\nlibrary(arrow)\r\n#> \r\n#> Attaching package: 'arrow'\r\n#> The following object is masked from 'package:utils':\r\n#> \r\n#>     timestamp\r\nlibrary(dplyr)\r\n#> \r\n#> Attaching package: 'dplyr'\r\n#> The following objects are masked from 'package:stats':\r\n#> \r\n#>     filter, lag\r\n#> The following objects are masked from 'package:base':\r\n#> \r\n#>     intersect, setdiff, setequal, union\r\n\r\nds_path = tempfile()\r\ndir.create(ds_path)\r\n\r\ndf = tibble(y=c(\"hi\", \"hi\", NA_character_))\r\n\r\ndf %>% arrow::write_dataset(ds_path)\r\n\r\narrow::open_dataset(ds_path) %>% collect() %>% filter(is.na(y))\r\n#> # A tibble: 1 \u00d7 1\r\n#>   y    \r\n#>   <chr>\r\n#> 1 <NA>\r\n\r\narrow::open_dataset(ds_path) %>% filter(is.na(y)) %>% collect()\r\n#> # A tibble: 0 \u00d7 1\r\n#> # \u2026 with 1 variable: y <chr>\r\n\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2022-01-26T16:20:12.425+0000",
                    "updated": "2022-01-26T16:20:12.425+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17482644",
                    "id": "17482644",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "This appears to be restricted to Parquet format as there are no issues with Feather or CSV:\r\n\r\n\r\n{code:r}\r\nlibrary(arrow)\r\nlibrary(dplyr)\r\n \r\nds_path <- tempfile()\r\ndir.create(ds_path)\r\n\r\ndf <- tibble(\r\n  y = c(0L, 0L, NA_integer_),\r\n  z = c(0L, 1L, NA_integer_)\r\n)\r\n\r\ndf %>% arrow::write_dataset(ds_path, format = \"feather\")\r\n\r\narrow::open_dataset(ds_path, format = \"feather\") %>% collect() %>% filter(is.na(y))\r\n#> # A tibble: 1 \u00d7 2\r\n#>       y     z\r\n#>   <int> <int>\r\n#> 1    NA    NA\r\n\r\narrow::open_dataset(ds_path, format = \"feather\") %>% filter(is.na(y)) %>% collect()\r\n#> # A tibble: 1 \u00d7 2\r\n#>       y     z\r\n#>   <int> <int>\r\n#> 1    NA    NA\r\n\r\nds_path = tempfile()\r\ndir.create(ds_path)\r\n\r\ndf %>% arrow::write_dataset(ds_path, format = \"csv\")\r\n\r\narrow::open_dataset(ds_path, format = \"csv\") %>% collect() %>% filter(is.na(y))\r\n#> # A tibble: 1 \u00d7 2\r\n#>       y     z\r\n#>   <int> <int>\r\n#> 1    NA    NA\r\n\r\narrow::open_dataset(ds_path, format = \"csv\") %>% filter(is.na(y)) %>% collect()\r\n#> # A tibble: 1 \u00d7 2\r\n#>       y     z\r\n#>   <int> <int>\r\n#> 1    NA    NA\r\n\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2022-01-26T17:42:12.483+0000",
                    "updated": "2022-01-26T17:42:12.483+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17484718",
                    "id": "17484718",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "body": "Seems related to the filter pushdown into the Parquet reader! If we write Parquet with {{write_statistics = FALSE}} we can trigger this too.\r\n\r\n{code:R}\r\nlibrary(arrow, warn.conflicts = FALSE)\r\nlibrary(dplyr, warn.conflicts = FALSE)\r\n\r\npath <- tempfile()\r\ndf <- tibble(\r\n  integers = 1:3, \r\n  col_with_na_and_one_val = c(0L, 0L, NA_integer_)\r\n)\r\n\r\n# should return one row\r\nwrite_parquet(df, path, write_statistics = TRUE)\r\nopen_dataset(path) %>% \r\n  filter(is.na(col_with_na_and_one_val))  %>% \r\n  collect()\r\n#> # A tibble: 0 \u00d7 2\r\n#> # \u2026 with 2 variables: integers <int>, col_with_na_and_one_val <int>\r\n\r\nwrite_parquet(df, path, write_statistics = FALSE)\r\nopen_dataset(path) %>% \r\n  filter(is.na(col_with_na_and_one_val))  %>% \r\n  collect()\r\n#> # A tibble: 1 \u00d7 2\r\n#>   integers col_with_na_and_one_val\r\n#>      <int>                   <int>\r\n#> 1        3                      NA\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "created": "2022-01-31T14:45:39.928+0000",
                    "updated": "2022-01-31T14:45:39.928+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17491423",
                    "id": "17491423",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I did some debugging for the projection pushdown. With statistics enabled, the row group has the guarantee {{(col_with_na_and_one_val == 0)}} and the predicate being tested is {{is_null(col_with_na_and_one_val, \\{nan_is_null=true})}}. The way simplification works is that there's a pass that extracts a map of field-value pairs from equality expressions. Hence, the simplification pass thinks that {{col_with_na_and_one_val}} can only be zero, i.e. it can't be null, and {{is_null(col_with_na_and_one_val)}} gets simplified to {{false}} and the row group is pruned. The main issue is then that we aren't properly accounting for nullability in both generating guarantees based on row group statistics and in simplification.\r\n\r\n(FWIW, this doesn't affect any other formats since we don't have predicate pushdown in the first place.)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-12T18:13:07.359+0000",
                    "updated": "2022-02-12T18:18:20.343+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17491424",
                    "id": "17491424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Also see https://github.com/apache/arrow/pull/10253#issuecomment-833005335 which is another instance of this problem.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-12T18:14:50.204+0000",
                    "updated": "2022-02-12T18:14:50.204+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17491425",
                    "id": "17491425",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I think basically we need to pick up and finish https://github.com/apache/arrow/pull/10253. We should also rigorously construct and document how we want to treat guarantees since we're playing fast and loose with them right now and that is leading to wrong results like this.\r\n\r\nCC [~westonpace], [~bkietz]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-12T18:16:00.590+0000",
                    "updated": "2022-02-12T18:16:00.590+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17491426",
                    "id": "17491426",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "(And thanks Nic and Dewey for those reprexes, those helped narrow it down a lot!)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-12T18:16:38.955+0000",
                    "updated": "2022-02-12T18:16:38.955+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17491427",
                    "id": "17491427",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "ARROW-14725 is also somewhat related (https://github.com/apache/arrow/pull/11716) since it refactors how simplification works (though it doesn't address this particular problem)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-12T18:19:04.799+0000",
                    "updated": "2022-02-12T18:19:04.799+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17522434",
                    "id": "17522434",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "https://github.com/apache/arrow/pull/12891 (ARROW-12659) \r\nadds a regression test for this.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-04-14T17:03:58.973+0000",
                    "updated": "2022-04-14T17:03:58.973+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13422281/comment/17526348",
                    "id": "17526348",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 12950\n[https://github.com/apache/arrow/pull/12950]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-04-22T11:51:44.329+0000",
                    "updated": "2022-04-22T11:51:44.329+0000"
                }
            ],
            "maxResults": 12,
            "total": 12,
            "startAt": 0
        },
        "customfield_12311820": "0|z0yips:",
        "customfield_12314139": null
    }
}