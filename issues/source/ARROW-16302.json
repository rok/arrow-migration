{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13441386",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386",
    "key": "ARROW-16302",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351550",
                "id": "12351550",
                "name": "9.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-08-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "bug",
            "partitioning",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12644682",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12644682",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13472775",
                    "key": "ARROW-17174",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13472775",
                    "fields": {
                        "summary": "[C++] FileSystemDataset FilenamePartitioning error - fsspec filesystem",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sanjibansg",
            "name": "sanjibansg",
            "key": "JIRAUSER282926",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Sanjiban Sengupta",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sanjibansg",
            "name": "sanjibansg",
            "key": "JIRAUSER282926",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Sanjiban Sengupta",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sanjibansg",
            "name": "sanjibansg",
            "key": "JIRAUSER282926",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Sanjiban Sengupta",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "aggregateprogress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16302/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 35,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761532",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg opened a new pull request, #12977:\nURL: https://github.com/apache/arrow/pull/12977\n\n   This PR fixes the issue of the partitioning field having null values while using FilenamePartitioning. \r\n   For FilenamePartitioning, we should only remove the prefix and thus should not use `StripPrefixAndFilename()`, which will remove the filename too along with the prefix.\n\n\n",
                    "created": "2022-04-24T23:06:01.562+0000",
                    "updated": "2022-04-24T23:06:01.562+0000",
                    "started": "2022-04-24T23:06:01.561+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761532",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761533",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#issuecomment-1107935615\n\n   https://issues.apache.org/jira/browse/ARROW-16302\n\n\n",
                    "created": "2022-04-24T23:06:22.184+0000",
                    "updated": "2022-04-24T23:06:22.184+0000",
                    "started": "2022-04-24T23:06:22.183+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761533",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761792",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857616730\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   I wonder if we should make it the responsibility of the partitioning implementation to strip the filename, instead of hardcoding an exception. (After all, what if the user wants to define a custom filename-based partitioning scheme?) Or we could pass both the path and the filename separately to `partitioning->Parse`.\n\n\n\n",
                    "created": "2022-04-25T13:19:45.987+0000",
                    "updated": "2022-04-25T13:19:45.987+0000",
                    "started": "2022-04-25T13:19:45.987+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761792",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761843",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857740111\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   So, it's like passing the entire `info.path()` in the `Parse()` method and then various partitioning implementations will do it in the way they want?\n\n\n\n",
                    "created": "2022-04-25T15:12:07.595+0000",
                    "updated": "2022-04-25T15:12:07.595+0000",
                    "started": "2022-04-25T15:12:07.594+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761843",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761846",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857740111\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   So, it's like passing the entire `info.path()` in the `Parse()` method and then various partitioning implementations will do it in the way they want? I think we can then strip the prefix/filename in the `ParseKeys` method of each of the partitioning modes.\n\n\n\n",
                    "created": "2022-04-25T15:18:33.420+0000",
                    "updated": "2022-04-25T15:18:33.420+0000",
                    "started": "2022-04-25T15:18:33.419+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761846",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761848",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857748824\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   Yeah, I think we can still strip the prefix, but we can let the partitioning handle the rest. \r\n   \r\n   And in that case it might make sense to split the remainder of the path and the filename for the partitioning implementation too and just pass both as arguments. \n\n\n\n",
                    "created": "2022-04-25T15:20:03.726+0000",
                    "updated": "2022-04-25T15:20:03.726+0000",
                    "started": "2022-04-25T15:20:03.726+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761848",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761849",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857749287\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   (We should still strip the prefix since presumably we don't want partitioning to depend on the prefix itself.)\n\n\n\n",
                    "created": "2022-04-25T15:20:28.753+0000",
                    "updated": "2022-04-25T15:20:28.753+0000",
                    "started": "2022-04-25T15:20:28.753+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761849",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761918",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857857993\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   We may pass both the filename and the path(other than the prefix) to the `Parse()` method, but the filename is only required for FilenamePartitioning I believe, and the path will be required by the Directory & Hive Partitioning.\n\n\n\n",
                    "created": "2022-04-25T17:20:24.391+0000",
                    "updated": "2022-04-25T17:20:24.391+0000",
                    "started": "2022-04-25T17:20:24.391+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761918",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/761923",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r857860950\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   Sure. From the point of view of datasets however it doesn't matter that some implementations only need some of the info.\r\n   \r\n   CC @westonpace for thoughts\n\n\n\n",
                    "created": "2022-04-25T17:24:14.698+0000",
                    "updated": "2022-04-25T17:24:14.698+0000",
                    "started": "2022-04-25T17:24:14.698+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "761923",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/762517",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r859106787\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   With the latest change, I modified the `StripPrefixAndFIlename()` method to return a `PartitionPathFormat` object which will contain both the directory and filename prefix and then passing that to the `Parse()` method which now expects both the directory and filename-prefix. \r\n   \r\n   We can modify the `Parse()` method as well to accept an object of `PartitionPathFormat` that way it will be symmetrical to the `Format()` method. But then, we need to implement similar changes to PyArrow, and I believe then to use the `partitioning.parse()` method in PyArrow we have to define an object of the `PartitionPathFormat` first. \n\n\n\n",
                    "created": "2022-04-26T20:14:20.185+0000",
                    "updated": "2022-04-26T20:14:20.185+0000",
                    "started": "2022-04-26T20:14:20.185+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "762517",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/762519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r859106787\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   With the latest change, I modified the `StripPrefixAndFilename()` method to return a `PartitionPathFormat` object which will contain both the directory and filename prefix and then passing that to the `Parse()` method which now expects both the directory and filename-prefix. \r\n   \r\n   We can modify the `Parse()` method as well to accept an object of `PartitionPathFormat` that way it will be symmetrical to the `Format()` method. But then, we need to implement similar changes to PyArrow, and I believe then to use the `partitioning.parse()` method in PyArrow we have to define an object of the `PartitionPathFormat` first. \n\n\n\n",
                    "created": "2022-04-26T20:14:35.388+0000",
                    "updated": "2022-04-26T20:14:35.388+0000",
                    "started": "2022-04-26T20:14:35.388+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "762519",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/762520",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r859106787\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,8 +278,13 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n   for (const auto& info : files_) {\n-    auto fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    if (partitioning->type_name() == \"filename\") {\n+      fixed_path = StripPrefix(info.path(), options_.partition_base_dir);\n+    } else {\n+      fixed_path = StripPrefixAndFilename(info.path(), options_.partition_base_dir);\n+    }\n\nReview Comment:\n   With the latest change, I modified the `StripPrefixAndFilename()` method to return a `PartitionPathFormat` object which will contain both the directory and filename prefix and then passing that to the `Parse()` method which now expects both the directory and filename-prefix. \r\n   \r\n   We can modify the `Parse()` method as well to accept an object of `PartitionPathFormat` that way it will be symmetrical to the `Format()` method. But then, we need to implement similar changes to PyArrow, and I believe then we have to define an object of `PartitionPathFormat` first to use the `partitioning.parse()` method in PyArrow.\n\n\n\n",
                    "created": "2022-04-26T20:16:10.492+0000",
                    "updated": "2022-04-26T20:16:10.492+0000",
                    "started": "2022-04-26T20:16:10.492+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "762520",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/762840",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r859144782\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -38,6 +38,10 @@ namespace dataset {\n \n constexpr char kFilenamePartitionSep = '_';\n \n+struct PartitionPathFormat {\n\nReview Comment:\n   ```suggestion\r\n   struct ARROW_DS_EXPORT PartitionPathFormat {\r\n   ```\n\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -76,11 +80,8 @@ class ARROW_DS_EXPORT Partitioning {\n       const std::shared_ptr<RecordBatch>& batch) const = 0;\n \n   /// \\brief Parse a path into a partition expression\n-  virtual Result<compute::Expression> Parse(const std::string& path) const = 0;\n-\n-  struct PartitionPathFormat {\n-    std::string directory, prefix;\n-  };\n+  virtual Result<compute::Expression> Parse(const std::string& directory = \"\",\n+                                            const std::string& prefix = \"\") const = 0;\n\nReview Comment:\n   Why do we need the default parameter values?\n\n\n\n##########\ncpp/src/arrow/dataset/file_parquet.cc:\n##########\n@@ -847,7 +847,8 @@ ParquetDatasetFactory::CollectParquetFragments(const Partitioning& partitioning)\n     auto row_groups = Iota(metadata_subset->num_row_groups());\n \n     auto partition_expression =\n-        partitioning.Parse(StripPrefixAndFilename(path, options_.partition_base_dir))\n+        partitioning\n+            .Parse(StripPrefixAndFilename(path, options_.partition_base_dir).directory)\n\nReview Comment:\n   Why aren't we passing both components?\n\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -76,11 +80,8 @@ class ARROW_DS_EXPORT Partitioning {\n       const std::shared_ptr<RecordBatch>& batch) const = 0;\n \n   /// \\brief Parse a path into a partition expression\n-  virtual Result<compute::Expression> Parse(const std::string& path) const = 0;\n-\n-  struct PartitionPathFormat {\n-    std::string directory, prefix;\n-  };\n+  virtual Result<compute::Expression> Parse(const std::string& directory = \"\",\n+                                            const std::string& prefix = \"\") const = 0;\n\nReview Comment:\n   Though yes, it would be better if we could pass `const PartitionPathFormat&` instead. FWIW I don't think we have to expose it to Python. Or we can just make a namedtuple on the Python side, it doesn't have to be a C++ class wrapper.\n\n\n\n##########\ncpp/src/arrow/dataset/partition.cc:\n##########\n@@ -805,19 +806,20 @@ std::shared_ptr<PartitioningFactory> HivePartitioning::MakeFactory(\n   return std::shared_ptr<PartitioningFactory>(new HivePartitioningFactory(options));\n }\n \n-std::string StripPrefixAndFilename(const std::string& path, const std::string& prefix) {\n+PartitionPathFormat StripPrefixAndFilename(const std::string& path,\n+                                           const std::string& prefix) {\n   auto maybe_base_less = fs::internal::RemoveAncestor(prefix, path);\n   auto base_less = maybe_base_less ? std::string(*maybe_base_less) : path;\n   auto basename_filename = fs::internal::GetAbstractPathParent(base_less);\n-  return basename_filename.first;\n+  return PartitionPathFormat{basename_filename.first, basename_filename.second};\n\nReview Comment:\n   nit: `std::move` things here\n\n\n\n##########\ncpp/src/arrow/dataset/file_parquet.cc:\n##########\n@@ -873,7 +874,8 @@ Result<std::vector<std::shared_ptr<Schema>>> ParquetDatasetFactory::InspectSchem\n \n     size_t i = 0;\n     for (const auto& e : paths_with_row_group_ids_) {\n-      stripped[i++] = StripPrefixAndFilename(e.first, options_.partition_base_dir);\n+      stripped[i++] =\n+          StripPrefixAndFilename(e.first, options_.partition_base_dir).directory;\n\nReview Comment:\n   (Can we cover this with a test?)\n\n\n\n##########\ncpp/src/arrow/dataset/file_parquet.cc:\n##########\n@@ -847,7 +847,8 @@ ParquetDatasetFactory::CollectParquetFragments(const Partitioning& partitioning)\n     auto row_groups = Iota(metadata_subset->num_row_groups());\n \n     auto partition_expression =\n-        partitioning.Parse(StripPrefixAndFilename(path, options_.partition_base_dir))\n+        partitioning\n+            .Parse(StripPrefixAndFilename(path, options_.partition_base_dir).directory)\n\nReview Comment:\n   (Also, can we cover this with a test?)\n\n\n\n##########\ncpp/src/arrow/dataset/file_parquet.cc:\n##########\n@@ -873,7 +874,8 @@ Result<std::vector<std::shared_ptr<Schema>>> ParquetDatasetFactory::InspectSchem\n \n     size_t i = 0;\n     for (const auto& e : paths_with_row_group_ids_) {\n-      stripped[i++] = StripPrefixAndFilename(e.first, options_.partition_base_dir);\n+      stripped[i++] =\n+          StripPrefixAndFilename(e.first, options_.partition_base_dir).directory;\n\nReview Comment:\n   Hmm, don't we still want the filename in the path in case the partitioning factory is a filename PartitioningFactory?\n\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,9 +278,11 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n\nReview Comment:\n   Is this necessary? It gets shadowed below\n\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -353,16 +359,17 @@ class ARROW_DS_EXPORT FilenamePartitioning : public KeyValuePartitioning {\n       std::vector<std::string> field_names, PartitioningFactoryOptions = {});\n \n  private:\n-  Result<std::vector<Key>> ParseKeys(const std::string& path) const override;\n+  Result<std::vector<Key>> ParseKeys(const std::string& directory,\n+                                     const std::string& prefix) const override;\n \n   Result<PartitionPathFormat> FormatValues(const ScalarVector& values) const override;\n };\n \n /// \\brief Remove a prefix and the filename of a path.\n ///\n /// e.g., `StripPrefixAndFilename(\"/data/year=2019/c.txt\", \"/data\") -> \"year=2019\"`\n\nReview Comment:\n   Example in docstring needs updating\n\n\n\n",
                    "created": "2022-04-27T12:40:57.886+0000",
                    "updated": "2022-04-27T12:40:57.886+0000",
                    "started": "2022-04-27T12:40:57.885+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "762840",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764337",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861960853\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -38,6 +38,10 @@ namespace dataset {\n \n constexpr char kFilenamePartitionSep = '_';\n \n+struct PartitionPathFormat {\n\nReview Comment:\n   Made the change, thanks!\n\n\n\n",
                    "created": "2022-04-29T16:24:29.268+0000",
                    "updated": "2022-04-29T16:24:29.268+0000",
                    "started": "2022-04-29T16:24:29.267+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764337",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764339",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861963368\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -76,11 +80,8 @@ class ARROW_DS_EXPORT Partitioning {\n       const std::shared_ptr<RecordBatch>& batch) const = 0;\n \n   /// \\brief Parse a path into a partition expression\n-  virtual Result<compute::Expression> Parse(const std::string& path) const = 0;\n-\n-  struct PartitionPathFormat {\n-    std::string directory, prefix;\n-  };\n+  virtual Result<compute::Expression> Parse(const std::string& directory = \"\",\n+                                            const std::string& prefix = \"\") const = 0;\n\nReview Comment:\n   - Removed the default parameter\r\n   - Modified the Parse method to use a `PartitionPathFormat` object as an argument. As for the PyArrow interface, modified the `parse()` method to accept just the two strings (directory & prefix) and then uses a cppclass object to form the PartitionPathFormat object which is then passed into the internal `Parse()` method. Is this a good approach? \n\n\n\n",
                    "created": "2022-04-29T16:27:34.659+0000",
                    "updated": "2022-04-29T16:27:34.659+0000",
                    "started": "2022-04-29T16:27:34.659+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764339",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764340",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861963501\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -353,16 +359,17 @@ class ARROW_DS_EXPORT FilenamePartitioning : public KeyValuePartitioning {\n       std::vector<std::string> field_names, PartitioningFactoryOptions = {});\n \n  private:\n-  Result<std::vector<Key>> ParseKeys(const std::string& path) const override;\n+  Result<std::vector<Key>> ParseKeys(const std::string& directory,\n+                                     const std::string& prefix) const override;\n \n   Result<PartitionPathFormat> FormatValues(const ScalarVector& values) const override;\n };\n \n /// \\brief Remove a prefix and the filename of a path.\n ///\n /// e.g., `StripPrefixAndFilename(\"/data/year=2019/c.txt\", \"/data\") -> \"year=2019\"`\n\nReview Comment:\n   Updated the docstring\n\n\n\n",
                    "created": "2022-04-29T16:27:49.640+0000",
                    "updated": "2022-04-29T16:27:49.640+0000",
                    "started": "2022-04-29T16:27:49.639+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764340",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764341",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861963687\n\n\n##########\ncpp/src/arrow/dataset/partition.cc:\n##########\n@@ -805,19 +806,20 @@ std::shared_ptr<PartitioningFactory> HivePartitioning::MakeFactory(\n   return std::shared_ptr<PartitioningFactory>(new HivePartitioningFactory(options));\n }\n \n-std::string StripPrefixAndFilename(const std::string& path, const std::string& prefix) {\n+PartitionPathFormat StripPrefixAndFilename(const std::string& path,\n+                                           const std::string& prefix) {\n   auto maybe_base_less = fs::internal::RemoveAncestor(prefix, path);\n   auto base_less = maybe_base_less ? std::string(*maybe_base_less) : path;\n   auto basename_filename = fs::internal::GetAbstractPathParent(base_less);\n-  return basename_filename.first;\n+  return PartitionPathFormat{basename_filename.first, basename_filename.second};\n\nReview Comment:\n   Made the change, thanks!\n\n\n\n",
                    "created": "2022-04-29T16:28:04.680+0000",
                    "updated": "2022-04-29T16:28:04.680+0000",
                    "started": "2022-04-29T16:28:04.679+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764341",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764343",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861964090\n\n\n##########\ncpp/src/arrow/dataset/discovery.cc:\n##########\n@@ -278,9 +278,11 @@ Result<std::shared_ptr<Dataset>> FileSystemDatasetFactory::Finish(FinishOptions\n   }\n \n   std::vector<std::shared_ptr<FileFragment>> fragments;\n+  std::string fixed_path;\n\nReview Comment:\n   Yes, corrected that, thanks for pointing that out!\n\n\n\n",
                    "created": "2022-04-29T16:28:39.886+0000",
                    "updated": "2022-04-29T16:28:39.886+0000",
                    "started": "2022-04-29T16:28:39.886+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764343",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764379",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r861978402\n\n\n##########\ncpp/src/arrow/dataset/partition.h:\n##########\n@@ -310,8 +310,8 @@ class ARROW_DS_EXPORT FunctionPartitioning : public Partitioning {\n \n   std::string type_name() const override { return name_; }\n \n-  Result<compute::Expression> Parse(const std::string& path) const override {\n-    return parse_impl_(path);\n+  Result<compute::Expression> Parse(const PartitionPathFormat& path) const override {\n+    return parse_impl_(path.directory);\n\nReview Comment:\n   Hmm, not for this PR but I would expect FunctionPartitioning to be \"as powerful as\" any other partitioning. But I don't think it's used much anyways.\n\n\n\n##########\npython/pyarrow/_dataset.pyx:\n##########\n@@ -1313,9 +1313,12 @@ cdef class Partitioning(_Weakrefable):\n     cdef inline shared_ptr[CPartitioning] unwrap(self):\n         return self.wrapped\n \n-    def parse(self, path):\n+    def parse(self, directory=\"\", prefix=\"\"):\n\nReview Comment:\n   nit but do both of these need a default? I can see prefix having a default because it's a new argument\n\n\n\n##########\npython/pyarrow/_dataset.pyx:\n##########\n@@ -1313,9 +1313,12 @@ cdef class Partitioning(_Weakrefable):\n     cdef inline shared_ptr[CPartitioning] unwrap(self):\n         return self.wrapped\n \n-    def parse(self, path):\n+    def parse(self, directory=\"\", prefix=\"\"):\n\nReview Comment:\n   Also IMO the parameter should be named \"filename\", and/or we should have a docstring\n\n\n\n##########\ncpp/src/arrow/dataset/file_parquet.cc:\n##########\n@@ -873,7 +874,8 @@ Result<std::vector<std::shared_ptr<Schema>>> ParquetDatasetFactory::InspectSchem\n \n     size_t i = 0;\n     for (const auto& e : paths_with_row_group_ids_) {\n-      stripped[i++] = StripPrefixAndFilename(e.first, options_.partition_base_dir);\n+      stripped[i++] =\n+          StripPrefixAndFilename(e.first, options_.partition_base_dir).directory;\n\nReview Comment:\n   This still seems off, but I can't figure out how to hit this case.\n\n\n\n",
                    "created": "2022-04-29T17:23:19.660+0000",
                    "updated": "2022-04-29T17:23:19.660+0000",
                    "started": "2022-04-29T17:23:19.660+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764379",
                    "issueId": "13441386"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/worklog/764399",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12977:\nURL: https://github.com/apache/arrow/pull/12977#discussion_r862046122\n\n\n##########\npython/pyarrow/_dataset.pyx:\n##########\n@@ -1313,9 +1313,12 @@ cdef class Partitioning(_Weakrefable):\n     cdef inline shared_ptr[CPartitioning] unwrap(self):\n         return self.wrapped\n \n-    def parse(self, path):\n+    def parse(self, directory=\"\", prefix=\"\"):\n\nReview Comment:\n   Previously, when the `parse()` method only accepted a path, we used to pass the filename there, as FilenamePartitioning only needs the filename and not the directory.  But, now that it is expecting both a directory and filename prefix, so I believe a directory will not be required for FilenamePartitioning, thus using an empty string as default.\n\n\n\n",
                    "created": "2022-04-29T18:30:06.340+0000",
                    "updated": "2022-04-29T18:30:06.340+0000",
                    "started": "2022-04-29T18:30:06.339+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "764399",
                    "issueId": "13441386"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 21000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4ca2515b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ca0255d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2215e3ca[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6f52b018[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20217742[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@46c881af[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4bce210f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@31e69a1e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1ad66007[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@18914f0b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@22edd34f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@27de9b66[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 21000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri May 27 00:08:47 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": [
            "C++"
        ],
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-05-27T00:08:47.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16302/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2022-04-24T22:59:29.000+0000",
        "updated": "2022-07-28T18:26:03.000+0000",
        "timeoriginalestimate": null,
        "description": "While using FilenamePartitioning, currently when we read a dataset, say from PyArrow, the partitioning field only has Null values.\r\n\r\n\u00a0\r\n\r\nThe issue can be reproduced with the following code\r\n\r\n\u00a0\r\n{code:python}\r\ntable = pa.table([\r\n\u00a0\u00a0  \u00a0 \u00a0 \u00a0 \u00a0 pa.array(range(20)), pa.array(np.random.randn(20)),\r\n\u00a0\u00a0  \u00a0 \u00a0 \u00a0 \u00a0 pa.array(np.repeat(['a', 'b'], 10))],\r\n\u00a0\u00a0  \u00a0 \u00a0 \u00a0 \u00a0 names=[\"f1\", \"f2\", \"part\"]\r\n\u00a0\u00a0  \u00a0 \u00a0 ) \r\n\r\npart = ds.partitioning(pa.schema([(\"part\", pa.string())]), flavor=\"filename\")\r\n\r\n# test is the directory where partitions are written\r\nds.write_dataset(\r\n\u00a0\u00a0  \u00a0 \u00a0 \u00a0 \u00a0 table, \"test\",\r\n\u00a0\u00a0  \u00a0 \u00a0 \u00a0 \u00a0 format=\"parquet\",\u00a0 partitioning=part\r\n\u00a0\u00a0  \u00a0 \u00a0 )\r\n\r\nresult = ds.dataset(\r\n\u00a0 \u00a0  \u00a0 \u00a0 \u00a0 \u00a0 \"test\",\u00a0 format=\"parquet\", partitioning=part,\r\n\u00a0 \u00a0  \u00a0 \u00a0 ).to_table(){code}\r\nThis results in something this:\r\n{code:python}\r\npyarrow.Table\r\nf1: int64\r\nf2: double\r\npart: string\r\n----\r\nf1: [[0,1,2,3,4,5,6,7,8,9],[10,11,12,13,14,15,16,17,18,19]]\r\nf2: [[-1.1753280347394899,-0.9640239222827617,0.7907247451009602,1.3667778347936321,0.005079832420686733,0.9024313772071855,-1.01618656608383,-1.1459911861999188,-0.7407261867306765,-0.012823499364722428],[0.29893685698088185,1.3907720928021299,-0.48826416913435605,-1.3436821154932153,-0.5492388164165941,-0.07093280675027104,0.009918818541272493,-1.05561750529359,-2.0209000426858927,-0.28081085330210676]]\r\npart: [[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]] {code}\r\n\u00a0\r\n\r\n\u00a0\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 21000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Null values in partitioning field for FilenamePartitioning",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13441386/comment/17542721",
                    "id": "17542721",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 12977\n[https://github.com/apache/arrow/pull/12977]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-05-27T00:08:47.505+0000",
                    "updated": "2022-05-27T00:08:47.505+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z11r6w:",
        "customfield_12314139": null
    }
}