{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13252990",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990",
    "key": "ARROW-6353",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=martinradev",
            "name": "martinradev",
            "key": "martinradev",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Martin Radev",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Igor+Yastrebov",
            "name": "Igor Yastrebov",
            "key": "igor yastrebov",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Igor Yastrebov",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Igor+Yastrebov",
            "name": "Igor Yastrebov",
            "key": "igor yastrebov",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Igor Yastrebov",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6353/votes",
            "votes": 1,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/315323",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write\u2026\nURL: https://github.com/apache/arrow/pull/5446\n \n \n   \u2026_table\r\n   \r\n   The patch exposes the option to change the default and/or per-column\r\n   compression level when creating a parquet file. No validation is done\r\n   on the input since the compression level is codec and version specific.\r\n   We use `np.iinfo(np.intc).min` as default value for compression_level to\r\n   denote that the compression level can be selected by Arrow. The reason\r\n   for this is that Arrow uses INT_MIN internally to represent the special\r\n   case of a compression level not being selected.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-19T21:51:47.757+0000",
                    "updated": "2019-09-19T21:51:47.757+0000",
                    "started": "2019-09-19T21:51:47.756+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "315323",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/315515",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write\u2026\nURL: https://github.com/apache/arrow/pull/5446#issuecomment-533448709\n \n \n   > We use np.iinfo(np.intc).min as default value for compression_level to\r\n   denote that the compression level can be selected by Arrow. The reason\r\n   for this is that Arrow uses INT_MIN internally to represent the special\r\n   case of a compression level not being selected.\r\n   \r\n   Is it not possible to use `None` for this in the Python API?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-20T07:49:20.273+0000",
                    "updated": "2019-09-20T07:49:20.273+0000",
                    "started": "2019-09-20T07:49:20.272+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "315515",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/315521",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on issue #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write\u2026\nURL: https://github.com/apache/arrow/pull/5446#issuecomment-533454990\n \n \n   > > We use np.iinfo(np.intc).min as default value for compression_level to\r\n   > > denote that the compression level can be selected by Arrow. The reason\r\n   > > for this is that Arrow uses INT_MIN internally to represent the special\r\n   > > case of a compression level not being selected.\r\n   > \r\n   > Is it not possible to use `None` for this in the Python API?\r\n   \r\n   I can change it. I wanted to make it consistent with the c++ properties api.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-20T08:09:47.712+0000",
                    "updated": "2019-09-20T08:09:47.712+0000",
                    "started": "2019-09-20T08:09:47.711+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "315521",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/315616",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on issue #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write\u2026\nURL: https://github.com/apache/arrow/pull/5446#issuecomment-533525662\n \n \n   @wesm @jorisvandenbossche Can you have a look?\r\n   I'm adding Wes since he is also familiar with the C++ change added some time ago.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-20T12:05:22.683+0000",
                    "updated": "2019-09-20T12:05:22.683+0000",
                    "started": "2019-09-20T12:05:22.682+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "315616",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316197",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326878877\n \n \n\n ##########\n File path: python/pyarrow/tests/test_parquet.py\n ##########\n @@ -632,6 +632,18 @@ def make_sample_file(table_or_df):\n     return pq.ParquetFile(buf)\n \n \n+def test_compression_level():\n+    arr = pa.array(list(map(int, range(1000))))\n+    data = [arr, arr]\n+    table = pa.Table.from_arrays(data, names=['a', 'b'])\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=1)\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=5)\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=[{'a': 2, 'b': 3}])\n \n Review comment:\n   Can you add a test to exhibit whether an error from an invalid compression level bubbles up to Python? \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T00:41:06.416+0000",
                    "updated": "2019-09-22T00:41:06.416+0000",
                    "started": "2019-09-22T00:41:06.416+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316197",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316198",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326878894\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1287,7 +1296,9 @@ def write_table(table, where, row_group_size=None, version='1.0',\n                 coerce_timestamps=None,\n                 allow_truncated_timestamps=False,\n                 data_page_size=None, flavor=None,\n-                filesystem=None, **kwargs):\n+                filesystem=None,\n+                compression_level=np.iinfo(np.intc).min,\n \n Review comment:\n   Hm, I'm wondering if we should switch compression.h to use INT32_MIN for the sentinel value rather than a platform integer. @pitrou? \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T00:41:06.426+0000",
                    "updated": "2019-09-22T00:41:06.426+0000",
                    "started": "2019-09-22T00:41:06.426+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316198",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316222",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326885329\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1287,7 +1296,9 @@ def write_table(table, where, row_group_size=None, version='1.0',\n                 coerce_timestamps=None,\n                 allow_truncated_timestamps=False,\n                 data_page_size=None, flavor=None,\n-                filesystem=None, **kwargs):\n+                filesystem=None,\n+                compression_level=np.iinfo(np.intc).min,\n \n Review comment:\n   Ah, this actually probably be None instead.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T06:39:49.617+0000",
                    "updated": "2019-09-22T06:39:49.617+0000",
                    "started": "2019-09-22T06:39:49.616+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316222",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316223",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326885329\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1287,7 +1296,9 @@ def write_table(table, where, row_group_size=None, version='1.0',\n                 coerce_timestamps=None,\n                 allow_truncated_timestamps=False,\n                 data_page_size=None, flavor=None,\n-                filesystem=None, **kwargs):\n+                filesystem=None,\n+                compression_level=np.iinfo(np.intc).min,\n \n Review comment:\n   Ah, this actually probably should be None instead.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T06:40:01.603+0000",
                    "updated": "2019-09-22T06:40:01.603+0000",
                    "started": "2019-09-22T06:40:01.603+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316223",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316261",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326903287\n \n \n\n ##########\n File path: python/pyarrow/tests/test_parquet.py\n ##########\n @@ -632,6 +632,18 @@ def make_sample_file(table_or_df):\n     return pq.ParquetFile(buf)\n \n \n+def test_compression_level():\n+    arr = pa.array(list(map(int, range(1000))))\n+    data = [arr, arr]\n+    table = pa.Table.from_arrays(data, names=['a', 'b'])\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=1)\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=5)\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=[{'a': 2, 'b': 3}])\n \n Review comment:\n   Yes, this was a good idea since I noticed that the zlib codec lazy initialization in Arrow can result into an assert if an invalid compression level is specified.\r\n   I added a patch for arrow-cpp to accomplish two things:\r\n    * Return an error if the codec doesn't support a compression level instead of ignoring it silently. This could help avoid confusion if a user doesn't see any change in compression ratio.\r\n    * Make sure that Codec::Create also initializes the codec by calling the newly added method `Status Init()`.\r\n    * Add a test\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T14:12:54.346+0000",
                    "updated": "2019-09-22T14:12:54.346+0000",
                    "started": "2019-09-22T14:12:54.345+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316261",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316262",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326903409\n \n \n\n ##########\n File path: python/pyarrow/tests/test_parquet.py\n ##########\n @@ -632,6 +632,42 @@ def make_sample_file(table_or_df):\n     return pq.ParquetFile(buf)\n \n \n+def test_compression_level():\n+    arr = pa.array(list(map(int, range(1000))))\n+    data = [arr, arr]\n+    table = pa.Table.from_arrays(data, names=['a', 'b'])\n+\n+    # Check one compression level.\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=1)\n+\n+    # Check another one to make sure that compression_level=1 does not\n+    # coincide with the default one in Arrow.\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=5)\n+\n+    # Check that the user can provide a compression level per column\n+    _check_roundtrip(table, expected=table, compression=\"gzip\",\n+                     compression_level=[{'a': 2, 'b': 3}])\n+\n+    # Check that specifying a compression level for a codec which does allow\n \n Review comment:\n   Should be _which does not allow_\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T14:15:27.324+0000",
                    "updated": "2019-09-22T14:15:27.324+0000",
                    "started": "2019-09-22T14:15:27.324+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316262",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316263",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326903461\n \n \n\n ##########\n File path: cpp/src/parquet/types.cc\n ##########\n @@ -61,9 +61,7 @@ std::unique_ptr<Codec> GetCodec(Compression::type codec, int compression_level)\n     throw ParquetException(ss.str());\n   }\n \n-  if (codec != Compression::UNCOMPRESSED) {\n-    PARQUET_THROW_NOT_OK(Codec::Create(codec, compression_level, &result));\n-  }\n+  PARQUET_THROW_NOT_OK(Codec::Create(codec, compression_level, &result));\n \n Review comment:\n   Instead of handling this special case here, it's best to move it to Codec::Create.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T14:16:23.926+0000",
                    "updated": "2019-09-22T14:16:23.926+0000",
                    "started": "2019-09-22T14:16:23.925+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316263",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316264",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on pull request #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326903461\n \n \n\n ##########\n File path: cpp/src/parquet/types.cc\n ##########\n @@ -61,9 +61,7 @@ std::unique_ptr<Codec> GetCodec(Compression::type codec, int compression_level)\n     throw ParquetException(ss.str());\n   }\n \n-  if (codec != Compression::UNCOMPRESSED) {\n-    PARQUET_THROW_NOT_OK(Codec::Create(codec, compression_level, &result));\n-  }\n+  PARQUET_THROW_NOT_OK(Codec::Create(codec, compression_level, &result));\n \n Review comment:\n   The check was removed since it can be handled within Codec::Create.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T14:23:57.166+0000",
                    "updated": "2019-09-22T14:23:57.166+0000",
                    "started": "2019-09-22T14:23:57.166+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316264",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316296",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#issuecomment-533903180\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=h1) Report\n   > Merging [#5446](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/fec714341017c6c0264be5548644256b01d2a5db?src=pr&el=desc) will **increase** coverage by `4.87%`.\n   > The diff coverage is `96.77%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/5446/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=tree)\n   \n   ```diff\n   @@             Coverage Diff             @@\n   ##           master    #5446       +/-   ##\n   ===========================================\n   + Coverage   84.33%    89.2%    +4.87%     \n   ===========================================\n     Files         160      766      +606     \n     Lines       10495   112011   +101516     \n     Branches     1498        0     -1498     \n   ===========================================\n   + Hits         8851    99922    +91071     \n   - Misses       1633    12089    +10456     \n   + Partials       11        0       -11\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [python/pyarrow/parquet.py](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvcGFycXVldC5weQ==) | `92.36% <\u00f8> (\u00f8)` | |\n   | [cpp/src/arrow/util/compression.h](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2NvbXByZXNzaW9uLmg=) | `100% <\u00f8> (\u00f8)` | |\n   | [cpp/src/arrow/util/compression\\_test.cc](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2NvbXByZXNzaW9uX3Rlc3QuY2M=) | `99.29% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/util/compression\\_zlib.cc](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2NvbXByZXNzaW9uX3psaWIuY2M=) | `88.06% <100%> (\u00f8)` | |\n   | [cpp/src/parquet/types.cc](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L3R5cGVzLmNj) | `93.97% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/util/compression.cc](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2NvbXByZXNzaW9uLmNj) | `90% <100%> (\u00f8)` | |\n   | [python/pyarrow/\\_parquet.pyx](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvX3BhcnF1ZXQucHl4) | `90.86% <83.33%> (\u00f8)` | |\n   | [python/pyarrow/tests/test\\_parquet.py](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvdGVzdHMvdGVzdF9wYXJxdWV0LnB5) | `96.21% <93.33%> (\u00f8)` | |\n   | [js/src/util/fn.ts](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-anMvc3JjL3V0aWwvZm4udHM=) | | |\n   | [js/src/builder/index.ts](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree#diff-anMvc3JjL2J1aWxkZXIvaW5kZXgudHM=) | | |\n   | ... and [808 more](https://codecov.io/gh/apache/arrow/pull/5446/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=footer). Last update [fec7143...cf1f8f5](https://codecov.io/gh/apache/arrow/pull/5446?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T17:58:10.926+0000",
                    "updated": "2019-09-22T17:58:10.926+0000",
                    "started": "2019-09-22T17:58:10.926+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316296",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316299",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "martinradev commented on issue #5446: ARROW-6353: [Python] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#issuecomment-533903655\n \n \n   @pitrou Can you have a look as well?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T18:01:45.701+0000",
                    "updated": "2019-09-22T18:01:45.701+0000",
                    "started": "2019-09-22T18:01:45.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316299",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316313",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5446: ARROW-6353: [Python] [C++] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446#discussion_r326916190\n \n \n\n ##########\n File path: cpp/src/arrow/util/compression_test.cc\n ##########\n @@ -367,41 +367,34 @@ TEST_P(CodecTest, CodecRoundtrip) {\n   }\n }\n \n-TEST_P(CodecTest, SpecifyCompressionLevel) {\n-  const auto compression = GetCompression();\n-  // The compression level is codec specific.\n-  int compression_level;\n-  switch (compression) {\n-    case Compression::LZ4:\n-    case Compression::LZO:\n-    case Compression::UNCOMPRESSED:\n-    case Compression::SNAPPY:\n-      // Compression level cannot be specified for these\n-      // compression types.\n-      return;\n-    case Compression::GZIP:\n-      compression_level = 2;\n-      break;\n-    case Compression::BZ2:\n-      // SKIP: BZ2 doesn't support one-shot compression\n-      return;\n-    case Compression::ZSTD:\n-      compression_level = 4;\n-      break;\n-    case Compression::BROTLI:\n-      compression_level = 10;\n-      break;\n-    default:\n-      FAIL() << \"Unhandled compression type\";\n-      return;\n-  }\n+TEST(TestCodecMisc, SpecifyCompressionLevel) {\n+  struct CombinationOption {\n+    Compression::type codec;\n+    int level;\n+    bool expect_success;\n+  };\n+  constexpr CombinationOption combinations[] = {\n+      {Compression::GZIP, 2, true},     {Compression::BROTLI, 10, true},\n+      {Compression::ZSTD, 4, true},     {Compression::LZ4, -10, false},\n+      {Compression::LZO, -22, false},   {Compression::UNCOMPRESSED, 10, false},\n+      {Compression::SNAPPY, 16, false}, {Compression::GZIP, -992, false}};\n \n   std::vector<uint8_t> data = MakeRandomData(2000);\n-  // create multiple compressors to try to break them\n-  std::unique_ptr<Codec> c1, c2;\n-  ASSERT_OK(Codec::Create(compression, compression_level, &c1));\n-  ASSERT_OK(Codec::Create(compression, compression_level, &c2));\n-  CheckCodecRoundtrip(c1, c2, data);\n+  for (const auto& combination : combinations) {\n+    const auto compression = combination.codec;\n+    const auto level = combination.level;\n+    const auto expect_success = combination.expect_success;\n+    std::unique_ptr<Codec> c1, c2;\n+    const auto status1 =\n+        ::arrow::internal::GenericToStatus(Codec::Create(compression, level, &c1));\n+    const auto status2 =\n+        ::arrow::internal::GenericToStatus(Codec::Create(compression, level, &c2));\n \n Review comment:\n   The GenericToStatus isn't needed here. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T19:38:09.304+0000",
                    "updated": "2019-09-22T19:38:09.304+0000",
                    "started": "2019-09-22T19:38:09.303+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316313",
                    "issueId": "13252990"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/worklog/316322",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5446: ARROW-6353: [Python] [C++] Expose compression_level option to parquet.write_table\nURL: https://github.com/apache/arrow/pull/5446\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-22T20:03:50.833+0000",
                    "updated": "2019-09-22T20:03:50.833+0000",
                    "started": "2019-09-22T20:03:50.832+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316322",
                    "issueId": "13252990"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@268243e3[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@51a64974[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ae76e1c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@29e963dd[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5bae658f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@505044d8[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21b64740[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@43a32f20[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6b09b8c6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@392d47fb[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2ab28bd9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@70327b80[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "Sun Sep 22 20:03:50 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-09-22T20:03:50.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6353/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2019-08-26T09:23:35.000+0000",
        "updated": "2019-09-22T20:03:50.000+0000",
        "timeoriginalestimate": null,
        "description": "This feature was introduced for C++ in\u00a0[ARROW-6216|https://issues.apache.org/jira/browse/ARROW-6216].",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Allow user to select compression level in pyarrow.parquet.write_table",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/comment/16915645",
                    "id": "16915645",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=martinradev",
                        "name": "martinradev",
                        "key": "martinradev",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Martin Radev",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~Igor Yastrebov] \r\nShould I work on this?\r\nI would be a bit slow but I would be interested in doing it from a learning experience standpoint.\r\n\r\nIsn't the priority a bit too high? The change to the Parquet/Arrow C++ API doesn't break the python layer.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=martinradev",
                        "name": "martinradev",
                        "key": "martinradev",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Martin Radev",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2019-08-26T09:33:35.426+0000",
                    "updated": "2019-08-26T09:33:35.426+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/comment/16916694",
                    "id": "16916694",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Igor+Yastrebov",
                        "name": "Igor Yastrebov",
                        "key": "igor yastrebov",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Igor Yastrebov",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~martinradev]\r\n\r\nYou are free to work on it if you want. I'd love to see this feature in 0.15.0 but since I won't do it myself I'm in no position to ask for it.\r\n\r\n\u00a0\r\n\r\nAs far as I'm concerned, there are only two levels of priority - blocker and non-blocker - but\u00a0jira admins can correct it if it is a problem.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Igor+Yastrebov",
                        "name": "Igor Yastrebov",
                        "key": "igor yastrebov",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Igor Yastrebov",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2019-08-27T12:56:14.254+0000",
                    "updated": "2019-08-27T12:56:14.254+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/comment/16933582",
                    "id": "16933582",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=martinradev",
                        "name": "martinradev",
                        "key": "martinradev",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Martin Radev",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I started working on it.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=martinradev",
                        "name": "martinradev",
                        "key": "martinradev",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Martin Radev",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2019-09-19T16:49:58.710+0000",
                    "updated": "2019-09-19T16:49:58.710+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252990/comment/16935411",
                    "id": "16935411",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 5446\n[https://github.com/apache/arrow/pull/5446]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-09-22T20:03:50.436+0000",
                    "updated": "2019-09-22T20:03:50.436+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z0618w:",
        "customfield_12314139": null
    }
}