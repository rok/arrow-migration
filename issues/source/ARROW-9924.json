{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13326213",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213",
    "key": "ARROW-9924",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12599512",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12599512",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13327244",
                    "key": "ARROW-9983",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13327244",
                    "fields": {
                        "summary": "[C++][Dataset][Python] Use larger default batch size than 32K for Datasets API",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            },
            {
                "id": "12598618",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12598618",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13327244",
                    "key": "ARROW-9983",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13327244",
                    "fields": {
                        "summary": "[C++][Dataset][Python] Use larger default batch size than 32K for Datasets API",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9924/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 25,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/484207",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz opened a new pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-14T21:07:00.586+0000",
                    "updated": "2020-09-14T21:07:00.586+0000",
                    "started": "2020-09-14T21:07:00.585+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484207",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/484213",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-692326434\n\n\n   https://issues.apache.org/jira/browse/ARROW-9924\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-14T21:33:59.337+0000",
                    "updated": "2020-09-14T21:33:59.337+0000",
                    "started": "2020-09-14T21:33:59.336+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484213",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/484484",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r488672303\n\n\n\n##########\nFile path: python/pyarrow/parquet.py\n##########\n@@ -1479,6 +1479,11 @@ def read(self, columns=None, use_threads=True, use_pandas_metadata=False):\n                 ]\n                 columns = columns + list(set(index_columns) - set(columns))\n \n+        if len(list(self._dataset.get_fragments())) <= 1:\n+            # Allow per-column parallelism; would otherwise cause contention\n+            # in the presence of per-file parallelism.\n+            use_threads = False\n\nReview comment:\n       Alternative would also to handle this within the `to_table` method? \n\n##########\nFile path: python/pyarrow/parquet.py\n##########\n@@ -1479,6 +1479,11 @@ def read(self, columns=None, use_threads=True, use_pandas_metadata=False):\n                 ]\n                 columns = columns + list(set(index_columns) - set(columns))\n \n+        if len(list(self._dataset.get_fragments())) <= 1:\n+            # Allow per-column parallelism; would otherwise cause contention\n+            # in the presence of per-file parallelism.\n+            use_threads = False\n\nReview comment:\n       We should probably check that `use_threads`is actually True when enabling this per-column parallelism\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1070,6 +1070,7 @@ cdef class ParquetFileFormat(FileFormat):\n         options = &(wrapped.get().reader_options)\n         options.use_buffered_stream = read_options.use_buffered_stream\n         options.buffer_size = read_options.buffer_size\n+        options.enable_parallel_column_conversion = True\n\nReview comment:\n       Should the default be False here? (and then be set to True if we only have a single file)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-15T13:36:02.951+0000",
                    "updated": "2020-09-15T13:36:02.951+0000",
                    "started": "2020-09-15T13:36:02.951+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484484",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/484644",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-692848891\n\n\n   Can you run some kind of benchmark or ad-hoc performance check, including with the file/shape in question here, to see the effects? I see two changes (batch size and single-file behavior change) so we should be clear about the effects.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-15T17:05:33.245+0000",
                    "updated": "2020-09-15T17:05:33.245+0000",
                    "started": "2020-09-15T17:05:33.245+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484644",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/484651",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-692852532\n\n\n   In terms of benchmarking, it also strikes me that one issue is that it may be faster (especially on machines with a lot of cores -- e.g. 16/20 core servers) to read a 2-file (or even n-file where n is some number less than the number of cores on the machine) dataset by reading the files one at a time rather than using the datasets API. How many files do you have to have before the performance issue goes away? This is something that would be good to quantify in a collection of benchmarks\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-15T17:12:27.348+0000",
                    "updated": "2020-09-15T17:12:27.348+0000",
                    "started": "2020-09-15T17:12:27.348+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "484651",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/485330",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-693622612\n\n\n   For a range of file and column counts, the time to read is as follows:\r\n   ```\r\n   nfiles  ncolumns  legacy_time  default_time  regression\r\n        1         1     0.490398      0.401345   -0.181592\r\n        1         2     0.642569      0.523074   -0.185964\r\n        1         4     0.988469      0.945871   -0.043095\r\n        1         8     1.541519      1.602061    0.039274\r\n        2         1     1.078602      0.622690   -0.422688\r\n        2         2     1.275463      0.922737   -0.276548\r\n        2         4     1.601820      2.001778    0.249689\r\n        2         8     2.847058      4.283226    0.504439\r\n        4         1     2.116808      0.760073   -0.640935\r\n        4         2     2.458016      1.472731   -0.400846\r\n        4         4     3.975070      2.648561   -0.333707\r\n        4         8     6.531598      6.030903   -0.076657\r\n   ```\r\n   (times in seconds, regression computed as (default_time - legacy_time)/legacy_time)\r\n   \r\n   `$ python -m pyperf system show`\r\n   <details>\r\n   <pre>\r\n   System state\r\n   ============\r\n   \r\n   CPU: use 8 logical CPUs: 0-7\r\n   Perf event: Maximum sample rate: 1 per second\r\n   ASLR: Full randomization\r\n   Linux scheduler: No CPU is isolated\r\n   CPU Frequency: 0-7=min=max=1800 MHz\r\n   CPU scaling governor (intel_pstate): performance\r\n   Turbo Boost (intel_pstate): Turbo Boost disabled\r\n   IRQ affinity: irqbalance service: inactive\r\n   IRQ affinity: Default IRQ affinity: CPU 0-7\r\n   IRQ affinity: IRQ affinity: IRQ 0-17,51,120-127,129-130,138-139,146,155-158=CPU 0-7; IRQ 128=CPU 0; IRQ 131=CPU 1; IRQ 132=CPU 2; IRQ 133=CPU 3; IRQ 134=CPU 4; IRQ 135=CPU 5; IRQ 136=CPU 6; IRQ 137=CPU 7\r\n   Power supply: the power cable is plugged\r\n   </pre>\r\n   </details>\r\n   \r\n   We mostly see a performance improvement with defaults, including moderate improvement in single file reading time. Note the significant regressions when reading two files with 4 or 8 columns, which is to be expected since legacy is able to divide that work across 4 or 8 threads instead of only 2.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-16T19:36:46.441+0000",
                    "updated": "2020-09-16T19:36:46.441+0000",
                    "started": "2020-09-16T19:36:46.440+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485330",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/485894",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r490454944\n\n\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1013,27 +1013,36 @@ cdef class ParquetReadOptions(_Weakrefable):\n     dictionary_columns : list of string, default None\n         Names of columns which should be dictionary encoded as\n         they are read.\n+    enable_parallel_column_conversion : bool, default False\n+        Whether single files may be read in parallel (ignored when reading\n+        multiple files to avoid thread contention).\n\nReview comment:\n       Add note that this is experimental. Once we fix our nested parallelism problem this shouldn't be needed\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1899,7 +1912,7 @@ cdef shared_ptr[CScanContext] _build_scan_context(bint use_threads=True,\n \n cdef void _populate_builder(const shared_ptr[CScannerBuilder]& ptr,\n                             list columns=None, Expression filter=None,\n-                            int batch_size=32*2**10) except *:\n+                            int batch_size=2**20) except *:\n\nReview comment:\n       Can this be put in a global variable (`DEFAULT_BATCH_SIZE`) rather than hard-coded?\n\n##########\nFile path: cpp/src/arrow/dataset/file_parquet.h\n##########\n@@ -91,6 +91,10 @@ class ARROW_DS_EXPORT ParquetFileFormat : public FileFormat {\n     /// @{\n     std::unordered_set<std::string> dict_columns;\n     /// @}\n+\n+    /// Parallelize conversion across columns. This option is ignored if a scan is already\n+    /// parallelized across input files.\n\nReview comment:\n       Add note that this is experimental. Once we fix our nested parallelism problem this shouldn't be needed\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1992,7 +2005,7 @@ cdef class Scanner(_Weakrefable):\n     def from_fragment(Fragment fragment not None, Schema schema=None,\n                       bint use_threads=True, MemoryPool memory_pool=None,\n                       list columns=None, Expression filter=None,\n-                      int batch_size=32*2**10):\n+                      int batch_size=2**20):\n\nReview comment:\n       use common variable\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-17T18:07:12.522+0000",
                    "updated": "2020-09-17T18:07:12.522+0000",
                    "started": "2020-09-17T18:07:12.522+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "485894",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/486226",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r490997910\n\n\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1899,7 +1912,7 @@ cdef shared_ptr[CScanContext] _build_scan_context(bint use_threads=True,\n \n cdef void _populate_builder(const shared_ptr[CScannerBuilder]& ptr,\n                             list columns=None, Expression filter=None,\n-                            int batch_size=32*2**10) except *:\n+                            int batch_size=2**20) except *:\n\nReview comment:\n       will do\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1013,27 +1013,36 @@ cdef class ParquetReadOptions(_Weakrefable):\n     dictionary_columns : list of string, default None\n         Names of columns which should be dictionary encoded as\n         they are read.\n+    enable_parallel_column_conversion : bool, default False\n+        Whether single files may be read in parallel (ignored when reading\n+        multiple files to avoid thread contention).\n\nReview comment:\n       alright\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-18T14:42:51.352+0000",
                    "updated": "2020-09-18T14:42:51.352+0000",
                    "started": "2020-09-18T14:42:51.351+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "486226",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/487191",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r492271433\n\n\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1013,27 +1013,38 @@ cdef class ParquetReadOptions(_Weakrefable):\n     dictionary_columns : list of string, default None\n         Names of columns which should be dictionary encoded as\n         they are read.\n+    enable_parallel_column_conversion : bool, default False\n+        EXPERIMENTAL: Parallelize conversion across columns. This option is\n+        ignored if a scan is already parallelized across input files to avoid\n+        thread contention. This option will be removed after support is added\n+        for simultaneous parallelization across files and columns.\n\nReview comment:\n       I was going to comment: is it needed to add this option in the *public* dataset interface? Since we can enable/disable it under the hood depending on whether we are reading a single file or not, and since we do not plan to keep this keyword long term. \r\n   \r\n   But, currently we implement this logic in parquet.py, which of course needs to be able to pass it through to the dataset API, so it needs to be a keyword this way. \n\n##########\nFile path: python/pyarrow/parquet.py\n##########\n@@ -1400,38 +1400,55 @@ def __init__(self, path_or_paths, filesystem=None, filters=None,\n                                 buffer_size=buffer_size)\n         if read_dictionary is not None:\n             read_options.update(dictionary_columns=read_dictionary)\n-        parquet_format = ds.ParquetFileFormat(read_options=read_options)\n \n         # map filters to Expressions\n         self._filters = filters\n         self._filter_expression = filters and _filters_to_expression(filters)\n \n-        # check for single NativeFile dataset\n-        if not isinstance(path_or_paths, list):\n-            if not _is_path_like(path_or_paths):\n-                fragment = parquet_format.make_fragment(path_or_paths)\n-                self._dataset = ds.FileSystemDataset(\n-                    [fragment], schema=fragment.physical_schema,\n-                    format=parquet_format,\n-                    filesystem=fragment.filesystem\n-                )\n-                return\n+        # map old filesystems to new one\n+        if filesystem is not None:\n+            filesystem = _ensure_filesystem(\n+                filesystem, use_mmap=memory_map)\n+        else:\n+            # assume local file system\n+            filesystem = LocalFileSystem(use_mmap=memory_map)\n\nReview comment:\n       I am not sure it is correct to *always* assume local filesystem if no `filesystem` is specified. Eg for a URI this will then not work (but this clearly not tested ..)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-21T18:44:34.713+0000",
                    "updated": "2020-09-21T18:44:34.713+0000",
                    "started": "2020-09-21T18:44:34.708+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "487191",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/487587",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r492271433\n\n\n\n##########\nFile path: python/pyarrow/_dataset.pyx\n##########\n@@ -1013,27 +1013,38 @@ cdef class ParquetReadOptions(_Weakrefable):\n     dictionary_columns : list of string, default None\n         Names of columns which should be dictionary encoded as\n         they are read.\n+    enable_parallel_column_conversion : bool, default False\n+        EXPERIMENTAL: Parallelize conversion across columns. This option is\n+        ignored if a scan is already parallelized across input files to avoid\n+        thread contention. This option will be removed after support is added\n+        for simultaneous parallelization across files and columns.\n\nReview comment:\n       I was going to comment: is it needed to add this option in the *public* dataset interface? Since we can enable/disable it under the hood depending on whether we are reading a single file or not, and since we do not plan to keep this keyword long term. \r\n   \r\n   But, currently we implement this logic in parquet.py, which of course needs to be able to pass it through to the dataset API, so it needs to be a keyword this way. \n\n##########\nFile path: python/pyarrow/parquet.py\n##########\n@@ -1400,38 +1400,55 @@ def __init__(self, path_or_paths, filesystem=None, filters=None,\n                                 buffer_size=buffer_size)\n         if read_dictionary is not None:\n             read_options.update(dictionary_columns=read_dictionary)\n-        parquet_format = ds.ParquetFileFormat(read_options=read_options)\n \n         # map filters to Expressions\n         self._filters = filters\n         self._filter_expression = filters and _filters_to_expression(filters)\n \n-        # check for single NativeFile dataset\n-        if not isinstance(path_or_paths, list):\n-            if not _is_path_like(path_or_paths):\n-                fragment = parquet_format.make_fragment(path_or_paths)\n-                self._dataset = ds.FileSystemDataset(\n-                    [fragment], schema=fragment.physical_schema,\n-                    format=parquet_format,\n-                    filesystem=fragment.filesystem\n-                )\n-                return\n+        # map old filesystems to new one\n+        if filesystem is not None:\n+            filesystem = _ensure_filesystem(\n+                filesystem, use_mmap=memory_map)\n+        else:\n+            # assume local file system\n+            filesystem = LocalFileSystem(use_mmap=memory_map)\n\nReview comment:\n       I am not sure it is correct to *always* assume local filesystem if no `filesystem` is specified. Eg for a URI this will then not work (but this clearly not tested ..)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-22T03:18:42.527+0000",
                    "updated": "2020-09-22T03:18:42.527+0000",
                    "started": "2020-09-22T03:18:42.527+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "487587",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/488222",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-696688370\n\n\n   It seems the crashing test is:\r\n   \r\n   https://github.com/apache/arrow/blob/40d64756dc3b2c51489b48362d0f04ee3e2a7388/python/pyarrow/tests/test_parquet.py#L3389-L3414\r\n   \r\n   where it is passing for `use_legacy_dataset=True`, but then crashing in the next test which normally is the same with `use_legacy_dataset=False`\r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-22T12:27:51.046+0000",
                    "updated": "2020-09-22T12:27:51.046+0000",
                    "started": "2020-09-22T12:27:51.046+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "488222",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/488230",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche edited a comment on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-696688370\n\n\n   It seems the crashing test is:\r\n   \r\n   https://github.com/apache/arrow/blob/40d64756dc3b2c51489b48362d0f04ee3e2a7388/python/pyarrow/tests/test_parquet.py#L3389-L3414\r\n   \r\n   where it is passing for `use_legacy_dataset=True`, but then crashing in the next test which normally is the same with `use_legacy_dataset=False`\r\n   \r\n   Not directly an idea how this would be related to the changes here, but maybe something about the decimal conversion code is not thread-safe? Although there are multiple columns, so also with legacy code it should run in parallel ..\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-22T12:30:42.231+0000",
                    "updated": "2020-09-22T12:30:42.231+0000",
                    "started": "2020-09-22T12:30:42.231+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "488230",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/489003",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche edited a comment on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-696688370\n\n\n   It seems the crashing test is:\r\n   \r\n   https://github.com/apache/arrow/blob/40d64756dc3b2c51489b48362d0f04ee3e2a7388/python/pyarrow/tests/test_parquet.py#L3389-L3414\r\n   \r\n   where it is passing for `use_legacy_dataset=True`, but then crashing in the next test which normally is the same with `use_legacy_dataset=False`\r\n   \r\n   Not directly an idea how this would be related to the changes here, but maybe something about the decimal conversion code is not thread-safe? Although there are multiple columns, so also with legacy code it should run in parallel ..\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-23T04:27:13.398+0000",
                    "updated": "2020-09-23T04:27:13.398+0000",
                    "started": "2020-09-23T04:27:13.398+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "489003",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/489035",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-696688370\n\n\n   It seems the crashing test is:\r\n   \r\n   https://github.com/apache/arrow/blob/40d64756dc3b2c51489b48362d0f04ee3e2a7388/python/pyarrow/tests/test_parquet.py#L3389-L3414\r\n   \r\n   where it is passing for `use_legacy_dataset=True`, but then crashing in the next test which normally is the same with `use_legacy_dataset=False`\r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-23T04:29:54.460+0000",
                    "updated": "2020-09-23T04:29:54.460+0000",
                    "started": "2020-09-23T04:29:54.460+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "489035",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/490424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-698590377\n\n\n   Passing Travis: https://travis-ci.org/github/bkietz/arrow/builds/730077738\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T21:11:04.343+0000",
                    "updated": "2020-09-24T21:11:04.343+0000",
                    "started": "2020-09-24T21:11:04.343+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490424",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/490689",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-698887227\n\n\n   @jorisvandenbossche PTAL\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T11:55:26.356+0000",
                    "updated": "2020-09-25T11:55:26.356+0000",
                    "started": "2020-09-25T11:55:26.356+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490689",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/490941",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#issuecomment-698590377\n\n\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T13:27:47.548+0000",
                    "updated": "2020-09-25T13:27:47.548+0000",
                    "started": "2020-09-25T13:27:47.548+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490941",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/491363",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r495174760\n\n\n\n##########\nFile path: c_glib/test/dataset/test-scan-options.rb\n##########\n@@ -28,7 +28,7 @@ def test_schema\n   end\n \n   def test_batch_size\n-    assert_equal(1<<15,\n+    assert_equal(1<<20,\n\nReview comment:\n       Should probably be a constant, but doesn't need to be fixed here\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.h\n##########\n@@ -73,7 +73,7 @@ class ARROW_DS_EXPORT ScanOptions {\n   RecordBatchProjector projector;\n \n   // Maximum row count for scanned batches.\n-  int64_t batch_size = 1 << 15;\n+  int64_t batch_size = 1 << 20;\n\nReview comment:\n       Should this be a constant `kDefaultBatchSize`?\n\n##########\nFile path: ci/scripts/python_test.sh\n##########\n@@ -29,4 +29,4 @@ export LD_LIBRARY_PATH=${ARROW_HOME}/lib:${LD_LIBRARY_PATH}\n # Enable some checks inside Python itself\n export PYTHONDEVMODE=1\n \n-pytest -r s --pyargs pyarrow\n+pytest -r s -vvv --pyargs pyarrow\n\nReview comment:\n       Revert this?\n\n##########\nFile path: cpp/src/parquet/arrow/reader.cc\n##########\n@@ -856,18 +856,32 @@ Status FileReaderImpl::GetRecordBatchReader(const std::vector<int>& row_groups,\n     return Status::OK();\n   }\n \n+  int64_t num_rows = 0;\n+  for (int row_group : row_groups) {\n+    num_rows += parquet_reader()->metadata()->RowGroup(row_group)->num_rows();\n+  }\n\nReview comment:\n       Should this be a helper method on the FileMetaData?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T18:57:34.562+0000",
                    "updated": "2020-09-25T18:57:34.562+0000",
                    "started": "2020-09-25T18:57:34.561+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491363",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/491481",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r495353478\n\n\n\n##########\nFile path: cpp/src/parquet/arrow/reader.cc\n##########\n@@ -856,18 +856,32 @@ Status FileReaderImpl::GetRecordBatchReader(const std::vector<int>& row_groups,\n     return Status::OK();\n   }\n \n+  int64_t num_rows = 0;\n+  for (int row_group : row_groups) {\n+    num_rows += parquet_reader()->metadata()->RowGroup(row_group)->num_rows();\n+  }\n\nReview comment:\n       I don't think `metadata->RowGroupRowCount(row_group)` is an improvement on `metadata->RowGroup(row_group)->num_rows()`\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-26T00:57:14.045+0000",
                    "updated": "2020-09-26T00:57:14.045+0000",
                    "started": "2020-09-26T00:57:14.045+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491481",
                    "issueId": "13326213"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/worklog/491482",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8188:\nURL: https://github.com/apache/arrow/pull/8188#discussion_r495353620\n\n\n\n##########\nFile path: cpp/src/arrow/dataset/scanner.h\n##########\n@@ -73,7 +73,7 @@ class ARROW_DS_EXPORT ScanOptions {\n   RecordBatchProjector projector;\n \n   // Maximum row count for scanned batches.\n-  int64_t batch_size = 1 << 15;\n+  int64_t batch_size = 1 << 20;\n\nReview comment:\n       Okay\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-26T00:57:37.504+0000",
                    "updated": "2020-09-26T00:57:37.504+0000",
                    "started": "2020-09-26T00:57:37.504+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491482",
                    "issueId": "13326213"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 15000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6787946b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@54aa9858[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@459f8293[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4577aa20[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5495b4d8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4927a89b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@70952036[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@84bb2ae[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7181f40b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@516f9d0[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5cdbfdd4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@950ea23[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Sep 29 19:29:40 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-09-29T19:29:40.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9924/watchers",
            "watchCount": 8,
            "isWatching": false
        },
        "created": "2020-09-06T22:05:12.000+0000",
        "updated": "2020-09-29T19:29:40.000+0000",
        "timeoriginalestimate": null,
        "description": "I haven't investigated very deeply but this seems symptomatic of a problem:\r\n\r\n{code}\r\nIn [27]: df = pd.DataFrame({'A': np.random.randn(10000000)})                                                                                                                              \r\n\r\nIn [28]: pq.write_table(pa.table(df), 'test.parquet')                                                                                                                                     \r\n\r\nIn [29]: timeit pq.read_table('test.parquet')                                                                                                                                             \r\n79.8 ms \u00b1 1.25 ms per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n\r\nIn [30]: timeit pq.read_table('test.parquet', use_legacy_dataset=True)                                                                                                                    \r\n66.4 ms \u00b1 1.33 ms per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Performance regression reading individual Parquet files using Dataset interface",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17191382",
                    "id": "17191382",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "IMHO we should not continue to use the Dataset interface for reading single files by default until the perf regression has been eliminated. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-06T22:13:33.077+0000",
                    "updated": "2020-09-06T22:13:33.077+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17191784",
                    "id": "17191784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "cc [~jorisvandenbossche]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-09-07T16:37:23.480+0000",
                    "updated": "2020-09-07T16:37:23.480+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17192188",
                    "id": "17192188",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "There was one other issue about a performance regression (ARROW-9827), for which I have an open PR (fix to not parse statistics when there is no filter specified). Now, I tried a release build of that branch compared to master, and that doesn't seem to make a difference for this case.\r\n\r\nbq. IMHO we should not continue to use the Dataset interface for reading single files by default until the perf regression has been eliminated. \r\n\r\nThat came up before, and we can certainly still use the old ParquetFile reader if there is eg no {{filter}} specified (we shouldn't use ParquetDataset for this case, though, as was done before 1.0)\r\n\r\n---\r\n\r\nI did a quick profile (with py-spy), and it _seems_ that the dataset version has a bit more overhead in all kinds of iteration (it uses the RecordBatchReader, and not the {{FileReader::ReadTable}} which is specifically to read the whole parquet file at once)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-09-08T12:47:55.754+0000",
                    "updated": "2020-09-08T12:47:55.754+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17192289",
                    "id": "17192289",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I'd prefer to fix the Datasets implementation rather than kicking the can down the road. It doesn't seem reasonable to pay an extra price when using the interface to read a single file. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-08T16:00:38.991+0000",
                    "updated": "2020-09-08T16:00:38.991+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17194834",
                    "id": "17194834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I took a look into this since I was curious what's wrong.\r\n\r\nSo I don't know about this:\r\n\r\n{code}\r\nIn [10]: a = pq.read_table('test.parquet', use_legacy_dataset=True)\r\n\r\nIn [11]: b = pq.read_table('test.parquet', use_legacy_dataset=False)\r\n\r\nIn [12]: a[0].num_chunks\r\nOut[12]: 1\r\n\r\nIn [13]: b[0].num_chunks\r\nOut[13]: 306\r\n{code}\r\n\r\nLooking at the top of the hierarchical perf report for the \"new\" code, the deeply nested layers of iterators strikes me as one thing to think more about whether that's the design we want\r\n\r\nhttps://gist.github.com/wesm/3e3eeb6b7f5f22650f18e69e206c2eb8\r\n\r\nI think the Datasets API may need to make a wiser decision about how to read a file based on the declared intent of the user. If the user calls {{ToTable}}, then I don't think it makes sense to break the problem up into so many small tasks -- perhaps the default chunk size should be larger than it is (so that streaming readers who are concerned about memory use can shrink the chunksize to something smaller)? \r\n\r\nAnother question: why ProjectRecordBatch and FilterRecordBatch being used? Nothing is being projected nor filtered. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-12T19:48:31.191+0000",
                    "updated": "2020-09-12T19:48:31.191+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17194843",
                    "id": "17194843",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I found that with a larger dataset with more columns, the slowdown is much worse\r\n\r\nSetup:\r\n\r\n{code}\r\ndf = pd.DataFrame({'f{0}'.format(i): np.random.randn(10000000) for i in range(50)})\r\npq.write_table(pa.table(df), 'test.parquet')\r\n{code}\r\n\r\nSo we have:\r\n\r\n{code}\r\nIn [1]: timeit pq.read_table('test.parquet', use_legacy_dataset=True)                                                                             \r\n843 ms \u00b1 40 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\r\n\r\nIn [2]: timeit pq.read_table('test.parquet', use_legacy_dataset=False)                                                                            \r\n4.53 s \u00b1 29.3 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-12T20:16:11.460+0000",
                    "updated": "2020-09-12T20:16:11.460+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17194853",
                    "id": "17194853",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Think I found the problem. I expanded the chunk size to 10M so there is a single chunk in both cases and:\r\n\r\n{code}\r\nIn [1]: %time a = pq.read_table('test.parquet', use_legacy_dataset=False)                                                                         \r\nCPU times: user 1.5 s, sys: 2.59 s, total: 4.08 s\r\nWall time: 4.09 s\r\n\r\nIn [2]: %time a = pq.read_table('test.parquet', use_legacy_dataset=True)                                                                          \r\nCPU times: user 3.49 s, sys: 5.28 s, total: 8.77 s\r\nWall time: 1.64 s\r\n{code}\r\n\r\nDigging deeper, another problem is that column decoding is not being parallelized when using the Datasets API, whereas it is when you use {{FileReader::ReadTable}}. This is likely an artifact of the fact that we have not yet tackled the nested parallelism problem in the Datasets API. It's too bad that our users are now suffering the consequences of this.\r\n\r\nSo there are a two problems here:\r\n\r\n* 32K is too small of a default batch size for quickly reading files into memory. I suggest setting it to ~256K or ~1M rows per batch\r\n* Parquet row group deserialization is not being parallelized at the column level in {{parquet::arrow::FileReader::GetRecordBatchReader}}\r\n\r\nThe band-aid solution to this problem will be to use the old code path when no special Datasets features are needed when using {{parquet.read_table}}, but these two issues do need to be fixed. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-12T20:38:17.869+0000",
                    "updated": "2020-09-12T20:38:17.869+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17195633",
                    "id": "17195633",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "{quote}\r\nLooking at the top of the hierarchical perf report for the \"new\" code, the deeply nested layers of iterators strikes me as one thing to think more about whether that's the design we want\r\n{quote}\r\n\r\nTo be clear, is the concern over clarity or performance? IIUC [https://gist.github.com/wesm/3e3eeb6b7f5f22650f18e69e206c2eb8#file-gistfile1-txt-L8-L20] represents minimal cost since 0.65% of runtime was spent managing the Iterator abstraction. If we wanted to replace our abstraction for lazy sequences we could potentially refactor to a {{Future<T>}}-based iteration. Did you have a replacement in mind?\r\n\r\n{quote}\r\nwhy ProjectRecordBatch and FilterRecordBatch being used? Nothing is being projected nor filtered\r\n{quote}\r\n\r\nWe don't explicitly elide them when the projection or filter is trivial. I could try to benchmark whether there is a significant performance benefit to adding a special case for trivial projection/filtering, but I'd guess we don't gain anything.\r\n\r\nAnother potential bandaid fix would be to allow column level parallelism when scanning a single file (since no thread contention would be incurred) (combined with increasing batch size).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-14T17:23:23.364+0000",
                    "updated": "2020-09-14T17:23:23.364+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17195647",
                    "id": "17195647",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "My principle concern is addressing the performance regressions, which are especially grave considering that they affect one of the (if not *the*) most-called user-facing APIs in the whole Arrow project. The other questions we can investigate as follow up matters. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-14T17:39:43.423+0000",
                    "updated": "2020-09-14T17:39:43.423+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13326213/comment/17204226",
                    "id": "17204226",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 8188\n[https://github.com/apache/arrow/pull/8188]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-29T19:29:40.771+0000",
                    "updated": "2020-09-29T19:29:40.771+0000"
                }
            ],
            "maxResults": 10,
            "total": 10,
            "startAt": 0
        },
        "customfield_12311820": "0|z0idds:",
        "customfield_12314139": null
    }
}