{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13320797",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797",
    "key": "ARROW-9642",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12598312",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12598312",
                "type": {
                    "id": "12310051",
                    "name": "Supercedes",
                    "inward": "is superceded by",
                    "outward": "supercedes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310051"
                },
                "outwardIssue": {
                    "id": "13278219",
                    "key": "ARROW-7517",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13278219",
                    "fields": {
                        "summary": "[C++] Builder does not honour dictionary type provided during initialization",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=mrkn",
            "name": "mrkn",
            "key": "mrkn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Kenta Murata",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=mrkn",
            "name": "mrkn",
            "key": "mrkn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Kenta Murata",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=mrkn",
            "name": "mrkn",
            "key": "mrkn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Kenta Murata",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 17400,
            "total": 17400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 17400,
            "total": 17400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9642/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 29,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/466078",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn opened a new pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-04T07:25:14.401+0000",
                    "updated": "2020-08-04T07:25:14.401+0000",
                    "started": "2020-08-04T07:25:14.401+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "466078",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/466086",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#issuecomment-668440282\n\n\n   https://issues.apache.org/jira/browse/ARROW-9642\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-04T07:49:18.900+0000",
                    "updated": "2020-08-04T07:49:18.900+0000",
                    "started": "2020-08-04T07:49:18.900+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "466086",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/468657",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r467947160\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -409,6 +409,10 @@ class DictionaryBuilder : public internal::DictionaryBuilderBase<AdaptiveIntBuil\n   using BASE = internal::DictionaryBuilderBase<AdaptiveIntBuilder, T>;\n   using BASE::BASE;\n \n+  Status ExpandIndexByteWidth(uint8_t new_index_byte_width) {\n+    return BASE::indices_builder_.ExpandIntSize(new_index_byte_width);\n\nReview comment:\n       Wouldn't it be better to add a new constructor signature, such as:\r\n   ```c++\r\n   DictionaryBuilderBase(const std::shared_ptr<DataType>& start_index_type,\r\n                         const std::shared_ptr<DataType>& value_type,\r\n                         MemoryPool* pool = default_memory_pool())\r\n   ```\r\n   ?\n\n##########\nFile path: cpp/src/arrow/array/builder_adaptive.h\n##########\n@@ -122,9 +122,10 @@ class ARROW_EXPORT AdaptiveUIntBuilder : public internal::AdaptiveIntBuilderBase\n \n   std::shared_ptr<DataType> type() const override;\n \n+  Status ExpandIntSize(uint8_t new_int_size);\n\nReview comment:\n       Hmm... I don't think it is required to make this public. Is it?\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -22,6 +22,8 @@\n #include <string>\n #include <vector>\n \n+#include <iostream>\n\nReview comment:\n       Is this necessary? If so, please put this include with the standard library includes above.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-10T14:37:05.598+0000",
                    "updated": "2020-08-10T14:37:05.598+0000",
                    "started": "2020-08-10T14:37:05.598+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "468657",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469266",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r468656539\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -22,6 +22,8 @@\n #include <string>\n #include <vector>\n \n+#include <iostream>\n\nReview comment:\n       This should be removed before committing but I forgot.\r\n   Thanks for catching this!\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-11T15:10:57.440+0000",
                    "updated": "2020-08-11T15:10:57.440+0000",
                    "started": "2020-08-11T15:10:57.439+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469266",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469268",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r468657312\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -409,6 +409,10 @@ class DictionaryBuilder : public internal::DictionaryBuilderBase<AdaptiveIntBuil\n   using BASE = internal::DictionaryBuilderBase<AdaptiveIntBuilder, T>;\n   using BASE::BASE;\n \n+  Status ExpandIndexByteWidth(uint8_t new_index_byte_width) {\n+    return BASE::indices_builder_.ExpandIntSize(new_index_byte_width);\n\nReview comment:\n       I see. I try to rewrite this way.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-11T15:12:06.020+0000",
                    "updated": "2020-08-11T15:12:06.020+0000",
                    "started": "2020-08-11T15:12:06.020+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469268",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469457",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#issuecomment-672392348\n\n\n   @pitrou @wesm I found that DictionaryBuilderCase rejects that the value type is NullType though there is the specialization of DictionaryBuilderBase with T=NullType.  Is this intentional?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T00:21:55.185+0000",
                    "updated": "2020-08-12T00:21:55.185+0000",
                    "started": "2020-08-12T00:21:55.185+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469457",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469458",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn edited a comment on pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#issuecomment-672392348\n\n\n   @pitrou @wesm I found that `DictionaryBuilderCase` rejects that the value type is `NullType` though there is the specialization of `DictionaryBuilderBase` with `T=NullType`.  Is this intentional?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T00:22:18.113+0000",
                    "updated": "2020-08-12T00:22:18.113+0000",
                    "started": "2020-08-12T00:22:18.113+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469458",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469582",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#issuecomment-672720419\n\n\n   @mrkn I don't think it is, feel free to add it :-)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T08:18:46.273+0000",
                    "updated": "2020-08-12T08:18:46.273+0000",
                    "started": "2020-08-12T08:18:46.273+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469582",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469591",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#issuecomment-672733878\n\n\n   @pitrou OK, I'll do it.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T08:34:32.724+0000",
                    "updated": "2020-08-12T08:34:32.724+0000",
                    "started": "2020-08-12T08:34:32.724+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469591",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469732",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r469298490\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -409,6 +409,10 @@ class DictionaryBuilder : public internal::DictionaryBuilderBase<AdaptiveIntBuil\n   using BASE = internal::DictionaryBuilderBase<AdaptiveIntBuilder, T>;\n   using BASE::BASE;\n \n+  Status ExpandIndexByteWidth(uint8_t new_index_byte_width) {\n+    return BASE::indices_builder_.ExpandIntSize(new_index_byte_width);\n\nReview comment:\n       @pitrou I've done to do this.  Could you please review this again?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T14:24:25.526+0000",
                    "updated": "2020-08-12T14:24:25.526+0000",
                    "started": "2020-08-12T14:24:25.526+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469732",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469733",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r469298987\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_adaptive.h\n##########\n@@ -122,9 +122,10 @@ class ARROW_EXPORT AdaptiveUIntBuilder : public internal::AdaptiveIntBuilderBase\n \n   std::shared_ptr<DataType> type() const override;\n \n+  Status ExpandIntSize(uint8_t new_int_size);\n\nReview comment:\n       This function needn't be public anymore.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T14:25:00.531+0000",
                    "updated": "2020-08-12T14:25:00.531+0000",
                    "started": "2020-08-12T14:25:00.531+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469733",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/469794",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r469387808\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_test.cc\n##########\n@@ -2029,6 +2029,19 @@ TEST_F(TestAdaptiveIntBuilder, TestAppendNulls) {\n   }\n }\n \n+TEST(TestAdaptiveIntBuilderWithStartIntSize, TestReset) {\n+  auto builder = std::make_shared<AdaptiveIntBuilder>(\n+      static_cast<uint8_t>(sizeof(int16_t)), default_memory_pool());\n+  ASSERT_TRUE(int16()->Equals(*builder->type()));\n+\n+  ASSERT_OK(\n+      builder->Append(static_cast<int64_t>(std::numeric_limits<int16_t>::max()) + 1));\n+  ASSERT_TRUE(int32()->Equals(*builder->type()));\n\nReview comment:\n       Same here.\n\n##########\nFile path: cpp/src/arrow/array/array_test.cc\n##########\n@@ -2029,6 +2029,19 @@ TEST_F(TestAdaptiveIntBuilder, TestAppendNulls) {\n   }\n }\n \n+TEST(TestAdaptiveIntBuilderWithStartIntSize, TestReset) {\n+  auto builder = std::make_shared<AdaptiveIntBuilder>(\n+      static_cast<uint8_t>(sizeof(int16_t)), default_memory_pool());\n+  ASSERT_TRUE(int16()->Equals(*builder->type()));\n\nReview comment:\n       `AssertTypeEqual`?\n\n##########\nFile path: cpp/src/arrow/array/array_test.cc\n##########\n@@ -2029,6 +2029,19 @@ TEST_F(TestAdaptiveIntBuilder, TestAppendNulls) {\n   }\n }\n \n+TEST(TestAdaptiveIntBuilderWithStartIntSize, TestReset) {\n+  auto builder = std::make_shared<AdaptiveIntBuilder>(\n+      static_cast<uint8_t>(sizeof(int16_t)), default_memory_pool());\n+  ASSERT_TRUE(int16()->Equals(*builder->type()));\n+\n+  ASSERT_OK(\n+      builder->Append(static_cast<int64_t>(std::numeric_limits<int16_t>::max()) + 1));\n+  ASSERT_TRUE(int32()->Equals(*builder->type()));\n+\n+  builder->Reset();\n+  ASSERT_TRUE(int16()->Equals(*builder->type()));\n\nReview comment:\n       Same here.\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -105,18 +105,46 @@ class DictionaryBuilderBase : public ArrayBuilder {\n \n   // WARNING: the type given below is the value type, not the DictionaryType.\n   // The DictionaryType is instantiated on the Finish() call.\n-  template <typename T1 = T>\n-  DictionaryBuilderBase(enable_if_t<!std::is_base_of<FixedSizeBinaryType, T1>::value,\n+  template <typename B = BuilderType, typename T1 = T>\n+  DictionaryBuilderBase(uint8_t start_int_size,\n+                        enable_if_t<std::is_base_of<AdaptiveIntBuilderBase, B>::value &&\n+                                        !is_fixed_size_binary_type<T1>::value,\n                                     const std::shared_ptr<DataType>&>\n                             value_type,\n                         MemoryPool* pool = default_memory_pool())\n+      : ArrayBuilder(pool),\n+        memo_table_(new internal::DictionaryMemoTable(pool, value_type)),\n+        delta_offset_(0),\n+        byte_width_(-1),\n+        indices_builder_(start_int_size, pool),\n+        value_type_(value_type) {}\n+\n+  template <typename T1 = T>\n+  DictionaryBuilderBase(\n\nReview comment:\n       Would the following work instead:\r\n   ```c++\r\n   DictionaryBuilderBase(const std::shared_ptr<DataType>& value_type, MemoryPool* pool = default_memory_pool())\r\n     : DictionaryBuilderBase(sizeof(int8_t), value_type, pool) {}\r\n   ```\r\n   ?\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n+  ASSERT_EQ(11, builder.length());\n+  ASSERT_EQ(11, builder.null_count());\n+\n+  std::shared_ptr<Array> result;\n+  ASSERT_OK(builder.Finish(&result));\n+  ASSERT_TRUE(dict_type->Equals(*result->type()));\n\nReview comment:\n       `AssertTypeEquals`\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       So one can append an array of ints to a null dictionary builder? What does it mean?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-12T16:37:01.885+0000",
                    "updated": "2020-08-12T16:37:01.885+0000",
                    "started": "2020-08-12T16:37:01.885+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "469794",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/470225",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r469945583\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -105,18 +105,46 @@ class DictionaryBuilderBase : public ArrayBuilder {\n \n   // WARNING: the type given below is the value type, not the DictionaryType.\n   // The DictionaryType is instantiated on the Finish() call.\n-  template <typename T1 = T>\n-  DictionaryBuilderBase(enable_if_t<!std::is_base_of<FixedSizeBinaryType, T1>::value,\n+  template <typename B = BuilderType, typename T1 = T>\n+  DictionaryBuilderBase(uint8_t start_int_size,\n+                        enable_if_t<std::is_base_of<AdaptiveIntBuilderBase, B>::value &&\n+                                        !is_fixed_size_binary_type<T1>::value,\n                                     const std::shared_ptr<DataType>&>\n                             value_type,\n                         MemoryPool* pool = default_memory_pool())\n+      : ArrayBuilder(pool),\n+        memo_table_(new internal::DictionaryMemoTable(pool, value_type)),\n+        delta_offset_(0),\n+        byte_width_(-1),\n+        indices_builder_(start_int_size, pool),\n+        value_type_(value_type) {}\n+\n+  template <typename T1 = T>\n+  DictionaryBuilderBase(\n\nReview comment:\n       This constructor is for the cases that BuilderType is not AdaptiveIntBuilder.  The constructor for the case of AdaptiveIntBuilder cannot be reused by this constructor because the constructor of a non-adaptive IntBuilder (i.e. `indices_builder_`) doesn't take the `start_int_size` argument.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T13:21:05.738+0000",
                    "updated": "2020-08-13T13:21:05.738+0000",
                    "started": "2020-08-13T13:21:05.738+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470225",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/470234",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r469954523\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       I think this is practically meaningless.  It is the same as `AppendNulls` as its implementation.  But, as  `AppendArray` function in `DictionaryBuilder` of `NullType` actually accepts an Array of any type, I believe we should test the behavior.\r\n   \r\n   We probably need to check the value type of the given `Array` in `AppendArray`.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T13:34:09.883+0000",
                    "updated": "2020-08-13T13:34:09.883+0000",
                    "started": "2020-08-13T13:34:09.883+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470234",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/470259",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r470001711\n\n\n\n##########\nFile path: cpp/src/arrow/array/builder_dict.h\n##########\n@@ -105,18 +105,46 @@ class DictionaryBuilderBase : public ArrayBuilder {\n \n   // WARNING: the type given below is the value type, not the DictionaryType.\n   // The DictionaryType is instantiated on the Finish() call.\n-  template <typename T1 = T>\n-  DictionaryBuilderBase(enable_if_t<!std::is_base_of<FixedSizeBinaryType, T1>::value,\n+  template <typename B = BuilderType, typename T1 = T>\n+  DictionaryBuilderBase(uint8_t start_int_size,\n+                        enable_if_t<std::is_base_of<AdaptiveIntBuilderBase, B>::value &&\n+                                        !is_fixed_size_binary_type<T1>::value,\n                                     const std::shared_ptr<DataType>&>\n                             value_type,\n                         MemoryPool* pool = default_memory_pool())\n+      : ArrayBuilder(pool),\n+        memo_table_(new internal::DictionaryMemoTable(pool, value_type)),\n+        delta_offset_(0),\n+        byte_width_(-1),\n+        indices_builder_(start_int_size, pool),\n+        value_type_(value_type) {}\n+\n+  template <typename T1 = T>\n+  DictionaryBuilderBase(\n\nReview comment:\n       Ah, I see, sorry.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-13T14:38:43.109+0000",
                    "updated": "2020-08-13T14:38:43.109+0000",
                    "started": "2020-08-13T14:38:43.109+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470259",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/470700",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r470633675\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       @pitrou How about this?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-14T13:47:23.496+0000",
                    "updated": "2020-08-14T13:47:23.496+0000",
                    "started": "2020-08-14T13:47:23.496+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "470700",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/471491",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r471486448\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       Checking the array type in each `AppendArray` call may result in performance degradation.\r\n   However, we should certainly _not_ assert that passing the wrong type passes silently.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-17T13:41:53.022+0000",
                    "updated": "2020-08-17T13:41:53.022+0000",
                    "started": "2020-08-17T13:41:53.022+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "471491",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/473011",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r474160038\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       @pitrou I replaced the `int_array` by `null_array`.\r\n   How do you think inserting `DCHECK` in `AppendArray` to check the array type only in the debug build?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T17:37:49.676+0000",
                    "updated": "2020-08-20T17:37:49.676+0000",
                    "started": "2020-08-20T17:37:49.676+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473011",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/474265",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r476407343\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       @mrkn Sorry for the delay. That sounds fine to me.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-25T12:25:08.076+0000",
                    "updated": "2020-08-25T12:25:08.076+0000",
                    "started": "2020-08-25T12:25:08.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "474265",
                    "issueId": "13320797"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/worklog/475142",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "mrkn commented on a change in pull request #7898:\nURL: https://github.com/apache/arrow/pull/7898#discussion_r478143508\n\n\n\n##########\nFile path: cpp/src/arrow/array/array_dict_test.cc\n##########\n@@ -904,6 +904,67 @@ TEST(TestDecimalDictionaryBuilder, DoubleTableSize) {\n   ASSERT_TRUE(expected.Equals(result));\n }\n \n+TEST(TestNullDictionaryBuilder, Basic) {\n+  // MakeBuilder\n+  auto dict_type = dictionary(int8(), null());\n+  std::unique_ptr<ArrayBuilder> boxed_builder;\n+  ASSERT_OK(MakeBuilder(default_memory_pool(), dict_type, &boxed_builder));\n+  auto& builder = checked_cast<DictionaryBuilder<NullType>&>(*boxed_builder);\n+\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_OK(builder.AppendNull());\n+  ASSERT_EQ(3, builder.length());\n+  ASSERT_EQ(3, builder.null_count());\n+\n+  ASSERT_OK(builder.AppendNulls(4));\n+  ASSERT_EQ(7, builder.length());\n+  ASSERT_EQ(7, builder.null_count());\n+\n+  auto int_array = ArrayFromJSON(int8(), \"[0, 1, 0, null]\");\n+  ASSERT_OK(builder.AppendArray(*int_array));\n\nReview comment:\n       @pitrou I tried to directly insert `DCHECK` in `AppendArray`, but I found it is difficult because `AppendArray` is defined in `builder_dict.h`. That is a public header file` so we cannot use `DCHECK` there.\r\n   \r\n   Instead of directly inserting `DCHECK`, the candidate patch is below.\r\n   \r\n   ```diff\r\n   diff --git a/cpp/src/arrow/array/builder_dict.cc b/cpp/src/arrow/array/builder_dict.cc\r\n   index 54fd94856..dc239f268 100644\r\n   --- a/cpp/src/arrow/array/builder_dict.cc\r\n   +++ b/cpp/src/arrow/array/builder_dict.cc\r\n   @@ -189,5 +189,11 @@ Status DictionaryMemoTable::InsertValues(const Array& array) {\r\n   \r\n    int32_t DictionaryMemoTable::size() const { return impl_->size(); }\r\n   \r\n   +#ifndef NDEBUG\r\n   +void CheckArrayType(const Type::type type_id, const Array& array, const std::string& message) {\r\n   +  DCHECK_EQ(type_id, array.type_id()) << message;\r\n   +}\r\n   +#endif\r\n   +\r\n    }  // namespace internal\r\n    }  // namespace arrow\r\n   diff --git a/cpp/src/arrow/array/builder_dict.h b/cpp/src/arrow/array/builder_dict.h\r\n   index f8c77a5b0..a0d02fd1b 100644\r\n   --- a/cpp/src/arrow/array/builder_dict.h\r\n   +++ b/cpp/src/arrow/array/builder_dict.h\r\n   @@ -93,6 +93,10 @@ class ARROW_EXPORT DictionaryMemoTable {\r\n      std::unique_ptr<DictionaryMemoTableImpl> impl_;\r\n    };\r\n   \r\n   +#ifndef NDEBUG\r\n   +void CheckArrayType(const Type::type type_id, const Array& array, const std::string& message);\r\n   +#endif\r\n   +\r\n    /// \\brief Array builder for created encoded DictionaryArray from\r\n    /// dense array\r\n    ///\r\n   @@ -248,6 +252,10 @@ class DictionaryBuilderBase : public ArrayBuilder {\r\n          const Array& array) {\r\n        using ArrayType = typename TypeTraits<T>::ArrayType;\r\n   \r\n   +#ifndef NDEBUG\r\n   +    CheckArrayType(T::type_id, array, \"Wrong value type of array to be appended\");\r\n   +#endif\r\n   +\r\n        const auto& concrete_array = static_cast<const ArrayType&>(array);\r\n        for (int64_t i = 0; i < array.length(); i++) {\r\n          if (array.IsNull(i)) {\r\n   @@ -406,6 +414,9 @@ class DictionaryBuilderBase<BuilderType, NullType> : public ArrayBuilder {\r\n   \r\n      /// \\brief Append a whole dense array to the builder\r\n      Status AppendArray(const Array& array) {\r\n   +#ifndef NDEBUG\r\n   +    CheckArrayType(NullType::type_id, array, \"Wrong value type of array to be appended\");\r\n   +#endif\r\n        for (int64_t i = 0; i < array.length(); i++) {\r\n          ARROW_RETURN_NOT_OK(AppendNull());\r\n        }\r\n    };\r\n   \r\n    }  // namespace internal\r\n   ```\r\n   \r\n   I don't think this approach is good.  Can I follow this way?\r\n   \r\n   By the way, I found that `AppendArray` for `DictionaryBuilderBase` of `FixedSizedBinaryType` checks the array type at the beginning of the function and return `Status::Invalid` when mismatching type types.  I guess if this kind of check is accepted for `FixedSizedBinaryType`, the same kind of check can be put in the other `AppendArray` functions.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-27T05:37:20.716+0000",
                    "updated": "2020-08-27T05:37:20.716+0000",
                    "started": "2020-08-27T05:37:20.716+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "475142",
                    "issueId": "13320797"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 17400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@34d4917c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@625567b2[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@39003f22[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@70a1b747[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@f744e0b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@5eca14d7[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@668bd903[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1bed411a[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3644507a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@38a686c9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@dd031f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7149778f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 17400,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Sep 01 14:40:40 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-09-01T14:40:40.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9642/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-08-04T07:22:40.000+0000",
        "updated": "2020-09-07T16:16:00.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 17400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Let MakeBuilder refer DictionaryType's index_type for deciding the starting bit width of the indices",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13320797/comment/17188512",
                    "id": "17188512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 7898\n[https://github.com/apache/arrow/pull/7898]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-09-01T14:40:40.432+0000",
                    "updated": "2020-09-01T14:40:40.432+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0hg2w:",
        "customfield_12314139": null
    }
}