{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13405251",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251",
    "key": "ARROW-14244",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 7200,
            "total": 7200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14244/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 12,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661599",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou opened a new pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353\n\n\n   * Split unary and binary kernels into two distinct translation units\r\n   * Fix temporal codegen infrastructure so as not to generate code for kernels\r\n     for unused argument types (e.g. avoid generating code for time inputs\r\n     if a kernel is only defined for date types)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T13:19:36.302+0000",
                    "updated": "2021-10-07T13:19:36.302+0000",
                    "started": "2021-10-07T13:19:36.301+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661599",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661601",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#issuecomment-937785821\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T13:20:03.248+0000",
                    "updated": "2021-10-07T13:20:03.248+0000",
                    "started": "2021-10-07T13:20:03.248+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661601",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724179495\n\n\n\n##########\nFile path: cpp/src/arrow/CMakeLists.txt\n##########\n@@ -400,11 +400,13 @@ if(ARROW_COMPUTE)\n        compute/kernels/scalar_cast_numeric.cc\n        compute/kernels/scalar_cast_string.cc\n        compute/kernels/scalar_cast_temporal.cc\n+       compute/kernels/scalar_cast_temporal.cc\n\nReview comment:\n       Was this meant to be duplicated?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/temporal_internal.h\n##########\n@@ -93,6 +103,48 @@ struct ZonedLocalizer {\n   local_days ConvertDays(sys_days d) const { return local_days(year_month_day(d)); }\n };\n \n+//\n+// Which types to generate a kernel for\n+//\n+struct WithDates {};\n+struct WithTimes {};\n+struct WithTimestamps {};\n+\n+// This helper allows generating temporal kernels for selected type categories\n+// without any spurious code generation for other categories (e.g. avoid\n+// generating code for date kernels for a times-only function).\n+template <typename Factory>\n+void AddTemporalKernels(Factory* fac) {}\n\nReview comment:\n       Slick!\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_binary.cc\n##########\n@@ -0,0 +1,546 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include <cmath>\n+#include <initializer_list>\n+#include <sstream>\n+\n+#include \"arrow/builder.h\"\n+#include \"arrow/compute/api_scalar.h\"\n+#include \"arrow/compute/kernels/common.h\"\n+#include \"arrow/compute/kernels/temporal_internal.h\"\n+#include \"arrow/util/checked_cast.h\"\n+#include \"arrow/util/time.h\"\n+#include \"arrow/vendored/datetime.h\"\n+\n+namespace arrow {\n+\n+using internal::checked_cast;\n+using internal::checked_pointer_cast;\n+\n+namespace compute {\n+namespace internal {\n+\n+namespace {\n+\n+using arrow_vendored::date::days;\n+using arrow_vendored::date::floor;\n+using arrow_vendored::date::hh_mm_ss;\n+using arrow_vendored::date::local_days;\n+using arrow_vendored::date::local_time;\n+using arrow_vendored::date::locate_zone;\n+using arrow_vendored::date::sys_days;\n+using arrow_vendored::date::sys_time;\n+using arrow_vendored::date::time_zone;\n+using arrow_vendored::date::trunc;\n+using arrow_vendored::date::weekday;\n+using arrow_vendored::date::weeks;\n+using arrow_vendored::date::year_month_day;\n+using arrow_vendored::date::year_month_weekday;\n+using arrow_vendored::date::years;\n+using arrow_vendored::date::zoned_time;\n+using arrow_vendored::date::literals::dec;\n+using arrow_vendored::date::literals::jan;\n+using arrow_vendored::date::literals::last;\n+using arrow_vendored::date::literals::mon;\n+using arrow_vendored::date::literals::sun;\n+using arrow_vendored::date::literals::thu;\n+using arrow_vendored::date::literals::wed;\n+using internal::applicator::ScalarBinaryNotNullStatefulEqualTypes;\n+\n+using DayOfWeekState = OptionsWrapper<DayOfWeekOptions>;\n+using WeekState = OptionsWrapper<WeekOptions>;\n+\n+Status CheckTimezones(const ExecBatch& batch) {\n+  const auto& timezone = GetInputTimezone(batch.values[0]);\n+  for (int i = 1; i < batch.num_values(); i++) {\n+    const auto& other_timezone = GetInputTimezone(batch.values[i]);\n+    if (other_timezone != timezone) {\n+      return Status::TypeError(\"Got differing time zone '\", other_timezone,\n+                               \"' for argument \", i + 1, \"; expected '\", timezone, \"'\");\n+    }\n+  }\n+  return Status::OK();\n+}\n+\n+int64_t GetQuarter(const year_month_day& ymd) {\n\nReview comment:\n       This is causing a CI error - suppose it needs to be promoted to the header.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T13:36:04.864+0000",
                    "updated": "2021-10-07T13:36:04.864+0000",
                    "started": "2021-10-07T13:36:04.864+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661606",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661609",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724192552\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_binary.cc\n##########\n@@ -0,0 +1,546 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include <cmath>\n+#include <initializer_list>\n+#include <sstream>\n+\n+#include \"arrow/builder.h\"\n+#include \"arrow/compute/api_scalar.h\"\n+#include \"arrow/compute/kernels/common.h\"\n+#include \"arrow/compute/kernels/temporal_internal.h\"\n+#include \"arrow/util/checked_cast.h\"\n+#include \"arrow/util/time.h\"\n+#include \"arrow/vendored/datetime.h\"\n+\n+namespace arrow {\n+\n+using internal::checked_cast;\n+using internal::checked_pointer_cast;\n+\n+namespace compute {\n+namespace internal {\n+\n+namespace {\n+\n+using arrow_vendored::date::days;\n+using arrow_vendored::date::floor;\n+using arrow_vendored::date::hh_mm_ss;\n+using arrow_vendored::date::local_days;\n+using arrow_vendored::date::local_time;\n+using arrow_vendored::date::locate_zone;\n+using arrow_vendored::date::sys_days;\n+using arrow_vendored::date::sys_time;\n+using arrow_vendored::date::time_zone;\n+using arrow_vendored::date::trunc;\n+using arrow_vendored::date::weekday;\n+using arrow_vendored::date::weeks;\n+using arrow_vendored::date::year_month_day;\n+using arrow_vendored::date::year_month_weekday;\n+using arrow_vendored::date::years;\n+using arrow_vendored::date::zoned_time;\n+using arrow_vendored::date::literals::dec;\n+using arrow_vendored::date::literals::jan;\n+using arrow_vendored::date::literals::last;\n+using arrow_vendored::date::literals::mon;\n+using arrow_vendored::date::literals::sun;\n+using arrow_vendored::date::literals::thu;\n+using arrow_vendored::date::literals::wed;\n+using internal::applicator::ScalarBinaryNotNullStatefulEqualTypes;\n+\n+using DayOfWeekState = OptionsWrapper<DayOfWeekOptions>;\n+using WeekState = OptionsWrapper<WeekOptions>;\n+\n+Status CheckTimezones(const ExecBatch& batch) {\n+  const auto& timezone = GetInputTimezone(batch.values[0]);\n+  for (int i = 1; i < batch.num_values(); i++) {\n+    const auto& other_timezone = GetInputTimezone(batch.values[i]);\n+    if (other_timezone != timezone) {\n+      return Status::TypeError(\"Got differing time zone '\", other_timezone,\n+                               \"' for argument \", i + 1, \"; expected '\", timezone, \"'\");\n+    }\n+  }\n+  return Status::OK();\n+}\n+\n+int64_t GetQuarter(const year_month_day& ymd) {\n\nReview comment:\n       Will do.\n\n##########\nFile path: cpp/src/arrow/CMakeLists.txt\n##########\n@@ -400,11 +400,13 @@ if(ARROW_COMPUTE)\n        compute/kernels/scalar_cast_numeric.cc\n        compute/kernels/scalar_cast_string.cc\n        compute/kernels/scalar_cast_temporal.cc\n+       compute/kernels/scalar_cast_temporal.cc\n\nReview comment:\n       Nope :-)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T13:41:42.857+0000",
                    "updated": "2021-10-07T13:41:42.857+0000",
                    "started": "2021-10-07T13:41:42.856+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661609",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661618",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724203465\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/temporal_internal.h\n##########\n@@ -93,6 +103,48 @@ struct ZonedLocalizer {\n   local_days ConvertDays(sys_days d) const { return local_days(year_month_day(d)); }\n };\n \n+//\n+// Which types to generate a kernel for\n+//\n+struct WithDates {};\n+struct WithTimes {};\n+struct WithTimestamps {};\n+\n+// This helper allows generating temporal kernels for selected type categories\n+// without any spurious code generation for other categories (e.g. avoid\n+// generating code for date kernels for a times-only function).\n+template <typename Factory>\n+void AddTemporalKernels(Factory* fac) {}\n\nReview comment:\n       Indeed!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T13:53:34.431+0000",
                    "updated": "2021-10-07T13:53:34.431+0000",
                    "started": "2021-10-07T13:53:34.431+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661618",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661652",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T14:26:23.326+0000",
                    "updated": "2021-10-07T14:26:23.326+0000",
                    "started": "2021-10-07T14:26:23.325+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661652",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/661991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#issuecomment-937785821\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:07:11.467+0000",
                    "updated": "2021-10-07T23:07:11.467+0000",
                    "started": "2021-10-07T23:07:11.467+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "661991",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/662058",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724203465\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/temporal_internal.h\n##########\n@@ -93,6 +103,48 @@ struct ZonedLocalizer {\n   local_days ConvertDays(sys_days d) const { return local_days(year_month_day(d)); }\n };\n \n+//\n+// Which types to generate a kernel for\n+//\n+struct WithDates {};\n+struct WithTimes {};\n+struct WithTimestamps {};\n+\n+// This helper allows generating temporal kernels for selected type categories\n+// without any spurious code generation for other categories (e.g. avoid\n+// generating code for date kernels for a times-only function).\n+template <typename Factory>\n+void AddTemporalKernels(Factory* fac) {}\n\nReview comment:\n       Indeed!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:13:07.116+0000",
                    "updated": "2021-10-07T23:13:07.116+0000",
                    "started": "2021-10-07T23:13:07.116+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662058",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/662180",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou opened a new pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353\n\n\n   * Split unary and binary kernels into two distinct translation units\r\n   * Fix temporal codegen infrastructure so as not to generate code for kernels\r\n     for unused argument types (e.g. avoid generating code for time inputs\r\n     if a kernel is only defined for date types)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:23:44.836+0000",
                    "updated": "2021-10-07T23:23:44.836+0000",
                    "started": "2021-10-07T23:23:44.836+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662180",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/662212",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724179495\n\n\n\n##########\nFile path: cpp/src/arrow/CMakeLists.txt\n##########\n@@ -400,11 +400,13 @@ if(ARROW_COMPUTE)\n        compute/kernels/scalar_cast_numeric.cc\n        compute/kernels/scalar_cast_string.cc\n        compute/kernels/scalar_cast_temporal.cc\n+       compute/kernels/scalar_cast_temporal.cc\n\nReview comment:\n       Was this meant to be duplicated?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/temporal_internal.h\n##########\n@@ -93,6 +103,48 @@ struct ZonedLocalizer {\n   local_days ConvertDays(sys_days d) const { return local_days(year_month_day(d)); }\n };\n \n+//\n+// Which types to generate a kernel for\n+//\n+struct WithDates {};\n+struct WithTimes {};\n+struct WithTimestamps {};\n+\n+// This helper allows generating temporal kernels for selected type categories\n+// without any spurious code generation for other categories (e.g. avoid\n+// generating code for date kernels for a times-only function).\n+template <typename Factory>\n+void AddTemporalKernels(Factory* fac) {}\n\nReview comment:\n       Slick!\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_binary.cc\n##########\n@@ -0,0 +1,546 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include <cmath>\n+#include <initializer_list>\n+#include <sstream>\n+\n+#include \"arrow/builder.h\"\n+#include \"arrow/compute/api_scalar.h\"\n+#include \"arrow/compute/kernels/common.h\"\n+#include \"arrow/compute/kernels/temporal_internal.h\"\n+#include \"arrow/util/checked_cast.h\"\n+#include \"arrow/util/time.h\"\n+#include \"arrow/vendored/datetime.h\"\n+\n+namespace arrow {\n+\n+using internal::checked_cast;\n+using internal::checked_pointer_cast;\n+\n+namespace compute {\n+namespace internal {\n+\n+namespace {\n+\n+using arrow_vendored::date::days;\n+using arrow_vendored::date::floor;\n+using arrow_vendored::date::hh_mm_ss;\n+using arrow_vendored::date::local_days;\n+using arrow_vendored::date::local_time;\n+using arrow_vendored::date::locate_zone;\n+using arrow_vendored::date::sys_days;\n+using arrow_vendored::date::sys_time;\n+using arrow_vendored::date::time_zone;\n+using arrow_vendored::date::trunc;\n+using arrow_vendored::date::weekday;\n+using arrow_vendored::date::weeks;\n+using arrow_vendored::date::year_month_day;\n+using arrow_vendored::date::year_month_weekday;\n+using arrow_vendored::date::years;\n+using arrow_vendored::date::zoned_time;\n+using arrow_vendored::date::literals::dec;\n+using arrow_vendored::date::literals::jan;\n+using arrow_vendored::date::literals::last;\n+using arrow_vendored::date::literals::mon;\n+using arrow_vendored::date::literals::sun;\n+using arrow_vendored::date::literals::thu;\n+using arrow_vendored::date::literals::wed;\n+using internal::applicator::ScalarBinaryNotNullStatefulEqualTypes;\n+\n+using DayOfWeekState = OptionsWrapper<DayOfWeekOptions>;\n+using WeekState = OptionsWrapper<WeekOptions>;\n+\n+Status CheckTimezones(const ExecBatch& batch) {\n+  const auto& timezone = GetInputTimezone(batch.values[0]);\n+  for (int i = 1; i < batch.num_values(); i++) {\n+    const auto& other_timezone = GetInputTimezone(batch.values[i]);\n+    if (other_timezone != timezone) {\n+      return Status::TypeError(\"Got differing time zone '\", other_timezone,\n+                               \"' for argument \", i + 1, \"; expected '\", timezone, \"'\");\n+    }\n+  }\n+  return Status::OK();\n+}\n+\n+int64_t GetQuarter(const year_month_day& ymd) {\n\nReview comment:\n       This is causing a CI error - suppose it needs to be promoted to the header.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:26:10.920+0000",
                    "updated": "2021-10-07T23:26:10.920+0000",
                    "started": "2021-10-07T23:26:10.919+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662212",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/662324",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:35:25.245+0000",
                    "updated": "2021-10-07T23:35:25.245+0000",
                    "started": "2021-10-07T23:35:25.244+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662324",
                    "issueId": "13405251"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/worklog/662396",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #11353:\nURL: https://github.com/apache/arrow/pull/11353#discussion_r724192552\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/scalar_temporal_binary.cc\n##########\n@@ -0,0 +1,546 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include <cmath>\n+#include <initializer_list>\n+#include <sstream>\n+\n+#include \"arrow/builder.h\"\n+#include \"arrow/compute/api_scalar.h\"\n+#include \"arrow/compute/kernels/common.h\"\n+#include \"arrow/compute/kernels/temporal_internal.h\"\n+#include \"arrow/util/checked_cast.h\"\n+#include \"arrow/util/time.h\"\n+#include \"arrow/vendored/datetime.h\"\n+\n+namespace arrow {\n+\n+using internal::checked_cast;\n+using internal::checked_pointer_cast;\n+\n+namespace compute {\n+namespace internal {\n+\n+namespace {\n+\n+using arrow_vendored::date::days;\n+using arrow_vendored::date::floor;\n+using arrow_vendored::date::hh_mm_ss;\n+using arrow_vendored::date::local_days;\n+using arrow_vendored::date::local_time;\n+using arrow_vendored::date::locate_zone;\n+using arrow_vendored::date::sys_days;\n+using arrow_vendored::date::sys_time;\n+using arrow_vendored::date::time_zone;\n+using arrow_vendored::date::trunc;\n+using arrow_vendored::date::weekday;\n+using arrow_vendored::date::weeks;\n+using arrow_vendored::date::year_month_day;\n+using arrow_vendored::date::year_month_weekday;\n+using arrow_vendored::date::years;\n+using arrow_vendored::date::zoned_time;\n+using arrow_vendored::date::literals::dec;\n+using arrow_vendored::date::literals::jan;\n+using arrow_vendored::date::literals::last;\n+using arrow_vendored::date::literals::mon;\n+using arrow_vendored::date::literals::sun;\n+using arrow_vendored::date::literals::thu;\n+using arrow_vendored::date::literals::wed;\n+using internal::applicator::ScalarBinaryNotNullStatefulEqualTypes;\n+\n+using DayOfWeekState = OptionsWrapper<DayOfWeekOptions>;\n+using WeekState = OptionsWrapper<WeekOptions>;\n+\n+Status CheckTimezones(const ExecBatch& batch) {\n+  const auto& timezone = GetInputTimezone(batch.values[0]);\n+  for (int i = 1; i < batch.num_values(); i++) {\n+    const auto& other_timezone = GetInputTimezone(batch.values[i]);\n+    if (other_timezone != timezone) {\n+      return Status::TypeError(\"Got differing time zone '\", other_timezone,\n+                               \"' for argument \", i + 1, \"; expected '\", timezone, \"'\");\n+    }\n+  }\n+  return Status::OK();\n+}\n+\n+int64_t GetQuarter(const year_month_day& ymd) {\n\nReview comment:\n       Will do.\n\n##########\nFile path: cpp/src/arrow/CMakeLists.txt\n##########\n@@ -400,11 +400,13 @@ if(ARROW_COMPUTE)\n        compute/kernels/scalar_cast_numeric.cc\n        compute/kernels/scalar_cast_string.cc\n        compute/kernels/scalar_cast_temporal.cc\n+       compute/kernels/scalar_cast_temporal.cc\n\nReview comment:\n       Nope :-)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-07T23:41:13.267+0000",
                    "updated": "2021-10-07T23:41:13.267+0000",
                    "started": "2021-10-07T23:41:13.267+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662396",
                    "issueId": "13405251"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/3",
            "id": "3",
            "description": "A task that needs to be done.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype",
            "name": "Task",
            "subtask": false,
            "avatarId": 21148
        },
        "timespent": 7200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@41c72f55[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d0441d7[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32127aed[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4de79f81[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@59c3f57e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@29af8352[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@84b4198[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7921dc87[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3f8faed8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6aef0f68[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@387ad42c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4f48f240[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 7200,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Oct 07 14:26:12 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-10-07T14:26:12.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14244/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2021-10-06T17:21:04.000+0000",
        "updated": "2021-10-07T23:41:14.000+0000",
        "timeoriginalestimate": null,
        "description": "{{scalar_temporal.cc}} takes a lot of time to compile, even in debug mode. This may be due to the large combination of compute functions and input types. It would be nice to try to make compile times smaller.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 7200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Investigate scalar_temporal.cc compilation speed",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13405251/comment/17425596",
                    "id": "17425596",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 11353\n[https://github.com/apache/arrow/pull/11353]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-10-07T14:26:12.470+0000",
                    "updated": "2021-10-07T14:26:12.470+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0vmdk:",
        "customfield_12314139": null
    }
}