{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13149160",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160",
    "key": "ARROW-2369",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "Parquet",
            "bug",
            "pandas",
            "parquetWriter",
            "pull-request-available",
            "pyarrow"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "1.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12531895",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12531895",
                "type": {
                    "id": "12310051",
                    "name": "Supercedes",
                    "inward": "is superceded by",
                    "outward": "supercedes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310051"
                },
                "outwardIssue": {
                    "id": "13149246",
                    "key": "ARROW-2372",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149246",
                    "fields": {
                        "summary": "[Python] ArrowIOError: Invalid argument when reading Parquet file",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jtan",
            "name": "jtan",
            "key": "jtan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Justin Tan",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jtan",
            "name": "jtan",
            "key": "jtan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Justin Tan",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2369/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@70ce4f0d[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3287787b[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@38ababa[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@ac75e10[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e596392[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4e4a14fd[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@184338e4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2844c222[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d74614b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@43076be4[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4202ff78[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4cd960c8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Apr 12 12:12:10 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-04-12T12:11:26.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2369/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2018-03-30T13:00:03.000+0000",
        "updated": "2018-04-16T19:11:10.000+0000",
        "timeoriginalestimate": null,
        "description": "When writing large Parquet files (above 10 GB or so) from Pandas to Parquet via the command\r\n\r\n{{pq.write_table(my_df, 'table.parquet')}}\r\n\r\nThe write succeeds, but when the parquet file is loaded, the error message\r\n\r\n{{ArrowIOError: Invalid parquet file. Corrupt footer.}}\r\n\r\nappears. This same error occurs when the parquet file is written chunkwise as well. When the parquet files are small, say < 5 GB or so (drawn randomly from the same dataset), everything proceeds as normal. I've also tried this with Pandas df.to_parquet(), with the same results.\r\n\r\nUpdate: Looks like any DataFrame with size above ~5GB (on disk) returns the same error.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12917022",
                "id": "12917022",
                "filename": "Screen Shot 2018-03-30 at 11.54.01 pm.png",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=jtan",
                    "name": "jtan",
                    "key": "jtan",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                    },
                    "displayName": "Justin Tan",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-03-30T12:54:36.528+0000",
                "size": 606572,
                "mimeType": "image/png",
                "content": "https://issues.apache.org/jira/secure/attachment/12917022/Screen+Shot+2018-03-30+at+11.54.01+pm.png"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "Large (>~20 GB) files written to Parquet via PyArrow are corrupted",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "Reproduced on Ubuntu + Mac OSX",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16421506",
                    "id": "16421506",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=babak.alipour%40gmail.com",
                        "name": "babak.alipour@gmail.com",
                        "key": "babak.alipour@gmail.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Babak Alipour",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I've got the same issue on Win 10, Arrow v0.9.0. The file was created with {{to_parquet(..., engine='pyarrow', compression='brotli')}} and cannot be read with {{read_parquet(..., engine='pyarrow')}} due to {{Invalid parquet file. Corrupt footer. error.}}\r\n\r\nSurprisingly, the same file created by pyarrow can be read using the fastparquet engine! File size on disk is 5,214,407,947 bytes (brotli compressed).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=babak.alipour%40gmail.com",
                        "name": "babak.alipour@gmail.com",
                        "key": "babak.alipour@gmail.com",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Babak Alipour",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-03-31T23:15:24.562+0000",
                    "updated": "2018-03-31T23:15:24.562+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16421510",
                    "id": "16421510",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Sounds like there's a {{uint32_t}} overflow somewhere, which is the sort of thing that often happens on Windows",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-03-31T23:33:20.801+0000",
                    "updated": "2018-03-31T23:33:20.801+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16430571",
                    "id": "16430571",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jtan",
                        "name": "jtan",
                        "key": "jtan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Justin Tan",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Looks like the file is readable by early pyarrow versions (0.5.0 - but created by v0.5.0 as well), so maybe something went wrong from 0.5.0 -> 0.9.0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jtan",
                        "name": "jtan",
                        "key": "jtan",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Justin Tan",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-09T14:07:27.839+0000",
                    "updated": "2018-04-09T14:07:27.839+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16430572",
                    "id": "16430572",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Ok, there are two things going on:\r\n* when {{write_table()}} is called with a filepath string, it goes through {{PythonFile}}, which is probably inefficient\r\n* {{PythonFile.Seek}} doesn't handle seek offsets greater than 2**32 properly:\r\n{code:python}\r\n>>> f = open('/tmp/empty', 'wb')\r\n>>> f.truncate(1<<33 + 10)\r\n8796093022208\r\n>>> f.close()\r\n>>> f = open('/tmp/empty', 'rb')\r\n>>> paf = pa.PythonFile(f, 'rb')\r\n>>> paf.tell()\r\n0\r\n>>> paf.seek(5)\r\n5\r\n>>> paf.tell()\r\n5\r\n>>> paf.seek(1<<33 + 6)\r\n0\r\n>>> paf.tell()\r\n0\r\n>>> f.seek(1<<33 + 6)\r\n549755813888\r\n>>> f.tell()\r\n549755813888\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2018-04-09T14:08:26.275+0000",
                    "updated": "2018-04-09T14:08:26.275+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16430650",
                    "id": "16430650",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou opened a new pull request #1866: ARROW-2369: [Python] Fix reading large Parquet files (> 4 GB)\nURL: https://github.com/apache/arrow/pull/1866\n \n \n   - Fix PythonFile.seek() for offsets > 4 GB\r\n   - Avoid instantiating a PythonFile in ParquetFile, for efficiency\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-09T15:02:50.617+0000",
                    "updated": "2018-04-09T15:02:50.617+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16435440",
                    "id": "16435440",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on a change in pull request #1866: ARROW-2369: [Python] Fix reading large Parquet files (> 4 GB)\nURL: https://github.com/apache/arrow/pull/1866#discussion_r181057233\n \n \n\n ##########\n File path: cpp/src/arrow/python/io.cc\n ##########\n @@ -65,14 +65,16 @@ class PythonFile {\n \n   Status Seek(int64_t position, int whence) {\n     // whence: 0 for relative to start of file, 2 for end of file\n-    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ii)\", position, whence);\n+    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ni)\",\n \n Review comment:\n   Problem was before that `position` was casted to an int32?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-12T12:08:42.462+0000",
                    "updated": "2018-04-12T12:08:42.462+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16435443",
                    "id": "16435443",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1866: ARROW-2369: [Python] Fix reading large Parquet files (> 4 GB)\nURL: https://github.com/apache/arrow/pull/1866#discussion_r181057886\n \n \n\n ##########\n File path: cpp/src/arrow/python/io.cc\n ##########\n @@ -65,14 +65,16 @@ class PythonFile {\n \n   Status Seek(int64_t position, int whence) {\n     // whence: 0 for relative to start of file, 2 for end of file\n-    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ii)\", position, whence);\n+    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ni)\",\n \n Review comment:\n   Yes, `i` takes the given parameter as `int` while `n` takes it as `Py_ssize_t`.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-12T12:10:46.762+0000",
                    "updated": "2018-04-12T12:10:46.762+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16435447",
                    "id": "16435447",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy closed pull request #1866: ARROW-2369: [Python] Fix reading large Parquet files (> 4 GB)\nURL: https://github.com/apache/arrow/pull/1866\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/python/io.cc b/cpp/src/arrow/python/io.cc\nindex 36c193dbfa..155e86f828 100644\n--- a/cpp/src/arrow/python/io.cc\n+++ b/cpp/src/arrow/python/io.cc\n@@ -65,14 +65,16 @@ class PythonFile {\n \n   Status Seek(int64_t position, int whence) {\n     // whence: 0 for relative to start of file, 2 for end of file\n-    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ii)\", position, whence);\n+    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ni)\",\n+                                               static_cast<Py_ssize_t>(position), whence);\n     Py_XDECREF(result);\n     PY_RETURN_IF_ERROR(StatusCode::IOError);\n     return Status::OK();\n   }\n \n   Status Read(int64_t nbytes, PyObject** out) {\n-    PyObject* result = cpp_PyObject_CallMethod(file_, \"read\", \"(i)\", nbytes);\n+    PyObject* result =\n+        cpp_PyObject_CallMethod(file_, \"read\", \"(n)\", static_cast<Py_ssize_t>(nbytes));\n     PY_RETURN_IF_ERROR(StatusCode::IOError);\n     *out = result;\n     return Status::OK();\ndiff --git a/python/pyarrow/parquet.py b/python/pyarrow/parquet.py\nindex beeedca032..34aa55a9c2 100644\n--- a/python/pyarrow/parquet.py\n+++ b/python/pyarrow/parquet.py\n@@ -60,7 +60,6 @@ class ParquetFile(object):\n     \"\"\"\n     def __init__(self, source, metadata=None, common_metadata=None):\n         self.reader = ParquetReader()\n-        source = _ensure_file(source)\n         self.reader.open(source, metadata=metadata)\n         self.common_metadata = common_metadata\n         self._nested_paths_by_prefix = self._build_nested_paths()\ndiff --git a/python/pyarrow/tests/test_io.py b/python/pyarrow/tests/test_io.py\nindex b29b9f1f6e..1511600777 100644\n--- a/python/pyarrow/tests/test_io.py\n+++ b/python/pyarrow/tests/test_io.py\n@@ -21,6 +21,7 @@\n import os\n import pytest\n import sys\n+import tempfile\n import weakref\n \n import numpy as np\n@@ -30,6 +31,25 @@\n from pyarrow.compat import u, guid\n import pyarrow as pa\n \n+\n+def check_large_seeks(file_factory):\n+    if sys.platform in ('win32', 'darwin'):\n+        pytest.skip(\"need sparse file support\")\n+    try:\n+        filename = tempfile.mktemp(prefix='test_io')\n+        with open(filename, 'wb') as f:\n+            f.truncate(2 ** 32 + 10)\n+            f.seek(2 ** 32 + 5)\n+            f.write(b'mark\\n')\n+        with file_factory(filename) as f:\n+            assert f.seek(2 ** 32 + 5) == 2 ** 32 + 5\n+            assert f.tell() == 2 ** 32 + 5\n+            assert f.read(5) == b'mark\\n'\n+            assert f.tell() == 2 ** 32 + 10\n+    finally:\n+        os.unlink(filename)\n+\n+\n # ----------------------------------------------------------------------\n # Python file-like objects\n \n@@ -83,6 +103,13 @@ def test_python_file_read():\n     f.close()\n \n \n+def test_python_file_large_seeks():\n+    def factory(filename):\n+        return pa.PythonFile(open(filename, 'rb'))\n+\n+    check_large_seeks(factory)\n+\n+\n def test_bytes_reader():\n     # Like a BytesIO, but zero-copy underneath for C++ consumers\n     data = b'some sample data'\n@@ -544,6 +571,10 @@ def test_os_file_reader(sample_disk_data):\n     _check_native_file_reader(pa.OSFile, sample_disk_data)\n \n \n+def test_os_file_large_seeks():\n+    check_large_seeks(pa.OSFile)\n+\n+\n def _try_delete(path):\n     try:\n         os.remove(path)\n@@ -600,6 +631,10 @@ def test_memory_zero_length(tmpdir):\n         assert memory_map.size() == 0\n \n \n+def test_memory_map_large_seeks():\n+    check_large_seeks(pa.memory_map)\n+\n+\n def test_os_file_writer(tmpdir):\n     SIZE = 4096\n     arr = np.random.randint(0, 256, size=SIZE).astype('u1')\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-12T12:11:11.069+0000",
                    "updated": "2018-04-12T12:11:11.069+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16435448",
                    "id": "16435448",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 1866\n[https://github.com/apache/arrow/pull/1866]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2018-04-12T12:11:26.420+0000",
                    "updated": "2018-04-12T12:11:26.420+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13149160/comment/16435450",
                    "id": "16435450",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou commented on a change in pull request #1866: ARROW-2369: [Python] Fix reading large Parquet files (> 4 GB)\nURL: https://github.com/apache/arrow/pull/1866#discussion_r181058227\n \n \n\n ##########\n File path: cpp/src/arrow/python/io.cc\n ##########\n @@ -65,14 +65,16 @@ class PythonFile {\n \n   Status Seek(int64_t position, int whence) {\n     // whence: 0 for relative to start of file, 2 for end of file\n-    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ii)\", position, whence);\n+    PyObject* result = cpp_PyObject_CallMethod(file_, \"seek\", \"(ni)\",\n \n Review comment:\n   Ultimately it is the same format string syntax as documented here: https://docs.python.org/3/c-api/arg.html#building-values\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-12T12:12:10.664+0000",
                    "updated": "2018-04-12T12:12:10.664+0000"
                }
            ],
            "maxResults": 10,
            "total": 10,
            "startAt": 0
        },
        "customfield_12311820": "0|i3rzpr:",
        "customfield_12314139": null
    }
}