{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13282775",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775",
    "key": "ARROW-7740",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12346687",
                "id": "12346687",
                "description": "",
                "name": "0.17.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-04-20"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jms",
            "name": "jms",
            "key": "jms",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "John Sheffield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jms",
            "name": "jms",
            "key": "jms",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "John Sheffield",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 6000,
            "total": 6000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6000,
            "total": 6000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7740/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 10,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413488",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792\n \n \n   Flatten would modify in-place the data_->child_data ArrayData if the currently flatten array is a slice. The parent child_data values also be modified.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:02:29.571+0000",
                    "updated": "2020-03-31T20:02:29.571+0000",
                    "started": "2020-03-31T20:02:29.571+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413488",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413489",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#discussion_r401180392\n \n \n\n ##########\n File path: r/R/json.R\n ##########\n @@ -38,6 +38,8 @@\n read_json_arrow <- function(file, col_select = NULL, as_data_frame = TRUE, ...) {\n   tab <- JsonTableReader$create(file, ...)$Read()$select(!!enquo(col_select))\n \n+  tab$ValidateFull()\n \n Review comment:\n   @nealrichardson should we toggle this via an option?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:04:03.640+0000",
                    "updated": "2020-03-31T20:04:03.640+0000",
                    "started": "2020-03-31T20:04:03.639+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413489",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413492",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#discussion_r401182373\n \n \n\n ##########\n File path: r/R/json.R\n ##########\n @@ -38,6 +38,8 @@\n read_json_arrow <- function(file, col_select = NULL, as_data_frame = TRUE, ...) {\n   tab <- JsonTableReader$create(file, ...)$Read()$select(!!enquo(col_select))\n \n+  tab$ValidateFull()\n \n Review comment:\n   I don't have an opinion; sounds like you think we should? Do any of the other readers do validation like this at all? (I'm not aware that they do.)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:07:37.326+0000",
                    "updated": "2020-03-31T20:07:37.326+0000",
                    "started": "2020-03-31T20:07:37.325+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413492",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413495",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#discussion_r401184083\n \n \n\n ##########\n File path: r/R/json.R\n ##########\n @@ -38,6 +38,8 @@\n read_json_arrow <- function(file, col_select = NULL, as_data_frame = TRUE, ...) {\n   tab <- JsonTableReader$create(file, ...)$Read()$select(!!enquo(col_select))\n \n+  tab$ValidateFull()\n \n Review comment:\n   Oh I see, this is added in this patch. IMO the library shouldn't be returning invalid Tables, so calling `Validate` on them seems unnecessary. I wouldn't add this to the reader function here; instead, if someone wanted to validate, they could return the Table themselves (`as_data_frame = FALSE`) and then call `$ValidateFull()` on it themselves.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:10:33.530+0000",
                    "updated": "2020-03-31T20:10:33.530+0000",
                    "started": "2020-03-31T20:10:33.529+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413495",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413496",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#discussion_r401184302\n \n \n\n ##########\n File path: r/tests/testthat/test-json.R\n ##########\n @@ -147,3 +147,16 @@ test_that(\"Can read json file with nested columns (ARROW-5503)\", {\n     )\n   )\n })\n+\n+test_that(\"Can read json file with list<struct<T...>> nested columns (ARROW-7740)\", {\n+  tf <- tempfile()\n+  on.exit(unlink(tf))\n+  writeLines('\n+    {\"a\":[{\"b\":1.0},{\"b\":2.0}]}\n+    {\"a\":[{\"b\":1.0},{\"b\":2.0}]}\n+  ', tf)\n+\n+  one <- tibble::tibble(b = c(1, 2))\n+  expected <- tibble::tibble(a = c(list(one), list(one)))\n+  expect_equivalent(arrow::read_json_arrow(tf), expected)\n \n Review comment:\n   ```suggestion\r\n     expect_equivalent(read_json_arrow(tf), expected)\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:12:02.772+0000",
                    "updated": "2020-03-31T20:12:02.772+0000",
                    "started": "2020-03-31T20:12:02.772+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413496",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413497",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#discussion_r401185433\n \n \n\n ##########\n File path: r/R/json.R\n ##########\n @@ -38,6 +38,8 @@\n read_json_arrow <- function(file, col_select = NULL, as_data_frame = TRUE, ...) {\n   tab <- JsonTableReader$create(file, ...)$Read()$select(!!enquo(col_select))\n \n+  tab$ValidateFull()\n \n Review comment:\n   I would remove this, it was only to help me debug \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:13:01.972+0000",
                    "updated": "2020-03-31T20:13:01.972+0000",
                    "started": "2020-03-31T20:13:01.971+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413497",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413498",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#issuecomment-606850010\n \n \n   Where was Flatten being called in the original failing test case?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:14:03.308+0000",
                    "updated": "2020-03-31T20:14:03.308+0000",
                    "started": "2020-03-31T20:14:03.307+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413498",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413500",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#issuecomment-606851138\n \n \n   https://issues.apache.org/jira/browse/ARROW-7740\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:16:32.224+0000",
                    "updated": "2020-03-31T20:16:32.224+0000",
                    "started": "2020-03-31T20:16:32.224+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413500",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413501",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on issue #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792#issuecomment-606851572\n \n \n   Flatten is called by the Array -> R vector  struct [converter](https://github.com/apache/arrow/blob/master/r/src/array_to_vector.cpp#L395-L407).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-31T20:17:26.178+0000",
                    "updated": "2020-03-31T20:17:26.178+0000",
                    "started": "2020-03-31T20:17:26.178+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413501",
                    "issueId": "13282775"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/worklog/413654",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #6792: ARROW-7740: [C++] Fix StructArray::Flatten corruption\nURL: https://github.com/apache/arrow/pull/6792\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-04-01T01:03:06.096+0000",
                    "updated": "2020-04-01T01:03:06.096+0000",
                    "started": "2020-04-01T01:03:06.095+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "413654",
                    "issueId": "13282775"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 6000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3c98a2ec[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3ffefc2c[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5ff9ade5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@17ae35aa[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@67cf13af[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3eb914f8[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2c3d104f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4ad86307[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@55955398[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@23fd9306[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6706405e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6e4fd7e2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6000,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Apr 01 01:03:05 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-04-01T01:03:05.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7740/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2020-02-01T16:28:12.000+0000",
        "updated": "2020-04-01T02:53:23.000+0000",
        "timeoriginalestimate": null,
        "description": "Reading a nested ndjson file using arrow::read_json_arrow with the default `as_data_frame=TRUE` causes an immediate session crash, but switching to `as_data_frame=FALSE` works fine and the resulting arrow object schema is correct.\r\n{code:java}\r\nlibrary(tidyr)\r\nlibrary(arrow)\r\nlibrary(jsonlite)\r\n# Create two test datasets: long_df and a variant that nests long_df into\r\n# a dataframe with a list-column 'nest_level1' containing a dataframe\r\nlong_df <- tidyr::expand_grid(ABC = LETTERS[1:3], xyz = letters[24:26], num = 1:3)\r\nlong_df[[\"ftr1\"]] <- runif(nrow(long_df))\r\nlong_df[[\"ftr2\"]] <- rpois(nrow(long_df), 100)\r\nnested_frame_level1 <- tidyr::nest(long_df, nest_level1 = c(num, ftr1, ftr2))\r\n# Write and validate nested ndjson\r\njsonlite::stream_out(nested_frame_level1, con = file(\"nested_frame_level1.json\"))\r\nreadLines(\"nested_frame_level1.json\", n = 2) # check we have valid ndjson here\r\n# This does not cause a session crash\r\nnested_arrow <- arrow::read_json_arrow(file = \"nested_frame_level1.json\", as_data_frame = FALSE)\r\nnested_arrow$schema # correctly interprets 'nest_level1` as `list<item: struct<num: int64, ftr1: double, ftr2: int64>>`\r\n# This causes a session crash\r\nnested_df <- arrow::read_json_arrow(file = \"nested_frame_level1.json\", as_data_frame = TRUE)\r\n\u00a0\r\n{code}\r\nThe R package version of Arrow is latest CRAN release (arrow * 0.15.1.1, 2019-11-05, CRAN (R 3.5.2)). I'm running this code in a slightly older R version (3.5.1), macOS\u00a010.14.6,\u00a0x86_64, darwin15.6.0, via RStudio 1.2.5001.\u00a0\r\n\r\n[edit: formatting fix]",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Array internals corruption in StructArray::Flatten",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17028181",
                    "id": "17028181",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Thanks for the report. I think there's multiple issues here, actually. I made a more minimal reproducer by taking the json file yours creates and trimming it down.\r\n\r\n{code}\r\nf2 <- tempfile()\r\nf3 <- tempfile()\r\ncat('{\"nest_level1\":[{\"num\":1,\"ftr1\":0.23342},{\"num\":2,\"ftr1\":0.31621}]}\r\n{\"nest_level1\":[{\"num\":1,\"ftr1\":0.31869},{\"num\":2,\"ftr1\":0.45382}]}\r\n', file=f2)\r\ncat('{\"nest_level1\":[{\"num\":1,\"ftr1\":0.23342},{\"num\":2,\"ftr1\":0.31621}]}\r\n{\"nest_level1\":[{\"num\":1,\"ftr1\":0.31869},{\"num\":2,\"ftr1\":0.45382}]}\r\n{\"nest_level1\":[{\"num\":1,\"ftr1\":0.05254},{\"num\":2,\"ftr1\":0.482}]}\r\n', file=f3)\r\n\r\narrow::read_json_arrow(f2)\r\narrow::read_json_arrow(f3)\r\n{code}\r\n\r\nInterestingly, the one with 2 rows doesn't crash, but the data it reads into R is wrong:\r\n\r\n{code}\r\n> arrow::read_json_arrow(f2)\r\n                                               nest_level1\r\n1 4.940656e-324, 9.881313e-324, 2.334200e-01, 3.162100e-01\r\n2 4.940656e-324, 9.881313e-324, 3.186900e-01, 4.538200e-01\r\n{code}\r\n\r\nWith 3 lines, it aborts. Here's a backtrace:\r\n\r\n{code}\r\n> arrow::read_json_arrow(f3)\r\n/Users/enpiar/Documents/ursa/arrow/cpp/src/arrow/array.cc:97:  Check failed: (off) <= (length) Slice offset greater than array length\r\n0   libarrow.100.dylib                  0x0000000113ac0354 _ZN5arrow4util7CerrLog14PrintBackTraceEv + 52\r\n1   libarrow.100.dylib                  0x0000000113ac0274 _ZN5arrow4util7CerrLogD2Ev + 100\r\n2   libarrow.100.dylib                  0x0000000113ac01d5 _ZN5arrow4util7CerrLogD1Ev + 21\r\n3   libarrow.100.dylib                  0x0000000113ac01f9 _ZN5arrow4util7CerrLogD0Ev + 25\r\n4   libarrow.100.dylib                  0x0000000113ac00e0 _ZN5arrow4util8ArrowLogD2Ev + 80\r\n5   libarrow.100.dylib                  0x0000000113ac0115 _ZN5arrow4util8ArrowLogD1Ev + 21\r\n6   libarrow.100.dylib                  0x000000011342535e _ZNK5arrow9ArrayData5SliceExx + 238\r\n7   libarrow.100.dylib                  0x0000000113432314 _ZNK5arrow11StructArray5fieldEi + 388\r\n8   arrow.so                            0x000000010d55e383 _ZN5arrow1r16Converter_StructC2ERKNSt3__16vectorINS2_10shared_ptrINS_5ArrayEEENS2_9allocatorIS6_EEEE + 163\r\n9   arrow.so                            0x000000010d551f04 _ZN5arrow1r9Converter4MakeERKNSt3__16vectorINS2_10shared_ptrINS_5ArrayEEENS2_9allocatorIS6_EEEE + 1012\r\n10  arrow.so                            0x000000010d55199d _ZN5arrow1r22ArrayVector__as_vectorElRKNSt3__16vectorINS1_10shared_ptrINS_5ArrayEEENS1_9allocatorIS5_EEEE + 29\r\n11  arrow.so                            0x000000010d5530b9 _Z16Array__as_vectorRKNSt3__110shared_ptrIN5arrow5ArrayEEE + 153\r\n12  arrow.so                            0x000000010d55f6bf _ZZNK5arrow1r14Converter_List17Ingest_some_nullsEP7SEXPRECRKNSt3__110shared_ptrINS_5ArrayEEEllENKUllE_clEl + 95\r\n13  arrow.so                            0x000000010d55f52b _ZNK5arrow1r14Converter_List17Ingest_some_nullsEP7SEXPRECRKNSt3__110shared_ptrINS_5ArrayEEEll + 251\r\n14  arrow.so                            0x000000010d55401b _ZNSt3__110__function6__funcIZN5arrow1r9Converter14IngestParallelEP7SEXPRECRKNS_10shared_ptrINS2_8internal9TaskGroupEEEEUlvE_NS_9allocatorISD_EEFNS2_6StatusEvEEclEv + 107\r\n15  libarrow.100.dylib                  0x0000000113ada414 _ZNKSt3__110__function12__value_funcIFN5arrow6StatusEvEEclEv + 68\r\n16  libarrow.100.dylib                  0x0000000113ad9d0c _ZNKSt3__18functionIFN5arrow6StatusEvEEclEv + 28\r\n17  libarrow.100.dylib                  0x0000000113add8e2 _ZZN5arrow8internal17ThreadedTaskGroup10AppendRealENSt3__18functionIFNS_6StatusEvEEEENKUlvE_clEv + 82\r\n18  libarrow.100.dylib                  0x0000000113add86d _ZNSt3__1L8__invokeIRZN5arrow8internal17ThreadedTaskGroup10AppendRealENS_8functionIFNS1_6StatusEvEEEEUlvE_JEEEDTclclsr3std3__1E7forwardIT_Efp_Espclsr3std3__1E7forwardIT0_Efp0_EEEOSA_DpOSB_ + 29\r\n19  libarrow.100.dylib                  0x0000000113add81d _ZNSt3__128__invoke_void_return_wrapperIvE6__callIJRZN5arrow8internal17ThreadedTaskGroup10AppendRealENS_8functionIFNS3_6StatusEvEEEEUlvE_EEEvDpOT_ + 29\r\n20  libarrow.100.dylib                  0x0000000113add7ed _ZNSt3__110__function12__alloc_funcIZN5arrow8internal17ThreadedTaskGroup10AppendRealENS_8functionIFNS2_6StatusEvEEEEUlvE_NS_9allocatorIS9_EEFvvEEclEv + 29\r\n21  libarrow.100.dylib                  0x0000000113adc4f9 _ZNSt3__110__function6__funcIZN5arrow8internal17ThreadedTaskGroup10AppendRealENS_8functionIFNS2_6StatusEvEEEEUlvE_NS_9allocatorIS9_EEFvvEEclEv + 25\r\n22  libarrow.100.dylib                  0x0000000113ae7b75 _ZNKSt3__110__function12__value_funcIFvvEEclEv + 53\r\n23  libarrow.100.dylib                  0x0000000113ae7725 _ZNKSt3__18functionIFvvEEclEv + 21\r\n24  libarrow.100.dylib                  0x0000000113ae70ea _ZN5arrow8internalL10WorkerLoopENSt3__110shared_ptrINS0_10ThreadPool5StateEEENS1_15__list_iteratorINS1_6threadEPvEE + 618\r\n25  libarrow.100.dylib                  0x0000000113ae6e41 _ZZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiENK3$_1clEv + 65\r\n26  libarrow.100.dylib                  0x0000000113ae6dbd _ZNSt3__1L8__invokeIZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiE3$_1JEEEDTclclsr3std3__1E7forwardIT_Efp_Espclsr3std3__1E7forwardIT0_Efp0_EEEOS5_DpOS6_ + 29\r\n27  libarrow.100.dylib                  0x0000000113ae6d25 _ZNSt3__1L16__thread_executeINS_10unique_ptrINS_15__thread_structENS_14default_deleteIS2_EEEEZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiE3$_1JEJEEEvRNS_5tupleIJT_T0_DpT1_EEENS_15__tuple_indicesIJXspT2_EEEE + 37\r\n28  libarrow.100.dylib                  0x0000000113ae6506 _ZNSt3__114__thread_proxyINS_5tupleIJNS_10unique_ptrINS_15__thread_structENS_14default_deleteIS3_EEEEZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiE3$_1EEEEEPvSC_ + 118\r\n29  libsystem_pthread.dylib             0x00007fff7a2f82eb _pthread_body + 126\r\n30  libsystem_pthread.dylib             0x00007fff7a2fb249 _pthread_start + 66\r\n31  libsystem_pthread.dylib             0x00007fff7a2f740d thread_start + 13\r\nAbort trap: 6\r\n{code}\r\n\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2020-02-01T18:18:37.051+0000",
                    "updated": "2020-02-01T18:18:37.051+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17028934",
                    "id": "17028934",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
                        "name": "fsaintjacques",
                        "key": "fsaintjacques",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
                        },
                        "displayName": "Francois Saint-Jacques",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "[~npr] did you try with master or with 0.15.1? Might be a duplicate of ARROW-7647 https://github.com/apache/arrow/pull/6273",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
                        "name": "fsaintjacques",
                        "key": "fsaintjacques",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
                        },
                        "displayName": "Francois Saint-Jacques",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-02-03T13:29:37.225+0000",
                    "updated": "2020-02-03T13:29:52.573+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17029057",
                    "id": "17029057",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Yeah I'm on master. FWIW, as the original report notes, it appears that the data is read into Arrow fine, the problems are on translating from Arrow to R:\r\n\r\n{code}\r\n> arrow::read_json_arrow(f3, as_data_frame=FALSE)\r\nTable\r\n3 rows x 1 columns\r\n$nest_level1: list<item: struct<num: int64, ftr1 <double>>>\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2020-02-03T15:58:35.470+0000",
                    "updated": "2020-02-03T15:58:35.470+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17070577",
                    "id": "17070577",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I started looking at this, I'm far enough down the rabbit hole that I might as well figure out the fix",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-03-29T23:28:41.230+0000",
                    "updated": "2020-03-29T23:28:41.230+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17070604",
                    "id": "17070604",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I've hit the limit of my knowledge of how the R C API works. See this commit\r\n\r\nhttps://github.com/wesm/arrow/commit/b5f07442c0297b85030b8624faced5bb114bb849#diff-85a7e5bb1bf1ea13536e9956b1920093R589\r\n\r\nI placed Validate usages on either side of {{SET_VECTOR_ELT}} here\r\n\r\n{code}\r\n    auto ingest_one = [&](R_xlen_t i) {\r\n      auto slice =\r\n          values_array->Slice(list_array->value_offset(i), list_array->value_length(i));\r\n      STOP_IF_NOT_OK(slice->Validate());\r\n      STOP_IF_NOT_OK(values_array->Validate());\r\n      SET_VECTOR_ELT(data, i + start, Array__as_vector(slice));\r\n      STOP_IF_NOT_OK(values_array->Validate());\r\n      STOP_IF_NOT_OK(slice->Validate());\r\n    };\r\n{code}\r\n\r\nThe code {{SET_VECTOR_ELT(data, i + start, Array__as_vector(slice));}} causes memory corruption (because the Validate calls fail on the subsequent lines) so presumably there is some missing use of Protect or other APIs ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-03-30T00:02:57.731+0000",
                    "updated": "2020-03-30T00:02:57.731+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17070605",
                    "id": "17070605",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "That commit also implements R bindings for Validate/ValidateFull, that should be broken out into a separate patch at some point",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-03-30T00:03:30.595+0000",
                    "updated": "2020-03-30T00:03:30.595+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17070606",
                    "id": "17070606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "cc [~romainfrancois]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-03-30T00:04:24.214+0000",
                    "updated": "2020-03-30T00:04:24.214+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13282775/comment/17072281",
                    "id": "17072281",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 6792\n[https://github.com/apache/arrow/pull/6792]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-04-01T01:03:05.329+0000",
                    "updated": "2020-04-01T01:03:05.329+0000"
                }
            ],
            "maxResults": 8,
            "total": 8,
            "startAt": 0
        },
        "customfield_12311820": "0|z0b2k8:",
        "customfield_12314139": null
    }
}