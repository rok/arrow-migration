{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13112036",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036",
    "key": "ARROW-1730",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Licht-T",
            "name": "Licht-T",
            "key": "licht-t",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=licht-t&avatarId=33236",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=licht-t&avatarId=33236",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=licht-t&avatarId=33236",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=licht-t&avatarId=33236"
            },
            "displayName": "Licht Takeuchi",
            "active": true,
            "timeZone": "Asia/Tokyo"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
            "name": "wesm",
            "key": "wesmckinn",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
            },
            "displayName": "Wes McKinney",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1730/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@47229a94[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7c667ac1[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@14bc4172[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5bc39156[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@58410f33[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@537a59e9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@25bb3525[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@62b559e5[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@325dfa17[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@336948a4[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4f8741f1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7355395[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Oct 28 01:18:43 UTC 2017",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2017-10-27T02:44:55.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1730/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2017-10-25T17:56:13.000+0000",
        "updated": "2017-10-28T01:18:43.000+0000",
        "timeoriginalestimate": null,
        "description": "Even with the ARROW-1484 patch, we have:\r\n\r\n{code: language=python}\r\nIn [10]: pa.array([0], type=pa.timestamp('ns'))\r\nOut[10]: \r\n<pyarrow.lib.TimestampArray object at 0x7f9145b27098>\r\n[\r\n  Timestamp('1968-01-12 11:18:14.409378304')\r\n]\r\n\r\nIn [11]: pa.array([0], type='int64').cast(pa.timestamp('ns'))\r\nOut[11]: \r\n<pyarrow.lib.TimestampArray object at 0x7f9145b27d18>\r\n[\r\n  Timestamp('1970-01-01 00:00:00')\r\n]\r\n{code}",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Incorrect result from pyarrow.array when passing timestamp type",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16219186",
                    "id": "16219186",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "But\r\n\r\n{code}\r\nIn [15]: pa.array(np.array([0], dtype='int64'), type=pa.timestamp('ns'))\r\nOut[15]: \r\n<pyarrow.lib.TimestampArray object at 0x7f9145a89048>\r\n[\r\n  Timestamp('1970-01-01 00:00:00')\r\n]\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-10-25T17:56:49.332+0000",
                    "updated": "2017-10-25T17:56:49.332+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220405",
                    "id": "16220405",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Licht-T",
                        "name": "Licht-T",
                        "key": "licht-t",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=licht-t&avatarId=33236",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=licht-t&avatarId=33236",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=licht-t&avatarId=33236",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=licht-t&avatarId=33236"
                        },
                        "displayName": "Licht Takeuchi",
                        "active": true,
                        "timeZone": "Asia/Tokyo"
                    },
                    "body": "I'm working on this.\r\nIt seems that PyLong is casted to PyDateTime.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=Licht-T",
                        "name": "Licht-T",
                        "key": "licht-t",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=licht-t&avatarId=33236",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=licht-t&avatarId=33236",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=licht-t&avatarId=33236",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=licht-t&avatarId=33236"
                        },
                        "displayName": "Licht Takeuchi",
                        "active": true,
                        "timeZone": "Asia/Tokyo"
                    },
                    "created": "2017-10-26T13:08:07.214+0000",
                    "updated": "2017-10-26T13:08:07.214+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220648",
                    "id": "16220648",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T opened a new pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256\n \n \n   This closes [ARROW-1730](https://issues.apache.org/jira/browse/ARROW-1730) and [ARROW-1738](https://issues.apache.org/jira/browse/ARROW-1738).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T15:45:41.851+0000",
                    "updated": "2017-10-26T15:45:41.851+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220904",
                    "id": "16220904",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#issuecomment-339748151\n \n \n   rebased\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T17:58:33.771+0000",
                    "updated": "2017-10-26T17:58:33.771+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220908",
                    "id": "16220908",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147220854\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -687,7 +718,8 @@ std::shared_ptr<SeqConverter> GetConverter(const std::shared_ptr<DataType>& type\n     case Type::DATE64:\n       return std::make_shared<DateConverter>();\n     case Type::TIMESTAMP:\n-      return std::make_shared<TimestampConverter>();\n+      return std::make_shared<TimestampConverter>(\n+          static_cast<TimestampType*>(&*type)->unit());\n \n Review comment:\n   More consistent with other parts of the code to use `static_cast<const TimestampType&>(*type).unit()`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:02:52.940+0000",
                    "updated": "2017-10-26T18:02:52.940+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220909",
                    "id": "16220909",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147220475\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -522,18 +522,49 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n \n Review comment:\n   Seems this can fail: https://docs.python.org/2/c-api/long.html#c.PyLong_AsLongLong. Is there a way for some other kind of object than a PyLong to end up in this code branch? \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:02:52.986+0000",
                    "updated": "2017-10-26T18:02:52.986+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220910",
                    "id": "16220910",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147220627\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -522,18 +522,49 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n+    }\n+    return typed_builder_->Append(t);\n   }\n };\n \n class TimestampConverter\n     : public TypedConverterVisitor<Date64Builder, TimestampConverter> {\n  public:\n+  TimestampConverter(TimeUnit::type unit) : unit_(unit) {}\n+\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n-    return typed_builder_->Append(PyDateTime_to_us(pydatetime));\n+    int64_t t;\n+    if (PyDateTime_Check(item.obj())) {\n+      auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n+\n+      switch (unit_) {\n+        case TimeUnit::SECOND:\n+          t = PyDateTime_to_s(pydatetime);\n+          break;\n+        case TimeUnit::MILLI:\n+          t = PyDateTime_to_ms(pydatetime);\n+          break;\n+        case TimeUnit::MICRO:\n+          t = PyDateTime_to_us(pydatetime);\n+          break;\n+        case TimeUnit::NANO:\n+          t = PyDateTime_to_ns(pydatetime);\n+          break;\n+      }\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n \n Review comment:\n   see above\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:02:53.058+0000",
                    "updated": "2017-10-26T18:02:53.058+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220912",
                    "id": "16220912",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147221502\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -522,18 +522,49 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n \n Review comment:\n   adding `RETURN_IF_PYERROR();` after this line is probably adequate error checking, then no further type checking is needed in the else\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:03:40.092+0000",
                    "updated": "2017-10-26T18:03:40.092+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220987",
                    "id": "16220987",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147231578\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -522,18 +522,49 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n+    }\n+    return typed_builder_->Append(t);\n   }\n };\n \n class TimestampConverter\n     : public TypedConverterVisitor<Date64Builder, TimestampConverter> {\n  public:\n+  TimestampConverter(TimeUnit::type unit) : unit_(unit) {}\n+\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n-    return typed_builder_->Append(PyDateTime_to_us(pydatetime));\n+    int64_t t;\n+    if (PyDateTime_Check(item.obj())) {\n+      auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n+\n+      switch (unit_) {\n+        case TimeUnit::SECOND:\n+          t = PyDateTime_to_s(pydatetime);\n+          break;\n+        case TimeUnit::MILLI:\n+          t = PyDateTime_to_ms(pydatetime);\n+          break;\n+        case TimeUnit::MICRO:\n+          t = PyDateTime_to_us(pydatetime);\n+          break;\n+        case TimeUnit::NANO:\n+          t = PyDateTime_to_ns(pydatetime);\n+          break;\n+      }\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n \n Review comment:\n   fixed\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:40:55.324+0000",
                    "updated": "2017-10-26T18:40:55.324+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220988",
                    "id": "16220988",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#discussion_r147231585\n \n \n\n ##########\n File path: cpp/src/arrow/python/builtin_convert.cc\n ##########\n @@ -522,18 +522,49 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n \n Review comment:\n   fixed\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:40:56.158+0000",
                    "updated": "2017-10-26T18:40:56.158+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16220994",
                    "id": "16220994",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#issuecomment-339761168\n \n \n   +1. I will await the build to run\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-26T18:43:39.638+0000",
                    "updated": "2017-10-26T18:43:39.638+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16221613",
                    "id": "16221613",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1256\n[https://github.com/apache/arrow/pull/1256]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-10-27T02:44:55.490+0000",
                    "updated": "2017-10-27T02:44:55.490+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16221614",
                    "id": "16221614",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/python/builtin_convert.cc b/cpp/src/arrow/python/builtin_convert.cc\nindex f7862d151..d52627ebf 100644\n--- a/cpp/src/arrow/python/builtin_convert.cc\n+++ b/cpp/src/arrow/python/builtin_convert.cc\n@@ -522,18 +522,51 @@ class UInt64Converter : public TypedConverterVisitor<UInt64Builder, UInt64Conver\n class DateConverter : public TypedConverterVisitor<Date64Builder, DateConverter> {\n  public:\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n-    return typed_builder_->Append(PyDate_to_ms(pydate));\n+    int64_t t;\n+    if (PyDate_Check(item.obj())) {\n+      auto pydate = reinterpret_cast<PyDateTime_Date*>(item.obj());\n+      t = PyDate_to_ms(pydate);\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n+      RETURN_IF_PYERROR();\n+    }\n+    return typed_builder_->Append(t);\n   }\n };\n \n class TimestampConverter\n     : public TypedConverterVisitor<Date64Builder, TimestampConverter> {\n  public:\n+  explicit TimestampConverter(TimeUnit::type unit) : unit_(unit) {}\n+\n   inline Status AppendItem(const OwnedRef& item) {\n-    auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n-    return typed_builder_->Append(PyDateTime_to_us(pydatetime));\n+    int64_t t;\n+    if (PyDateTime_Check(item.obj())) {\n+      auto pydatetime = reinterpret_cast<PyDateTime_DateTime*>(item.obj());\n+\n+      switch (unit_) {\n+        case TimeUnit::SECOND:\n+          t = PyDateTime_to_s(pydatetime);\n+          break;\n+        case TimeUnit::MILLI:\n+          t = PyDateTime_to_ms(pydatetime);\n+          break;\n+        case TimeUnit::MICRO:\n+          t = PyDateTime_to_us(pydatetime);\n+          break;\n+        case TimeUnit::NANO:\n+          t = PyDateTime_to_ns(pydatetime);\n+          break;\n+      }\n+    } else {\n+      t = static_cast<int64_t>(PyLong_AsLongLong(item.obj()));\n+      RETURN_IF_PYERROR();\n+    }\n+    return typed_builder_->Append(t);\n   }\n+\n+ private:\n+  TimeUnit::type unit_;\n };\n \n class DoubleConverter : public TypedConverterVisitor<DoubleBuilder, DoubleConverter> {\n@@ -687,7 +720,8 @@ std::shared_ptr<SeqConverter> GetConverter(const std::shared_ptr<DataType>& type\n     case Type::DATE64:\n       return std::make_shared<DateConverter>();\n     case Type::TIMESTAMP:\n-      return std::make_shared<TimestampConverter>();\n+      return std::make_shared<TimestampConverter>(\n+          static_cast<const TimestampType&>(*type).unit());\n     case Type::DOUBLE:\n       return std::make_shared<DoubleConverter>();\n     case Type::BINARY:\ndiff --git a/cpp/src/arrow/python/util/datetime.h b/cpp/src/arrow/python/util/datetime.h\nindex 782960f62..c110bc64a 100644\n--- a/cpp/src/arrow/python/util/datetime.h\n+++ b/cpp/src/arrow/python/util/datetime.h\n@@ -247,12 +247,26 @@ static inline int64_t PyDate_to_ms(PyDateTime_Date* pydate) {\n   return total_seconds * 1000;\n }\n \n+static inline int64_t PyDateTime_to_s(PyDateTime_DateTime* pydatetime) {\n+  return PyDate_to_ms(reinterpret_cast<PyDateTime_Date*>(pydatetime)) / 1000LL;\n+}\n+\n+static inline int64_t PyDateTime_to_ms(PyDateTime_DateTime* pydatetime) {\n+  int64_t date_ms = PyDate_to_ms(reinterpret_cast<PyDateTime_Date*>(pydatetime));\n+  int ms = PyDateTime_DATE_GET_MICROSECOND(pydatetime) / 1000;\n+  return date_ms + ms;\n+}\n+\n static inline int64_t PyDateTime_to_us(PyDateTime_DateTime* pydatetime) {\n   int64_t ms = PyDate_to_ms(reinterpret_cast<PyDateTime_Date*>(pydatetime));\n   int us = PyDateTime_DATE_GET_MICROSECOND(pydatetime);\n   return ms * 1000 + us;\n }\n \n+static inline int64_t PyDateTime_to_ns(PyDateTime_DateTime* pydatetime) {\n+  return PyDateTime_to_us(pydatetime) * 1000;\n+}\n+\n static inline int32_t PyDate_to_days(PyDateTime_Date* pydate) {\n   return static_cast<int32_t>(PyDate_to_ms(pydate) / 86400000LL);\n }\ndiff --git a/python/pyarrow/tests/test_convert_builtin.py b/python/pyarrow/tests/test_convert_builtin.py\nindex d18ed9506..414266ddb 100644\n--- a/python/pyarrow/tests/test_convert_builtin.py\n+++ b/python/pyarrow/tests/test_convert_builtin.py\n@@ -197,6 +197,75 @@ def test_timestamp(self):\n         assert arr[3].as_py() == datetime.datetime(2010, 8, 13, 5,\n                                                    46, 57, 437699)\n \n+    def test_timestamp_with_unit(self):\n+        data = [\n+            datetime.datetime(2007, 7, 13, 1, 23, 34, 123456),\n+        ]\n+\n+        s = pa.timestamp('s')\n+        ms = pa.timestamp('ms')\n+        us = pa.timestamp('us')\n+        ns = pa.timestamp('ns')\n+\n+        arr_s = pa.array(data, type=s)\n+        assert len(arr_s) == 1\n+        assert arr_s.type == s\n+        assert arr_s[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                     23, 34, 0)\n+\n+        arr_ms = pa.array(data, type=ms)\n+        assert len(arr_ms) == 1\n+        assert arr_ms.type == ms\n+        assert arr_ms[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                      23, 34, 123000)\n+\n+        arr_us = pa.array(data, type=us)\n+        assert len(arr_us) == 1\n+        assert arr_us.type == us\n+        assert arr_us[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                      23, 34, 123456)\n+\n+        arr_ns = pa.array(data, type=ns)\n+        assert len(arr_ns) == 1\n+        assert arr_ns.type == ns\n+        assert arr_ns[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n+                                                      23, 34, 123456)\n+\n+    def test_timestamp_from_int_with_unit(self):\n+        data = [1]\n+\n+        s = pa.timestamp('s')\n+        ms = pa.timestamp('ms')\n+        us = pa.timestamp('us')\n+        ns = pa.timestamp('ns')\n+\n+        arr_s = pa.array(data, type=s)\n+        assert len(arr_s) == 1\n+        assert arr_s.type == s\n+        assert str(arr_s[0]) == \"Timestamp('1970-01-01 00:00:01')\"\n+\n+        arr_ms = pa.array(data, type=ms)\n+        assert len(arr_ms) == 1\n+        assert arr_ms.type == ms\n+        assert str(arr_ms[0]) == \"Timestamp('1970-01-01 00:00:00.001000')\"\n+\n+        arr_us = pa.array(data, type=us)\n+        assert len(arr_us) == 1\n+        assert arr_us.type == us\n+        assert str(arr_us[0]) == \"Timestamp('1970-01-01 00:00:00.000001')\"\n+\n+        arr_ns = pa.array(data, type=ns)\n+        assert len(arr_ns) == 1\n+        assert arr_ns.type == ns\n+        assert str(arr_ns[0]) == \"Timestamp('1970-01-01 00:00:00.000000001')\"\n+\n+        with pytest.raises(pa.ArrowException):\n+            class CustomClass():\n+                pass\n+            pa.array([1, CustomClass()], type=ns)\n+            pa.array([1, CustomClass()], type=pa.date32())\n+            pa.array([1, CustomClass()], type=pa.date64())\n+\n     def test_mixed_nesting_levels(self):\n         pa.array([1, 2, None])\n         pa.array([[1], [2], None])\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-27T02:44:56.041+0000",
                    "updated": "2017-10-27T02:44:56.041+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112036/comment/16223126",
                    "id": "16223126",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1256: ARROW-1730, ARROW-1738: [Python] Fix wrong datetime conversion\nURL: https://github.com/apache/arrow/pull/1256#issuecomment-340129670\n \n \n   Thanks @wesm !\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T01:18:43.365+0000",
                    "updated": "2017-10-28T01:18:43.365+0000"
                }
            ],
            "maxResults": 14,
            "total": 14,
            "startAt": 0
        },
        "customfield_12311820": "0|i3lp4n:",
        "customfield_12314139": null
    }
}