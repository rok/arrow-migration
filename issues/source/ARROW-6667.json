{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13258349",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349",
    "key": "ARROW-6667",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "2.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=AaronOpferCTC",
            "name": "AaronOpferCTC",
            "key": "aaronopferctc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Aaron Opfer",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=AaronOpferCTC",
            "name": "AaronOpferCTC",
            "key": "aaronopferctc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Aaron Opfer",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=AaronOpferCTC",
            "name": "AaronOpferCTC",
            "key": "aaronopferctc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Aaron Opfer",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6667/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 17,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/316763",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AaronOpfer commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476\n \n \n   _build_nested_path has a reference cycle because the closured function refers to the parent cell which also refers to the closured function again. Address this by clearing the reference to the function from the parent cell before returning.\r\n   \r\n   open_dataset_file is partialed with self inside the ParquetFile class. Prevent this by using a weakref instead.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-23T16:06:42.564+0000",
                    "updated": "2019-09-23T16:06:42.564+0000",
                    "started": "2019-09-23T16:06:42.564+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316763",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/316833",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534193959\n \n \n   Why do you care about `_build_nested_path` exactly? It's just a small function, it's not a problem if there's a reference cycle.\r\n   \r\n   `_open_dataset` looks more serious, since it may keep alive an entire dataset.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-23T17:10:05.076+0000",
                    "updated": "2019-09-23T17:10:05.076+0000",
                    "started": "2019-09-23T17:10:05.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316833",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/316834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#discussion_r327229849\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -152,6 +153,8 @@ def _visit_piece(i, key, rest):\n         for i, path in enumerate(paths):\n             _visit_piece(i, path[0], path[1:])\n \n+        _visit_piece = None  # Remove GC cycle.\n \n Review comment:\n   This looks a bit convoluted to me. Just make `_visit_piece` iterative rather than recursive and the cycle should disappear.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-23T17:10:43.088+0000",
                    "updated": "2019-09-23T17:10:43.088+0000",
                    "started": "2019-09-23T17:10:43.087+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316834",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/316839",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534196976\n \n \n   As the CI shows, this PR breaks the unit tests. I recommend you run the unit tests using `pytest` before pushing changes, since it will allow you to iterate more quickly.\r\n   \r\n   In this case, the weakref breaks pickling. I would suggest trying to untangle the mess that is the `_open_dataset_file` indirection, perhaps by moving some functionality in a dedicated `DatasetFileOpener` (or `DatasetParams`?) class that would hold the necessary parameters.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-23T17:17:17.934+0000",
                    "updated": "2019-09-23T17:17:17.934+0000",
                    "started": "2019-09-23T17:17:17.933+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316839",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/316941",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AaronOpfer commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534248028\n \n \n   Hi, sorry for not catching the test failures in the first push.\r\n   \r\n   > I would suggest trying to untangle the mess that is the _open_dataset_file indirection, perhaps by moving some functionality in a dedicated DatasetFileOpener (or DatasetParams?) class that would hold the necessary parameters.\r\n   \r\n   The new patch creates a metadata storage object for the purpose of breaking the cycle in `ParquetDataset`. The implementation of which I'm not super pleased about, so I'm interested in what your feedback is there.\r\n   \r\n   > Why do you care about `_build_nested_path` exactly? It's just a small function, it's not a problem if there's a reference cycle.\r\n   \r\n   I'm analyzing my codebase trying to identify why my garbage collector is running very frequently during calculations and my analysis had me find this reference cycle. I would be uncomfortable raising my garbage collection threshold or disabling it outright for performance gains unless my analysis actually shows that I never actually collect any garbage, and the `_build_nested_path` stackframes are swept on every collection. If I can read between the lines a bit, I agree with you that it is a minor problem when it comes to actual bytes of memory wasted.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-23T19:27:51.055+0000",
                    "updated": "2019-09-23T19:27:51.055+0000",
                    "started": "2019-09-23T19:27:51.054+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "316941",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317289",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534470968\n \n \n   > I'm analyzing my codebase trying to identify why my garbage collector is running very frequently during calculations and my analysis had me find this reference cycle.\r\n   \r\n   Hmm, I'd suggest taking some steps back :-) The Python garbage collector is running frequently by design. However, there are different kinds of garbage collections: incremental and full garbage collections. Only the full garbage collections can be costly, and even then, in most applications they have a minimal cost. You may use [gc.callbacks](https://docs.python.org/3/library/gc.html#gc.callbacks) if you want to find out more information about this.\r\n   \r\n   Generally, it's expected for object-oriented code (and/or code using closures, etc.) to have reference cycles. As long as those reference cycles don't keep a costly object alive (such as an open file or a large array), it shouldn't be much of a problem.\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T09:17:52.839+0000",
                    "updated": "2019-09-24T09:17:52.839+0000",
                    "started": "2019-09-24T09:17:52.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317289",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317292",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#discussion_r327511750\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1172,6 +1190,11 @@ def all_filters_accept(piece):\n         self.pieces = [p for p in self.pieces if all_filters_accept(p)]\n \n \n+for attribute in _ParquetDatasetMetadata.__slots__:\n+    setattr(ParquetDataset, attribute, _metadata_forwarder(attribute))\n \n Review comment:\n   Hmm, no, this is making things more bizarre than they already are. I was hoping for a helper object that would expose the current `_make_manifest` and/or `_open_dataset` logic.\r\n   \r\n   Also, if you want to forward a bunch of attributes (at most 5 of them, apparently), I'd suggest writing the properties by hand. You probably don't need to make them writable, either, if the target object is properly initialized.\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T09:20:41.938+0000",
                    "updated": "2019-09-24T09:20:41.938+0000",
                    "started": "2019-09-24T09:20:41.937+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317292",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317293",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#discussion_r327510904\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -142,15 +143,18 @@ def _build_nested_paths(self):\n \n         result = defaultdict(list)\n \n-        def _visit_piece(i, key, rest):\n-            result[key].append(i)\n+        for i, path in enumerate(paths):\n+            key = path[0]\n+            rest = path[1:]\n+            while True:\n+                result[key].append(i)\n \n-            if len(rest) > 0:\n-                nested_key = '.'.join((key, rest[0]))\n-                _visit_piece(i, nested_key, rest[1:])\n+                if not rest:\n+                    break\n \n-        for i, path in enumerate(paths):\n-            _visit_piece(i, path[0], path[1:])\n+                nested_key = '.'.join((key, rest[0]))\n \n Review comment:\n   Can directly write `key = ...`, but otherwise this is fine.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T09:20:41.942+0000",
                    "updated": "2019-09-24T09:20:41.942+0000",
                    "started": "2019-09-24T09:20:41.942+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317293",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317542",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AaronOpfer commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#discussion_r327652746\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1172,6 +1190,11 @@ def all_filters_accept(piece):\n         self.pieces = [p for p in self.pieces if all_filters_accept(p)]\n \n \n+for attribute in _ParquetDatasetMetadata.__slots__:\n+    setattr(ParquetDataset, attribute, _metadata_forwarder(attribute))\n \n Review comment:\n   Agreed that a helper object is probably the best approach, but unfortunately I have limited time to spend on this problem. Can we establish a compromise? \r\n   \r\n   What I can do is:\r\n    * eliminate this funny for-loop and write out the five properties,\r\n    * remove the write-side of the property, which should remove the funny `_metadata_forwarder` function,\r\n    * and change `ParquetDataset.__init__` to write to `self._metadata.the_property` directly\r\n   \r\n   This would also make these metadata properties read-only, which might have some benefits (or drawbacks).\r\n   \r\n   If this is unacceptable, I can remove the `ParquetDataset` changes and leave this PR to just be the changes to `_build_nested_path`, and either you or I can make another ticket to track the `ParquetDataset` reference cycle which will be left not fixed.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T14:36:39.433+0000",
                    "updated": "2019-09-24T14:36:39.433+0000",
                    "started": "2019-09-24T14:36:39.433+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317542",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317580",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#discussion_r327680841\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -1172,6 +1190,11 @@ def all_filters_accept(piece):\n         self.pieces = [p for p in self.pieces if all_filters_accept(p)]\n \n \n+for attribute in _ParquetDatasetMetadata.__slots__:\n+    setattr(ParquetDataset, attribute, _metadata_forwarder(attribute))\n \n Review comment:\n   > What I can do is:\r\n   \r\n   This sounds ok to me. Also, making `_open_dataset` a method of the new object may be nice as well.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T15:24:18.318+0000",
                    "updated": "2019-09-24T15:24:18.318+0000",
                    "started": "2019-09-24T15:24:18.318+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317580",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317633",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AaronOpfer commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534638649\n \n \n   Looks like Python 2.7 can't pickle bound methods. \u2639\ufe0f I'll go ahead and make the code uglier to fix it.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T16:29:31.785+0000",
                    "updated": "2019-09-24T16:29:31.785+0000",
                    "started": "2019-09-24T16:29:31.784+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317633",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/317749",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "AaronOpfer commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534697696\n \n \n   BTW @pitrou just realized you've had to come in after my garbage collection changes before...\r\n   \r\n   https://github.com/tornadoweb/tornado/pull/1782\r\n   https://github.com/tornadoweb/tornado/pull/2230\r\n   \r\n   Small world isn't it? \ud83d\ude03 This time you managed to stop me before I added weakrefs instead of after.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-24T18:50:24.753+0000",
                    "updated": "2019-09-24T18:50:24.753+0000",
                    "started": "2019-09-24T18:50:24.753+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "317749",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/318031",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534833138\n \n \n   Looks like this is passing save for lint issues. I'm going to fix your lint issues in hopes that @pitrou can merge this in the morning before a 0.15.0 release candidate is cut\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-25T03:17:00.388+0000",
                    "updated": "2019-09-25T03:17:00.388+0000",
                    "started": "2019-09-25T03:17:00.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318031",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/318033",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534833204\n \n \n   Please make pull requests using branches in the future, it's tedious and error prone for us to push commits to your master branch\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-25T03:17:27.816+0000",
                    "updated": "2019-09-25T03:17:27.816+0000",
                    "started": "2019-09-25T03:17:27.816+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318033",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/318034",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534833796\n \n \n   I can't rebase/force-push otherwise GitHub will force the PR closed\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-25T03:20:29.320+0000",
                    "updated": "2019-09-25T03:20:29.320+0000",
                    "started": "2019-09-25T03:20:29.319+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318034",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/318210",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-25T10:15:34.093+0000",
                    "updated": "2019-09-25T10:15:34.093+0000",
                    "started": "2019-09-25T10:15:34.092+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318210",
                    "issueId": "13258349"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/worklog/318218",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #5476: ARROW-6667: [Python] remove cyclical object references in pyarrow.parquet\nURL: https://github.com/apache/arrow/pull/5476#issuecomment-534957426\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=h1) Report\n   > :exclamation: No coverage uploaded for pull request base (`master@c6faaed`). [Click here to learn what that means](https://docs.codecov.io/docs/error-reference#section-missing-base-commit).\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/5476/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff            @@\n   ##             master    #5476   +/-   ##\n   =========================================\n     Coverage          ?   66.35%           \n   =========================================\n     Files             ?      508           \n     Lines             ?    70129           \n     Branches          ?        0           \n   =========================================\n     Hits              ?    46533           \n     Misses            ?    23596           \n     Partials          ?        0\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [python/pyarrow/parquet.py](https://codecov.io/gh/apache/arrow/pull/5476/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvcGFycXVldC5weQ==) | `92.5% <100%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=footer). Last update [c6faaed...f4909e0](https://codecov.io/gh/apache/arrow/pull/5476?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-25T10:23:44.350+0000",
                    "updated": "2019-09-25T10:23:44.350+0000",
                    "started": "2019-09-25T10:23:44.350+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318218",
                    "issueId": "13258349"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@685a1611[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2dec3c48[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b993f6d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@77db4a2a[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2d2bbf91[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7465beac[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6f5851a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2bd205f4[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5b75e028[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2bca534[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@284b2d2c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@130d7074[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Sep 25 10:15:33 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-09-25T10:15:33.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6667/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-09-23T16:00:37.000+0000",
        "updated": "2019-09-25T10:23:44.000+0000",
        "timeoriginalestimate": null,
        "description": "Reference cycles appear in two places inside pyarrow.parquet which causes these objects to have much longer lifetimes than necessary:\r\n\r\n\u00a0\r\n\r\n{{_build_nested_path}} has a reference cycle because the closured function refers to the parent cell which also refers to the closured function again (objgraph shown in attachment)\r\n\r\n{{open_dataset_file}} is partialed with self inside the {{ParquetFile}} class (objgraph shown in attachment).",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12981081",
                "id": "12981081",
                "filename": "cycle1_build_nested_path.PNG",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=AaronOpferCTC",
                    "name": "AaronOpferCTC",
                    "key": "aaronopferctc",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Aaron Opfer",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2019-09-23T15:58:54.235+0000",
                "size": 30619,
                "mimeType": "image/png",
                "content": "https://issues.apache.org/jira/secure/attachment/12981081/cycle1_build_nested_path.PNG"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12981080",
                "id": "12981080",
                "filename": "cycle2_open_dataset.PNG",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=AaronOpferCTC",
                    "name": "AaronOpferCTC",
                    "key": "aaronopferctc",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Aaron Opfer",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2019-09-23T15:59:13.076+0000",
                "size": 51784,
                "mimeType": "image/png",
                "content": "https://issues.apache.org/jira/secure/attachment/12981080/cycle2_open_dataset.PNG"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Avoid Reference Cycles in pyarrow.parquet",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13258349/comment/16937592",
                    "id": "16937592",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 5476\n[https://github.com/apache/arrow/pull/5476]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2019-09-25T10:15:33.597+0000",
                    "updated": "2019-09-25T10:15:33.597+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z06xfc:",
        "customfield_12314139": null
    }
}