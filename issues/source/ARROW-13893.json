{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13399277",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277",
    "key": "ARROW-13893",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/1",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/blocker.svg",
            "name": "Blocker",
            "id": "1"
        },
        "labels": [
            "pull-request-available",
            "query-engine"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13893/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 30,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/662790",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson opened a new pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373\n\n\n   This still has some TODOs and cleanups left, but I finally got something that passes tests\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-08T15:42:20.376+0000",
                    "updated": "2021-10-08T15:42:20.376+0000",
                    "started": "2021-10-08T15:42:20.375+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662790",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/662792",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-938741783\n\n\n   https://issues.apache.org/jira/browse/ARROW-13893\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-08T15:42:51.501+0000",
                    "updated": "2021-10-08T15:42:51.501+0000",
                    "started": "2021-10-08T15:42:51.501+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662792",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/662925",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r725247172\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -175,9 +183,20 @@ ExecPlan <- R6Class(\"ExecPlan\",\n           temp_columns = names(.data$temp_columns)\n         )\n       }\n+\n+      # This is only safe because we are going to evaluate queries that end\n+      # with head/tail first, then evaluate any subsequent query as a new query\n+      if (!is.null(.data$head)) {\n+        node$head <- .data$head\n+      }\n+      if (!is.null(.data$tail)) {\n+        node$tail <- .data$tail\n+      }\n+\n       node\n     },\n     Run = function(node) {\n+      # TODO: pass head/tail to ExecPlan_run\n\nReview comment:\n       ```suggestion\r\n         # TODO (ARROW-12763): pass head/tail to ExecPlan_run\r\n   ```\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -19,6 +19,20 @@\n # The following S3 methods are registered on load if dplyr is present\n \n collect.arrow_dplyr_query <- function(x, as_data_frame = TRUE, ...) {\n+  # head and tail are not ExecNodes, at best we can handle them via sink node\n+  # so if there are any steps done after head/tail, we need to\n+  # evaluate the query up to then and then do a new query for the rest\n+  if (is_collapsed(x) && has_head_tail(x$.data)) {\n+    x$.data <- as_adq(dplyr::compute(x$.data))\n+  }\n+  # TODO: if there are no aggregations or joins or sorting, (and there is\n\nReview comment:\n       I will do this in this PR (or maybe not necessary if I can use the Scanner interface in do_exec_plan)\n\n##########\nFile path: r/R/dplyr.R\n##########\n@@ -162,22 +162,36 @@ as.data.frame.arrow_dplyr_query <- function(x, row.names = NULL, optional = FALS\n \n #' @export\n head.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- head.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  # TODO: test that nrow on collapsed query with agg/join/head\n\nReview comment:\n       Will do now\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -20,6 +20,14 @@ do_exec_plan <- function(.data) {\n   final_node <- plan$Build(.data)\n   tab <- plan$Run(final_node)$read_table()\n \n+  # TODO: can we move all of this logic into plan$Run, making a \"source\" node?\n+  if (!is.null(final_node$head)) {\n+    # TODO: implement head off of the RecordBatchReader so you can bail early\n\nReview comment:\n       I will do this one here, will try going through ScannerBuilder::FromRecordBatchReader and use the existing head/tail methods there so as not to reimplement that logic. Assuming that works, I may be able to pull this into plan$Run (and do Scanner::ToRecordBatchReader on the other side)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-08T19:19:08.752+0000",
                    "updated": "2021-10-08T19:19:08.752+0000",
                    "started": "2021-10-08T19:19:08.751+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "662925",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/663636",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r726304214\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -175,11 +180,33 @@ ExecPlan <- R6Class(\"ExecPlan\",\n           temp_columns = names(.data$temp_columns)\n         )\n       }\n+\n+      # This is only safe because we are going to evaluate queries that end\n+      # with head/tail first, then evaluate any subsequent query as a new query\n+      if (!is.null(.data$head)) {\n+        node$head <- .data$head\n+      }\n+      if (!is.null(.data$tail)) {\n+        node$tail <- .data$tail\n+      }\n+\n       node\n     },\n     Run = function(node) {\n       assert_is(node, \"ExecNode\")\n-      ExecPlan_run(self, node, node$sort %||% list())\n+      # TODO (ARROW-12763): pass head/tail to ExecPlan_run so we can maybe TopK\n+      out <- ExecPlan_run(self, node, node$sort %||% list())\n+\n+      if (!is.null(node$head)) {\n+        # These methods are on RecordBatchReader (but return Table)\n+        # TODO: make the head/tail methods return RBR not Table\n+        out <- head(out, node$head)\n+        # TODO: can we now tell `self` to StopProducing? We already have\n\nReview comment:\n       Any reason I shouldn't call `StopProducing` at this point? I've collected my head rows by now and don't care what else the query returns. @bkietz @westonpace \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-11T16:28:25.963+0000",
                    "updated": "2021-10-11T16:28:25.963+0000",
                    "started": "2021-10-11T16:28:25.963+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "663636",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/663664",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r726424048\n\n\n\n##########\nFile path: r/R/dplyr.R\n##########\n@@ -162,22 +162,36 @@ as.data.frame.arrow_dplyr_query <- function(x, row.names = NULL, optional = FALS\n \n #' @export\n head.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- head.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  # TODO: test that nrow on collapsed query with agg/join/head\n\nReview comment:\n       ```suggestion\r\n   ```\r\n   \r\n   Deferring to ARROW-14288\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-11T17:33:32.914+0000",
                    "updated": "2021-10-11T17:33:32.914+0000",
                    "started": "2021-10-11T17:33:32.914+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "663664",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/663670",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r726452292\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -175,11 +180,33 @@ ExecPlan <- R6Class(\"ExecPlan\",\n           temp_columns = names(.data$temp_columns)\n         )\n       }\n+\n+      # This is only safe because we are going to evaluate queries that end\n+      # with head/tail first, then evaluate any subsequent query as a new query\n+      if (!is.null(.data$head)) {\n+        node$head <- .data$head\n+      }\n+      if (!is.null(.data$tail)) {\n+        node$tail <- .data$tail\n+      }\n+\n       node\n     },\n     Run = function(node) {\n       assert_is(node, \"ExecNode\")\n-      ExecPlan_run(self, node, node$sort %||% list())\n+      # TODO (ARROW-12763): pass head/tail to ExecPlan_run so we can maybe TopK\n+      out <- ExecPlan_run(self, node, node$sort %||% list())\n+\n+      if (!is.null(node$head)) {\n+        # These methods are on RecordBatchReader (but return Table)\n+        # TODO: make the head/tail methods return RBR not Table\n+        out <- head(out, node$head)\n+        # TODO: can we now tell `self` to StopProducing? We already have\n\nReview comment:\n       I've tried that, LMK if that's wrong to do\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-11T17:47:12.228+0000",
                    "updated": "2021-10-11T17:47:12.228+0000",
                    "started": "2021-10-11T17:47:12.227+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "663670",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664146",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727130827\n\n\n\n##########\nFile path: r/R/dataset-scan.R\n##########\n@@ -143,6 +139,26 @@ Scanner$create <- function(dataset,\n #' @export\n names.Scanner <- function(x) names(x$schema)\n \n+#' @export\n+head.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n+  dataset___Scanner__head(x, n)\n+}\n+\n+#' @export\n+tail.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n\nReview comment:\n       Out of curiosity: what's the \"For now\" in reference to?\n\n##########\nFile path: r/R/dataset-scan.R\n##########\n@@ -143,6 +139,26 @@ Scanner$create <- function(dataset,\n #' @export\n names.Scanner <- function(x) names(x$schema)\n \n+#' @export\n+head.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n+  dataset___Scanner__head(x, n)\n+}\n+\n+#' @export\n+tail.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n\nReview comment:\n       Ah I see now it wouldn't work with the implementation down there. \n\n##########\nFile path: r/R/dplyr.R\n##########\n@@ -162,22 +162,35 @@ as.data.frame.arrow_dplyr_query <- function(x, row.names = NULL, optional = FALS\n \n #' @export\n head.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- head.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  out <- as_adq(x)\n+  out$head <- n\n+  collapse.arrow_dplyr_query(out)\n }\n \n #' @export\n tail.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- tail.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  out <- as_adq(x)\n\nReview comment:\n       Do we need this `as_adq()` here? It should be harmless / a no-op, but it should always go through the `inherits(.data, \"arrow_dplyr_query\")` path, no?\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -18,7 +18,12 @@\n do_exec_plan <- function(.data) {\n   plan <- ExecPlan$create()\n   final_node <- plan$Build(.data)\n-  tab <- plan$Run(final_node)$read_table()\n+  tab <- plan$Run(final_node)\n+\n+  # TODO (ARROW-14289): make the head/tail methods return RBR not Table\n+  if (inherits(tab, \"RecordBatchReader\")) {\n+    tab <- tab$read_table()\n+  }\n\nReview comment:\n       \ud83e\udd14 this might be useful in / simplify the `to_arrow()` branch\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:02:43.374+0000",
                    "updated": "2021-10-12T16:02:43.374+0000",
                    "started": "2021-10-12T16:02:43.374+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664146",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664161",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727314172\n\n\n\n##########\nFile path: r/R/dataset-scan.R\n##########\n@@ -143,6 +139,26 @@ Scanner$create <- function(dataset,\n #' @export\n names.Scanner <- function(x) names(x$schema)\n \n+#' @export\n+head.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n+  dataset___Scanner__head(x, n)\n+}\n+\n+#' @export\n+tail.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n\nReview comment:\n       Yeah, R supports negative `n` and does different things with it but that's not trivial for us/I don't want to deal with it now (also this is an old comment, just relocated in this PR)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:37:41.357+0000",
                    "updated": "2021-10-12T16:37:41.357+0000",
                    "started": "2021-10-12T16:37:41.356+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664161",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664162",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727315248\n\n\n\n##########\nFile path: r/R/dplyr.R\n##########\n@@ -162,22 +162,35 @@ as.data.frame.arrow_dplyr_query <- function(x, row.names = NULL, optional = FALS\n \n #' @export\n head.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- head.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  out <- as_adq(x)\n+  out$head <- n\n+  collapse.arrow_dplyr_query(out)\n }\n \n #' @export\n tail.arrow_dplyr_query <- function(x, n = 6L, ...) {\n-  # TODO (ARROW-13893): refactor\n-  out <- tail.Dataset(x, n, ...)\n-  restore_dplyr_features(out, x)\n+  out <- as_adq(x)\n\nReview comment:\n       You are right, it's not needed since we don't reuse this method for Datasets etc.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:38:57.504+0000",
                    "updated": "2021-10-12T16:38:57.504+0000",
                    "started": "2021-10-12T16:38:57.504+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664162",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664164",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941182955\n\n\n   We don't see _huge_ speedups (or slow downs) going from `... %>% arrange() %>% compute() %>% head() %>% collect()` to `... %>% arrange() %>% head() %>% collect()`. But like you mentioned, we expect a bigger speed up with topk which is not this PR\r\n   \r\n   It's a bit tricky to run these in scientific manner since https://issues.apache.org/jira/browse/ARROW-14197 prevents us from running more than one iteration at a time\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:40:34.643+0000",
                    "updated": "2021-10-12T16:40:34.643+0000",
                    "started": "2021-10-12T16:40:34.642+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664164",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727317186\n\n\n\n##########\nFile path: r/R/dataset-scan.R\n##########\n@@ -143,6 +139,26 @@ Scanner$create <- function(dataset,\n #' @export\n names.Scanner <- function(x) names(x$schema)\n \n+#' @export\n+head.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n+  dataset___Scanner__head(x, n)\n+}\n+\n+#' @export\n+tail.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n\nReview comment:\n       \ud83d\udc4d on deferring this. I bet it will come up, but we can (hopefully) deal with that when we have a proper way of doing this in a kernel. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:41:38.143+0000",
                    "updated": "2021-10-12T16:41:38.143+0000",
                    "started": "2021-10-12T16:41:38.142+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664165",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664167",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727318315\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -18,7 +18,12 @@\n do_exec_plan <- function(.data) {\n   plan <- ExecPlan$create()\n   final_node <- plan$Build(.data)\n-  tab <- plan$Run(final_node)$read_table()\n+  tab <- plan$Run(final_node)\n+\n+  # TODO (ARROW-14289): make the head/tail methods return RBR not Table\n+  if (inherits(tab, \"RecordBatchReader\")) {\n+    tab <- tab$read_table()\n+  }\n\nReview comment:\n       Maybe, I saw a few places where they could intersect\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:43:06.508+0000",
                    "updated": "2021-10-12T16:43:06.508+0000",
                    "started": "2021-10-12T16:43:06.508+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664167",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664169",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941187398\n\n\n   > We don't see _huge_ speedups (or slow downs)\r\n   \r\n   I wouldn't expect much performance change in the TPC-H queries since (IIUC) they're only sorting the result of a grouped aggregation, so the data being sorted/collected is relatively small.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:46:18.617+0000",
                    "updated": "2021-10-12T16:46:18.617+0000",
                    "started": "2021-10-12T16:46:18.617+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664169",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664172",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#discussion_r727322150\n\n\n\n##########\nFile path: r/R/dataset-scan.R\n##########\n@@ -143,6 +139,26 @@ Scanner$create <- function(dataset,\n #' @export\n names.Scanner <- function(x) names(x$schema)\n \n+#' @export\n+head.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n+  dataset___Scanner__head(x, n)\n+}\n+\n+#' @export\n+tail.Scanner <- function(x, n = 6L, ...) {\n+  assert_that(n > 0) # For now\n\nReview comment:\n       It's not a new limitation, it's been there as long as head/tail have been supported (version 2.0.0, one year ago), hasn't come up yet (at least on jira, to my knowledge) \ud83e\udd37 \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T16:48:19.354+0000",
                    "updated": "2021-10-12T16:48:19.354+0000",
                    "started": "2021-10-12T16:48:19.354+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664172",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664223",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941283928\n\n\n   On this PR, `head(taxi_ds)` returns quickly (and deterministically, IIUC) and arrange %>% head crashes (but isn't wrong!):\r\n   \r\n   ```\r\n   > ds %>% select(-rate_code_id) %>% arrange(desc(dropoff_at)) %>% head() %>% collect()\r\n   zsh: killed     R --no-save --no-restore-data --quiet\r\n   ```\r\n   \r\n   I expect (and will confirm) that with the TopK node in the followup PR, that should not crash.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T18:43:50.833+0000",
                    "updated": "2021-10-12T18:43:50.833+0000",
                    "started": "2021-10-12T18:43:50.833+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664223",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664304",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T20:12:58.845+0000",
                    "updated": "2021-10-12T20:12:58.845+0000",
                    "started": "2021-10-12T20:12:58.845+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664304",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664305",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941445785\n\n\n   Benchmark runs are scheduled for baseline = 8837f64d4e543de974da9dd0443957b073d9ec9d and contender = 71612e3f9dbad01c5379ff2f50740cc6d04368ae. 71612e3f9dbad01c5379ff2f50740cc6d04368ae is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0a75573ed1b64a5891a067ee83d6aebc...fc4654979f1043caba791e0e64e9a003/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/ce284db7efd44fd888d6af863394e8ee...bf8df6ef4a354b4699f41f37d22cc8d5/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/86761e90131745b0910dd56f8ddef752...9cae560986554f43acf3f4c5d02d69f9/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T20:13:37.441+0000",
                    "updated": "2021-10-12T20:13:37.441+0000",
                    "started": "2021-10-12T20:13:37.441+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664305",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664312",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941445785\n\n\n   Benchmark runs are scheduled for baseline = 8837f64d4e543de974da9dd0443957b073d9ec9d and contender = 71612e3f9dbad01c5379ff2f50740cc6d04368ae. 71612e3f9dbad01c5379ff2f50740cc6d04368ae is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0a75573ed1b64a5891a067ee83d6aebc...fc4654979f1043caba791e0e64e9a003/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/ce284db7efd44fd888d6af863394e8ee...bf8df6ef4a354b4699f41f37d22cc8d5/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/86761e90131745b0910dd56f8ddef752...9cae560986554f43acf3f4c5d02d69f9/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-12T20:25:17.584+0000",
                    "updated": "2021-10-12T20:25:17.584+0000",
                    "started": "2021-10-12T20:25:17.584+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664312",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664427",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941445785\n\n\n   Benchmark runs are scheduled for baseline = 8837f64d4e543de974da9dd0443957b073d9ec9d and contender = 71612e3f9dbad01c5379ff2f50740cc6d04368ae. 71612e3f9dbad01c5379ff2f50740cc6d04368ae is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0a75573ed1b64a5891a067ee83d6aebc...fc4654979f1043caba791e0e64e9a003/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/ce284db7efd44fd888d6af863394e8ee...bf8df6ef4a354b4699f41f37d22cc8d5/)\n   [Failed] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/86761e90131745b0910dd56f8ddef752...9cae560986554f43acf3f4c5d02d69f9/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T01:19:24.299+0000",
                    "updated": "2021-10-13T01:19:24.299+0000",
                    "started": "2021-10-13T01:19:24.299+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664427",
                    "issueId": "13399277"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/worklog/664460",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11373:\nURL: https://github.com/apache/arrow/pull/11373#issuecomment-941445785\n\n\n   Benchmark runs are scheduled for baseline = 8837f64d4e543de974da9dd0443957b073d9ec9d and contender = 71612e3f9dbad01c5379ff2f50740cc6d04368ae. 71612e3f9dbad01c5379ff2f50740cc6d04368ae is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0a75573ed1b64a5891a067ee83d6aebc...fc4654979f1043caba791e0e64e9a003/)\n   [Finished :arrow_down:1.36% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/ce284db7efd44fd888d6af863394e8ee...bf8df6ef4a354b4699f41f37d22cc8d5/)\n   [Failed] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/86761e90131745b0910dd56f8ddef752...9cae560986554f43acf3f4c5d02d69f9/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T04:25:22.952+0000",
                    "updated": "2021-10-13T04:25:22.952+0000",
                    "started": "2021-10-13T04:25:22.952+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664460",
                    "issueId": "13399277"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 18000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7145543b[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2d8f2e58[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@66ae97dc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@328798bf[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@86e3da0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3a0bcbc4[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2889ab2e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@26c59ce0[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5f3f36a5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3b0e936d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e3b8ff9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@54933a42[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 12 20:12:46 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-10-12T20:12:45.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13893/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2021-09-03T15:09:26.000+0000",
        "updated": "2021-10-13T21:37:10.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Make head/tail lazy on datasets and queries",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/comment/17419951",
                    "id": "17419951",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "The current behavior is a bit surprising even when it \"should\" be defined:\r\n\r\n{code:r}\r\n> library(arrow)\r\n> library(dplyr)\r\n> \r\n> tab <- Table$create(mtcars)\r\n> \r\n> tab %>% \r\n+   arrange(mpg) %>% \r\n+   head(4) %>% \r\n+   collect()\r\n   mpg cyl disp  hp drat    wt  qsec vs am gear carb\r\n1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\r\n2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\r\n3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\r\n4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\r\n> \r\n> mtcars %>% \r\n+   arrange(mpg) %>% \r\n+   head(4) %>% \r\n+   collect()\r\n                     mpg cyl disp  hp drat    wt  qsec vs am gear carb\r\nCadillac Fleetwood  10.4   8  472 205 2.93 5.250 17.98  0  0    3    4\r\nLincoln Continental 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4\r\nCamaro Z28          13.3   8  350 245 3.73 3.840 15.41  0  0    3    4\r\nDuster 360          14.3   8  360 245 3.21 3.570 15.84  0  0    3    4\r\n{code}\r\n\r\nI know there's some work to determine if `head()` could/should be defined int he absence of an explicit order, but after an `arrange()` it should work.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-09-24T19:44:43.382+0000",
                    "updated": "2021-09-24T19:44:43.382+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/comment/17419952",
                    "id": "17419952",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I'd kind of expect it to work too given our current threading model but, in general, and specifically with some of the threading models being proposed, you would need resequencing/serialization and not just an implicit order.\r\n\r\nOtherwise it is perfectly reasonable for the following ordering:\r\n\r\nSort node emits batch 1\r\nSort node emits batch 2\r\nProject node emits batch 2\r\nProject node emits batch 1",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-09-24T19:50:31.809+0000",
                    "updated": "2021-09-24T19:50:57.581+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/comment/17419961",
                    "id": "17419961",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Actually...I suppose sort / order by happens after projection, so I retract my previous statement.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-09-24T20:08:30.536+0000",
                    "updated": "2021-09-24T20:08:30.536+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13399277/comment/17427900",
                    "id": "17427900",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 11373\n[https://github.com/apache/arrow/pull/11373]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-12T20:12:46.018+0000",
                    "updated": "2021-10-12T20:12:46.018+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z0ulj4:",
        "customfield_12314139": null
    }
}