{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13356723",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723",
    "key": "ARROW-11495",
    "fields": {
        "fixVersions": [],
        "resolution": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "name": "Open",
            "id": "1",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                "id": 2,
                "key": "new",
                "colorName": "blue-gray",
                "name": "To Do"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sundyli",
            "name": "sundyli",
            "key": "sundyli",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34046",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34046",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34046",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34046"
            },
            "displayName": "benwang li",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sundyli",
            "name": "sundyli",
            "key": "sundyli",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34046",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34046",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34046",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34046"
            },
            "displayName": "benwang li",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11495/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 15,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/558932",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li opened a new pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596\n\n\n   We should consider number overflow in arithmetic operator functions.\r\n   \r\n   ```\r\n   UIn8 + UIn8 should be UInt16, but now it's UInt8\r\n   UInt16 * UInt16 should be UInt64, but now it's UInt16\r\n   ```\r\n   \r\n   Refer:  https://github.com/ClickHouse/ClickHouse/blob/bd81f43ecb/src/DataTypes/NumberTraits.h\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-27T13:44:05.565+0000",
                    "updated": "2021-02-27T13:44:05.565+0000",
                    "started": "2021-02-27T13:44:05.565+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558932",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/558933",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-787074912\n\n\n   https://issues.apache.org/jira/browse/ARROW-11495\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-27T13:44:19.041+0000",
                    "updated": "2021-02-27T13:44:19.041+0000",
                    "started": "2021-02-27T13:44:19.041+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558933",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/558945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-787079131\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=h1) Report\n   > Merging [#9596](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=desc) (f2a9f34) into [master](https://codecov.io/gh/apache/arrow/commit/5ae63f8ec0c14d5e871aa79d90e5d163b369e704?el=desc) (5ae63f8) will **increase** coverage by `0.01%`.\n   > The diff coverage is `80.18%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9596/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9596      +/-   ##\n   ==========================================\n   + Coverage   82.32%   82.34%   +0.01%     \n   ==========================================\n     Files         245      245              \n     Lines       56383    56473      +90     \n   ==========================================\n   + Hits        46419    46502      +83     \n   - Misses       9964     9971       +7     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [...tafusion/src/physical\\_plan/expressions/coercion.rs](https://codecov.io/gh/apache/arrow/pull/9596/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2V4cHJlc3Npb25zL2NvZXJjaW9uLnJz) | `83.11% <76.92%> (+4.70%)` | :arrow_up: |\n   | [...datafusion/src/physical\\_plan/expressions/binary.rs](https://codecov.io/gh/apache/arrow/pull/9596/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2V4cHJlc3Npb25zL2JpbmFyeS5ycw==) | `85.00% <100.00%> (\u00f8)` | |\n   | [rust/datafusion/tests/sql.rs](https://codecov.io/gh/apache/arrow/pull/9596/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3Rlc3RzL3NxbC5ycw==) | `98.28% <100.00%> (\u00f8)` | |\n   | [rust/arrow/src/compute/kernels/cast.rs](https://codecov.io/gh/apache/arrow/pull/9596/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL2Nhc3QucnM=) | `97.33% <0.00%> (+0.03%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=footer). Last update [5ae63f8...f2a9f34](https://codecov.io/gh/apache/arrow/pull/9596?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-27T14:14:23.987+0000",
                    "updated": "2021-02-27T14:14:23.987+0000",
                    "started": "2021-02-27T14:14:23.986+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558945",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559059",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-787447714\n\n\n   Thanks @sundy-li  -- I will try and review this tomorrow sometime\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-28T12:53:18.123+0000",
                    "updated": "2021-02-28T12:53:18.123+0000",
                    "started": "2021-02-28T12:53:18.122+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559059",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559510",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#discussion_r584917648\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/expressions/binary.rs\n##########\n@@ -700,9 +702,9 @@ mod tests {\n             DataType::UInt32,\n             vec![1u32, 2u32],\n             Operator::Plus,\n-            Int32Array,\n\nReview comment:\n       I reviewed the test changes in this file and they make sense to me. \ud83d\udc4d \n\n##########\nFile path: rust/datafusion/src/physical_plan/expressions/coercion.rs\n##########\n@@ -44,6 +46,68 @@ pub fn is_numeric(dt: &DataType) -> bool {\n         }\n }\n \n+/// Get next byte size of the integer number\n+fn next_size(size: usize) -> usize {\n+    if size < 8_usize {\n+        return size * 2;\n+    }\n+    size\n+}\n+\n+/// Determine if a DataType is float or not\n+pub fn is_floating(dt: &DataType) -> bool {\n+    matches!(\n+        dt,\n+        DataType::Float16 | DataType::Float32 | DataType::Float64\n+    )\n+}\n+\n+pub fn is_integer(dt: &DataType) -> bool {\n+    is_numeric(dt) && !is_floating(dt)\n+}\n+\n+pub fn numeric_byte_size(dt: &DataType) -> Option<usize> {\n+    match dt {\n+        DataType::Int8 | DataType::UInt8 => Some(1),\n+        DataType::Int16 | DataType::UInt16 | DataType::Float16 => Some(2),\n+        DataType::Int32 | DataType::UInt32 | DataType::Float32 => Some(4),\n+        DataType::Int64 | DataType::UInt64 | DataType::Float64 => Some(8),\n+        _ => None,\n+    }\n+}\n+\n+pub fn construct_numeric_type(\n+    is_signed: bool,\n+    is_floating: bool,\n+    byte_size: usize,\n+) -> Option<DataType> {\n+    match (is_signed, is_floating, byte_size) {\n+        (false, false, 1) => Some(DataType::UInt8),\n+        (false, false, 2) => Some(DataType::UInt16),\n+        (false, false, 4) => Some(DataType::UInt32),\n+        (false, false, 8) => Some(DataType::UInt64),\n+        (false, true, 1) => Some(DataType::Float16),\n+        (false, true, 2) => Some(DataType::Float16),\n+        (false, true, 4) => Some(DataType::Float32),\n+        (false, true, 8) => Some(DataType::Float64),\n+        (true, false, 1) => Some(DataType::Int8),\n+        (true, false, 2) => Some(DataType::Int16),\n+        (true, false, 4) => Some(DataType::Int32),\n+        (true, false, 8) => Some(DataType::Int64),\n+        (true, true, 1) => Some(DataType::Float32),\n+        (true, true, 2) => Some(DataType::Float32),\n+        (true, true, 4) => Some(DataType::Float32),\n+        (true, true, 8) => Some(DataType::Float64),\n+\n+        // TODO support bigint and decimal types, now we just let's overflow\n\nReview comment:\n       I think this is reasonable \n\n##########\nFile path: rust/datafusion/src/physical_plan/expressions/coercion.rs\n##########\n@@ -44,6 +46,68 @@ pub fn is_numeric(dt: &DataType) -> bool {\n         }\n }\n \n+/// Get next byte size of the integer number\n+fn next_size(size: usize) -> usize {\n+    if size < 8_usize {\n+        return size * 2;\n+    }\n+    size\n+}\n+\n+/// Determine if a DataType is float or not\n+pub fn is_floating(dt: &DataType) -> bool {\n\nReview comment:\n       I think it might be worth putting these functions on  `DataType` itself -- `DataType::is_floating(&self)`, and `DataType::numeric_byte_size(&self)` but we can always do that in a subsequent PR -- it is not needed for this one\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T17:48:08.787+0000",
                    "updated": "2021-03-01T17:48:08.787+0000",
                    "started": "2021-03-01T17:48:08.787+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559510",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559533",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788171536\n\n\n   I just tried a quick test on postgres which I think says postgres doesn't upcast integer types\r\n   \r\n   ```\r\n   alamb=# create table foo (x smallint);\r\n   CREATE TABLE\r\n   alamb=# create table bar as select x * x from foo;\r\n   SELECT 0\r\n   alamb=# \\d bar\r\n                     Table \"public.bar\"\r\n     Column  |   Type   | Collation | Nullable | Default \r\n   ----------+----------+-----------+----------+---------\r\n    ?column? | smallint |           |          | \r\n   \r\n   alamb=# \r\n   ```\r\n   \r\n   If a calculation overflows the maximum value of a `smallint`, postgres produces a runtime error rather than automatically upcasing:\r\n   \r\n   ```\r\n   alamb=# insert into foo values (32767);\r\n   INSERT 0 1\r\n   alamb=# select x + x from foo;\r\n   ERROR:  smallint out of range\r\n   alamb=# \r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T18:31:17.797+0000",
                    "updated": "2021-03-01T18:31:17.797+0000",
                    "started": "2021-03-01T18:31:17.796+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559533",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559535",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb edited a comment on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788171536\n\n\n   I just tried a quick test on postgres which I think says postgres doesn't upcast integer types\r\n   \r\n   ```sql\r\n   alamb=# create table foo (x smallint);\r\n   CREATE TABLE\r\n   alamb=# create table bar as select x * x from foo;\r\n   SELECT 0\r\n   alamb=# \\d bar\r\n                     Table \"public.bar\"\r\n     Column  |   Type   | Collation | Nullable | Default \r\n   ----------+----------+-----------+----------+---------\r\n    ?column? | smallint |           |          | \r\n   \r\n   alamb=# \r\n   ```\r\n   \r\n   If a calculation overflows the maximum value of a `smallint`, postgres produces a runtime error rather than automatically upcasing:\r\n   \r\n   ```sql\r\n   alamb=# insert into foo values (32767);\r\n   INSERT 0 1\r\n   alamb=# select x + x from foo;\r\n   ERROR:  smallint out of range\r\n   alamb=# \r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T18:31:37.073+0000",
                    "updated": "2021-03-01T18:31:37.073+0000",
                    "started": "2021-03-01T18:31:37.073+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559535",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559536",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788175032\n\n\n   .\r\n   \r\n   > I think this implementation looks really nice -- thank you @sundy-li . I believe that the code does what the PR description says it does.\r\n   > \r\n   > I wonder if you happen to know what Postgres does in this situation (eg adding 2 32-bit numbers together?) I can imagine certain situations when the users wants to choose performance over avoiding possible overflow and would prefer not to upcast both arguments to 64-bit.\r\n   > \r\n   > @Dandandan / @andygrove what do you think about what the default behavior should be?\r\n   \r\n   > I think this implementation looks really nice -- thank you @sundy-li . I believe that the code does what the PR description says it does.\r\n   > \r\n   > I wonder if you happen to know what Postgres does in this situation (eg adding 2 32-bit numbers together?) I can imagine certain situations when the users wants to choose performance over avoiding possible overflow and would prefer not to upcast both arguments to 64-bit.\r\n   > \r\n   > @Dandandan / @andygrove what do you think about what the default behavior should be?\r\n   \r\n   I think it could be acceptable to do a bit more here than PostgreSQL does? It think it will make DataFusion behave differently however from PostgreSQL.\r\n   E.g. PostgreSQL returns an error `integer out of range` on `SELECT 20000000000 + 20000000000` which I think the coercion will avoid by upcasting to 64 bit integers.\r\n   \r\n   > I think this implementation looks really nice -- thank you @sundy-li . I believe that the code does what the PR description says it does.\r\n   > \r\n   > I wonder if you happen to know what Postgres does in this situation (eg adding 2 32-bit numbers together?) I can imagine certain situations when the users wants to choose performance over avoiding possible overflow and would prefer not to upcast both arguments to 64-bit.\r\n   > \r\n   > @Dandandan / @andygrove what do you think about what the default behavior should be?\r\n   \r\n   I think it could be acceptable to do a bit more here than PostgreSQL does? It think it will make DataFusion behave differently however from PostgreSQL.\r\n   E.g. PostgreSQL returns an error `integer out of range` on `SELECT 20000000000 + 20000000000` but I think the coercion will avoid this error by upcasting to 64 bit integers.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T18:36:15.853+0000",
                    "updated": "2021-03-01T18:36:15.853+0000",
                    "started": "2021-03-01T18:36:15.852+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559536",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559539",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788185255\n\n\n   Also for memory/performance concerns - I think it makes sense to think about those as well. We will do some extra copies by casting, so `u8 + u8` will be converted if I understand correctly to `c(u8, u16) + c(u8, u16)`, but `u8 + u8 + u8` will involve more copies to something like `c(c(u8, u16)+ c(u8, u16), u32) + c(u8, u32)` etc. as the subexpressions are coerced to u16 already first. This could be optimized out a bit maybe to avoid the double casting, but it shows it can be quite inefficient.\n   \n   Also when doing IO and keeping the result in memory will result in more storage costs, longer latency and/or higher memory usage if you don't convert them to use smaller types again.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T18:52:38.388+0000",
                    "updated": "2021-03-01T18:52:38.388+0000",
                    "started": "2021-03-01T18:52:38.388+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559539",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559541",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan edited a comment on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788175032\n\n\n   .\r\n   \r\n   > I think this implementation looks really nice -- thank you @sundy-li . I believe that the code does what the PR description says it does.\r\n   > \r\n   > I wonder if you happen to know what Postgres does in this situation (eg adding 2 32-bit numbers together?) I can imagine certain situations when the users wants to choose performance over avoiding possible overflow and would prefer not to upcast both arguments to 64-bit.\r\n   > \r\n   > @Dandandan / @andygrove what do you think about what the default behavior should be?\r\n   \r\n   > I think this implementation looks really nice -- thank you @sundy-li . I believe that the code does what the PR description says it does.\r\n   > \r\n   > I wonder if you happen to know what Postgres does in this situation (eg adding 2 32-bit numbers together?) I can imagine certain situations when the users wants to choose performance over avoiding possible overflow and would prefer not to upcast both arguments to 64-bit.\r\n   > \r\n   > @Dandandan / @andygrove what do you think about what the default behavior should be?\r\n   \r\n   I think it could be acceptable to do a bit more here than PostgreSQL does? It think it will make DataFusion behave differently however from PostgreSQL.\r\n   E.g. PostgreSQL returns an error `integer out of range` on `SELECT 20000000000 + 20000000000` which I think the coercion will avoid by upcasting to 64 bit integers.\r \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T18:53:14.824+0000",
                    "updated": "2021-03-01T18:53:14.824+0000",
                    "started": "2021-03-01T18:53:14.823+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559541",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/559704",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-788519719\n\n\n   > Also for memory/performance concerns - I think it makes sense to think about those as well. We will do some extra copies by casting, so `u8 + u8` will be converted if I understand correctly to `c(u8, u16) + c(u8, u16)`, but `u8 + u8 + u8` will involve more copies to something like `c(c(u8, u16)+ c(u8, u16), u32) + c(u8, u32)` etc. as the subexpressions are coerced to u16 already first. This could be optimized out a bit maybe to avoid the double casting, but it shows it can be quite inefficient.\r\n   > \r\n   > Also when doing IO and keeping the result in memory will result in more storage costs, longer latency and/or higher memory usage if you don't convert them to use smaller types again.\r\n   \r\n   Yes, it is. But correctness is important than efficiency. So it may be worth doing that.  I'm a fan of ClickHouse, ClickHouse always pursues the ultimate performance, but it had to do that too.\r\n   \r\n   About behavior in mysql:\r\n   ```\r\n   mysql> select 3 / 2, 2 - 3, 127 + 3, 255 + 8;\r\n   +--------------+-------------+--------------+--------------+\r\n   | divide(3, 2) | minus(2, 3) | plus(127, 3) | plus(255, 8) |\r\n   +--------------+-------------+--------------+--------------+\r\n   |          1.5 |          -1 |          130 |          263 |\r\n   +--------------+-------------+--------------+--------------+\r\n   1 row in set (0.01 sec)\r\n   \r\n   ```\r\n   \r\n   \r\n   \r\n    \r\n   \r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T02:08:32.472+0000",
                    "updated": "2021-03-02T02:08:32.472+0000",
                    "started": "2021-03-02T02:08:32.472+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559704",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/568386",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "returnString commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-801967204\n\n\n   I wouldn't expect most operations on numeric types to result in changes, other than division (ever the awkward one). Imo the user should opt into this kind of behaviour by casting at least one of the inputs to the desired result type.\r\n   \r\n   For simple queries, it's not too bad, but if I were doing calculations in sql and then say writing back to another table, I would expect my u8 + u8 operations to yield more uint8s, not automatically convert to u16s. If I wanted that behaviour, I'd first promote one of those u8s to a u16 via casting.\r\n   \r\n   I also think that if people are explicitly selecting the smaller sizes of [u]ints, they're aware of the constraints and probably have a valid domain/resource reason for not using something larger.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-18T14:19:53.932+0000",
                    "updated": "2021-03-18T14:19:53.932+0000",
                    "started": "2021-03-18T14:19:53.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "568386",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/582164",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-819193149\n\n\n   Make sense, thank you all guys. Closing this pr.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-14T02:59:34.877+0000",
                    "updated": "2021-04-14T02:59:34.877+0000",
                    "started": "2021-04-14T02:59:34.877+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582164",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/582165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li closed pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-14T02:59:37.795+0000",
                    "updated": "2021-04-14T02:59:37.795+0000",
                    "started": "2021-04-14T02:59:37.795+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "582165",
                    "issueId": "13356723"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356723/worklog/583758",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9596:\nURL: https://github.com/apache/arrow/pull/9596#issuecomment-820694772\n\n\n   Thanks @sundy-li \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-15T19:59:05.077+0000",
                    "updated": "2021-04-15T19:59:05.077+0000",
                    "started": "2021-04-15T19:59:05.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "583758",
                    "issueId": "13356723"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6482300c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6896dd32[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e47b1f0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@669847[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@635acb3e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4f7077b9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2c5b9796[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@184b96fa[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2dfdbdf6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@617cca4f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@116b06d1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5553ae40[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "2021-02-04 09:58:15.0",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": null,
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11495/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-02-04T09:58:15.000+0000",
        "updated": "2021-12-16T16:59:38.000+0000",
        "timeoriginalestimate": null,
        "description": "Currently `numerical_coercion` did not take consideration for integer overflow, such as\u00a0\r\n\r\n\u00a0\r\n \u00a0\r\n{code:java}\r\n//\u4ee3\u7801\u5360\u4f4d\u7b26\r\nUIn8 + UIn8 should be UInt16, but now it's UInt8\r\nUInt16 * UInt16 should be UInt64, but now it's UInt16\r\n{code}\r\nClickHouse handled it well, maybe we should learn it from ClickHouse\r\n\r\n\u00a0\r\n{code:java}\r\n//\u4ee3\u7801\u5360\u4f4d\u7b26 From  https://github.com/ClickHouse/ClickHouse/blob/bd81f43ecb/src/DataTypes/NumberTraits.h\r\n\r\ntemplate <bool is_signed, bool is_floating, size_t size>\r\n struct Construct\r\n{ usingType=Error; }\r\n;\r\ntemplate <> struct Construct<false, false, 1> { using Type = UInt8; };\r\n template <> struct Construct<false, false, 2> { using Type = UInt16; };\r\n template <> struct Construct<false, false, 4> { using Type = UInt32; };\r\n template <> struct Construct<false, false, 8> { using Type = UInt64; };\r\n template <> struct Construct<false, false, 16> { using Type = UInt256; }; /// TODO: we cannot use our UInt128 here\r\n template <> struct Construct<false, false, 32> { using Type = UInt256; };\r\n template <> struct Construct<false, true, 1> { using Type = Float32; };\r\n template <> struct Construct<false, true, 2> { using Type = Float32; };\r\n template <> struct Construct<false, true, 4> { using Type = Float32; };\r\n template <> struct Construct<false, true, 8> { using Type = Float64; };\r\n template <> struct Construct<true, false, 1> { using Type = Int8; };\r\n template <> struct Construct<true, false, 2> { using Type = Int16; };\r\n template <> struct Construct<true, false, 4> { using Type = Int32; };\r\n template <> struct Construct<true, false, 8> { using Type = Int64; };\r\n template <> struct Construct<true, false, 16> { using Type = Int128; };\r\n template <> struct Construct<true, false, 32> { using Type = Int256; };\r\n template <> struct Construct<true, true, 1> { using Type = Float32; };\r\n template <> struct Construct<true, true, 2> { using Type = Float32; };\r\n template <> struct Construct<true, true, 4> { using Type = Float32; };\r\n template <> struct Construct<true, true, 8> { using Type = Float64; };\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[RUST] [datafusion] implementation for numerical_coercion is wrong",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [],
            "maxResults": 0,
            "total": 0,
            "startAt": 0
        },
        "customfield_12311820": "0|z0ncp4:",
        "customfield_12314139": null
    }
}