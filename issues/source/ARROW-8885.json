{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13306606",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606",
    "key": "ARROW-8885",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12347769",
                "id": "12347769",
                "description": "",
                "name": "1.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-07-24"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-8885/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436227",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson opened a new pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245\n\n\n   Rather than `#including` everything in one header file and `#including` that in every .cpp file, this breaks out those includes to each .cpp file. There's also a more limited `arrow_exports.h` now that is included in the `arrowExports.cpp` that gets generated. \r\n   \r\n   Installation/compilation time for the R bindings on my laptop (single-threaded) dropped from 130s to 90s (roughly 1/3 less, 40s total) as a result, so it seems like we were wasting a lot of CPU cycles before. \r\n   \r\n   There's probably more improvements that could be made here, open to suggestion from those who understand C++ better.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-21T21:57:50.473+0000",
                    "updated": "2020-05-21T21:57:50.473+0000",
                    "started": "2020-05-21T21:57:50.473+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436227",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436232",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#issuecomment-632369134\n\n\n   https://issues.apache.org/jira/browse/ARROW-8885\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-21T22:02:31.337+0000",
                    "updated": "2020-05-21T22:02:31.337+0000",
                    "started": "2020-05-21T22:02:31.337+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436232",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436253",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#issuecomment-632384317\n\n\n   @github-actions autotune\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-21T22:47:25.989+0000",
                    "updated": "2020-05-21T22:47:25.989+0000",
                    "started": "2020-05-21T22:47:25.989+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436253",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436500",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques closed pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T12:05:28.140+0000",
                    "updated": "2020-05-22T12:05:28.140+0000",
                    "started": "2020-05-22T12:05:28.140+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436500",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436554",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429303750\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n #include <arrow/result.h>\n-#include <arrow/type.h>\n #include <arrow/type_fwd.h>\n-#include <arrow/util/checked_cast.h>\n-#include <arrow/util/compression.h>\n-#include <arrow/util/iterator.h>\n+// Do we need ubsan always there?\n\nReview comment:\n       question\n\n##########\nFile path: r/src/array_from_vector.cpp\n##########\n@@ -20,6 +20,11 @@\n #include \"./arrow_types.h\"\n \n #if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/array.h>\n+#include <arrow/builder.h>\n+#include <arrow/table.h>\n+// This says \"Private header, not to be exported\"\n\nReview comment:\n       Is this ok?\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       The RBuffer class definition should probably be moved to buffer.cpp but I didn't work out how to register it in the namespace in this file.\n\n##########\nFile path: r/src/arrow_exports.h\n##########\n@@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+// This gets included in arrowExports.cpp\n+\n+#pragma once\n+\n+#include \"arrow_rcpp.h\"\n+\n+#if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/csv/reader.h>\n+#include <arrow/dataset/api.h>\n\nReview comment:\n       I suspect if there were more type_fwd.h files (like for dataset), we could trim this file back further and shave off some more seconds. \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T15:12:37.436+0000",
                    "updated": "2020-05-22T15:12:37.436+0000",
                    "started": "2020-05-22T15:12:37.436+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436554",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436603",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429369559\n\n\n\n##########\nFile path: r/src/array_from_vector.cpp\n##########\n@@ -20,6 +20,11 @@\n #include \"./arrow_types.h\"\n \n #if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/array.h>\n+#include <arrow/builder.h>\n+#include <arrow/table.h>\n+// This says \"Private header, not to be exported\"\n\nReview comment:\n       Yep, this is fine.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:27:59.469+0000",
                    "updated": "2020-05-22T17:27:59.469+0000",
                    "started": "2020-05-22T17:27:59.469+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436603",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436605",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429371319\n\n\n\n##########\nFile path: r/src/arrow_exports.h\n##########\n@@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+// This gets included in arrowExports.cpp\n+\n+#pragma once\n+\n+#include \"arrow_rcpp.h\"\n+\n+#if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/csv/reader.h>\n+#include <arrow/dataset/api.h>\n\nReview comment:\n       It ain't going to help, you'll have to include `<arrow/dataset/api.h` in `arrowExports.cpp` anyway (since it calls the dataset constructor/destructor/move.\n\n##########\nFile path: r/src/arrow_exports.h\n##########\n@@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+// This gets included in arrowExports.cpp\n+\n+#pragma once\n+\n+#include \"arrow_rcpp.h\"\n+\n+#if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/csv/reader.h>\n+#include <arrow/dataset/api.h>\n\nReview comment:\n       It ain't going to help, you'll have to include `<arrow/dataset/api.h` in `arrowExports.cpp` anyway (since it calls the dataset constructor/destructor/move).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:32:09.103+0000",
                    "updated": "2020-05-22T17:32:09.103+0000",
                    "started": "2020-05-22T17:32:09.103+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436605",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429372456\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       `RBuffer` is a templated class, the definition must be in the header and all it's dependencies must also be included in the headers.\r\n   \r\n   In other words, by moving `RBuffer` in it's own file, the using classes will also need to include this new header + the original `<arrow/buffer.h>`, e.g. no benefits.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:34:18.267+0000",
                    "updated": "2020-05-22T17:34:18.267+0000",
                    "started": "2020-05-22T17:34:18.267+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436606",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436607",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429372456\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       `RBuffer` is a templated class, the definition must be in the header and all it's dependencies must also be included in the headers.\r\n   \r\n   In other words, by moving `RBuffer` in it's own file, the using classes will also need to include this new header + the original `<arrow/buffer.h>`, i.e. no benefits.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:34:31.435+0000",
                    "updated": "2020-05-22T17:34:31.435+0000",
                    "started": "2020-05-22T17:34:31.435+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436607",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436608",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429372721\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n #include <arrow/result.h>\n-#include <arrow/type.h>\n #include <arrow/type_fwd.h>\n-#include <arrow/util/checked_cast.h>\n-#include <arrow/util/compression.h>\n-#include <arrow/util/iterator.h>\n+// Do we need ubsan always there?\n\nReview comment:\n       It's not needed, I removed it (will be in #7251).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:34:54.735+0000",
                    "updated": "2020-05-22T17:34:54.735+0000",
                    "started": "2020-05-22T17:34:54.735+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436608",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436612",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#issuecomment-632825223\n\n\n   @nealrichardson the next step is probably to break `arrowExport.{h,cpp}` into one per file cpp file, e.g.\r\n   \r\n   ```\r\n   src/buffer.cpp\r\n   src/buffer.h\r\n   src/buffer_export.cpp\r\n   ...\r\n   ```\r\n   \r\n   This will make the export file much smaller and require less headers to read, on top of allowing this to be parallelized (as opposed to a single thread for the huge file as it is). I suspect we can shave probably another 33%, the final link will still be a bottleneck.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:43:39.789+0000",
                    "updated": "2020-05-22T17:43:39.789+0000",
                    "started": "2020-05-22T17:43:39.789+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436612",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436613",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques edited a comment on pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#issuecomment-632825223\n\n\n   @nealrichardson the next step is probably to break `arrowExport.{h,cpp}` into one per file cpp file, e.g.\r\n   \r\n   ```\r\n   src/buffer.cpp\r\n   src/buffer.h\r\n   src/buffer_export.cpp\r\n   ...\r\n   ```\r\n   \r\n   This will make the export file much smaller and require less headers to read, on top of allowing this to be parallelized (as opposed to a single thread for the huge file as it is). I suspect we can shave probably another 33%, the final link will still be a bottleneck. I'm not familiar with rcpp and it's restrictions/requirements, @romainfrancois might say if this is never going to work.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T17:45:03.197+0000",
                    "updated": "2020-05-22T17:45:03.197+0000",
                    "started": "2020-05-22T17:45:03.197+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436613",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436625",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429388011\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       Right but only 2 cpp files need RBuffer, so we wouldn\u2019t have to include it for the other 20 files. So does that help?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T18:09:58.076+0000",
                    "updated": "2020-05-22T18:09:58.076+0000",
                    "started": "2020-05-22T18:09:58.075+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436625",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436633",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429395569\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       It doesn't, I had to touch 6 files, but it's exactly the same time to compile.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T18:29:10.448+0000",
                    "updated": "2020-05-22T18:29:10.448+0000",
                    "started": "2020-05-22T18:29:10.447+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436633",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436654",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429431625\n\n\n\n##########\nFile path: r/src/arrow_types.h\n##########\n@@ -176,64 +37,21 @@ inline constexpr Rbyte default_value<RAWSXP>() {\n \n }  // namespace Rcpp\n \n-namespace arrow {\n-namespace r {\n-\n-template <typename T>\n-inline std::shared_ptr<T> extract(SEXP x) {\n-  return Rcpp::ConstReferenceSmartPtrInputParameter<std::shared_ptr<T>>(x);\n-}\n-\n-}  // namespace r\n-}  // namespace arrow\n-\n #if defined(ARROW_R_WITH_ARROW)\n-#include <arrow/api.h>\n-#include <arrow/c/bridge.h>\n-#include <arrow/compute/api.h>\n-#include <arrow/csv/reader.h>\n-#include <arrow/dataset/api.h>\n-#include <arrow/filesystem/filesystem.h>\n-#include <arrow/filesystem/localfs.h>\n-#include <arrow/filesystem/s3fs.h>\n-#include <arrow/io/compressed.h>\n-#include <arrow/io/file.h>\n-#include <arrow/io/memory.h>\n-#include <arrow/ipc/feather.h>\n-#include <arrow/ipc/reader.h>\n-#include <arrow/ipc/writer.h>\n-#include <arrow/json/reader.h>\n+#include <arrow/buffer.h>  // for RBuffer definition below\n\nReview comment:\n       \ud83d\udc4d I don't have great instincts about what drives compile time and how to optimize it\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T20:02:28.844+0000",
                    "updated": "2020-05-22T20:02:28.844+0000",
                    "started": "2020-05-22T20:02:28.844+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436654",
                    "issueId": "13306606"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/worklog/436655",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #7245:\nURL: https://github.com/apache/arrow/pull/7245#discussion_r429433084\n\n\n\n##########\nFile path: r/src/arrow_exports.h\n##########\n@@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+// This gets included in arrowExports.cpp\n+\n+#pragma once\n+\n+#include \"arrow_rcpp.h\"\n+\n+#if defined(ARROW_R_WITH_ARROW)\n+#include <arrow/csv/reader.h>\n+#include <arrow/dataset/api.h>\n\nReview comment:\n       Are you sure? IIUC (which I may very well not) arrowExports.cpp itself doesn't call the constructors etc., it just wraps, so you just need to have the types in the signature declared somewhere. See e.g. https://github.com/apache/arrow/blob/master/r/src/arrowExports.cpp#L1534-L1547\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-22T20:06:47.163+0000",
                    "updated": "2020-05-22T20:06:47.163+0000",
                    "started": "2020-05-22T20:06:47.163+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436655",
                    "issueId": "13306606"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@30a9fa56[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7625896f[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4298d5c7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@18ac520a[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6d24eba7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@37f9d258[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33cb0f8d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@490d37fc[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3be84a9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7a2cfd94[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@11f0323b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@31e2452e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri May 22 12:06:45 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-05-22T12:06:45.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-8885/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-05-21T21:51:29.000+0000",
        "updated": "2020-05-22T20:06:48.000+0000",
        "timeoriginalestimate": null,
        "description": "I noticed that we were jamming all of our arrow #includes in one header file in the R bindings and then including that everywhere. Seemed like that was wasteful and probably causing compilation to be slower.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Don't include everything everywhere",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13306606/comment/17113970",
                    "id": "17113970",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
                        "name": "fsaintjacques",
                        "key": "fsaintjacques",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
                        },
                        "displayName": "Francois Saint-Jacques",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 7245\n[https://github.com/apache/arrow/pull/7245]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
                        "name": "fsaintjacques",
                        "key": "fsaintjacques",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
                        },
                        "displayName": "Francois Saint-Jacques",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-05-22T12:06:45.438+0000",
                    "updated": "2020-05-22T12:06:45.438+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0f0wg:",
        "customfield_12314139": null
    }
}