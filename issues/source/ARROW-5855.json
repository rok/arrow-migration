{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13243258",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258",
    "key": "ARROW-5855",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5855/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 43,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/321979",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566\n \n \n   https://issues.apache.org/jira/browse/ARROW-5855\r\n   \r\n   - [x] Basic wrappers for DurationArray/Type/Value\r\n   - [x] Numpy / pandas conversion\r\n   - [ ] Python conversion\r\n   \r\n   I also still need to see if I can deduplicate some parts in the arrow_to_pandas conversion (share more with datetime).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-02T15:20:42.536+0000",
                    "updated": "2019-10-02T15:20:42.536+0000",
                    "started": "2019-10-02T15:20:42.535+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "321979",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/321985",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#issuecomment-537548353\n \n \n   https://issues.apache.org/jira/browse/ARROW-5855\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-02T15:31:11.511+0000",
                    "updated": "2019-10-02T15:31:11.511+0000",
                    "started": "2019-10-02T15:31:11.511+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "321985",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322584",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331032295\n \n \n\n ##########\n File path: cpp/src/arrow/python/python_to_arrow.cc\n ##########\n @@ -449,6 +449,63 @@ class TimestampConverter\n   TimeUnit::type unit_;\n };\n \n+template <NullCoding null_coding>\n+class DurationConverter\n \n Review comment:\n   This is almost literally a copy paste of the TimestampConverter above with timestamp-things replaced with duration-things. Is there a way to deduplicate some code? \r\n   Templating this might be difficult as I also need to switch Python / numpy C API calls? (`PyDateTime_DateTime` -> `PyDateTime_Delta`, `PyDatetimeScalarObject` -> `PyTimedeltaScalarObject`, ...)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T13:16:51.441+0000",
                    "updated": "2019-10-03T13:16:51.441+0000",
                    "started": "2019-10-03T13:16:51.441+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322584",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322669",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#issuecomment-537977486\n \n \n   Also opened a few follow-up items that I ran into: https://issues.apache.org/jira/browse/ARROW-6778 (casting), overflow in conversion to ns (https://issues.apache.org/jira/browse/ARROW-6779) and parquet support (https://issues.apache.org/jira/browse/ARROW-6780).\r\n   \r\n   Another question is if we want to call this type \"timedelta\" instead of \"duration\" in the python interface (like we also have `pa.float64()` and not `pa.double()`), since standard library, numpy and pandas all call this \"timedelta\"). \r\n   Although I actually see this float64 / double is rather inconsistent (as the type you create with `pa.float64`still prints as \"double\")\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T14:45:20.026+0000",
                    "updated": "2019-10-03T14:45:20.026+0000",
                    "started": "2019-10-03T14:45:20.026+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322669",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322689",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331101922\n \n \n\n ##########\n File path: cpp/src/arrow/python/python_to_arrow.cc\n ##########\n @@ -449,6 +449,63 @@ class TimestampConverter\n   TimeUnit::type unit_;\n };\n \n+template <NullCoding null_coding>\n+class DurationConverter\n \n Review comment:\n   Can use something like this:\r\n   ```cpp\r\n   template <typename ArrowType>\r\n   struct PyDateTimeTraits {};\r\n   \r\n   template <>\r\n   struct PyDateTimeTraits<TimestampType> {\r\n     using PyTypeCheck = PyDateTime_Check;\r\n     using PyDateTimeObject = PyDateTime_DateTime;\r\n   \r\n     using py_to_s = internal::PyDateTime_to_s;\r\n     using py_to_ms = internal::PyDateTime_to_ms;\r\n     using py_to_us = internal::PyDateTime_to_us;\r\n     using py_to_ns = internal::PyDateTime_to_ns;\r\n   \r\n     using np_traits = internal::npy_traits<NPY_DATETIME>;\r\n     using NpScalarObject = PyDatetimeScalarObject;\r\n   };\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:50.498+0000",
                    "updated": "2019-10-03T15:36:50.498+0000",
                    "started": "2019-10-03T15:36:50.498+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322689",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322690",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331096895\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1082,6 +1105,53 @@ class DatetimeBlock : public PandasBlock {\n   }\n };\n \n+class TimedeltaBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+  Status AllocateDatetime(int ndim) {\n+    RETURN_NOT_OK(AllocateNDArray(NPY_TIMEDELTA, ndim));\n+\n+    PyAcquireGIL lock;\n+    auto date_dtype = reinterpret_cast<PyArray_DatetimeDTypeMetaData*>(\n+        PyArray_DESCR(reinterpret_cast<PyArrayObject*>(block_arr_.obj()))->c_metadata);\n+    date_dtype->meta.base = NPY_FR_ns;\n+    return Status::OK();\n+  }\n+\n+  Status Allocate() override { return AllocateDatetime(2); }\n+\n+  Status Write(std::shared_ptr<ChunkedArray> data, int64_t abs_placement,\n+               int64_t rel_placement) override {\n+    Type::type type = data->type()->id();\n+\n+    int64_t* out_buffer =\n+        reinterpret_cast<int64_t*>(block_data_) + rel_placement * num_rows_;\n+\n+    if (type == Type::DURATION) {\n+      const auto& ts_type = checked_cast<const DurationType&>(*data->type());\n+\n+      if (ts_type.unit() == TimeUnit::NANO) {\n+        ConvertNumericNullable<int64_t>(*data, kPandasTimestampNull, out_buffer);\n \n Review comment:\n   For consistency, you could probably call `ConvertDatetimeLikeNanos<int64_t, 1L>(*data, out_buffer);`. The multiplication should be optimized away in release mode.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:50.697+0000",
                    "updated": "2019-10-03T15:36:50.697+0000",
                    "started": "2019-10-03T15:36:50.697+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322690",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322691",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331108049\n \n \n\n ##########\n File path: python/pyarrow/tests/test_scalars.py\n ##########\n @@ -299,6 +299,46 @@ def test_timestamp_no_overflow(self):\n         result = arr.to_pylist()\n         assert result == timestamp_rows\n \n+    def test_duration(self):\n+        arr = np.array([0, 3600000000000], dtype='timedelta64[ns]')\n+\n+        units = ['us', 'ms', 's']\n \n Review comment:\n   Why not test nanoseconds as well?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:50.831+0000",
                    "updated": "2019-10-03T15:36:50.831+0000",
                    "started": "2019-10-03T15:36:50.830+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322691",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322692",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331092874\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1082,6 +1105,53 @@ class DatetimeBlock : public PandasBlock {\n   }\n };\n \n+class TimedeltaBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+  Status AllocateDatetime(int ndim) {\n+    RETURN_NOT_OK(AllocateNDArray(NPY_TIMEDELTA, ndim));\n+\n+    PyAcquireGIL lock;\n+    auto date_dtype = reinterpret_cast<PyArray_DatetimeDTypeMetaData*>(\n+        PyArray_DESCR(reinterpret_cast<PyArrayObject*>(block_arr_.obj()))->c_metadata);\n+    date_dtype->meta.base = NPY_FR_ns;\n+    return Status::OK();\n+  }\n+\n+  Status Allocate() override { return AllocateDatetime(2); }\n \n Review comment:\n   Why is it 2 by default?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.019+0000",
                    "updated": "2019-10-03T15:36:51.019+0000",
                    "started": "2019-10-03T15:36:51.018+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322692",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322693",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331104001\n \n \n\n ##########\n File path: python/pyarrow/scalar.pxi\n ##########\n @@ -405,6 +405,69 @@ cdef class TimestampValue(ArrayValue):\n         return converter(value, tzinfo=tzinfo)\n \n \n+cdef dict _TIMEDELTA_CONVERSION_FUNCTIONS = {}\n+cdef c_bool _timedelta_conversion_initialized = False\n+\n+\n+def _nanoseconds_to_timedelta_safe(v):\n+    if v % 1000 != 0:\n+        raise ValueError(\n+            \"Nanosecond duration {} is not safely convertible to microseconds \"\n+            \"to convert to datetime.timedelta. Install pandas to return as \"\n+            \"Timedelta with nanosecond support or access the .value \"\n+            \"attribute.\".format(v))\n+    micros = v // 1000\n+\n+    return datetime.timedelta(microseconds=micros)\n+\n+\n+def _timedelta_conversion_functions():\n+    global _timedelta_conversion_initialized\n+    if _timedelta_conversion_initialized:\n \n Review comment:\n   Or simply `if _TIMEDELTA_CONVERSION_FUNCTIONS`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.022+0000",
                    "updated": "2019-10-03T15:36:51.022+0000",
                    "started": "2019-10-03T15:36:51.021+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322693",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322694",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331101567\n \n \n\n ##########\n File path: cpp/src/arrow/python/datetime.h\n ##########\n @@ -113,6 +113,43 @@ inline int64_t PyDateTime_to_ns(PyDateTime_DateTime* pydatetime) {\n   return PyDateTime_to_us(pydatetime) * 1000;\n }\n \n+ARROW_PYTHON_EXPORT\n+inline int64_t PyDelta_to_s(PyDateTime_Delta* pytimedelta) {\n+  int64_t total_seconds = 0;\n+  // TODO(py2) change to \"PyDateTime_DELTA_GET_SECONDS/DAYS(pytimedelta)\"\n+  total_seconds +=\n+      PyLong_AsLongLong(PyObject_GetAttrString((PyObject*)pytimedelta, \"seconds\"));\n \n Review comment:\n   The previous version of this code didn't use attribute access. Why did you switch to this? It's gonna be a lot slower.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.034+0000",
                    "updated": "2019-10-03T15:36:51.034+0000",
                    "started": "2019-10-03T15:36:51.034+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322694",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322695",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331104574\n \n \n\n ##########\n File path: python/pyarrow/tests/test_array.py\n ##########\n @@ -926,6 +931,16 @@ def test_cast_date32_to_int():\n     assert result2.equals(arr)\n \n \n+@pytest.mark.xfail(strict=True)  # TODO implement duration cast\n \n Review comment:\n   Just open a JIRA instead of adding a failing test.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.038+0000",
                    "updated": "2019-10-03T15:36:51.038+0000",
                    "started": "2019-10-03T15:36:51.037+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322695",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322696",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331106791\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_builtin.py\n ##########\n @@ -932,6 +964,93 @@ class CustomClass():\n             pa.array([1, CustomClass()], type=ty)\n \n \n+@pytest.mark.parametrize('np_scalar', [True, False])\n+def test_sequence_duration(np_scalar):\n+    td1 = datetime.timedelta(1, 1, 1)\n+    td2 = datetime.timedelta(1, 100)\n+    if np_scalar:\n+        data = [np.timedelta64(td1), None, np.timedelta64(td2)]\n+    else:\n+        data = [td1, None, td2]\n+\n+    arr = pa.array(data)\n+    assert len(arr) == 3\n+    assert arr.type == pa.duration('us')\n+    assert arr.null_count == 1\n+    assert arr[0].as_py() == td1\n+    assert arr[1].as_py() is None\n+    assert arr[2].as_py() == td2\n+\n+\n+@pytest.mark.parametrize('unit', ['s', 'ms', 'us', 'ns'])\n+def test_sequence_duration_with_unit(unit):\n+    data = [\n+        datetime.timedelta(1, 1, 1001),\n \n Review comment:\n   Would be nice to test with more interesting values here as well...\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.041+0000",
                    "updated": "2019-10-03T15:36:51.041+0000",
                    "started": "2019-10-03T15:36:51.041+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322696",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322697",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331090591\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -230,6 +231,26 @@ inline void set_numpy_metadata(int type, const DataType* datatype, PyArray_Descr\n       // datatype->type == Type::DATE64\n       date_dtype->meta.base = NPY_FR_D;\n     }\n+  } else if (type == NPY_TIMEDELTA) {\n+    auto date_dtype = reinterpret_cast<PyArray_DatetimeDTypeMetaData*>(out->c_metadata);\n+    if (datatype->id() == Type::DURATION) {\n \n Review comment:\n   What happens if not?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.044+0000",
                    "updated": "2019-10-03T15:36:51.044+0000",
                    "started": "2019-10-03T15:36:51.044+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322697",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322698",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331108335\n \n \n\n ##########\n File path: python/pyarrow/tests/test_scalars.py\n ##########\n @@ -299,6 +299,46 @@ def test_timestamp_no_overflow(self):\n         result = arr.to_pylist()\n         assert result == timestamp_rows\n \n+    def test_duration(self):\n+        arr = np.array([0, 3600000000000], dtype='timedelta64[ns]')\n+\n+        units = ['us', 'ms', 's']\n+\n+        for i, unit in enumerate(units):\n+            dtype = 'timedelta64[{0}]'.format(unit)\n+            arrow_arr = pa.array(arr.astype(dtype))\n+            expected = datetime.timedelta(seconds=60*60)\n+            assert isinstance(arrow_arr[1].as_py(), datetime.timedelta)\n+            assert arrow_arr[1].as_py() == expected\n+            assert (arrow_arr[1].value * 1000**(i+1) ==\n+                    expected.total_seconds() * 1e9)\n+\n+    @pytest.mark.pandas\n+    def test_duration_nanos_pandas(self):\n+        import pandas as pd\n+        arr = pa.array([0, 3600000000000], type=pa.duration('ns'))\n+        expected = pd.Timedelta('1 hour')\n+        assert isinstance(arr[1].as_py(), pd.Timedelta)\n+        assert arr[1].as_py() == expected\n+        assert arr[1].value == expected.value\n+\n+        # Non-zero nanos work fine\n+        arr = pa.array([946684800000000001], type=pa.duration('ns'))\n+        arr[0].as_py() == pd.Timedelta(946684800000000001, unit='ns')\n \n Review comment:\n   You forgot the `assert` :-)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.086+0000",
                    "updated": "2019-10-03T15:36:51.086+0000",
                    "started": "2019-10-03T15:36:51.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322698",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322699",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331105508\n \n \n\n ##########\n File path: python/pyarrow/tests/test_array.py\n ##########\n @@ -1229,6 +1245,47 @@ def test_array_from_timestamp_with_generic_unit():\n         pa.array([n, x, y])\n \n \n+@pytest.mark.parametrize(('dtype', 'type'), [\n+    ('timedelta64[s]', pa.duration('s')),\n+    ('timedelta64[ms]', pa.duration('ms')),\n+    ('timedelta64[us]', pa.duration('us')),\n+    ('timedelta64[ns]', pa.duration('ns'))\n+])\n+def test_array_from_numpy_timedelta(dtype, type):\n+    data = [\n+        None,\n+        datetime.timedelta(1),\n+        datetime.timedelta(0, 1)\n+    ]\n+\n+    # from numpy array\n+    np_arr = np.array(data, dtype=dtype)\n+    arr = pa.array(np_arr)\n+    assert isinstance(arr, pa.DurationArray)\n+    assert arr.type == type\n+    expected = pa.array(data, type=type)\n+    assert arr.equals(expected)\n \n Review comment:\n   What does `arr.to_pylist()` say?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.090+0000",
                    "updated": "2019-10-03T15:36:51.090+0000",
                    "started": "2019-10-03T15:36:51.089+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322699",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322700",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331106109\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_builtin.py\n ##########\n @@ -863,6 +867,34 @@ def test_datetime_subclassing():\n     assert arr_us[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n                                                   23, 34, 123456)\n \n+    data = [\n+        MyTimedelta(1, 1, 1000),\n \n Review comment:\n   Is it possible to test the conversion with more interesting values?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T15:36:51.102+0000",
                    "updated": "2019-10-03T15:36:51.102+0000",
                    "started": "2019-10-03T15:36:51.102+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322700",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322715",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331126356\n \n \n\n ##########\n File path: python/pyarrow/tests/test_convert_builtin.py\n ##########\n @@ -863,6 +867,34 @@ def test_datetime_subclassing():\n     assert arr_us[0].as_py() == datetime.datetime(2007, 7, 13, 1,\n                                                   23, 34, 123456)\n \n+    data = [\n+        MyTimedelta(1, 1, 1000),\n \n Review comment:\n   What values would you find interesting? (thinking about specific corner cases?)\r\n   \r\n   (it's mainly the fact that the subclass is working that is being tested here)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T16:13:58.147+0000",
                    "updated": "2019-10-03T16:13:58.147+0000",
                    "started": "2019-10-03T16:13:58.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322715",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322716",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331117184\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -230,6 +231,26 @@ inline void set_numpy_metadata(int type, const DataType* datatype, PyArray_Descr\n       // datatype->type == Type::DATE64\n       date_dtype->meta.base = NPY_FR_D;\n     }\n+  } else if (type == NPY_TIMEDELTA) {\n+    auto date_dtype = reinterpret_cast<PyArray_DatetimeDTypeMetaData*>(out->c_metadata);\n+    if (datatype->id() == Type::DURATION) {\n \n Review comment:\n   That shouldn't happen (as NPY_TIMEDELTA should only be passed in case of Type::DURATION). So I can just leave out the if check? (and maybe add a debug assert?) \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T16:13:58.151+0000",
                    "updated": "2019-10-03T16:13:58.151+0000",
                    "started": "2019-10-03T16:13:58.150+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322716",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322717",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331124852\n \n \n\n ##########\n File path: python/pyarrow/tests/test_array.py\n ##########\n @@ -926,6 +931,16 @@ def test_cast_date32_to_int():\n     assert result2.equals(arr)\n \n \n+@pytest.mark.xfail(strict=True)  # TODO implement duration cast\n \n Review comment:\n   I already opened https://issues.apache.org/jira/browse/ARROW-6778 for that (but I also already wrote the test when I found out, so thought to just keep it)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T16:13:58.155+0000",
                    "updated": "2019-10-03T16:13:58.155+0000",
                    "started": "2019-10-03T16:13:58.154+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322717",
                    "issueId": "13243258"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/worklog/322718",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5566: ARROW-5855: [Python] Support for Duration (timedelta) type\nURL: https://github.com/apache/arrow/pull/5566#discussion_r331122831\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1082,6 +1105,53 @@ class DatetimeBlock : public PandasBlock {\n   }\n };\n \n+class TimedeltaBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+  Status AllocateDatetime(int ndim) {\n+    RETURN_NOT_OK(AllocateNDArray(NPY_TIMEDELTA, ndim));\n+\n+    PyAcquireGIL lock;\n+    auto date_dtype = reinterpret_cast<PyArray_DatetimeDTypeMetaData*>(\n+        PyArray_DESCR(reinterpret_cast<PyArrayObject*>(block_arr_.obj()))->c_metadata);\n+    date_dtype->meta.base = NPY_FR_ns;\n+    return Status::OK();\n+  }\n+\n+  Status Allocate() override { return AllocateDatetime(2); }\n \n Review comment:\n   Because pandas stores this as a 2D numpy array. \r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T16:13:58.158+0000",
                    "updated": "2019-10-03T16:13:58.158+0000",
                    "started": "2019-10-03T16:13:58.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322718",
                    "issueId": "13243258"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 18000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@c5302c3[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@75c798da[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@19206fe9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5068255f[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4bd3c61c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4f2a73b9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@556f1292[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@443c97bd[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@118a4a00[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@da15433[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@20f72c97[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@56c64b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 08 11:12:46 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-10-08T11:12:46.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5855/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-07-04T20:07:50.000+0000",
        "updated": "2019-10-08T11:17:37.000+0000",
        "timeoriginalestimate": null,
        "description": "Add support for the Duration type (added in C++: ARROW-835, ARROW-5261)\r\n\r\n- add DurationType and DurationArray wrappers\r\n- add inference support for datetime.timedelta / np.timedelta64",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Add support for Duration type",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13243258/comment/16946722",
                    "id": "16946722",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 5566\n[https://github.com/apache/arrow/pull/5566]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2019-10-08T11:12:46.822+0000",
                    "updated": "2019-10-08T11:12:46.822+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z04dxk:",
        "customfield_12314139": null
    }
}