{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13370150",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150",
    "key": "ARROW-12263",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12334506",
                "id": "12334506",
                "name": "Developer Tools"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333001",
                "id": "12333001",
                "name": "Packaging"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
            "name": "kszucs",
            "key": "kszucs",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Krisztian Szucs",
            "active": true,
            "timeZone": "Europe/Budapest"
        },
        "aggregateprogress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12263/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 11,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/578476",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815077273\n\n\n   Submitted nightly jobs manually: https://github.com/ursacomputing/crossbow/branches/all?query=build-141\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T17:06:00.457+0000",
                    "updated": "2021-04-07T17:06:00.457+0000",
                    "started": "2021-04-07T17:06:00.457+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578476",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/578660",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815246713\n\n\n   https://issues.apache.org/jira/browse/ARROW-12263\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T20:39:01.589+0000",
                    "updated": "2021-04-07T20:39:01.589+0000",
                    "started": "2021-04-07T20:39:01.589+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578660",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/578822",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs removed a comment on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815077273\n\n\n   Submitted nightly jobs manually: https://github.com/ursacomputing/crossbow/branches/all?query=build-141\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-08T01:32:02.329+0000",
                    "updated": "2021-04-08T01:32:02.329+0000",
                    "started": "2021-04-08T01:32:02.329+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578822",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/578824",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815381533\n\n\n   Submitted nightly jobs manually: https://github.com/ursacomputing/crossbow/branches/all?query=build-187\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-08T01:32:28.275+0000",
                    "updated": "2021-04-08T01:32:28.275+0000",
                    "started": "2021-04-08T01:32:28.275+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578824",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/579118",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815709244\n\n\n   I need to adjust the comment bot which I'm testing on my fork.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-08T11:54:01.877+0000",
                    "updated": "2021-04-08T11:54:01.877+0000",
                    "started": "2021-04-08T11:54:01.877+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "579118",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/579287",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#issuecomment-815899103\n\n\n   The comment bot works as expected https://github.com/kszucs/arrow/pull/18#issuecomment-815856248\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-08T15:05:18.087+0000",
                    "updated": "2021-04-08T15:05:18.087+0000",
                    "started": "2021-04-08T15:05:18.087+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "579287",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/580375",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs closed pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-09T22:13:15.554+0000",
                    "updated": "2021-04-09T22:13:15.554+0000",
                    "started": "2021-04-09T22:13:15.554+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580375",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/580498",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on a change in pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#discussion_r611002474\n\n\n\n##########\nFile path: dev/archery/archery/bot.py\n##########\n@@ -248,81 +167,94 @@ def actions(ctx):\n               help='Crossbow repository on github to use')\n @click.pass_obj\n def crossbow(obj, crossbow):\n-    \"\"\"Trigger crossbow builds for this pull request\"\"\"\n+    \"\"\"\n+    Trigger crossbow builds for this pull request\n+    \"\"\"\n     obj['crossbow_repo'] = crossbow\n \n \n+def _clone_arrow_and_crossbow(dest, crossbow_repo, pull_request):\n+    \"\"\"\n+    Clone the repositories and initialize crossbow objects.\n+\n+    Parameters\n+    ----------\n+    dest : Path\n+        Filesystem path to clone the repositories to.\n+    crossbow_repo : str\n+        Github repository name, like kszucs/crossbow.\n+    pull_request : pygithub.PullRequest\n+        Object containing information about the pull request the comment bot\n+        was triggered from.\n+    \"\"\"\n+    arrow_path = dest / 'arrow'\n+    queue_path = dest / 'crossbow'\n+\n+    # clone arrow and checkout the pull request's branch\n+    pull_request_ref = 'pull/{}/head:{}'.format(\n+        pull_request.number, pull_request.head.ref\n+    )\n+    git.clone(pull_request.base.repo.clone_url, str(arrow_path))\n+    git.fetch('origin', pull_request_ref, git_dir=arrow_path)\n+    git.checkout(pull_request.head.ref, git_dir=arrow_path)\n+\n+    # clone crossbow repository\n+    crossbow_url = 'https://github.com/{}'.format(crossbow_repo)\n+    git.clone(crossbow_url, str(queue_path))\n+\n+    # initialize crossbow objects\n+    github_token = os.environ['CROSSBOW_GITHUB_TOKEN']\n+    arrow = Repo(arrow_path)\n+    queue = Queue(queue_path, github_token=github_token, require_https=True)\n+\n+    return (arrow, queue)\n+\n+\n @crossbow.command()\n @click.argument('tasks', nargs=-1, required=False)\n @click.option('--group', '-g', 'groups', multiple=True,\n               help='Submit task groups as defined in tests.yml')\n @click.option('--param', '-p', 'params', multiple=True,\n               help='Additional task parameters for rendering the CI templates')\n-@click.option('--dry-run/--push', default=False,\n-              help='Just display the new changelog, don\\'t write it')\n+@click.option('--arrow-version', '-v', default=None,\n+              help='Set target version explicitly.')\n @click.pass_obj\n-def submit(obj, tasks, groups, params, dry_run):\n-    \"\"\"Submit crossbow testing tasks.\n+def submit(obj, tasks, groups, params, arrow_version):\n+    \"\"\"\n+    Submit crossbow testing tasks.\n \n     See groups defined in arrow/dev/tasks/tests.yml\n     \"\"\"\n-    from ruamel.yaml import YAML\n-\n-    git = Git()\n-\n-    # construct crossbow arguments\n-    args = []\n-    if dry_run:\n-        args.append('--dry-run')\n-\n-    for p in params:\n-        args.extend(['-p', p])\n-    for g in groups:\n-        args.extend(['-g', g])\n-    for t in tasks:\n-        args.append(t)\n-\n-    # pygithub pull request object\n-    pr = obj['pull']\n-    crossbow_url = 'https://github.com/{}'.format(obj['crossbow_repo'])\n-\n+    crossbow_repo = obj['crossbow_repo']\n+    pull_request = obj['pull_request']\n     with tempfile.TemporaryDirectory() as tmpdir:\n         tmpdir = Path(tmpdir)\n-        arrow = tmpdir / 'arrow'\n-        queue = tmpdir / 'crossbow'\n-\n-        # clone arrow and checkout the pull request's branch\n-        git.clone(pr.base.repo.clone_url, str(arrow))\n-        git.fetch('origin', 'pull/{}/head:{}'.format(pr.number, pr.head.ref),\n-                  git_dir=str(arrow))\n-        git.checkout(pr.head.ref, git_dir=str(arrow))\n-\n-        # clone crossbow\n-        git.clone(crossbow_url, str(queue))\n-\n-        # submit the crossbow tasks\n-        result = Path('result.yml').resolve()\n-        xbow = Crossbow(str(arrow / 'dev' / 'tasks' / 'crossbow.py'))\n-        xbow.run(\n-            '--queue-path', str(queue),\n-            '--output-file', str(result),\n-            'submit',\n-            '--job-prefix', 'actions',\n-            # don't rely on crossbow's remote and branch detection, because\n-            # it doesn't work without a tracking upstream branch\n-            '--arrow-remote', pr.head.repo.clone_url,\n-            '--arrow-branch', pr.head.ref,\n-            *args\n+        arrow, queue = _clone_arrow_and_crossbow(\n+            dest=Path(tmpdir),\n+            crossbow_repo=crossbow_repo,\n+            pull_request=pull_request,\n         )\n+        # load available tasks configuration and groups from yaml\n+        config = Config.load_yaml(arrow.path / \"dev\" / \"tasks\" / \"tasks.yml\")\n+        config.validate()\n+\n+        # initialize the crossbow build's target repository\n+        target = Target.from_repo(arrow, version=arrow_version,\n+                                  remote=pull_request.base.repo.clone_url)\n\nReview comment:\n       It seems that `pull_request.base` always refers `apache/arrow` not `${USER}/arrow`: https://github.com/apache/arrow/pull/9977#issuecomment-817082661\r\n   Should w use `pull_request.head` here?\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-10T06:01:12.165+0000",
                    "updated": "2021-04-10T06:01:12.165+0000",
                    "started": "2021-04-10T06:01:12.164+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580498",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/580500",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on a change in pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#discussion_r611002565\n\n\n\n##########\nFile path: dev/archery/archery/bot.py\n##########\n@@ -248,81 +167,94 @@ def actions(ctx):\n               help='Crossbow repository on github to use')\n @click.pass_obj\n def crossbow(obj, crossbow):\n-    \"\"\"Trigger crossbow builds for this pull request\"\"\"\n+    \"\"\"\n+    Trigger crossbow builds for this pull request\n+    \"\"\"\n     obj['crossbow_repo'] = crossbow\n \n \n+def _clone_arrow_and_crossbow(dest, crossbow_repo, pull_request):\n+    \"\"\"\n+    Clone the repositories and initialize crossbow objects.\n+\n+    Parameters\n+    ----------\n+    dest : Path\n+        Filesystem path to clone the repositories to.\n+    crossbow_repo : str\n+        Github repository name, like kszucs/crossbow.\n+    pull_request : pygithub.PullRequest\n+        Object containing information about the pull request the comment bot\n+        was triggered from.\n+    \"\"\"\n+    arrow_path = dest / 'arrow'\n+    queue_path = dest / 'crossbow'\n+\n+    # clone arrow and checkout the pull request's branch\n+    pull_request_ref = 'pull/{}/head:{}'.format(\n+        pull_request.number, pull_request.head.ref\n+    )\n+    git.clone(pull_request.base.repo.clone_url, str(arrow_path))\n+    git.fetch('origin', pull_request_ref, git_dir=arrow_path)\n+    git.checkout(pull_request.head.ref, git_dir=arrow_path)\n+\n+    # clone crossbow repository\n+    crossbow_url = 'https://github.com/{}'.format(crossbow_repo)\n+    git.clone(crossbow_url, str(queue_path))\n+\n+    # initialize crossbow objects\n+    github_token = os.environ['CROSSBOW_GITHUB_TOKEN']\n+    arrow = Repo(arrow_path)\n+    queue = Queue(queue_path, github_token=github_token, require_https=True)\n+\n+    return (arrow, queue)\n+\n+\n @crossbow.command()\n @click.argument('tasks', nargs=-1, required=False)\n @click.option('--group', '-g', 'groups', multiple=True,\n               help='Submit task groups as defined in tests.yml')\n @click.option('--param', '-p', 'params', multiple=True,\n               help='Additional task parameters for rendering the CI templates')\n-@click.option('--dry-run/--push', default=False,\n-              help='Just display the new changelog, don\\'t write it')\n+@click.option('--arrow-version', '-v', default=None,\n+              help='Set target version explicitly.')\n @click.pass_obj\n-def submit(obj, tasks, groups, params, dry_run):\n-    \"\"\"Submit crossbow testing tasks.\n+def submit(obj, tasks, groups, params, arrow_version):\n+    \"\"\"\n+    Submit crossbow testing tasks.\n \n     See groups defined in arrow/dev/tasks/tests.yml\n     \"\"\"\n-    from ruamel.yaml import YAML\n-\n-    git = Git()\n-\n-    # construct crossbow arguments\n-    args = []\n-    if dry_run:\n-        args.append('--dry-run')\n-\n-    for p in params:\n-        args.extend(['-p', p])\n-    for g in groups:\n-        args.extend(['-g', g])\n-    for t in tasks:\n-        args.append(t)\n-\n-    # pygithub pull request object\n-    pr = obj['pull']\n-    crossbow_url = 'https://github.com/{}'.format(obj['crossbow_repo'])\n-\n+    crossbow_repo = obj['crossbow_repo']\n+    pull_request = obj['pull_request']\n     with tempfile.TemporaryDirectory() as tmpdir:\n         tmpdir = Path(tmpdir)\n-        arrow = tmpdir / 'arrow'\n-        queue = tmpdir / 'crossbow'\n-\n-        # clone arrow and checkout the pull request's branch\n-        git.clone(pr.base.repo.clone_url, str(arrow))\n-        git.fetch('origin', 'pull/{}/head:{}'.format(pr.number, pr.head.ref),\n-                  git_dir=str(arrow))\n-        git.checkout(pr.head.ref, git_dir=str(arrow))\n-\n-        # clone crossbow\n-        git.clone(crossbow_url, str(queue))\n-\n-        # submit the crossbow tasks\n-        result = Path('result.yml').resolve()\n-        xbow = Crossbow(str(arrow / 'dev' / 'tasks' / 'crossbow.py'))\n-        xbow.run(\n-            '--queue-path', str(queue),\n-            '--output-file', str(result),\n-            'submit',\n-            '--job-prefix', 'actions',\n-            # don't rely on crossbow's remote and branch detection, because\n-            # it doesn't work without a tracking upstream branch\n-            '--arrow-remote', pr.head.repo.clone_url,\n-            '--arrow-branch', pr.head.ref,\n-            *args\n+        arrow, queue = _clone_arrow_and_crossbow(\n+            dest=Path(tmpdir),\n+            crossbow_repo=crossbow_repo,\n+            pull_request=pull_request,\n         )\n+        # load available tasks configuration and groups from yaml\n+        config = Config.load_yaml(arrow.path / \"dev\" / \"tasks\" / \"tasks.yml\")\n+        config.validate()\n+\n+        # initialize the crossbow build's target repository\n+        target = Target.from_repo(arrow, version=arrow_version,\n+                                  remote=pull_request.base.repo.clone_url)\n\nReview comment:\n       @kszucs \u2191\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-10T06:02:46.970+0000",
                    "updated": "2021-04-10T06:02:46.970+0000",
                    "started": "2021-04-10T06:02:46.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580500",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/580525",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on a change in pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#discussion_r611015829\n\n\n\n##########\nFile path: dev/archery/archery/bot.py\n##########\n@@ -248,81 +167,94 @@ def actions(ctx):\n               help='Crossbow repository on github to use')\n @click.pass_obj\n def crossbow(obj, crossbow):\n-    \"\"\"Trigger crossbow builds for this pull request\"\"\"\n+    \"\"\"\n+    Trigger crossbow builds for this pull request\n+    \"\"\"\n     obj['crossbow_repo'] = crossbow\n \n \n+def _clone_arrow_and_crossbow(dest, crossbow_repo, pull_request):\n+    \"\"\"\n+    Clone the repositories and initialize crossbow objects.\n+\n+    Parameters\n+    ----------\n+    dest : Path\n+        Filesystem path to clone the repositories to.\n+    crossbow_repo : str\n+        Github repository name, like kszucs/crossbow.\n+    pull_request : pygithub.PullRequest\n+        Object containing information about the pull request the comment bot\n+        was triggered from.\n+    \"\"\"\n+    arrow_path = dest / 'arrow'\n+    queue_path = dest / 'crossbow'\n+\n+    # clone arrow and checkout the pull request's branch\n+    pull_request_ref = 'pull/{}/head:{}'.format(\n+        pull_request.number, pull_request.head.ref\n+    )\n+    git.clone(pull_request.base.repo.clone_url, str(arrow_path))\n+    git.fetch('origin', pull_request_ref, git_dir=arrow_path)\n+    git.checkout(pull_request.head.ref, git_dir=arrow_path)\n+\n+    # clone crossbow repository\n+    crossbow_url = 'https://github.com/{}'.format(crossbow_repo)\n+    git.clone(crossbow_url, str(queue_path))\n+\n+    # initialize crossbow objects\n+    github_token = os.environ['CROSSBOW_GITHUB_TOKEN']\n+    arrow = Repo(arrow_path)\n+    queue = Queue(queue_path, github_token=github_token, require_https=True)\n+\n+    return (arrow, queue)\n+\n+\n @crossbow.command()\n @click.argument('tasks', nargs=-1, required=False)\n @click.option('--group', '-g', 'groups', multiple=True,\n               help='Submit task groups as defined in tests.yml')\n @click.option('--param', '-p', 'params', multiple=True,\n               help='Additional task parameters for rendering the CI templates')\n-@click.option('--dry-run/--push', default=False,\n-              help='Just display the new changelog, don\\'t write it')\n+@click.option('--arrow-version', '-v', default=None,\n+              help='Set target version explicitly.')\n @click.pass_obj\n-def submit(obj, tasks, groups, params, dry_run):\n-    \"\"\"Submit crossbow testing tasks.\n+def submit(obj, tasks, groups, params, arrow_version):\n+    \"\"\"\n+    Submit crossbow testing tasks.\n \n     See groups defined in arrow/dev/tasks/tests.yml\n     \"\"\"\n-    from ruamel.yaml import YAML\n-\n-    git = Git()\n-\n-    # construct crossbow arguments\n-    args = []\n-    if dry_run:\n-        args.append('--dry-run')\n-\n-    for p in params:\n-        args.extend(['-p', p])\n-    for g in groups:\n-        args.extend(['-g', g])\n-    for t in tasks:\n-        args.append(t)\n-\n-    # pygithub pull request object\n-    pr = obj['pull']\n-    crossbow_url = 'https://github.com/{}'.format(obj['crossbow_repo'])\n-\n+    crossbow_repo = obj['crossbow_repo']\n+    pull_request = obj['pull_request']\n     with tempfile.TemporaryDirectory() as tmpdir:\n         tmpdir = Path(tmpdir)\n-        arrow = tmpdir / 'arrow'\n-        queue = tmpdir / 'crossbow'\n-\n-        # clone arrow and checkout the pull request's branch\n-        git.clone(pr.base.repo.clone_url, str(arrow))\n-        git.fetch('origin', 'pull/{}/head:{}'.format(pr.number, pr.head.ref),\n-                  git_dir=str(arrow))\n-        git.checkout(pr.head.ref, git_dir=str(arrow))\n-\n-        # clone crossbow\n-        git.clone(crossbow_url, str(queue))\n-\n-        # submit the crossbow tasks\n-        result = Path('result.yml').resolve()\n-        xbow = Crossbow(str(arrow / 'dev' / 'tasks' / 'crossbow.py'))\n-        xbow.run(\n-            '--queue-path', str(queue),\n-            '--output-file', str(result),\n-            'submit',\n-            '--job-prefix', 'actions',\n-            # don't rely on crossbow's remote and branch detection, because\n-            # it doesn't work without a tracking upstream branch\n-            '--arrow-remote', pr.head.repo.clone_url,\n-            '--arrow-branch', pr.head.ref,\n-            *args\n+        arrow, queue = _clone_arrow_and_crossbow(\n+            dest=Path(tmpdir),\n+            crossbow_repo=crossbow_repo,\n+            pull_request=pull_request,\n         )\n+        # load available tasks configuration and groups from yaml\n+        config = Config.load_yaml(arrow.path / \"dev\" / \"tasks\" / \"tasks.yml\")\n+        config.validate()\n+\n+        # initialize the crossbow build's target repository\n+        target = Target.from_repo(arrow, version=arrow_version,\n+                                  remote=pull_request.base.repo.clone_url)\n\nReview comment:\n       We should, sorry about that! The fix is at https://github.com/apache/arrow/pull/9978\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-10T08:25:01.739+0000",
                    "updated": "2021-04-10T08:25:01.739+0000",
                    "started": "2021-04-10T08:25:01.739+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580525",
                    "issueId": "13370150"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/worklog/580610",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on a change in pull request #9913:\nURL: https://github.com/apache/arrow/pull/9913#discussion_r611090156\n\n\n\n##########\nFile path: dev/archery/archery/bot.py\n##########\n@@ -248,81 +167,94 @@ def actions(ctx):\n               help='Crossbow repository on github to use')\n @click.pass_obj\n def crossbow(obj, crossbow):\n-    \"\"\"Trigger crossbow builds for this pull request\"\"\"\n+    \"\"\"\n+    Trigger crossbow builds for this pull request\n+    \"\"\"\n     obj['crossbow_repo'] = crossbow\n \n \n+def _clone_arrow_and_crossbow(dest, crossbow_repo, pull_request):\n+    \"\"\"\n+    Clone the repositories and initialize crossbow objects.\n+\n+    Parameters\n+    ----------\n+    dest : Path\n+        Filesystem path to clone the repositories to.\n+    crossbow_repo : str\n+        Github repository name, like kszucs/crossbow.\n+    pull_request : pygithub.PullRequest\n+        Object containing information about the pull request the comment bot\n+        was triggered from.\n+    \"\"\"\n+    arrow_path = dest / 'arrow'\n+    queue_path = dest / 'crossbow'\n+\n+    # clone arrow and checkout the pull request's branch\n+    pull_request_ref = 'pull/{}/head:{}'.format(\n+        pull_request.number, pull_request.head.ref\n+    )\n+    git.clone(pull_request.base.repo.clone_url, str(arrow_path))\n+    git.fetch('origin', pull_request_ref, git_dir=arrow_path)\n+    git.checkout(pull_request.head.ref, git_dir=arrow_path)\n+\n+    # clone crossbow repository\n+    crossbow_url = 'https://github.com/{}'.format(crossbow_repo)\n+    git.clone(crossbow_url, str(queue_path))\n+\n+    # initialize crossbow objects\n+    github_token = os.environ['CROSSBOW_GITHUB_TOKEN']\n+    arrow = Repo(arrow_path)\n+    queue = Queue(queue_path, github_token=github_token, require_https=True)\n+\n+    return (arrow, queue)\n+\n+\n @crossbow.command()\n @click.argument('tasks', nargs=-1, required=False)\n @click.option('--group', '-g', 'groups', multiple=True,\n               help='Submit task groups as defined in tests.yml')\n @click.option('--param', '-p', 'params', multiple=True,\n               help='Additional task parameters for rendering the CI templates')\n-@click.option('--dry-run/--push', default=False,\n-              help='Just display the new changelog, don\\'t write it')\n+@click.option('--arrow-version', '-v', default=None,\n+              help='Set target version explicitly.')\n @click.pass_obj\n-def submit(obj, tasks, groups, params, dry_run):\n-    \"\"\"Submit crossbow testing tasks.\n+def submit(obj, tasks, groups, params, arrow_version):\n+    \"\"\"\n+    Submit crossbow testing tasks.\n \n     See groups defined in arrow/dev/tasks/tests.yml\n     \"\"\"\n-    from ruamel.yaml import YAML\n-\n-    git = Git()\n-\n-    # construct crossbow arguments\n-    args = []\n-    if dry_run:\n-        args.append('--dry-run')\n-\n-    for p in params:\n-        args.extend(['-p', p])\n-    for g in groups:\n-        args.extend(['-g', g])\n-    for t in tasks:\n-        args.append(t)\n-\n-    # pygithub pull request object\n-    pr = obj['pull']\n-    crossbow_url = 'https://github.com/{}'.format(obj['crossbow_repo'])\n-\n+    crossbow_repo = obj['crossbow_repo']\n+    pull_request = obj['pull_request']\n     with tempfile.TemporaryDirectory() as tmpdir:\n         tmpdir = Path(tmpdir)\n-        arrow = tmpdir / 'arrow'\n-        queue = tmpdir / 'crossbow'\n-\n-        # clone arrow and checkout the pull request's branch\n-        git.clone(pr.base.repo.clone_url, str(arrow))\n-        git.fetch('origin', 'pull/{}/head:{}'.format(pr.number, pr.head.ref),\n-                  git_dir=str(arrow))\n-        git.checkout(pr.head.ref, git_dir=str(arrow))\n-\n-        # clone crossbow\n-        git.clone(crossbow_url, str(queue))\n-\n-        # submit the crossbow tasks\n-        result = Path('result.yml').resolve()\n-        xbow = Crossbow(str(arrow / 'dev' / 'tasks' / 'crossbow.py'))\n-        xbow.run(\n-            '--queue-path', str(queue),\n-            '--output-file', str(result),\n-            'submit',\n-            '--job-prefix', 'actions',\n-            # don't rely on crossbow's remote and branch detection, because\n-            # it doesn't work without a tracking upstream branch\n-            '--arrow-remote', pr.head.repo.clone_url,\n-            '--arrow-branch', pr.head.ref,\n-            *args\n+        arrow, queue = _clone_arrow_and_crossbow(\n+            dest=Path(tmpdir),\n+            crossbow_repo=crossbow_repo,\n+            pull_request=pull_request,\n         )\n+        # load available tasks configuration and groups from yaml\n+        config = Config.load_yaml(arrow.path / \"dev\" / \"tasks\" / \"tasks.yml\")\n+        config.validate()\n+\n+        # initialize the crossbow build's target repository\n+        target = Target.from_repo(arrow, version=arrow_version,\n+                                  remote=pull_request.base.repo.clone_url)\n\nReview comment:\n       Thanks!\r\n   It works now!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-10T20:33:35.513+0000",
                    "updated": "2021-04-10T20:33:35.513+0000",
                    "started": "2021-04-10T20:33:35.513+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580610",
                    "issueId": "13370150"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 6600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@fd6fbe5[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@74f36648[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@12937489[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7d3d91b5[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76acd0c8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@496ec005[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40d0d29d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@51f1530b[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@414bf36d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@7e9a7da9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@38181cdd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@632a79de[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Apr 09 22:13:18 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-04-09T22:13:18.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12263/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-04-07T16:15:14.000+0000",
        "updated": "2021-04-10T20:33:36.000+0000",
        "timeoriginalestimate": null,
        "description": "Crossbow should be part of the archery toolset enabling tighter integration and easier installation.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Dev][Packaging] Move Crossbow to Archery",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13370150/comment/17318352",
                    "id": "17318352",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "Issue resolved by pull request 9913\n[https://github.com/apache/arrow/pull/9913]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2021-04-09T22:13:18.716+0000",
                    "updated": "2021-04-09T22:13:18.716+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0pmpk:",
        "customfield_12314139": null
    }
}