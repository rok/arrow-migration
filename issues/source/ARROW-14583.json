{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13409980",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980",
    "key": "ARROW-14583",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350712",
                "id": "12350712",
                "description": "",
                "name": "6.0.1",
                "archived": false,
                "released": true,
                "releaseDate": "2021-11-18"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available",
            "query-engine"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12626049",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12626049",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13410620",
                    "key": "ARROW-14630",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410620",
                    "fields": {
                        "summary": "[C++] DCHECK in GroupByNode when error encountered",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kbzsl",
            "name": "kbzsl",
            "key": "kbzsl",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Zsolt Kegyes-Brassai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kbzsl",
            "name": "kbzsl",
            "key": "kbzsl",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Zsolt Kegyes-Brassai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 7800,
            "total": 7800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 7800,
            "total": 7800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14583/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 13,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/677049",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623\n\n\n   This fixes two issues:\r\n   - A crash in GroupByNode when no batches are processed\r\n   - A spurious error calling Take on a ChunkedArray with no chunks\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-05T14:25:59.348+0000",
                    "updated": "2021-11-05T14:25:59.348+0000",
                    "started": "2021-11-05T14:25:59.348+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "677049",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/677050",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-961938934\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-05T14:26:29.570+0000",
                    "updated": "2021-11-05T14:26:29.570+0000",
                    "started": "2021-11-05T14:26:29.569+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "677050",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/677540",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-05T20:07:05.368+0000",
                    "updated": "2021-11-05T20:07:05.368+0000",
                    "started": "2021-11-05T20:07:05.368+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "677540",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/677574",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-961938934\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-05T20:11:04.194+0000",
                    "updated": "2021-11-05T20:11:04.194+0000",
                    "started": "2021-11-05T20:11:04.194+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "677574",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678008",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#discussion_r744060205\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/vector_selection.cc\n##########\n@@ -2013,8 +2013,13 @@ Result<std::shared_ptr<ChunkedArray>> TakeCA(const ChunkedArray& values,\n     // TODO Case 3: If indices are sorted, can slice them and call Array Take\n \n     // Case 4: Else, concatenate chunks and call Array Take\n-    ARROW_ASSIGN_OR_RAISE(current_chunk,\n-                          Concatenate(values.chunks(), ctx->memory_pool()));\n+    if (values.chunks().empty()) {\n+      ARROW_ASSIGN_OR_RAISE(current_chunk, MakeArrayOfNull(values.type(), /*length=*/0,\n+                                                           ctx->memory_pool()));\n+    } else {\n+      ARROW_ASSIGN_OR_RAISE(current_chunk,\n+                            Concatenate(values.chunks(), ctx->memory_pool()));\n+    }\n\nReview comment:\n       Do we need to apply this same fix for TakeCC below?\r\n   \r\n   Note: TakeCC might not be in the GroupByNode path so this could maybe be done as a separate JIRA.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-06T02:57:52.670+0000",
                    "updated": "2021-11-06T02:57:52.670+0000",
                    "started": "2021-11-06T02:57:52.670+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678008",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678089",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#discussion_r744128125\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/vector_selection.cc\n##########\n@@ -2013,8 +2013,13 @@ Result<std::shared_ptr<ChunkedArray>> TakeCA(const ChunkedArray& values,\n     // TODO Case 3: If indices are sorted, can slice them and call Array Take\n \n     // Case 4: Else, concatenate chunks and call Array Take\n-    ARROW_ASSIGN_OR_RAISE(current_chunk,\n-                          Concatenate(values.chunks(), ctx->memory_pool()));\n+    if (values.chunks().empty()) {\n+      ARROW_ASSIGN_OR_RAISE(current_chunk, MakeArrayOfNull(values.type(), /*length=*/0,\n+                                                           ctx->memory_pool()));\n+    } else {\n+      ARROW_ASSIGN_OR_RAISE(current_chunk,\n+                            Concatenate(values.chunks(), ctx->memory_pool()));\n+    }\n\nReview comment:\n       No, because if we're in the loop body, then we're calling Concatenate on the result of TakeCA, and TakeCA always returns one chunk. However, I've added more tests for this case.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-06T13:57:23.925+0000",
                    "updated": "2021-11-06T13:57:23.925+0000",
                    "started": "2021-11-06T13:57:23.925+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678089",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678536",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#discussion_r744815935\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate_test.cc\n##########\n@@ -692,6 +699,24 @@ TEST(GroupBy, Errors) {\n                                         batch->GetColumnByName(\"group_id\")}),\n               Raises(StatusCode::NotImplemented,\n                      HasSubstr(\"Direct execution of HASH_AGGREGATE functions\")));\n+\n+  // Regression test for ARROW-14583: handle when no batches are\n\nReview comment:\n       Since this is not testing an error condition, should you create a separate test case for this?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-08T15:11:41.626+0000",
                    "updated": "2021-11-08T15:11:41.626+0000",
                    "started": "2021-11-08T15:11:41.625+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678536",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678550",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#discussion_r744833711\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate_test.cc\n##########\n@@ -692,6 +699,24 @@ TEST(GroupBy, Errors) {\n                                         batch->GetColumnByName(\"group_id\")}),\n               Raises(StatusCode::NotImplemented,\n                      HasSubstr(\"Direct execution of HASH_AGGREGATE functions\")));\n+\n+  // Regression test for ARROW-14583: handle when no batches are\n\nReview comment:\n       Yup, I split the test case.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-08T15:27:36.027+0000",
                    "updated": "2021-11-08T15:27:36.027+0000",
                    "started": "2021-11-08T15:27:36.027+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678550",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678689",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm closed pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-08T19:33:02.653+0000",
                    "updated": "2021-11-08T19:33:02.653+0000",
                    "started": "2021-11-08T19:33:02.653+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678689",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678690",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-963503724\n\n\n   Benchmark runs are scheduled for baseline = 00c94e0fa9074defc8818aab945a1db8420aefc8 and contender = 0ed742494f11b6be8033cf65e9e48725249669b6. 0ed742494f11b6be8033cf65e9e48725249669b6 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0925c83189c542ff9b7dcd6c3200b158...19dc1c8e7b9f4c319838e0165ec583dc/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/65e5b22c0e9246e8aec613ccb245630f...2360293d709643da9ebf6a616270f5e4/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/a2c09abe93784108a316ce2e60fd75e1...ef53f6c6ac3242269273a1538360ed77/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-08T19:33:25.176+0000",
                    "updated": "2021-11-08T19:33:25.176+0000",
                    "started": "2021-11-08T19:33:25.175+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678690",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678697",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-963503724\n\n\n   Benchmark runs are scheduled for baseline = 00c94e0fa9074defc8818aab945a1db8420aefc8 and contender = 0ed742494f11b6be8033cf65e9e48725249669b6. 0ed742494f11b6be8033cf65e9e48725249669b6 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0925c83189c542ff9b7dcd6c3200b158...19dc1c8e7b9f4c319838e0165ec583dc/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/65e5b22c0e9246e8aec613ccb245630f...2360293d709643da9ebf6a616270f5e4/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/a2c09abe93784108a316ce2e60fd75e1...ef53f6c6ac3242269273a1538360ed77/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-08T19:43:27.758+0000",
                    "updated": "2021-11-08T19:43:27.758+0000",
                    "started": "2021-11-08T19:43:27.757+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678697",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678921",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-963503724\n\n\n   Benchmark runs are scheduled for baseline = 00c94e0fa9074defc8818aab945a1db8420aefc8 and contender = 0ed742494f11b6be8033cf65e9e48725249669b6. 0ed742494f11b6be8033cf65e9e48725249669b6 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0925c83189c542ff9b7dcd6c3200b158...19dc1c8e7b9f4c319838e0165ec583dc/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/65e5b22c0e9246e8aec613ccb245630f...2360293d709643da9ebf6a616270f5e4/)\n   [Finished :arrow_down:0.58% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/a2c09abe93784108a316ce2e60fd75e1...ef53f6c6ac3242269273a1538360ed77/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-09T06:39:34.230+0000",
                    "updated": "2021-11-09T06:39:34.230+0000",
                    "started": "2021-11-09T06:39:34.230+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678921",
                    "issueId": "13409980"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/worklog/678968",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11623:\nURL: https://github.com/apache/arrow/pull/11623#issuecomment-963503724\n\n\n   Benchmark runs are scheduled for baseline = 00c94e0fa9074defc8818aab945a1db8420aefc8 and contender = 0ed742494f11b6be8033cf65e9e48725249669b6. 0ed742494f11b6be8033cf65e9e48725249669b6 is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/0925c83189c542ff9b7dcd6c3200b158...19dc1c8e7b9f4c319838e0165ec583dc/)\n   [Finished :arrow_down:1.54% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/65e5b22c0e9246e8aec613ccb245630f...2360293d709643da9ebf6a616270f5e4/)\n   [Finished :arrow_down:0.58% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/a2c09abe93784108a316ce2e60fd75e1...ef53f6c6ac3242269273a1538360ed77/)\n   Supported benchmarks:\n   ursa-i9-9960x: langs = Python, R, JavaScript\n   ursa-thinkcentre-m75q: langs = C++, Java\n   ec2-t3-xlarge-us-east-2: cloud = True\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-09T10:12:23.665+0000",
                    "updated": "2021-11-09T10:12:23.665+0000",
                    "started": "2021-11-09T10:12:23.665+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "678968",
                    "issueId": "13409980"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 7800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4b7a9de6[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3459b11d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@10451336[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@69ed897a[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5db2b80f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2b5fb227[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@133bd8d9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1618259d[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5ea28591[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@83acae8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@450a2626[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1269c7d7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 7800,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Nov 08 19:33:03 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-11-08T19:33:03.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14583/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2021-11-04T07:05:29.000+0000",
        "updated": "2021-11-09T10:12:24.000+0000",
        "timeoriginalestimate": null,
        "description": "Original issue report is below; here's an even more minimal example:\r\n{code:r}\r\nlibrary(arrow)\r\nlibrary(dplyr)\r\ntd <- tempfile()\r\ndir.create(td)\r\n# if there is no partitioning in data data, this won't segfault\r\n# write_dataset(iris, td) - swap this in and won't segfault\r\nwrite_dataset(group_by(iris, Species), td)\r\nopen_dataset(td) %>%\r\n  filter(Species == \"tulip\") %>%\r\n  group_by(Sepal.Length) %>%\r\n  summarise(n = n()) %>%\r\n  collect()\r\n\r\n{code}\r\n----\r\nI was trying the new features introduced in latest {{arrow (6.0.2)}} package based on examples from the \u201cNew Directions for Apache Arrow\u201d talk.\r\n\r\nThe RStudio IDE was crashing and the R session was aborted.\r\n\r\nLooking closely I found that I downloaded only 2 years of data (2018 & 2019) and after the first filter ({{year == 2015}}) no data remains to be processed further.\r\n\r\nAfter some debugging, by replacing the collect() function, it turns out that the {{summarize()}} is the one which function is causing the crash.\r\n\r\n\u00a0\r\n{code:java}\r\nas_dataset <- open_dataset(\"c:/Rproj_learn/nyc-taxi/\", \r\n                                partitioning = c(\"year\", \"month\")) %>%\r\n  filter(total_amount > 100 & year == 2015) %>%\r\n  select(tip_amount, total_amount, passenger_count) %>%\r\n  mutate(tip_pct = tip_amount / total_amount * 100) %>%\r\n  group_by(passenger_count) %>%\r\n  summarize(avg_tip_pct = mean(tip_pct), n = n()) %>%\r\n  filter(n > 5000) %>%\r\n  arrange(desc(avg_tip_pct)) %>%\r\n  collect(){code}\r\n\u00a0\r\n\r\nI would expect to get an error message (without crashing the IDE), which can be handled in code.\r\n\r\nAnother alternative result would be an empty data.frame, like in case when the parquet file was read in as a data.frame. I simulated this situation by setting a high {{total_amount}} value when filtering. Note: when using an Arrow table an error message is generated.\r\n\r\n\u00a0\r\n{code:java}\r\n\u00a0library(tidyverse)\r\n#> Warning: package 'tibble' was built under R version 4.1.1\r\n#> Warning: package 'tidyr' was built under R version 4.1.1\r\n#> Warning: package 'readr' was built under R version 4.1.1\r\nlibrary(arrow)\r\n#> Warning: package 'arrow' was built under R version 4.1.1\r\n#> \r\n#> Attaching package: 'arrow'\r\n#> The following object is masked from 'package:utils':\r\n#> \r\n#>     timestamp\r\n\r\nread_parquet(\"c:/Rproj_learn/nyc-taxi/2018/01/data.parquet\", \r\n             as_data_frame = FALSE) %>%\r\n  # filter(total_amount > 100) %>%\r\n  filter(total_amount > 1e10) %>%\r\n  select(tip_amount, total_amount, passenger_count) %>%\r\n  mutate(tip_pct = tip_amount / total_amount * 100) %>%\r\n  group_by(passenger_count) %>%\r\n  summarize(avg_tip_pct = mean(tip_pct), n = n()) %>%\r\n  filter(n > 500) %>%\r\n  arrange(desc(avg_tip_pct)) %>%\r\n  collect()\r\n\r\n#> Error: Invalid: Must pass at least one array\r\n\r\n\r\nread_parquet(\"c:/Rproj_learn/nyc-taxi/2018/01/data.parquet\", \r\n             as_data_frame = TRUE) %>%\r\n  # filter(total_amount > 100) %>%\r\n  filter(total_amount > 1e10) %>%\r\n  select(tip_amount, total_amount, passenger_count) %>%\r\n  mutate(tip_pct = tip_amount / total_amount * 100) %>%\r\n  group_by(passenger_count) %>%\r\n  summarize(avg_tip_pct = mean(tip_pct), n = n()) %>%\r\n  filter(n > 500) %>%\r\n  arrange(desc(avg_tip_pct)) %>%\r\n  collect()\r\n\r\n#> # A tibble: 0 x 3\r\n#> # ... with 3 variables: passenger_count <int>, avg_tip_pct <dbl>, n <int>\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 7800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R][C++] Crash when summarizing after filtering to no rows on partitioned data",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "I am using a windows 10 machine, R 4.1.0, up to date R packages, and latest RStudio IDE.",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17438887",
                    "id": "17438887",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I agree that an empty table is preferable.  I believe this error is coming from the query engine itself (must pass at least one array is from arrow::Concatenate which shouldn't be called if the list is empty) but it might be happening in the conversion from C++ to R.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-11-04T18:45:36.622+0000",
                    "updated": "2021-11-04T18:45:36.622+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17439291",
                    "id": "17439291",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "The crash is because if GroupByNode gets 0 batches, it never initializes its internal state. The \"Invalid\" error is because Take() on a ChunkedArray assumes there must be 1 or more than 1 chunk, and fails to account for 0 chunks (and so as Weston guessed, is trying to concatenate 0 chunks).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-11-05T14:10:34.763+0000",
                    "updated": "2021-11-05T14:10:34.763+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17440036",
                    "id": "17440036",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "I've since been playing around in R and found that even without filtering, I get a crash when doing group_by + summarise on partitioned data, e.g. I get a segfault from the below code\r\n\r\n\u00a0\r\n{code:java}\r\nlibrary(arrow)\r\nlibrary(dplyr)\r\n\r\nwrite_dataset(group_by(iris, Species), \"iris_data\")\r\n\r\nopen_dataset(\"iris_data\") %>%\r\n\u00a0 group_by(Species) %>%\r\n\u00a0 summarise(mean(Sepal.Length)) %>%\r\n\u00a0 collect() {code}\r\nFurther experimentation and I've found that it only segfaults if you group by the same variable it's partitioned by when it's been saved - I guess it's still the 0 batches thing happening there.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2021-11-07T16:21:02.802+0000",
                    "updated": "2021-11-07T18:25:02.276+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17440119",
                    "id": "17440119",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "It appears this fails in a different place so this might be a different bug. (At least, the fix here still crashes for this example.) I'm going to investigate more tomorrow.\r\n\r\n{noformat}\r\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\r\n#1  0x00007ffff7543921 in __GI_abort () at abort.c:79\r\n#2  0x00007ffff1e61047 in google::logging_fail() ()\r\n   from /home/lidavidm/miniconda3/envs/dev/lib/libglog.so.0\r\n#3  0x00007ffff1e68c0d in google::LogMessage::Fail() ()\r\n   from /home/lidavidm/miniconda3/envs/dev/lib/libglog.so.0\r\n#4  0x00007ffff1e6b7a6 in google::LogMessage::SendToLog() ()\r\n   from /home/lidavidm/miniconda3/envs/dev/lib/libglog.so.0\r\n#5  0x00007ffff1e68705 in google::LogMessage::Flush() ()\r\n   from /home/lidavidm/miniconda3/envs/dev/lib/libglog.so.0\r\n#6  0x00007ffff1e688fd in google::LogMessage::~LogMessage() ()\r\n   from /home/lidavidm/miniconda3/envs/dev/lib/libglog.so.0\r\n#7  0x00007fff6f9c60cc in arrow::util::ArrowLog::~ArrowLog (this=0x7fff94e24028)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/logging.cc:250\r\n#8  0x00007fff6f999ab5 in arrow::ConcreteFutureImpl::DoMarkFinishedOrFailed (\r\n    this=0x55555a7d2890, state=arrow::FutureState::SUCCESS)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.cc:309\r\n#9  0x00007fff6f997e5a in arrow::ConcreteFutureImpl::DoMarkFinished (this=0x55555a7d2890)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.cc:231\r\n#10 0x00007fff6f994f5d in arrow::FutureImpl::MarkFinished (this=0x55555a7d2890)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.cc:383\r\n#11 0x00007fffd0372570 in arrow::Future<arrow::internal::Empty>::DoMarkFinished (\r\n    this=0x55555aa056e8, res=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.h:712\r\n#12 0x00007fffd0372482 in arrow::Future<arrow::internal::Empty>::MarkFinished<arrow::internal::Empty, void> (this=0x55555aa056e8, s=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.h:463\r\n#13 0x00007fff6fc8fa3d in arrow::compute::(anonymous namespace)::GroupByNode::StopProducing (this=0x55555aa05650, output=0x55555b088e40)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/aggregate_node.cc:533\r\n#14 0x00007fff6fca29f9 in arrow::compute::MapNode::StopProducing (this=0x55555b088e40)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:348\r\n#15 0x00007fff6fca28f1 in arrow::compute::MapNode::StopProducing (this=0x55555b088e40, \r\n    output=0x555555a5ff30)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:338\r\n#16 0x00007fff6fca29f9 in arrow::compute::MapNode::StopProducing (this=0x555555a5ff30)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:348\r\n#17 0x00007fff6fca28f1 in arrow::compute::MapNode::StopProducing (this=0x555555a5ff30, \r\n    output=0x55555877de40)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:338\r\n#18 0x00007fff6fd2de33 in arrow::compute::(anonymous namespace)::SinkNode::ErrorReceived\r\n    (this=0x55555877de40, input=0x555555a5ff30, error=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/sink_node.cc:117\r\n---Type <return> to continue, or q <return> to quit---\r\n#19 0x00007fff6fca2452 in arrow::compute::MapNode::ErrorReceived (this=0x555555a5ff30, \r\n    input=0x55555b088e40, error=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:319\r\n#20 0x00007fff6fca2452 in arrow::compute::MapNode::ErrorReceived (this=0x55555b088e40, \r\n    input=0x55555aa05650, error=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:319\r\n#21 0x00007fff6fca1e32 in arrow::compute::ExecNode::ErrorIfNotOk (this=0x55555aa05650, \r\n    status=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:300\r\n#22 0x00007fff6fc8f351 in arrow::compute::(anonymous namespace)::GroupByNode::InputReceived (this=0x55555aa05650, input=0x55555bde3440, batch=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/aggregate_node.cc:492\r\n#23 0x00007fff6fca32ce in arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_1::operator()() const (this=0x7fff2c004028)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:368\r\n#24 0x00007fff6fca655f in arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1}::operator()() const (this=0x7fff2c004020)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:375\r\n#25 0x00007fff6fca64f0 in arrow::detail::ContinueFuture::operator()<arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1}&, , arrow::Status, arrow::Future<arrow::internal::Empty> > (this=0x7fff2c004018, next=..., f=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/future.h:148\r\n#26 0x00007fff6fca6476 in std::__invoke_impl<void, arrow::detail::ContinueFuture&, arrow::Future<arrow::internal::Empty>&, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1}&>(std::__invoke_other, arrow::detail::ContinueFuture&, arrow::Future<arrow::internal::Empty>&, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1}&) (__f=..., __args=..., __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:60\r\n#27 0x00007fff6fca63a7 in std::__invoke<arrow::detail::ContinueFuture&, arrow::Future<arrow::internal::Empty>&, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1}&>(std::__invoke_result&&, (arrow::detail::ContinueFuture&)...) (__fn=..., __args=..., __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:95\r\n#28 0x00007fff6fca6358 in std::_Bind<arrow::detail::ContinueFuture (arrow::Future<arrow::internal::Empty>, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1})>::__call<void, , 0ul, 1ul>(std::tuple<>&&, std::_Index_tuple<0ul,---Type <return> to continue, or q <return> to quit---\r\n 1ul>) (this=0x7fff2c004018, __args=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/functional:467\r\n#29 0x00007fff6fca62e6 in std::_Bind<arrow::detail::ContinueFuture (arrow::Future<arrow::internal::Empty>, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1})>::operator()<, void>() (this=0x7fff2c004018)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/functional:549\r\n#30 0x00007fff6fca62b1 in arrow::internal::FnOnce<void ()>::FnImpl<std::_Bind<arrow::detail::ContinueFuture (arrow::Future<arrow::internal::Empty>, arrow::compute::MapNode::SubmitTask(std::function<arrow::Result<arrow::compute::ExecBatch> (arrow::compute::ExecBatch)>, arrow::compute::ExecBatch)::$_2::operator()() const::{lambda()#1})> >::invoke() (\r\n    this=0x7fff2c004010)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/functional.h:152\r\n#31 0x00007fff6f9e9b0a in arrow::internal::FnOnce<void ()>::operator()() && (\r\n    this=0x7fff94e24c90)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/functional.h:140\r\n#32 0x00007fff6f9e92d2 in arrow::internal::WorkerLoop (state=..., it=...)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/thread_pool.cc:177\r\n#33 0x00007fff6f9e8f68 in arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3::operator()() const (this=0x555557f9ae98)\r\n    at /home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/util/thread_pool.cc:344\r\n#34 0x00007fff6f9e8efd in _ZSt13__invoke_implIvZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiE3$_3JEET_St14__invoke_otherOT0_DpOT1_ (__f=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:60\r\n#35 0x00007fff6f9e8e8d in _ZSt8__invokeIZN5arrow8internal10ThreadPool21LaunchWorkersUnlockedEiE3$_3JEENSt15__invoke_resultIT_JDpT0_EE4typeEOS5_DpOS6_ (__fn=...)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/bits/invoke.h:95\r\n#36 0x00007fff6f9e8e65 in std::thread::_Invoker<std::tuple<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3> >::_M_invoke<0ul> (this=0x555557f9ae98)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:234\r\n#37 0x00007fff6f9e8e35 in std::thread::_Invoker<std::tuple<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3> >::operator()() (this=0x555557f9ae98)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:243\r\n#38 0x00007fff6f9e8cd9 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<arrow::internal::ThreadPool::LaunchWorkersUnlocked(int)::$_3> > >::_M_run() (\r\n    this=0x555557f9ae90)\r\n    at /usr/lib/gcc/x86_64-linux-gnu/7.5.0/../../../../include/c++/7.5.0/thread:186\r\n#39 0x00007ffff276d9b0 in std::execute_native_thread_routine (__p=<optimized out>)\r\n    at /home/conda/feedstock_root/build_artifacts/gcc_compilers_1628138005912/work/build/x86_64-conda-linux-gnu/libstdc++-v3/include/bits/new_allocator.h:82\r\n#40 0x00007ffff4f1d6db in start_thread (arg=0x7fff94e34700) at pthread_create.c:463\r\n#41 0x00007ffff762471f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n{noformat}\r\n\r\nIt also doesn't fail consistently for me, it sometimes instead gives this error so I think there's at least two bugs wrapped up here:\r\n\r\n{noformat}\r\nError: Invalid: Arrays used to construct an ExecBatch must have equal length\r\n/home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/aggregate_node.cc:387  ExecBatch::Make({batch.values[agg_src_field_ids_[i]], id_batch})\r\n/home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/compute/exec/exec_plan.cc:417  iterator_.Next()\r\n/home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/record_batch.cc:318  ReadNext(&batch)\r\n/home/lidavidm/Code/upstream/arrow-14583/cpp/src/arrow/record_batch.cc:329  ReadAll(&batches)\r\n{noformat}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-11-07T22:50:56.644+0000",
                    "updated": "2021-11-07T22:51:14.315+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17440457",
                    "id": "17440457",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I've filed a bug for the new reproduction as ARROW-14630.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-11-08T13:34:37.676+0000",
                    "updated": "2021-11-08T13:34:37.676+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13409980/comment/17440707",
                    "id": "17440707",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 11623\n[https://github.com/apache/arrow/pull/11623]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-11-08T19:33:03.977+0000",
                    "updated": "2021-11-08T19:33:03.977+0000"
                }
            ],
            "maxResults": 6,
            "total": 6,
            "startAt": 0
        },
        "customfield_12311820": "0|z0wfj4:",
        "customfield_12314139": null
    }
}