{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13382960",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960",
    "key": "ARROW-13022",
    "fields": {
        "parent": {
            "id": "13413587",
            "key": "ARROW-14806",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13413587",
            "fields": {
                "summary": "[R] Implement bindings for lubridate component extraction functions",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                    "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                    "name": "Resolved",
                    "id": "5",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                    "id": "2",
                    "description": "A new feature of the product, which has yet to be developed.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                    "name": "New Feature",
                    "subtask": false,
                    "avatarId": 21141
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12617244",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12617244",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13383408",
                    "key": "ARROW-13054",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13383408",
                    "fields": {
                        "summary": "[C++] Add option to specify the first day of the week for the \"day_of_week\" temporal kernel",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            },
            {
                "id": "12617056",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12617056",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "outwardIssue": {
                    "id": "13360576",
                    "key": "ARROW-11759",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360576",
                    "fields": {
                        "summary": "[C++] Kernel to extract datetime components (year, month, day, etc) from timestamp type",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 22200,
            "total": 22200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 22200,
            "total": 22200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13022/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 37,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/609912",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic opened a new pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-10T20:18:46.339+0000",
                    "updated": "2021-06-10T20:18:46.339+0000",
                    "started": "2021-06-10T20:18:46.338+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "609912",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/609913",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#issuecomment-859018584\n\n\n   https://issues.apache.org/jira/browse/ARROW-13022\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-10T20:19:00.054+0000",
                    "updated": "2021-06-10T20:19:00.054+0000",
                    "started": "2021-06-10T20:19:00.053+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "609913",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610082",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r650076060\n\n\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       IDK that we should truncate the data like this. A slight (technical) API difference is probably better than throwing away precision.\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,119 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- ymd_hms(\"1987-10-09 23:00:00\", tz = NULL)\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"extract datetime components from date\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = isoyear(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = quarter(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = month(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date, week_start = 3)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, label = TRUE)) %>%\n+      collect(),\n+    regexp = \"Label argument not supported by Arrow; pulling data into R\"\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, locale = Sys.getlocale(\"LC_TIME\"))) %>%\n+      collect(),\n+    regexp = 'Expression wday(date, locale = Sys.getlocale(\"LC_TIME\")) not supported in Arrow; pulling data into R',\n+    fixed = TRUE\n+  )\n\nReview comment:\n       Yeah I think we can do this more unit-testy version where appropriate; we test elsewhere that the errors we throw in the nse_funcs get handled by filter/mutate correctly.\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       What is the label argument? Is it something we should support? I think it's good to document these unsupported exceptions in comments, to note either why Arrow should behave differently, or what Jira issue exists to remove the exception.\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       Please leave a comment with that JIRA issue somewhere in this code that we expect to remove.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T07:15:26.307+0000",
                    "updated": "2021-06-14T07:15:26.307+0000",
                    "started": "2021-06-14T07:15:26.307+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610082",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610111",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r649723619\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       I was going to mention that we actually also have an \"ISO weekday\" in the C++ kernels, but only as field in the `iso_calendar` kernel, and not as separate one. We could also add `iso_day_of_week` if that helps, or even just make `day_of_week` follow the ISO conventions. Because the 0 (monday) - 6 (sunday) might be something Python specific.\r\n   \r\n   But then looked at what C++ does, and there the default is actually 0 (sunday) - 6 (saturday), so yet something else ;) (although I see that also Postgres uses that for `dow`)\r\n   \r\n   In the end, once you have it in one form, it's an easy conversion to any of the other of course, so it might not matter that much.\r\n   \r\n   \n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n\nReview comment:\n       \"hour\" is missing here?\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       Note that second might do something different. I think \"second\" in lubridate is the equivalent of \"second + subsecond\" in arrow\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       What do you mean exactly with rounding? A quick try gives me:\r\n   \r\n   ```\r\n   > second(ymd_hms(\"2011-06-04 12:00:01.123456\"))\r\n   [1] 1.123456\r\n   ```\r\n   \r\n   which seems to give all decimals\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       I don't think lubridate / R supports nanosecond resolution\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T07:18:24.928+0000",
                    "updated": "2021-06-14T07:18:24.928+0000",
                    "started": "2021-06-14T07:18:24.928+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610111",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610339",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r649907028\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       That probably makes more sense than my workaround here actually.\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       Good catch.  Hmm, I think this might be more complicated than that actually, as lubridate rounds it to 1 decimal place, using R's odd-even rounding whereas Arrow doesn't do the rounding, so I'm not sure if this can be done without rounding being implemented (see https://issues.apache.org/jira/browse/ARROW-12744)\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n\nReview comment:\n       Oops, will add in now.\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       OK, will do, and will open a JIRA, thanks!\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-13054\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       So it does; I think I must have been getting mixed up with something I'd changed when I needed to update a test I wrote, never mind,\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,119 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- ymd_hms(\"1987-10-09 23:00:00\", tz = NULL)\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"extract datetime components from date\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = isoyear(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = quarter(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = month(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date, week_start = 3)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, label = TRUE)) %>%\n+      collect(),\n+    regexp = \"Label argument not supported by Arrow; pulling data into R\"\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, locale = Sys.getlocale(\"LC_TIME\"))) %>%\n+      collect(),\n+    regexp = 'Expression wday(date, locale = Sys.getlocale(\"LC_TIME\")) not supported in Arrow; pulling data into R',\n+    fixed = TRUE\n+  )\n\nReview comment:\n       Good point, I think I was just copying and pasting from the older way of doing things.  Whether it matters or not to @nealrichardson, I think that way is a lot clearer so I'll update them!\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       The label argument is whether the day is displayed as a character string or a number.  Maybe it is something we should support; shall I open a ticket?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T07:40:37.456+0000",
                    "updated": "2021-06-14T07:40:37.456+0000",
                    "started": "2021-06-14T07:40:37.456+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610339",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610346",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r650057966\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,119 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- ymd_hms(\"1987-10-09 23:00:00\", tz = NULL)\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"extract datetime components from date\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = isoyear(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = quarter(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = month(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(x = wday(date, week_start = 3)) %>%\n+      collect(),\n+    test_df\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, label = TRUE)) %>%\n+      collect(),\n+    regexp = \"Label argument not supported by Arrow; pulling data into R\"\n+  )\n+  \n+  expect_warning(\n+    test_df %>%\n+      Table$create() %>%\n+      mutate(x = wday(date, locale = Sys.getlocale(\"LC_TIME\"))) %>%\n+      collect(),\n+    regexp = 'Expression wday(date, locale = Sys.getlocale(\"LC_TIME\")) not supported in Arrow; pulling data into R',\n+    fixed = TRUE\n+  )\n\nReview comment:\n       For cases in which an error is thrown and then converted to a warning, I think we prefer to write the tests like this:\r\n   ```r\r\n   x <- Expression$field_ref(\"x\")\r\n   expect_error(\r\n     nse_funcs$wday(x, label = TRUE),\r\n     \"Label argument not supported by Arrow\"\r\n   )\r\n   ```\r\n   I'm not sure how important this is. @nealrichardson does it matter to you?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T07:41:25.282+0000",
                    "updated": "2021-06-14T07:41:25.282+0000",
                    "started": "2021-06-14T07:41:25.281+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610346",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610355",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r649895508\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       We could add options to the C++ kernel to enable different behaviors there.\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n+  }\n+  offset <- get_date_offset(week_start)\n+  Expression$create(\"add\", Expression$create(\"day_of_week\", x), Expression$scalar(offset))\n+}\n+\n+#' Get date offset\n+#' \n+#' Arrow's `day_of_week` kernel counts from 0 (Monday) to 6 (Sunday), whereas\n+#' `lubridate::wday` counts from 1 to 7, and allows users to specify which day\n+#' of the week is first (Sunday by default).  This function converts the returned\n\nReview comment:\n       If we go that way it would probably be best to have another Jira for \"TemporalOptions\". It's probably best you proceed with the workaround and we loop back to this later.\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       What about nanoseconds?\r\n   ```R\r\n   > second(ymd_hms(\"2011-06-04 12:00:01.123456789\"))\r\n   [1] 1.123457\r\n   ```\r\n   \r\n   Arrow would probably return `1.123456789`.\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       I think so too. So probably it should be \"`second = second + round(subsecond, 6)`\" to match that behaviour?\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       I think so too. So probably it should be \"`second = second + round(subsecond, 6)`\" to match that behavior?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T07:42:45.495+0000",
                    "updated": "2021-06-14T07:42:45.495+0000",
                    "started": "2021-06-14T07:42:45.495+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610355",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/610585",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r650738642\n\n\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -28,8 +28,17 @@\n   # stringr spellings of those\n   \"str_length\" = \"utf8_length\",\n   \"str_to_lower\" = \"utf8_lower\",\n-  \"str_to_upper\" = \"utf8_upper\"\n+  \"str_to_upper\" = \"utf8_upper\",\n   # str_trim is defined in dplyr.R\n+  \"year\" = \"year\",\n+  \"isoyear\" = \"iso_year\",\n+  \"quarter\" = \"quarter\",\n+  \"month\" = \"month\",\n+  \"day\" = \"day\",\n+  \"yday\" = \"day_of_year\",\n+  \"isoweek\" = \"iso_week\",\n+  \"minute\" = \"minute\",\n+  \"second\" = \"second\"\n\nReview comment:\n       Agreed, I would also say that it's not because lubridate does not support nanoseconds that *if* you actually have nanoseconds (which is possible since arrow supports it) those should be discarded. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-14T08:20:29.748+0000",
                    "updated": "2021-06-14T08:20:29.748+0000",
                    "started": "2021-06-14T08:20:29.748+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "610585",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612513",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655221384\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       The label argument allows the return of the day of the week in the correct language.\r\n   \r\n   In `lubridate`, there's a whole lot of work around defining the locale and then setting the weekday names appropriately, though essentially, it just uses the format function to extract the relevant date.\r\n   \t\r\n   I think that we wouldn't want to implement this at the C++ level as it doesn't feel like it fits there as it's doing quite a lot more work than calculating a value, (i.e. returning locale-specific dates), and we could still achieve this with good performance at the R level by implementing this functionality using the ifelse kernel once its R bindings are implemented.\r\n   \r\n   How about if I leave it as unsupported now, but create a ticket to implement it later, that lists the ifelse R binding as a dependency?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-21T09:32:06.541+0000",
                    "updated": "2021-06-21T09:32:06.541+0000",
                    "started": "2021-06-21T09:32:06.540+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612513",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612529",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655248209\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       We could do such things in C++ as the library we use supports locale-aware [strftime](https://strftime.org/) (See [slide 26](http://schd.ws/hosted_files/cppcon2016/0f/Welcome%20To%20The%20Time%20Zone%20-%20Howard%20Hinnant%20-%20CppCon%202016.pdf). I expect we'll need it other places later too.\r\n   \r\n   Please make a Jira and indicate we need to discuss if this goes into R or C++.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-21T10:10:46.466+0000",
                    "updated": "2021-06-21T10:10:46.466+0000",
                    "started": "2021-06-21T10:10:46.466+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612529",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612533",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655256202\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       Thanks, will do!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-21T10:22:59.061+0000",
                    "updated": "2021-06-21T10:22:59.061+0000",
                    "started": "2021-06-21T10:22:59.061+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612533",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612536",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655259199\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-13133\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-21T10:27:34.028+0000",
                    "updated": "2021-06-21T10:27:34.028+0000",
                    "started": "2021-06-21T10:27:34.027+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612536",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612940",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655844136\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+tz_aware_date <- ymd_hms(\"2017-01-01 00:00:12.3456789\")\n+tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n\nReview comment:\n       I added in the above test to demonstrate the current/expected behaviour, but I'm not totally happy with this.  I'm not sure what makes sense to do here.\r\n   \r\n   I need to properly catch up on the mailing list discussion on timezone aware timestamps to work out the likely possibilities and solutions, so will come back to this, but not happy with it as-is at the moment.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T03:11:38.643+0000",
                    "updated": "2021-06-22T03:11:38.643+0000",
                    "started": "2021-06-22T03:11:38.642+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612940",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612941",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655844664\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,175 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  \n+  tz_aware_date <- ymd_hms(\"2017-01-01\")\n+  tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+  \n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n+\n+test_that(\"date32 objects are not supported\",{\n+  \n+  date <- ymd(\"2017-01-01\")\n+  df <- tibble::tibble(date = date)\n+  \n+  expect_error(\n+    Table$create(df) %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    \"Function year has no kernel matching input types\"\n+  )\n+})\n+\n\nReview comment:\n       Will open a JIRA to implement for these object types.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T03:13:18.342+0000",
                    "updated": "2021-06-22T03:13:18.342+0000",
                    "started": "2021-06-22T03:13:18.342+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612941",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612944",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655848010\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+tz_aware_date <- ymd_hms(\"2017-01-01 00:00:12.3456789\")\n+tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n\nReview comment:\n       Not entirely sure, but I think when this is merged, it will allow the above issue to be resolved: https://issues.apache.org/jira/browse/ARROW-12980\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T03:24:40.030+0000",
                    "updated": "2021-06-22T03:24:40.030+0000",
                    "started": "2021-06-22T03:24:40.030+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612944",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/612945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655848143\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,175 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  \n+  tz_aware_date <- ymd_hms(\"2017-01-01\")\n+  tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+  \n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n+\n+test_that(\"date32 objects are not supported\",{\n+  \n+  date <- ymd(\"2017-01-01\")\n+  df <- tibble::tibble(date = date)\n+  \n+  expect_error(\n+    Table$create(df) %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    \"Function year has no kernel matching input types\"\n+  )\n+})\n+\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-13138\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T03:25:05.506+0000",
                    "updated": "2021-06-22T03:25:05.506+0000",
                    "started": "2021-06-22T03:25:05.506+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "612945",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/613052",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rok commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655248209\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       We could do such things in C++ as the library we use supports locale-aware [strftime](https://strftime.org/) (See [slide 26](http://schd.ws/hosted_files/cppcon2016/0f/Welcome%20To%20The%20Time%20Zone%20-%20Howard%20Hinnant%20-%20CppCon%202016.pdf). I expect we'll need it other places later too.\r\n   \r\n   Please make a Jira and indicate we need to discuss if this goes into R or C++.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T07:42:26.197+0000",
                    "updated": "2021-06-22T07:42:26.197+0000",
                    "started": "2021-06-22T07:42:26.197+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "613052",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/613056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655221384\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       The label argument allows the return of the day of the week in the correct language.\r\n   \r\n   In `lubridate`, there's a whole lot of work around defining the locale and then setting the weekday names appropriately, though essentially, it just uses the format function to extract the relevant date.\r\n   \t\r\n   I think that we wouldn't want to implement this at the C++ level as it doesn't feel like it fits there as it's doing quite a lot more work than calculating a value, (i.e. returning locale-specific dates), and we could still achieve this with good performance at the R level by implementing this functionality using the ifelse kernel once its R bindings are implemented.\r\n   \r\n   How about if I leave it as unsupported now, but create a ticket to implement it later, that lists the ifelse R binding as a dependency?\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       Thanks, will do!\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-13133\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+tz_aware_date <- ymd_hms(\"2017-01-01 00:00:12.3456789\")\n+tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n\nReview comment:\n       I added in the above test to demonstrate the current/expected behaviour, but I'm not totally happy with this.  I'm not sure what makes sense to do here.\r\n   \r\n   I need to properly catch up on the mailing list discussion on timezone aware timestamps to work out the likely possibilities and solutions, so will come back to this, but not happy with it as-is at the moment.\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,175 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  \n+  tz_aware_date <- ymd_hms(\"2017-01-01\")\n+  tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+  \n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n+\n+test_that(\"date32 objects are not supported\",{\n+  \n+  date <- ymd(\"2017-01-01\")\n+  df <- tibble::tibble(date = date)\n+  \n+  expect_error(\n+    Table$create(df) %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    \"Function year has no kernel matching input types\"\n+  )\n+})\n+\n\nReview comment:\n       Will open a JIRA to implement for these object types.\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+tz_aware_date <- ymd_hms(\"2017-01-01 00:00:12.3456789\")\n+tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n\nReview comment:\n       Not entirely sure, but I think when this is merged, it will allow the above issue to be resolved: https://issues.apache.org/jira/browse/ARROW-12980\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,175 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  \n+  tz_aware_date <- ymd_hms(\"2017-01-01\")\n+  tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+  \n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n+\n+test_that(\"date32 objects are not supported\",{\n+  \n+  date <- ymd(\"2017-01-01\")\n+  df <- tibble::tibble(date = date)\n+  \n+  expect_error(\n+    Table$create(df) %>%\n+      mutate(x = year(date)) %>%\n+      collect(),\n+    \"Function year has no kernel matching input types\"\n+  )\n+})\n+\n\nReview comment:\n       https://issues.apache.org/jira/browse/ARROW-13138\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T07:42:43.602+0000",
                    "updated": "2021-06-22T07:42:43.602+0000",
                    "started": "2021-06-22T07:42:43.601+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "613056",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/613348",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r655959918\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-lubridate.R\n##########\n@@ -0,0 +1,160 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+library(lubridate)\n+library(dplyr)\n+\n+test_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\n+test_df <- tibble::tibble(date = test_date)\n+\n+tz_aware_date <- ymd_hms(\"2017-01-01 00:00:12.3456789\")\n+tz_aware_df <- tibble::tibble(date = tz_aware_date)\n+\n+test_that(\"timezone aware timestamps are not supported\",{\n+  x <- Expression$field_ref(\"x\")\n+  expect_error(\n+    Table$create(tz_aware_df) %>%\n+      mutate(x = wday(date)) %>%\n+      collect(),\n+    \"Timezone aware timestamps not supported\"\n+  )\n+})\n\nReview comment:\n       I think this is fine for now, since we this error on purpose in the initial PR to limit scope. And this functionality will indeed be added in a next PR.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T08:19:58.782+0000",
                    "updated": "2021-06-22T08:19:58.782+0000",
                    "started": "2021-06-22T08:19:58.782+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "613348",
                    "issueId": "13382960"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/worklog/613618",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10507:\nURL: https://github.com/apache/arrow/pull/10507#discussion_r656447630\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -442,3 +442,37 @@ nse_funcs$strptime <- function(x, format = \"%Y-%m-%d %H:%M:%S\", tz = NULL, unit\n \n   Expression$create(\"strptime\", x, options = list(format = format, unit = unit))\n }\n+\n+nse_funcs$wday <- function(x, label = FALSE, abbr = TRUE, week_start = getOption(\"lubridate.week.start\", 7)) {\n+  if (label) {\n+    arrow_not_supported(\"Label argument\")\n\nReview comment:\n       Can you leave a comment explaining this and linking to the JIRA issue?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-22T17:47:15.735+0000",
                    "updated": "2021-06-22T17:47:15.735+0000",
                    "started": "2021-06-22T17:47:15.735+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "613618",
                    "issueId": "13382960"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 22200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4499a949[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@11e93b38[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@99ed40c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@51761efc[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e5db7c9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@790b4b28[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6caceb1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@672aa16a[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@547aa1b9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@770bf215[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@27640503[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@15f7c174[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 22200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 05 18:24:11 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-06-24T15:16:48.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13022/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2021-06-09T14:02:35.000+0000",
        "updated": "2021-11-24T11:56:20.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "6h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 22200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] bindings for lubridate's year, isoyear, quarter, month, day, wday, yday, isoweek, hour, minute, and second functions",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17368925",
                    "id": "17368925",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 10507\n[https://github.com/apache/arrow/pull/10507]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-06-24T15:16:48.536+0000",
                    "updated": "2021-06-24T15:16:48.536+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424542",
                    "id": "17424542",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Is it expected behavior that the lubridate functions like year() are implemented for datetimes but not dates? (or perhaps this is a windows-specific issue I'm having, though I don't think it would be related to timezones)\r\n\r\n``` r\r\nlibrary(arrow)\r\n#> \r\n#> Attaching package: 'arrow'\r\n#> The following object is masked from 'package:utils':\r\n#> \r\n#> timestamp\r\nsuppressPackageStartupMessages(library(dplyr))\r\nsuppressPackageStartupMessages(library(tibble))\r\nlibrary(lubridate, warn.conflicts = FALSE)\r\n\r\ntest_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\r\n\r\ntest_df <- tibble::tibble(\r\n datetime = c(test_date, NA),\r\n date = c(as.Date(\"2017-01-01\"), NA)\r\n)\r\n\r\nar <- Table$create(test_df)\r\n\r\nar %>%\r\n mutate(yr_dt = year(datetime)) %>%\r\n pull(yr_dt)\r\n#> [1] 2017 NA\r\nar %>%\r\n mutate(yr_d = year(date)) %>%\r\n pull(yr_d)\r\n#> Error: NotImplemented: Function year has no kernel matching input types (array[date32[day]])\r\nar %>%\r\n mutate(mo_dt = month(datetime)) %>%\r\n pull(mo_dt)\r\n#> [1] 1 NA\r\nar %>%\r\n mutate(mo_d = month(date)) %>%\r\n pull(mo_d)\r\n#> Error: NotImplemented: Function month has no kernel matching input types (array[date32[day]])\r\n```\r\n\r\n<sup>Created on 2021-10-05 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\r\n\r\n<details style=\"margin-bottom:10px;\">\r\n<summary>\r\nSession info\r\n</summary>\r\n\r\n``` r\r\nsessioninfo::session_info()\r\n#> - Session info ---------------------------------------------------------------\r\n#> setting value \r\n#> version R version 4.0.5 (2021-03-31)\r\n#> os Windows 10 x64 \r\n#> system x86_64, mingw32 \r\n#> ui RTerm \r\n#> language (EN) \r\n#> collate English_United States.1252 \r\n#> ctype English_United States.1252 \r\n#> tz America/New_York \r\n#> date 2021-10-05 \r\n#> \r\n#> - Packages -------------------------------------------------------------------\r\n#> package * version date lib source \r\n#> arrow * 5.0.0.2 2021-09-05 [1] CRAN (R 4.0.5)\r\n#> assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.0.5)\r\n#> bit 4.0.4 2020-08-04 [1] CRAN (R 4.0.5)\r\n#> bit64 4.0.5 2020-08-30 [1] CRAN (R 4.0.5)\r\n#> cli 3.0.1 2021-07-17 [1] CRAN (R 4.0.5)\r\n#> crayon 1.4.1 2021-02-08 [1] CRAN (R 4.0.5)\r\n#> DBI 1.1.1 2021-01-15 [1] CRAN (R 4.0.5)\r\n#> digest 0.6.27 2020-10-24 [1] CRAN (R 4.0.5)\r\n#> dplyr * 1.0.7 2021-06-18 [1] CRAN (R 4.0.5)\r\n#> ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.0.5)\r\n#> evaluate 0.14 2019-05-28 [1] CRAN (R 4.0.5)\r\n#> fansi 0.5.0 2021-05-25 [1] CRAN (R 4.0.5)\r\n#> fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.0.5)\r\n#> fs 1.5.0 2020-07-31 [1] CRAN (R 4.0.5)\r\n#> generics 0.1.0 2020-10-31 [1] CRAN (R 4.0.5)\r\n#> glue 1.4.2 2020-08-27 [1] CRAN (R 4.0.5)\r\n#> highr 0.9 2021-04-16 [1] CRAN (R 4.0.5)\r\n#> htmltools 0.5.2 2021-08-25 [1] CRAN (R 4.0.5)\r\n#> knitr 1.34 2021-09-09 [1] CRAN (R 4.0.5)\r\n#> lifecycle 1.0.0 2021-02-15 [1] CRAN (R 4.0.5)\r\n#> lubridate * 1.7.10 2021-02-26 [1] CRAN (R 4.0.5)\r\n#> magrittr 2.0.1 2020-11-17 [1] CRAN (R 4.0.5)\r\n#> pillar 1.6.2 2021-07-29 [1] CRAN (R 4.0.5)\r\n#> pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.0.5)\r\n#> purrr 0.3.4 2020-04-17 [1] CRAN (R 4.0.5)\r\n#> R6 2.5.1 2021-08-19 [1] CRAN (R 4.0.5)\r\n#> Rcpp 1.0.7 2021-07-07 [1] CRAN (R 4.0.5)\r\n#> reprex 2.0.1 2021-08-05 [1] CRAN (R 4.0.5)\r\n#> rlang 0.4.11 2021-04-30 [1] CRAN (R 4.0.5)\r\n#> rmarkdown 2.11 2021-09-14 [1] CRAN (R 4.0.5)\r\n#> rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.0.5)\r\n#> sessioninfo 1.1.1 2018-11-05 [1] CRAN (R 4.0.5)\r\n#> stringi 1.7.4 2021-08-25 [1] CRAN (R 4.0.5)\r\n#> stringr 1.4.0 2019-02-10 [1] CRAN (R 4.0.5)\r\n#> tibble * 3.1.4 2021-08-25 [1] CRAN (R 4.0.5)\r\n#> tidyselect 1.1.1 2021-04-30 [1] CRAN (R 4.0.5)\r\n#> utf8 1.2.2 2021-07-24 [1] CRAN (R 4.0.5)\r\n#> vctrs 0.3.8 2021-04-29 [1] CRAN (R 4.0.5)\r\n#> withr 2.4.2 2021-04-18 [1] CRAN (R 4.0.5)\r\n#> xfun 0.26 2021-09-14 [1] CRAN (R 4.0.5)\r\n#> yaml 2.2.1 2020-02-01 [1] CRAN (R 4.0.5)\r\n#> \r\n#> [1] C:/Users/jalsal02/R/win-library/4.0\r\n#> [2] C:/Program Files/R/R-4.0.5/library\r\n```\r\n\r\n</details>",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-10-05T15:51:49.723+0000",
                    "updated": "2021-10-05T15:51:49.723+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424553",
                    "id": "17424553",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "[~jalsalam] I believe we added date support after 5.0.0, can you try installing a nightly version of the R package and see if it works for you?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-05T16:11:20.966+0000",
                    "updated": "2021-10-05T16:11:20.966+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424557",
                    "id": "17424557",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "body": "I believe this was done with ARROW-13138\u00a0and would indeed not be available in 5.0.0.\r\n\r\nYour issue would not be related to timezones since date doesn't have them.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "created": "2021-10-05T16:21:33.559+0000",
                    "updated": "2021-10-05T16:22:59.755+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424564",
                    "id": "17424564",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~npr]\u00a0For me with nightly installed I am seeing the same behavior (nightly showing for me as R package version 5.0.0.2). Also tested here via call_function.\r\n\r\n\u00a0\r\n\r\n``` r\r\n# install.packages(\"arrow\", repos = \"https://arrow-r-nightly.s3.amazonaws.com\")\r\npackageVersion(\"arrow\")\r\n#> [1] '5.0.0.2'\r\n\r\nlibrary(arrow)\r\n#> \r\n#> Attaching package: 'arrow'\r\n#> The following object is masked from 'package:utils':\r\n#> \r\n#> timestamp\r\nsuppressPackageStartupMessages(library(dplyr))\r\nsuppressPackageStartupMessages(library(lubridate))\r\n\r\ntest_date <- as.POSIXct(\"2017-01-01 00:00:12.3456789\", tz = \"\")\r\n\r\ntest_df <- tibble::tibble(\r\n datetime = c(test_date, NA),\r\n date = c(as.Date(\"2017-01-01\"), NA)\r\n)\r\n\r\nar <- Table$create(test_df)\r\n\r\nar %>% mutate(yr_d = year(date))\r\n#> Error: NotImplemented: Function year has no kernel matching input types (array[date32[day]])\r\nar %>% mutate(mo_d = month(date))\r\n#> Error: NotImplemented: Function month has no kernel matching input types (array[date32[day]])\r\n\r\nar_date <- Array$create(as.Date(\"2017-01-01\"))\r\n\r\ncall_function(\"year\", ar_date)\r\n#> Error: NotImplemented: Function year has no kernel matching input types (array[date32[day]])\r\ncall_function(\"month\", ar_date)\r\n#> Error: NotImplemented: Function month has no kernel matching input types (array[date32[day]])\r\n```\r\n\r\n<sup>Created on 2021-10-05 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\r\n\r\n<details style=\"margin-bottom:10px;\">\r\n<summary>\r\nSession info\r\n</summary>\r\n\r\n``` r\r\nsessionInfo()\r\n#> R version 4.0.5 (2021-03-31)\r\n#> Platform: x86_64-w64-mingw32/x64 (64-bit)\r\n#> Running under: Windows 10 x64 (build 18363)\r\n#> \r\n#> Matrix products: default\r\n#> \r\n#> locale:\r\n#> [1] LC_COLLATE=English_United States.1252 \r\n#> [2] LC_CTYPE=English_United States.1252 \r\n#> [3] LC_MONETARY=English_United States.1252\r\n#> [4] LC_NUMERIC=C \r\n#> [5] LC_TIME=English_United States.1252 \r\n#> \r\n#> attached base packages:\r\n#> [1] stats graphics grDevices utils datasets methods base \r\n#> \r\n#> other attached packages:\r\n#> [1] lubridate_1.7.10 dplyr_1.0.7 arrow_5.0.0.2 \r\n#> \r\n#> loaded via a namespace (and not attached):\r\n#> [1] Rcpp_1.0.7 compiler_4.0.5 pillar_1.6.3 highr_0.9 \r\n#> [5] tools_4.0.5 digest_0.6.28 bit_4.0.4 evaluate_0.14 \r\n#> [9] lifecycle_1.0.1 tibble_3.1.5 pkgconfig_2.0.3 rlang_0.4.11 \r\n#> [13] reprex_2.0.1 cli_3.0.1 DBI_1.1.1 rstudioapi_0.13 \r\n#> [17] yaml_2.2.1 xfun_0.26 fastmap_1.1.0 withr_2.4.2 \r\n#> [21] stringr_1.4.0 knitr_1.36 generics_0.1.0 fs_1.5.0 \r\n#> [25] vctrs_0.3.8 bit64_4.0.5 tidyselect_1.1.1 glue_1.4.2 \r\n#> [29] R6_2.5.1 fansi_0.5.0 rmarkdown_2.11 purrr_0.3.4 \r\n#> [33] magrittr_2.0.1 htmltools_0.5.2 ellipsis_0.3.2 assertthat_0.2.1\r\n#> [37] utf8_1.2.2 stringi_1.7.4 crayon_1.4.1\r\n```\r\n\r\n</details>",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-10-05T16:30:17.544+0000",
                    "updated": "2021-10-05T16:30:17.544+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424568",
                    "id": "17424568",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "body": "I\u00a0 am not really familiar with R nightly builds, but you will need a 6.0.0 release to get component extraction on date.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "created": "2021-10-05T16:35:34.643+0000",
                    "updated": "2021-10-05T16:35:34.643+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424575",
                    "id": "17424575",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Okay, sounds like it has to do with my version! Thanks.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-10-05T16:43:48.487+0000",
                    "updated": "2021-10-05T16:43:48.487+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424638",
                    "id": "17424638",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "{{packageVersion(\"arrow\")}} says you're still on 5.0.0.2. Anyway I just confirmed that this is resolved in master so will be released in 6.0.0 in the next couple of weeks. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-10-05T18:13:00.000+0000",
                    "updated": "2021-10-05T18:13:00.000+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13382960/comment/17424641",
                    "id": "17424641",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~npr]\u00a0Yes, I apologize\u00a0\u2013 I thought I had successfully installed nightly, but I had not. I have now done so and verified that the date component functions are working as expected.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jalsalam",
                        "name": "jalsalam",
                        "key": "jalsalam",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
                        },
                        "displayName": "Jameel Alsalam",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-10-05T18:24:11.791+0000",
                    "updated": "2021-10-05T18:24:11.791+0000"
                }
            ],
            "maxResults": 9,
            "total": 9,
            "startAt": 0
        },
        "customfield_12311820": "0|z0rsy0:",
        "customfield_12314139": null
    }
}