{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13233880",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880",
    "key": "ARROW-5359",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12347769",
                "id": "12347769",
                "description": "",
                "name": "1.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-07-24"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343937",
                "id": "12343937",
                "description": "",
                "name": "0.13.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-04-01"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12580466",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12580466",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13285258",
                    "key": "ARROW-7856",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13285258",
                    "fields": {
                        "summary": "[Python] to_pandas() causing datetimes > pd.Timestamp.max to wrap around",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12580468",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12580468",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13189863",
                    "key": "ARROW-3448",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13189863",
                    "fields": {
                        "summary": "[Python] Pandas roundtrip doesn't preserve list of datetime objects",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=joetl",
            "name": "joetl",
            "key": "joetl",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joe Muruganandam",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=joetl",
            "name": "joetl",
            "key": "joetl",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joe Muruganandam",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5359/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 35,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/433114",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r425087732\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3941,3 +3945,28 @@ def test_metadata_compat_missing_field_name():\n     result = table.to_pandas()\n     # on python 3.5 the column order can differ -> adding check_like=True\n     tm.assert_frame_equal(result, expected, check_like=True)\n+\n+\n+@pytest.mark.skipif(pq is None, reason=\"Parquet not available\")\n\nReview comment:\n       ```suggestion\r\n   @pytest.mark.parquet\r\n   ```\r\n   \r\n   (the mark will automatically ensure the tests are skipped as well)\n\n##########\nFile path: python/pyarrow/array.pxi\n##########\n@@ -549,6 +550,11 @@ cdef class _PandasConvertible:\n             Cast integers with nulls to objects\n         date_as_object : bool, default True\n             Cast dates to objects. If False, convert to datetime64[ns] dtype.\n+        timestamp_as_object : bool, default False\n+            Cast non-nanosecond timestamps (np.datetime64) to objects. This is\n\nReview comment:\n       Shoudn't we also force this conversion when you have nanosecond timestamps? If I specify `timestamp_as_object=True`, I would expect to actually get datetime objects, even if my unit is nanoseconds?\n\n##########\nFile path: python/pyarrow/pandas_compat.py\n##########\n@@ -699,6 +699,17 @@ def _reconstruct_block(item, columns=None, extension_columns=None):\n \n     block_arr = item.get('block', None)\n     placement = item['placement']\n+\n+    if (\n+            (block_arr is not None) and\n+            (block_arr.dtype.type == np.datetime64) and\n+            (block_arr.dtype.name != \"datetime64[ns]\")\n+    ):\n+        # Non-nanosecond timestamps can express much larger values than\n+        # nanosecond timestamps, and pandas checks that the values fit into\n+        # nanosecond range, so this needs to be an object as dtype.\n+        block_arr = block_arr.astype(np.dtype(\"O\"))\n\nReview comment:\n       Can you explain why this is needed? \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-14T12:18:28.294+0000",
                    "updated": "2020-05-14T12:18:28.294+0000",
                    "started": "2020-05-14T12:18:28.294+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "433114",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434964",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r427331603\n\n\n\n##########\nFile path: python/pyarrow/array.pxi\n##########\n@@ -549,6 +550,11 @@ cdef class _PandasConvertible:\n             Cast integers with nulls to objects\n         date_as_object : bool, default True\n             Cast dates to objects. If False, convert to datetime64[ns] dtype.\n+        timestamp_as_object : bool, default False\n+            Cast non-nanosecond timestamps (np.datetime64) to objects. This is\n\nReview comment:\n       Hm. It's lossy if you do that, though, since `datetime` only supports microseconds. And the goal is more to deal with out-of-range timestamps, and returning object is more a side-effect of trying to do that.\r\n   \r\n   Actually, here's the argument against changing it: having multiple columns, some nanosecond, some not. If nanosecond gets downgraded to microsecond, you're forced to choice between losing data and not being able to access data. Whereas current default allows both accuracy and range.\r\n   \r\n   I'm not sure in practice how much that will occur.\r\n   \r\n   I can change it if you have a strong opinion in favor of making it always return objects.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:10:18.815+0000",
                    "updated": "2020-05-19T14:10:18.815+0000",
                    "started": "2020-05-19T14:10:18.815+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434964",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434965",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r427336072\n\n\n\n##########\nFile path: python/pyarrow/pandas_compat.py\n##########\n@@ -699,6 +699,17 @@ def _reconstruct_block(item, columns=None, extension_columns=None):\n \n     block_arr = item.get('block', None)\n     placement = item['placement']\n+\n+    if (\n+            (block_arr is not None) and\n+            (block_arr.dtype.type == np.datetime64) and\n+            (block_arr.dtype.name != \"datetime64[ns]\")\n+    ):\n+        # Non-nanosecond timestamps can express much larger values than\n+        # nanosecond timestamps, and pandas checks that the values fit into\n+        # nanosecond range, so this needs to be an object as dtype.\n+        block_arr = block_arr.astype(np.dtype(\"O\"))\n\nReview comment:\n       If the dtype is `timestamp[ms]`, Pandas says \"oh it's a timestamp, I should force it to nanosecond\" and then it blows up for timestamps out of range, undoing the point of the exercise.\r\n   \r\n   Specifically, you get the following error:\r\n   \r\n   ```\r\n   pyarrow/pandas_compat.py:740: in _reconstruct_block\r\n       block = _int.make_block(block_arr, placement=placement)\r\n   ../pyarrow/lib/python3.7/site-packages/pandas/core/internals/blocks.py:3047: in make_block\r\n       return klass(values, ndim=ndim, placement=placement)\r\n   ../pyarrow/lib/python3.7/site-packages/pandas/core/internals/blocks.py:2170: in __init__\r\n       values = self._maybe_coerce_values(values)\r\n   ../pyarrow/lib/python3.7/site-packages/pandas/core/internals/blocks.py:2194: in _maybe_coerce_values\r\n       values = conversion.ensure_datetime64ns(values)\r\n   pandas/_libs/tslibs/conversion.pyx:123: in pandas._libs.tslibs.conversion.ensure_datetime64ns\r\n       ???\r\n   _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \r\n   \r\n   >   ???\r\n   E   pandas._libs.tslibs.np_datetime.OutOfBoundsDatetime: Out of bounds nanosecond timestamp: 1-01-01 00:00:00\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:16:05.982+0000",
                    "updated": "2020-05-19T14:16:05.982+0000",
                    "started": "2020-05-19T14:16:05.982+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434965",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434967",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r427341919\n\n\n\n##########\nFile path: python/pyarrow/pandas_compat.py\n##########\n@@ -699,6 +699,17 @@ def _reconstruct_block(item, columns=None, extension_columns=None):\n \n     block_arr = item.get('block', None)\n     placement = item['placement']\n+\n+    if (\n+            (block_arr is not None) and\n+            (block_arr.dtype.type == np.datetime64) and\n+            (block_arr.dtype.name != \"datetime64[ns]\")\n+    ):\n+        # Non-nanosecond timestamps can express much larger values than\n+        # nanosecond timestamps, and pandas checks that the values fit into\n+        # nanosecond range, so this needs to be an object as dtype.\n+        block_arr = block_arr.astype(np.dtype(\"O\"))\n\nReview comment:\n       I expanded the inline comment to try to explain better.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:23:24.856+0000",
                    "updated": "2020-05-19T14:23:24.856+0000",
                    "started": "2020-05-19T14:23:24.856+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434967",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434968",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r427342127\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3941,3 +3945,28 @@ def test_metadata_compat_missing_field_name():\n     result = table.to_pandas()\n     # on python 3.5 the column order can differ -> adding check_like=True\n     tm.assert_frame_equal(result, expected, check_like=True)\n+\n+\n+@pytest.mark.skipif(pq is None, reason=\"Parquet not available\")\n\nReview comment:\n       Fixed.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:23:38.317+0000",
                    "updated": "2020-05-19T14:23:38.317+0000",
                    "started": "2020-05-19T14:23:38.317+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434968",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434971",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-630853662\n\n\n   @jorisvandenbossche (or any other reviewer): I have resolved two comments, and the remaining one needs some additional feedback from a reviewer. Thanks!\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:24:26.314+0000",
                    "updated": "2020-05-19T14:24:26.314+0000",
                    "started": "2020-05-19T14:24:26.314+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434971",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434974",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-630858966\n\n\n   @itamarst thanks for the updates! See also my non-inline questions/comments at https://github.com/apache/arrow/pull/7169#pullrequestreview-411737751\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:32:24.599+0000",
                    "updated": "2020-05-19T14:32:24.599+0000",
                    "started": "2020-05-19T14:32:24.599+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434974",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434976",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r427351793\n\n\n\n##########\nFile path: python/pyarrow/array.pxi\n##########\n@@ -549,6 +550,11 @@ cdef class _PandasConvertible:\n             Cast integers with nulls to objects\n         date_as_object : bool, default True\n             Cast dates to objects. If False, convert to datetime64[ns] dtype.\n+        timestamp_as_object : bool, default False\n+            Cast non-nanosecond timestamps (np.datetime64) to objects. This is\n\nReview comment:\n       Hmm, yes, that's a good reason. \r\n   Personally I don't think that it being lossy is a problem (in the end, the user would explicitly ask for it), but since this keyword applies to all columns, it might indeed be useful to handle this case of mixed-unit columns a bit more gracefully.\r\n   \r\n   (this might also signal that a simple boolean flag is maybe not sufficient for this keyword)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:34:45.190+0000",
                    "updated": "2020-05-19T14:34:45.190+0000",
                    "started": "2020-05-19T14:34:45.190+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434976",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434978",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-630861038\n\n\n   Ah yes, will do. Any thoughts on the remaining inline review comment re objects for nanosecond?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:35:25.878+0000",
                    "updated": "2020-05-19T14:35:25.878+0000",
                    "started": "2020-05-19T14:35:25.878+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434978",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434980",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-630861784\n\n\n   Actually, how about changing the keyword to \"dont_force_nanosecond_timetamp\" or something? That would address two of your concerns.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:36:30.508+0000",
                    "updated": "2020-05-19T14:36:30.508+0000",
                    "started": "2020-05-19T14:36:30.507+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434980",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/434984",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-630868204\n\n\n   OK, I've addressed the testing comments, so we're down to semantics and naming of the flag.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-19T14:45:42.763+0000",
                    "updated": "2020-05-19T14:45:42.763+0000",
                    "started": "2020-05-19T14:45:42.763+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "434984",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/437948",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-634853818\n\n\n   @jorisvandenbossche are you happy with this as is, or do you want semantic changes to the flag?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-27T18:23:47.772+0000",
                    "updated": "2020-05-27T18:23:47.772+0000",
                    "started": "2020-05-27T18:23:47.771+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "437948",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/437961",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r431368560\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3965,8 +3964,32 @@ def test_timestamp_as_object():\n             np.datetime64('2050-05-03 15:42', 'ns'),\n         ],\n     })\n+    # Not part of what we're testing, just ensuring that the inputs are what we\n+    # expect.\n+    assert (df.dateTimeMs.dtype, df.dateTimeNs.dtype) == (\n+        # O == object, <M8[ns] == timestamp64[ns]\n+        np.dtype(\"O\"), np.dtype(\"<M8[ns]\")\n+    )\n+    return df\n+\n+\n+@pytest.mark.parquet\n+def test_timestamp_as_object_parquet(tempdir):\n+    # Timestamps can be stored as Parquet and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n     table = pa.Table.from_pandas(df)\n-    pq.write_table(table, 'timeseries.parquet', version=\"2.0\")\n-    result = pq.read_table('timeseries.parquet')\n+    filename = tempdir / \"timestamps_from_pandas.parquet\"\n+    pq.write_table(table, filename, version=\"2.0\")\n+    result = pq.read_table(filename)\n     df2 = result.to_pandas(timestamp_as_object=True)\n     tm.assert_frame_equal(df, df2, check_like=True)\n+\n+\n+def test_timestamp_as_object():\n+    # Timestamps can be converted Arrow and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n+    table = pa.Table.from_pandas(df)\n+    df2 = table.to_pandas(timestamp_as_object=True)\n+    tm.assert_frame_equal(df, df2, check_like=True)\n\nReview comment:\n       I would still like to see more explicit tests (eg from this test it is still not clear to me what is actually being returned is a datetime.datetime object or not)\r\n   \r\n   Eg something like\r\n   \r\n   ```\r\n   import datetime\r\n   dt = datetime.datetime(2012, 1, 1)\r\n   arr = pa.array([dt], type=pa.timestamp('s'))\r\n   result = arr.to_pandas(timestamp_as_object=True)\r\n   assert result.dtype == object\r\n   assert isinstance(result[0], datetime.datetime)\r\n   assert result[0] == dt \r\n   ```\r\n   \r\n   And the above can be done for the different resolutions (except ns) to cover that as well.\r\n   \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-27T18:52:25.724+0000",
                    "updated": "2020-05-27T18:52:25.724+0000",
                    "started": "2020-05-27T18:52:25.724+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "437961",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/437967",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-634876862\n\n\n   @itamarst sorry for the slow follow-up. I think I am OK with the current semantics of the option\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-27T19:04:46.636+0000",
                    "updated": "2020-05-27T19:04:46.636+0000",
                    "started": "2020-05-27T19:04:46.636+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "437967",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/437968",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r431376285\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3965,8 +3964,32 @@ def test_timestamp_as_object():\n             np.datetime64('2050-05-03 15:42', 'ns'),\n         ],\n     })\n+    # Not part of what we're testing, just ensuring that the inputs are what we\n+    # expect.\n+    assert (df.dateTimeMs.dtype, df.dateTimeNs.dtype) == (\n+        # O == object, <M8[ns] == timestamp64[ns]\n+        np.dtype(\"O\"), np.dtype(\"<M8[ns]\")\n+    )\n+    return df\n+\n+\n+@pytest.mark.parquet\n+def test_timestamp_as_object_parquet(tempdir):\n+    # Timestamps can be stored as Parquet and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n     table = pa.Table.from_pandas(df)\n-    pq.write_table(table, 'timeseries.parquet', version=\"2.0\")\n-    result = pq.read_table('timeseries.parquet')\n+    filename = tempdir / \"timestamps_from_pandas.parquet\"\n+    pq.write_table(table, filename, version=\"2.0\")\n+    result = pq.read_table(filename)\n     df2 = result.to_pandas(timestamp_as_object=True)\n     tm.assert_frame_equal(df, df2, check_like=True)\n+\n+\n+def test_timestamp_as_object():\n+    # Timestamps can be converted Arrow and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n+    table = pa.Table.from_pandas(df)\n+    df2 = table.to_pandas(timestamp_as_object=True)\n+    tm.assert_frame_equal(df, df2, check_like=True)\n\nReview comment:\n       OK, tried to do something based on your suggestion.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-27T19:06:11.782+0000",
                    "updated": "2020-05-27T19:06:11.782+0000",
                    "started": "2020-05-27T19:06:11.782+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "437968",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/443806",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r438202601\n\n\n\n##########\nFile path: python/pyarrow/pandas_compat.py\n##########\n@@ -699,6 +699,22 @@ def _reconstruct_block(item, columns=None, extension_columns=None):\n \n     block_arr = item.get('block', None)\n     placement = item['placement']\n+\n+    if (\n+            (block_arr is not None) and\n+            (block_arr.dtype.type == np.datetime64) and\n+            (block_arr.dtype.name != \"datetime64[ns]\")\n+    ):\n+        # 1. Non-nanosecond timestamps can express dates outside\n+        #    the range supported by nanoseconds.\n+        # 2. If the dtype is datetime64 of any sort, deep inside\n+        #    Panda's make_block() code path is will do\n\nReview comment:\n       ```suggestion\r\n           #    pandas' make_block() code path it will do\r\n   ```\n\n##########\nFile path: python/pyarrow/pandas_compat.py\n##########\n@@ -699,6 +699,17 @@ def _reconstruct_block(item, columns=None, extension_columns=None):\n \n     block_arr = item.get('block', None)\n     placement = item['placement']\n+\n+    if (\n+            (block_arr is not None) and\n+            (block_arr.dtype.type == np.datetime64) and\n+            (block_arr.dtype.name != \"datetime64[ns]\")\n+    ):\n+        # Non-nanosecond timestamps can express much larger values than\n+        # nanosecond timestamps, and pandas checks that the values fit into\n+        # nanosecond range, so this needs to be an object as dtype.\n+        block_arr = block_arr.astype(np.dtype(\"O\"))\n\nReview comment:\n       Thanks for the additional comments. All clear now!\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3941,3 +3946,63 @@ def test_metadata_compat_missing_field_name():\n     result = table.to_pandas()\n     # on python 3.5 the column order can differ -> adding check_like=True\n     tm.assert_frame_equal(result, expected, check_like=True)\n+\n+\n+def make_df_with_timestamps():\n+    # Some of the milliseconds timestamps deliberately don't fit in the range\n+    # that is possible with nanosecond timestamps.\n+    df = pd.DataFrame({\n+        'dateTimeMs': [\n+            np.datetime64('0001-01-01 00:00', 'ms'),\n+            np.datetime64('2012-05-02 12:35', 'ms'),\n+            np.datetime64('2012-05-03 15:42', 'ms'),\n+            np.datetime64('3000-05-03 15:42', 'ms'),\n+        ],\n+        'dateTimeNs': [\n+            np.datetime64('1991-01-01 00:00', 'ns'),\n+            np.datetime64('2012-05-02 12:35', 'ns'),\n+            np.datetime64('2012-05-03 15:42', 'ns'),\n+            np.datetime64('2050-05-03 15:42', 'ns'),\n+        ],\n+    })\n+    # Not part of what we're testing, just ensuring that the inputs are what we\n+    # expect.\n+    assert (df.dateTimeMs.dtype, df.dateTimeNs.dtype) == (\n+        # O == object, <M8[ns] == timestamp64[ns]\n+        np.dtype(\"O\"), np.dtype(\"<M8[ns]\")\n+    )\n+    return df\n+\n+\n+@pytest.mark.parquet\n+def test_timestamp_as_object_parquet(tempdir):\n+    # Timestamps can be stored as Parquet and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n+    table = pa.Table.from_pandas(df)\n+    filename = tempdir / \"timestamps_from_pandas.parquet\"\n+    pq.write_table(table, filename, version=\"2.0\")\n+    result = pq.read_table(filename)\n+    df2 = result.to_pandas(timestamp_as_object=True)\n+    tm.assert_frame_equal(df, df2, check_like=True)\n\nReview comment:\n       I quickly checked, and the `check_like` doesn't seem necessary. Do you remember why you added it?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-10T15:38:08.861+0000",
                    "updated": "2020-06-10T15:38:08.861+0000",
                    "started": "2020-06-10T15:38:08.860+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "443806",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/443807",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on a change in pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#discussion_r438222016\n\n\n\n##########\nFile path: python/pyarrow/tests/test_pandas.py\n##########\n@@ -3941,3 +3946,63 @@ def test_metadata_compat_missing_field_name():\n     result = table.to_pandas()\n     # on python 3.5 the column order can differ -> adding check_like=True\n     tm.assert_frame_equal(result, expected, check_like=True)\n+\n+\n+def make_df_with_timestamps():\n+    # Some of the milliseconds timestamps deliberately don't fit in the range\n+    # that is possible with nanosecond timestamps.\n+    df = pd.DataFrame({\n+        'dateTimeMs': [\n+            np.datetime64('0001-01-01 00:00', 'ms'),\n+            np.datetime64('2012-05-02 12:35', 'ms'),\n+            np.datetime64('2012-05-03 15:42', 'ms'),\n+            np.datetime64('3000-05-03 15:42', 'ms'),\n+        ],\n+        'dateTimeNs': [\n+            np.datetime64('1991-01-01 00:00', 'ns'),\n+            np.datetime64('2012-05-02 12:35', 'ns'),\n+            np.datetime64('2012-05-03 15:42', 'ns'),\n+            np.datetime64('2050-05-03 15:42', 'ns'),\n+        ],\n+    })\n+    # Not part of what we're testing, just ensuring that the inputs are what we\n+    # expect.\n+    assert (df.dateTimeMs.dtype, df.dateTimeNs.dtype) == (\n+        # O == object, <M8[ns] == timestamp64[ns]\n+        np.dtype(\"O\"), np.dtype(\"<M8[ns]\")\n+    )\n+    return df\n+\n+\n+@pytest.mark.parquet\n+def test_timestamp_as_object_parquet(tempdir):\n+    # Timestamps can be stored as Parquet and reloaded into Pandas with no loss\n+    # of information if the timestamp_as_object option is True.\n+    df = make_df_with_timestamps()\n+    table = pa.Table.from_pandas(df)\n+    filename = tempdir / \"timestamps_from_pandas.parquet\"\n+    pq.write_table(table, filename, version=\"2.0\")\n+    result = pq.read_table(filename)\n+    df2 = result.to_pandas(timestamp_as_object=True)\n+    tm.assert_frame_equal(df, df2, check_like=True)\n\nReview comment:\n       Probably copied from some other test or something.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-10T15:40:32.518+0000",
                    "updated": "2020-06-10T15:40:32.518+0000",
                    "started": "2020-06-10T15:40:32.518+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "443807",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/443819",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "itamarst commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-642098139\n\n\n   > @itamarst thanks for the updated tests\r\n   > \r\n   > I wanted to do a final check before merging, but I now realize we might not necessarily need a new option on the C++ level (`timestamp_as_object`), as we already have the internal `coerce_temporal_nanoseconds` option, which we can set depending on the public `timestamp_as_object` option.\r\n   > \r\n   > Eg the code at\r\n   > \r\n   > https://github.com/apache/arrow/blob/75546d1aa8a45a0358f88f4993a5a8ed2452f2e4/python/pyarrow/array.pxi#L1114-L1115\r\n   > \r\n   > could be (I think)\r\n   > \r\n   > ```\r\n   > if not timestamp_as_object:\r\n   >     c_options.coerce_temporal_nanoseconds = True\r\n   > ```\r\n   > \r\n   \r\n   Mmmm. Maybe? That also interacts with `date_as_object` so it plausibly will have side-effects if we switch to that implmenetation.\r\n   \r\n   ```c++\r\n       case Type::DATE64:\r\n         if (options.date_as_object) {\r\n           *output_type = PandasWriter::OBJECT;\r\n         } else {\r\n           *output_type = options.coerce_temporal_nanoseconds ? PandasWriter::DATETIME_NANO\r\n                                                              : PandasWriter::DATETIME_DAY;\r\n         }\r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-10T15:51:07.142+0000",
                    "updated": "2020-06-10T15:51:07.142+0000",
                    "started": "2020-06-10T15:51:07.142+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "443819",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/444134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-642445332\n\n\n   Ah, yes, forgot that `coerce_temporal_nanoseconds` is also used to signal nanoseconds for dates and duration/timedelta. OK, forget my suggestion ;)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-11T06:42:43.117+0000",
                    "updated": "2020-06-11T06:42:43.117+0000",
                    "started": "2020-06-11T06:42:43.117+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "444134",
                    "issueId": "13233880"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/worklog/444137",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #7169:\nURL: https://github.com/apache/arrow/pull/7169#issuecomment-642447156\n\n\n   OK, some final things:\r\n   \r\n   - There is a lint error: \r\n   \r\n   ```\r\n   INFO:archery:Running Python linter (flake8)\r\n   /arrow/python/pyarrow/tests/test_pandas.py:26:1: F811 redefinition of unused 'datetime' from line 23\r\n   ```\r\n   \r\n   * The new tests are failing for older pandas. I am taking a look at that (solution migth be to just skip for older pandas)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-06-11T06:46:45.642+0000",
                    "updated": "2020-06-11T06:46:45.642+0000",
                    "started": "2020-06-11T06:46:45.642+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "444137",
                    "issueId": "13233880"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 21000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6890d168[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5144bcb2[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@19d3f32d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6d067d89[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7fb46473[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3b6f8352[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3da35589[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@63179d81[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3fdcea6c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@78ee9bd6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5f46965f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@e2f3a3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 21000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Jun 19 03:29:16 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-06-19T03:29:16.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-5359/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2019-05-16T23:41:47.000+0000",
        "updated": "2020-06-19T03:29:21.000+0000",
        "timeoriginalestimate": null,
        "description": "Creating ticket for issue reported in github([https://github.com/apache/arrow/issues/4284])\r\nh2. pyarrow (Issue with timestamp conversion from arrow to pandas)\r\n\r\npyarrow Table.to_pandas has option date_as_object but does not have similar option for timestamp. When a timestamp column in arrow table is converted to pandas the target datetype is pd.Timestamp and pd.Timestamp does not handle time > 2262-04-11 23:47:16.854775807 and hence in the below scenario the date is transformed to incorrect value. Adding timestamp_as_object option in pa.Table.to_pandas will help in this scenario.\r\n\r\n#Python(3.6.8)\r\n\r\nimport pandas as pd\r\n\r\nimport pyarrow as pa\r\n\r\npd.*version*\r\n'0.24.1'\r\n\r\npa.*version*\r\n'0.13.0'\r\n\r\nimport datetime\r\n\r\ndf = pd.DataFrame(\\{\"test_date\": [datetime.datetime(3000,12,31,12,0),datetime.datetime(3100,12,31,12,0)]})\r\n\r\ndf\r\ntest_date\r\n0 3000-12-31 12:00:00\r\n1 3100-12-31 12:00:00\r\n\r\npa_table = pa.Table.from_pandas(df)\r\n\r\npa_table[0]\r\nColumn name='test_date' type=TimestampType(timestamp[us])\r\n[\r\n[\r\n32535172800000000,\r\n35690846400000000\r\n]\r\n]\r\n\r\npa_table.to_pandas()\r\ntest_date\r\n0 1831-11-22 12:50:52.580896768\r\n1 1931-11-22 12:50:52.580896768",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 21000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] timestamp_as_object support for pa.Table.to_pandas in pyarrow",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "Ubuntu",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/comment/17104355",
                    "id": "17104355",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=GPSnoopy",
                        "name": "GPSnoopy",
                        "key": "gpsnoopy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Tanguy Fautre",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I suspect this feature is needed to support Parquet files containing timestamps in ms or us, where entries such as 0001-01-01 00:00 or 9999-12-31 23:59 need to be supported (in our use case, these are MinValue and MaxValue of DateTime in C#).\r\n\r\nThe following code works until {{to_pandas()}} is called. This latter part tries to convert timestamp[ms] to timestamp[ns] (hence the {{safe=False}}) and converts 0001-01-01 to 1754-08-30.\r\n\r\n- Python 3.8.2 x64\r\n- Pandas 1.0.3\r\n- PyArrow 0.17.0\r\n\r\n{code:python}\r\nimport numpy as np\r\nimport pandas as pd\r\nimport pyarrow as pa\r\nimport pyarrow.parquet as pq\r\n\r\ndf = pd.DataFrame({\r\n    'id': [1, 2, 3],\r\n    'dateTime': [np.datetime64('0001-01-01 00:00', 'ms'), np.datetime64('2012-05-02 12:35', 'ms'), np.datetime64('2012-05-03 15:42', 'ms')],\r\n    'value': [1.1, 2.2, 3.3]})\r\n\r\ntable = pa.Table.from_pandas(df)\r\npq.write_table(table, 'timeseries.parquet')\r\nresult = pq.read_table('timeseries.parquet')\r\ndf2 = result.to_pandas(date_as_object = True, safe = False)\r\n{code}\r\n\r\ndf\r\n{code}\r\n \tid \tdateTime \tvalue\r\n0 \t1 \t0001-01-01T00:00:00.000 \t1.1\r\n1 \t2 \t2012-05-02T12:35:00.000 \t2.2\r\n2 \t3 \t2012-05-03T15:42:00.000 \t3.3\r\n{code}\r\n\r\ndf['dateTime']\r\n{code}\r\n0    0001-01-01T00:00:00.000\r\n1    2012-05-02T12:35:00.000\r\n2    2012-05-03T15:42:00.000\r\nName: dateTime, dtype: object\r\n{code}\r\n\r\ntable\r\n{code}\r\npyarrow.Table\r\nid: int64\r\ndateTime: timestamp[ms]\r\nvalue: double\r\n{code}\r\n\r\nresult\r\n{code}\r\npyarrow.Table\r\nid: int64\r\ndateTime: timestamp[ms]\r\nvalue: double\r\n{code}\r\n\r\ndf2\r\n{code}\r\n \tid \tdateTime \tvalue\r\n0 \t1 \t1754-08-30 22:43:41.128654848 \t1.1\r\n1 \t2 \t2012-05-02 12:35:00.000000000 \t2.2\r\n2 \t3 \t2012-05-03 15:42:00.000000000 \t3.3\r\n{code}\r\n\r\ndf2['dateTime']\r\n{code}\r\n0   1754-08-30 22:43:41.128654848\r\n1   2012-05-02 12:35:00.000000000\r\n2   2012-05-03 15:42:00.000000000\r\nName: dateTime, dtype: datetime64[ns]\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=GPSnoopy",
                        "name": "GPSnoopy",
                        "key": "gpsnoopy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Tanguy Fautre",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-05-11T11:30:20.647+0000",
                    "updated": "2020-05-11T11:30:20.647+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/comment/17105254",
                    "id": "17105254",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Indeed, out-of-bounds timetamps (out of bounds for pandas, which only supports 1677 to 2262 right now) is I think the main use case for a {{timestamp_as_object}} keyword.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-05-12T09:09:46.759+0000",
                    "updated": "2020-05-12T09:09:46.759+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/comment/17106379",
                    "id": "17106379",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=itamarst",
                        "name": "itamarst",
                        "key": "itamarst",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=itamarst&avatarId=39709",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=itamarst&avatarId=39709",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=itamarst&avatarId=39709",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=itamarst&avatarId=39709"
                        },
                        "displayName": "Itamar Turner-Trauring",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I have opened a PR with a fix: https://github.com/apache/arrow/pull/7169",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=itamarst",
                        "name": "itamarst",
                        "key": "itamarst",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=itamarst&avatarId=39709",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=itamarst&avatarId=39709",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=itamarst&avatarId=39709",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=itamarst&avatarId=39709"
                        },
                        "displayName": "Itamar Turner-Trauring",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-05-13T15:03:38.826+0000",
                    "updated": "2020-05-13T15:03:38.826+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13233880/comment/17140165",
                    "id": "17140165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 7169\n[https://github.com/apache/arrow/pull/7169]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-06-19T03:29:16.348+0000",
                    "updated": "2020-06-19T03:29:16.348+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z02s80:",
        "customfield_12314139": null
    }
}