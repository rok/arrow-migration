{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13169194",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194",
    "key": "ARROW-2763",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rgruener",
            "name": "rgruener",
            "key": "rgruener",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robbie Gruener",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rgruener",
            "name": "rgruener",
            "key": "rgruener",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robbie Gruener",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rgruener",
            "name": "rgruener",
            "key": "rgruener",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Robbie Gruener",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2763/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 6,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117487",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rgruener opened a new pull request #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195\n \n \n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-29T17:26:12.302+0000",
                    "updated": "2018-06-29T17:26:12.302+0000",
                    "started": "2018-06-29T17:26:12.302+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117487",
                    "issueId": "13169194"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117490",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rgruener commented on a change in pull request #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195#discussion_r199229951\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -729,16 +729,23 @@ def __init__(self, path_or_paths, filesystem=None, schema=None,\n \n         self.paths = path_or_paths\n \n-        (self.pieces, self.partitions,\n-         self.common_metadata_path) = _make_manifest(path_or_paths, self.fs)\n+        (self.pieces,\n+         self.partitions,\n+         self.common_metadata_path,\n+         self.metadata_path) = _make_manifest(path_or_paths, self.fs)\n \n         if self.common_metadata_path is not None:\n             with self.fs.open(self.common_metadata_path) as f:\n                 self.common_metadata = ParquetFile(f).metadata\n         else:\n             self.common_metadata = None\n \n-        self.metadata = metadata\n+        if metadata is None and self.metadata_path is not None:\n+            with self.fs.open(self.metadata_path) as f:\n+                self.metadata = ParquetFile(f).metadata\n+        else:\n+            self.metadata = metadata\n \n Review comment:\n   This is potentially confusing since if you pass in `metadata` for schema validation the `metadata_path` could be pointing to a different file than the `metadata` object represents. I think it might be best to have the `metadata` passed into the constructor be strictly used for schema validation and not stored to represent the metadata object of the dataset as it seems like it wouldnt contain the correct row group information of the dataset.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-29T17:32:51.793+0000",
                    "updated": "2018-06-29T17:32:51.793+0000",
                    "started": "2018-06-29T17:32:51.793+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117490",
                    "issueId": "13169194"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117859",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on a change in pull request #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195#discussion_r199325403\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -729,16 +729,23 @@ def __init__(self, path_or_paths, filesystem=None, schema=None,\n \n         self.paths = path_or_paths\n \n-        (self.pieces, self.partitions,\n-         self.common_metadata_path) = _make_manifest(path_or_paths, self.fs)\n+        (self.pieces,\n+         self.partitions,\n+         self.common_metadata_path,\n+         self.metadata_path) = _make_manifest(path_or_paths, self.fs)\n \n         if self.common_metadata_path is not None:\n             with self.fs.open(self.common_metadata_path) as f:\n                 self.common_metadata = ParquetFile(f).metadata\n         else:\n             self.common_metadata = None\n \n-        self.metadata = metadata\n+        if metadata is None and self.metadata_path is not None:\n+            with self.fs.open(self.metadata_path) as f:\n+                self.metadata = ParquetFile(f).metadata\n+        else:\n+            self.metadata = metadata\n \n Review comment:\n   When we would go the route and only use the passed-in `metadata` for schema validation, we should probably call the parameter differently (i.e. deprecate the old, add the new one).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-30T15:38:11.173+0000",
                    "updated": "2018-06-30T15:38:11.173+0000",
                    "started": "2018-06-30T15:38:11.172+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117859",
                    "issueId": "13169194"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117860",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on a change in pull request #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195#discussion_r199325359\n \n \n\n ##########\n File path: python/pyarrow/parquet.py\n ##########\n @@ -756,8 +763,8 @@ def validate_schemas(self):\n         open_file = self._get_open_file_func()\n \n         if self.metadata is None and self.schema is None:\n-            if self.common_metadata_path is not None:\n-                self.schema = open_file(self.common_metadata_path).schema\n+            if self.common_metadata is not None:\n \n Review comment:\n   Nice catch!\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-30T15:38:11.180+0000",
                    "updated": "2018-06-30T15:38:11.180+0000",
                    "started": "2018-06-30T15:38:11.180+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117860",
                    "issueId": "13169194"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117862",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on issue #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195#issuecomment-401548432\n \n \n   Failure is the Plasma test that is fixed on master\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-30T15:39:07.567+0000",
                    "updated": "2018-06-30T15:39:07.567+0000",
                    "started": "2018-06-30T15:39:07.566+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117862",
                    "issueId": "13169194"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/worklog/117863",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy closed pull request #2195: ARROW-2763: [Python] Make _metadata file accessible in ParquetDataset\nURL: https://github.com/apache/arrow/pull/2195\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/pyarrow/parquet.py b/python/pyarrow/parquet.py\nindex f8fd8b46b4..ccbc47844f 100644\n--- a/python/pyarrow/parquet.py\n+++ b/python/pyarrow/parquet.py\n@@ -729,8 +729,10 @@ def __init__(self, path_or_paths, filesystem=None, schema=None,\n \n         self.paths = path_or_paths\n \n-        (self.pieces, self.partitions,\n-         self.common_metadata_path) = _make_manifest(path_or_paths, self.fs)\n+        (self.pieces,\n+         self.partitions,\n+         self.common_metadata_path,\n+         self.metadata_path) = _make_manifest(path_or_paths, self.fs)\n \n         if self.common_metadata_path is not None:\n             with self.fs.open(self.common_metadata_path) as f:\n@@ -738,7 +740,12 @@ def __init__(self, path_or_paths, filesystem=None, schema=None,\n         else:\n             self.common_metadata = None\n \n-        self.metadata = metadata\n+        if metadata is None and self.metadata_path is not None:\n+            with self.fs.open(self.metadata_path) as f:\n+                self.metadata = ParquetFile(f).metadata\n+        else:\n+            self.metadata = metadata\n+\n         self.schema = schema\n \n         self.split_row_groups = split_row_groups\n@@ -756,8 +763,8 @@ def validate_schemas(self):\n         open_file = self._get_open_file_func()\n \n         if self.metadata is None and self.schema is None:\n-            if self.common_metadata_path is not None:\n-                self.schema = open_file(self.common_metadata_path).schema\n+            if self.common_metadata is not None:\n+                self.schema = self.common_metadata.schema\n             else:\n                 self.schema = self.pieces[0].get_metadata(open_file).schema\n         elif self.schema is None:\n@@ -919,6 +926,7 @@ def _ensure_filesystem(fs):\n def _make_manifest(path_or_paths, fs, pathsep='/'):\n     partitions = None\n     common_metadata_path = None\n+    metadata_path = None\n \n     if len(path_or_paths) == 1:\n         # Dask passes a directory as a list of length 1\n@@ -928,6 +936,7 @@ def _make_manifest(path_or_paths, fs, pathsep='/'):\n         manifest = ParquetManifest(path_or_paths, filesystem=fs,\n                                    pathsep=fs.pathsep)\n         common_metadata_path = manifest.common_metadata_path\n+        metadata_path = manifest.metadata_path\n         pieces = manifest.pieces\n         partitions = manifest.partitions\n     else:\n@@ -946,7 +955,7 @@ def _make_manifest(path_or_paths, fs, pathsep='/'):\n             piece = ParquetDatasetPiece(path)\n             pieces.append(piece)\n \n-    return pieces, partitions, common_metadata_path\n+    return pieces, partitions, common_metadata_path, metadata_path\n \n \n _read_table_docstring = \"\"\"\ndiff --git a/python/pyarrow/tests/test_parquet.py b/python/pyarrow/tests/test_parquet.py\nindex b09ac5a565..e0ddca1c81 100644\n--- a/python/pyarrow/tests/test_parquet.py\n+++ b/python/pyarrow/tests/test_parquet.py\n@@ -1350,6 +1350,41 @@ def test_read_common_metadata_files(tmpdir):\n     _test_read_common_metadata_files(fs, base_path)\n \n \n+def _test_read_metadata_files(fs, base_path):\n+    import pyarrow.parquet as pq\n+\n+    N = 100\n+    df = pd.DataFrame({\n+        'index': np.arange(N),\n+        'values': np.random.randn(N)\n+    }, columns=['index', 'values'])\n+\n+    data_path = pjoin(base_path, 'data.parquet')\n+\n+    table = pa.Table.from_pandas(df)\n+\n+    with fs.open(data_path, 'wb') as f:\n+        _write_table(table, f)\n+\n+    metadata_path = pjoin(base_path, '_metadata')\n+    with fs.open(metadata_path, 'wb') as f:\n+        pq.write_metadata(table.schema, f)\n+\n+    dataset = pq.ParquetDataset(base_path, filesystem=fs)\n+    assert dataset.metadata_path == metadata_path\n+\n+    with fs.open(data_path) as f:\n+        metadata_schema = pq.read_metadata(f).schema\n+    assert dataset.schema.equals(metadata_schema)\n+\n+\n+@parquet\n+def test_read_metadata_files(tmpdir):\n+    base_path = str(tmpdir)\n+    fs = LocalFileSystem.get_instance()\n+    _test_read_metadata_files(fs, base_path)\n+\n+\n @parquet\n def test_read_schema(tmpdir):\n     import pyarrow.parquet as pq\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-06-30T15:39:49.136+0000",
                    "updated": "2018-06-30T15:39:49.136+0000",
                    "started": "2018-06-30T15:39:49.135+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "117863",
                    "issueId": "13169194"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 3000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@35466b53[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@449ddcbe[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7e3f3c45[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@54ed7710[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3a55f1dc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6c41e033[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6b9b24ea[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@54f18b7e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41bf4b2d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@229c6b51[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1092b79c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@48e0648b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 3000,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Jun 30 15:39:47 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-06-30T15:39:47.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2763/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2018-06-29T16:02:15.000+0000",
        "updated": "2018-06-30T15:39:55.000+0000",
        "timeoriginalestimate": null,
        "description": "Currently when creating a ParquetDataset it gives you access to the _common_metadata file but not the _metadata file.\r\n\r\nWe access the metadata file to get row group information\u00a0of the dataset without opening each footer.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 3000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Make parquet _metadata file accessible from ParquetDataset",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13169194/comment/16528773",
                    "id": "16528773",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 2195\n[https://github.com/apache/arrow/pull/2195]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2018-06-30T15:39:47.085+0000",
                    "updated": "2018-06-30T15:39:47.085+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|i3ve4n:",
        "customfield_12314139": null
    }
}