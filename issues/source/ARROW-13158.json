{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13385577",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577",
    "key": "ARROW-13158",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13158/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614381",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche opened a new pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591\n\n\n   This PR does several small things:\r\n   \r\n   - Fix `__contains__` to not check the actual keys (and not rely on `__getitem__` since that also supports integers)\r\n   - Add tests for the case of StructScalar with duplicate field names, and ensure some behaviours that already worked (`__getitem__` with integers, `__iter__`, `keys()`)\r\n   - Changed `list(scalar)` (`__iter__`) to also return the keys for a \"null\" scalar (since we do allow `s[\"key\"]` in that case, that seems most consistent?)\r\n   - Changed the `repr` to use a tuple instead of dict representation. I know this just postpones a bit the `as_py()` discussion (should it return dict vs tuple?), but at least this ensures that the `repr` doesn't fail on the short term, and so you can inspect the object.\r\n   - I added an explicit `items()` method (overriding the ones from Mapping), because the return value of this can in theory support duplicate fields, and this can be a way to get a list of tuples already. But, this doesn't fully follows the Mapping API as the return value is different (not a `dict_items` object).\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T09:00:22.690+0000",
                    "updated": "2021-06-24T09:00:22.690+0000",
                    "started": "2021-06-24T09:00:22.690+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614381",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614382",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#issuecomment-867467562\n\n\n   https://issues.apache.org/jira/browse/ARROW-13158\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T09:00:36.304+0000",
                    "updated": "2021-06-24T09:00:36.304+0000",
                    "started": "2021-06-24T09:00:36.304+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614382",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614387",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r657765844\n\n\n\n##########\nFile path: python/pyarrow/tests/test_scalars.py\n##########\n@@ -514,7 +515,7 @@ def test_struct():\n         s['non-existent']\n \n     s = pa.scalar(None, type=ty)\n-    assert list(s) == []\n+    assert list(s) == list(s.keys()) == ['x', 'y']\n\nReview comment:\n       This is a change in behaviour, but it seems more correct to me, since you can still do `s['x']` (which gives you a null scalar). But on the other hand it conflicts with `s.as_py()` being `None` (and not `{'x': None, 'y': None}`)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T09:03:27.002+0000",
                    "updated": "2021-06-24T09:03:27.002+0000",
                    "started": "2021-06-24T09:03:27.002+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614387",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614622",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r658129462\n\n\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n+            except KeyError:\n+                raise ValueError(\n+                    \"Converting to Python dictionary is not supported when \"\n+                    \"duplicate field names are present\")\n         else:\n             return None\n \n+    def _as_py_tuple(self):\n+        # a version that returns a tuple instead of dict to support repr/str\n+        # with the presence of duplicate field names\n+        if self.is_valid:\n+            return [(key, self[i].as_py()) for i, key in enumerate(self)]\n\nReview comment:\n       `return list(self.items())`?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T17:02:46.578+0000",
                    "updated": "2021-06-24T17:02:46.578+0000",
                    "started": "2021-06-24T17:02:46.578+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614622",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614623",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r658129744\n\n\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n\nReview comment:\n       `return dict(self.items())`?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T17:03:09.766+0000",
                    "updated": "2021-06-24T17:03:09.766+0000",
                    "started": "2021-06-24T17:03:09.766+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614623",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614625",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r658130623\n\n\n\n##########\nFile path: python/pyarrow/tests/test_scalars.py\n##########\n@@ -514,7 +515,7 @@ def test_struct():\n         s['non-existent']\n \n     s = pa.scalar(None, type=ty)\n-    assert list(s) == []\n+    assert list(s) == list(s.keys()) == ['x', 'y']\n\nReview comment:\n       Yes, it's a bit difficult. @wesm @xhochy  What do you think?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T17:04:36.113+0000",
                    "updated": "2021-06-24T17:04:36.113+0000",
                    "started": "2021-06-24T17:04:36.112+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614625",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/614696",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r658231643\n\n\n\n##########\nFile path: python/pyarrow/tests/test_scalars.py\n##########\n@@ -514,7 +515,7 @@ def test_struct():\n         s['non-existent']\n \n     s = pa.scalar(None, type=ty)\n-    assert list(s) == []\n+    assert list(s) == list(s.keys()) == ['x', 'y']\n\nReview comment:\n       I have no deep experience with scalars so I cannot contribute an opinion here.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-24T19:39:07.120+0000",
                    "updated": "2021-06-24T19:39:07.120+0000",
                    "started": "2021-06-24T19:39:07.120+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "614696",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/616042",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r660380916\n\n\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n\nReview comment:\n       `self.items()` (currently) returns tuples with pyarrow scalars, not python scalars (so it could also be `{k: v.as_py() for k, v in self.items()}`)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-29T08:08:50.196+0000",
                    "updated": "2021-06-29T08:08:50.196+0000",
                    "started": "2021-06-29T08:08:50.196+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "616042",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/616043",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r660381390\n\n\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n+            except KeyError:\n+                raise ValueError(\n+                    \"Converting to Python dictionary is not supported when \"\n+                    \"duplicate field names are present\")\n         else:\n             return None\n \n+    def _as_py_tuple(self):\n+        # a version that returns a tuple instead of dict to support repr/str\n+        # with the presence of duplicate field names\n+        if self.is_valid:\n+            return [(key, self[i].as_py()) for i, key in enumerate(self)]\n\nReview comment:\n       Same here, I need to `as_py()` version of the scalar.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-29T08:09:25.860+0000",
                    "updated": "2021-06-29T08:09:25.860+0000",
                    "started": "2021-06-29T08:09:25.859+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "616043",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/616349",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on a change in pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#discussion_r660380916\n\n\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n\nReview comment:\n       `self.items()` (currently) returns tuples with pyarrow scalars, not python scalars (so it could also be `{k: v.as_py() for k, v in self.items()}`)\n\n##########\nFile path: python/pyarrow/scalar.pxi\n##########\n@@ -652,21 +649,42 @@ cdef class StructScalar(Scalar, collections.abc.Mapping):\n \n         try:\n             return Scalar.wrap(GetResultValue(sp.field(ref)))\n-        except ArrowInvalid:\n+        except ArrowInvalid as exc:\n             if isinstance(key, int):\n-                raise IndexError(key)\n+                raise IndexError(key) from exc\n             else:\n-                raise KeyError(key)\n+                raise KeyError(key) from exc\n \n     def as_py(self):\n         \"\"\"\n         Return this value as a Python dict.\n         \"\"\"\n         if self.is_valid:\n-            return {k: v.as_py() for k, v in self.items()}\n+            try:\n+                return {k: self[k].as_py() for k in self.keys()}\n+            except KeyError:\n+                raise ValueError(\n+                    \"Converting to Python dictionary is not supported when \"\n+                    \"duplicate field names are present\")\n         else:\n             return None\n \n+    def _as_py_tuple(self):\n+        # a version that returns a tuple instead of dict to support repr/str\n+        # with the presence of duplicate field names\n+        if self.is_valid:\n+            return [(key, self[i].as_py()) for i, key in enumerate(self)]\n\nReview comment:\n       Same here, I need to `as_py()` version of the scalar.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-29T13:47:06.379+0000",
                    "updated": "2021-06-29T13:47:06.379+0000",
                    "started": "2021-06-29T13:47:06.379+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "616349",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/618577",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#issuecomment-873915328\n\n\n   Any other comments here? (cc @kszucs)\r\n   \r\n   There is the issue of how we should handle \"null\" struct scalars:\r\n   \r\n   ```\r\n   In [2]: s = pa.scalar(None, type=pa.struct([('a', pa.int64()), ('b', pa.float64())]))\r\n   \r\n   In [3]: s\r\n   Out[3]: <pyarrow.StructScalar: None>\r\n   \r\n   In [4]: s['a']\r\n   Out[4]: <pyarrow.Int64Scalar: None>\r\n   ```\r\n   \r\n   The above is the current behaviour, where you can access a field of a null value, but so that doesn't distinguish from a scalar with null values in the fields:\r\n   \r\n   ```\r\n   In [5]: s2 = pa.scalar({'a': None, 'b': None}, type=pa.struct([('a', pa.int64()), ('b', pa.float64())]))\r\n   \r\n   In [6]: s2\r\n   Out[6]: <pyarrow.StructScalar: {'a': None, 'b': None}>\r\n   \r\n   In [7]: s2['a']\r\n   Out[7]: <pyarrow.Int64Scalar: None>\r\n   ```\r\n   \r\n   But I would leave that discussion out of this PR, I think this PR already fixes some issues and is useful on its own.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-05T08:28:41.740+0000",
                    "updated": "2021-07-05T08:28:41.740+0000",
                    "started": "2021-07-05T08:28:41.740+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "618577",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/618671",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#issuecomment-874153925\n\n\n   +1 for merging as is. Can you rebase first?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-05T14:24:48.297+0000",
                    "updated": "2021-07-05T14:24:48.297+0000",
                    "started": "2021-07-05T14:24:48.297+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "618671",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/618731",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-05T16:25:41.858+0000",
                    "updated": "2021-07-05T16:25:41.858+0000",
                    "started": "2021-07-05T16:25:41.858+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "618731",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/619010",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#issuecomment-874153925\n\n\n   +1 for merging as is. Can you rebase first?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-06T11:00:27.596+0000",
                    "updated": "2021-07-06T11:00:27.596+0000",
                    "started": "2021-07-06T11:00:27.596+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "619010",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/619068",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591#issuecomment-873915328\n\n\n   Any other comments here? (cc @kszucs)\r\n   \r\n   There is the issue of how we should handle \"null\" struct scalars:\r\n   \r\n   ```\r\n   In [2]: s = pa.scalar(None, type=pa.struct([('a', pa.int64()), ('b', pa.float64())]))\r\n   \r\n   In [3]: s\r\n   Out[3]: <pyarrow.StructScalar: None>\r\n   \r\n   In [4]: s['a']\r\n   Out[4]: <pyarrow.Int64Scalar: None>\r\n   ```\r\n   \r\n   The above is the current behaviour, where you can access a field of a null value, but so that doesn't distinguish from a scalar with null values in the fields:\r\n   \r\n   ```\r\n   In [5]: s2 = pa.scalar({'a': None, 'b': None}, type=pa.struct([('a', pa.int64()), ('b', pa.float64())]))\r\n   \r\n   In [6]: s2\r\n   Out[6]: <pyarrow.StructScalar: {'a': None, 'b': None}>\r\n   \r\n   In [7]: s2['a']\r\n   Out[7]: <pyarrow.Int64Scalar: None>\r\n   ```\r\n   \r\n   But I would leave that discussion out of this PR, I think this PR already fixes some issues and is useful on its own.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-06T11:10:31.005+0000",
                    "updated": "2021-07-06T11:10:31.005+0000",
                    "started": "2021-07-06T11:10:31.005+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "619068",
                    "issueId": "13385577"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/worklog/619156",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #10591:\nURL: https://github.com/apache/arrow/pull/10591\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-06T11:24:24.984+0000",
                    "updated": "2021-07-06T11:24:24.984+0000",
                    "started": "2021-07-06T11:24:24.984+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "619156",
                    "issueId": "13385577"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@309ddd13[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@9cf271c[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41dd47e7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@31da6f07[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@244547d1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@8bd8b0a[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@23741785[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4134e6bb[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4f414a83[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2b406dba[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@280b9f68[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4e6cb5ec[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Jul 05 16:25:32 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-07-05T16:25:32.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13158/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-06-24T07:59:58.000+0000",
        "updated": "2021-07-06T11:24:26.000+0000",
        "timeoriginalestimate": null,
        "description": "Broken off from ARROW-9997\r\n\r\nWhen having duplicate fields, the repr fails:\r\n\r\n{code}\r\nIn [28]: s = pa.scalar([('a', 1), ('b', 2), ('a', 3)], pa.struct([('a', 'int64'), ('b', 'int64'), ('a', 'int64')]))\r\n\r\nIn [29]: 0 in s\r\nOut[29]: True\r\n\r\nIn [30]: s\r\n....\r\nKeyError: 'a'\r\n{code}\r\n\r\nIn addition, the contains ({{in}}) operation also shouldn't accept integers (this is also the case for non-duplicate fields)",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Fix repr and contains of StructScalar with duplicate field names",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13385577/comment/17374925",
                    "id": "17374925",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 10591\n[https://github.com/apache/arrow/pull/10591]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-07-05T16:25:32.616+0000",
                    "updated": "2021-07-05T16:25:32.616+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0s92w:",
        "customfield_12314139": null
    }
}