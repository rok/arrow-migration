{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13275064",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064",
    "key": "ARROW-7413",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "dataset",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12346358",
                "id": "12346358",
                "description": "",
                "name": "0.15.1",
                "archived": false,
                "released": true,
                "releaseDate": "2019-11-01"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7413/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 15,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369071",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151\n \n \n   https://issues.apache.org/jira/browse/ARROW-7413\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-09T14:34:48.421+0000",
                    "updated": "2020-01-09T14:34:48.421+0000",
                    "started": "2020-01-09T14:34:48.420+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369071",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369073",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#issuecomment-572589885\n \n \n   @bkietz this is further exposing the PartitionSchemeDiscovery to make it usable from python.\r\n   \r\n   Do we have preference on the API? \r\n   Currently, I made it similar to the C++ API with a static method on the actual (hive/schema) PartitionScheme, returning the base (existing) PartitionSchemeDiscovery object, which can be passed to the option.\r\n   \r\n   cc @kszucs \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-09T14:39:06.945+0000",
                    "updated": "2020-01-09T14:39:06.945+0000",
                    "started": "2020-01-09T14:39:06.945+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369073",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369083",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#issuecomment-572594287\n \n \n   https://issues.apache.org/jira/browse/ARROW-7413\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-09T14:48:49.339+0000",
                    "updated": "2020-01-09T14:48:49.339+0000",
                    "started": "2020-01-09T14:48:49.339+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369083",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365260065\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   IMO `ds.SchemaPartitionSchemeDiscovery(['group', 'key'])` would be better, subclassing `ds.PartitionSchemeDiscovery` would follow the current semantics of the binding.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-10T14:31:03.891+0000",
                    "updated": "2020-01-10T14:31:03.891+0000",
                    "started": "2020-01-10T14:31:03.890+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369867",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369905",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365307886\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   I think the main counter argument for that is that such a `SchemaPartitionSchemeDiscovery` is not needed for the rest, and will have no functionality (the user only needs to pass an instance of the base class to the discovery options). \r\n   \r\n   I seem to recall that @bkietz mentioned that for other classes as well in the python bindings. \r\n   \r\n   Another option would also be a more functional approach in the user facing API, eg a `hive_partition()` function that either constructs an actual PartitionScheme or a PartitionSchemeDiscovery depending on the input.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-10T16:05:50.916+0000",
                    "updated": "2020-01-10T16:05:50.916+0000",
                    "started": "2020-01-10T16:05:50.915+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369905",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369969",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365367076\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   Exposing subclasses of PartitionSchemeDiscovery is indeed not necessary and should be avoided. There's a JIRA up for removing some class hierarchies which *are* currently exposed https://issues.apache.org/jira/browse/ARROW-7391 like PartitionScheme and Expressions.\r\n   \r\n   @jorisvandenbossche I think a single `hive_partition()` function like you describe is ideal; `R` currently does this.  `hive_partition(schema)` -> explicit Scheme` `hive_partition(None) -> Discovery`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-10T18:22:42.577+0000",
                    "updated": "2020-01-10T18:22:42.577+0000",
                    "started": "2020-01-10T18:22:42.576+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369969",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/369976",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365367076\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   Exposing subclasses of PartitionSchemeDiscovery is indeed not necessary and should be avoided. There's a JIRA up for removing some class hierarchies which *are* currently exposed https://issues.apache.org/jira/browse/ARROW-7391 like PartitionScheme and Expressions.\r\n   \r\n   @jorisvandenbossche I think a single `hive_partition()` function like you describe is ideal; R currently does this.  `hive_partition(schema)` -> explicit Scheme, while `hive_partition(None)` -> Discovery. Similarly I'd like to see `ordered_partition(schema)` -> explicit Scheme, `ordered_partition(list_of_names)` -> Discovery.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-10T18:30:33.170+0000",
                    "updated": "2020-01-10T18:30:33.170+0000",
                    "started": "2020-01-10T18:30:33.170+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "369976",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/370057",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365423333\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   I'm not in favor of returning different types with different APIs depending on the function argument. I have intentionally introduced only classes before adding any factory functions (like the open_dataset, or partition_scheme etc.). Returning objects with the appropriate type  does no harm, wrapping them with functions is easy and straightforward.\r\n   \r\n   Could You give me an end-to-end example of the imagined API?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-10T20:45:55.808+0000",
                    "updated": "2020-01-10T20:45:55.808+0000",
                    "started": "2020-01-10T20:45:55.807+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "370057",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/370866",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r365874096\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   I think the \"imagined\" API exists in R already: \r\n   \r\n   https://github.com/apache/arrow/blob/master/r/R/dataset.R\r\n   https://github.com/apache/arrow/blob/master/r/tests/testthat/test-dataset.R\r\n   \r\n   One could argue that you should start with the factory functions and only expose the classes and methods you actually need--anything else is YAGNI. In R, for example, I found that I needed to create HivePartitionScheme and HivePartitionSchemeDiscovery classes in R because `hive_partition()` would return one or the other, but they didn't need any methods defined because the only thing you'd do with either is pass them to a DataSourceDiscovery, which would consume them appropriately. \r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-13T15:44:27.378+0000",
                    "updated": "2020-01-13T15:44:27.378+0000",
                    "started": "2020-01-13T15:44:27.378+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "370866",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371489",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r366248323\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   Getting back to this. One option is to merge as is: it's closest to the C++ API for those low-level classes, and a high-level function like `hive_partitioning()` can be added later in the open_dataset PR? \r\n   (but I also happily implement the additional subclasses to move forward with this)\r\n   \r\n   > I'm not in favor of returning different types with different APIs depending on the function argument.\r\n   \r\n   @kszucs in general I agree with this. However, for a high level user API in this case, I think it's also not great to have multiple functions like both `hive_partitioning(schema)` and `hive_partitioning_factory()`, and both `ordered_partitioning(schema)` and `ordered_partitioning_factory(list_of_names)` (as the result in both cases will be passed to the same keyword in `open_dataset`).\r\n    \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:05:22.387+0000",
                    "updated": "2020-01-14T10:05:22.387+0000",
                    "started": "2020-01-14T10:05:22.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371489",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371510",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r366258575\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n+    assert isinstance(schema_discovery, ds.PartitionSchemeDiscovery)\n+    options.partition_scheme_discovery = schema_discovery\n+\n+    discovery = ds.FileSystemDataSourceDiscovery(\n+        mockfs, paths_or_selector, format, options\n+    )\n+    inspected_schema = discovery.inspect()\n+    # i64/f64 from data, group/key from \"/1/xxx\" and \"/2/yyy\" paths\n+    expected_schema = pa.schema([\n+        (\"i64\", pa.int64()),\n+        (\"f64\", pa.float64()),\n+        (\"group\", pa.int32()),\n+        (\"key\", pa.string()),\n+    ])\n+    assert inspected_schema.remove_metadata().equals(expected_schema)\n \n Review comment:\n   FYI There is a `check_metadata` keyword for Schema.equals.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:25:45.814+0000",
                    "updated": "2020-01-14T10:25:45.814+0000",
                    "started": "2020-01-14T10:25:45.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371510",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371511",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r366259660\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n \n Review comment:\n   Agree. Either way, we should come up with a better API, but we can do that refinement in a follow-up PR.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:27:44.092+0000",
                    "updated": "2020-01-14T10:27:44.092+0000",
                    "started": "2020-01-14T10:27:44.092+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371511",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:28:38.087+0000",
                    "updated": "2020-01-14T10:28:38.087+0000",
                    "started": "2020-01-14T10:28:38.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371512",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371516",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#discussion_r366262981\n \n \n\n ##########\n File path: python/pyarrow/tests/test_dataset.py\n ##########\n @@ -352,3 +352,29 @@ def test_file_system_discovery(mockfs, paths_or_selector):\n     assert isinstance(table, pa.Table)\n     assert len(table) == 10\n     assert table.num_columns == 4\n+\n+\n+def test_partition_scheme_discovery(mockfs):\n+    paths_or_selector = fs.FileSelector('subdir', recursive=True)\n+    format = ds.ParquetFileFormat()\n+\n+    options = ds.FileSystemDiscoveryOptions('subdir')\n+    schema_discovery = ds.SchemaPartitionScheme.discover(['group', 'key'])\n+    assert isinstance(schema_discovery, ds.PartitionSchemeDiscovery)\n+    options.partition_scheme_discovery = schema_discovery\n+\n+    discovery = ds.FileSystemDataSourceDiscovery(\n+        mockfs, paths_or_selector, format, options\n+    )\n+    inspected_schema = discovery.inspect()\n+    # i64/f64 from data, group/key from \"/1/xxx\" and \"/2/yyy\" paths\n+    expected_schema = pa.schema([\n+        (\"i64\", pa.int64()),\n+        (\"f64\", pa.float64()),\n+        (\"group\", pa.int32()),\n+        (\"key\", pa.string()),\n+    ])\n+    assert inspected_schema.remove_metadata().equals(expected_schema)\n \n Review comment:\n   > FYI There is a check_metadata keyword for Schema.equals.\r\n   \r\n   Ah, that's good to know ;)\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:34:07.070+0000",
                    "updated": "2020-01-14T10:34:07.070+0000",
                    "started": "2020-01-14T10:34:07.069+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371516",
                    "issueId": "13275064"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/worklog/371517",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6151: ARROW-7413: [Python] Expose and test the partioning discovery\nURL: https://github.com/apache/arrow/pull/6151#issuecomment-574110520\n \n \n   Thanks, will update the other PR, so can further discuss the higher level user API there.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-01-14T10:34:30.232+0000",
                    "updated": "2020-01-14T10:34:30.232+0000",
                    "started": "2020-01-14T10:34:30.232+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "371517",
                    "issueId": "13275064"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2844146e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6498321a[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6869fd19[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4d441aec[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@395a49e9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6a9fa22b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4d390b54[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@20c7fb65[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4b39fb95[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@5ca08623[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@59c64548[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@464581c6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jan 14 10:28:37 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-01-14T10:28:37.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7413/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2019-12-17T17:38:14.000+0000",
        "updated": "2020-01-14T10:34:30.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python][Dataset] Add tests for PartitionSchemeDiscovery",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/comment/17010713",
                    "id": "17010713",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "[~bkietz] I suppose you are not working on this right now? \r\nI am running into the python bindings for the partition discovery while updating my open_dataset() PR, so can probably also tackle this.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-01-08T14:35:12.114+0000",
                    "updated": "2020-01-08T14:35:12.114+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13275064/comment/17014997",
                    "id": "17014997",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "Issue resolved by pull request 6151\n[https://github.com/apache/arrow/pull/6151]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2020-01-14T10:28:37.162+0000",
                    "updated": "2020-01-14T10:28:37.162+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z09rpk:",
        "customfield_12314139": null
    }
}