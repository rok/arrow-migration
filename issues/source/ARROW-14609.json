{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13410241",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241",
    "key": "ARROW-14609",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14609/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 25,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/710500",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg opened a new pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179\n\n\n   This PR makes {arrow} join error messages triggered by wrong column specification in `by` closer to the {dplyr} ones\r\n   ```\r\n   # dplyr error message\r\n   > left_join(iris, iris, by  = \"made_up_colname\")\r\n   Error: Join columns must be present in data.\r\n   x Problem with `made_up_colname`.\r\n   Run `rlang::last_error()` to see where the error occurred.\r\n   \r\n   # current {arrow} error message\r\n   > left_join(arrow_table(iris), arrow_table(iris), by = \"made_up_colname\")\r\n   Error in handle_join_by(by, x, y) : \r\n     all(names(by) %in% names(x)) is not TRUE\r\n   \r\n   # error message after this PR\r\n   > left_join(arrow_table(iris), arrow_table(iris), by = \"made_up_colname\")\r\n   Error: Join column must be present in data.\r\n   x `made_up_colname` not present in x.\r\n   Run `rlang::last_error()` to see where the error occurred.\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T13:27:40.929+0000",
                    "updated": "2022-01-18T13:27:40.929+0000",
                    "started": "2022-01-18T13:27:40.929+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710500",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/710501",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#issuecomment-1015412111\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T13:28:03.694+0000",
                    "updated": "2022-01-18T13:28:03.694+0000",
                    "started": "2022-01-18T13:28:03.693+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710501",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/710820",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787102302\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,33 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  if (length(missing_x_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_x_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n+    abort(c(message, x = message_x))\n+  }\n+\n+  missing_y_cols <- setdiff(by, names(y))\n+  if (length(missing_y_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_y_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_y <- paste(\n+      oxford_paste(missing_y_cols, quote_symbol = \"`\"),\n+      \"not present in y.\"\n+    )\n+    abort(c(message, x = message_y))\n+  }\n\nReview comment:\n       Would it be possible to accumulate message_x and message_y in parallel and then print them both? This might ultimately simplify this (e.g. the \"join column must be present in data\" would happen once). But more importantly it would give people the feedback about both x and y at the beginning instead of fixing one and then having another pop up.\r\n   \r\n   \n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       The extra wrapping of `()`s is to get the error from a whole dplyr chain, right? (at least, that's what I think https://github.com/r-lib/testthat/issues/1471 is saying). \r\n   \r\n   In these cases, there's not actually a chain, so these should just work (right?)\n\n##########\nFile path: r/tests/testthat/_snaps/dplyr-join.md\n##########\n@@ -0,0 +1,50 @@\n+# Error handling\n+\n+    Code\n+      (expect_error(left_join(arrow_table(example_data), arrow_table(example_data),\n+      by = \"made_up_colname\")))\n+    Output\n+      <error/rlang_error>\n+      Join column must be present in data.\n+      x `made_up_colname` not present in x.\n\nReview comment:\n       The error messages including x/y is a nice touch, though it should be pointed out that does differ from dplyr:\r\n   \r\n   ```\r\n   library(dplyr)\r\n   #> \r\n   #> Attaching package: 'dplyr'\r\n   #> The following objects are masked from 'package:stats':\r\n   #> \r\n   #>     filter, lag\r\n   #> The following objects are masked from 'package:base':\r\n   #> \r\n   #>     intersect, setdiff, setequal, union\r\n   left_join(mtcars, mtcars, by = \"foo\")\r\n   #> Error: Join columns must be present in data.\r\n   #> \u2716 Problem with `foo`.\r\n   ```\r\n   \r\n   Giving the explicit x/y is friendlier though, so I'm happy to keep it.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T19:54:39.166+0000",
                    "updated": "2022-01-18T19:54:39.166+0000",
                    "started": "2022-01-18T19:54:39.165+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710820",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/710883",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787149579\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,33 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  if (length(missing_x_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_x_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n+    abort(c(message, x = message_x))\n+  }\n+\n+  missing_y_cols <- setdiff(by, names(y))\n+  if (length(missing_y_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_y_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_y <- paste(\n+      oxford_paste(missing_y_cols, quote_symbol = \"`\"),\n+      \"not present in y.\"\n+    )\n+    abort(c(message, x = message_y))\n+  }\n\nReview comment:\n       I had a similar thought and I have a hunch this might be the reason for {dplyr} keeping things simpler / a bit more ambiguous. I will look into it. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T21:06:42.700+0000",
                    "updated": "2022-01-18T21:06:42.700+0000",
                    "started": "2022-01-18T21:06:42.699+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710883",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/710902",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787163085\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,33 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  if (length(missing_x_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_x_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n+    abort(c(message, x = message_x))\n+  }\n+\n+  missing_y_cols <- setdiff(by, names(y))\n+  if (length(missing_y_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_y_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_y <- paste(\n+      oxford_paste(missing_y_cols, quote_symbol = \"`\"),\n+      \"not present in y.\"\n+    )\n+    abort(c(message, x = message_y))\n+  }\n\nReview comment:\n       We might need to simplify the header (no more singular/ plural), but that is a minor thing and sacrifice to make for the addition of a second error bullet point. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-18T21:28:31.540+0000",
                    "updated": "2022-01-18T21:28:31.540+0000",
                    "started": "2022-01-18T21:28:31.540+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "710902",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711234",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787564893\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,33 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  if (length(missing_x_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_x_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n+    abort(c(message, x = message_x))\n+  }\n+\n+  missing_y_cols <- setdiff(by, names(y))\n+  if (length(missing_y_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_y_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_y <- paste(\n+      oxford_paste(missing_y_cols, quote_symbol = \"`\"),\n+      \"not present in y.\"\n+    )\n+    abort(c(message, x = message_y))\n+  }\n\nReview comment:\n       Done\r\n   ```\r\n   > left_join(\r\n   +         arrow_table(example_data),\r\n   +         arrow_table(example_data),\r\n   +         by = c(\"made_up_colname1\", \"made_up_colname2\")\r\n   +       )\r\n    Error: Join columns must be present in data.\r\n   x `made_up_colname1` and `made_up_colname2` not present in x.\r\n   x `made_up_colname1` and `made_up_colname2` not present in y.\r\n   Run `rlang::last_error()` to see where the error occurred.\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T09:57:37.409+0000",
                    "updated": "2022-01-19T09:57:37.409+0000",
                    "started": "2022-01-19T09:57:37.409+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711234",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711235",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787565796\n\n\n\n##########\nFile path: r/tests/testthat/_snaps/dplyr-join.md\n##########\n@@ -0,0 +1,50 @@\n+# Error handling\n+\n+    Code\n+      (expect_error(left_join(arrow_table(example_data), arrow_table(example_data),\n+      by = \"made_up_colname\")))\n+    Output\n+      <error/rlang_error>\n+      Join column must be present in data.\n+      x `made_up_colname` not present in x.\n\nReview comment:\n       Yes, I thought have explicit x/y error bullets might be better. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T09:58:30.396+0000",
                    "updated": "2022-01-19T09:58:30.396+0000",
                    "started": "2022-01-19T09:58:30.396+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711235",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711237",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787567978\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       the extra brackets print the output. Without brackets it would look like the example below and we would lose the main reason for using `expect_snapshot()`\r\n   <img width=\"819\" alt=\"image\" src=\"https://user-images.githubusercontent.com/13176361/150107840-d004a6dd-bd8d-4c41-bc86-ea559ed269b4.png\">\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T10:00:33.195+0000",
                    "updated": "2022-01-19T10:00:33.195+0000",
                    "started": "2022-01-19T10:00:33.195+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711237",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711238",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787576778\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       I'd be in favour of keeping those extra brackets `()` in.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T10:09:09.825+0000",
                    "updated": "2022-01-19T10:09:09.825+0000",
                    "started": "2022-01-19T10:09:09.825+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711238",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711314",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787576778\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       I'd be in favour of keeping those extra brackets `()` in.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T11:32:48.598+0000",
                    "updated": "2022-01-19T11:32:48.598+0000",
                    "started": "2022-01-19T11:32:48.597+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711314",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711315",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787567978\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       the extra brackets print the output. Without brackets it would look like the example below and we would lose the main reason for using `expect_snapshot()`\r\n   <img width=\"819\" alt=\"image\" src=\"https://user-images.githubusercontent.com/13176361/150107840-d004a6dd-bd8d-4c41-bc86-ea559ed269b4.png\">\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T11:33:01.351+0000",
                    "updated": "2022-01-19T11:33:01.351+0000",
                    "started": "2022-01-19T11:33:01.351+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711315",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711347",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787675965\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       We could use `expect_snapshot(error =  TRUE)` instead of `expect_snapshot()` + `(expect_error())`, but we lose the `Output` heading - something we could live with. See my [6602362](https://github.com/apache/arrow/pull/12179/commits/660236248de9d4d6abaa2f516053eae44260892c) commit.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T12:00:28.066+0000",
                    "updated": "2022-01-19T12:00:28.066+0000",
                    "started": "2022-01-19T12:00:28.066+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711347",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711349",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787675965\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       We could use `expect_snapshot(error =  TRUE)` instead of `expect_snapshot()` + `(expect_error())`, but we lose the `Output` heading - something we could live with. See my [6602362](https://github.com/apache/arrow/pull/12179/commits/660236248de9d4d6abaa2f516053eae44260892c) commit for the snapshot diff. I think this latest version might be the best balance between readability & conciseness. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T12:05:51.671+0000",
                    "updated": "2022-01-19T12:05:51.671+0000",
                    "started": "2022-01-19T12:05:51.670+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711349",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711482",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paleolimbot commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787927677\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,30 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  missing_y_cols <- setdiff(by, names(y))\n+  message_x <- NULL\n+  message_y <- NULL\n+\n+  if (length(missing_x_cols) > 0) {\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n\nReview comment:\n       ```suggestion\r\n       )\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T16:31:36.167+0000",
                    "updated": "2022-01-19T16:31:36.167+0000",
                    "started": "2022-01-19T16:31:36.167+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711482",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711508",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787969608\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,30 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  missing_y_cols <- setdiff(by, names(y))\n+  message_x <- NULL\n+  message_y <- NULL\n+\n+  if (length(missing_x_cols) > 0) {\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n\nReview comment:\n       \ud83d\udc4d\ud83c\udffb \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T17:14:14.703+0000",
                    "updated": "2022-01-19T17:14:14.703+0000",
                    "started": "2022-01-19T17:14:14.703+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711508",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711703",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r788171888\n\n\n\n##########\nFile path: r/R/dplyr-join.R\n##########\n@@ -117,10 +117,33 @@ handle_join_by <- function(by, x, y) {\n   if (is.null(names(by))) {\n     by <- set_names(by)\n   }\n-  # TODO: nicer messages?\n-  stopifnot(\n-    all(names(by) %in% names(x)),\n-    all(by %in% names(y))\n-  )\n+\n+  missing_x_cols <- setdiff(names(by), names(x))\n+  if (length(missing_x_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_x_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_x <- paste(\n+      oxford_paste(missing_x_cols, quote_symbol = \"`\"),\n+      \"not present in x.\"\n+      )\n+    abort(c(message, x = message_x))\n+  }\n+\n+  missing_y_cols <- setdiff(by, names(y))\n+  if (length(missing_y_cols) > 0) {\n+    message <- paste(\n+      \"Join\",\n+      ngettext(length(missing_y_cols), \"column\", \"columns\"),\n+      \"must be present in data.\"\n+    )\n+    message_y <- paste(\n+      oxford_paste(missing_y_cols, quote_symbol = \"`\"),\n+      \"not present in y.\"\n+    )\n+    abort(c(message, x = message_y))\n+  }\n\nReview comment:\n       Nice! I think this code is also even cleaner than the first version (and has a better behavior!)\n\n##########\nFile path: r/tests/testthat/_snaps/dplyr-join.md\n##########\n@@ -0,0 +1,46 @@\n+# Error handling\n+\n+    Code\n+      left_join(arrow_table(example_data), arrow_table(example_data), by = \"made_up_colname\")\n+    Error <rlang_error>\n+      Join columns must be present in data.\n+      x `made_up_colname` not present in x.\n+      x `made_up_colname` not present in y.\n+\n+---\n+\n+    Code\n+      left_join(arrow_table(example_data), arrow_table(example_data), by = c(int = \"made_up_colname\"))\n+    Error <rlang_error>\n+      Join columns must be present in data.\n+      x `made_up_colname` not present in y.\n+\n+---\n+\n+    Code\n+      left_join(arrow_table(example_data), arrow_table(example_data), by = c(\n+        made_up_colname = \"int\"))\n+    Error <rlang_error>\n+      Join columns must be present in data.\n+      x `made_up_colname` not present in x.\n+\n+---\n+\n+    Code\n+      left_join(arrow_table(example_data), arrow_table(example_data), by = c(\n+        \"made_up_colname1\", \"made_up_colname2\"))\n+    Error <rlang_error>\n+      Join columns must be present in data.\n+      x `made_up_colname1` and `made_up_colname2` not present in x.\n+      x `made_up_colname1` and `made_up_colname2` not present in y.\n+\n+---\n+\n+    Code\n+      left_join(arrow_table(example_data), arrow_table(example_data), by = c(\n+        made_up_colname1 = \"made_up_colname2\"))\n+    Error <rlang_error>\n+      Join columns must be present in data.\n+      x `made_up_colname1` not present in x.\n+      x `made_up_colname2` not present in y.\n\nReview comment:\n       Oh this is super nice + clear and someone won't be left fixing `made_up_colname1` and then getting hit with `made_up_colname2`\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,8 +90,56 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join columns must be present in data\"\n+  )\n+\n+  # we print both message_x and message_y with an unnamed `by` vector\n\nReview comment:\n       I like the comments here that explain _why_ these tests are here / what is being checked \u2014 though part of me wonders if this is showing the downside to snapshots (not having the error here in the code showing what we are looking). \r\n   \r\n   Let's keep the snapshots for now (especially cause greping the `rlang::abort()` messages is not super fun). Is there a Jira already for adding something to our devdocs about how to use snapshots/our philosophy on how to review them/limitations (e.g. C++ tests not working well)/that kind of stuff? We shouldn't expand the scope of this PR for just that, but it would be good to make a jira that adds that info so we all agree how we will use them going forward.\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,9 +90,57 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join column must be present in data\"\n   )\n+  expect_snapshot({\n+    (expect_error(\n\nReview comment:\n       Yup, I like `expect_snapshot(error = TRUE)` and it looks like that's the way that the testthat developers are recommending moving forward too.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-19T22:09:03.228+0000",
                    "updated": "2022-01-19T22:09:03.228+0000",
                    "started": "2022-01-19T22:09:03.228+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711703",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711951",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r787565796\n\n\n\n##########\nFile path: r/tests/testthat/_snaps/dplyr-join.md\n##########\n@@ -0,0 +1,50 @@\n+# Error handling\n+\n+    Code\n+      (expect_error(left_join(arrow_table(example_data), arrow_table(example_data),\n+      by = \"made_up_colname\")))\n+    Output\n+      <error/rlang_error>\n+      Join column must be present in data.\n+      x `made_up_colname` not present in x.\n\nReview comment:\n       Yes, I thought having explicit x/y error bullets might be better. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-20T10:08:07.035+0000",
                    "updated": "2022-01-20T10:08:07.035+0000",
                    "started": "2022-01-20T10:08:07.034+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711951",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/711954",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r788617132\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,8 +90,56 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join columns must be present in data\"\n+  )\n+\n+  # we print both message_x and message_y with an unnamed `by` vector\n\nReview comment:\n       I think a [relevant Jira](https://issues.apache.org/jira/browse/ARROW-14458) already exists. We might not need another one, but rather update it to reflect current thinking (i.e. use `expect_snapshot(error = TRUE)` where possible, the future addition of classed errors to cpp11, etc). What do you think?  \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-20T10:21:28.450+0000",
                    "updated": "2022-01-20T10:21:28.450+0000",
                    "started": "2022-01-20T10:21:28.450+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "711954",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/712172",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r788940238\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -90,8 +90,56 @@ test_that(\"Error handling\", {\n     left_tab %>%\n       left_join(to_join, by = \"not_a_col\") %>%\n       collect(),\n-    \"all(names(by) %in% names(x)) is not TRUE\",\n-    fixed = TRUE\n+    \"Join columns must be present in data\"\n+  )\n+\n+  # we print both message_x and message_y with an unnamed `by` vector\n\nReview comment:\n       That Jira is great, please to update it to reflect this thinking\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-20T16:31:55.134+0000",
                    "updated": "2022-01-20T16:31:55.134+0000",
                    "started": "2022-01-20T16:31:55.133+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "712172",
                    "issueId": "13410241"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/worklog/712175",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12179:\nURL: https://github.com/apache/arrow/pull/12179#discussion_r788941464\n\n\n\n##########\nFile path: r/tests/testthat/test-parquet.R\n##########\n@@ -218,7 +218,7 @@ test_that(\"ParquetFileWriter raises an error for non-OutputStream sink\", {\n   # ARROW-9946\n   expect_error(\n     ParquetFileWriter$create(schema = sch, sink = tempfile()),\n-    regex = \"OutputStream\"\n+    regexp = \"OutputStream\"\n\nReview comment:\n       Good catch!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-20T16:33:05.563+0000",
                    "updated": "2022-01-20T16:33:05.563+0000",
                    "started": "2022-01-20T16:33:05.563+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "712175",
                    "issueId": "13410241"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 15000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4e1b6c2a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@a21a172[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@432e8573[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@44838655[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21189584[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@79cc2c3b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4e7e2b6c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1697bdd8[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7346be3b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6b73e99c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@54e99ad5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7f3b94ed[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15000,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jan 20 16:33:55 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-01-20T16:33:55.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14609/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-11-05T12:09:43.000+0000",
        "updated": "2022-01-22T12:51:39.000+0000",
        "timeoriginalestimate": null,
        "description": "We should use the dplyr error message which is clear when the \"by\" argument to joins is not correctly specified.\r\n\r\n{code:r}\r\n> left_join(iris, iris, by  = \"made_up_colname\")\r\nError: Join columns must be present in data.\r\nx Problem with `made_up_colname`.\r\nRun `rlang::last_error()` to see where the error occurred.\r\n\r\n> left_join(arrow_table(iris), arrow_table(iris), by = \"made_up_colname\")\r\nError in handle_join_by(by, x, y) : \r\n  all(names(by) %in% names(x)) is not TRUE\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] left_join by argument error message mismatch",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13410241/comment/17479497",
                    "id": "17479497",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 12179\n[https://github.com/apache/arrow/pull/12179]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-20T16:33:55.351+0000",
                    "updated": "2022-01-20T16:33:55.351+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0wh54:",
        "customfield_12314139": null
    }
}