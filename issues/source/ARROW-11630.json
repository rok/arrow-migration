{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13358659",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659",
    "key": "ARROW-11630",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sundyli",
            "name": "sundyli",
            "key": "sundyli",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34046",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34046",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34046",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34046"
            },
            "displayName": "benwang li",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sundyli",
            "name": "sundyli",
            "key": "sundyli",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34046",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34046",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34046",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34046"
            },
            "displayName": "benwang li",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sundyli",
            "name": "sundyli",
            "key": "sundyli",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34046",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34046",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34046",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34046"
            },
            "displayName": "benwang li",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 28800,
            "total": 28800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 28800,
            "total": 28800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11630/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 48,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559077",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li opened a new pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602\n\n\n   - Introduce `limit: Option<usize>` for sort functions, then we can use [partial_sort](https://crates.io/crates/partial_sort) to achieve better performance in queries with limit & sort. Datafusion can use it later if it can push up the limit to the sort plan.\r\n   - Introduce [pdqsort](https://crates.io/crates/pdqsort)  for primitive array sorting. \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-28T14:05:03.983+0000",
                    "updated": "2021-02-28T14:05:03.983+0000",
                    "started": "2021-02-28T14:05:03.983+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559077",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559078",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-787457715\n\n\n   https://issues.apache.org/jira/browse/ARROW-11630\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-28T14:05:27.382+0000",
                    "updated": "2021-02-28T14:05:27.382+0000",
                    "started": "2021-02-28T14:05:27.382+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559078",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559079",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-787460272\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=h1) Report\n   > Merging [#9602](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=desc) (85439c1) into [master](https://codecov.io/gh/apache/arrow/commit/5ae63f8ec0c14d5e871aa79d90e5d163b369e704?el=desc) (5ae63f8) will **decrease** coverage by `0.02%`.\n   > The diff coverage is `60.24%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9602/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9602      +/-   ##\n   ==========================================\n   - Coverage   82.32%   82.30%   -0.03%     \n   ==========================================\n     Files         245      245              \n     Lines       56383    56555     +172     \n   ==========================================\n   + Hits        46419    46546     +127     \n   - Misses       9964    10009      +45     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/arrow/src/compute/kernels/sort.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL3NvcnQucnM=) | `91.10% <60.00%> (-2.46%)` | :arrow_down: |\n   | [rust/datafusion/src/physical\\_plan/sort.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL3NvcnQucnM=) | `90.22% <100.00%> (+0.05%)` | :arrow_up: |\n   | [rust/arrow/src/datatypes/field.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvZGF0YXR5cGVzL2ZpZWxkLnJz) | `55.47% <0.00%> (-0.66%)` | :arrow_down: |\n   | [...integration-testing/src/flight\\_server\\_scenarios.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy5ycw==) | `0.00% <0.00%> (\u00f8)` | |\n   | [...-testing/src/flight\\_server\\_scenarios/middleware.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9taWRkbGV3YXJlLnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [...ng/src/flight\\_server\\_scenarios/auth\\_basic\\_proto.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9hdXRoX2Jhc2ljX3Byb3RvLnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [...ng/src/flight\\_server\\_scenarios/integration\\_test.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9pbnRlZ3JhdGlvbl90ZXN0LnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [rust/arrow/src/csv/reader.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY3N2L3JlYWRlci5ycw==) | `93.17% <0.00%> (+0.02%)` | :arrow_up: |\n   | [rust/arrow/src/compute/kernels/cast.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL2Nhc3QucnM=) | `97.33% <0.00%> (+0.03%)` | :arrow_up: |\n   | [rust/arrow/src/datatypes/schema.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvZGF0YXR5cGVzL3NjaGVtYS5ycw==) | `73.39% <0.00%> (+0.76%)` | :arrow_up: |\n   | ... and [2 more](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=footer). Last update [5ae63f8...85439c1](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-28T14:22:58.356+0000",
                    "updated": "2021-02-28T14:22:58.356+0000",
                    "started": "2021-02-28T14:22:58.355+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559079",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559248",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-787460272\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=h1) Report\n   > Merging [#9602](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=desc) (06c503c) into [master](https://codecov.io/gh/apache/arrow/commit/5ae63f8ec0c14d5e871aa79d90e5d163b369e704?el=desc) (5ae63f8) will **increase** coverage by `0.03%`.\n   > The diff coverage is `82.68%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9602/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9602      +/-   ##\n   ==========================================\n   + Coverage   82.32%   82.36%   +0.03%     \n   ==========================================\n     Files         245      245              \n     Lines       56383    56661     +278     \n   ==========================================\n   + Hits        46419    46668     +249     \n   - Misses       9964     9993      +29     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/arrow/src/compute/kernels/sort.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL3NvcnQucnM=) | `93.60% <82.62%> (+0.04%)` | :arrow_up: |\n   | [rust/datafusion/src/physical\\_plan/sort.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL3NvcnQucnM=) | `90.22% <100.00%> (+0.05%)` | :arrow_up: |\n   | [rust/arrow/src/datatypes/field.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvZGF0YXR5cGVzL2ZpZWxkLnJz) | `55.47% <0.00%> (-0.66%)` | :arrow_down: |\n   | [...integration-testing/src/flight\\_server\\_scenarios.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy5ycw==) | `0.00% <0.00%> (\u00f8)` | |\n   | [...-testing/src/flight\\_server\\_scenarios/middleware.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9taWRkbGV3YXJlLnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [...ng/src/flight\\_server\\_scenarios/auth\\_basic\\_proto.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9hdXRoX2Jhc2ljX3Byb3RvLnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [...ng/src/flight\\_server\\_scenarios/integration\\_test.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9pbnRlZ3JhdGlvbi10ZXN0aW5nL3NyYy9mbGlnaHRfc2VydmVyX3NjZW5hcmlvcy9pbnRlZ3JhdGlvbl90ZXN0LnJz) | `0.00% <0.00%> (\u00f8)` | |\n   | [rust/arrow/src/csv/reader.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY3N2L3JlYWRlci5ycw==) | `93.17% <0.00%> (+0.02%)` | :arrow_up: |\n   | [rust/arrow/src/compute/kernels/cast.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL2Nhc3QucnM=) | `97.33% <0.00%> (+0.03%)` | :arrow_up: |\n   | [rust/arrow/src/datatypes/schema.rs](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvZGF0YXR5cGVzL3NjaGVtYS5ycw==) | `73.39% <0.00%> (+0.76%)` | :arrow_up: |\n   | ... and [2 more](https://codecov.io/gh/apache/arrow/pull/9602/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=footer). Last update [5ae63f8...06c503c](https://codecov.io/gh/apache/arrow/pull/9602?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T08:02:38.904+0000",
                    "updated": "2021-03-01T08:02:38.904+0000",
                    "started": "2021-03-01T08:02:38.904+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559248",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559552",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r584928250\n\n\n\n##########\nFile path: rust/arrow/Cargo.toml\n##########\n@@ -51,6 +51,8 @@ flatbuffers = \"^0.8\"\n hex = \"0.4\"\n prettytable-rs = { version = \"0.8.0\", optional = true }\n lexical-core = \"^0.7\"\n+partial_sort = \"0.1.1\"\n+pdqsort = \"1.0.3\"\n\nReview comment:\n       I am -1 on this. Either add a feature gate or something else.\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -36,8 +36,12 @@ use TimeUnit::*;\n ///\n /// Returns an `ArrowError::ComputeError(String)` if the array type is either unsupported by `sort_to_indices` or `take`.\n ///\n-pub fn sort(values: &ArrayRef, options: Option<SortOptions>) -> Result<ArrayRef> {\n-    let indices = sort_to_indices(values, options)?;\n+pub fn sort(\n+    values: &ArrayRef,\n+    options: Option<SortOptions>,\n+    limit: Option<usize>,\n\nReview comment:\n       I think that this should be done on a separate function instead of adding another parameter to this one. It would also allow to feature-gate said function with the two new dependencies.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T19:37:32.040+0000",
                    "updated": "2021-03-01T19:37:32.040+0000",
                    "started": "2021-03-01T19:37:32.040+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559552",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559572",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r584928250\n\n\n\n##########\nFile path: rust/arrow/Cargo.toml\n##########\n@@ -51,6 +51,8 @@ flatbuffers = \"^0.8\"\n hex = \"0.4\"\n prettytable-rs = { version = \"0.8.0\", optional = true }\n lexical-core = \"^0.7\"\n+partial_sort = \"0.1.1\"\n+pdqsort = \"1.0.3\"\n\nReview comment:\n       I am -0 on this without any benchmarks justifying this. Can't we at least feature-gate this?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-01T21:07:09.513+0000",
                    "updated": "2021-03-01T21:07:09.513+0000",
                    "started": "2021-03-01T21:07:09.513+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559572",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559719",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r585214440\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -36,8 +36,12 @@ use TimeUnit::*;\n ///\n /// Returns an `ArrowError::ComputeError(String)` if the array type is either unsupported by `sort_to_indices` or `take`.\n ///\n-pub fn sort(values: &ArrayRef, options: Option<SortOptions>) -> Result<ArrayRef> {\n-    let indices = sort_to_indices(values, options)?;\n+pub fn sort(\n+    values: &ArrayRef,\n+    options: Option<SortOptions>,\n+    limit: Option<usize>,\n\nReview comment:\n       Ok, I will introduce `partial_sort` with `limit` parameter.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:07:49.328+0000",
                    "updated": "2021-03-02T03:07:49.328+0000",
                    "started": "2021-03-02T03:07:49.327+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559719",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559724",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the benche results about partial_sort in arrow are:\r\n    \r\n   \r\n   ```\r\n   sort 2^10                     time:   [156.26 us 156.97 us 157.88 us]\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^10               time:   [133.73 us 134.42 us 135.27 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [113.61 us 114.21 us 114.85 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [66.455 us 66.932 us 67.504 us]\r\n   sort nulls 2^12 limit 1000    time:   [65.030 us 65.218 us 65.412 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:24:16.850+0000",
                    "updated": "2021-03-02T03:24:16.850+0000",
                    "started": "2021-03-02T03:24:16.850+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559724",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559725",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the [benche results about partial_sort in arrow](https://github.com/apache/arrow/blob/f19fc1644a07cefcf584d450ad70c5708926c252/rust/arrow/benches/sort_kernel.rs#L76-L106) are:\r\n    \r\n   \r\n   ```\r\n   sort 2^10                     time:   [156.26 us 156.97 us 157.88 us]\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^10               time:   [133.73 us 134.42 us 135.27 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [113.61 us 114.21 us 114.85 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [66.455 us 66.932 us 67.504 us]\r\n   sort nulls 2^12 limit 1000    time:   [65.030 us 65.218 us 65.412 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:25:56.639+0000",
                    "updated": "2021-03-02T03:25:56.639+0000",
                    "started": "2021-03-02T03:25:56.638+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559725",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559729",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the [benche results about partial_sort in arrow](https://github.com/apache/arrow/blob/f19fc1644a07cefcf584d450ad70c5708926c252/rust/arrow/benches/sort_kernel.rs#L76-L106) are:\r\n    \r\n   \r\n   ```\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [113.61 us 114.21 us 114.85 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [66.455 us 66.932 us 67.504 us]\r\n   sort nulls 2^12 limit 1000    time:   [65.030 us 65.218 us 65.412 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:27:28.400+0000",
                    "updated": "2021-03-02T03:27:28.400+0000",
                    "started": "2021-03-02T03:27:28.400+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559729",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559731",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches in my pc.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the [benche results about partial_sort in arrow](https://github.com/apache/arrow/blob/f19fc1644a07cefcf584d450ad70c5708926c252/rust/arrow/benches/sort_kernel.rs#L76-L106) are:\r\n    \r\n   \r\n   ```\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [113.61 us 114.21 us 114.85 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [66.455 us 66.932 us 67.504 us]\r\n   sort nulls 2^12 limit 1000    time:   [65.030 us 65.218 us 65.412 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:28:37.169+0000",
                    "updated": "2021-03-02T03:28:37.169+0000",
                    "started": "2021-03-02T03:28:37.169+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559731",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559733",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches in my pc.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the [benche results about partial_sort in arrow](https://github.com/apache/arrow/blob/f19fc1644a07cefcf584d450ad70c5708926c252/rust/arrow/benches/sort_kernel.rs#L76-L106) are:\r\n    \r\n   \r\n   ```\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [645.91 us 654.36 us 663.78 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [76.281 us 77.907 us 79.783 us]\r\n   sort nulls 2^12 limit 1000    time:   [258.98 us 260.32 us 262.24 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:30:04.705+0000",
                    "updated": "2021-03-02T03:30:04.705+0000",
                    "started": "2021-03-02T03:30:04.704+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559733",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/559734",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li edited a comment on pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#issuecomment-788550187\n\n\n   I removed `pdqsort`, because the performance didn't show any improvement during the benches in my pc.\r\n   Added a separate function `partial_sort `as @jorgecarleitao suggested.\r\n   \r\n   I did not find any other `partial_sort` function in Rust like std::partial_sort in c++.  So I created [one](https://github.com/sundy-li/partial_sort).\r\n   \r\n   And the [benche results about partial_sort in arrow](https://github.com/apache/arrow/blob/dc3167e3826177af1a6feec516a528a4ee38c674/rust/arrow/benches/sort_kernel.rs#L76-L106) are:\r\n    \r\n   \r\n   ```\r\n   sort 2^12                     time:   [753.58 us 755.43 us 758.14 us]\r\n   sort nulls 2^12               time:   [633.41 us 635.28 us 637.51 us]\r\n   \r\n   sort 2^12 limit 10            time:   [49.246 us 49.820 us 50.667 us]\r\n   sort 2^12 limit 100           time:   [115.11 us 116.26 us 117.76 us]\r\n   sort 2^12 limit 1000          time:   [645.91 us 654.36 us 663.78 us]\r\n   sort nulls 2^12 limit 10      time:   [66.283 us 66.725 us 67.347 us]\r\n   sort nulls 2^12 limit 100     time:   [76.281 us 77.907 us 79.783 us]\r\n   sort nulls 2^12 limit 1000    time:   [258.98 us 260.32 us 262.24 us]\r\n   \r\n   \r\n   ```\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-02T03:31:12.086+0000",
                    "updated": "2021-03-02T03:31:12.086+0000",
                    "started": "2021-03-02T03:31:12.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "559734",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560388",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586321776\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -517,20 +650,32 @@ where\n             },\n         );\n \n-    if !options.descending {\n-        valids.sort_by(|a, b| cmp_array(a.1.as_ref(), b.1.as_ref()))\n+    let mut len = values.len();\n+    let descending = options.descending;\n+\n+    if let Some(size) = limit {\n+        len = size.min(len);\n+    }\n+\n+    // we are not using partial_sort here, because array is ArrayRef. Something is not working good in that.\n\nReview comment:\n       What does \"not working good\" mean here?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-03T11:03:11.382+0000",
                    "updated": "2021-03-03T11:03:11.382+0000",
                    "started": "2021-03-03T11:03:11.382+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560388",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560391",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586323373\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       Does `partial_sort` have a fast path when `len` is the length of the array?  The pattern in this block is repeated a few times, if we could just use `partial_sort` it could be simplified to a simple `if let` that updates `len`?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-03T11:05:40.083+0000",
                    "updated": "2021-03-03T11:05:40.083+0000",
                    "started": "2021-03-03T11:05:40.083+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560391",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560392",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "paddyhoran commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586324951\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       Sorry not \"fast path\" but would the performance be the same as `sort_by`?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-03T11:07:57.553+0000",
                    "updated": "2021-03-03T11:07:57.553+0000",
                    "started": "2021-03-03T11:07:57.553+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560392",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560779",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586975774\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       > Sorry not \"fast path\" but would the performance be the same as `sort_by`?\r\n   \r\n   I'm afraid not. The sort function in rust is merge sort, it is slightly faster than the heap sort for larger sets.\r\n   But it requires twice the memory of the heap sort because of the second array. \r\n   \r\n   ```\r\n   sort 2^12               time:   [799.70 us 806.41 us 814.15 us]\r\n   sort 2^12 limit 2^12     time:   [1.2848 ms 1.3012 ms 1.3229 ms]\r\n   \r\n   sort nulls 2^12         time:   [647.20 us 649.27 us 651.61 us]\r\n   sort nulls 2^12 limit 2^12   time:   [780.17 us 788.48 us 798.04 us]\r\n   ```\r\n   \r\n   We can make a new function to reduce the repeated patterns.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-04T02:04:11.127+0000",
                    "updated": "2021-03-04T02:04:11.127+0000",
                    "started": "2021-03-04T02:04:11.127+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560779",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560780",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586975774\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       > Sorry not \"fast path\" but would the performance be the same as `sort_by`?\r\n   \r\n   I'm afraid not. The sort function in rust is merge sort, it is slightly faster than the heap sort for larger sets to sort all elements.\r\n   But it requires twice the memory of the heap sort because of the second array. \r\n   \r\n   ```\r\n   sort 2^12               time:   [799.70 us 806.41 us 814.15 us]\r\n   sort 2^12 limit 2^12     time:   [1.2848 ms 1.3012 ms 1.3229 ms]\r\n   \r\n   sort nulls 2^12         time:   [647.20 us 649.27 us 651.61 us]\r\n   sort nulls 2^12 limit 2^12   time:   [780.17 us 788.48 us 798.04 us]\r\n   ```\r\n   \r\n   We can make a new function to reduce the repeated patterns.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-04T02:04:35.238+0000",
                    "updated": "2021-03-04T02:04:35.238+0000",
                    "started": "2021-03-04T02:04:35.238+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560780",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560782",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586975774\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       > Sorry not \"fast path\" but would the performance be the same as `sort_by`?\r\n   \r\n   I'm afraid not. The sort function in rust is merge sort, it is slightly faster than the heap sort for larger sets to sort all elements. \r\n   But it requires twice the memory of the heap sort because of the second array. \r\n   \r\n   ```\r\n   sort 2^12               time:   [799.70 us 806.41 us 814.15 us]\r\n   sort 2^12 limit 2^12     time:   [1.2848 ms 1.3012 ms 1.3229 ms]\r\n   \r\n   sort nulls 2^12         time:   [647.20 us 649.27 us 651.61 us]\r\n   sort nulls 2^12 limit 2^12   time:   [780.17 us 788.48 us 798.04 us]\r\n   ```\r\n   \r\n   We can make a new function to reduce the repeated patterns or make partial_sort fallback to default sort when  limit is the len.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-04T02:05:42.314+0000",
                    "updated": "2021-03-04T02:05:42.314+0000",
                    "started": "2021-03-04T02:05:42.313+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560782",
                    "issueId": "13358659"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/worklog/560784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sundy-li commented on a change in pull request #9602:\nURL: https://github.com/apache/arrow/pull/9602#discussion_r586975774\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/sort.rs\n##########\n@@ -278,12 +347,27 @@ fn sort_boolean(\n     let valids_len = valids.len();\n     let nulls_len = nulls.len();\n \n-    if !descending {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1));\n-    } else {\n-        valids.sort_by(|a, b| a.1.cmp(&b.1).reverse());\n-        // reverse to keep a stable ordering\n-        nulls.reverse();\n+    let mut len = values.len();\n+    match limit {\n+        Some(limit) => {\n+            len = limit.min(len);\n+            if !descending {\n+                valids.partial_sort(len, |a, b| cmp(a.1, b.1));\n\nReview comment:\n       > Sorry not \"fast path\" but would the performance be the same as `sort_by`?\r\n   \r\n   I'm afraid not. The sort function in rust is merge sort, it is slightly faster than the heap sort for larger sets to sort all elements. \r\n   But it requires twice the memory of the heap sort because of the second array. \r\n   \r\n   ```\r\n   sort 2^12               time:   [799.70 us 806.41 us 814.15 us]\r\n   sort 2^12 limit 2^12     time:   [1.2848 ms 1.3012 ms 1.3229 ms]\r\n   \r\n   sort nulls 2^12         time:   [647.20 us 649.27 us 651.61 us]\r\n   sort nulls 2^12 limit 2^12   time:   [780.17 us 788.48 us 798.04 us]\r\n   ```\r\n   \r\n   We can make a new function to reduce the repeated patterns or make partial_sort fallback to default sort when  limit equals to len.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-04T02:05:59.347+0000",
                    "updated": "2021-03-04T02:05:59.347+0000",
                    "started": "2021-03-04T02:05:59.347+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "560784",
                    "issueId": "13358659"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 28800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5c72c9fb[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21c23048[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3375ea0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@33476efe[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5696cd74[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1c4737af[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@253ca8d9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2d04121e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4d1997a7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@68c62be4[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@28fc3c45[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@25e54fa6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 28800,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 16 10:23:44 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-03-16T10:23:43.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11630/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-02-15T13:40:07.000+0000",
        "updated": "2021-03-16T11:16:31.000+0000",
        "timeoriginalestimate": null,
        "description": "\u00a0\r\n\r\n1.\u00a0 Use partial_sort for queries with limit expression.\u00a0\r\n{code:java}\r\n//\u4ee3\u7801\u5360\u4f4d\u7b26\r\nselect number from table order by numbder limit 3;{code}\r\nWe can use partial_sort (can be implemented in BinaryHeap).\u00a0This can significantly improve the sorting performance\u00a0in sort && limit queries\r\n\u00a0\r\n\r\nRefer: [https://github.com/ClickHouse/ClickHouse/blob/f669a9f97ad850edb77d10e51cd0c41a4af737bf/src/Columns/ColumnVector.cpp#L137-L145]\u00a0[\u00a0|https://github.com/ClickHouse/ClickHouse/blob/f669a9f97ad850edb77d10e51cd0c41a4af737bf/src/Columns/ColumnVector.cpp#L137-L145]\r\n\r\n\r\n\r\n\r\n\r\n2. Use pqdsort for Primitive arrays. this is already done in ClickHouse, Refer:\u00a0[https://github.com/ClickHouse/ClickHouse/blob/f669a9f97ad850edb77d10e51cd0c41a4af737bf/src/Columns/ColumnVector.cpp#L188-L191]\r\n\r\n\u00a0\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "8h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 28800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] Introduce partial_sort and limit option for sort kernel",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13358659/comment/17302405",
                    "id": "17302405",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9602\n[https://github.com/apache/arrow/pull/9602]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-03-16T10:23:44.034+0000",
                    "updated": "2021-03-16T10:23:44.034+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nomw:",
        "customfield_12314139": null
    }
}