{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13378487",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487",
    "key": "ARROW-12791",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12791/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 30,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/596827",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic opened a new pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-14T18:32:30.811+0000",
                    "updated": "2021-05-14T18:32:30.811+0000",
                    "started": "2021-05-14T18:32:30.811+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "596827",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/596838",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#issuecomment-841447425\n\n\n   https://issues.apache.org/jira/browse/ARROW-12791\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-14T19:10:52.160+0000",
                    "updated": "2021-05-14T19:10:52.160+0000",
                    "started": "2021-05-14T19:10:52.160+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "596838",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598586",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634387573\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n+      } else {\n+        stop(e)\n\nReview comment:\n       Does this `stop()` return the call trace now?\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       I can see arguments on both sides of this: would it be helpful to include the original error message as well as our new nicer one? \r\n   \r\n   On the one hand: it's more content and content that some (most?) won't have the context to know what to do with, but on the other it makes clear what the message is form the c++ if someone is familiar with that or does have some reason to suspect that the parquet files are parquet, but were mangled it would tell them that a bit more clearly. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T13:40:56.558+0000",
                    "updated": "2021-05-18T13:40:56.558+0000",
                    "started": "2021-05-18T13:40:56.558+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598586",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598628",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634482956\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n+      } else {\n+        stop(e)\n\nReview comment:\n       I think so? When I click \"Show Traceback\" in RStudio, I get this;\r\n   \r\n   ```\r\n   > ds <- open_dataset(csv_dir, partitioning = \"part\")\r\n    Error: Looks like these are not parquet files, did you mean to specify a 'format'? \r\n   6. stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", \r\n       call. = FALSE) at dataset.R#103\r\n   5. value[[3L]](cond) \r\n   4. tryCatchOne(expr, names, parentenv, handlers[[1L]]) \r\n   3. tryCatchList(expr, classes, parentenv, handlers) \r\n   2. tryCatch(factory$Finish(schema, isTRUE(unify_schemas)), error = function(e) {\r\n       msg <- conditionMessage(e)\r\n       if (grep(\"Parquet magic bytes not found in footer\", msg)) {\r\n           stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\",  ... at dataset.R#97\r\n   1. open_dataset(csv_dir, partitioning = \"part\") \r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T15:13:58.929+0000",
                    "updated": "2021-05-18T15:13:58.929+0000",
                    "started": "2021-05-18T15:13:58.929+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598628",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598637",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634492852\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n+      } else {\n+        stop(e)\n\nReview comment:\n       Ah, I was thinking about the line 105 stop. I'm not certain if passing `e` there will have the same behavior as it would now (for errors that aren't this parquet issue, like providing a non-existent directory). Currently (on the master branch) that looks like:\r\n   \r\n   ```\r\n   > ds <- open_dataset(\"~/does/not/exist\") \r\n   Error: IOError: Cannot list directory '/Users/jkeane/does/not/exist'. Detail: [errno 2] No such file or directory\r\n   ```\r\n   \r\n   But with this change it might be something like the following without also adding `call. = FALSE` here too (though I'm not certain of that!)\r\n   \r\n   ```\r\n   Error in open_dataset() : Error: IOError: Cannot list directory '/Users/jkeane/does/not/exist'. Detail: [errno 2] No such file or directory\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T15:23:37.422+0000",
                    "updated": "2021-05-18T15:23:37.422+0000",
                    "started": "2021-05-18T15:23:37.422+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598637",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598657",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634525212\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       Ergh, you make a good point.  I'm tempted to abandon this PR and just solve this via documentation as I don't think there's a good solution in the code.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T15:59:46.946+0000",
                    "updated": "2021-05-18T15:59:46.946+0000",
                    "started": "2021-05-18T15:59:46.945+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598657",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598659",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634528056\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       I actually think \"just\" the message you have here is better than the status quo (and better than docs). But I think you could `paste` together the two messages and be good if you wanted to surface both?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T16:02:30.925+0000",
                    "updated": "2021-05-18T16:02:30.925+0000",
                    "started": "2021-05-18T16:02:30.925+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598659",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598676",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634570064\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       I don't like the C++ error messages being exposed to the end user, so I'm with you on that.  I'm now a bit concerned that the error can be triggered by multiple things and it's not easy to work out which - and I don't want the error message to mislead the user.  I'll have a think about if there's a rephrasing that fixes this.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T16:38:05.637+0000",
                    "updated": "2021-05-18T16:38:05.637+0000",
                    "started": "2021-05-18T16:38:05.636+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598676",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634572440\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       Hmmm, what are the other things that trigger it?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T16:41:16.005+0000",
                    "updated": "2021-05-18T16:41:16.005+0000",
                    "started": "2021-05-18T16:41:16.005+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598678",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598681",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#issuecomment-843344849\n\n\n   https://github.com/apache/arrow/commit/ace2bfc160e049b4edc7ffb55081cfb7210d6e43 and https://github.com/apache/arrow/commit/aa27b4c71c61e7264974c5eb076d0241ed1ddfe0 can be a model for your solution here\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T16:44:38.269+0000",
                    "updated": "2021-05-18T16:44:38.269+0000",
                    "started": "2021-05-18T16:44:38.268+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598681",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598688",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634581473\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       Oh, as you mentioned in your initial comment: if the files are Parquet files but mangled.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T16:53:32.168+0000",
                    "updated": "2021-05-18T16:53:32.168+0000",
                    "started": "2021-05-18T16:53:32.168+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598688",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598697",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634591911\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       Oh, I think that's totally fine to have a message like this after that. The helpfulness might be a bit of a distraction, but I think most people who get this error message will either be in need of the helpfulness or be knowledgeable enough about their underlying data to not get too distracted by it.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T17:08:47.585+0000",
                    "updated": "2021-05-18T17:08:47.585+0000",
                    "started": "2021-05-18T17:08:47.584+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598697",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598704",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634594017\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       So as an exploratory question, \"If this message is universally better than the C++ message should the C++ message be changed?  Why or why not?\"\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T17:11:53.575+0000",
                    "updated": "2021-05-18T17:11:53.575+0000",
                    "started": "2021-05-18T17:11:53.575+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598704",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598707",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634597442\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       The error isn't wrong, it's just not informative at this higher layer. \"Invalid parquet magic bytes\" is meaningful if you yourself called read_parquet(file), but in this case, you weren't intending to read a parquet file because they aren't parquet files. \n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       The error isn't wrong, it's just not informative at this particular higher layer. \"Invalid parquet magic bytes\" is meaningful if you yourself called read_parquet(file), but in this case, you weren't intending to read a parquet file because they aren't parquet files. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T17:16:48.274+0000",
                    "updated": "2021-05-18T17:16:48.274+0000",
                    "started": "2021-05-18T17:16:48.273+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598707",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598715",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634604005\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       @nealrichardson is \ud83d\udcaf on that, it's also a slightly different audience than that C++ error is targeted at\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T17:26:33.974+0000",
                    "updated": "2021-05-18T17:26:33.974+0000",
                    "started": "2021-05-18T17:26:33.974+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598715",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598733",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634619864\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       It seems at least there is some room for improvement.  The transition from `read_parquet` to `open_dataset` is at least partially in C++ as well (you are calling `DatasetFactory::Finish` here).  Although the terms are slightly different `e.g. fragments vs sources`.  So I think we could update the C++ error to something like \"Dataset creation failed.  The fragment <fragment-to-string> did not match the expected <format> format: <child_error>\"\r\n   \r\n   Concretely, \"Dataset creation failed.  The fragment '/2019/July/myfile.csv' did not match the expected 'parquet'' format: Parquet magic bytes not found in footer\".\r\n   \r\n   I worry this kind of error translation is a slippery slope.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T17:50:27.355+0000",
                    "updated": "2021-05-18T17:50:27.355+0000",
                    "started": "2021-05-18T17:50:27.354+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598733",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598841",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634743196\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       I can understand where you're coming from @westonpace - I definitely don't think we should necessarily have error translation for every single C++ error in the package or make that into a pattern we use.\r\n   \r\n   Just to provide a little more context, the reason for opening the original ticket was that when there is a call to `open_dataset()`, if the format is anything other than \"parquet\", the user needs to pass that format through as an optional argument, but it's not immediately clear from looking at the docs for `open_dataset()` that this is the case.  I'm going to add some examples to the documentation that show how to open files of different formats with `open_dataset()`, but the info in the error is intended as an extra hint in case the behaviour is unintuitive.\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T20:58:29.435+0000",
                    "updated": "2021-05-18T20:58:29.435+0000",
                    "started": "2021-05-18T20:58:29.435+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598841",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598846",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r634748152\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n\nReview comment:\n       I've added ARROW-12827 to cleanup the C++ exceptions at some point but I agree that this PR could still be very viable on its own.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T21:06:33.215+0000",
                    "updated": "2021-05-18T21:06:33.215+0000",
                    "started": "2021-05-18T21:06:33.214+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598846",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/598870",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#issuecomment-843578991\n\n\n   > [ace2bfc](https://github.com/apache/arrow/commit/ace2bfc160e049b4edc7ffb55081cfb7210d6e43) and [aa27b4c](https://github.com/apache/arrow/commit/aa27b4c71c61e7264974c5eb076d0241ed1ddfe0) can be a model for your solution here\r\n   \r\n   Thanks, @nealrichardson, have now updated the PR to follow this pattern!\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-18T21:34:30.193+0000",
                    "updated": "2021-05-18T21:34:30.193+0000",
                    "started": "2021-05-18T21:34:30.193+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "598870",
                    "issueId": "13378487"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/worklog/599347",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10326:\nURL: https://github.com/apache/arrow/pull/10326#discussion_r635436898\n\n\n\n##########\nFile path: r/R/dataset.R\n##########\n@@ -93,8 +93,19 @@ open_dataset <- function(sources,\n     return(dataset___UnionDataset__create(sources, schema))\n   }\n   factory <- DatasetFactory$create(sources, partitioning = partitioning, ...)\n-  # Default is _not_ to inspect/unify schemas\n-  factory$Finish(schema, isTRUE(unify_schemas))\n+  \n+  tryCatch(\n+    # Default is _not_ to inspect/unify schemas\n+    factory$Finish(schema, isTRUE(unify_schemas)),\n+    error = function (e) {\n+      msg <- conditionMessage(e)\n+      if(grep(\"Parquet magic bytes not found in footer\", msg)){\n+        stop(\"Looks like these are not parquet files, did you mean to specify a 'format'?\", call. = FALSE)\n+      } else {\n+        stop(e)\n\nReview comment:\n       Now I've updated the error to match the patterns mentioned by @nealrichardson below, so I think that resolves this.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-19T17:15:09.146+0000",
                    "updated": "2021-05-19T17:15:09.146+0000",
                    "started": "2021-05-19T17:15:09.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "599347",
                    "issueId": "13378487"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 18000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@323e89d1[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@fda03[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6c9f8360[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@123e9332[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d8aa50e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7879ef05[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@686de7e9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@e2c5ed5[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@464628cb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@71f0f6c1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@762505b9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1a93375e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Jun 04 20:11:54 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-06-04T20:11:54.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12791/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-05-14T13:25:41.000+0000",
        "updated": "2021-06-04T20:11:58.000+0000",
        "timeoriginalestimate": null,
        "description": "When I call the following code:\r\n\r\n\u00a0\r\n{code:java}\r\ntf <- tempfile()\r\ndir.create(tf)\r\non.exit(unlink(tf))\r\nwrite_csv_arrow(mtcars[1:5,], file.path(tf, \"file1.csv\"))\r\nwrite_csv_arrow(mtcars[6:11,], file.path(tf, \"file2.csv\"))\r\nds <- open_dataset(c(file.path(tf, \"file1.csv\"), file.path(tf, \"file2.csv\")))\r\n{code}\r\nI get the following error:\u00a0\r\n{code:java}\r\n Error: IOError: Could not open parquet input source '/tmp/RtmpSug6P8/file714931976ac54/file1.csv': Invalid: Parquet magic bytes not found in footer. Either the file is corrupted or this is not a parquet file.\r\n{code}\r\nHowever, in the documentation for open_dataset(), there is nothing saying that the input source cannot be a CSV or must be a Parquet file.\u00a0\u00a0 \r\n\r\nI think this is due to calling DataSetFactory$Finish() when schema is NULL and input files have no inherent schema (i.e. are CSVs).",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Better error handling for DatasetFactory$Finish() when no format specified",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/comment/17344631",
                    "id": "17344631",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Judging from the error message, it's because \"parquet\" is the default file format, and those aren't Parquet files. https://arrow.apache.org/docs/r/reference/dataset_factory.html",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-05-14T14:44:18.818+0000",
                    "updated": "2021-05-14T14:44:18.818+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/comment/17344779",
                    "id": "17344779",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "You could try to catch the \"Parquet magic bytes not found in footer\" error message inside open_dataset() and return a different/helpful message like \"Looks like these are not parquet files, did you mean to specify a 'format'?\" or something.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-05-14T17:28:17.754+0000",
                    "updated": "2021-05-14T17:28:17.754+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378487/comment/17357597",
                    "id": "17357597",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 10326\n[https://github.com/apache/arrow/pull/10326]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-06-04T20:11:54.438+0000",
                    "updated": "2021-06-04T20:11:54.438+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z0r1f4:",
        "customfield_12314139": null
    }
}