{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13380896",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896",
    "key": "ARROW-12903",
    "fields": {
        "parent": {
            "id": "13329760",
            "key": "ARROW-10117",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13329760",
            "fields": {
                "summary": "[C++] Implement work-stealing scheduler / multiple queues in ThreadPool",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                    "description": "The issue is open and ready for the assignee to start work on it.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                    "name": "Open",
                    "id": "1",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                        "id": 2,
                        "key": "new",
                        "colorName": "blue-gray",
                        "name": "To Do"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                    "id": "4",
                    "description": "An improvement or enhancement to an existing feature or task.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                    "name": "Improvement",
                    "subtask": false,
                    "avatarId": 21140
                }
            }
        },
        "fixVersions": [],
        "resolution": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "name": "Open",
            "id": "1",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                "id": 2,
                "key": "new",
                "colorName": "blue-gray",
                "name": "To Do"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 5400,
            "total": 5400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12903/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 9,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/603389",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace opened a new pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421\n\n\n   See JIRA for rationale (I also added a comment to the benchmark itself)\r\n   \r\n   Even without any changes to the thread pools you should be able to see some speedup from ideal scheduling.  With the changes being introduced in the work stealing PRs the speedup is even more stark.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-28T03:47:37.888+0000",
                    "updated": "2021-05-28T03:47:37.888+0000",
                    "started": "2021-05-28T03:47:37.888+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "603389",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/603390",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#issuecomment-850090015\n\n\n   https://issues.apache.org/jira/browse/ARROW-12903\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-28T03:47:53.101+0000",
                    "updated": "2021-05-28T03:47:53.101+0000",
                    "started": "2021-05-28T03:47:53.100+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "603390",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/604367",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#discussion_r642886129\n\n\n\n##########\nFile path: cpp/src/arrow/util/thread_pool.h\n##########\n@@ -288,6 +288,10 @@ class ARROW_EXPORT ThreadPool : public Executor {\n   // tasks are finished.\n   Status Shutdown(bool wait = true);\n \n+  // Waits for the thread pool to reach a quiet state where all workers are\n\nReview comment:\n       \"Wait\"\n\n##########\nFile path: cpp/src/arrow/util/thread_pool_benchmark.cc\n##########\n@@ -103,6 +103,52 @@ static void ThreadPoolSpawn(benchmark::State& state) {  // NOLINT non-const refe\n   state.SetItemsProcessed(state.iterations() * nspawns);\n }\n \n+// The ThreadPoolSpawn benchmark submits all tasks from a single outside thread.  This\n+// ends up causing a worst-case scenario for the current simple thread pool.  All threads\n+// compete over the task queue mutex trying to grab the next thread off the queue and the\n+// result is a large amount of contention.\n+//\n+// By spreading out the scheduling across multiple threads we can help reduce that\n+// contention.  This benchmark demonstrates the ideal case where we are able to perfectly\n+// partition the scheduling across the available threads.\n+//\n+// Both situations could be encountered (the thread pool can't choose how it is used) but\n+// by having both benchmarks we can express the importance of distributed scheduling.\n+static void ThreadPoolIdealSpawn(benchmark::State& state) {  // NOLINT non-const reference\n+  const auto nthreads = static_cast<int>(state.range(0));\n+  const auto workload_size = static_cast<int32_t>(state.range(1));\n+\n+  Workload workload(workload_size);\n+\n+  // Spawn enough tasks to make the pool start up overhead negligible\n+  const int32_t nspawns = 200000000 / workload_size + 1;\n+  const int32_t nspawns_per_thread = nspawns / nthreads;\n+\n+  for (auto _ : state) {\n+    state.PauseTiming();\n+    std::shared_ptr<ThreadPool> pool;\n+    pool = *ThreadPool::Make(nthreads);\n+    state.ResumeTiming();\n+\n+    for (int32_t i = 0; i < nthreads; ++i) {\n+      // Pass the task by reference to avoid copying it around\n+      ABORT_NOT_OK(pool->Spawn([&pool, &workload, nspawns_per_thread] {\n+        for (int32_t j = 0; j < nspawns_per_thread; j++) {\n+          ABORT_NOT_OK(pool->Spawn(std::ref(workload)));\n+        }\n+      }));\n+    }\n+\n+    // Wait for all tasks to finish\n+    pool->WaitForIdle();\n\nReview comment:\n       What's the point, since you're calling `Shutdown(wait=true)` just below?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-01T08:20:40.058+0000",
                    "updated": "2021-06-01T08:20:40.058+0000",
                    "started": "2021-06-01T08:20:40.058+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604367",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/604909",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#issuecomment-852682551\n\n\n   Just adding the benchmark...\r\n   \r\n   ```\r\n   ThreadPoolSpawn/threads:1/task_cost:1000/real_time         104576026 ns     39527736 ns            7 items_per_second=1.91249M/s\r\n   ThreadPoolSpawn/threads:2/task_cost:1000/real_time          81736943 ns     69631881 ns            8 items_per_second=2.44689M/s\r\n   ThreadPoolSpawn/threads:4/task_cost:1000/real_time         395577537 ns    337000146 ns            2 items_per_second=505.592k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:1000/real_time         326650393 ns    290524204 ns            2 items_per_second=612.278k/s\r\n   ThreadPoolSpawn/threads:1/task_cost:10000/real_time         81345849 ns      2355243 ns            8 items_per_second=245.876k/s\r\n   ThreadPoolSpawn/threads:2/task_cost:10000/real_time         43399109 ns      2694481 ns           16 items_per_second=460.862k/s\r\n   ThreadPoolSpawn/threads:4/task_cost:10000/real_time         22975768 ns      3457033 ns           31 items_per_second=870.526k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:10000/real_time         21717680 ns     14331911 ns           37 items_per_second=920.955k/s\r\n   ThreadPoolSpawn/threads:1/task_cost:100000/real_time        81517332 ns       270745 ns            8 items_per_second=24.5469k/s\r\n   ThreadPoolSpawn/threads:2/task_cost:100000/real_time        41615534 ns       281452 ns           17 items_per_second=48.083k/s\r\n   ThreadPoolSpawn/threads:4/task_cost:100000/real_time        21324149 ns       316989 ns           33 items_per_second=93.8373k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:100000/real_time        12702954 ns       443910 ns           55 items_per_second=157.522k/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:1000/real_time    107253606 ns        91704 ns            6 items_per_second=1.86475M/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:1000/real_time     88176114 ns       117639 ns            8 items_per_second=2.2682M/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:1000/real_time     86717904 ns       107266 ns            8 items_per_second=2.30634M/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:1000/real_time     98762117 ns       209733 ns            7 items_per_second=2.02508M/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:10000/real_time    84566727 ns        64819 ns            8 items_per_second=236.511k/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:10000/real_time    46885981 ns        70276 ns           15 items_per_second=426.588k/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:10000/real_time    27807860 ns        94742 ns           26 items_per_second=719.257k/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:10000/real_time    16994645 ns       148328 ns           41 items_per_second=1.1769M/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:100000/real_time   81094164 ns        52531 ns            8 items_per_second=24.675k/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:100000/real_time   42196762 ns        85439 ns           16 items_per_second=47.4207k/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:100000/real_time   22380385 ns       120278 ns           32 items_per_second=89.4086k/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:100000/real_time   12873517 ns       180938 ns           56 items_per_second=155.435k/s\r\n   ```\r\n   \r\n   Early results from work-stealing (note, impl:1 is the single queue implementation, it benefits quite a bit from the generalized refactor (#10401) which shrinks the critical section considerably)...\r\n   \r\n   ```\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:1000/real_time         109095290 ns     45507459 ns            6 items_per_second=1.83327M/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:1000/real_time          84445897 ns     73408467 ns            8 items_per_second=2.36839M/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:1000/real_time         384508473 ns    331111388 ns            2 items_per_second=520.147k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:1000/real_time         340298964 ns    310431590 ns            2 items_per_second=587.721k/s\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:10000/real_time         84889601 ns      2927850 ns            8 items_per_second=235.612k/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:10000/real_time         46962168 ns      4429182 ns           16 items_per_second=425.896k/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:10000/real_time         27891032 ns      5498450 ns           24 items_per_second=717.112k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:10000/real_time         23484115 ns     15697174 ns           29 items_per_second=851.682k/s\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:100000/real_time        86121178 ns       466594 ns            8 items_per_second=23.2347k/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:100000/real_time        47425209 ns       563522 ns           14 items_per_second=42.1928k/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:100000/real_time        26281335 ns       621087 ns           29 items_per_second=76.1377k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:100000/real_time        17440052 ns       774646 ns           48 items_per_second=114.736k/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:1000/real_time         103240478 ns     38378988 ns            7 items_per_second=1.93723M/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:1000/real_time          75653969 ns     52775243 ns            9 items_per_second=2.64363M/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:1000/real_time         377306923 ns    319204178 ns            2 items_per_second=530.075k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:1000/real_time         299943726 ns    268612631 ns            2 items_per_second=666.795k/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:10000/real_time         90443729 ns      4378503 ns            8 items_per_second=221.143k/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:10000/real_time         44763896 ns      2994083 ns           15 items_per_second=446.811k/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:10000/real_time         23488252 ns      3392981 ns           28 items_per_second=851.532k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:10000/real_time         17048732 ns      5469744 ns           45 items_per_second=1.17317M/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:100000/real_time        90217957 ns       547220 ns            8 items_per_second=22.1796k/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:100000/real_time        46026938 ns       456690 ns           15 items_per_second=43.4745k/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:100000/real_time        26673468 ns       570498 ns           28 items_per_second=75.0184k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:100000/real_time        13344305 ns       605292 ns           52 items_per_second=149.952k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:1000/real_time     79428262 ns       101330 ns            9 items_per_second=2.51801M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:1000/real_time     41236138 ns       139716 ns           17 items_per_second=4.85011M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:1000/real_time     25092115 ns       204669 ns           28 items_per_second=7.97063M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:1000/real_time     25280289 ns       348096 ns           32 items_per_second=7.9113M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:10000/real_time    12125072 ns        94012 ns           49 items_per_second=1.64956M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:10000/real_time     6073941 ns       114892 ns           89 items_per_second=3.29276M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:10000/real_time     5748868 ns       173750 ns          125 items_per_second=3.47895M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:10000/real_time     9328825 ns       595124 ns          108 items_per_second=2.14389M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:100000/real_time    2958410 ns        85393 ns          229 items_per_second=676.377k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:100000/real_time    3074567 ns       191386 ns          235 items_per_second=650.498k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:100000/real_time    2770940 ns       260583 ns          235 items_per_second=721.777k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:100000/real_time    1502805 ns       173022 ns          446 items_per_second=1.33085M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:1000/real_time     85477504 ns       110078 ns            9 items_per_second=2.33981M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:1000/real_time     44590546 ns       134688 ns           15 items_per_second=4.48526M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:1000/real_time     26524082 ns       176142 ns           24 items_per_second=7.54032M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:1000/real_time     28468596 ns       355124 ns           43 items_per_second=7.02528M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:10000/real_time    10248307 ns        85681 ns           53 items_per_second=1.95164M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:10000/real_time     5843059 ns       104370 ns          133 items_per_second=3.42286M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:10000/real_time     6790626 ns       193317 ns          100 items_per_second=2.94524M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:10000/real_time     9542556 ns       623649 ns          118 items_per_second=2.09587M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:100000/real_time    3225593 ns       101590 ns          209 items_per_second=620.351k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:100000/real_time    3129998 ns       186755 ns          219 items_per_second=638.978k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:100000/real_time    5807119 ns       254434 ns          100 items_per_second=344.405k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:100000/real_time    7648492 ns       453787 ns           91 items_per_second=261.489k/s\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T03:15:21.621+0000",
                    "updated": "2021-06-02T03:15:21.621+0000",
                    "started": "2021-06-02T03:15:21.621+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604909",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/604910",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace edited a comment on pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#issuecomment-852682551\n\n\n   Just adding the benchmark...\r\n   \r\n   ```\r\n   ThreadPoolSpawn/threads:1/task_cost:1000/real_time         104576026 ns     39527736 ns            7 items_per_second=1.91249M/s\r\n   ThreadPoolSpawn/threads:2/task_cost:1000/real_time          81736943 ns     69631881 ns            8 items_per_second=2.44689M/s\r\n   ThreadPoolSpawn/threads:4/task_cost:1000/real_time         395577537 ns    337000146 ns            2 items_per_second=505.592k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:1000/real_time         326650393 ns    290524204 ns            2 items_per_second=612.278k/s\r\n   ThreadPoolSpawn/threads:1/task_cost:10000/real_time         81345849 ns      2355243 ns            8 items_per_second=245.876k/s\r\n   ThreadPoolSpawn/threads:2/task_cost:10000/real_time         43399109 ns      2694481 ns           16 items_per_second=460.862k/s\r\n   ThreadPoolSpawn/threads:4/task_cost:10000/real_time         22975768 ns      3457033 ns           31 items_per_second=870.526k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:10000/real_time         21717680 ns     14331911 ns           37 items_per_second=920.955k/s\r\n   ThreadPoolSpawn/threads:1/task_cost:100000/real_time        81517332 ns       270745 ns            8 items_per_second=24.5469k/s\r\n   ThreadPoolSpawn/threads:2/task_cost:100000/real_time        41615534 ns       281452 ns           17 items_per_second=48.083k/s\r\n   ThreadPoolSpawn/threads:4/task_cost:100000/real_time        21324149 ns       316989 ns           33 items_per_second=93.8373k/s\r\n   ThreadPoolSpawn/threads:8/task_cost:100000/real_time        12702954 ns       443910 ns           55 items_per_second=157.522k/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:1000/real_time    107253606 ns        91704 ns            6 items_per_second=1.86475M/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:1000/real_time     88176114 ns       117639 ns            8 items_per_second=2.2682M/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:1000/real_time     86717904 ns       107266 ns            8 items_per_second=2.30634M/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:1000/real_time     98762117 ns       209733 ns            7 items_per_second=2.02508M/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:10000/real_time    84566727 ns        64819 ns            8 items_per_second=236.511k/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:10000/real_time    46885981 ns        70276 ns           15 items_per_second=426.588k/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:10000/real_time    27807860 ns        94742 ns           26 items_per_second=719.257k/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:10000/real_time    16994645 ns       148328 ns           41 items_per_second=1.1769M/s\r\n   ThreadPoolIdealSpawn/threads:1/task_cost:100000/real_time   81094164 ns        52531 ns            8 items_per_second=24.675k/s\r\n   ThreadPoolIdealSpawn/threads:2/task_cost:100000/real_time   42196762 ns        85439 ns           16 items_per_second=47.4207k/s\r\n   ThreadPoolIdealSpawn/threads:4/task_cost:100000/real_time   22380385 ns       120278 ns           32 items_per_second=89.4086k/s\r\n   ThreadPoolIdealSpawn/threads:8/task_cost:100000/real_time   12873517 ns       180938 ns           56 items_per_second=155.435k/s\r\n   ```\r\n   \r\n   Early results from work-stealing (note, impl:1 is the single queue implementation, it benefits quite a bit from the generalized refactor (#10401) which shrinks the critical section)...\r\n   \r\n   ```\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:1000/real_time         109095290 ns     45507459 ns            6 items_per_second=1.83327M/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:1000/real_time          84445897 ns     73408467 ns            8 items_per_second=2.36839M/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:1000/real_time         384508473 ns    331111388 ns            2 items_per_second=520.147k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:1000/real_time         340298964 ns    310431590 ns            2 items_per_second=587.721k/s\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:10000/real_time         84889601 ns      2927850 ns            8 items_per_second=235.612k/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:10000/real_time         46962168 ns      4429182 ns           16 items_per_second=425.896k/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:10000/real_time         27891032 ns      5498450 ns           24 items_per_second=717.112k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:10000/real_time         23484115 ns     15697174 ns           29 items_per_second=851.682k/s\r\n   ThreadPoolSpawn/impl:1/threads:1/task_cost:100000/real_time        86121178 ns       466594 ns            8 items_per_second=23.2347k/s\r\n   ThreadPoolSpawn/impl:1/threads:2/task_cost:100000/real_time        47425209 ns       563522 ns           14 items_per_second=42.1928k/s\r\n   ThreadPoolSpawn/impl:1/threads:4/task_cost:100000/real_time        26281335 ns       621087 ns           29 items_per_second=76.1377k/s\r\n   ThreadPoolSpawn/impl:1/threads:8/task_cost:100000/real_time        17440052 ns       774646 ns           48 items_per_second=114.736k/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:1000/real_time         103240478 ns     38378988 ns            7 items_per_second=1.93723M/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:1000/real_time          75653969 ns     52775243 ns            9 items_per_second=2.64363M/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:1000/real_time         377306923 ns    319204178 ns            2 items_per_second=530.075k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:1000/real_time         299943726 ns    268612631 ns            2 items_per_second=666.795k/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:10000/real_time         90443729 ns      4378503 ns            8 items_per_second=221.143k/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:10000/real_time         44763896 ns      2994083 ns           15 items_per_second=446.811k/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:10000/real_time         23488252 ns      3392981 ns           28 items_per_second=851.532k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:10000/real_time         17048732 ns      5469744 ns           45 items_per_second=1.17317M/s\r\n   ThreadPoolSpawn/impl:2/threads:1/task_cost:100000/real_time        90217957 ns       547220 ns            8 items_per_second=22.1796k/s\r\n   ThreadPoolSpawn/impl:2/threads:2/task_cost:100000/real_time        46026938 ns       456690 ns           15 items_per_second=43.4745k/s\r\n   ThreadPoolSpawn/impl:2/threads:4/task_cost:100000/real_time        26673468 ns       570498 ns           28 items_per_second=75.0184k/s\r\n   ThreadPoolSpawn/impl:2/threads:8/task_cost:100000/real_time        13344305 ns       605292 ns           52 items_per_second=149.952k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:1000/real_time     79428262 ns       101330 ns            9 items_per_second=2.51801M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:1000/real_time     41236138 ns       139716 ns           17 items_per_second=4.85011M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:1000/real_time     25092115 ns       204669 ns           28 items_per_second=7.97063M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:1000/real_time     25280289 ns       348096 ns           32 items_per_second=7.9113M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:10000/real_time    12125072 ns        94012 ns           49 items_per_second=1.64956M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:10000/real_time     6073941 ns       114892 ns           89 items_per_second=3.29276M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:10000/real_time     5748868 ns       173750 ns          125 items_per_second=3.47895M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:10000/real_time     9328825 ns       595124 ns          108 items_per_second=2.14389M/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:1/task_cost:100000/real_time    2958410 ns        85393 ns          229 items_per_second=676.377k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:2/task_cost:100000/real_time    3074567 ns       191386 ns          235 items_per_second=650.498k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:4/task_cost:100000/real_time    2770940 ns       260583 ns          235 items_per_second=721.777k/s\r\n   ThreadPoolIdealSpawn/impl:1/threads:8/task_cost:100000/real_time    1502805 ns       173022 ns          446 items_per_second=1.33085M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:1000/real_time     85477504 ns       110078 ns            9 items_per_second=2.33981M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:1000/real_time     44590546 ns       134688 ns           15 items_per_second=4.48526M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:1000/real_time     26524082 ns       176142 ns           24 items_per_second=7.54032M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:1000/real_time     28468596 ns       355124 ns           43 items_per_second=7.02528M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:10000/real_time    10248307 ns        85681 ns           53 items_per_second=1.95164M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:10000/real_time     5843059 ns       104370 ns          133 items_per_second=3.42286M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:10000/real_time     6790626 ns       193317 ns          100 items_per_second=2.94524M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:10000/real_time     9542556 ns       623649 ns          118 items_per_second=2.09587M/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:1/task_cost:100000/real_time    3225593 ns       101590 ns          209 items_per_second=620.351k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:2/task_cost:100000/real_time    3129998 ns       186755 ns          219 items_per_second=638.978k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:4/task_cost:100000/real_time    5807119 ns       254434 ns          100 items_per_second=344.405k/s\r\n   ThreadPoolIdealSpawn/impl:2/threads:8/task_cost:100000/real_time    7648492 ns       453787 ns           91 items_per_second=261.489k/s\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T03:15:36.159+0000",
                    "updated": "2021-06-02T03:15:36.159+0000",
                    "started": "2021-06-02T03:15:36.159+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604910",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/604911",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#discussion_r643622911\n\n\n\n##########\nFile path: cpp/src/arrow/util/thread_pool_benchmark.cc\n##########\n@@ -103,6 +103,52 @@ static void ThreadPoolSpawn(benchmark::State& state) {  // NOLINT non-const refe\n   state.SetItemsProcessed(state.iterations() * nspawns);\n }\n \n+// The ThreadPoolSpawn benchmark submits all tasks from a single outside thread.  This\n+// ends up causing a worst-case scenario for the current simple thread pool.  All threads\n+// compete over the task queue mutex trying to grab the next thread off the queue and the\n+// result is a large amount of contention.\n+//\n+// By spreading out the scheduling across multiple threads we can help reduce that\n+// contention.  This benchmark demonstrates the ideal case where we are able to perfectly\n+// partition the scheduling across the available threads.\n+//\n+// Both situations could be encountered (the thread pool can't choose how it is used) but\n+// by having both benchmarks we can express the importance of distributed scheduling.\n+static void ThreadPoolIdealSpawn(benchmark::State& state) {  // NOLINT non-const reference\n+  const auto nthreads = static_cast<int>(state.range(0));\n+  const auto workload_size = static_cast<int32_t>(state.range(1));\n+\n+  Workload workload(workload_size);\n+\n+  // Spawn enough tasks to make the pool start up overhead negligible\n+  const int32_t nspawns = 200000000 / workload_size + 1;\n+  const int32_t nspawns_per_thread = nspawns / nthreads;\n+\n+  for (auto _ : state) {\n+    state.PauseTiming();\n+    std::shared_ptr<ThreadPool> pool;\n+    pool = *ThreadPool::Make(nthreads);\n+    state.ResumeTiming();\n+\n+    for (int32_t i = 0; i < nthreads; ++i) {\n+      // Pass the task by reference to avoid copying it around\n+      ABORT_NOT_OK(pool->Spawn([&pool, &workload, nspawns_per_thread] {\n+        for (int32_t j = 0; j < nspawns_per_thread; j++) {\n+          ABORT_NOT_OK(pool->Spawn(std::ref(workload)));\n+        }\n+      }));\n+    }\n+\n+    // Wait for all tasks to finish\n+    pool->WaitForIdle();\n\nReview comment:\n       At this point we cannot know that all the tasks have been spawned.  If I call `Shutdown(wait=true)` then a slow spawner will fail because `SpawnReal` returns `Status::Invalid` if `please_shutdown_` is `true`.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T03:19:08.269+0000",
                    "updated": "2021-06-02T03:19:08.269+0000",
                    "started": "2021-06-02T03:19:08.268+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604911",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/604912",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#discussion_r643623285\n\n\n\n##########\nFile path: cpp/src/arrow/util/thread_pool.h\n##########\n@@ -288,6 +288,10 @@ class ARROW_EXPORT ThreadPool : public Executor {\n   // tasks are finished.\n   Status Shutdown(bool wait = true);\n \n+  // Waits for the thread pool to reach a quiet state where all workers are\n\nReview comment:\n       Fixed.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T03:20:12.584+0000",
                    "updated": "2021-06-02T03:20:12.584+0000",
                    "started": "2021-06-02T03:20:12.583+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604912",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/623418",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace closed pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-16T05:01:42.494+0000",
                    "updated": "2021-07-16T05:01:42.494+0000",
                    "started": "2021-07-16T05:01:42.494+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623418",
                    "issueId": "13380896"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/worklog/623419",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #10421:\nURL: https://github.com/apache/arrow/pull/10421#issuecomment-881178238\n\n\n   Closing for now to keep PR queue clean.  Will reopen when we revisit work scheduling.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-16T05:01:45.748+0000",
                    "updated": "2021-07-16T05:01:45.748+0000",
                    "started": "2021-07-16T05:01:45.747+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "623419",
                    "issueId": "13380896"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 5400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6b594859[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@61a2075c[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@359f9131[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@44f6f839[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@59eb528[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@39c4bb9f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@709bb38f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@35fba95[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@73986823[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6f9c3d8c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4236fc3b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3cc37dfa[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 5400,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jul 12 14:04:45 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": null,
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12903/watchers",
            "watchCount": 2,
            "isWatching": true
        },
        "created": "2021-05-28T03:26:29.000+0000",
        "updated": "2022-07-12T14:04:45.000+0000",
        "timeoriginalestimate": null,
        "description": "The benchmark ThreadPoolSpawn (in thread_pool_benchmark.cc) is used to help understand the cost of adding a new thread task and to know when it is worth it / not worth it to schedule additional work.\u00a0 For example, it seems that for small (1000) task sizes we start to lose the benefit of threads in as few as 2 threads.\r\n\r\nHowever, this benchmark is actually demonstrating a worst-case scenario in terms of \"scheuduling\" overhead.\u00a0 Without changing the thread pool implementation at all we can considerably improve the efficiency of this benchmark.\u00a0 This Jira is to add an alternative best-case scenario to better help understand the cost of new thread tasks.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 5400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Create new thread pool benchmark demonstrating the \"scheduling\" bottleneck",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13380896/comment/17565730",
                    "id": "17565730",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "body": "This issue was last updated over 90 days ago, which may be an indication it is no longer being actively worked. To better reflect the current state, the issue is being unassigned. Please feel free to re-take assignment of the issue if it is being actively worked, or if you plan to start that work soon.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "created": "2022-07-12T14:04:45.315+0000",
                    "updated": "2022-07-12T14:04:45.315+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0rg9s:",
        "customfield_12314139": null
    }
}