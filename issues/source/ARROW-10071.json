{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13328955",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955",
    "key": "ARROW-10071",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=romainfrancois",
            "name": "romainfrancois",
            "key": "romainfrancois",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=romainfrancois&avatarId=35092",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=romainfrancois&avatarId=35092",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=romainfrancois&avatarId=35092",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=romainfrancois&avatarId=35092"
            },
            "displayName": "Romain Francois",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10071/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 18,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/489505",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois opened a new pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246\n\n\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   \r\n   a <- Array$create(1:10)\r\n   tf <- tempfile()\r\n   saveRDS(a, tf)\r\n   \r\n   b <- readRDS(tf)\r\n   b$length()\r\n   #> Error in Array__length(self): Invalid <Array>, external pointer to null\r\n   ```\r\n   \r\n   <sup>Created on 2020-09-23 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0.9001)</sup>\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-23T09:52:03.075+0000",
                    "updated": "2020-09-23T09:52:03.075+0000",
                    "started": "2020-09-23T09:52:03.075+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "489505",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/489507",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#issuecomment-697259565\n\n\n   https://issues.apache.org/jira/browse/ARROW-10071\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-23T09:52:32.815+0000",
                    "updated": "2020-09-23T09:52:32.815+0000",
                    "started": "2020-09-23T09:52:32.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "489507",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/489610",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r493663218\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       If we're checking for nullptr here, can we remove the `shared_ptr_is_null` check inside the `shared_ptr()` constructor? Then we can just `$new()` to create the R6 objects.\n\n##########\nFile path: r/tests/testthat/test-arrow.R\n##########\n@@ -47,3 +47,12 @@ r_only({\n     )\n   })\n })\n+\n+test_that(\"arrow gracefully fails to load objects from other sessions (ARROW-10071)\", {\n+  a <- Array$create(1:10)\n+  tf <- tempfile(); on.exit(unlink(tf))\n+  saveRDS(a, tf)\n+\n+  b <- readRDS(tf)\n\nReview comment:\n       I don't understand why this fails--`a` still exists so I'd expect that a pointer to it would still work, even if it had been written to a file--but I trust you that it does :)\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n+    SEXP klass = Rf_getAttrib(self, R_ClassSymbol);\n+    std::string first_class(Rf_isNull(klass) ? \"ArrowObject\"\n+                                             : CHAR(STRING_ELT(klass, 0)));\n\nReview comment:\n       1) if this is an R6 object, how can class ever be NULL?\r\n   \r\n   2) Why not take the last element in `klass`, i.e. the actual subclass?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-23T15:03:15.519+0000",
                    "updated": "2020-09-23T15:03:15.519+0000",
                    "started": "2020-09-23T15:03:15.519+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "489610",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490025",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494093172\n\n\n\n##########\nFile path: r/tests/testthat/test-arrow.R\n##########\n@@ -47,3 +47,12 @@ r_only({\n     )\n   })\n })\n+\n+test_that(\"arrow gracefully fails to load objects from other sessions (ARROW-10071)\", {\n+  a <- Array$create(1:10)\n+  tf <- tempfile(); on.exit(unlink(tf))\n+  saveRDS(a, tf)\n+\n+  b <- readRDS(tf)\n\nReview comment:\n       serialization of external pointer loses the pointer\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T07:23:05.237+0000",
                    "updated": "2020-09-24T07:23:05.237+0000",
                    "started": "2020-09-24T07:23:05.237+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490025",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490027",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494095853\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n+    SEXP klass = Rf_getAttrib(self, R_ClassSymbol);\n+    std::string first_class(Rf_isNull(klass) ? \"ArrowObject\"\n+                                             : CHAR(STRING_ELT(klass, 0)));\n\nReview comment:\n       I'll refine about the NULL case, but the class we do want is the first one: \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   \r\n   a <- Array$create(1:10)\r\n   class(a)\r\n   #> [1] \"Array\"       \"ArrowObject\" \"R6\"\r\n   ```\r\n   \r\n   <sup>Created on 2020-09-24 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0.9001)</sup>\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T07:28:04.356+0000",
                    "updated": "2020-09-24T07:28:04.356+0000",
                    "started": "2020-09-24T07:28:04.356+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490027",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490070",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494154401\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       We can't really do that because of the implicit `else NULL` case: \r\n   \r\n   ```r\r\n   shared_ptr <- function(class, xp) {\r\n     if (!shared_ptr_is_null(xp)) class$new(xp)\r\n   }\r\n   ```\r\n   \r\n   There are cases where we want an R NULL when the internal C++ shared pointer holds a C++ null pointer, e.g. when we call: \r\n   \r\n   ```c++\r\n   std::shared_ptr<Array> RecordBatch::GetColumnByName(const std::string& name) const {\r\n     auto i = schema_->GetFieldIndex(name);\r\n     return i == -1 ? NULLPTR : column(i);\r\n   }\r\n   ```\r\n   \r\n   For example in this tests: \r\n   \r\n   ```r\r\n   test_that(\"[[ and $ on RecordBatch\", {\r\n     [...]\r\n     expect_null(batch$qwerty)\r\n     [...]\r\n   })\r\n   ```\r\n   \r\n   having the extra layer with the R function `shared_ptr(T, .)` maybe calling `T$new(.)` gives the NULL. \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T09:01:34.510+0000",
                    "updated": "2020-09-24T09:01:34.510+0000",
                    "started": "2020-09-24T09:01:34.510+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490070",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490075",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#issuecomment-698219857\n\n\n   Is there something I can use to demangle the type name ? \r\n   \r\n   ``` r\r\n   arrow:::Array__length(1)\r\n   #> Error in arrow:::Array__length(1): Invalid R object for NSt3__110shared_ptrIN5arrow5ArrayEEE, must be an ArrowObject\r\n   ```\r\n   \r\n   <sup>Created on 2020-09-24 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0.9001)</sup>\r\n   \r\n   Rcpp had `DEMANGLE` https://github.com/RcppCore/Rcpp/blob/85f6b275966cdfb1dfd32575e2da509ea2642084/src/api.cpp#L111\r\n   \r\n   @bkietz ? \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T09:09:52.381+0000",
                    "updated": "2020-09-24T09:09:52.381+0000",
                    "started": "2020-09-24T09:09:52.381+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490075",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490083",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494166354\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       Another way would be to have the ability to directly create the R6 objects internally, either by having more code in \r\n   \r\n   ```cpp\r\n   template <typename T>\r\n   SEXP as_sexp(const std::shared_ptr<T>& ptr) {\r\n     return cpp11::external_pointer<std::shared_ptr<T>>(new std::shared_ptr<T>(ptr));\r\n   }\r\n   ```\r\n   \r\n   but we would need some sort of dispatch from `T` to the R6 object. \r\n   \r\n   Or we would need to change the interface of many functions: \r\n   \r\n   ```cpp\r\n   // [[arrow::export]]\r\n   std::shared_ptr<arrow::Array> StructArray__field(\r\n       const std::shared_ptr<arrow::StructArray>& array, int i) {\r\n     return array->field(i);\r\n   }\r\n   ```\r\n   \r\n   perhaps to: \r\n   \r\n   ```cpp\r\n   // [[arrow::export]]\r\n   R6 StructArray__field(\r\n       const std::shared_ptr<arrow::StructArray>& array, int i) {\r\n     return R6(array->field(i), \"Array\");\r\n   }\r\n   ```\r\n   \r\n   but I don't think it's worth it\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T09:21:03.448+0000",
                    "updated": "2020-09-24T09:21:03.448+0000",
                    "started": "2020-09-24T09:21:03.448+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490083",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490257",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494391841\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       Ah ok, I missed that that check translated some responses into `NULL`--though I don't think that's something we do widely, and maybe it would be better to make that more explicit in order to simplify the rest of the cases. \r\n   \r\n   Regarding directly returning R6 objects from the cpp code, my thought had been more like the first idea of modifying `as_sexp` to map `T` to R6 classes. Our convention is that R6 class names are generally the bare C++ class name (assuming namespaces), i.e. `arrow::dataset::Dataset` is `Dataset` R6 class, with some exceptions. So we could record a map of those exceptions (e.g. \"arrow::csv::TableReader\" maps to \"CsvTableReader\") in cpp. If I were writing this in R, it could look something like this:\r\n   \r\n   ```r\r\n   get_r6_constructor <- function(cpp_class) {\r\n     if (cpp_class %in% names(special_cases)) {\r\n       r6_name <- special_cases[[cpp_class]]\r\n     } else {\r\n       r6_name <- sub(\"^.*::(.*)$\", \"\\\\1\", cpp_class)\r\n     }\r\n     get(r6_name, asNamespace(\"arrow\"))$new\r\n   }\r\n   ```\r\n   \r\n   cc @bkietz \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T15:02:13.799+0000",
                    "updated": "2020-09-24T15:02:13.799+0000",
                    "started": "2020-09-24T15:02:13.799+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490257",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490302",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494456605\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       I'd prefer to specify a complete mapping T to R6 class names, rather than only listing special cases. This would be a pretty straightforward trait structure in c++\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-24T16:33:56.865+0000",
                    "updated": "2020-09-24T16:33:56.865+0000",
                    "started": "2020-09-24T16:33:56.865+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490302",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490866",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494093172\n\n\n\n##########\nFile path: r/tests/testthat/test-arrow.R\n##########\n@@ -47,3 +47,12 @@ r_only({\n     )\n   })\n })\n+\n+test_that(\"arrow gracefully fails to load objects from other sessions (ARROW-10071)\", {\n+  a <- Array$create(1:10)\n+  tf <- tempfile(); on.exit(unlink(tf))\n+  saveRDS(a, tf)\n+\n+  b <- readRDS(tf)\n\nReview comment:\n       serialization of external pointer loses the pointer\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n+    SEXP klass = Rf_getAttrib(self, R_ClassSymbol);\n+    std::string first_class(Rf_isNull(klass) ? \"ArrowObject\"\n+                                             : CHAR(STRING_ELT(klass, 0)));\n\nReview comment:\n       I'll refine about the NULL case, but the class we do want is the first one: \r\n   \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   \r\n   a <- Array$create(1:10)\r\n   class(a)\r\n   #> [1] \"Array\"       \"ArrowObject\" \"R6\"\r\n   ```\r\n   \r\n   <sup>Created on 2020-09-24 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0.9001)</sup>\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       We can't really do that because of the implicit `else NULL` case: \r\n   \r\n   ```r\r\n   shared_ptr <- function(class, xp) {\r\n     if (!shared_ptr_is_null(xp)) class$new(xp)\r\n   }\r\n   ```\r\n   \r\n   There are cases where we want an R NULL when the internal C++ shared pointer holds a C++ null pointer, e.g. when we call: \r\n   \r\n   ```c++\r\n   std::shared_ptr<Array> RecordBatch::GetColumnByName(const std::string& name) const {\r\n     auto i = schema_->GetFieldIndex(name);\r\n     return i == -1 ? NULLPTR : column(i);\r\n   }\r\n   ```\r\n   \r\n   For example in this tests: \r\n   \r\n   ```r\r\n   test_that(\"[[ and $ on RecordBatch\", {\r\n     [...]\r\n     expect_null(batch$qwerty)\r\n     [...]\r\n   })\r\n   ```\r\n   \r\n   having the extra layer with the R function `shared_ptr(T, .)` maybe calling `T$new(.)` gives the NULL. \n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       Another way would be to have the ability to directly create the R6 objects internally, either by having more code in \r\n   \r\n   ```cpp\r\n   template <typename T>\r\n   SEXP as_sexp(const std::shared_ptr<T>& ptr) {\r\n     return cpp11::external_pointer<std::shared_ptr<T>>(new std::shared_ptr<T>(ptr));\r\n   }\r\n   ```\r\n   \r\n   but we would need some sort of dispatch from `T` to the R6 object. \r\n   \r\n   Or we would need to change the interface of many functions: \r\n   \r\n   ```cpp\r\n   // [[arrow::export]]\r\n   std::shared_ptr<arrow::Array> StructArray__field(\r\n       const std::shared_ptr<arrow::StructArray>& array, int i) {\r\n     return array->field(i);\r\n   }\r\n   ```\r\n   \r\n   perhaps to: \r\n   \r\n   ```cpp\r\n   // [[arrow::export]]\r\n   R6 StructArray__field(\r\n       const std::shared_ptr<arrow::StructArray>& array, int i) {\r\n     return R6(array->field(i), \"Array\");\r\n   }\r\n   ```\r\n   \r\n   but I don't think it's worth it\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T13:20:54.237+0000",
                    "updated": "2020-09-25T13:20:54.237+0000",
                    "started": "2020-09-25T13:20:54.236+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490866",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/490887",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494391841\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       Ah ok, I missed that that check translated some responses into `NULL`--though I don't think that's something we do widely, and maybe it would be better to make that more explicit in order to simplify the rest of the cases. \r\n   \r\n   Regarding directly returning R6 objects from the cpp code, my thought had been more like the first idea of modifying `as_sexp` to map `T` to R6 classes. Our convention is that R6 class names are generally the bare C++ class name (assuming namespaces), i.e. `arrow::dataset::Dataset` is `Dataset` R6 class, with some exceptions. So we could record a map of those exceptions (e.g. \"arrow::csv::TableReader\" maps to \"CsvTableReader\") in cpp. If I were writing this in R, it could look something like this:\r\n   \r\n   ```r\r\n   get_r6_constructor <- function(cpp_class) {\r\n     if (cpp_class %in% names(special_cases)) {\r\n       r6_name <- special_cases[[cpp_class]]\r\n     } else {\r\n       r6_name <- sub(\"^.*::(.*)$\", \"\\\\1\", cpp_class)\r\n     }\r\n     get(r6_name, asNamespace(\"arrow\"))$new\r\n   }\r\n   ```\r\n   \r\n   cc @bkietz \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T13:23:07.834+0000",
                    "updated": "2020-09-25T13:23:07.834+0000",
                    "started": "2020-09-25T13:23:07.834+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "490887",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491046",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r494456605\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -157,8 +157,15 @@ struct ns {\n \n template <typename Pointer>\n Pointer r6_to_pointer(SEXP self) {\n-  return reinterpret_cast<Pointer>(\n-      R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp)));\n+  void* p = R_ExternalPtrAddr(Rf_findVarInFrame(self, arrow::r::symbols::xp));\n+  if (p == nullptr) {\n\nReview comment:\n       I'd prefer to specify a complete mapping T to R6 class names, rather than only listing special cases. This would be a pretty straightforward trait structure in c++\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T13:37:52.798+0000",
                    "updated": "2020-09-25T13:37:52.798+0000",
                    "started": "2020-09-25T13:37:52.798+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491046",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491058",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#issuecomment-698219857\n\n\n   Is there something I can use to demangle the type name ? \r\n   \r\n   ``` r\r\n   arrow:::Array__length(1)\r\n   #> Error in arrow:::Array__length(1): Invalid R object for NSt3__110shared_ptrIN5arrow5ArrayEEE, must be an ArrowObject\r\n   ```\r\n   \r\n   <sup>Created on 2020-09-24 by the [reprex package](https://reprex.tidyverse.org) (v0.3.0.9001)</sup>\r\n   \r\n   Rcpp had `DEMANGLE` https://github.com/RcppCore/Rcpp/blob/85f6b275966cdfb1dfd32575e2da509ea2642084/src/api.cpp#L111\r\n   \r\n   @bkietz ? \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T13:39:00.405+0000",
                    "updated": "2020-09-25T13:39:00.405+0000",
                    "started": "2020-09-25T13:39:00.405+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491058",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491428",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#issuecomment-699153455\n\n\n   @romainfrancois yes, should I make a PR to your branch?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T21:02:15.742+0000",
                    "updated": "2020-09-25T21:02:15.742+0000",
                    "started": "2020-09-25T21:02:15.742+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491428",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491430",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#issuecomment-699156330\n\n\n   @bkietz you can probably just push to it, or whatever you want. AFAICT that's the only outstanding issue and I'll merge when it is resolved (since it's earlier in the day here).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-25T21:09:14.700+0000",
                    "updated": "2020-09-25T21:09:14.700+0000",
                    "started": "2020-09-25T21:09:14.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491430",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491601",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246#discussion_r495490009\n\n\n\n##########\nFile path: r/src/arrow_cpp11.h\n##########\n@@ -16,12 +16,15 @@\n // under the License.\n \n #include <cstring>  // for strlen\n+#include <iostream>\n\nReview comment:\n       ```suggestion\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-26T19:59:44.978+0000",
                    "updated": "2020-09-26T19:59:44.978+0000",
                    "started": "2020-09-26T19:59:44.978+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491601",
                    "issueId": "13328955"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/worklog/491602",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz closed pull request #8246:\nURL: https://github.com/apache/arrow/pull/8246\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-09-26T20:00:59.249+0000",
                    "updated": "2020-09-26T20:00:59.249+0000",
                    "started": "2020-09-26T20:00:59.249+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "491602",
                    "issueId": "13328955"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 10800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@70a0dcbe[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6603b28b[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@171714a0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6c7b7b23[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@50c97f5a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@12a70804[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d3abce4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@a2f6a03[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1187f7b3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3bca2aaf[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@537f6cae[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@22716bb0[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10800,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Sep 26 20:01:00 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-09-26T20:01:00.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10071/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-09-23T09:32:40.000+0000",
        "updated": "2020-09-26T20:01:00.000+0000",
        "timeoriginalestimate": null,
        "description": "library(arrow, warn.conflicts = FALSE)\r\n\r\na <- Array$create(1:10)\r\n tf <- tempfile()\r\n saveRDS(a, tf)\r\n\r\nb <- readRDS(tf)\r\n b$length()",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] segfault with ArrowObject from previous session, or saved",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13328955/comment/17202668",
                    "id": "17202668",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 8246\n[https://github.com/apache/arrow/pull/8246]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-09-26T20:01:00.336+0000",
                    "updated": "2020-09-26T20:01:00.336+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0iu9k:",
        "customfield_12314139": null
    }
}