{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13353283",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283",
    "key": "ARROW-11320",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11320/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 15,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/537825",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou opened a new pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265\n\n\n   * Make the random generator seed a bit more unique.\r\n   * When a temporary name already exists, retry with another one instead of bailing out.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-19T14:29:16.687+0000",
                    "updated": "2021-01-19T14:29:16.687+0000",
                    "started": "2021-01-19T14:29:16.687+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "537825",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/537858",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#issuecomment-762909921\n\n\n   https://issues.apache.org/jira/browse/ARROW-11320\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-19T15:18:39.038+0000",
                    "updated": "2021-01-19T15:18:39.038+0000",
                    "started": "2021-01-19T15:18:39.037+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "537858",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/537878",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#issuecomment-762951703\n\n\n   cc @westonpace Do you want to review this?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-19T16:18:06.282+0000",
                    "updated": "2021-01-19T16:18:06.282+0000",
                    "started": "2021-01-19T16:18:06.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "537878",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/537944",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r560366357\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       Why not simply use a static/anon-namespace functions for TryCreatingDirectory and MakeBaseName?  MakeRandomName is already one.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n\nReview comment:\n       The way it is at the moment you will try the next directory if you get a permissions error or non-existing directory but you won't try the next directory if you tried three times and failed.  I think this is probably ok, just making sure this is the behavior you want.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n+    if (ptr) {\n+      return std::move(ptr);\n\nReview comment:\n       Why are you applying `std::move` to a return value?\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1590,20 +1610,29 @@ Result<SignalHandler> SetSignalHandler(int signum, const SignalHandler& handler)\n \n namespace {\n \n+int64_t GetPid() {\n+#ifdef _WIN32\n+  return GetCurrentProcessId();\n+#else\n+  return getpid();\n+#endif\n+}\n+\n std::mt19937_64 GetSeedGenerator() {\n   // Initialize Mersenne Twister PRNG with a true random seed.\n+  // Make sure to mix in process id to minimize risks of clashes when parallel testing.\n #ifdef ARROW_VALGRIND\n   // Valgrind can crash, hang or enter an infinite loop on std::random_device,\n   // use a crude initializer instead.\n-  // Make sure to mix in process id to avoid clashes when parallel testing.\n   const uint8_t dummy = 0;\n   ARROW_UNUSED(dummy);\n   std::mt19937_64 seed_gen(reinterpret_cast<uintptr_t>(&dummy) ^\n-                           static_cast<uintptr_t>(getpid()));\n+                           static_cast<uintptr_t>(GetPid()));\n #else\n   std::random_device true_random;\n   std::mt19937_64 seed_gen(static_cast<uint64_t>(true_random()) ^\n-                           (static_cast<uint64_t>(true_random()) << 32));\n+                           (static_cast<uint64_t>(true_random()) << 32) ^\n+                           (static_cast<uint64_t>(GetPid()) << 17));\n\nReview comment:\n       Why `<< 17`?  Won't this leave the last 17 bits as 0?  It appears PID is at least 32 bits.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-19T18:05:15.758+0000",
                    "updated": "2021-01-19T18:05:15.758+0000",
                    "started": "2021-01-19T18:05:15.758+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "537944",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/537945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r560366357\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       Why not simply use static/anon-namespace functions for TryCreatingDirectory and MakeBaseName?  MakeRandomName is already one.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-19T18:05:41.313+0000",
                    "updated": "2021-01-19T18:05:41.313+0000",
                    "started": "2021-01-19T18:05:41.312+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "537945",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539073",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561909698\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. But I can move out MakeBaseName.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. But I can move out `MakeBaseName`.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T14:11:30.942+0000",
                    "updated": "2021-01-21T14:11:30.942+0000",
                    "started": "2021-01-21T14:11:30.941+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539073",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539075",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561910697\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n+    if (ptr) {\n+      return std::move(ptr);\n\nReview comment:\n       Because some old gcc fails compiling without it:\r\n   https://github.com/apache/arrow/runs/1728457990#step:9:552\r\n   https://github.com/apache/arrow/runs/1728457638#step:7:992\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T14:12:41.297+0000",
                    "updated": "2021-01-21T14:12:41.297+0000",
                    "started": "2021-01-21T14:12:41.297+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539075",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539076",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561910802\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n\nReview comment:\n       Yes, this is the desired behaviour.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T14:12:54.226+0000",
                    "updated": "2021-01-21T14:12:54.226+0000",
                    "started": "2021-01-21T14:12:54.226+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539076",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539077",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561911098\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1590,20 +1610,29 @@ Result<SignalHandler> SetSignalHandler(int signum, const SignalHandler& handler)\n \n namespace {\n \n+int64_t GetPid() {\n+#ifdef _WIN32\n+  return GetCurrentProcessId();\n+#else\n+  return getpid();\n+#endif\n+}\n+\n std::mt19937_64 GetSeedGenerator() {\n   // Initialize Mersenne Twister PRNG with a true random seed.\n+  // Make sure to mix in process id to minimize risks of clashes when parallel testing.\n #ifdef ARROW_VALGRIND\n   // Valgrind can crash, hang or enter an infinite loop on std::random_device,\n   // use a crude initializer instead.\n-  // Make sure to mix in process id to avoid clashes when parallel testing.\n   const uint8_t dummy = 0;\n   ARROW_UNUSED(dummy);\n   std::mt19937_64 seed_gen(reinterpret_cast<uintptr_t>(&dummy) ^\n-                           static_cast<uintptr_t>(getpid()));\n+                           static_cast<uintptr_t>(GetPid()));\n #else\n   std::random_device true_random;\n   std::mt19937_64 seed_gen(static_cast<uint64_t>(true_random()) ^\n-                           (static_cast<uint64_t>(true_random()) << 32));\n+                           (static_cast<uint64_t>(true_random()) << 32) ^\n+                           (static_cast<uint64_t>(GetPid()) << 17));\n\nReview comment:\n       Hmm, I don't know what I was thinking. Shifting is pointless here indeed.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T14:13:17.305+0000",
                    "updated": "2021-01-21T14:13:17.305+0000",
                    "started": "2021-01-21T14:13:17.305+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539077",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539090",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561909698\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. I can move out `MakeBaseName`, though it doesn't seem very useful.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T14:27:48.838+0000",
                    "updated": "2021-01-21T14:27:48.838+0000",
                    "started": "2021-01-21T14:27:48.838+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539090",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539184",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#issuecomment-764784559\n\n\n   Travis-CI build: https://travis-ci.com/github/pitrou/arrow/builds/213944945 . Will merge.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T16:48:53.331+0000",
                    "updated": "2021-01-21T16:48:53.331+0000",
                    "started": "2021-01-21T16:48:53.331+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539184",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539185",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T16:49:06.251+0000",
                    "updated": "2021-01-21T16:49:06.251+0000",
                    "started": "2021-01-21T16:49:06.250+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539185",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539731",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou closed pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:07:31.932+0000",
                    "updated": "2021-01-22T06:07:31.932+0000",
                    "started": "2021-01-22T06:07:31.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539731",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539753",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#discussion_r561909698\n\n\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. But I can move out MakeBaseName.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. But I can move out `MakeBaseName`.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n+    if (ptr) {\n+      return std::move(ptr);\n\nReview comment:\n       Because some old gcc fails compiling without it:\r\n   https://github.com/apache/arrow/runs/1728457990#step:9:552\r\n   https://github.com/apache/arrow/runs/1728457638#step:7:992\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n+      [&](const NativePathString& base_dir) -> Result<std::unique_ptr<TemporaryDir>> {\n+    Status st;\n+    for (int attempt = 0; attempt < 3; ++attempt) {\n+      PlatformFilename fn(base_dir + kNativeSep + base_name + kNativeSep);\n+      auto result = CreateDir(fn);\n+      if (!result.ok()) {\n+        // Probably a permissions error or a non-existing base_dir\n+        return nullptr;\n+      }\n+      if (*result) {\n+        return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+      }\n+      // The random name already exists in base_dir, try with another name\n+      st = Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n+      ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n+    }\n+    return st;\n+  };\n+\n+  ARROW_ASSIGN_OR_RAISE(base_name, MakeBaseName());\n \n   auto base_dirs = GetPlatformTemporaryDirs();\n   DCHECK_NE(base_dirs.size(), 0);\n \n-  auto st = Status::OK();\n-  for (const auto& p : base_dirs) {\n-    PlatformFilename fn(p + kNativeSep + base_name + kNativeSep);\n-    auto result = CreateDir(fn);\n-    if (!result.ok()) {\n-      st = result.status();\n-      continue;\n-    }\n-    if (!*result) {\n-      // XXX Should we retry with another random name?\n-      return Status::IOError(\"Path already exists: '\", fn.ToString(), \"'\");\n-    } else {\n-      return std::unique_ptr<TemporaryDir>(new TemporaryDir(std::move(fn)));\n+  for (const auto& base_dir : base_dirs) {\n+    ARROW_ASSIGN_OR_RAISE(auto ptr, TryCreatingDirectory(base_dir));\n\nReview comment:\n       Yes, this is the desired behaviour.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1590,20 +1610,29 @@ Result<SignalHandler> SetSignalHandler(int signum, const SignalHandler& handler)\n \n namespace {\n \n+int64_t GetPid() {\n+#ifdef _WIN32\n+  return GetCurrentProcessId();\n+#else\n+  return getpid();\n+#endif\n+}\n+\n std::mt19937_64 GetSeedGenerator() {\n   // Initialize Mersenne Twister PRNG with a true random seed.\n+  // Make sure to mix in process id to minimize risks of clashes when parallel testing.\n #ifdef ARROW_VALGRIND\n   // Valgrind can crash, hang or enter an infinite loop on std::random_device,\n   // use a crude initializer instead.\n-  // Make sure to mix in process id to avoid clashes when parallel testing.\n   const uint8_t dummy = 0;\n   ARROW_UNUSED(dummy);\n   std::mt19937_64 seed_gen(reinterpret_cast<uintptr_t>(&dummy) ^\n-                           static_cast<uintptr_t>(getpid()));\n+                           static_cast<uintptr_t>(GetPid()));\n #else\n   std::random_device true_random;\n   std::mt19937_64 seed_gen(static_cast<uint64_t>(true_random()) ^\n-                           (static_cast<uint64_t>(true_random()) << 32));\n+                           (static_cast<uint64_t>(true_random()) << 32) ^\n+                           (static_cast<uint64_t>(GetPid()) << 17));\n\nReview comment:\n       Hmm, I don't know what I was thinking. Shifting is pointless here indeed.\n\n##########\nFile path: cpp/src/arrow/util/io_util.cc\n##########\n@@ -1482,31 +1482,51 @@ std::string MakeRandomName(int num_chars) {\n }  // namespace\n \n Result<std::unique_ptr<TemporaryDir>> TemporaryDir::Make(const std::string& prefix) {\n-  std::string suffix = MakeRandomName(8);\n+  const int kNumChars = 8;\n+\n   NativePathString base_name;\n-  ARROW_ASSIGN_OR_RAISE(base_name, StringToNative(prefix + suffix));\n+\n+  auto MakeBaseName = [&]() {\n+    std::string suffix = MakeRandomName(kNumChars);\n+    return StringToNative(prefix + suffix);\n+  };\n+\n+  auto TryCreatingDirectory =\n\nReview comment:\n       `TryCreatingDirectory` mutates the enclosing scope and is therefore coupled to this function. I can move out `MakeBaseName`, though it doesn't seem very useful.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:10:26.779+0000",
                    "updated": "2021-01-22T06:10:26.779+0000",
                    "started": "2021-01-22T06:10:26.779+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539753",
                    "issueId": "13353283"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/worklog/539919",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #9265:\nURL: https://github.com/apache/arrow/pull/9265#issuecomment-764784559\n\n\n   Travis-CI build: https://travis-ci.com/github/pitrou/arrow/builds/213944945 . Will merge.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:35:48.468+0000",
                    "updated": "2021-01-22T06:35:48.468+0000",
                    "started": "2021-01-22T06:35:48.468+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539919",
                    "issueId": "13353283"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@75b020e5[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@b36227[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d5d6fc1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@26649017[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32b03d16[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@dd9ccfe[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5b2c99e3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@594a5eb9[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6a21900b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@29dc0f8d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@160078d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1d34433b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jan 21 16:48:58 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-01-21T16:48:58.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11320/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-01-19T13:53:21.000+0000",
        "updated": "2021-04-18T15:59:10.000+0000",
        "timeoriginalestimate": null,
        "description": "When running the release verification script, I sometimes get this error:\r\n{code}\r\n[----------] 5 tests from TestInt8/TestSparseTensorRoundTrip/0, where TypeParam = arrow::Int8Type\r\n[ RUN      ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCOOIndexRowMajor\r\n/tmp/arrow-3.0.0.4SRpe/apache-arrow-3.0.0/cpp/src/arrow/ipc/tensor_test.cc:53: Failure\r\nFailed\r\n'_error_or_value8.status()' failed with IOError: Path already exists: '/tmp/ipc-test-qj6ng827/'\r\n[  FAILED  ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCOOIndexRowMajor, where TypeParam = arrow::Int8Type (0 ms)\r\n[ RUN      ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCOOIndexColumnMajor\r\n[       OK ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCOOIndexColumnMajor (0 ms)\r\n[ RUN      ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSRIndex\r\n[       OK ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSRIndex (0 ms)\r\n[ RUN      ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSCIndex\r\n[       OK ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSCIndex (0 ms)\r\n[ RUN      ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSFIndex\r\n[       OK ] TestInt8/TestSparseTensorRoundTrip/0.WithSparseCSFIndex (1 ms)\r\n[----------] 5 tests from TestInt8/TestSparseTensorRoundTrip/0 (1 ms total)\r\n{code}\r\n\r\nIt seems that in some fringe cases, the random generation of temporary directory names produces duplicates. Most likely this means the random generator is getting the same seed from different processes.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Spurious test failure when creating temporary dir",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353283/comment/17269426",
                    "id": "17269426",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 9265\n[https://github.com/apache/arrow/pull/9265]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-01-21T16:48:58.809+0000",
                    "updated": "2021-01-21T16:48:58.809+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0mrh4:",
        "customfield_12314139": null
    }
}