{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13398795",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795",
    "key": "ARROW-13853",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "kernel",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12623590",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12623590",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13403208",
                    "key": "ARROW-14126",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13403208",
                    "fields": {
                        "summary": "[C++] Add locale support for relevant string compute functions",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=edponce",
            "name": "edponce",
            "key": "edponce",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=edponce&avatarId=45496",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=edponce&avatarId=45496",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=edponce&avatarId=45496",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=edponce&avatarId=45496"
            },
            "displayName": "Eduardo Ponce",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 20400,
            "total": 20400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 20400,
            "total": 20400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13853/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 34,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/655144",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce opened a new pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232\n\n\n   This PR adds locale validation to string functions matching stringr: str_to_title, str_to_lower, and str_to_upper.\r\n   In Arrow C++, these kernels do not support a locale argument so only the default R locale (\"en\") is currently supported.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-25T01:55:53.345+0000",
                    "updated": "2021-09-25T01:55:53.345+0000",
                    "started": "2021-09-25T01:55:53.345+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655144",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/655145",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#issuecomment-926993252\n\n\n   https://issues.apache.org/jira/browse/ARROW-13853\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-25T01:56:07.231+0000",
                    "updated": "2021-09-25T01:56:07.231+0000",
                    "started": "2021-09-25T01:56:07.231+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "655145",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/656335",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r717860993\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,38 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Arrow does not supports a locale option for string case conversion functions,\n+# contrast to stringr's API, so the `locale` argument is only valid for the\n+# standard/default ones: \"en\", \"C\", and \"POSIX\". The following are string\n+# functions that take a `locale` option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+.valid_locales_for_string_functions <- list(\"en\", \"C\", \"POSIX\")\n+\n+arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  assert_that(\n+    locale %in% .valid_locales_for_string_functions,\n+    msg = paste(\n+      \"`locale` must be any of: \",\n+      paste(.valid_locales_for_string_functions, collapse=\",\")\n+    )\n+  )\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n\nReview comment:\n       I would ditch the function above and rewrite these like this:\r\n   \r\n   ```suggestion\r\n     if (!identical(locale, \"en\")) {\r\n       stop(\"Providing 'locale' to 'str_to_lower' not supported in Arrow; to change locale, use 'Sys.setlocale()'\", call. = FALSE)\r\n     }\r\n     Expression$create(\"utf8_lower\", string)\r\n   ```\r\n   \r\n   Thoughts @jonkeane @thisisnic ? \r\n   \r\n   (I'd also leave a comment referencing the jira issue that would support passing locale to the string kernels)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-28T18:35:34.834+0000",
                    "updated": "2021-09-28T18:35:34.834+0000",
                    "started": "2021-09-28T18:35:34.833+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "656335",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/656882",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r717860993\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,38 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Arrow does not supports a locale option for string case conversion functions,\n+# contrast to stringr's API, so the `locale` argument is only valid for the\n+# standard/default ones: \"en\", \"C\", and \"POSIX\". The following are string\n+# functions that take a `locale` option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+.valid_locales_for_string_functions <- list(\"en\", \"C\", \"POSIX\")\n+\n+arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  assert_that(\n+    locale %in% .valid_locales_for_string_functions,\n+    msg = paste(\n+      \"`locale` must be any of: \",\n+      paste(.valid_locales_for_string_functions, collapse=\",\")\n+    )\n+  )\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n\nReview comment:\n       I would ditch the function above and rewrite these like this:\r\n   \r\n   ```suggestion\r\n     if (!identical(locale, \"en\")) {\r\n       stop(\"Providing 'locale' to 'str_to_lower' not supported in Arrow; to change locale, use 'Sys.setlocale()'\", call. = FALSE)\r\n     }\r\n     Expression$create(\"utf8_lower\", string)\r\n   ```\r\n   \r\n   Thoughts @jonkeane @thisisnic ? \r\n   \r\n   (I'd also leave a comment referencing the jira issue that would support passing locale to the string kernels)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-28T20:27:19.669+0000",
                    "updated": "2021-09-28T20:27:19.669+0000",
                    "started": "2021-09-28T20:27:19.669+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "656882",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/656908",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r717947724\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,38 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Arrow does not supports a locale option for string case conversion functions,\n+# contrast to stringr's API, so the `locale` argument is only valid for the\n+# standard/default ones: \"en\", \"C\", and \"POSIX\". The following are string\n+# functions that take a `locale` option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+.valid_locales_for_string_functions <- list(\"en\", \"C\", \"POSIX\")\n+\n+arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  assert_that(\n+    locale %in% .valid_locales_for_string_functions,\n+    msg = paste(\n+      \"`locale` must be any of: \",\n+      paste(.valid_locales_for_string_functions, collapse=\",\")\n+    )\n+  )\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n\nReview comment:\n       FYI, when an invalid `locale` is provided the following message is triggered in a (Table -> mutate -> collect) pipeline:\r\n   ```r\r\n   Warning: In str_to_title(x, locale = \"es\"), Providing 'locale' to 'str_to_title' is not supported in Arrow; to change locale use 'Sys.setlocale()'; pulling data into R\r\n   Error: Problem with `mutate()` column `r`.\r\n   \u2139 `r = str_to_title(x, locale = \"es\")`.\r\n   \u2716 could not find function \"str_to_title\"\r\n   Run `rlang::last_error()` to see where the error occurred.\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-28T20:41:38.623+0000",
                    "updated": "2021-09-28T20:41:38.623+0000",
                    "started": "2021-09-28T20:41:38.623+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "656908",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657116",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718384360\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,39 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing 'locale' to 'str_to_lower' is not supported in Arrow; \",\n+    \"to change locale use 'Sys.setlocale()'\", call. = FALSE)\n\nReview comment:\n       Small phrasing suggestion (would need copying to the others too).\r\n   \r\n   ```suggestion\r\n       stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\r\n       \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T10:44:24.896+0000",
                    "updated": "2021-09-29T10:44:24.896+0000",
                    "started": "2021-09-29T10:44:24.896+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657116",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657334",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#issuecomment-930300415\n\n\n   @github-actions crossbow submit test-r-linux-as-cran\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T15:45:09.532+0000",
                    "updated": "2021-09-29T15:45:09.532+0000",
                    "started": "2021-09-29T15:45:09.531+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657334",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657335",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#issuecomment-930301217\n\n\n   Revision: f6c29d0379efb31fe4e41c959356bc484c4ca43c\n   \n   Submitted crossbow builds: [ursacomputing/crossbow @ actions-859](https://github.com/ursacomputing/crossbow/branches/all?query=actions-859)\n   \n   |Task|Status|\n   |----|------|\n   |test-r-linux-as-cran|[![Github Actions](https://github.com/ursacomputing/crossbow/workflows/Crossbow/badge.svg?branch=actions-859-github-test-r-linux-as-cran)](https://github.com/ursacomputing/crossbow/actions?query=branch:actions-859-github-test-r-linux-as-cran)|\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T15:46:13.644+0000",
                    "updated": "2021-09-29T15:46:13.644+0000",
                    "started": "2021-09-29T15:46:13.644+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657335",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657336",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718651282\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,39 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing 'locale' to 'str_to_lower' is not supported in Arrow; \",\n+    \"to change locale use 'Sys.setlocale()'\", call. = FALSE)\n\nReview comment:\n       I like Nic's phrasing here, seeing it repeated three times: should we write/store the message once and use it in each `stop` so we know the same is being used. If we do want to keep the function name in it (I don't think we need to, but if we do) we could make a small helper that plots that in.\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -471,6 +471,46 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"Foo\", \" B\\na R\", \"\u2c6d\u027d\u2c64oW\", \"\u0131I\"))\n\nReview comment:\n       I've triggered our as-cran build to check this \u2014 we might want (or in fact need) to turn these non-ascii characters into their unicode escapes to not anger cran checking (cf https://github.com/apache/arrow/blob/master/r/tests/testthat/test-json.R#L26)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T15:47:59.763+0000",
                    "updated": "2021-09-29T15:47:59.763+0000",
                    "started": "2021-09-29T15:47:59.763+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657336",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657444",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718763214\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -471,6 +471,46 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"Foo\", \" B\\na R\", \"\u2c6d\u027d\u2c64oW\", \"\u0131I\"))\n\nReview comment:\n       It did pass, though https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Encoding-issues recommends using `\\u...` for portability. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T18:03:24.104+0000",
                    "updated": "2021-09-29T18:03:24.104+0000",
                    "started": "2021-09-29T18:03:24.103+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657444",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657448",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718770517\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -471,6 +471,46 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"Foo\", \" B\\na R\", \"\u2c6d\u027d\u2c64oW\", \"\u0131I\"))\n\nReview comment:\n       I believe it was Solaris that would choke on this in the past.\r\n   \r\n   Can we just rely on the C++ tests that unicode etc. works? We just need to test here that we can invoke the kernels correctly.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T18:14:11.963+0000",
                    "updated": "2021-09-29T18:14:11.963+0000",
                    "started": "2021-09-29T18:14:11.963+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657448",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657450",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718772363\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -471,6 +471,46 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"Foo\", \" B\\na R\", \"\u2c6d\u027d\u2c64oW\", \"\u0131I\"))\n\nReview comment:\n       Unicode is tested in C++, so I will remove unicode characters.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T18:17:01.115+0000",
                    "updated": "2021-09-29T18:17:01.115+0000",
                    "started": "2021-09-29T18:17:01.115+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657450",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657495",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718815571\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -467,6 +467,25 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"1Foo1\", \" \\tB a R\\n\", \"!apACHe aRroW!\"))\n+  funcs <- c(str_to_lower, str_to_upper, str_to_title)\n+  for (func in funcs) {\n+    expect_dplyr_equal(\n+      input %>%\n+        transmute(x = func(x)) %>%\n+        collect(),\n+      df\n+    )\n+\n+    funcname = as.character(substitute(func))\n+    expect_error(\n+      nse_funcs[[funcname]](\"Apache Arrow\", locale = \"sp\"),\n+      \"Providing a value for 'locale' other than the default ('en') is not supported by Arrow\"\n+    )\n\nReview comment:\n       We could probably get away with testing the error on one function and not wrapping them all in this for loop.\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -467,6 +467,25 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"1Foo1\", \" \\tB a R\\n\", \"!apACHe aRroW!\"))\n+  funcs <- c(str_to_lower, str_to_upper, str_to_title)\n+  for (func in funcs) {\n+    expect_dplyr_equal(\n+      input %>%\n+        transmute(x = func(x)) %>%\n\nReview comment:\n       This should work, but because of how these tests are evaluated, I think something is getting lost leading to these errors: https://github.com/apache/arrow/pull/11232/checks?check_run_id=3748190500#step:8:17492\n\n##########\nFile path: r/tests/testthat/test-dplyr-string-functions.R\n##########\n@@ -467,6 +467,25 @@ test_that(\"strsplit and str_split\", {\n   )\n })\n \n+test_that(\"str_to_lower, str_to_upper, and str_to_title\", {\n+  df <- tibble(x = c(\"1Foo1\", \" \\tB a R\\n\", \"!apACHe aRroW!\"))\n+  funcs <- c(str_to_lower, str_to_upper, str_to_title)\n+  for (func in funcs) {\n+    expect_dplyr_equal(\n+      input %>%\n+        transmute(x = func(x)) %>%\n\nReview comment:\n       In other places, we have tested lists of functions like these by transmuting/mutating multiple columns https://github.com/apache/arrow/blob/master/r/tests/testthat/test-dplyr.R#L996-L1009\r\n   \r\n   something like:\r\n   \r\n   ```\r\n   expect_dplyr_equal(\r\n          input %>%\r\n            transmute(\r\n              x_lower = str_to_lower(x),\r\n              x_upper = str_to_upper(x),\r\n              x_title = str_to_title(x)\r\n            ) %>%\r\n            collect()\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T19:25:00.018+0000",
                    "updated": "2021-09-29T19:25:00.018+0000",
                    "started": "2021-09-29T19:25:00.017+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657495",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#issuecomment-930494348\n\n\n   Thanks all for the great reviews!\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T19:53:42.311+0000",
                    "updated": "2021-09-29T19:53:42.311+0000",
                    "started": "2021-09-29T19:53:42.310+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657512",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657518",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718847719\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       Sorry to bikeshed but I find this more readable, what do you think @jonkeane?\r\n   \r\n   ```suggestion\r\n   stop_if_locale_provided <- function(locale) {\r\n     if (!identical(locale, \"en\")) {\r\n       stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\r\n       \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\r\n     }\r\n   }\r\n   \r\n   nse_funcs$str_to_lower <- function(string, locale = \"en\") {\r\n     stop_if_locale_provided(locale)\r\n     Expression$create(\"utf8_lower\", string)\r\n   }\r\n   \r\n   nse_funcs$str_to_upper <- function(string, locale = \"en\") {\r\n     stop_if_locale_provided(locale)\r\n     Expression$create(\"utf8_upper\", string)\r\n   }\r\n   \r\n   nse_funcs$str_to_title <- function(string, locale = \"en\") {\r\n     stop_if_locale_provided(locale)\r\n     Expression$create(\"utf8_title\", string)\r\n   }\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T20:09:35.439+0000",
                    "updated": "2021-09-29T20:09:35.439+0000",
                    "started": "2021-09-29T20:09:35.438+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657518",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657524",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718854820\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       Yes I agree, this also fits with other patterns we have of stopping/bailing with validation function and then producing what's needed otherwise.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T20:20:28.508+0000",
                    "updated": "2021-09-29T20:20:28.508+0000",
                    "started": "2021-09-29T20:20:28.507+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657524",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657552",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718883605\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       I agree this is a better approach.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T21:04:03.433+0000",
                    "updated": "2021-09-29T21:04:03.433+0000",
                    "started": "2021-09-29T21:04:03.432+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657552",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657555",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718884182\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       Should `stop_if_locale_provided` be a \"hidden\" function (ie, name begins with a dot)?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T21:05:06.234+0000",
                    "updated": "2021-09-29T21:05:06.234+0000",
                    "started": "2021-09-29T21:05:06.234+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657555",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657559",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718889316\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       It's already hidden in so far as it's not available to users of the arrow package (without doing something special). I think the way it is is good \u2014 no reason to prefix it with a dot\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T21:13:25.757+0000",
                    "updated": "2021-09-29T21:13:25.757+0000",
                    "started": "2021-09-29T21:13:25.756+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657559",
                    "issueId": "13398795"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/worklog/657560",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #11232:\nURL: https://github.com/apache/arrow/pull/11232#discussion_r718890520\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -330,6 +330,35 @@ arrow_string_join_function <- function(null_handling, null_replacement = NULL) {\n   }\n }\n \n+# Currently, Arrow does not supports a locale option for string case conversion\n+# functions, contrast to stringr's API, so the 'locale' argument is only valid\n+# for stringr's default value (\"en\"). The following are string functions that\n+# take a 'locale' option as its second argument:\n+#   str_to_lower\n+#   str_to_upper\n+#   str_to_title\n+#\n+# Arrow locale will be supported with ARROW-14126\n+.arrow_string_function_with_locale_arg <- function(func, string, locale) {\n+  if (!identical(locale, \"en\")) {\n+    stop(\"Providing a value for 'locale' other than the default ('en') is not supported by Arrow. \",\n+    \"To change locale, use 'Sys.setlocale()'\", call. = FALSE)\n+  }\n+  Expression$create(func, string)\n+}\n+\n+nse_funcs$str_to_lower <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_lower\", string, locale)\n+}\n+\n+nse_funcs$str_to_upper <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_upper\", string, locale)\n+}\n+\n+nse_funcs$str_to_title <- function(string, locale = \"en\") {\n+  .arrow_string_function_with_locale_arg(\"utf8_title\", string, locale)\n+}\n\nReview comment:\n       Ok, thanks for the guidance.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-29T21:15:19.657+0000",
                    "updated": "2021-09-29T21:15:19.657+0000",
                    "started": "2021-09-29T21:15:19.656+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "657560",
                    "issueId": "13398795"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 20400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1665b7da[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@259713be[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6ffa0c06[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@726de8a4[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3cfcd534[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3db663e9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@293d265[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1f26325b[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@45a901fe[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4b0e8b89[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@57927877[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@79883c34[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 20400,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Sep 30 12:52:51 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-09-30T12:52:51.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13853/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-09-01T20:22:09.000+0000",
        "updated": "2021-09-30T12:53:03.000+0000",
        "timeoriginalestimate": null,
        "description": "ARROW-12714 added the *str_to_title* kernel and a basic mapping, but we should add a test. Also the stringr function takes a \"locale\" argument which is not handled here; we should either pass it to Arrow C++ if it supports it (which I doubt) or error if a value is provided in R.\r\n\r\nThis also applies to *str_to_lower* and *str_to_upper* kernels.\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 20400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] String to_title, to_lower, to_upper kernels",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/comment/17419937",
                    "id": "17419937",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=edponce",
                        "name": "edponce",
                        "key": "edponce",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=edponce&avatarId=45496",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=edponce&avatarId=45496",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=edponce&avatarId=45496",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=edponce&avatarId=45496"
                        },
                        "displayName": "Eduardo Ponce",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Arrow string compute functions do not support a locale setting and use the default POSIX locale which is \"C\".\r\nArrow provides UTF-8 variants of the string functions for localization standardization.\r\nCurrently, only _strftime_ uses a locale option for formatting the resulting string.\r\n\r\nLocalization would also need to be considered for kernels that use/change text casing, compare strings, and format numbers.\r\n\r\nCreated [ARROW-14126|https://issues.apache.org/jira/browse/ARROW-14126] to further investigate localization support for string functions.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=edponce",
                        "name": "edponce",
                        "key": "edponce",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=edponce&avatarId=45496",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=edponce&avatarId=45496",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=edponce&avatarId=45496",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=edponce&avatarId=45496"
                        },
                        "displayName": "Eduardo Ponce",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-09-24T19:11:56.156+0000",
                    "updated": "2021-09-24T19:18:47.294+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/comment/17421552",
                    "id": "17421552",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=edponce",
                        "name": "edponce",
                        "key": "edponce",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=edponce&avatarId=45496",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=edponce&avatarId=45496",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=edponce&avatarId=45496",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=edponce&avatarId=45496"
                        },
                        "displayName": "Eduardo Ponce",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "If (for now) we are going to not accept locale option but still want to match *stringr* API, I can think of any of these approaches:\r\n * *str_to_lower(x, locale = \"en\")* -> only accept \"en\" locale and error if other\r\n * *str_to_lower(x, locale = NULL)* -> only accept NULL locale (ie., not supported) and error if another value is given\r\n * *str_to_lower(x, locale)* -> use *missing()* function to R to detect locale arg, if it is provided then error out\r\n * *str_to_lower(x )* -> non-matching API\r\n\r\ncc [~npr] Any suggestions?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=edponce",
                        "name": "edponce",
                        "key": "edponce",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=edponce&avatarId=45496",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=edponce&avatarId=45496",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=edponce&avatarId=45496",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=edponce&avatarId=45496"
                        },
                        "displayName": "Eduardo Ponce",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-09-28T17:26:08.787+0000",
                    "updated": "2021-09-28T17:26:54.424+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/comment/17421631",
                    "id": "17421631",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I made a suggestion on the PR",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-09-28T19:40:38.563+0000",
                    "updated": "2021-09-28T19:40:38.563+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398795/comment/17422756",
                    "id": "17422756",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 11232\n[https://github.com/apache/arrow/pull/11232]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-09-30T12:52:51.350+0000",
                    "updated": "2021-09-30T12:52:51.350+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z0uik8:",
        "customfield_12314139": null
    }
}