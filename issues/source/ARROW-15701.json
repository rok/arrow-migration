{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13428815",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815",
    "key": "ARROW-15701",
    "fields": {
        "parent": {
            "id": "13413587",
            "key": "ARROW-14806",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13413587",
            "fields": {
                "summary": "[R] Implement bindings for lubridate component extraction functions",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                    "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                    "name": "Resolved",
                    "id": "5",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                    "id": "2",
                    "description": "A new feature of the product, which has yet to be developed.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                    "name": "New Feature",
                    "subtask": false,
                    "avatarId": 21141
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12633744",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12633744",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "inwardIssue": {
                    "id": "13413601",
                    "key": "ARROW-14815",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601",
                    "fields": {
                        "summary": "[R] Implement bindings for lubridate::semester",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10800,
            "total": 10800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15701/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 18,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/730559",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1047265737\n\n\n   https://issues.apache.org/jira/browse/ARROW-15701\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T22:19:26.575+0000",
                    "updated": "2022-02-21T22:19:26.575+0000",
                    "started": "2022-02-21T22:19:26.575+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730559",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/735297",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r817682714\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n+      x <- call_binding(\"if_else\",\n+                        call_binding(\"between\", x, 1, 12),\n+                        x,\n+                        NA_integer_)\n+      x <- build_expr(\"cast\", x * 28L, options = cast_options(to_type = date32()))\n\nReview comment:\n       This is a cheeky implementation, but it works. \ud83d\ude04 \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-02T13:19:58.643+0000",
                    "updated": "2022-03-02T13:19:58.643+0000",
                    "started": "2022-03-02T13:19:58.643+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "735297",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/736948",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r819959724\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n\nReview comment:\n       This bit looks repetitive (these should already be integers \u2014 and this cast would then attempt to cast them to integers)? Are you trying to ensure that things aren't int64()? Or something else? \n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -820,6 +816,79 @@ test_that(\"dst extracts daylight savings time correctly\", {\n   )\n })\n \n+test_that(\"month() supports integer input\", {\n+    test_df_month <- tibble(\n+      month_as_int = c(1:12, NA)\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        mutate(month_int_input = month(month_as_int)) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    skip_on_os(\"windows\") # https://issues.apache.org/jira/browse/ARROW-13168\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(month(month_as_int, label = TRUE))\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(\n+            month(month_as_int, label = TRUE, abbr = FALSE)\n+          )) %>%\n\nReview comment:\n       ```suggestion\r\n             )\r\n           ) %>%\r\n   ```\r\n   \r\n   Minor style nit\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n+      x <- call_binding(\"if_else\",\n+                        call_binding(\"between\", x, 1, 12),\n+                        x,\n+                        NA_integer_)\n+      x <- build_expr(\"cast\", x * 28L, options = cast_options(to_type = date32()))\n\nReview comment:\n       We could actually short-circuit here and return the expression with simply `if_else` when `label = FALSE`, since that will return an integer itself, yeah? \r\n   \r\n   I agree that this is a little bit unorthodox, but I _think_ it works. An alternative would be to put this value into a date string with a call to the `paste` binding and then doing `strptime` on that. Both aren't super ideal \u2014 but I suspect that this integer multiplication is going to be more performant (though if we are basing a decision on that, we probably should measure it!). \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T22:35:08.184+0000",
                    "updated": "2022-03-04T22:35:08.184+0000",
                    "started": "2022-03-04T22:35:08.184+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736948",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/736949",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r819967589\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n\nReview comment:\n       It's an oversight from the initial structure which tried to handle things differently based on R object vs `Expression` logic. \r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T22:47:31.497+0000",
                    "updated": "2022-03-04T22:47:31.497+0000",
                    "started": "2022-03-04T22:47:31.497+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736949",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/736950",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r819967589\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n\nReview comment:\n       It's an oversight from the initial structure which tried to handle things differently based on R object vs `Expression` logic. Thanks for catching it \ud83d\udc4d\ud83c\udffb \r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-04T22:47:53.962+0000",
                    "updated": "2022-03-04T22:47:53.962+0000",
                    "started": "2022-03-04T22:47:53.962+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "736950",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/737437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r820527494\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -820,6 +816,79 @@ test_that(\"dst extracts daylight savings time correctly\", {\n   )\n })\n \n+test_that(\"month() supports integer input\", {\n+    test_df_month <- tibble(\n+      month_as_int = c(1:12, NA)\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        mutate(month_int_input = month(month_as_int)) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    skip_on_os(\"windows\") # https://issues.apache.org/jira/browse/ARROW-13168\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(month(month_as_int, label = TRUE))\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(\n+            month(month_as_int, label = TRUE, abbr = FALSE)\n+          )) %>%\n\nReview comment:\n       Done.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-07T09:37:09.031+0000",
                    "updated": "2022-03-07T09:37:09.031+0000",
                    "started": "2022-03-07T09:37:09.030+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "737437",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/737438",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r820532168\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n\nReview comment:\n       Removed duplicated code.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-07T09:42:49.373+0000",
                    "updated": "2022-03-07T09:42:49.373+0000",
                    "started": "2022-03-07T09:42:49.373+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "737438",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/737530",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r820752265\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,7 +105,22 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      if (is.integer(x)) {\n+        x <- build_expr(\"cast\", x, options = cast_options(to_type = int32()))\n+      }\n+      x <- call_binding(\"if_else\",\n+                        call_binding(\"between\", x, 1, 12),\n+                        x,\n+                        NA_integer_)\n+      x <- build_expr(\"cast\", x * 28L, options = cast_options(to_type = date32()))\n\nReview comment:\n       I haven't done any benchmarking yet.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-07T14:24:10.051+0000",
                    "updated": "2022-03-07T14:24:10.051+0000",
                    "started": "2022-03-07T14:24:10.051+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "737530",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r821704331\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,17 +105,39 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      x <- call_binding(\"if_else\",\n+                        call_binding(\"between\", x, 1, 12),\n+                        x,\n+                        NA_integer_)\n+      if (!label) {\n+        # if we don't need a label we can return the integer itself (constrained\n+        # to 1:12)\n+        return(x)\n+      } else {\n+        # make the integer into a date32() - which interprets integers as\n+        # days from epoch (we multiply by 28 to be able to later extract the\n+        # month with label) - NB this builds a false date (to be used by strftime)\n+        # since we only know and care about the month\n+        x <- build_expr(\"cast\", x * 28L, options = cast_options(to_type = date32()))\n+      }\n\nReview comment:\n       This is minor, and a matter of style so feel free to take it or leave it: I tend to do:\r\n   \r\n   ```\r\n   if (condition) {\r\n     return(...)\r\n   }\r\n   \r\n   # code that happens next\r\n   ```\r\n   \r\n   I find that makes the early return stand out a bit more, and saves us some indents on the rest of the larger function.\r\n   \r\n   Like I said, you can take it or leave it, that's very much personal preference.\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -820,6 +816,80 @@ test_that(\"dst extracts daylight savings time correctly\", {\n   )\n })\n \n+test_that(\"month() supports integer input\", {\n+    test_df_month <- tibble(\n+      month_as_int = c(1:12, NA)\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        mutate(month_int_input = month(month_as_int)) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    skip_on_os(\"windows\") # https://issues.apache.org/jira/browse/ARROW-13168\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(month(month_as_int, label = TRUE))\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(\n+            month(month_as_int, label = TRUE, abbr = FALSE)\n+          )\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+  })\n+\n+test_that(\"month() errors with double input and returns NA with int outside 1:12\", {\n+  test_df_month <- tibble(\n+    month_as_int = c(-1L, 1L, 13L, NA),\n+    month_as_double = month_as_int + 0.1\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      record_batch() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n+  expect_equal(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      select(month_as_int) %>%\n+      mutate(month_int_input = month(month_as_int)) %>%\n+      collect(),\n+    tibble(\n+      month_as_int = c(-1L, 1L, 13L, NA),\n+      month_int_input = c(NA, 1L, NA, NA)\n+    )\n+  )\n\nReview comment:\n       Again, a personal style thing, so take it or leave it, but I wonder if we should put this up at the top of this block (or possibly in the block above) so that you have the order {tests expected to work}, {tests expected to error}.\r\n   \r\n   When I first read this block I was like \"Oh this is the errors block\" \u2014 it's actually not (and you mention that in the title), but that's what I thought at first was surprised to see an `expect_equal()` here.\r\n   \r\n   Up to you if you want to take on that style as well.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-08T14:20:23.166+0000",
                    "updated": "2022-03-08T14:20:23.166+0000",
                    "started": "2022-03-08T14:20:23.166+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738165",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738193",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r821815217\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -105,17 +105,39 @@ register_bindings_datetime <- function() {\n     (call_binding(\"yday\", x) - 1) %/% 7 + 1\n   })\n \n-  register_binding(\"month\", function(x, label = FALSE, abbr = TRUE, locale = Sys.getlocale(\"LC_TIME\")) {\n+  register_binding(\"month\", function(x,\n+                                     label = FALSE,\n+                                     abbr = TRUE,\n+                                     locale = Sys.getlocale(\"LC_TIME\")) {\n+\n+    if (call_binding(\"is.integer\", x)) {\n+      x <- call_binding(\"if_else\",\n+                        call_binding(\"between\", x, 1, 12),\n+                        x,\n+                        NA_integer_)\n+      if (!label) {\n+        # if we don't need a label we can return the integer itself (constrained\n+        # to 1:12)\n+        return(x)\n+      } else {\n+        # make the integer into a date32() - which interprets integers as\n+        # days from epoch (we multiply by 28 to be able to later extract the\n+        # month with label) - NB this builds a false date (to be used by strftime)\n+        # since we only know and care about the month\n+        x <- build_expr(\"cast\", x * 28L, options = cast_options(to_type = date32()))\n+      }\n\nReview comment:\n       Done. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-08T16:02:03.800+0000",
                    "updated": "2022-03-08T16:02:03.800+0000",
                    "started": "2022-03-08T16:02:03.800+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738193",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738196",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r821818922\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -820,6 +816,80 @@ test_that(\"dst extracts daylight savings time correctly\", {\n   )\n })\n \n+test_that(\"month() supports integer input\", {\n+    test_df_month <- tibble(\n+      month_as_int = c(1:12, NA)\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        mutate(month_int_input = month(month_as_int)) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    skip_on_os(\"windows\") # https://issues.apache.org/jira/browse/ARROW-13168\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(month(month_as_int, label = TRUE))\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(\n+            month(month_as_int, label = TRUE, abbr = FALSE)\n+          )\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+  })\n+\n+test_that(\"month() errors with double input and returns NA with int outside 1:12\", {\n+  test_df_month <- tibble(\n+    month_as_int = c(-1L, 1L, 13L, NA),\n+    month_as_double = month_as_int + 0.1\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      record_batch() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n+  expect_equal(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      select(month_as_int) %>%\n+      mutate(month_int_input = month(month_as_int)) %>%\n+      collect(),\n+    tibble(\n+      month_as_int = c(-1L, 1L, 13L, NA),\n+      month_int_input = c(NA, 1L, NA, NA)\n+    )\n+  )\n\nReview comment:\n       I kept it in the block, but moved it at the top. Done\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-08T16:05:44.672+0000",
                    "updated": "2022-03-08T16:05:44.672+0000",
                    "started": "2022-03-08T16:05:44.672+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738196",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738831",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#discussion_r822765160\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -820,6 +816,81 @@ test_that(\"dst extracts daylight savings time correctly\", {\n   )\n })\n \n+test_that(\"month() supports integer input\", {\n+    test_df_month <- tibble(\n+      month_as_int = c(1:12, NA)\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        mutate(month_int_input = month(month_as_int)) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    skip_on_os(\"windows\") # https://issues.apache.org/jira/browse/ARROW-13168\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(month(month_as_int, label = TRUE))\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+\n+    compare_dplyr_binding(\n+      .input %>%\n+        # R returns ordered factor whereas Arrow returns character\n+        mutate(\n+          month_int_input = as.character(\n+            month(month_as_int, label = TRUE, abbr = FALSE)\n+          )\n+        ) %>%\n+        collect(),\n+      test_df_month\n+    )\n+  })\n+\n+test_that(\"month() errors with double input and returns NA with int outside 1:12\", {\n+  test_df_month <- tibble(\n+    month_as_int = c(-1L, 1L, 13L, NA),\n+    month_as_double = month_as_int + 0.1\n+  )\n+\n+  expect_equal(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      select(month_as_int) %>%\n+      mutate(month_int_input = month(month_as_int)) %>%\n+      collect(),\n+    tibble(\n+      month_as_int = c(-1L, 1L, 13L, NA),\n+      month_int_input = c(NA, 1L, NA, NA)\n+    )\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      arrow_table() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n+  expect_error(\n+    test_df_month %>%\n+      record_batch() %>%\n+      mutate(month_dbl_input = month(month_as_double)) %>%\n+      collect(),\n+    regexp = \"Function 'month' has no kernel matching input types (array[double])\",\n+    fixed = TRUE\n+  )\n+\n\nReview comment:\n       ```suggestion\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T15:22:16.247+0000",
                    "updated": "2022-03-09T15:22:16.247+0000",
                    "started": "2022-03-09T15:22:16.247+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738831",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738832",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane closed pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T15:24:10.681+0000",
                    "updated": "2022-03-09T15:24:10.681+0000",
                    "started": "2022-03-09T15:24:10.680+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738832",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738839",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1063044311\n\n\n   Benchmark runs are scheduled for baseline = a76794c1a3811a698130f95cf72dcbd6cc372a08 and contender = 1b77e6dfc15f1126731891544376f7b6cb85d5fd. 1b77e6dfc15f1126731891544376f7b6cb85d5fd is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Scheduled] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/13214498df994262a0e689f0f8fc3b45...22ee83f8ac5741b2866d443a225a5efc/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a0d3df74507a43269cb09e72336e9a20...0d46f4f3643041b6a3ebe351cc1d0d65/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b685392d45b5478783c9727ec6b10907...5d823fab6d51496abcc0e17410da4522/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/4818dda29cdf482b890c481a14aaa0ea...1e6155abcc9c4077b5342e7953ed7bc2/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T15:31:37.550+0000",
                    "updated": "2022-03-09T15:31:37.550+0000",
                    "started": "2022-03-09T15:31:37.550+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738839",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738875",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1063044311\n\n\n   Benchmark runs are scheduled for baseline = a76794c1a3811a698130f95cf72dcbd6cc372a08 and contender = 1b77e6dfc15f1126731891544376f7b6cb85d5fd. 1b77e6dfc15f1126731891544376f7b6cb85d5fd is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/13214498df994262a0e689f0f8fc3b45...22ee83f8ac5741b2866d443a225a5efc/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a0d3df74507a43269cb09e72336e9a20...0d46f4f3643041b6a3ebe351cc1d0d65/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b685392d45b5478783c9727ec6b10907...5d823fab6d51496abcc0e17410da4522/)\n   [Scheduled] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/4818dda29cdf482b890c481a14aaa0ea...1e6155abcc9c4077b5342e7953ed7bc2/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T15:51:17.088+0000",
                    "updated": "2022-03-09T15:51:17.088+0000",
                    "started": "2022-03-09T15:51:17.087+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738875",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/738983",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1063044311\n\n\n   Benchmark runs are scheduled for baseline = a76794c1a3811a698130f95cf72dcbd6cc372a08 and contender = 1b77e6dfc15f1126731891544376f7b6cb85d5fd. 1b77e6dfc15f1126731891544376f7b6cb85d5fd is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/13214498df994262a0e689f0f8fc3b45...22ee83f8ac5741b2866d443a225a5efc/)\n   [Scheduled] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a0d3df74507a43269cb09e72336e9a20...0d46f4f3643041b6a3ebe351cc1d0d65/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b685392d45b5478783c9727ec6b10907...5d823fab6d51496abcc0e17410da4522/)\n   [Finished :arrow_down:0.81% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/4818dda29cdf482b890c481a14aaa0ea...1e6155abcc9c4077b5342e7953ed7bc2/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T17:51:42.656+0000",
                    "updated": "2022-03-09T17:51:42.656+0000",
                    "started": "2022-03-09T17:51:42.656+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "738983",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/739003",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1063044311\n\n\n   Benchmark runs are scheduled for baseline = a76794c1a3811a698130f95cf72dcbd6cc372a08 and contender = 1b77e6dfc15f1126731891544376f7b6cb85d5fd. 1b77e6dfc15f1126731891544376f7b6cb85d5fd is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/13214498df994262a0e689f0f8fc3b45...22ee83f8ac5741b2866d443a225a5efc/)\n   [Finished :arrow_down:0.25% :arrow_up:0.0%] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a0d3df74507a43269cb09e72336e9a20...0d46f4f3643041b6a3ebe351cc1d0d65/)\n   [Scheduled] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b685392d45b5478783c9727ec6b10907...5d823fab6d51496abcc0e17410da4522/)\n   [Finished :arrow_down:0.81% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/4818dda29cdf482b890c481a14aaa0ea...1e6155abcc9c4077b5342e7953ed7bc2/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T18:11:44.498+0000",
                    "updated": "2022-03-09T18:11:44.498+0000",
                    "started": "2022-03-09T18:11:44.498+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739003",
                    "issueId": "13428815"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/worklog/739103",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #12482:\nURL: https://github.com/apache/arrow/pull/12482#issuecomment-1063044311\n\n\n   Benchmark runs are scheduled for baseline = a76794c1a3811a698130f95cf72dcbd6cc372a08 and contender = 1b77e6dfc15f1126731891544376f7b6cb85d5fd. 1b77e6dfc15f1126731891544376f7b6cb85d5fd is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/13214498df994262a0e689f0f8fc3b45...22ee83f8ac5741b2866d443a225a5efc/)\n   [Finished :arrow_down:0.25% :arrow_up:0.0%] [test-mac-arm](https://conbench.ursa.dev/compare/runs/a0d3df74507a43269cb09e72336e9a20...0d46f4f3643041b6a3ebe351cc1d0d65/)\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/b685392d45b5478783c9727ec6b10907...5d823fab6d51496abcc0e17410da4522/)\n   [Finished :arrow_down:0.81% :arrow_up:0.0%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/4818dda29cdf482b890c481a14aaa0ea...1e6155abcc9c4077b5342e7953ed7bc2/)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-09T20:42:14.503+0000",
                    "updated": "2022-03-09T20:42:14.503+0000",
                    "started": "2022-03-09T20:42:14.503+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739103",
                    "issueId": "13428815"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 10800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@54026cf1[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6bc38ef[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d963178[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3a8a1165[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2b08ba83[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@141af922[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@786b0728[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@12802079[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7c325c08[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3fa26945[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1f507bde[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@cc003a5[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10800,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Mar 09 15:24:02 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-03-09T15:24:02.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15701/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2022-02-16T13:26:00.000+0000",
        "updated": "2022-03-09T20:42:15.000+0000",
        "timeoriginalestimate": null,
        "description": "*Conclusion*: we will implement this in the R bindings - month will allow integer input: {{month(int)}} will return {{int}} as long as {{int}} is between 1 and 12.\r\n==================================\r\nIn R, more specifically in {{{}lubridate{}}}, {{month()}} can be used both to get and set the corresponding component of a date. This means {{month()}} accepts integer inputs.\r\n{code:r}\r\nsuppressPackageStartupMessages(library(lubridate)) \r\nmonth(1:12)\r\n#>  [1]  1  2  3  4  5  6  7  8  9 10 11 12\r\nmonth(1:13)\r\n#> Error in month.numeric(1:13): Values are not in 1:12\r\n{code}\r\nSolving this would allow us to implement bindings such as `semester()` in a manner closer to {{{}lubridate{}}}.\r\n{code:r}\r\nsuppressPackageStartupMessages(library(dplyr))\r\nsuppressPackageStartupMessages(library(lubridate))\r\n\r\ntest_df <- tibble(\r\n  month_as_int = c(1:12, NA),\r\n  month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\r\n  dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\r\n)\r\n\r\ntest_df %>%\r\n  mutate(\r\n    sem_date = semester(dates),\r\n    sem_month_as_int = semester(month_as_int))\r\n#> # A tibble: 13 \u00d7 5\r\n#>    month_as_int month_as_char_pad dates      sem_date sem_month_as_int\r\n#>           <int> <chr>             <date>        <int>            <int>\r\n#>  1            1 01                2021-01-15        1                1\r\n#>  2            2 02                2021-02-15        1                1\r\n#>  3            3 03                2021-03-15        1                1\r\n#>  4            4 04                2021-04-15        1                1\r\n#>  5            5 05                2021-05-15        1                1\r\n#>  6            6 06                2021-06-15        1                1\r\n#>  7            7 07                2021-07-15        2                2\r\n#>  8            8 08                2021-08-15        2                2\r\n#>  9            9 09                2021-09-15        2                2\r\n#> 10           10 10                2021-10-15        2                2\r\n#> 11           11 11                2021-11-15        2                2\r\n#> 12           12 12                2021-12-15        2                2\r\n#> 13           NA <NA>              NA               NA               NA\r\n{code}\r\n\r\nCurrently attempts to use {{month()}} with integer inputs errors with:\r\n{code:r}\r\nFunction 'month' has no kernel matching input types (array[int32])\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] month() should allow integer inputs",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493242",
                    "id": "17493242",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Can you clarify what the expected output would be for the months kernel with integer input (so eg for {{month(1)}})? \r\n\r\nFor being able to _set_ the component (such as the month) of a timestamp, that could be useful I think (Python also has this concept as a \"replace\" method, eg {{datetime.replace(month=12)}}), but for Arrow I think that would be a separate kernel.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-02-16T13:41:10.487+0000",
                    "updated": "2022-02-16T13:41:10.487+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493249",
                    "id": "17493249",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I think {{month(a)}} should return {{a}} when {{a}} is between 1 and 12 and error otherwise.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-16T14:01:59.040+0000",
                    "updated": "2022-02-16T14:02:42.321+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493266",
                    "id": "17493266",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "body": "Month is currently just an extraction kernel for timestamps and dates, e.g.: month(timestamp[unit]) -> int32. Arrow does not have a \"month array\" concept so month(int) is expected to fail. Are you expecting to do month(int) -> duration?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=rokm",
                        "name": "rokm",
                        "key": "rokm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Rok Mihevc",
                        "active": true,
                        "timeZone": "Europe/Amsterdam"
                    },
                    "created": "2022-02-16T14:54:03.247+0000",
                    "updated": "2022-02-16T14:55:10.236+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493283",
                    "id": "17493283",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "This also should be accomplishable in the R bindings if we want to do it there quickly to unblock things before we decide/wait for the C++ implementation.\r\n\r\nBasically, somewhere in https://github.com/apache/arrow/blob/1b9e76c6b07d557249a949c7c98d00997513d5cc/r/R/dplyr-funcs-datetime.R#L108-L119 check the input type and do casting or follow a slightly different path and return an expression that creates the thing we need.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-16T15:14:41.922+0000",
                    "updated": "2022-02-16T15:14:41.922+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493284",
                    "id": "17493284",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Not necessarily {{month(int) -> duration}}, but in R, in general (and {{lubridate}} in particular), quite a bunch of functionality goes through something like month (which is a slot in the list returned by POSIXlt). In my case the implementation of semester extraction goes through {{month()}}, and also supports integer inputs (in addition to dates and date times). \r\nI haven't started looking into the {{duration}} type in lubridate - there lubridate has {{dmonths}} which could be used to create a {{duration}} object corresponding to a timespan of x months. ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-16T15:14:53.096+0000",
                    "updated": "2022-02-16T15:14:53.096+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493285",
                    "id": "17493285",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "bq. I think month(a) should return a when a is between 1 and 12 and error otherwise. \r\n\r\n\r\nIn that case I suppose that is also easily achievable on the R side? (without complicating the kernel in C++)",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-02-16T15:16:27.804+0000",
                    "updated": "2022-02-16T15:16:27.804+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493288",
                    "id": "17493288",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I think so too - that was the reason behind having the title of the ticket as a question. If this is relevant mostly for R, we could implement it in the binding for {{month()}}. Maybe I should have made it a bit clearer that it is a question rather than an affirmation.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-16T15:21:27.126+0000",
                    "updated": "2022-02-16T15:22:09.595+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17493298",
                    "id": "17493298",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I will edit this issue to refer to R only and I'll look into solving it in the R bindings. Thanks all for your input.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
                        "name": "dragosmg",
                        "key": "dragosmg",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
                        },
                        "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-16T15:35:49.890+0000",
                    "updated": "2022-02-16T15:36:03.314+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815/comment/17503643",
                    "id": "17503643",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 12482\n[https://github.com/apache/arrow/pull/12482]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-03-09T15:24:02.740+0000",
                    "updated": "2022-03-09T15:24:02.740+0000"
                }
            ],
            "maxResults": 9,
            "total": 9,
            "startAt": 0
        },
        "customfield_12311820": "0|z0zmu8:",
        "customfield_12314139": null
    }
}