{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13387354",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354",
    "key": "ARROW-13252",
    "fields": {
        "fixVersions": [],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/10101",
            "id": "10101",
            "description": "Issues which have gone without any activity for an extended period of time",
            "name": "Abandoned"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=neworld",
            "name": "neworld",
            "key": "neworld",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=neworld&avatarId=46652",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=neworld&avatarId=46652",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=neworld&avatarId=46652",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=neworld&avatarId=46652"
            },
            "displayName": "Nate Clark",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "name": "Closed",
            "id": "6",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=neworld",
            "name": "neworld",
            "key": "neworld",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=neworld&avatarId=46652",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=neworld&avatarId=46652",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=neworld&avatarId=46652",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=neworld&avatarId=46652"
            },
            "displayName": "Nate Clark",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=neworld",
            "name": "neworld",
            "key": "neworld",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=neworld&avatarId=46652",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=neworld&avatarId=46652",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=neworld&avatarId=46652",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=neworld&avatarId=46652"
            },
            "displayName": "Nate Clark",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13252/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 25,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/619359",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world opened a new pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662\n\n\n   Add the offset of the start of a row to parsing and decoding errors.\r\n   \r\n   In order to know the row offset during decoding a new array of offsets was added to DataBatch which indicate the offset of the row relative to the offset of the batch. This adds an overhead of an additional vector and an array of ints with one int per row\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-06T13:40:09.828+0000",
                    "updated": "2021-07-06T13:40:09.828+0000",
                    "started": "2021-07-06T13:40:09.827+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "619359",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/619361",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-874770122\n\n\n   https://issues.apache.org/jira/browse/ARROW-13252\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-06T13:41:10.109+0000",
                    "updated": "2021-07-06T13:41:10.109+0000",
                    "started": "2021-07-06T13:41:10.109+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "619361",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/644678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-909720129\n\n\n   @pitrou or @westonpace any opinions on this MR?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-31T23:16:48.479+0000",
                    "updated": "2021-08-31T23:16:48.479+0000",
                    "started": "2021-08-31T23:16:48.479+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "644678",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/644886",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-909720129\n\n\n   @pitrou or @westonpace any opinions on this MR?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-01T09:14:18.117+0000",
                    "updated": "2021-09-01T09:14:18.117+0000",
                    "started": "2021-09-01T09:14:18.116+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "644886",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650219",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#discussion_r707619719\n\n\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n\nReview comment:\n       This should return `Status`.  OOM is a real consideration and it should be, ideally, handled gracefully.\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n+    if (ARROW_PREDICT_FALSE(size_ == capacity_)) {\n+      capacity_ *= 2;\n+      ARROW_CHECK_OK(buffer_->Resize(capacity_ * sizeof(Type)));\n\nReview comment:\n       `RETURN_NOT_OK`\n\n##########\nFile path: cpp/src/arrow/csv/reader.cc\n##########\n@@ -391,17 +391,20 @@ namespace {\n class BlockParsingOperator {\n  public:\n   BlockParsingOperator(io::IOContext io_context, ParseOptions parse_options,\n-                       int num_csv_cols, int64_t first_row)\n+                       int num_csv_cols, int64_t first_row, int64_t offset)\n       : io_context_(io_context),\n         parse_options_(parse_options),\n         num_csv_cols_(num_csv_cols),\n         count_rows_(first_row >= 0),\n-        num_rows_seen_(first_row) {}\n+        num_rows_seen_(first_row),\n+        next_block_offset_(offset) {}\n \n   Result<ParsedBlock> operator()(const CSVBlock& block) {\n     constexpr int32_t max_num_rows = std::numeric_limits<int32_t>::max();\n-    auto parser = std::make_shared<BlockParser>(\n-        io_context_.pool(), parse_options_, num_csv_cols_, num_rows_seen_, max_num_rows);\n+    next_block_offset_ += block.bytes_skipped;\n\nReview comment:\n       At the moment streaming parsing is always serial but that is due to a bug/limitation (ARROW-13155).  Eventually, `operator()` will be called multiple times at once (across multiple blocks).  I think this breaks both `num_rows_seen_` and `next_block_offset_` but we can fix it then.\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n\nReview comment:\n       Ah, I see now this is just how it was before.  I don't think you need to fix it in this PR then.  @pitrou do you know if this was done for performance reasons?\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n\nReview comment:\n       I'm not sure I like the name `TypedXyz` makes me think of \"types\" which, in Arrow, usually means `DataType`.  So I would expect something called a `TypedBuffer` to be similar to an array.  Also, `Buffer` I would think of as something that has a fixed size.  Maybe `ResettableBufferBuilder` or `ResettableBuilder`?  Then the name is pretty similar to the builders we have but the functionality is pretty similar too so I think that fits.\n\n##########\nFile path: cpp/src/arrow/csv/reader.cc\n##########\n@@ -742,6 +751,25 @@ class ReaderMixin {\n     return ParseResult{std::move(parser), static_cast<int64_t>(parsed_size)};\n   }\n \n+  /**\n+   * @brief add the `size()` of all buffers in `block` to `parser_offset_`\n+   * @return the parser offset which should be used by the caller\n+   */\n+  int64_t UpdateParserOffset(const CSVBlock& block) {\n+    parser_offset_ += block.bytes_skipped;\n+    auto result = parser_offset_;\n\nReview comment:\n       It's been a hard habit for me to break but `result` is not a good variable name.  Maybe `updated_offset` or something like that?\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n+    if (ARROW_PREDICT_FALSE(size_ == capacity_)) {\n+      capacity_ *= 2;\n+      ARROW_CHECK_OK(buffer_->Resize(capacity_ * sizeof(Type)));\n+      typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+    }\n+    typed_buffer_[size_++] = value;\n+  }\n+\n+  Status Shrink() {\n+    ARROW_CHECK_OK(buffer_->Resize(size_ * sizeof(Type)));\n+    return arrow::Status::OK();\n\nReview comment:\n       I'm quite certain that `PoolBuffer` will reallocate if a resize shrinks the capacity enough to fit into a smaller power of 2.  As such, you should probably be reassigning `typed_buffer_` here.  Although,  in usage, it appears you only call `Shrink` when you're finished so maybe just name it `Finish` and have it return the `buffer` and get rid of `buffer()`?\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n+    if (ARROW_PREDICT_FALSE(size_ == capacity_)) {\n+      capacity_ *= 2;\n+      ARROW_CHECK_OK(buffer_->Resize(capacity_ * sizeof(Type)));\n+      typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+    }\n+    typed_buffer_[size_++] = value;\n+  }\n+\n+  Status Shrink() {\n+    ARROW_CHECK_OK(buffer_->Resize(size_ * sizeof(Type)));\n\nReview comment:\n       `RETURN_NOT_OK`.  I could maybe be convinced this would never fail since you should be going to a smaller size but since you're returning `Status` anyways it's probably better to be consistent and who knows how allocators choose to work.\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n\nReview comment:\n       This should be `void Append(Type value)` to be consistent with other usage (ParsedValueDesc is passed by value)\n\n##########\nFile path: cpp/src/arrow/csv/reader.cc\n##########\n@@ -742,6 +751,25 @@ class ReaderMixin {\n     return ParseResult{std::move(parser), static_cast<int64_t>(parsed_size)};\n   }\n \n+  /**\n+   * @brief add the `size()` of all buffers in `block` to `parser_offset_`\n+   * @return the parser offset which should be used by the caller\n\nReview comment:\n       Use `\\brief` and `\\return` and `///` comments\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-13T20:08:55.416+0000",
                    "updated": "2021-09-13T20:08:55.416+0000",
                    "started": "2021-09-13T20:08:55.416+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650219",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650220",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#discussion_r707644015\n\n\n\n##########\nFile path: cpp/src/arrow/csv/reader.cc\n##########\n@@ -742,6 +751,25 @@ class ReaderMixin {\n     return ParseResult{std::move(parser), static_cast<int64_t>(parsed_size)};\n   }\n \n+  /**\n+   * @brief add the `size()` of all buffers in `block` to `parser_offset_`\n+   * @return the parser offset which should be used by the caller\n+   */\n+  int64_t UpdateParserOffset(const CSVBlock& block) {\n+    parser_offset_ += block.bytes_skipped;\n+    auto result = parser_offset_;\n\nReview comment:\n       It's been a hard habit for me to break, as I used to do the same thing, but `result` is not a good variable name.  Maybe `updated_offset` or something like that?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-13T20:09:18.759+0000",
                    "updated": "2021-09-13T20:09:18.759+0000",
                    "started": "2021-09-13T20:09:18.759+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650220",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650319",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on a change in pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#discussion_r707847507\n\n\n\n##########\nFile path: cpp/src/arrow/csv/parser.cc\n##########\n@@ -100,6 +100,47 @@ class PresizedDataWriter {\n   int64_t saved_parsed_size_;\n };\n \n+/// \\brief Utility class for writing one type into a buffer\n+/// \\tparam Type of the value stored in this buffer\n+template <typename Type>\n+class TypedBuffer {\n+ public:\n+  explicit TypedBuffer(MemoryPool* pool, int64_t capacity)\n+      : size_(0), capacity_(capacity), mark_(-1) {\n+    buffer_ = *AllocateResizableBuffer(capacity_ * sizeof(Type), pool);\n+    typed_buffer_ = reinterpret_cast<Type*>(buffer_->mutable_data());\n+  }\n+\n+  void Append(const Type& value) {\n+    if (ARROW_PREDICT_FALSE(size_ == capacity_)) {\n+      capacity_ *= 2;\n+      ARROW_CHECK_OK(buffer_->Resize(capacity_ * sizeof(Type)));\n\nReview comment:\n       As noted before this is a void method, so I cannot return the status here.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-14T01:57:40.480+0000",
                    "updated": "2021-09-14T01:57:40.480+0000",
                    "started": "2021-09-14T01:57:40.480+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650319",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650323",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-918737367\n\n\n   > Sorry for the wait for feedback. Have you run the parsing benchmarks in `parser_benchmark.cc`? Does capturing the offset have any noticeable effect on performance?\r\n   \r\n   I was getting some wide variations between runs but these are the best numbers I got for master and this branch\r\n   master:\r\n   \r\n   > ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         168985 ns       168981 ns         4117 bytes_per_second=959.423M/s\r\n   ChunkCSVEscapedBlock        155557 ns       155555 ns         4460 bytes_per_second=980.924M/s\r\n   ChunkCSVNoNewlinesBlock        147 ns          147 ns      4741333 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         263473 ns       263469 ns         2646 bytes_per_second=615.346M/s\r\n   ParseCSVEscapedBlock        209135 ns       209132 ns         3362 bytes_per_second=729.624M/s\r\n   ParseCSVFlightsExample     2175256 ns      2175243 ns          320 bytes_per_second=446.642M/s\r\n   ParseCSVVehiclesExample   15967256 ns     15967111 ns           44 bytes_per_second=718.222M/s\r\n   ParseCSVStocksExample      3463566 ns      3463298 ns          203 bytes_per_second=605.926M/s\r\n   \r\n   This branch:\r\n   > ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         169009 ns       169006 ns         4093 bytes_per_second=959.283M/s\r\n   ChunkCSVEscapedBlock        156445 ns       156443 ns         4467 bytes_per_second=975.356M/s\r\n   ChunkCSVNoNewlinesBlock        149 ns          149 ns      4749759 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         369561 ns       369551 ns         1882 bytes_per_second=438.707M/s\r\n   ParseCSVEscapedBlock        367681 ns       367671 ns         1867 bytes_per_second=415.012M/s\r\n   ParseCSVFlightsExample     2538161 ns      2538102 ns          278 bytes_per_second=382.788M/s\r\n   ParseCSVVehiclesExample   16641194 ns     16639585 ns           42 bytes_per_second=689.196M/s\r\n   ParseCSVStocksExample      3119450 ns      3119364 ns          224 bytes_per_second=672.734M/s\r\n   \r\n   No significant difference that I can see\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-14T02:15:53.517+0000",
                    "updated": "2021-09-14T02:15:53.517+0000",
                    "started": "2021-09-14T02:15:53.517+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650323",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650324",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world edited a comment on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-918737367\n\n\n   > Sorry for the wait for feedback. Have you run the parsing benchmarks in `parser_benchmark.cc`? Does capturing the offset have any noticeable effect on performance?\r\n   \r\n   I was getting some wide variations between runs but these are the best numbers I got for master and this branch\r\n   master:\r\n   \r\n   ` ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         168985 ns       168981 ns         4117 bytes_per_second=959.423M/s\r\n   ChunkCSVEscapedBlock        155557 ns       155555 ns         4460 bytes_per_second=980.924M/s\r\n   ChunkCSVNoNewlinesBlock        147 ns          147 ns      4741333 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         263473 ns       263469 ns         2646 bytes_per_second=615.346M/s\r\n   ParseCSVEscapedBlock        209135 ns       209132 ns         3362 bytes_per_second=729.624M/s\r\n   ParseCSVFlightsExample     2175256 ns      2175243 ns          320 bytes_per_second=446.642M/s\r\n   ParseCSVVehiclesExample   15967256 ns     15967111 ns           44 bytes_per_second=718.222M/s\r\n   ParseCSVStocksExample      3463566 ns      3463298 ns          203 bytes_per_second=605.926M/s`\r\n   \r\n   This branch:\r\n   ` ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         169009 ns       169006 ns         4093 bytes_per_second=959.283M/s\r\n   ChunkCSVEscapedBlock        156445 ns       156443 ns         4467 bytes_per_second=975.356M/s\r\n   ChunkCSVNoNewlinesBlock        149 ns          149 ns      4749759 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         369561 ns       369551 ns         1882 bytes_per_second=438.707M/s\r\n   ParseCSVEscapedBlock        367681 ns       367671 ns         1867 bytes_per_second=415.012M/s\r\n   ParseCSVFlightsExample     2538161 ns      2538102 ns          278 bytes_per_second=382.788M/s\r\n   ParseCSVVehiclesExample   16641194 ns     16639585 ns           42 bytes_per_second=689.196M/s\r\n   ParseCSVStocksExample      3119450 ns      3119364 ns          224 bytes_per_second=672.734M/s`\r\n   \r\n   No significant difference that I can see\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-14T02:16:38.898+0000",
                    "updated": "2021-09-14T02:16:38.898+0000",
                    "started": "2021-09-14T02:16:38.897+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650324",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650325",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world edited a comment on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-918737367\n\n\n   > Sorry for the wait for feedback. Have you run the parsing benchmarks in `parser_benchmark.cc`? Does capturing the offset have any noticeable effect on performance?\r\n   \r\n   I was getting some wide variations between runs but these are the best numbers I got for master and this branch\r\n   master:\r\n   \r\n   ```\r\n    ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         168985 ns       168981 ns         4117 bytes_per_second=959.423M/s\r\n   ChunkCSVEscapedBlock        155557 ns       155555 ns         4460 bytes_per_second=980.924M/s\r\n   ChunkCSVNoNewlinesBlock        147 ns          147 ns      4741333 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         263473 ns       263469 ns         2646 bytes_per_second=615.346M/s\r\n   ParseCSVEscapedBlock        209135 ns       209132 ns         3362 bytes_per_second=729.624M/s\r\n   ParseCSVFlightsExample     2175256 ns      2175243 ns          320 bytes_per_second=446.642M/s\r\n   ParseCSVVehiclesExample   15967256 ns     15967111 ns           44 bytes_per_second=718.222M/s\r\n   ParseCSVStocksExample      3463566 ns      3463298 ns          203 bytes_per_second=605.926M/s\r\n   ```\r\n   \r\n   This branch:\r\n   ```\r\n    ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         169009 ns       169006 ns         4093 bytes_per_second=959.283M/s\r\n   ChunkCSVEscapedBlock        156445 ns       156443 ns         4467 bytes_per_second=975.356M/s\r\n   ChunkCSVNoNewlinesBlock        149 ns          149 ns      4749759 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         369561 ns       369551 ns         1882 bytes_per_second=438.707M/s\r\n   ParseCSVEscapedBlock        367681 ns       367671 ns         1867 bytes_per_second=415.012M/s\r\n   ParseCSVFlightsExample     2538161 ns      2538102 ns          278 bytes_per_second=382.788M/s\r\n   ParseCSVVehiclesExample   16641194 ns     16639585 ns           42 bytes_per_second=689.196M/s\r\n   ParseCSVStocksExample      3119450 ns      3119364 ns          224 bytes_per_second=672.734M/s\r\n   ```\r\n   \r\n   No significant difference that I can see\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-14T02:17:32.478+0000",
                    "updated": "2021-09-14T02:17:32.478+0000",
                    "started": "2021-09-14T02:17:32.478+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650325",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/650326",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world edited a comment on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-918737367\n\n\n   > Sorry for the wait for feedback. Have you run the parsing benchmarks in `parser_benchmark.cc`? Does capturing the offset have any noticeable effect on performance?\r\n   \r\n   I was getting some wide variations between runs but these are the best numbers I got for master and this branch\r\n   master:\r\n   \r\n   ```\r\n    ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         168985 ns       168981 ns         4117 bytes_per_second=959.423M/s\r\n   ChunkCSVEscapedBlock        155557 ns       155555 ns         4460 bytes_per_second=980.924M/s\r\n   ChunkCSVNoNewlinesBlock        147 ns          147 ns      4741333 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         263473 ns       263469 ns         2646 bytes_per_second=615.346M/s\r\n   ParseCSVEscapedBlock        209135 ns       209132 ns         3362 bytes_per_second=729.624M/s\r\n   ParseCSVFlightsExample     2175256 ns      2175243 ns          320 bytes_per_second=446.642M/s\r\n   ParseCSVVehiclesExample   15967256 ns     15967111 ns           44 bytes_per_second=718.222M/s\r\n   ParseCSVStocksExample      3463566 ns      3463298 ns          203 bytes_per_second=605.926M/s\r\n   ```\r\n   \r\n   This branch:\r\n   ```\r\n    ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         169009 ns       169006 ns         4093 bytes_per_second=959.283M/s\r\n   ChunkCSVEscapedBlock        156445 ns       156443 ns         4467 bytes_per_second=975.356M/s\r\n   ChunkCSVNoNewlinesBlock        149 ns          149 ns      4749759 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         369561 ns       369551 ns         1882 bytes_per_second=438.707M/s\r\n   ParseCSVEscapedBlock        367681 ns       367671 ns         1867 bytes_per_second=415.012M/s\r\n   ParseCSVFlightsExample     2538161 ns      2538102 ns          278 bytes_per_second=382.788M/s\r\n   ParseCSVVehiclesExample   16641194 ns     16639585 ns           42 bytes_per_second=689.196M/s\r\n   ParseCSVStocksExample      3119450 ns      3119364 ns          224 bytes_per_second=672.734M/s\r\n   ```\r\n   \r\n   Most have no significant difference but ParseCSVQuotedBlock, ParseCSVEscapedBlock and ParseCSVFlightsExample did show performance degradation\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-09-14T02:21:52.734+0000",
                    "updated": "2021-09-14T02:21:52.734+0000",
                    "started": "2021-09-14T02:21:52.734+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "650326",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/660387",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-934508373\n\n\n   > Most have no significant difference but ParseCSVQuotedBlock, ParseCSVEscapedBlock and ParseCSVFlightsExample did show performance degradation\r\n   \r\n   Sorry for not answering earlier; but the degradation looks quite concerning indeed. A minor difference (e.g. 3-4%) would be ok, but we seem to be getting a 30% slowdown in some of these cases.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-05T15:22:20.589+0000",
                    "updated": "2021-10-05T15:22:20.589+0000",
                    "started": "2021-10-05T15:22:20.589+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "660387",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/664644",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-942316179\n\n\n   > Sorry for not answering earlier; but the degradation looks quite concerning indeed. A minor difference (e.g. 3-4%) would be ok, but we seem to be getting a 30% slowdown in some of these cases.\r\n   \r\n   I agree that the performance change seems severe. I am not sure why adding ints to a second buffer would affect the performance that much. I also was getting wildly different values between runs on the same branch sometimes almost a 50% change so I am not sure how reliable any of those numbers really are. I can play with it some to see if I can figure out what is going on.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T13:36:54.300+0000",
                    "updated": "2021-10-13T13:36:54.300+0000",
                    "started": "2021-10-13T13:36:54.299+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664644",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/664858",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-942316179\n\n\n   > Sorry for not answering earlier; but the degradation looks quite concerning indeed. A minor difference (e.g. 3-4%) would be ok, but we seem to be getting a 30% slowdown in some of these cases.\r\n   \r\n   I agree that the performance change seems severe. I am not sure why adding ints to a second buffer would affect the performance that much. I also was getting wildly different values between runs on the same branch sometimes almost a 50% change so I am not sure how reliable any of those numbers really are. I can play with it some to see if I can figure out what is going on.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T18:21:56.609+0000",
                    "updated": "2021-10-13T18:21:56.609+0000",
                    "started": "2021-10-13T18:21:56.609+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "664858",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/665440",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-942799576\n\n\n   I think I figured out the issue. It was the overhead of checking the buffer bounds on every append. I changed it back to not checking bounds for the fixed size buffer and numbers look much better\r\n   \r\n   ```\r\n   ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         174105 ns       174102 ns         4012 bytes_per_second=931.204M/s\r\n   ChunkCSVEscapedBlock        143420 ns       143417 ns         4863 bytes_per_second=1063.95M/s\r\n   ChunkCSVNoNewlinesBlock        179 ns          179 ns      4276522 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         286099 ns       286084 ns         2434 bytes_per_second=566.703M/s\r\n   ParseCSVEscapedBlock        267409 ns       267403 ns         2612 bytes_per_second=570.629M/s\r\n   ParseCSVFlightsExample     2238658 ns      2238612 ns          310 bytes_per_second=433.999M/s\r\n   ParseCSVVehiclesExample   16297590 ns     16297154 ns           43 bytes_per_second=703.677M/s\r\n   ParseCSVStocksExample      3236563 ns      3236484 ns          216 bytes_per_second=648.39M/s\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T23:38:23.571+0000",
                    "updated": "2021-10-13T23:38:23.571+0000",
                    "started": "2021-10-13T23:38:23.571+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665440",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/665441",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world edited a comment on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-942799576\n\n\n   I think I figured out the issue. It was the overhead of checking the buffer bounds on every append. I changed it back to not checking bounds for the fixed size buffer and numbers look much better\r\n   \r\n   ```\r\n   ----------------------------------------------------------------------------------\r\n   Benchmark                        Time             CPU   Iterations UserCounters...\r\n   ----------------------------------------------------------------------------------\r\n   ChunkCSVQuotedBlock         174105 ns       174102 ns         4012 bytes_per_second=931.204M/s\r\n   ChunkCSVEscapedBlock        143420 ns       143417 ns         4863 bytes_per_second=1063.95M/s\r\n   ChunkCSVNoNewlinesBlock        179 ns          179 ns      4276522 bytes_per_second=0/s\r\n   ParseCSVQuotedBlock         286099 ns       286084 ns         2434 bytes_per_second=566.703M/s\r\n   ParseCSVEscapedBlock        267409 ns       267403 ns         2612 bytes_per_second=570.629M/s\r\n   ParseCSVFlightsExample     2238658 ns      2238612 ns          310 bytes_per_second=433.999M/s\r\n   ParseCSVVehiclesExample   16297590 ns     16297154 ns           43 bytes_per_second=703.677M/s\r\n   ParseCSVStocksExample      3236563 ns      3236484 ns          216 bytes_per_second=648.39M/s\r\n   ```\r\n   \r\n   Those numbers are about what I am getting now for master too\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T23:39:46.849+0000",
                    "updated": "2021-10-13T23:39:46.849+0000",
                    "started": "2021-10-13T23:39:46.849+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665441",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/674643",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-959217878\n\n\n   Any opinion on this @pitrou or @westonpace ?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-03T14:20:41.261+0000",
                    "updated": "2021-11-03T14:20:41.261+0000",
                    "started": "2021-11-03T14:20:41.261+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "674643",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/675523",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-959217878\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-04T00:58:21.197+0000",
                    "updated": "2021-11-04T00:58:21.197+0000",
                    "started": "2021-11-04T00:58:21.197+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "675523",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/676146",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "n3world commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-959217878\n\n\n   Any opinion on this @pitrou or @westonpace ?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-04T02:02:41.712+0000",
                    "updated": "2021-11-04T02:02:41.712+0000",
                    "started": "2021-11-04T02:02:41.712+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "676146",
                    "issueId": "13387354"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/worklog/679736",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #10662:\nURL: https://github.com/apache/arrow/pull/10662#issuecomment-965495803\n\n\n   While the micro-benchmarks don't show any regression, it's quite conceivable that a more memory-heavy workload would show a regression. After all, we're building up an additional buffer, even though it's smaller than the values buffer. So I'm a bit lukewarm on this, especially as the motivation is a rather niche use case.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-10T16:11:39.450+0000",
                    "updated": "2021-11-10T16:11:39.450+0000",
                    "started": "2021-11-10T16:11:39.450+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "679736",
                    "issueId": "13387354"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 15000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7a3dfb8c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d41af3d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@262afbba[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@16229005[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@71bebe89[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3699f74f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@479f2d0d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@45bf2f43[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41719b8b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@38ab2f65[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6629a38[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3a1b6880[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15000,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Feb 14 16:44:29 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-02-14T16:44:29.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13252/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-07-02T14:59:32.000+0000",
        "updated": "2022-02-14T16:44:29.000+0000",
        "timeoriginalestimate": null,
        "description": "CSV parsing error messages will contain the row number when parallel parsing is not enabled but when parallel parsing is enabled there is no indication of where the error occurred in the input. In order to add that context the row byte offset can be added to the output.\r\n\r\n\u00a0\r\n\r\nThis can be done relatively easily for the parser but associating byte offsets with the data or row being decoded would require more metadata to be maintained in the DataBatch. Potentially doubling the size of ParsedValueDesc.\r\n\r\n\u00a0\r\n\r\nThis was mentioned and discussed in comments [here|https://github.com/apache/arrow/pull/10202#issuecomment-870796708]",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] CSV Add byte offset for error messages",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13387354/comment/17492095",
                    "id": "17492095",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=neworld",
                        "name": "neworld",
                        "key": "neworld",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=neworld&avatarId=46652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=neworld&avatarId=46652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=neworld&avatarId=46652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=neworld&avatarId=46652"
                        },
                        "displayName": "Nate Clark",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "After discussions in [PR|https://github.com/apache/arrow/pull/10662] it was determined this functionality is no longer desired.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=neworld",
                        "name": "neworld",
                        "key": "neworld",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=neworld&avatarId=46652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=neworld&avatarId=46652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=neworld&avatarId=46652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=neworld&avatarId=46652"
                        },
                        "displayName": "Nate Clark",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-02-14T16:44:29.800+0000",
                    "updated": "2022-02-14T16:44:29.800+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0sk0w:",
        "customfield_12314139": null
    }
}