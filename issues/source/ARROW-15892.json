{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13432895",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895",
    "key": "ARROW-15892",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12635385",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12635385",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13433165",
                    "key": "ARROW-15906",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433165",
                    "fields": {
                        "summary": "[C++] S3Filesystem shouldn't create new buckets by default",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=sanjibansg",
            "name": "sanjibansg",
            "key": "JIRAUSER282926",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Sanjiban Sengupta",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
            "name": "mRWaffles",
            "key": "JIRAUSER286359",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Jonny Fuller",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
            "name": "mRWaffles",
            "key": "JIRAUSER286359",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Jonny Fuller",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 27600,
            "total": 27600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 27600,
            "total": 27600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15892/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 46,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/746955",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg opened a new pull request #12701:\nURL: https://github.com/apache/arrow/pull/12701\n\n\n   This PR adds a boolean flag which can be used to avoid creating directories with the Dataset API for filesystems like s3.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-24T05:55:40.113+0000",
                    "updated": "2022-03-24T05:55:40.113+0000",
                    "started": "2022-03-24T05:55:40.113+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "746955",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/746957",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12701:\nURL: https://github.com/apache/arrow/pull/12701#issuecomment-1077258152\n\n\n   https://issues.apache.org/jira/browse/ARROW-15892\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-24T05:56:03.813+0000",
                    "updated": "2022-03-24T05:56:03.813+0000",
                    "started": "2022-03-24T05:56:03.813+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "746957",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/750108",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12701:\nURL: https://github.com/apache/arrow/pull/12701#issuecomment-1083151771\n\n\n   @sanjibansg I'm not sure it will be easy to create an automated S3 test with limited permissions, so we may simply punt on that. @westonpace What do you think?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-30T13:37:48.421+0000",
                    "updated": "2022-03-30T13:37:48.421+0000",
                    "started": "2022-03-30T13:37:48.421+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "750108",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/750115",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #12701:\nURL: https://github.com/apache/arrow/pull/12701#issuecomment-1083159837\n\n\n   @pitrou We have precedence for it here: https://github.com/apache/arrow/blob/64560af62391cb8823b3af3ac60991c0de59bac3/python/pyarrow/tests/test_fs.py#L242 so I don't think it would be too difficult to add.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-30T13:45:04.077+0000",
                    "updated": "2022-03-30T13:45:04.077+0000",
                    "started": "2022-03-30T13:45:04.077+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "750115",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/756814",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r850042491\n\n\n##########\npython/pyarrow/includes/libarrow_dataset.pxd:\n##########\n@@ -18,6 +18,7 @@\n # distutils: language = c++\n \n from libcpp.unordered_map cimport unordered_map\n+from libcpp cimport bool\n\nReview Comment:\n   So this works ([it creates an alias for `bint` named `bool`](https://github.com/cython/cython/blob/d2d2ea33a21e1915a52790ef64fdd1f28867854c/Cython/Includes/libcpp/__init__.pxd#L2)) but elsewhere we either use `bint` directly or call it `c_bool` with: `from libcpp cimport bool as c_bool`.  Lets stick with one of the two existing approaches instead of adding a third.\n\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   Why is this method here instead of `util.py`?\n\n\n\n##########\npython/pyarrow/tests/test_dataset.py:\n##########\n@@ -4286,6 +4287,55 @@ def test_write_dataset_s3(s3_example_simple):\n     assert result.equals(table)\n \n \n+_minio_put_only_policy = \"\"\"{\n+    \"Version\": \"2012-10-17\",\n+    \"Statement\": [\n+        {\n+            \"Effect\": \"Allow\",\n+            \"Action\": [\n+                \"s3:PutObject\",\n+                \"s3:ListBucket\",\n+                \"s3:GetObjectVersion\"\n+            ],\n+            \"Resource\": [\n+                \"arn:aws:s3:::*\"\n+            ]\n+        }\n+    ]\n+}\"\"\"\n+\n+\n+@pytest.mark.parquet\n+@pytest.mark.s3\n+def test_write_dataset_s3_put_only(s3_server, limited_s3_user):\n+    from pyarrow.fs import S3FileSystem\n+\n+    # write dataset with s3 filesystem\n+    host, port, _, _ = s3_server['connection']\n+    fs = S3FileSystem(\n+        access_key='limited',\n+        secret_key='limited123',\n+        endpoint_override='{}:{}'.format(host, port),\n+        scheme='http'\n+    )\n+    limited_s3_user(_minio_put_only_policy)\n+    table = pa.table([\n+        pa.array(range(20)), pa.array(np.random.randn(20)),\n+        pa.array(np.repeat(['a', 'b'], 10))],\n+        names=[\"f1\", \"f2\", \"part\"]\n+    )\n+    # writing with filesystem object with create_dir flag set to false\n\nReview Comment:\n   Can you add a check to make sure that writing the dataset with `create_dir=True` fails?  It doesn't really give us any coverage of our code but it allows us to make sure we've configured the limited server correctly so the test is more robust.\n\n\n\n",
                    "created": "2022-04-14T02:58:26.871+0000",
                    "updated": "2022-04-14T02:58:26.871+0000",
                    "started": "2022-04-14T02:58:26.871+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "756814",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/756877",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r850219507\n\n\n##########\ncpp/src/arrow/dataset/file_base.h:\n##########\n@@ -387,6 +387,8 @@ struct ARROW_DS_EXPORT FileSystemDatasetWriteOptions {\n   /// Controls what happens if an output directory already exists.\n   ExistingDataBehavior existing_data_behavior = ExistingDataBehavior::kError;\n \n+  bool create_dir = true;\n\nReview Comment:\n   Can you add a docstring for this?\n\n\n\n##########\npython/pyarrow/dataset.py:\n##########\n@@ -753,7 +753,7 @@ def write_dataset(data, base_dir, basename_template=None, format=None,\n                   max_partitions=None, max_open_files=None,\n                   max_rows_per_file=None, min_rows_per_group=None,\n                   max_rows_per_group=None, file_visitor=None,\n-                  existing_data_behavior='error'):\n+                  existing_data_behavior='error', create_dir=True):\n\nReview Comment:\n   Can you add the corresponding parameter description in the docstring below?\n\n\n\n##########\ncpp/src/arrow/dataset/dataset_writer.cc:\n##########\n@@ -476,7 +478,8 @@ class DatasetWriter::DatasetWriterImpl : public util::AsyncDestroyable {\n   }\n \n   Future<> DoWriteRecordBatch(std::shared_ptr<RecordBatch> batch,\n-                              const std::string& directory, const std::string& prefix) {\n+                              const std::string& directory, const std::string& prefix,\n+                              const bool& create_dir) {\n\nReview Comment:\n   No need to pass primitive types by reference.\r\n   ```suggestion\r\n                                 bool create_dir) {\r\n   ```\n\n\n\n##########\npython/pyarrow/tests/test_dataset.py:\n##########\n@@ -4286,6 +4287,55 @@ def test_write_dataset_s3(s3_example_simple):\n     assert result.equals(table)\n \n \n+_minio_put_only_policy = \"\"\"{\n+    \"Version\": \"2012-10-17\",\n+    \"Statement\": [\n+        {\n+            \"Effect\": \"Allow\",\n+            \"Action\": [\n+                \"s3:PutObject\",\n+                \"s3:ListBucket\",\n+                \"s3:GetObjectVersion\"\n+            ],\n+            \"Resource\": [\n+                \"arn:aws:s3:::*\"\n+            ]\n+        }\n+    ]\n+}\"\"\"\n+\n+\n+@pytest.mark.parquet\n+@pytest.mark.s3\n+def test_write_dataset_s3_put_only(s3_server, limited_s3_user):\n\nReview Comment:\n   Can you add a comment explaining what this test is for, and referencing the JIRA issue number?\n\n\n\n##########\ncpp/src/arrow/dataset/dataset_writer.cc:\n##########\n@@ -476,7 +478,8 @@ class DatasetWriter::DatasetWriterImpl : public util::AsyncDestroyable {\n   }\n \n   Future<> DoWriteRecordBatch(std::shared_ptr<RecordBatch> batch,\n-                              const std::string& directory, const std::string& prefix) {\n+                              const std::string& directory, const std::string& prefix,\n+                              const bool& create_dir) {\n\nReview Comment:\n   Also, I may be misunderstanding, but this parameter doesn't seem actually used?\n\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   Also, why is this a fixture if it's invoked as a regular function?\n\n\n\n",
                    "created": "2022-04-14T08:46:55.788+0000",
                    "updated": "2022-04-14T08:46:55.788+0000",
                    "started": "2022-04-14T08:46:55.788+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "756877",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757469",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851428912\n\n\n##########\npython/pyarrow/includes/libarrow_dataset.pxd:\n##########\n@@ -18,6 +18,7 @@\n # distutils: language = c++\n \n from libcpp.unordered_map cimport unordered_map\n+from libcpp cimport bool\n\nReview Comment:\n   Made the change, thanks!\n\n\n\n##########\ncpp/src/arrow/dataset/file_base.h:\n##########\n@@ -387,6 +387,8 @@ struct ARROW_DS_EXPORT FileSystemDatasetWriteOptions {\n   /// Controls what happens if an output directory already exists.\n   ExistingDataBehavior existing_data_behavior = ExistingDataBehavior::kError;\n \n+  bool create_dir = true;\n\nReview Comment:\n   Added docstring.\n\n\n\n",
                    "created": "2022-04-15T18:38:09.534+0000",
                    "updated": "2022-04-15T18:38:09.534+0000",
                    "started": "2022-04-15T18:38:09.533+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757469",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757470",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851429300\n\n\n##########\ncpp/src/arrow/dataset/dataset_writer.cc:\n##########\n@@ -476,7 +478,8 @@ class DatasetWriter::DatasetWriterImpl : public util::AsyncDestroyable {\n   }\n \n   Future<> DoWriteRecordBatch(std::shared_ptr<RecordBatch> batch,\n-                              const std::string& directory, const std::string& prefix) {\n+                              const std::string& directory, const std::string& prefix,\n+                              const bool& create_dir) {\n\nReview Comment:\n   yes, sorry we don't need to pass it by reference. Yes, the parameter is actually needed. Thanks for pointing that out, thanks!\n\n\n\n",
                    "created": "2022-04-15T18:39:04.784+0000",
                    "updated": "2022-04-15T18:39:04.784+0000",
                    "started": "2022-04-15T18:39:04.784+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757470",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757471",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851429400\n\n\n##########\npython/pyarrow/tests/test_dataset.py:\n##########\n@@ -4286,6 +4287,55 @@ def test_write_dataset_s3(s3_example_simple):\n     assert result.equals(table)\n \n \n+_minio_put_only_policy = \"\"\"{\n+    \"Version\": \"2012-10-17\",\n+    \"Statement\": [\n+        {\n+            \"Effect\": \"Allow\",\n+            \"Action\": [\n+                \"s3:PutObject\",\n+                \"s3:ListBucket\",\n+                \"s3:GetObjectVersion\"\n+            ],\n+            \"Resource\": [\n+                \"arn:aws:s3:::*\"\n+            ]\n+        }\n+    ]\n+}\"\"\"\n+\n+\n+@pytest.mark.parquet\n+@pytest.mark.s3\n+def test_write_dataset_s3_put_only(s3_server, limited_s3_user):\n\nReview Comment:\n   Added the comment.\n\n\n\n",
                    "created": "2022-04-15T18:39:19.796+0000",
                    "updated": "2022-04-15T18:39:19.796+0000",
                    "started": "2022-04-15T18:39:19.796+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757471",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757472",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851429491\n\n\n##########\npython/pyarrow/dataset.py:\n##########\n@@ -753,7 +753,7 @@ def write_dataset(data, base_dir, basename_template=None, format=None,\n                   max_partitions=None, max_open_files=None,\n                   max_rows_per_file=None, min_rows_per_group=None,\n                   max_rows_per_group=None, file_visitor=None,\n-                  existing_data_behavior='error'):\n+                  existing_data_behavior='error', create_dir=True):\n\nReview Comment:\n   Added the parameter desc, thanks!\n\n\n\n",
                    "created": "2022-04-15T18:39:34.842+0000",
                    "updated": "2022-04-15T18:39:34.842+0000",
                    "started": "2022-04-15T18:39:34.841+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757472",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757641",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851708200\n\n\n##########\npython/pyarrow/tests/test_dataset.py:\n##########\n@@ -4286,6 +4287,55 @@ def test_write_dataset_s3(s3_example_simple):\n     assert result.equals(table)\n \n \n+_minio_put_only_policy = \"\"\"{\n+    \"Version\": \"2012-10-17\",\n+    \"Statement\": [\n+        {\n+            \"Effect\": \"Allow\",\n+            \"Action\": [\n+                \"s3:PutObject\",\n+                \"s3:ListBucket\",\n+                \"s3:GetObjectVersion\"\n+            ],\n+            \"Resource\": [\n+                \"arn:aws:s3:::*\"\n+            ]\n+        }\n+    ]\n+}\"\"\"\n+\n+\n+@pytest.mark.parquet\n+@pytest.mark.s3\n+def test_write_dataset_s3_put_only(s3_server, limited_s3_user):\n+    from pyarrow.fs import S3FileSystem\n+\n+    # write dataset with s3 filesystem\n+    host, port, _, _ = s3_server['connection']\n+    fs = S3FileSystem(\n+        access_key='limited',\n+        secret_key='limited123',\n+        endpoint_override='{}:{}'.format(host, port),\n+        scheme='http'\n+    )\n+    limited_s3_user(_minio_put_only_policy)\n+    table = pa.table([\n+        pa.array(range(20)), pa.array(np.random.randn(20)),\n+        pa.array(np.repeat(['a', 'b'], 10))],\n+        names=[\"f1\", \"f2\", \"part\"]\n+    )\n+    # writing with filesystem object with create_dir flag set to false\n\nReview Comment:\n   Made the change.\n\n\n\n",
                    "created": "2022-04-17T06:08:28.854+0000",
                    "updated": "2022-04-17T06:08:28.854+0000",
                    "started": "2022-04-17T06:08:28.854+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757641",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757642",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851709124\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   I was trying to pass arguments in the fixture. See this https://stackoverflow.com/a/44701916\r\n   The fixture `limited_s3_user` can then be used with both the limited policy and the put only policy.\n\n\n\n",
                    "created": "2022-04-17T06:18:49.523+0000",
                    "updated": "2022-04-17T06:18:49.523+0000",
                    "started": "2022-04-17T06:18:49.523+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757642",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757643",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r851709124\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   I was trying to pass arguments in the fixture. See this https://stackoverflow.com/a/44701916\r\n   The fixture `limited_s3_user` can then be used with both the limited policy and the put only policy. But, I am curious why the CI tests are failing, while I think it passes locally.\n\n\n\n",
                    "created": "2022-04-17T06:19:54.742+0000",
                    "updated": "2022-04-17T06:19:54.742+0000",
                    "started": "2022-04-17T06:19:54.741+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757643",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/757962",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r852235866\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   This doesn't answer the question: why do you want it to be a fixture?\n\n\n\n",
                    "created": "2022-04-18T16:24:18.541+0000",
                    "updated": "2022-04-18T16:24:18.541+0000",
                    "started": "2022-04-18T16:24:18.541+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "757962",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758279",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r852600099\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   Sorry, this fixture thing was a little confusing at first. I thought by decorating it as a fixture it should set up the s3 properly with the required permissions. But, that might be the reason of the failing CI. Updated the code where it is no longer a fixture, and moved it to util.py as well. Thanks for the suggestion! \n\n\n\n",
                    "created": "2022-04-19T05:07:55.442+0000",
                    "updated": "2022-04-19T05:07:55.442+0000",
                    "started": "2022-04-19T05:07:55.440+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758279",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758280",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sanjibansg commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r852600099\n\n\n##########\npython/pyarrow/tests/conftest.py:\n##########\n@@ -311,3 +313,23 @@ def s3_server(s3_connection):\n         finally:\n             if proc is not None:\n                 proc.kill()\n+\n+\n+@pytest.fixture(scope='session')\n+def limited_s3_user(request, s3_server):\n\nReview Comment:\n   Sorry, this fixture thing was a little confusing at first. I thought by decorating it as a fixture it should set up the s3 user properly with the required permissions. But, that might be the reason of the failing CI. Updated the code where it is no longer a fixture, and moved it to util.py as well. Thanks for the suggestion! \n\n\n\n",
                    "created": "2022-04-19T05:10:10.836+0000",
                    "updated": "2022-04-19T05:10:10.836+0000",
                    "started": "2022-04-19T05:10:10.836+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758280",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758546",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r853202785\n\n\n##########\ncpp/src/arrow/dataset/file_base.h:\n##########\n@@ -387,6 +387,9 @@ struct ARROW_DS_EXPORT FileSystemDatasetWriteOptions {\n   /// Controls what happens if an output directory already exists.\n   ExistingDataBehavior existing_data_behavior = ExistingDataBehavior::kError;\n \n+  /// Flag to restrict or allow creating directory for writing the dataset.\n\nReview Comment:\n   ```suggestion\r\n     /// Whether to attempt creating the dataset directory.\r\n     /// This can be set to false to work around limited permissions on some filesystems.\r\n   ```\n\n\n\n",
                    "created": "2022-04-19T15:21:00.055+0000",
                    "updated": "2022-04-19T15:21:00.055+0000",
                    "started": "2022-04-19T15:21:00.054+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758546",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758554",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r853206757\n\n\n##########\npython/pyarrow/tests/util.py:\n##########\n@@ -349,3 +351,102 @@ def signal_wakeup_fd(*, warn_on_full_buffer=False):\n             signal.set_wakeup_fd(old_fd)\n         r.close()\n         w.close()\n+\n+\n+def _ensure_minio_component_version(component, minimum_year):\n+    full_args = [component, '--version']\n+    proc = subprocess.Popen(full_args, stdout=subprocess.PIPE,\n+                            stderr=subprocess.PIPE, encoding='utf-8')\n+    if proc.wait(10) != 0:\n+        return False\n+    stdout = proc.stdout.read()\n+    pattern = component + r' version RELEASE\\.(\\d+)-.*'\n+    version_match = re.search(pattern, stdout)\n+    if version_match:\n+        version_year = version_match.group(1)\n+        return int(version_year) >= minimum_year\n+    else:\n+        return False\n+\n+\n+def _wait_for_minio_startup(mcdir, address, access_key, secret_key):\n+    start = time.time()\n+    while time.time() - start < 10:\n+        try:\n+            _run_mc_command(mcdir, 'alias', 'set', 'myminio',\n+                            f'http://{address}', access_key, secret_key)\n+            return\n+        except ChildProcessError:\n+            time.sleep(1)\n+    raise Exception(\"mc command could not connect to local minio\")\n+\n+\n+def _run_mc_command(mcdir, *args):\n+    full_args = ['mc', '-C', mcdir] + list(args)\n+    proc = subprocess.Popen(full_args, stdout=subprocess.PIPE,\n+                            stderr=subprocess.PIPE, encoding='utf-8')\n+    retval = proc.wait(10)\n+    cmd_str = ' '.join(full_args)\n+    print(f'Cmd: {cmd_str}')\n+    print(f'  Return: {retval}')\n+    print(f'  Stdout: {proc.stdout.read()}')\n+    print(f'  Stderr: {proc.stderr.read()}')\n+    if retval != 0:\n+        raise ChildProcessError(\"Could not run mc\")\n+\n+\n+def _configure_limited_user(tmpdir, address, access_key, secret_key, policy):\n+    \"\"\"\n+    Attempts to use the mc command to configure the minio server\n+    with a special user limited:limited123 which does not have\n+    permission to create buckets.  This mirrors some real life S3\n+    configurations where users are given strict permissions.\n+\n+    Arrow S3 operations should still work in such a configuration\n+    (e.g. see ARROW-13685)\n+    \"\"\"\n+    try:\n+        if not _ensure_minio_component_version('mc', 2021):\n+            # mc version is too old for the capabilities we need\n+            return False\n+        if not _ensure_minio_component_version('minio', 2021):\n+            # minio version is too old for the capabilities we need\n+            return False\n+        mcdir = os.path.join(tmpdir, 'mc')\n+        if not os.path.exists(mcdir):\n+            os.mkdir(mcdir)\n+        policy_path = os.path.join(tmpdir, 'limited-buckets-policy.json')\n+        with open(policy_path, mode='w') as policy_file:\n+            policy_file.write(policy)\n+        # The s3_server fixture starts the minio process but\n+        # it takes a few moments for the process to become available\n+        _wait_for_minio_startup(mcdir, address, access_key, secret_key)\n+        # These commands create a limited user with a specific\n+        # policy and creates a sample bucket for that user to\n+        # write to\n+        _run_mc_command(mcdir, 'admin', 'policy', 'add',\n+                        'myminio/', 'no-create-buckets', policy_path)\n+        _run_mc_command(mcdir, 'admin', 'user', 'add',\n+                        'myminio/', 'limited', 'limited123')\n+        _run_mc_command(mcdir, 'admin', 'policy', 'set',\n+                        'myminio', 'no-create-buckets', 'user=limited')\n+        _run_mc_command(mcdir, 'mb', 'myminio/existing-bucket')\n+        return True\n+    except FileNotFoundError:\n+        # If mc is not found, skip these tests\n+        return False\n+\n+\n+def limited_s3_user(s3_server, policy):\n\nReview Comment:\n   Since this is not a fixture anymore, can you merge this with `_configure_limited_user` and name the resulting function e.g. `_configure_s3_limited_user`?\n\n\n\n",
                    "created": "2022-04-19T15:25:05.335+0000",
                    "updated": "2022-04-19T15:25:05.335+0000",
                    "started": "2022-04-19T15:25:05.334+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758554",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758555",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r853207236\n\n\n##########\npython/pyarrow/tests/util.py:\n##########\n@@ -30,6 +30,8 @@\n import string\n import subprocess\n import sys\n+import re\n\nReview Comment:\n   Nit, but please let's keep stdlib imports in alphabetical order.\n\n\n\n",
                    "created": "2022-04-19T15:25:35.445+0000",
                    "updated": "2022-04-19T15:25:35.445+0000",
                    "started": "2022-04-19T15:25:35.445+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758555",
                    "issueId": "13432895"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/worklog/758558",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on code in PR #12701:\nURL: https://github.com/apache/arrow/pull/12701#discussion_r853209670\n\n\n##########\npython/pyarrow/tests/test_dataset.py:\n##########\n@@ -4286,6 +4286,66 @@ def test_write_dataset_s3(s3_example_simple):\n     assert result.equals(table)\n \n \n+_minio_put_only_policy = \"\"\"{\n+    \"Version\": \"2012-10-17\",\n+    \"Statement\": [\n+        {\n+            \"Effect\": \"Allow\",\n+            \"Action\": [\n+                \"s3:PutObject\",\n+                \"s3:ListBucket\",\n+                \"s3:GetObjectVersion\"\n+            ],\n+            \"Resource\": [\n+                \"arn:aws:s3:::*\"\n+            ]\n+        }\n+    ]\n+}\"\"\"\n+\n+\n+@pytest.mark.parquet\n+@pytest.mark.s3\n+def test_write_dataset_s3_put_only(s3_server):\n+    # [ARROW-15892] Testing the create_dir flag which will restrict\n+    # creating a new directory for writing a dataset. This is\n+    # required while writing a dataset in s3 where we have very\n+    # limited permissions and thus we can directly write the dataset\n+    # without creating a directory.\n+    from pyarrow.fs import S3FileSystem\n+\n+    # write dataset with s3 filesystem\n+    host, port, _, _ = s3_server['connection']\n+    fs = S3FileSystem(\n+        access_key='limited',\n+        secret_key='limited123',\n+        endpoint_override='{}:{}'.format(host, port),\n+        scheme='http'\n+    )\n+    limited_s3_user(s3_server, _minio_put_only_policy)\n+    table = pa.table([\n+        pa.array(range(20)), pa.array(np.random.randn(20)),\n+        pa.array(np.repeat(['a', 'b'], 10))],\n+        names=[\"f1\", \"f2\", \"part\"]\n+    )\n+    # writing with filesystem object with create_dir flag set to false\n+    ds.write_dataset(\n+        table, \"existing-bucket\", filesystem=fs,\n+        format=\"feather\", create_dir=False\n+    )\n\nReview Comment:\n   This test doesn't do any partitioning?\n\n\n\n",
                    "created": "2022-04-19T15:28:01.477+0000",
                    "updated": "2022-04-19T15:28:01.477+0000",
                    "started": "2022-04-19T15:28:01.477+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "758558",
                    "issueId": "13432895"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 27600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@65db6b5c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4164d9e2[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c1a8fbb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6b56fc13[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@a9e45c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@143c2bfc[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4c030997[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1069c260[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@682115cc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1d37a0ff[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@49ac4d7f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1788fce8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 27600,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Apr 25 16:52:31 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-04-25T16:52:31.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15892/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2022-03-09T15:48:53.000+0000",
        "updated": "2022-05-01T06:21:04.000+0000",
        "timeoriginalestimate": null,
        "description": "Hi team, first time posting an issue so I apologize if the format is lacking. My original comment is on ARROW-13685 Github Issue [here|https://github.com/apache/arrow/pull/11136#issuecomment-1062406820].\u00a0\r\n\r\nLong story short, our environment is super locked down, and while my application has permission to write data against an s3 prefix, I do not have the {{ListBucket}} permission nor can I add it. This does not prevent me from using the \"individual\" file APIs like {{pq.write_table}} but the bucket validation logic in the \"dataset\" APIs breaks when trying to test for the bucket's existence.\u00a0\r\n{code:java}\r\npq.write_to_dataset(pa.Table.from_batches([data]), location, filesystem=s3fs){code}\r\n{code:java}\r\nOSError: When creating bucket '<my bucket>': AWS Error [code 15]: Access Denied{code}\r\nThe same is true for the generic {{pyarrow.dataset}} APIs. My understanding is the bucket validation logic is part of the C++ code, not the Python API. As a Pythonista who knows nothing of C++ I am not sure how to resolve this problem.\r\n\u00a0\r\nWould it be possible to disable the bucket existence check with an optional key word argument? Thank you for your time!\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "7h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 27600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Dataset APIs require s3:ListBucket Permissions",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503711",
                    "id": "17503711",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Which permissions do you have in that S3 environment exactly?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-03-09T16:33:04.000+0000",
                    "updated": "2022-03-09T16:33:04.000+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503735",
                    "id": "17503735",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=willjones127",
                        "name": "willjones127",
                        "key": "willjones127",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Will Jones",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I think the ListBucket permission grants access to list objects in the bucket, which I think is required for a lot of dataset operations.\r\n\r\nFrom [Amazon's docs|https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-policy-language-overview.html]:\u00a0\r\n{quote}For example, the\u00a0{{s3:ListBucket}}\u00a0permission allows the user to use the Amazon S3\u00a0[GET Bucket (List Objects)|https://docs.aws.amazon.com/AmazonS3/latest/API/RESTBucketGET.html]\u00a0operation.\u00a0\r\n{quote}\r\nThe error you have sounds more like it's from not having s3:CreateBucket? Which I would agree is something that shouldn't be necessary.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=willjones127",
                        "name": "willjones127",
                        "key": "willjones127",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Will Jones",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-03-09T17:03:07.438+0000",
                    "updated": "2022-03-09T17:03:07.438+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503766",
                    "id": "17503766",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
                        "name": "mRWaffles",
                        "key": "JIRAUSER286359",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jonny Fuller",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "My understanding is that the API tries to create a bucket to see if it exists as part of its standard workflow. The only permissions I have are PutObject within a prefix boundary (ie put object at /myapp/namespace/<etc>). I'm looking for a way to bypass the bucket checking step and simply write the data as if I was using the {{write_table}} API.\u00a0\r\n\r\nI should add, I cannot provide the detailed permissions because they are provided by a temporary STS session. To my knowledge there is no way to ask STS \"what permissions does this assumed role have?\" ie you have to actually make requests to see if they are denied. I know I can {{PutObject}} because {{write_table}} ie writing a single parquet file works, as do other single file operations. Only when trying to use the higher level dataset (aka multiple file partition APIs) does my operation fail due to access control issues as detailed above.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
                        "name": "mRWaffles",
                        "key": "JIRAUSER286359",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jonny Fuller",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-03-09T18:08:00.565+0000",
                    "updated": "2022-03-09T18:10:48.083+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503868",
                    "id": "17503868",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I can reproduce this and I agree that the permission in question is probably {{ListBucket}}.  In this case it isn't the logic around checking bucket existence exactly that is causing the problem.  In the datasets module we always call `CreateDir` since the function succeeds if the directory already exists.\r\n\r\nIn s3fs, if the directory is a bucket (e.g. if it is `foo` and not `foo/my_dataset`), we call `CreateBucket` without doing any existence checking at all (then if we get a \"bucket already exists\" error we just return ok).  That explains why the error you are getting is {{\"OSError: When creating bucket\"}} and not {{\"OSError: When testing for existence of bucket\"}}\r\n\r\nIt should be straightforward to add an option to completely disable `CreateDir` calls in datasets.  This would be a little bizarre from a local filesystem perspective but makes perfect sense in an object store where directories don't need to be created.  You would also need to make sure you specify {{existing_data_behavior=overwrite_or_ignore}}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-03-09T21:51:45.854+0000",
                    "updated": "2022-03-09T21:51:45.854+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503873",
                    "id": "17503873",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Actually, I suppose this means that a user might need the {{CreateBucket}} permission (assuming they don't disable CreateDir calls entirely with the aforementioned flag) in order to use {{write_dataset}} if the base directory for their dataset is a bucket.\r\n\r\nIn other words, today, the call {{write_dataset(tab, 'foo', filesystem=s3fs, format='parquet')}} requires both {{CreateBucket}} and {{ListBucket}} permission and the call {{write_dataset(tab, 'foo/my_dataset', filesystem=s3fs, format='parquet')}} only requires {{ListBucket}} permission (assuming the foo bucket exists).  We could probably improve on that as well.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-03-09T22:00:31.488+0000",
                    "updated": "2022-03-09T22:00:48.730+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503902",
                    "id": "17503902",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=willjones127",
                        "name": "willjones127",
                        "key": "willjones127",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Will Jones",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~westonpace] based on my prior experience with S3, I'm actually surprise it would call CreateBucket at all. IMO it should probably error if the bucket doesn't exist by default; buckets are entities that usually have lots of governance around them (tags, permissions, etc), so making it easy for someone to accidentally create one via a typo seems bad.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=willjones127",
                        "name": "willjones127",
                        "key": "willjones127",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Will Jones",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-03-09T23:13:28.268+0000",
                    "updated": "2022-03-09T23:13:28.268+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503930",
                    "id": "17503930",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
                        "name": "mRWaffles",
                        "key": "JIRAUSER286359",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jonny Fuller",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Wow thanks for following up so quickly team. I'm definitely with [~willjones127]. I would want to be very specific about creating buckets.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=mRWaffles",
                        "name": "mRWaffles",
                        "key": "JIRAUSER286359",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jonny Fuller",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2022-03-10T01:03:07.341+0000",
                    "updated": "2022-03-10T01:03:07.341+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17503967",
                    "id": "17503967",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I think this is one of those things that is just a bit leaky when you have a filesystem abstraction that covers both local and remote filesystems.  The flag I described above (don't create directories) ought to prevent any buckets from being created.  We could also add a configuration parameter to the S3FileSystem itself (e.g. \"safe mode\") that would error out if it were asked to create a bucket.  That would help if the user made a typo for example.  I think that probably belongs in a different JIRA so feel free to open.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-03-10T03:10:11.961+0000",
                    "updated": "2022-03-10T03:10:11.961+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17504099",
                    "id": "17504099",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Hmm, I think adding a general S3 option is a good idea. I agree it may not make sense generally to allow implicit creation of buckets (but some S3-compatible backends may have different rules, so it should still be possible).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-03-10T08:48:34.915+0000",
                    "updated": "2022-03-10T08:48:34.915+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13432895/comment/17527634",
                    "id": "17527634",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 12701\n[https://github.com/apache/arrow/pull/12701]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-04-25T16:52:31.460+0000",
                    "updated": "2022-04-25T16:52:31.460+0000"
                }
            ],
            "maxResults": 10,
            "total": 10,
            "startAt": 0
        },
        "customfield_12311820": "0|z10bvs:",
        "customfield_12314139": null
    }
}