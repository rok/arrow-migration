{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13377676",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676",
    "key": "ARROW-12728",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "kernel",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12615334",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12615334",
                "type": {
                    "id": "12310460",
                    "name": "Child-Issue",
                    "inward": "is a child of",
                    "outward": "is a parent of",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310460"
                },
                "inwardIssue": {
                    "id": "13376404",
                    "key": "ARROW-12633",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13376404",
                    "fields": {
                        "summary": "[C++] Query engine umbrella issue",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12621049",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12621049",
                "type": {
                    "id": "12310460",
                    "name": "Child-Issue",
                    "inward": "is a child of",
                    "outward": "is a parent of",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310460"
                },
                "inwardIssue": {
                    "id": "13389644",
                    "key": "ARROW-13339",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13389644",
                    "fields": {
                        "summary": "[C++] Implement hash_aggregate kernels (umbrella issue)",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                            "description": "The issue is open and ready for the assignee to start work on it.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                            "name": "Open",
                            "id": "1",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                                "id": 2,
                                "key": "new",
                                "colorName": "blue-gray",
                                "name": "To Do"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            },
            {
                "id": "12623242",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12623242",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13402017",
                    "key": "ARROW-14035",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13402017",
                    "fields": {
                        "summary": "[C++][Compute] Implement non-hash count_distinct aggregate kernel",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
                            "name": "Critical",
                            "id": "2"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12621050",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12621050",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "inwardIssue": {
                    "id": "13394962",
                    "key": "ARROW-13620",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13394962",
                    "fields": {
                        "summary": "[R] Binding for n_distinct()",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=michalno",
            "name": "michalno",
            "key": "michalno",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Michal Nowakiewicz",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=michalno",
            "name": "michalno",
            "key": "michalno",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Michal Nowakiewicz",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12728/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 17,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/633713",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876\n\n\n   This reuses the Grouper to add kernels for count_distinct and distinct. The implementation for distinct is very simple and not particularly efficient, leveraging Concatenate to build the output list. Neither kernel handles larger-than-memory processing.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-04T17:49:02.992+0000",
                    "updated": "2021-08-04T17:49:02.992+0000",
                    "started": "2021-08-04T17:49:02.992+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "633713",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/633714",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-892851721\n\n\n   https://issues.apache.org/jira/browse/ARROW-12728\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-04T17:49:27.751+0000",
                    "updated": "2021-08-04T17:49:27.751+0000",
                    "started": "2021-08-04T17:49:27.751+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "633714",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/633715",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-892851940\n\n\n   Actually, if we want to keep the `distinct` kernel, either the grouper could be adjusted to build the output list directly, or we should use Take instead of Concatenate.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-04T17:49:40.916+0000",
                    "updated": "2021-08-04T17:49:40.916+0000",
                    "started": "2021-08-04T17:49:40.916+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "633715",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/633808",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-892951968\n\n\n   Changed to use Take() to assemble the final results instead of Concatenate().\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-04T20:28:20.573+0000",
                    "updated": "2021-08-04T20:28:20.573+0000",
                    "started": "2021-08-04T20:28:20.572+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "633808",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/634137",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-892851721\n\n\n   https://issues.apache.org/jira/browse/ARROW-12728\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-05T11:17:27.281+0000",
                    "updated": "2021-08-05T11:17:27.281+0000",
                    "started": "2021-08-05T11:17:27.280+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "634137",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/634249",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-892851940\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-05T11:30:01.072+0000",
                    "updated": "2021-08-05T11:30:01.072+0000",
                    "started": "2021-08-05T11:30:01.071+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "634249",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/634469",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876\n\n\n   This reuses the Grouper to add kernels for count_distinct and distinct. The implementation for distinct is very simple and not particularly efficient, leveraging Concatenate to build the output list. Neither kernel handles larger-than-memory processing.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-05T11:55:10.705+0000",
                    "updated": "2021-08-05T11:55:10.705+0000",
                    "started": "2021-08-05T11:55:10.704+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "634469",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/639602",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r691569047\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate_test.cc\n##########\n@@ -1062,6 +1062,184 @@ TEST(GroupBy, AnyAndAll) {\n   }\n }\n \n+TEST(GroupBy, CountDistinct) {\n+  for (bool use_threads : {true, false}) {\n+    SCOPED_TRACE(use_threads ? \"parallel/merged\" : \"serial\");\n+\n+    auto table =\n+        TableFromJSON(schema({field(\"argument\", float64()), field(\"key\", int64())}), {R\"([\n+    [1,    1],\n+    [1,    1]\n+])\",\n+                                                                                      R\"([\n+    [0,    2],\n+    [null, 3]\n+])\",\n+                                                                                      R\"([\n+    [4,    null],\n+    [1,    3]\n+])\",\n+                                                                                      R\"([\n+    [0,    2],\n+    [-1,   2]\n+])\",\n+                                                                                      R\"([\n+    [1,    null],\n+    [NaN,  3]\n+  ])\",\n+                                                                                      R\"([\n+    [2,    null],\n+    [3,    null]\n+  ])\"});\n+\n+    ASSERT_OK_AND_ASSIGN(Datum aggregated_and_grouped,\n+                         internal::GroupBy(\n+                             {\n+                                 table->GetColumnByName(\"argument\"),\n+                             },\n+                             {\n+                                 table->GetColumnByName(\"key\"),\n+                             },\n+                             {\n+                                 {\"hash_count_distinct\", nullptr},\n+                             },\n+                             use_threads));\n+    SortBy({\"key_0\"}, &aggregated_and_grouped);\n+    ValidateOutput(aggregated_and_grouped);\n+\n+    AssertDatumsEqual(ArrayFromJSON(struct_({\n+                                        field(\"hash_count_distinct\", int64()),\n+                                        field(\"key_0\", int64()),\n+                                    }),\n+                                    R\"([\n+    [1, 1],\n+    [2, 2],\n+    [3, 3],\n+    [4, null]\n+  ])\"),\n+                      aggregated_and_grouped,\n+                      /*verbose=*/true);\n+\n+    table =\n+        TableFromJSON(schema({field(\"argument\", utf8()), field(\"key\", int64())}), {R\"([\n+    [\"foo\",  1],\n+    [\"foo\",  1]\n+])\",\n+                                                                                   R\"([\n+    [\"bar\",  2],\n+    [null,   3]\n+])\",\n+                                                                                   R\"([\n+    [\"baz\",  null],\n+    [\"foo\",  3]\n+])\",\n+                                                                                   R\"([\n+    [\"bar\",  2],\n+    [\"spam\", 2]\n+])\",\n+                                                                                   R\"([\n+    [\"eggs\", null],\n+    [\"ham\",  3]\n+  ])\",\n+                                                                                   R\"([\n+    [\"a\",    null],\n+    [\"b\",    null]\n+  ])\"});\n+\n+    ASSERT_OK_AND_ASSIGN(aggregated_and_grouped,\n+                         internal::GroupBy(\n+                             {\n+                                 table->GetColumnByName(\"argument\"),\n+                             },\n+                             {\n+                                 table->GetColumnByName(\"key\"),\n+                             },\n+                             {\n+                                 {\"hash_count_distinct\", nullptr},\n+                             },\n+                             use_threads));\n+    ValidateOutput(aggregated_and_grouped);\n+    SortBy({\"key_0\"}, &aggregated_and_grouped);\n+\n+    AssertDatumsEqual(ArrayFromJSON(struct_({\n+                                        field(\"hash_count_distinct\", int64()),\n+                                        field(\"key_0\", int64()),\n+                                    }),\n+                                    R\"([\n+    [1, 1],\n+    [2, 2],\n+    [3, 3],\n+    [4, null]\n+  ])\"),\n+                      aggregated_and_grouped,\n+                      /*verbose=*/true);\n+  }\n+}\n+\n+TEST(GroupBy, Distinct) {\n+  for (bool use_threads : {true, false}) {\n+    SCOPED_TRACE(use_threads ? \"parallel/merged\" : \"serial\");\n+\n+    auto table =\n+        TableFromJSON(schema({field(\"argument\", utf8()), field(\"key\", int64())}), {R\"([\n+    [\"foo\",  1],\n+    [\"foo\",  1]\n+])\",\n+                                                                                   R\"([\n+    [\"bar\",  2],\n+    [null,   3]\n+])\",\n+                                                                                   R\"([\n+    [\"baz\",  null],\n+    [\"foo\",  3]\n+])\",\n+                                                                                   R\"([\n+    [\"bar\",  2],\n+    [\"spam\", 2]\n+])\",\n+                                                                                   R\"([\n+    [\"eggs\", null],\n+    [\"ham\",  3]\n+  ])\",\n+                                                                                   R\"([\n+    [\"a\",    null],\n+    [\"b\",    null]\n+  ])\"});\n+\n+    ASSERT_OK_AND_ASSIGN(auto aggregated_and_grouped,\n+                         internal::GroupBy(\n+                             {\n+                                 table->GetColumnByName(\"argument\"),\n+                             },\n+                             {\n+                                 table->GetColumnByName(\"key\"),\n+                             },\n+                             {\n+                                 {\"hash_distinct\", nullptr},\n+                             },\n+                             use_threads));\n+    ValidateOutput(aggregated_and_grouped);\n+    SortBy({\"key_0\"}, &aggregated_and_grouped);\n+\n+    // Order of sub-arrays is not stable\n\nReview comment:\n       That's annoying.\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1828,6 +1828,120 @@ struct GroupedAllImpl : public GroupedAggregator {\n   TypedBufferBuilder<bool> seen_;\n };\n \n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n+    return Status::OK();\n+  }\n+\n+  Status Consume(const ExecBatch& batch) override {\n+    if (!grouper_) {\n+      ARROW_ASSIGN_OR_RAISE(grouper_, Grouper::Make(batch.GetDescriptors(), ctx_));\n+    }\n+    return grouper_->Consume(batch).status();\n+  }\n+\n+  Status Merge(GroupedAggregator&& raw_other,\n+               const ArrayData& group_id_mapping) override {\n+    auto other = checked_cast<GroupedCountDistinctImpl*>(&raw_other);\n+\n+    // Get (group_id, value) pairs, then translate the group IDs and consume them\n+    // ourselves\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, other->grouper_->GetUniques());\n+\n+    const auto* g_mapping = group_id_mapping.GetValues<uint32_t>(1);\n+    auto* other_g = uniques[1].array()->GetMutableValues<uint32_t>(1);\n+    for (int64_t i = 0; i < uniques.length; i++) {\n+      other_g[i] = g_mapping[other_g[i]];\n+    }\n+\n+    return Consume(std::move(uniques));\n+  }\n+\n+  Result<Datum> Finalize() override {\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> values,\n+                          AllocateBuffer(num_groups_ * sizeof(int64_t), pool_));\n+    int64_t* counts = reinterpret_cast<int64_t*>(values->mutable_data());\n+    std::fill(counts, counts + num_groups_, 0);\n+\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, grouper_->GetUniques());\n+    auto* g = uniques[1].array()->GetValues<uint32_t>(1);\n+    for (int64_t i = 0; i < uniques.length; i++) {\n+      counts[g[i]]++;\n+    }\n+\n+    return ArrayData::Make(int64(), num_groups_, {nullptr, std::move(values)},\n+                           /*null_count=*/0);\n+  }\n+\n+  std::shared_ptr<DataType> out_type() const override { return int64(); }\n+\n+  ExecContext* ctx_;\n+  MemoryPool* pool_;\n+  int64_t num_groups_;\n+  std::unique_ptr<Grouper> grouper_;\n+};\n+\n+struct GroupedDistinctImpl : public GroupedCountDistinctImpl {\n+  Result<Datum> Finalize() override {\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, grouper_->GetUniques());\n+\n+    // Assemble the final list via Take\n+\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> offsets_buffer,\n+                          AllocateBuffer((num_groups_ + 1) * sizeof(int32_t), pool_));\n+    int32_t* offsets = reinterpret_cast<int32_t*>(offsets_buffer->mutable_data());\n+\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> take_indices,\n+                          AllocateBuffer(uniques.length * sizeof(int64_t), pool_));\n+    int32_t* indices = reinterpret_cast<int32_t*>(take_indices->mutable_data());\n+\n+    std::vector<std::vector<int32_t>> grouped_slices(num_groups_);\n+\n+    auto* g = uniques[1].array()->GetValues<uint32_t>(1);\n+    for (int32_t i = 0; i < uniques.length; i++) {\n+      grouped_slices[g[i]].push_back(i);\n+    }\n+\n+    offsets[0] = 0;\n+    for (size_t i = 0; i < grouped_slices.size(); i++) {\n+      indices = std::copy(grouped_slices[i].begin(), grouped_slices[i].end(), indices);\n+      offsets[i + 1] = offsets[i] + static_cast<int32_t>(grouped_slices[i].size());\n+    }\n+\n+    ARROW_ASSIGN_OR_RAISE(\n\nReview comment:\n       This looks very similar to Grouper::MakeGroupings and Grouper::ApplyGroupings, any chance of reuse?\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -2257,6 +2381,21 @@ void RegisterHashAggregateBasic(FunctionRegistry* registry) {\n     DCHECK_OK(func->AddKernel(MakeKernel(boolean(), HashAggregateInit<GroupedAllImpl>)));\n     DCHECK_OK(registry->AddFunction(std::move(func)));\n   }\n+\n+  {\n+    auto func = std::make_shared<HashAggregateFunction>(\n+        \"hash_count_distinct\", Arity::Binary(), &hash_count_distinct_doc);\n+    DCHECK_OK(func->AddKernel(\n+        MakeKernel(ValueDescr::ARRAY, HashAggregateInit<GroupedCountDistinctImpl>)));\n\nReview comment:\n       Nit: I'd like to avoid lazy initialization of the Grouper (just to keep it in `Kernel::init` because... that's the init method), should be doable by providing custom `init` for both of these\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1828,6 +1828,120 @@ struct GroupedAllImpl : public GroupedAggregator {\n   TypedBufferBuilder<bool> seen_;\n };\n \n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n\nReview comment:\n       @michalursa what do you think of adding `Grouper::Reserve(additional_capacity_hint)`?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-18T20:27:10.475+0000",
                    "updated": "2021-08-18T20:27:10.475+0000",
                    "started": "2021-08-18T20:27:10.475+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "639602",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/639801",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r692045221\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -2257,6 +2381,21 @@ void RegisterHashAggregateBasic(FunctionRegistry* registry) {\n     DCHECK_OK(func->AddKernel(MakeKernel(boolean(), HashAggregateInit<GroupedAllImpl>)));\n     DCHECK_OK(registry->AddFunction(std::move(func)));\n   }\n+\n+  {\n+    auto func = std::make_shared<HashAggregateFunction>(\n+        \"hash_count_distinct\", Arity::Binary(), &hash_count_distinct_doc);\n+    DCHECK_OK(func->AddKernel(\n+        MakeKernel(ValueDescr::ARRAY, HashAggregateInit<GroupedCountDistinctImpl>)));\n\nReview comment:\n       Concretely: if a type is unsupported by Grouper then as currently written we won't detect that error until the first call to `consume`. Among other things, that means that an `Expression` would successfully bind\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-19T12:01:41.525+0000",
                    "updated": "2021-08-19T12:01:41.525+0000",
                    "started": "2021-08-19T12:01:41.525+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "639801",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/640025",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r692480203\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1828,6 +1828,120 @@ struct GroupedAllImpl : public GroupedAggregator {\n   TypedBufferBuilder<bool> seen_;\n };\n \n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n\nReview comment:\n       The keys here are pairs of `[value, group_id]` so just having the number of groups doesn't give much of a capacity hint.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-19T20:54:44.223+0000",
                    "updated": "2021-08-19T20:54:44.223+0000",
                    "started": "2021-08-19T20:54:44.222+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "640025",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/640026",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r692480479\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1828,6 +1828,120 @@ struct GroupedAllImpl : public GroupedAggregator {\n   TypedBufferBuilder<bool> seen_;\n };\n \n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n+    return Status::OK();\n+  }\n+\n+  Status Consume(const ExecBatch& batch) override {\n+    if (!grouper_) {\n+      ARROW_ASSIGN_OR_RAISE(grouper_, Grouper::Make(batch.GetDescriptors(), ctx_));\n+    }\n+    return grouper_->Consume(batch).status();\n+  }\n+\n+  Status Merge(GroupedAggregator&& raw_other,\n+               const ArrayData& group_id_mapping) override {\n+    auto other = checked_cast<GroupedCountDistinctImpl*>(&raw_other);\n+\n+    // Get (group_id, value) pairs, then translate the group IDs and consume them\n+    // ourselves\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, other->grouper_->GetUniques());\n+\n+    const auto* g_mapping = group_id_mapping.GetValues<uint32_t>(1);\n+    auto* other_g = uniques[1].array()->GetMutableValues<uint32_t>(1);\n+    for (int64_t i = 0; i < uniques.length; i++) {\n+      other_g[i] = g_mapping[other_g[i]];\n+    }\n+\n+    return Consume(std::move(uniques));\n+  }\n+\n+  Result<Datum> Finalize() override {\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> values,\n+                          AllocateBuffer(num_groups_ * sizeof(int64_t), pool_));\n+    int64_t* counts = reinterpret_cast<int64_t*>(values->mutable_data());\n+    std::fill(counts, counts + num_groups_, 0);\n+\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, grouper_->GetUniques());\n+    auto* g = uniques[1].array()->GetValues<uint32_t>(1);\n+    for (int64_t i = 0; i < uniques.length; i++) {\n+      counts[g[i]]++;\n+    }\n+\n+    return ArrayData::Make(int64(), num_groups_, {nullptr, std::move(values)},\n+                           /*null_count=*/0);\n+  }\n+\n+  std::shared_ptr<DataType> out_type() const override { return int64(); }\n+\n+  ExecContext* ctx_;\n+  MemoryPool* pool_;\n+  int64_t num_groups_;\n+  std::unique_ptr<Grouper> grouper_;\n+};\n+\n+struct GroupedDistinctImpl : public GroupedCountDistinctImpl {\n+  Result<Datum> Finalize() override {\n+    ARROW_ASSIGN_OR_RAISE(auto uniques, grouper_->GetUniques());\n+\n+    // Assemble the final list via Take\n+\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> offsets_buffer,\n+                          AllocateBuffer((num_groups_ + 1) * sizeof(int32_t), pool_));\n+    int32_t* offsets = reinterpret_cast<int32_t*>(offsets_buffer->mutable_data());\n+\n+    ARROW_ASSIGN_OR_RAISE(std::shared_ptr<Buffer> take_indices,\n+                          AllocateBuffer(uniques.length * sizeof(int64_t), pool_));\n+    int32_t* indices = reinterpret_cast<int32_t*>(take_indices->mutable_data());\n+\n+    std::vector<std::vector<int32_t>> grouped_slices(num_groups_);\n+\n+    auto* g = uniques[1].array()->GetValues<uint32_t>(1);\n+    for (int32_t i = 0; i < uniques.length; i++) {\n+      grouped_slices[g[i]].push_back(i);\n+    }\n+\n+    offsets[0] = 0;\n+    for (size_t i = 0; i < grouped_slices.size(); i++) {\n+      indices = std::copy(grouped_slices[i].begin(), grouped_slices[i].end(), indices);\n+      offsets[i + 1] = offsets[i] + static_cast<int32_t>(grouped_slices[i].size());\n+    }\n+\n+    ARROW_ASSIGN_OR_RAISE(\n\nReview comment:\n       It turns out it's exactly the composition of the two, thanks for pointing that out.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-19T20:55:07.439+0000",
                    "updated": "2021-08-19T20:55:07.439+0000",
                    "started": "2021-08-19T20:55:07.439+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "640026",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/640027",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r692480633\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -2257,6 +2381,21 @@ void RegisterHashAggregateBasic(FunctionRegistry* registry) {\n     DCHECK_OK(func->AddKernel(MakeKernel(boolean(), HashAggregateInit<GroupedAllImpl>)));\n     DCHECK_OK(registry->AddFunction(std::move(func)));\n   }\n+\n+  {\n+    auto func = std::make_shared<HashAggregateFunction>(\n+        \"hash_count_distinct\", Arity::Binary(), &hash_count_distinct_doc);\n+    DCHECK_OK(func->AddKernel(\n+        MakeKernel(ValueDescr::ARRAY, HashAggregateInit<GroupedCountDistinctImpl>)));\n\nReview comment:\n       Moved initialization into the custom Init function.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-19T20:55:20.800+0000",
                    "updated": "2021-08-19T20:55:20.800+0000",
                    "started": "2021-08-19T20:55:20.799+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "640027",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/640827",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-904086583\n\n\n   @lidavidm needs rebase\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-23T20:11:29.188+0000",
                    "updated": "2021-08-23T20:11:29.188+0000",
                    "started": "2021-08-23T20:11:29.188+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "640827",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/640835",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#issuecomment-904115784\n\n\n   Rebased, thanks for the heads up.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-23T20:46:12.289+0000",
                    "updated": "2021-08-23T20:46:12.289+0000",
                    "started": "2021-08-23T20:46:12.289+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "640835",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/641778",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r695902005\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1900,6 +1900,97 @@ struct GroupedAllImpl : public GroupedBooleanAggregator<GroupedAllImpl> {\n                                  num_groups, /*out_offset=*/0, no_nulls);\n   }\n };\n+\n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n+    return Status::OK();\n+  }\n+\n+  Status Consume(const ExecBatch& batch) override {\n+    return grouper_->Consume(batch).status();\n+  }\n+\n+  Status Merge(GroupedAggregator&& raw_other,\n+               const ArrayData& group_id_mapping) override {\n+    auto other = checked_cast<GroupedCountDistinctImpl*>(&raw_other);\n+\n+    // Get (group_id, value) pairs, then translate the group IDs and consume them\n\nReview comment:\n       Nit: `(value, group_id)` pairs?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T16:08:12.829+0000",
                    "updated": "2021-08-25T16:08:12.829+0000",
                    "started": "2021-08-25T16:08:12.829+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641778",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/641787",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876#discussion_r695910432\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1900,6 +1900,97 @@ struct GroupedAllImpl : public GroupedBooleanAggregator<GroupedAllImpl> {\n                                  num_groups, /*out_offset=*/0, no_nulls);\n   }\n };\n+\n+// ----------------------------------------------------------------------\n+// CountDistinct/Distinct implementation\n+\n+struct GroupedCountDistinctImpl : public GroupedAggregator {\n+  Status Init(ExecContext* ctx, const FunctionOptions* options) override {\n+    ctx_ = ctx;\n+    pool_ = ctx->memory_pool();\n+    return Status::OK();\n+  }\n+\n+  Status Resize(int64_t new_num_groups) override {\n+    num_groups_ = new_num_groups;\n+    return Status::OK();\n+  }\n+\n+  Status Consume(const ExecBatch& batch) override {\n+    return grouper_->Consume(batch).status();\n+  }\n+\n+  Status Merge(GroupedAggregator&& raw_other,\n+               const ArrayData& group_id_mapping) override {\n+    auto other = checked_cast<GroupedCountDistinctImpl*>(&raw_other);\n+\n+    // Get (group_id, value) pairs, then translate the group IDs and consume them\n\nReview comment:\n       Indeed. Thanks, fixed.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T16:18:26.857+0000",
                    "updated": "2021-08-25T16:18:26.857+0000",
                    "started": "2021-08-25T16:18:26.857+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641787",
                    "issueId": "13377676"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/worklog/641971",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz closed pull request #10876:\nURL: https://github.com/apache/arrow/pull/10876\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-08-25T20:49:35.236+0000",
                    "updated": "2021-08-25T20:49:35.236+0000",
                    "started": "2021-08-25T20:49:35.235+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "641971",
                    "issueId": "13377676"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 10200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7dc42d0a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7960ec96[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@481216b4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3668477c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@14459d9b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@160feaf1[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4e70f932[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3a571427[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@246efb3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6b77d568[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2287085d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2073d606[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10200,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Aug 25 20:49:23 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-08-25T20:49:22.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12728/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2021-05-10T18:16:15.000+0000",
        "updated": "2021-09-18T17:44:17.000+0000",
        "timeoriginalestimate": null,
        "description": "Implement count distinct aggregate reusing hash table from hash group by inside of it.\r\n\r\nThis brings support to SQL queries like:\r\nselect a, count(distinct b), count(distinct c) from t group by a\r\n\r\nFor instance to compute count(distinct b), the first group id mapping will give group id based on column a value; then the second group id mapping is done using the key (groupid(a), b) inside count(distinct b) aggregate (similarly for count(distinct c)).\u00a0\r\nAfter all input rows are consumed, the final processing step scans the hash tables based on (groupid(a), b) and updates an array of counts indexed by groupid(a). \r\nThe resulting array of counts represents the output of count distinct aggregate.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Compute] Implement count_distinct/distinct hash aggregate kernels ",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/comment/17380712",
                    "id": "17380712",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "If I understand right, this should be a fairly straightfoward hash aggregate kernel on top of ARROW-12759 - is anyone planning on working on this? I'd like to take it otherwise to get more familiar with the ExecNode/Grouper infrastructure.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
                        "name": "lidavidm",
                        "key": "lidavidm",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "David Li",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-07-14T16:05:47.618+0000",
                    "updated": "2021-07-14T16:05:47.618+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13377676/comment/17404712",
                    "id": "17404712",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 10876\n[https://github.com/apache/arrow/pull/10876]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-08-25T20:49:23.031+0000",
                    "updated": "2021-08-25T20:49:23.031+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0qwfc:",
        "customfield_12314139": null
    }
}