{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13156063",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063",
    "key": "ARROW-2525",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kou",
            "name": "kou",
            "key": "kou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kou&avatarId=30762",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kou&avatarId=30762",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kou&avatarId=30762",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kou&avatarId=30762"
            },
            "displayName": "Kouhei Sutou",
            "active": true,
            "timeZone": "Asia/Tokyo"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12332430",
                "id": "12332430",
                "name": "GLib"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kou",
            "name": "kou",
            "key": "kou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kou&avatarId=30762",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kou&avatarId=30762",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kou&avatarId=30762",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kou&avatarId=30762"
            },
            "displayName": "Kouhei Sutou",
            "active": true,
            "timeZone": "Asia/Tokyo"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kou",
            "name": "kou",
            "key": "kou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kou&avatarId=30762",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kou&avatarId=30762",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kou&avatarId=30762",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kou&avatarId=30762"
            },
            "displayName": "Kouhei Sutou",
            "active": true,
            "timeZone": "Asia/Tokyo"
        },
        "aggregateprogress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 3000,
            "total": 3000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2525/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 5,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/worklog/96566",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou opened a new pull request #1962: ARROW-2525: [GLib] Add garrow_struct_array_flatten()\nURL: https://github.com/apache/arrow/pull/1962\n \n \n   garrow_struct_array_get_fields() is deprecated.\r\n   \r\n   Version related macros are also added for deprecating\r\n   garrow_struct_array_get_fields().\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-04-30T06:23:20.581+0000",
                    "updated": "2018-04-30T06:23:20.581+0000",
                    "started": "2018-04-30T06:23:20.580+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "96566",
                    "issueId": "13156063"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/worklog/97024",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy closed pull request #1962: ARROW-2525: [GLib] Add garrow_struct_array_flatten()\nURL: https://github.com/apache/arrow/pull/1962\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/c_glib/.gitignore b/c_glib/.gitignore\nindex 271914740..a8edddab3 100644\n--- a/c_glib/.gitignore\n+++ b/c_glib/.gitignore\n@@ -40,6 +40,7 @@ Makefile.in\n /arrow-glib/enums.c\n /arrow-glib/enums.h\n /arrow-glib/stamp-*\n+/arrow-glib/version.h\n /arrow-glib/*.pc\n /arrow-gpu-glib/*.pc\n /example/build\ndiff --git a/c_glib/arrow-glib/Makefile.am b/c_glib/arrow-glib/Makefile.am\nindex 9148f8a58..2c8c8f7e3 100644\n--- a/c_glib/arrow-glib/Makefile.am\n+++ b/c_glib/arrow-glib/Makefile.am\n@@ -82,7 +82,8 @@ libarrow_glib_la_headers +=\t\t\t\\\n \tcompute.h\n \n libarrow_glib_la_generated_headers =\t\t\\\n-\tenums.h\n+\tenums.h\t\t\t\t\t\\\n+\tversion.h\n \n libarrow_glib_la_generated_sources =\t\t\\\n \tenums.c\t\t\t\t\t\\\n@@ -166,6 +167,7 @@ libarrow_glib_la_SOURCES =\t\t\t\\\n \t$(libarrow_glib_la_cpp_headers)\n \n BUILT_SOURCES =\t\t\t\t\t\\\n+\t$(libarrow_glib_la_genearted_headers)\t\\\n \t$(libarrow_glib_la_genearted_sources)\t\\\n \tstamp-enums.c\t\t\t\t\\\n \tstamp-enums.h\ndiff --git a/c_glib/arrow-glib/arrow-glib.h b/c_glib/arrow-glib/arrow-glib.h\nindex fb1b37e2c..ba33fda46 100644\n--- a/c_glib/arrow-glib/arrow-glib.h\n+++ b/c_glib/arrow-glib/arrow-glib.h\n@@ -20,6 +20,7 @@\n #pragma once\n \n #include <arrow-glib/gobject-type.h>\n+#include <arrow-glib/version.h>\n \n #include <arrow-glib/array.h>\n #include <arrow-glib/array-builder.h>\ndiff --git a/c_glib/arrow-glib/composite-array.cpp b/c_glib/arrow-glib/composite-array.cpp\nindex 14cc46d73..10aa27d12 100644\n--- a/c_glib/arrow-glib/composite-array.cpp\n+++ b/c_glib/arrow-glib/composite-array.cpp\n@@ -221,22 +221,46 @@ garrow_struct_array_get_field(GArrowStructArray *array,\n  *\n  * Returns: (element-type GArrowArray) (transfer full):\n  *   The fields in the struct.\n+ *\n+ * Deprecated: 0.10.0. Use garrow_struct_array_flatten() instead.\n  */\n GList *\n garrow_struct_array_get_fields(GArrowStructArray *array)\n+{\n+  return garrow_struct_array_flatten(array, NULL);\n+}\n+\n+/**\n+ * garrow_struct_array_flatten\n+ * @array: A #GArrowStructArray.\n+ * @error: (nullable): Return location for a #GError or %NULL.\n+ *\n+ * Returns: (element-type GArrowArray) (transfer full):\n+ *   The fields in the struct.\n+ *\n+ * Since: 0.10.0\n+ */\n+GList *\n+garrow_struct_array_flatten(GArrowStructArray *array, GError **error)\n {\n   const auto arrow_array = garrow_array_get_raw(GARROW_ARRAY(array));\n-  const auto arrow_struct_array =\n-    static_cast<const arrow::StructArray *>(arrow_array.get());\n+  auto arrow_struct_array =\n+    std::static_pointer_cast<arrow::StructArray>(arrow_array);\n+\n+  auto memory_pool = arrow::default_memory_pool();\n+  arrow::ArrayVector arrow_arrays;\n+  auto status = arrow_struct_array->Flatten(memory_pool, &arrow_arrays);\n+  if (!garrow_error_check(error, status, \"[struct-array][flatten]\")) {\n+    return NULL;\n+  }\n \n-  GList *fields = NULL;\n-  for (int i = 0; i < arrow_struct_array->num_fields(); ++i) {\n-    auto arrow_field = arrow_struct_array->field(i);\n-    GArrowArray *field = garrow_array_new_raw(&arrow_field);\n-    fields = g_list_prepend(fields, field);\n+  GList *arrays = NULL;\n+  for (auto arrow_array : arrow_arrays) {\n+    auto array = garrow_array_new_raw(&arrow_array);\n+    arrays = g_list_prepend(arrays, array);\n   }\n \n-  return g_list_reverse(fields);\n+  return g_list_reverse(arrays);\n }\n \n \ndiff --git a/c_glib/arrow-glib/composite-array.h b/c_glib/arrow-glib/composite-array.h\nindex c59a61681..ad6ad53ff 100644\n--- a/c_glib/arrow-glib/composite-array.h\n+++ b/c_glib/arrow-glib/composite-array.h\n@@ -19,6 +19,8 @@\n \n #pragma once\n \n+#include <arrow-glib/version.h>\n+\n #include <arrow-glib/basic-array.h>\n #include <arrow-glib/data-type.h>\n \n@@ -127,8 +129,13 @@ GArrowStructArray *garrow_struct_array_new(GArrowDataType *data_type,\n \n GArrowArray *garrow_struct_array_get_field(GArrowStructArray *array,\n                                            gint i);\n+\n+GARROW_DEPRECATED_IN_0_10_FOR(garrow_struct_array_flatten)\n GList *garrow_struct_array_get_fields(GArrowStructArray *array);\n \n+GARROW_AVAILABLE_IN_0_10\n+GList *garrow_struct_array_flatten(GArrowStructArray *array, GError **error);\n+\n \n #define GARROW_TYPE_DICTIONARY_ARRAY (garrow_dictionary_array_get_type())\n G_DECLARE_DERIVABLE_TYPE(GArrowDictionaryArray,\ndiff --git a/c_glib/arrow-glib/meson.build b/c_glib/arrow-glib/meson.build\nindex 699489ffe..0278ac26a 100644\n--- a/c_glib/arrow-glib/meson.build\n+++ b/c_glib/arrow-glib/meson.build\n@@ -142,6 +142,16 @@ cpp_headers += files(\n )\n \n \n+version_h_conf = configuration_data()\n+version_h_conf.set('GARROW_VERSION_MAJOR', version_major)\n+version_h_conf.set('GARROW_VERSION_MINOR', version_minor)\n+version_h_conf.set('GARROW_VERSION_MICRO', version_micro)\n+version_h_conf.set('GARROW_VERSION_TAG', version_tag)\n+version_h = configure_file(input: 'version.h.in',\n+                           output: 'version.h',\n+                           configuration: version_h_conf)\n+c_headers += version_h\n+\n enums = gnome.mkenums('enums',\n                       sources: c_headers,\n                       identifier_prefix: 'GArrow',\ndiff --git a/c_glib/arrow-glib/version.h.in b/c_glib/arrow-glib/version.h.in\nnew file mode 100644\nindex 000000000..eb734250e\n--- /dev/null\n+++ b/c_glib/arrow-glib/version.h.in\n@@ -0,0 +1,181 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+#pragma once\n+\n+#include <glib.h>\n+\n+/**\n+ * SECTION: version\n+ * @section_id: version-macros\n+ * @title: Version related macros\n+ * @include: arrow-glib/arrow-glib.h\n+ *\n+ * Apache Arrow GLib provides macros that can be used by C pre-processor.\n+ * They are useful to check version related things at compile time.\n+ */\n+\n+/**\n+ * GARROW_VERSION_MAJOR:\n+ *\n+ * The major version.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_MAJOR (@GARROW_VERSION_MAJOR@)\n+\n+/**\n+ * GARROW_VERSION_MINOR:\n+ *\n+ * The minor version.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_MINOR (@GARROW_VERSION_MINOR@)\n+\n+/**\n+ * GARROW_VERSION_MICRO:\n+ *\n+ * The micro version.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_MICRO (@GARROW_VERSION_MICRO@)\n+\n+/**\n+ * GARROW_VERSION_TAG:\n+ *\n+ * The version tag. Normally, it's an empty string. It's \"SNAPSHOT\"\n+ * for snapshot version.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_TAG   \"@GARROW_VERSION_TAG@\"\n+\n+/**\n+ * GARROW_VERSION_CHECK:\n+ * @major: A major version to check for.\n+ * @minor: A minor version to check for.\n+ * @micro: A micro version to check for.\n+ *\n+ * You can use this macro in C pre-processor.\n+ *\n+ * Returns: %TRUE if the compile time Apache Arrow GLib version is the\n+ *   same as or newer than the passed version, %FALSE otherwise.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_CHECK(major, minor, micro)       \\\n+  (GARROW_MAJOR_VERSION > (major) ||                    \\\n+   (GARROW_MAJOR_VERSION == (major) &&                  \\\n+    GARROW_MINOR_VERSION > (minor)) ||                  \\\n+   (GARROW_MAJOR_VERSION == (major) &&                  \\\n+    GARROW_MINOR_VERSION == (minor) &&                  \\\n+    GARROW_MICRO_VERSION >= (micro)))\n+\n+/**\n+ * GARROW_DISABLE_DEPRECATION_WARNINGS:\n+ *\n+ * If this macro is defined, no deprecated warnings are produced.\n+ *\n+ * You must define this macro before including the\n+ * arrow-glib/arrow-glib.h header.\n+ *\n+ * Since: 0.10.0\n+ */\n+\n+#ifdef GARROW_DISABLE_DEPRECATION_WARNINGS\n+#  define GARROW_DEPRECATED\n+#  define GARROW_DEPRECATED_FOR(function)\n+#  define GARROW_UNAVAILABLE(major, minor)\n+#else\n+#  define GARROW_DEPRECATED G_DEPRECATED\n+#  define GARROW_DEPRECATED_FOR(function) G_DEPRECATED_FOR(function)\n+#  define GARROW_UNAVAILABLE(major, minor) G_UNAVAILABLE(major, minor)\n+#endif\n+\n+/**\n+ * GARROW_VERSION_0_10:\n+ *\n+ * You can use this macro value for compile time API version check.\n+ *\n+ * Since: 0.10.0\n+ */\n+#define GARROW_VERSION_0_10 G_ENCODE_VERSION(0, 10)\n+\n+/**\n+ * GARROW_VERSION_MIN_REQUIRED:\n+ *\n+ * You can use this macro for compile time API version check.\n+ *\n+ * This macro value must be one of the predefined version macros such\n+ * as %GARROW_VERSION_0_10.\n+ *\n+ * If you use any functions that is defined by newer version than\n+ * %GARROW_VERSION_MIN_REQUIRED, deprecated warnings are produced at\n+ * compile time.\n+ *\n+ * You must define this macro before including the\n+ * arrow-glib/arrow-glib.h header.\n+ *\n+ * Since: 0.10.0\n+ */\n+#ifndef GARROW_VERSION_MIN_REQUIRED\n+#  define GARROW_VERSION_MIN_REQUIRED                           \\\n+  G_ENCODE_VERSION(GARROW_VERSION_MAJOR, GARROW_VERSION_MINOR)\n+#endif\n+\n+/**\n+ * GARROW_VERSION_MAX_ALLOWED:\n+ *\n+ * You can use this macro for compile time API version check.\n+ *\n+ * This macro value must be one of the predefined version macros such\n+ * as %GARROW_VERSION_0_10.\n+ *\n+ * If you use any functions that is defined by newer version than\n+ * %GARROW_VERSION_MAX_ALLOWED, deprecated warnings are produced at\n+ * compile time.\n+ *\n+ * You must define this macro before including the\n+ * arrow-glib/arrow-glib.h header.\n+ *\n+ * Since: 0.10.0\n+ */\n+#ifndef GARROW_VERSION_MAX_ALLOWED\n+#  define GARROW_VERSION_MAX_ALLOWED            \\\n+  G_ENCODE_VERSION(GARROW_VERSION_MAJOR, GARROW_VERSION_MINOR)\n+#endif\n+\n+\n+#define GARROW_AVAILABLE_IN_ALL\n+\n+#if GARROW_VERSION_MIN_REQUIRED >= GARROW_VERSION_0_10\n+#  define GARROW_DEPRECATED_IN_0_10               GARROW_DEPRECATED\n+#  define GARROW_DEPRECATED_IN_0_10_FOR(function) GARROW_DEPRECATED_FOR(function)\n+#else\n+#  define GARROW_DEPRECATED_IN_0_10\n+#  define GARROW_DEPRECATED_IN_0_10_FOR(function)\n+#endif\n+\n+#if GARROW_VERSION_MAX_ALLOWED < GARROW_VERSION_0_10\n+#  define GARROW_AVAILABLE_IN_0_10 GARROW_UNAVAILABLE(0, 10)\n+#else\n+#  define GARROW_AVAILABLE_IN_0_10\n+#endif\ndiff --git a/c_glib/configure.ac b/c_glib/configure.ac\nindex f4f2c99bb..d80cc9eda 100644\n--- a/c_glib/configure.ac\n+++ b/c_glib/configure.ac\n@@ -19,7 +19,9 @@ AC_PREREQ(2.65)\n \n m4_define([arrow_glib_version],\n            m4_esyscmd(grep \"^  <version>\" \"$(dirname $0)/../java/pom.xml\" | \\\n-                        sed -e 's/\\(^  <version>\\|<\\/version>$\\)//g' | \\\n+                        sed -E \\\n+                            -e 's/(^  <version>)//g' \\\n+                            -e 's/(<\\/version>$)//g' | \\\n                         tr -d '\\n'))\n AC_INIT([arrow-glib],\n         arrow_glib_version,\n@@ -34,6 +36,27 @@ AC_CONFIG_HEADERS([config.h])\n AM_INIT_AUTOMAKE([1.13 foreign])\n AM_SILENT_RULES([yes])\n \n+GARROW_VERSION_MAJOR=$(echo \"arrow_glib_version\" | \\\n+                         sed -E -e 's/^([[0-9]]+)\\..+$/\\1/' | \\\n+                         tr -d '\\n')\n+GARROW_VERSION_MINOR=$(echo \"arrow_glib_version\" | \\\n+                         sed -E -e 's/^[[0-9]]+\\.([[0-9]]+)\\..+$/\\1/' | \\\n+                         tr -d '\\n')\n+GARROW_VERSION_MICRO=$(echo \"arrow_glib_version\" | \\\n+                         sed -E -e 's/^[[0-9]]+\\.[[0-9]]+\\.([[0-9]]+).*$/\\1/' | \\\n+                         tr -d '\\n')\n+if echo \"arrow_glib_version\" | grep -- \"-\" > /dev/null; then\n+  GARROW_VERSION_TAG=$(echo \"arrow_glib_version\" | \\\n+                         sed -E -e 's/^[[0-9]]+\\.[[0-9]]+\\.[[0-9]]+-(.+)$/\\1/' | \\\n+                         tr -d '\\n')\n+else\n+  GARROW_VERSION_TAG=\n+fi\n+AC_SUBST(GARROW_VERSION_MAJOR)\n+AC_SUBST(GARROW_VERSION_MINOR)\n+AC_SUBST(GARROW_VERSION_MICRO)\n+AC_SUBST(GARROW_VERSION_TAG)\n+\n AC_CANONICAL_HOST\n AC_MSG_CHECKING([for macOS])\n case \"$host_os\" in\n@@ -139,6 +162,7 @@ AC_CONFIG_FILES([\n   Makefile\n   arrow-glib/Makefile\n   arrow-glib/arrow-glib.pc\n+  arrow-glib/version.h\n   arrow-gpu-glib/Makefile\n   arrow-gpu-glib/arrow-gpu-glib.pc\n   doc/Makefile\ndiff --git a/c_glib/doc/reference/Makefile.am b/c_glib/doc/reference/Makefile.am\nindex 454c2b069..1c3fdfb4e 100644\n--- a/c_glib/doc/reference/Makefile.am\n+++ b/c_glib/doc/reference/Makefile.am\n@@ -30,7 +30,8 @@ MKDB_OPTIONS =\t\t\t\t\t\\\n \t--source-suffixes=\"c,cpp,h\"\n \n HFILE_GLOB =\t\t\t\t\t\\\n-\t$(top_srcdir)/arrow-glib/*.h\n+\t$(top_srcdir)/arrow-glib/*.h\t\t\\\n+\t$(top_builddir)/arrow-glib/*.h\n \n IGNORE_HFILES =\n \ndiff --git a/c_glib/doc/reference/arrow-glib-docs.xml b/c_glib/doc/reference/arrow-glib-docs.xml\nindex 23d1e9a0f..d318c5e9b 100644\n--- a/c_glib/doc/reference/arrow-glib-docs.xml\n+++ b/c_glib/doc/reference/arrow-glib-docs.xml\n@@ -136,6 +136,14 @@\n   </part>\n   -->\n \n+  <part id=\"misc\">\n+    <title>Misc</title>\n+    <chapter id=\"version\">\n+      <title>Version</title>\n+      <xi:include href=\"xml/version.xml\"></xi:include>\n+    </chapter>\n+  </part>\n+\n   <chapter id=\"object-tree\">\n     <title>Object Hierarchy</title>\n     <xi:include href=\"xml/tree_index.sgml\"/>\n@@ -148,6 +156,14 @@\n     <title>Index of deprecated API</title>\n     <xi:include href=\"xml/api-index-deprecated.xml\"><xi:fallback /></xi:include>\n   </index>\n+  <index id=\"api-index-0-10-0\" role=\"0.10.0\">\n+    <title>Index of new symbols in 0.10.0</title>\n+    <xi:include href=\"xml/api-index-0.10.0.xml\"><xi:fallback /></xi:include>\n+  </index>\n+  <index id=\"api-index-0-9-0\" role=\"0.9.0\">\n+    <title>Index of new symbols in 0.9.0</title>\n+    <xi:include href=\"xml/api-index-0.9.0.xml\"><xi:fallback /></xi:include>\n+  </index>\n   <index id=\"api-index-0-8-0\" role=\"0.8.0\">\n     <title>Index of new symbols in 0.8.0</title>\n     <xi:include href=\"xml/api-index-0.8.0.xml\"><xi:fallback /></xi:include>\ndiff --git a/c_glib/test/test-struct-array.rb b/c_glib/test/test-struct-array.rb\nindex c55e95e4f..78760a9b3 100644\n--- a/c_glib/test/test-struct-array.rb\n+++ b/c_glib/test/test-struct-array.rb\n@@ -50,7 +50,7 @@ def test_new\n                                         -1))\n   end\n \n-  def test_fields\n+  def test_flatten\n     fields = [\n       Arrow::Field.new(\"score\", Arrow::Int8DataType.new),\n       Arrow::Field.new(\"enabled\", Arrow::BooleanDataType.new),\n@@ -74,7 +74,7 @@ def test_fields\n           array.get_field(1).get_value(i),\n         ]\n       else\n-        array.fields.collect do |field|\n+        array.flatten.collect do |field|\n           field.get_value(i)\n         end\n       end\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-01T09:58:57.097+0000",
                    "updated": "2018-05-01T09:58:57.097+0000",
                    "started": "2018-05-01T09:58:57.096+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "97024",
                    "issueId": "13156063"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/worklog/97044",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #1962: ARROW-2525: [GLib] Add garrow_struct_array_flatten()\nURL: https://github.com/apache/arrow/pull/1962#issuecomment-385656422\n \n \n   Looks like this may have broken the glib builds: https://travis-ci.org/apache/arrow/builds/373402983\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-01T12:06:23.325+0000",
                    "updated": "2018-05-01T12:06:23.325+0000",
                    "started": "2018-05-01T12:06:23.325+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "97044",
                    "issueId": "13156063"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/worklog/97054",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on issue #1962: ARROW-2525: [GLib] Add garrow_struct_array_flatten()\nURL: https://github.com/apache/arrow/pull/1962#issuecomment-385662527\n \n \n   Oops.\r\n   We need more work for out-of-source build.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-01T12:44:35.198+0000",
                    "updated": "2018-05-01T12:44:35.198+0000",
                    "started": "2018-05-01T12:44:35.197+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "97054",
                    "issueId": "13156063"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/worklog/97056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on issue #1962: ARROW-2525: [GLib] Add garrow_struct_array_flatten()\nURL: https://github.com/apache/arrow/pull/1962#issuecomment-385662727\n \n \n   I created a pull request for it: #1974 \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2018-05-01T12:45:37.150+0000",
                    "updated": "2018-05-01T12:45:37.150+0000",
                    "started": "2018-05-01T12:45:37.149+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "97056",
                    "issueId": "13156063"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 3000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@14605930[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@62be25be[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5921e477[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4aa1a938[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6771ad[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3b2961b9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6d7d38f7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2ad2b409[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@110342e7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6157cdd7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6569fb8a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5aa469d2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 3000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue May 01 10:00:26 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-05-01T10:00:26.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2525/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2018-04-30T05:58:47.000+0000",
        "updated": "2018-05-01T12:45:37.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 3000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[GLib] Add garrow_struct_array_flatten()",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13156063/comment/16459576",
                    "id": "16459576",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 1962\n[https://github.com/apache/arrow/pull/1962]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2018-05-01T10:00:26.998+0000",
                    "updated": "2018-05-01T10:00:26.998+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|i3t613:",
        "customfield_12314139": null
    }
}