{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13136172",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172",
    "key": "ARROW-2090",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=aposney",
            "name": "aposney",
            "key": "aposney",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Alec Posney",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=aposney",
            "name": "aposney",
            "key": "aposney",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Alec Posney",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=aposney",
            "name": "aposney",
            "key": "aposney",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Alec Posney",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2090/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@64c5b59e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@d1e9d73[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4141d977[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@38cd3129[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@65e85c09[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@62ab6070[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2dee8733[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7c7bafde[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5b54bc4c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@62c5ffb6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3bcb3bc2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1a6f763a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Feb 05 21:56:41 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-02-05T21:56:37.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2090/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-02-05T01:57:06.000+0000",
        "updated": "2018-02-05T21:57:02.000+0000",
        "timeoriginalestimate": null,
        "description": "Add the ability to use python\u00a0{{with}} syntax on the {{ParquetWriter}} object.\r\n\r\nFor example:\r\n{code:python}\r\nwith pq.ParquetWriter(foo, schema) as writer:\r\n    writer.write_table(table)\r\n{code}\r\n\r\nThe benefit of this syntax is that it removes the chances of you writing out a partial (invalid) parquet file, which is currently possible if you forget to call the close method, or more likely the close method is not called due to an exception being thrown. \r\n\r\nIt should still be possible to use the previous syntax for backwards compatibility and fine grained control reasons.\r\nSimilarly, the {{parquet}} module level {{write_table}} method should be able to use the new syntax without changing previous behaviour. ",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Add context manager methods to ParquetWriter",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172/comment/16351975",
                    "id": "16351975",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Posnet opened a new pull request #1559: ARROW-2090: Add context methods to ParquetWriter\nURL: https://github.com/apache/arrow/pull/1559\n \n \n   Added the `__enter__` and `__exit__` methods to the ParquetWriter\r\n   Class. This allows you to write code in the following style:\r\n   \r\n   ```\r\n   with ParquetWriter(foo, schema) as writer:\r\n       writer.write_table(table)\r\n   ```\r\n   \r\n   And the ParquetWriter context object will handle calling the close\r\n   method for you when the with block exits.  It propagates errors\r\n   in line with previous behavior. I have also updated the module\r\n   level `write_table` method to use the new `with` style.\r\n   And it maintains it's existing behavior of trying to remove\r\n   a partial file if an exception is encountered.\r\n   \r\n   The reason for this change, was a bug I encountered while\r\n   using the `ParquetWriter` object, where I wasn't closing\r\n   the writer correctly in the event of an exception, which resulted\r\n   in partially written parquet files. Adding the ability to use\r\n   `with` syntax will reduce the chances of a similar misuse\r\n   while still maintaing backwards compatibility.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-05T01:58:45.872+0000",
                    "updated": "2018-02-05T01:58:45.872+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172/comment/16352007",
                    "id": "16352007",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Posnet commented on issue #1559: ARROW-2090: [Python] Add context methods to ParquetWriter\nURL: https://github.com/apache/arrow/pull/1559#issuecomment-362969944\n \n \n   I'm not sure why the plasma store tests are failing. As far as I can work out, the code I changed doesn't touch the plasma code at all. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-05T03:06:48.588+0000",
                    "updated": "2018-02-05T03:06:48.588+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172/comment/16352632",
                    "id": "16352632",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1559: ARROW-2090: [Python] Add context methods to ParquetWriter\nURL: https://github.com/apache/arrow/pull/1559#issuecomment-363144664\n \n \n   The Plasma failures are likely unrelated, we've been experiencing problems in Travis CI the last couple weeks (see ARROW-2062, ARROW-2071, others)\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-05T16:47:34.701+0000",
                    "updated": "2018-02-05T16:47:34.701+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172/comment/16352983",
                    "id": "16352983",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1559\n[https://github.com/apache/arrow/pull/1559]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-02-05T21:56:37.040+0000",
                    "updated": "2018-02-05T21:56:37.040+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13136172/comment/16352984",
                    "id": "16352984",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1559: ARROW-2090: [Python] Add context methods to ParquetWriter\nURL: https://github.com/apache/arrow/pull/1559\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/doc/source/parquet.rst b/python/doc/source/parquet.rst\nindex d466ba128..ac56520ff 100644\n--- a/python/doc/source/parquet.rst\n+++ b/python/doc/source/parquet.rst\n@@ -139,11 +139,20 @@ We can similarly write a Parquet file with multiple row groups by using\n    pf2 = pq.ParquetFile('example2.parquet')\n    pf2.num_row_groups\n \n+Alternatively python ``with`` syntax can also be use:\n+\n+.. ipython:: python\n+\n+   with pq.ParquetWriter('example3.parquet', table.schema) as writer:\n+       for i in range(3):\n+           writer.write_table(table)\n+\n .. ipython:: python\n    :suppress:\n \n    !rm example.parquet\n    !rm example2.parquet\n+   !rm example3.parquet\n \n Compression, Encoding, and File Compatibility\n ---------------------------------------------\ndiff --git a/python/pyarrow/parquet.py b/python/pyarrow/parquet.py\nindex 3a0924a27..8820b6b4a 100644\n--- a/python/pyarrow/parquet.py\n+++ b/python/pyarrow/parquet.py\n@@ -292,6 +292,14 @@ def __del__(self):\n         if getattr(self, 'is_open', False):\n             self.close()\n \n+    def __enter__(self):\n+        return self\n+\n+    def __exit__(self, *args, **kwargs):\n+        self.close()\n+        # return false since we want to propagate exceptions\n+        return False\n+\n     def write_table(self, table, row_group_size=None):\n         if self.schema_changed:\n             table = _sanitize_table(table, self.schema, self.flavor)\n@@ -932,29 +940,24 @@ def write_table(table, where, row_group_size=None, version='1.0',\n                 flavor=None, **kwargs):\n     row_group_size = kwargs.pop('chunk_size', row_group_size)\n \n-    writer = None\n     try:\n-        writer = ParquetWriter(\n-            where, table.schema,\n-            version=version,\n-            flavor=flavor,\n-            use_dictionary=use_dictionary,\n-            coerce_timestamps=coerce_timestamps,\n-            compression=compression,\n-            use_deprecated_int96_timestamps=use_deprecated_int96_timestamps,\n-            **kwargs)\n-        writer.write_table(table, row_group_size=row_group_size)\n+        with ParquetWriter(\n+                where, table.schema,\n+                version=version,\n+                flavor=flavor,\n+                use_dictionary=use_dictionary,\n+                coerce_timestamps=coerce_timestamps,\n+                compression=compression,\n+                use_deprecated_int96_timestamps= use_deprecated_int96_timestamps, # noqa\n+                **kwargs) as writer:\n+            writer.write_table(table, row_group_size=row_group_size)\n     except Exception:\n-        if writer is not None:\n-            writer.close()\n         if isinstance(where, six.string_types):\n             try:\n                 os.remove(where)\n             except os.error:\n                 pass\n         raise\n-    else:\n-        writer.close()\n \n \n write_table.__doc__ = \"\"\"\ndiff --git a/python/pyarrow/tests/test_parquet.py b/python/pyarrow/tests/test_parquet.py\nindex 7c2edb378..c49f3d396 100644\n--- a/python/pyarrow/tests/test_parquet.py\n+++ b/python/pyarrow/tests/test_parquet.py\n@@ -1673,3 +1673,66 @@ def test_decimal_roundtrip_negative_scale(tmpdir):\n     result_table = _read_table(string_filename)\n     result = result_table.to_pandas()\n     tm.assert_frame_equal(result, expected)\n+\n+\n+@parquet\n+def test_parquet_writer_context_obj(tmpdir):\n+\n+    import pyarrow.parquet as pq\n+\n+    df = _test_dataframe(100)\n+    df['unique_id'] = 0\n+\n+    arrow_table = pa.Table.from_pandas(df, preserve_index=False)\n+    out = pa.BufferOutputStream()\n+\n+    with pq.ParquetWriter(out, arrow_table.schema, version='2.0') as writer:\n+\n+        frames = []\n+        for i in range(10):\n+            df['unique_id'] = i\n+            arrow_table = pa.Table.from_pandas(df, preserve_index=False)\n+            writer.write_table(arrow_table)\n+\n+            frames.append(df.copy())\n+\n+    buf = out.get_result()\n+    result = _read_table(pa.BufferReader(buf))\n+\n+    expected = pd.concat(frames, ignore_index=True)\n+    tm.assert_frame_equal(result.to_pandas(), expected)\n+\n+\n+@parquet\n+def test_parquet_writer_context_obj_with_exception(tmpdir):\n+\n+    import pyarrow.parquet as pq\n+\n+    df = _test_dataframe(100)\n+    df['unique_id'] = 0\n+\n+    arrow_table = pa.Table.from_pandas(df, preserve_index=False)\n+    out = pa.BufferOutputStream()\n+    error_text = 'Artificial Error'\n+\n+    try:\n+        with pq.ParquetWriter(out,\n+                              arrow_table.schema,\n+                              version='2.0') as writer:\n+\n+            frames = []\n+            for i in range(10):\n+                df['unique_id'] = i\n+                arrow_table = pa.Table.from_pandas(df, preserve_index=False)\n+                writer.write_table(arrow_table)\n+                frames.append(df.copy())\n+                if i == 5:\n+                    raise ValueError(error_text)\n+    except Exception as e:\n+        assert str(e) == error_text\n+\n+    buf = out.get_result()\n+    result = _read_table(pa.BufferReader(buf))\n+\n+    expected = pd.concat(frames, ignore_index=True)\n+    tm.assert_frame_equal(result.to_pandas(), expected)\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-02-05T21:56:41.081+0000",
                    "updated": "2018-02-05T21:56:41.081+0000"
                }
            ],
            "maxResults": 5,
            "total": 5,
            "startAt": 0
        },
        "customfield_12311820": "0|i3ps5z:",
        "customfield_12314139": null
    }
}