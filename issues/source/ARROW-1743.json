{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13112671",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671",
    "key": "ARROW-1743",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341666",
                "id": "12341666",
                "name": "0.7.1",
                "archived": false,
                "released": true,
                "releaseDate": "2017-10-01"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Licht-T",
            "name": "Licht-T",
            "key": "licht-t",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=licht-t&avatarId=33236",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=licht-t&avatarId=33236",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=licht-t&avatarId=33236",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=licht-t&avatarId=33236"
            },
            "displayName": "Licht Takeuchi",
            "active": true,
            "timeZone": "Asia/Tokyo"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=brianpendleton",
            "name": "brianpendleton",
            "key": "brianpendleton",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10441",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"
            },
            "displayName": "Brian Pendleton",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=brianpendleton",
            "name": "brianpendleton",
            "key": "brianpendleton",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10441",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10441",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10441",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10441"
            },
            "displayName": "Brian Pendleton",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1743/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3c79a798[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7496e283[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@68aa1970[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2b6b7c1c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33baf639[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@5b8963ba[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@63509022[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@132b9bc8[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7744acaa[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@67c0854b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76d811[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4fccf60c[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Nov 14 03:47:32 UTC 2017",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2017-11-14T03:47:30.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1743/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2017-10-27T20:34:07.000+0000",
        "updated": "2017-11-14T03:47:32.000+0000",
        "timeoriginalestimate": null,
        "description": "Categorical columns in the index of a dataframe are causing a roundtrip failure.  \r\n\r\n{code}\r\n>>> df = pd.DataFrame({'a': [1, 2, 3], 'b': [1, 2, 3]})\r\n>>> df['a'] = df.a.astype('category')\r\n>>> df = df.set_index('a')\r\n>>> tbl = pa.Table.from_pandas(df)\r\n>>> tbl.to_pandas()\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\n  File \"table.pxi\", line 881, in pyarrow.lib.Table.to_pandas\r\n  File \"C:\\Users\\bpendlet\\Miniconda3\\envs\\panpy3\\lib\\site-packages\\pyarrow\\pandas_compat.py\", line 303, in table_to_blockmanager\r\n    if not values.flags.writeable:\r\nAttributeError: 'Categorical' object has no attribute 'flags'\r\n{code}\r\n\r\n\r\nWorks as expected when you don't change have the categorical:\r\n{code}\r\n>>> df = pd.DataFrame({'a': [1, 2, 3], 'b': [1, 2, 3]})\r\n>>> df = df.set_index('a')\r\n>>> tbl = pa.Table.from_pandas(df)\r\n>>> tbl.to_pandas()\r\n   b\r\na\r\n1  1\r\n2  2\r\n3  3\r\n{code}\r\n",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Table to_pandas fails when index contains categorical column",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223173",
                    "id": "16223173",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T opened a new pull request #1260: ARROW-1743: [Python] Avoid non-array writable check\nURL: https://github.com/apache/arrow/pull/1260\n \n \n   This closes [ARROW-1743](https://issues.apache.org/jira/projects/ARROW/issues/ARROW-1743).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T02:53:34.915+0000",
                    "updated": "2017-10-28T02:53:34.915+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223456",
                    "id": "16223456",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147552976\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   For categorical columns, we need to check `values.categories.values` and `values.codes` for writability. You can check for categorical columns either by using the dtype or `isinstance(value, pd.Categorical)`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T12:09:41.328+0000",
                    "updated": "2017-10-28T12:09:41.328+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223488",
                    "id": "16223488",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147553977\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   @xhochy Do we need to check writability of `Categorical.codes` and `Categorical.categories .values` even if we cannot edit directly?\r\n   ```\r\n   >>> import pandas as pd\r\n   >>> import numpy as np\r\n   >>> values = pd.Categorical(['A', 'A'])\r\n   >>> \r\n   >>> arr = pa.DictionaryArray.from_arrays(\r\n   ...     np.array([0, 0]),\r\n   ...     np.array([100]))\r\n   >>>\r\n   >>> result = arr.to_pandas()\r\n   >>>\r\n   >>> result.categories.values\r\n   array([100])\r\n   >>> result.categories.values[:] = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   ValueError: assignment destination is read-only\r\n   >>> \r\n   >>> result.codes\r\n   array([0, 0], dtype=int8)\r\n   >>> result.codes[:] = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   ValueError: assignment destination is read-only\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T13:06:52.862+0000",
                    "updated": "2017-10-28T13:06:52.862+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223490",
                    "id": "16223490",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147553977\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   @xhochy Do we need to check writability of `Categorical.codes` and `Categorical.categories.values` even if we cannot edit directly?\r\n   ```python\r\n   >>> import pandas as pd\r\n   >>> import numpy as np\r\n   >>> values = pd.Categorical(['A', 'A'])\r\n   >>> \r\n   >>> arr = pa.DictionaryArray.from_arrays(\r\n   ...     np.array([0, 0]),\r\n   ...     np.array([100]))\r\n   >>>\r\n   >>> result = arr.to_pandas()\r\n   >>>\r\n   >>> result.categories.values\r\n   array([100])\r\n   >>> result.categories.values[:] = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   ValueError: assignment destination is read-only\r\n   >>> \r\n   >>> result.codes\r\n   array([0, 0], dtype=int8)\r\n   >>> result.codes[:] = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   ValueError: assignment destination is read-only\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T13:07:23.908+0000",
                    "updated": "2017-10-28T13:07:23.908+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223495",
                    "id": "16223495",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147553977\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   @xhochy Do we need to check writability of `Categorical.codes` even if we cannot edit directly?\r\n   ```python\r\n   >>> import pandas as pd\r\n   >>> import numpy as np\r\n   >>> values = pd.Categorical(['A', 'A'])\r\n   >>> \r\n   >>> arr = pa.DictionaryArray.from_arrays(\r\n   ...     np.array([0, 0]),\r\n   ...     np.array([100]))\r\n   >>>\r\n   >>> result = arr.to_pandas()\r\n   >>>\r\n   >>> result.codes = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n     File \"/usr/local/lib/python2.7/site-packages/pandas/core/categorical.py\", line 506, in _set_codes\r\n       raise ValueError(\"cannot set Categorical codes directly\")\r\n   ValueError: cannot set Categorical codes directly\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T13:08:48.269+0000",
                    "updated": "2017-10-28T13:08:48.269+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16223499",
                    "id": "16223499",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147553977\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   @xhochy Do we need to check writability of `Categorical.codes` and `Categorical. categories.values` even if we cannot edit directly?\r\n   ```python\r\n   >>> import pandas as pd\r\n   >>> import numpy as np\r\n   >>> values = pd.Categorical(['A', 'A'])\r\n   >>> \r\n   >>> arr = pa.DictionaryArray.from_arrays(\r\n   ...     np.array([0, 0]),\r\n   ...     np.array([100]))\r\n   >>>\r\n   >>> result = arr.to_pandas()\r\n   >>>\r\n   >>> result.codes = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n     File \"/usr/local/lib/python2.7/site-packages/pandas/core/categorical.py\", line 506, in _set_codes\r\n       raise ValueError(\"cannot set Categorical codes directly\")\r\n   ValueError: cannot set Categorical codes directly\r\n   >>> \r\n   >>> result.categories.values = 1\r\n   Traceback (most recent call last):\r\n     File \"<stdin>\", line 1, in <module>\r\n   AttributeError: can't set attribute\r\n   ```\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-28T13:10:54.898+0000",
                    "updated": "2017-10-28T13:10:54.898+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16224458",
                    "id": "16224458",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "xhochy commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147632727\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   @Licht-T if they pose a problem with Pandas 0.19.2 and we continue to support this version, we should check them. If we would switch our requirements to `pandas>=0.20`, then we could ignore them. Maybe @wesm or @cpcloud has some opinion on dropping older Pandas versions.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-30T07:45:50.742+0000",
                    "updated": "2017-10-30T07:45:50.742+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16224993",
                    "id": "16224993",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147709151\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   Thanks @xhochy, I got it. Should I leave a note about the problem on code?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-30T13:58:43.589+0000",
                    "updated": "2017-10-30T13:58:43.589+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16224994",
                    "id": "16224994",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147709151\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   Thanks @xhochy, I got it. Should I leave a note on code?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-30T13:58:58.718+0000",
                    "updated": "2017-10-30T13:58:58.718+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16224997",
                    "id": "16224997",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on a change in pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#discussion_r147710279\n \n \n\n ##########\n File path: python/pyarrow/pandas_compat.py\n ##########\n @@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n \n Review comment:\n   I think this check here is a workaround for a pandas issue (where `pd.factorize` will fail on non-writeable arrays because of stuff with the Cython buffer protocol). I don't think this will impact Categorical types, @jreback can you confirm?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-10-30T14:02:37.968+0000",
                    "updated": "2017-10-30T14:02:37.968+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16241429",
                    "id": "16241429",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-342364593\n \n \n   @Licht-T what's the status on this one? I can also take a look\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-07T03:26:40.856+0000",
                    "updated": "2017-11-07T03:26:40.856+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248708",
                    "id": "16248708",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343698749\n \n \n   ping @Licht-T, please advise\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-11T22:34:17.385+0000",
                    "updated": "2017-11-11T22:34:17.385+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248755",
                    "id": "16248755",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343706471\n \n \n   @wesm Excuse me! I was in bed with flu, but now okay.\r\n   \r\n   In the discussion, we don't have to check writable flags for `CategoricalIndex` if `pd.factorize` in pandas 1.9.2. works fine. So I'll check this. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-12T01:15:52.708+0000",
                    "updated": "2017-11-12T01:15:52.708+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248756",
                    "id": "16248756",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343706471\n \n \n   @wesm Excuse me! I was in bed with flu, but now okay.\r\n   \r\n   In the discussion, we don't have to check writable flags for `Categorical` if `pd.factorize` in pandas 1.9.2. works fine. So I'll check this. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-12T01:16:43.090+0000",
                    "updated": "2017-11-12T01:16:43.090+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248757",
                    "id": "16248757",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343706471\n \n \n   @wesm Excuse me! I was in bed with flu, and now okay.\r\n   \r\n   In the discussion, we don't have to check writable flags for `Categorical` if `pd.factorize` in pandas 1.9.2. works fine. So I'll check this. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-12T01:17:07.285+0000",
                    "updated": "2017-11-12T01:17:07.285+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248784",
                    "id": "16248784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343713108\n \n \n   @wesm Seems no problem.\r\n   \r\n   ```bash\r\n   [python] python                                                                                                              13:39:23  \u2601  fix-non-array-writable-check \u2600\r\n   Python 2.7.10 (default, Oct 23 2015, 19:19:21)\r\n   [GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)] on darwin\r\n   Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n   >>> import pandas as pd\r\n   >>> import pyarrow as pa\r\n   >>>\r\n   >>>\r\n   >>> pd.__version__\r\n   u'0.19.2'\r\n   >>>\r\n   >>> df = pd.DataFrame({'a': [1, 2, 3], 'b': [1, 2, 3]})\r\n   >>> df['a'] = df.a.astype('category')\r\n   >>> df = df.set_index('a')\r\n   >>>\r\n   >>> tbl = pa.Table.from_pandas(df)\r\n   >>> df_new = tbl.to_pandas()\r\n   >>>\r\n   >>> pd.factorize(df_new['b'])\r\n   (array([0, 1, 2]), Int64Index([1, 2, 3], dtype='int64'))\r\n   ```\r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-12T04:40:51.790+0000",
                    "updated": "2017-11-12T04:40:51.790+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16248787",
                    "id": "16248787",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Licht-T commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-343713108\n \n \n   @wesm Seems no problem.\r\n   \r\n   ```python\r\n   [python] python                                                                                                              13:39:23  \u2601  fix-non-array-writable-check \u2600\r\n   Python 2.7.10 (default, Oct 23 2015, 19:19:21)\r\n   [GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.5)] on darwin\r\n   Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n   >>> import pandas as pd\r\n   >>> import pyarrow as pa\r\n   >>>\r\n   >>>\r\n   >>> pd.__version__\r\n   u'0.19.2'\r\n   >>>\r\n   >>> df = pd.DataFrame({'a': [1, 2, 3], 'b': [1, 2, 3]})\r\n   >>> df['a'] = df.a.astype('category')\r\n   >>> df = df.set_index('a')\r\n   >>>\r\n   >>> tbl = pa.Table.from_pandas(df)\r\n   >>> df_new = tbl.to_pandas()\r\n   >>>\r\n   >>> pd.factorize(df_new['b'])\r\n   (array([0, 1, 2]), Int64Index([1, 2, 3], dtype='int64'))\r\n   ```\r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-12T04:43:49.406+0000",
                    "updated": "2017-11-12T04:43:49.406+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16250780",
                    "id": "16250780",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260#issuecomment-344137738\n \n \n   Sorry to hear you were sick! Let me take a look here\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-14T03:45:15.757+0000",
                    "updated": "2017-11-14T03:45:15.757+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16250781",
                    "id": "16250781",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 1260\n[https://github.com/apache/arrow/pull/1260]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2017-11-14T03:47:30.944+0000",
                    "updated": "2017-11-14T03:47:30.944+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13112671/comment/16250782",
                    "id": "16250782",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm closed pull request #1260: ARROW-1743: [Python] Avoid non-array writeable-flag check\nURL: https://github.com/apache/arrow/pull/1260\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/python/pyarrow/pandas_compat.py b/python/pyarrow/pandas_compat.py\nindex 5592d8dd9..2ecdb63da 100644\n--- a/python/pyarrow/pandas_compat.py\n+++ b/python/pyarrow/pandas_compat.py\n@@ -404,7 +404,7 @@ def table_to_blockmanager(options, table, memory_pool, nthreads=1):\n             index_name = None if is_unnamed_index_level(name) else name\n             col_pandas = col.to_pandas()\n             values = col_pandas.values\n-            if not values.flags.writeable:\n+            if hasattr(values, 'flags') and not values.flags.writeable:\n                 # ARROW-1054: in pandas 0.19.2, factorize will reject\n                 # non-writeable arrays when calling MultiIndex.from_arrays\n                 values = values.copy()\ndiff --git a/python/pyarrow/tests/test_convert_pandas.py b/python/pyarrow/tests/test_convert_pandas.py\nindex 8360dae54..5d8f63279 100644\n--- a/python/pyarrow/tests/test_convert_pandas.py\n+++ b/python/pyarrow/tests/test_convert_pandas.py\n@@ -198,6 +198,13 @@ def test_datetimetz_column_index(self):\n         md = column_indexes['metadata']\n         assert md['timezone'] == 'America/New_York'\n \n+    def test_categorical_row_index(self):\n+        df = pd.DataFrame({'a': [1, 2, 3], 'b': [1, 2, 3]})\n+        df['a'] = df.a.astype('category')\n+        df = df.set_index('a')\n+\n+        self._check_pandas_roundtrip(df, preserve_index=True)\n+\n     def test_float_no_nulls(self):\n         data = {}\n         fields = []\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-14T03:47:32.837+0000",
                    "updated": "2017-11-14T03:47:32.837+0000"
                }
            ],
            "maxResults": 20,
            "total": 20,
            "startAt": 0
        },
        "customfield_12311820": "0|i3lt1b:",
        "customfield_12314139": null
    }
}