{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13192838",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838",
    "key": "ARROW-3564",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12344987",
                "id": "12344987",
                "name": "0.12.1",
                "archived": false,
                "released": true,
                "releaseDate": "2019-02-25"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343937",
                "id": "12343937",
                "description": "",
                "name": "0.13.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-04-01"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "parquet",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "5.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343066",
                "id": "12343066",
                "description": "",
                "name": "0.11.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-10-08"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
            "name": "hatem",
            "key": "hatem",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Hatem Helal",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
            "name": "hatem",
            "key": "hatem",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Hatem Helal",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
            "name": "hatem",
            "key": "hatem",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Hatem Helal",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3564/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 11,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/181684",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "hatemhelal commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331\n \n \n   Reworked logic for encoder selection in column writer.  Added C++ tests and expect that this should resolve the problem observed with using dictionary encoding to write parquet files using pyarrow described in ARROW-3564.  \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-07T10:14:36.727+0000",
                    "updated": "2019-01-07T10:14:36.727+0000",
                    "started": "2019-01-07T10:14:36.726+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "181684",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/183201",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "hatemhelal commented on issue #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#issuecomment-452786698\n \n \n   The CI failures are unrelated to this PR.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-09T17:45:06.076+0000",
                    "updated": "2019-01-09T17:45:06.076+0000",
                    "started": "2019-01-09T17:45:06.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "183201",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/184775",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on issue #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#issuecomment-453985968\n \n \n   @hatemhelal Can you rebase this branch on master to get rid of the CI failures?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-14T12:17:57.327+0000",
                    "updated": "2019-01-14T12:17:57.327+0000",
                    "started": "2019-01-14T12:17:57.317+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "184775",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/184776",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#discussion_r247471652\n \n \n\n ##########\n File path: cpp/src/parquet/column_writer.cc\n ##########\n @@ -534,22 +534,16 @@ void ColumnWriter::FlushBufferedDataPages() {\n template <typename Type>\n TypedColumnWriter<Type>::TypedColumnWriter(ColumnChunkMetaDataBuilder* metadata,\n                                            std::unique_ptr<PageWriter> pager,\n+                                           const bool use_dictionary,\n                                            Encoding::type encoding,\n                                            const WriterProperties* properties)\n-    : ColumnWriter(metadata, std::move(pager),\n-                   (encoding == Encoding::PLAIN_DICTIONARY ||\n-                    encoding == Encoding::RLE_DICTIONARY),\n-                   encoding, properties) {\n-  switch (encoding) {\n-    case Encoding::PLAIN:\n-      current_encoder_.reset(new PlainEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    case Encoding::PLAIN_DICTIONARY:\n-    case Encoding::RLE_DICTIONARY:\n-      current_encoder_.reset(new DictEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    default:\n-      ParquetException::NYI(\"Selected encoding is not supported\");\n+    : ColumnWriter(metadata, std::move(pager), use_dictionary, encoding, properties) {\n+  if (use_dictionary) {\n \n Review comment:\n   Why did you change the old logic from the switch to the extra `use_dictionary` flag?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-14T12:21:28.422+0000",
                    "updated": "2019-01-14T12:21:28.422+0000",
                    "started": "2019-01-14T12:21:28.422+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "184776",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/184788",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "hatemhelal commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#discussion_r247481495\n \n \n\n ##########\n File path: cpp/src/parquet/column_writer.cc\n ##########\n @@ -534,22 +534,16 @@ void ColumnWriter::FlushBufferedDataPages() {\n template <typename Type>\n TypedColumnWriter<Type>::TypedColumnWriter(ColumnChunkMetaDataBuilder* metadata,\n                                            std::unique_ptr<PageWriter> pager,\n+                                           const bool use_dictionary,\n                                            Encoding::type encoding,\n                                            const WriterProperties* properties)\n-    : ColumnWriter(metadata, std::move(pager),\n-                   (encoding == Encoding::PLAIN_DICTIONARY ||\n-                    encoding == Encoding::RLE_DICTIONARY),\n-                   encoding, properties) {\n-  switch (encoding) {\n-    case Encoding::PLAIN:\n-      current_encoder_.reset(new PlainEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    case Encoding::PLAIN_DICTIONARY:\n-    case Encoding::RLE_DICTIONARY:\n-      current_encoder_.reset(new DictEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    default:\n-      ParquetException::NYI(\"Selected encoding is not supported\");\n+    : ColumnWriter(metadata, std::move(pager), use_dictionary, encoding, properties) {\n+  if (use_dictionary) {\n \n Review comment:\n   This wasn't obvious to me either.  For the version 2.0 code path it seems that we need to instantiate `ColumnWriter` with the `RLE_DICTIONARY` encoding but previously it was using the `PLAIN` encoding as defined here in arrow/cpp/src/parquet/properties.h:\r\n   \r\n   ```\r\n     inline Encoding::type dictionary_page_encoding() const {\r\n       if (parquet_version_ == ParquetVersion::PARQUET_1_0) {\r\n         return Encoding::PLAIN_DICTIONARY;\r\n       } else {\r\n         return Encoding::PLAIN;\r\n       }\r\n     }\r\n   ```\r\n   \r\n   To fix this, I replaced the call to `dictionary_page_encoding()` with `dictionary_index_encoding()` in `ColumnWriter::Make'.  It seemed clearer to me to also compute the `use_dictionary` option there too and pass it down the stack.  Let me know if you have any suggestions to make this clearer?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-14T12:57:13.159+0000",
                    "updated": "2019-01-14T12:57:13.159+0000",
                    "started": "2019-01-14T12:57:13.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "184788",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/184789",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "hatemhelal commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#discussion_r247481495\n \n \n\n ##########\n File path: cpp/src/parquet/column_writer.cc\n ##########\n @@ -534,22 +534,16 @@ void ColumnWriter::FlushBufferedDataPages() {\n template <typename Type>\n TypedColumnWriter<Type>::TypedColumnWriter(ColumnChunkMetaDataBuilder* metadata,\n                                            std::unique_ptr<PageWriter> pager,\n+                                           const bool use_dictionary,\n                                            Encoding::type encoding,\n                                            const WriterProperties* properties)\n-    : ColumnWriter(metadata, std::move(pager),\n-                   (encoding == Encoding::PLAIN_DICTIONARY ||\n-                    encoding == Encoding::RLE_DICTIONARY),\n-                   encoding, properties) {\n-  switch (encoding) {\n-    case Encoding::PLAIN:\n-      current_encoder_.reset(new PlainEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    case Encoding::PLAIN_DICTIONARY:\n-    case Encoding::RLE_DICTIONARY:\n-      current_encoder_.reset(new DictEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    default:\n-      ParquetException::NYI(\"Selected encoding is not supported\");\n+    : ColumnWriter(metadata, std::move(pager), use_dictionary, encoding, properties) {\n+  if (use_dictionary) {\n \n Review comment:\n   This wasn't obvious to me either.  For the version 2.0 code path it seems that we need to instantiate `ColumnWriter` with the `RLE_DICTIONARY` encoding but previously it was using the `PLAIN` encoding as defined here in arrow/cpp/src/parquet/properties.h:\r\n   \r\n   ```\r\n     inline Encoding::type dictionary_page_encoding() const {\r\n       if (parquet_version_ == ParquetVersion::PARQUET_1_0) {\r\n         return Encoding::PLAIN_DICTIONARY;\r\n       } else {\r\n         return Encoding::PLAIN;\r\n       }\r\n     }\r\n   ```\r\n   \r\n   To fix this, I replaced the call to `dictionary_page_encoding()` with `dictionary_index_encoding()` in `ColumnWriter::Make`.  It seemed clearer to me to also compute the `use_dictionary` option there too and pass it down the stack.  Let me know if you have any suggestions to make this clearer?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-14T12:57:27.335+0000",
                    "updated": "2019-01-14T12:57:27.335+0000",
                    "started": "2019-01-14T12:57:27.333+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "184789",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/185664",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#issuecomment-454715634\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=h1) Report\n   > Merging [#3331](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/a1a9221cf6522b4c9bc26a9ebf4a459f6217050e?src=pr&el=desc) will **increase** coverage by `1.05%`.\n   > The diff coverage is `98.27%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3331/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3331      +/-   ##\n   ==========================================\n   + Coverage   88.31%   89.36%   +1.05%     \n   ==========================================\n     Files         631      385     -246     \n     Lines       79294    49132   -30162     \n     Branches     1069        0    -1069     \n   ==========================================\n   - Hits        70025    43908   -26117     \n   + Misses       9154     5224    -3930     \n   + Partials      115        0     -115\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/parquet/column\\_writer.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXIuaA==) | `70.58% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/column\\_writer-test.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXItdGVzdC5jYw==) | `99.56% <100%> (+0.01%)` | :arrow_up: |\n   | [cpp/src/parquet/column\\_writer.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXIuY2M=) | `97.57% <96.15%> (-0.02%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/reader.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvcmVhZGVyLmg=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/reader.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvcmVhZGVyLmNj) | `0.52% <0%> (-90.48%)` | :arrow_down: |\n   | [cpp/src/arrow/adapters/orc/adapter.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9hZGFwdGVycy9vcmMvYWRhcHRlci5jYw==) | `0.26% <0%> (-74.08%)` | :arrow_down: |\n   | [cpp/src/plasma/eviction\\_policy.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvZXZpY3Rpb25fcG9saWN5LmNj) | `59.01% <0%> (-40.99%)` | :arrow_down: |\n   | [cpp/src/plasma/events.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvZXZlbnRzLmNj) | `52.5% <0%> (-35%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/options.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3Yvb3B0aW9ucy5o) | `66.66% <0%> (-33.34%)` | :arrow_down: |\n   | [cpp/src/plasma/thirdparty/ae/ae.c](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvdGhpcmRwYXJ0eS9hZS9hZS5j) | `41.7% <0%> (-29.39%)` | :arrow_down: |\n   | ... and [337 more](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=footer). Last update [a1a9221...55bed4c](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-16T09:43:52.366+0000",
                    "updated": "2019-01-16T09:43:52.366+0000",
                    "started": "2019-01-16T09:43:52.365+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "185664",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/185665",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#issuecomment-454715634\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=h1) Report\n   > Merging [#3331](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/a1a9221cf6522b4c9bc26a9ebf4a459f6217050e?src=pr&el=desc) will **increase** coverage by `1.05%`.\n   > The diff coverage is `98.27%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3331/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3331      +/-   ##\n   ==========================================\n   + Coverage   88.31%   89.36%   +1.05%     \n   ==========================================\n     Files         631      385     -246     \n     Lines       79294    49132   -30162     \n     Branches     1069        0    -1069     \n   ==========================================\n   - Hits        70025    43908   -26117     \n   + Misses       9154     5224    -3930     \n   + Partials      115        0     -115\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/parquet/column\\_writer.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXIuaA==) | `70.58% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/parquet/column\\_writer-test.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXItdGVzdC5jYw==) | `99.56% <100%> (+0.01%)` | :arrow_up: |\n   | [cpp/src/parquet/column\\_writer.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl93cml0ZXIuY2M=) | `97.57% <96.15%> (-0.02%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/reader.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvcmVhZGVyLmg=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/reader.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvcmVhZGVyLmNj) | `0.52% <0%> (-90.48%)` | :arrow_down: |\n   | [cpp/src/arrow/adapters/orc/adapter.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9hZGFwdGVycy9vcmMvYWRhcHRlci5jYw==) | `0.26% <0%> (-74.08%)` | :arrow_down: |\n   | [cpp/src/plasma/eviction\\_policy.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvZXZpY3Rpb25fcG9saWN5LmNj) | `59.01% <0%> (-40.99%)` | :arrow_down: |\n   | [cpp/src/plasma/events.cc](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvZXZlbnRzLmNj) | `52.5% <0%> (-35%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/options.h](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3Yvb3B0aW9ucy5o) | `66.66% <0%> (-33.34%)` | :arrow_down: |\n   | [cpp/src/plasma/thirdparty/ae/ae.c](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvdGhpcmRwYXJ0eS9hZS9hZS5j) | `41.7% <0%> (-29.39%)` | :arrow_down: |\n   | ... and [337 more](https://codecov.io/gh/apache/arrow/pull/3331/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=footer). Last update [a1a9221...55bed4c](https://codecov.io/gh/apache/arrow/pull/3331?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-16T09:43:54.641+0000",
                    "updated": "2019-01-16T09:43:54.641+0000",
                    "started": "2019-01-16T09:43:54.641+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "185665",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/185856",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#discussion_r248356297\n \n \n\n ##########\n File path: cpp/src/parquet/column_writer.cc\n ##########\n @@ -534,22 +534,16 @@ void ColumnWriter::FlushBufferedDataPages() {\n template <typename Type>\n TypedColumnWriter<Type>::TypedColumnWriter(ColumnChunkMetaDataBuilder* metadata,\n                                            std::unique_ptr<PageWriter> pager,\n+                                           const bool use_dictionary,\n                                            Encoding::type encoding,\n                                            const WriterProperties* properties)\n-    : ColumnWriter(metadata, std::move(pager),\n-                   (encoding == Encoding::PLAIN_DICTIONARY ||\n-                    encoding == Encoding::RLE_DICTIONARY),\n-                   encoding, properties) {\n-  switch (encoding) {\n-    case Encoding::PLAIN:\n-      current_encoder_.reset(new PlainEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    case Encoding::PLAIN_DICTIONARY:\n-    case Encoding::RLE_DICTIONARY:\n-      current_encoder_.reset(new DictEncoder<Type>(descr_, properties->memory_pool()));\n-      break;\n-    default:\n-      ParquetException::NYI(\"Selected encoding is not supported\");\n+    : ColumnWriter(metadata, std::move(pager), use_dictionary, encoding, properties) {\n+  if (use_dictionary) {\n \n Review comment:\n   Thanks for clarifying, that makes a bit more sense to me now.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-16T16:34:20.064+0000",
                    "updated": "2019-01-16T16:34:20.064+0000",
                    "started": "2019-01-16T16:34:20.063+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "185856",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/185905",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "hatemhelal commented on issue #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331#issuecomment-454870235\n \n \n   Thanks @xhochy, appreciate the code review!\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-16T17:37:49.958+0000",
                    "updated": "2019-01-16T17:37:49.958+0000",
                    "started": "2019-01-16T17:37:49.958+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "185905",
                    "issueId": "13192838"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/worklog/185984",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "xhochy commented on pull request #3331: ARROW-3564: [C++] Fix dictionary encoding logic for Parquet 2.0\nURL: https://github.com/apache/arrow/pull/3331\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-16T20:46:51.651+0000",
                    "updated": "2019-01-16T20:46:51.651+0000",
                    "started": "2019-01-16T20:46:51.651+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "185984",
                    "issueId": "13192838"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 6600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2986e2b9[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7af7bbc7[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24a5d40f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@634b6adf[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1542ae1a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6cc57059[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@664ad462[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5e6f47e6[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e5d104f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@195df465[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2904cae8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@df0e859[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6600,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Jan 16 20:46:46 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-01-16T20:46:46.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-3564/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2018-10-19T12:57:33.000+0000",
        "updated": "2019-02-19T16:00:30.000+0000",
        "timeoriginalestimate": null,
        "description": "Using pyarrow v0.11.0, the\u00a0attached script writes a simple table (lifted from the\u00a0[pyarrow doc|https://arrow.apache.org/docs/python/parquet.html]) to both parquet format versions 1.0 and 2.0, with and without dictionary encoding enabled.\r\n\r\n\r\nInspecting the written files using\u00a0[parquet-tools|https://github.com/apache/parquet-mr/tree/master/parquet-tools]\u00a0appears to show that dictionary encoding is not used in either of the version 2.0 files.\u00a0 Both files report that the columns are encoded using\u00a0{{PLAIN,RLE}}\u00a0and that the dictionary page offset is zero.\u00a0 I\u00a0was expecting that the column encoding would include\u00a0{{RLE_DICTIONARY}}.\u00a0Attached are the script with repro steps and the files that were generated by it.\r\n\r\nBelow is the output of using {{parquet-tools meta}} on the version 2.0 files\r\n{panel:title=version='2.0', use_dictionary = True}\r\n{panel}\r\n|{{% parquet-tools meta example_v2.0_dict_True.parquet}}\r\n {{file:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [file:.../example_v2.0_dict_True.parquet|file:///.../example_v2.0_dict_True.parquet]}}\r\n {{creator:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 parquet-cpp version 1.5.1-SNAPSHOT}} \\{ Unknown macro: {extra}\r\n }}\r\n \u00a0\r\n {{file schema:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 schema}}\r\n {{--------------------------------------------------------------------------------}}\r\n {{one:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL DOUBLE R:0 D:1}}\r\n {{three:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL BOOLEAN R:0 D:1}}\r\n {{two:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL BINARY R:0 D:1}}\r\n {{__index_level_0__: OPTIONAL BINARY R:0 D:1}}\r\n \u00a0\r\n {{row group 1:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 RC:3 TS:211 OFFSET:4}}\r\n {{--------------------------------------------------------------------------------}}\r\n {{one:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 DOUBLE SNAPPY DO:0 FPO:4 SZ:65/63/0.97 VC:3 ENC:PLAIN,RLE ST:[min: -1.0, max: 2.5, num_nulls: 1]}}\r\n {{three:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 BOOLEAN SNAPPY DO:0 FPO:142 SZ:36/34/0.94 VC:3 ENC:PLAIN,RLE ST:[min: false, max: true, num_nulls: 0]}}\r\n {{two:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 BINARY SNAPPY DO:0 FPO:225 SZ:60/58/0.97 VC:3 ENC:PLAIN,RLE ST:[min: 0x626172, max: 0x666F6F, num_nulls: 0]}}\r\n {{__index_level_0__:\u00a0 BINARY SNAPPY DO:0 FPO:328 SZ:50/48/0.96 VC:3 ENC:PLAIN,RLE ST:[min: 0x61, max: 0x63, num_nulls: 0]}}|\r\n{panel:title=version='2.0', use_dictionary = False}\r\n{panel}\r\n|{{% parquet-tools meta example_v2.0_dict_False.parquet}}\r\n {{file:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [file:.../example_v2.0_dict_False.parquet|file:///.../example_v2.0_dict_False.parquet]}}\r\n {{creator:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 parquet-cpp version 1.5.1-SNAPSHOT}} \\{ Unknown macro: {extra}\r\n }}\r\n \u00a0\r\n {{file schema:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 schema}}\r\n {{--------------------------------------------------------------------------------}}\r\n {{one:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL DOUBLE R:0 D:1}}\r\n {{three:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL BOOLEAN R:0 D:1}}\r\n {{two:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OPTIONAL BINARY R:0 D:1}}\r\n {{__index_level_0__: OPTIONAL BINARY R:0 D:1}}\r\n \u00a0\r\n {{row group 1:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 RC:3 TS:211 OFFSET:4}}\r\n {{--------------------------------------------------------------------------------}}\r\n {{one:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 DOUBLE SNAPPY DO:0 FPO:4 SZ:65/63/0.97 VC:3 ENC:PLAIN,RLE ST:[min: -1.0, max: 2.5, num_nulls: 1]}}\r\n {{three:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 BOOLEAN SNAPPY DO:0 FPO:142 SZ:36/34/0.94 VC:3 ENC:PLAIN,RLE ST:[min: false, max: true, num_nulls: 0]}}\r\n {{two:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 BINARY SNAPPY DO:0 FPO:225 SZ:60/58/0.97 VC:3 ENC:PLAIN,RLE ST:[min: 0x626172, max: 0x666F6F, num_nulls: 0]}}\r\n {{__index_level_0__:\u00a0 BINARY SNAPPY DO:0 FPO:328 SZ:50/48/0.96 VC:3 ENC:PLAIN,RLE ST:[min: 0x61, max: 0x63, num_nulls: 0]}}|",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12944720",
                "id": "12944720",
                "filename": "example_v1.0_dict_False.parquet",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                    "name": "hatem",
                    "key": "hatem",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Hatem Helal",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-10-19T12:44:16.323+0000",
                "size": 1441,
                "mimeType": "application/octet-stream",
                "content": "https://issues.apache.org/jira/secure/attachment/12944720/example_v1.0_dict_False.parquet"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12944718",
                "id": "12944718",
                "filename": "example_v1.0_dict_True.parquet",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                    "name": "hatem",
                    "key": "hatem",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Hatem Helal",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-10-19T12:44:16.330+0000",
                "size": 1532,
                "mimeType": "application/octet-stream",
                "content": "https://issues.apache.org/jira/secure/attachment/12944718/example_v1.0_dict_True.parquet"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12944721",
                "id": "12944721",
                "filename": "example_v2.0_dict_False.parquet",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                    "name": "hatem",
                    "key": "hatem",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Hatem Helal",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-10-19T12:44:16.323+0000",
                "size": 1441,
                "mimeType": "application/octet-stream",
                "content": "https://issues.apache.org/jira/secure/attachment/12944721/example_v2.0_dict_False.parquet"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12944719",
                "id": "12944719",
                "filename": "example_v2.0_dict_True.parquet",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                    "name": "hatem",
                    "key": "hatem",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Hatem Helal",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-10-19T12:44:16.326+0000",
                "size": 1441,
                "mimeType": "application/octet-stream",
                "content": "https://issues.apache.org/jira/secure/attachment/12944719/example_v2.0_dict_True.parquet"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/attachment/12944717",
                "id": "12944717",
                "filename": "pyarrow_repro.py",
                "author": {
                    "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                    "name": "hatem",
                    "key": "hatem",
                    "avatarUrls": {
                        "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                        "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                        "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                        "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                    },
                    "displayName": "Hatem Helal",
                    "active": true,
                    "timeZone": "Etc/UTC"
                },
                "created": "2018-10-19T12:44:16.334+0000",
                "size": 514,
                "mimeType": "text/x-python-script",
                "content": "https://issues.apache.org/jira/secure/attachment/12944717/pyarrow_repro.py"
            }
        ],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] writing version 2.0 parquet format with dictionary encoding enabled",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/comment/16704954",
                    "id": "16704954",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                        "name": "hatem",
                        "key": "hatem",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Hatem Helal",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I had a first stab at this as I thought it was a logic error but now not so sure.\u00a0 [~wesmckinn], I should have some time to work on arrow in the coming weeks.\u00a0 Can you assign this task to me?\u00a0 Any thoughts you have on this would also be helpful.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=hatem",
                        "name": "hatem",
                        "key": "hatem",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Hatem Helal",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-11-30T16:02:47.293+0000",
                    "updated": "2018-11-30T16:02:47.293+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/comment/16704960",
                    "id": "16704960",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "That is indeed odd. I don't know what might be happening off hand, you'll have to step through to see where the column encoder is being constructed. I added you as a Contributor on the project so you can assign yourself issues",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2018-11-30T16:09:01.915+0000",
                    "updated": "2018-11-30T16:09:01.915+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13192838/comment/16744456",
                    "id": "16744456",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "body": "Issue resolved by pull request 3331\n[https://github.com/apache/arrow/pull/3331]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=uwe",
                        "name": "uwe",
                        "key": "xhochy",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=xhochy&avatarId=30652",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=xhochy&avatarId=30652",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=xhochy&avatarId=30652",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=xhochy&avatarId=30652"
                        },
                        "displayName": "Uwe Korn",
                        "active": true,
                        "timeZone": "Europe/Berlin"
                    },
                    "created": "2019-01-16T20:46:46.868+0000",
                    "updated": "2019-01-16T20:46:46.868+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|i3zetz:",
        "customfield_12314139": null
    }
}