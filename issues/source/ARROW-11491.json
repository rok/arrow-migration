{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13356645",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645",
    "key": "ARROW-11491",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12608037",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12608037",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "outwardIssue": {
                    "id": "13343230",
                    "key": "ARROW-10771",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13343230",
                    "fields": {
                        "summary": "[Rust] Extend JSON schema inference to nested types",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=houqp",
            "name": "houqp",
            "key": "houqp",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "QP Hou",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=houqp",
            "name": "houqp",
            "key": "houqp",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "QP Hou",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=houqp",
            "name": "houqp",
            "key": "houqp",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "QP Hou",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 15600,
            "total": 15600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15600,
            "total": 15600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11491/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 26,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/547429",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp opened a new pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-04T05:11:49.770+0000",
                    "updated": "2021-02-04T05:11:49.770+0000",
                    "started": "2021-02-04T05:11:49.770+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "547429",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/547430",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#issuecomment-773033585\n\n\n   https://issues.apache.org/jira/browse/ARROW-11491\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-04T05:12:13.388+0000",
                    "updated": "2021-02-04T05:12:13.388+0000",
                    "started": "2021-02-04T05:12:13.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "547430",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/547436",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r569953550\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       @nevi-me the I don't have the full context here, so my change of logic here might not be correct. Basically the current implementation throws out an type incompatible error when a column is detected to have both list and non-list value, for example: `\"c\": true\"` v.s. `\"c\": [true, false]`.\r\n   \r\n   Do you remember what's the reason for doing automatic conversion between scalar column to scalar list column? This behavior seems a bit too magical to me.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-04T05:20:09.735+0000",
                    "updated": "2021-02-04T05:20:09.735+0000",
                    "started": "2021-02-04T05:20:09.735+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "547436",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/547437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r569954389\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       There aim was to reduce the odds of throwing away data, converting the scalar to a single-item list.\r\n   \r\n   I can't remember if I checked against Spark, but I'll do that during the day. I'm convinced that I've come across the behaviour elsewhere before, but can't remember where.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-04T05:23:40.327+0000",
                    "updated": "2021-02-04T05:23:40.327+0000",
                    "started": "2021-02-04T05:23:40.326+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "547437",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/548330",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r570844136\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       What have you decided here; to preserve the old behaviour or change it?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T10:11:27.832+0000",
                    "updated": "2021-02-05T10:11:27.832+0000",
                    "started": "2021-02-05T10:11:27.831+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548330",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/548986",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r571374068\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       @nevi-me i just tested it with spark, looks like it's doing the conversion the other way, i.e. when a column contains both scalar and list values, it gets converted to string type. as a result, boolean lists are parsed into `\"[true, false]\"` string.\r\n   \r\n   I don't have a strong opinion on this, but if we want to match spark, then we should probably go that fallback to string if incompatible types are detected. What do you think? @nevi-me @jorgecarleitao @andygrove .\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       @nevi-me i just tested it with spark, looks like it's doing the conversion the other way, i.e. when a column contains both scalar and list values, it gets converted to string type. as a result, boolean lists are parsed into `\"[true, false]\"` string.\r\n   \r\n   I don't have a strong opinion on this, but if we want to match spark, then we should probably go that fallback to string if incompatible types are detected. What do you think? @nevi-me @jorgecarleitao @andygrove @alamb .\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-06T06:54:24.650+0000",
                    "updated": "2021-02-06T06:54:24.650+0000",
                    "started": "2021-02-06T06:54:24.649+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548986",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/549255",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r571605491\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       In general I think matching Spark's behavior is probably a good idea so as to try and maximize compatibility with the rest of the ecosystem.\r\n   \r\n   That being said, if Spark's behavior is hard to use, confusing or unwieldy to implement, I think there is a reasonable case to be made for deviating from its behavior too. \r\n   \r\n   \"it depends\" lol\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-07T11:59:07.814+0000",
                    "updated": "2021-02-07T11:59:07.814+0000",
                    "started": "2021-02-07T11:59:07.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "549255",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/549256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r571606006\n\n\n\n##########\nFile path: rust/arrow/src/json/reader.rs\n##########\n@@ -1874,9 +1997,7 @@ mod tests {\n                 .downcast_ref::<ListArray>()\n                 .unwrap();\n             let bb = bb.values();\n-            let bb = bb.as_any().downcast_ref::<Float64Array>().unwrap();\n-            assert_eq!(10, bb.len());\n-            assert!(4.0 - bb.value(9) < f64::EPSILON);\n\nReview comment:\n       What happened to `bb.value(9)`? \n\n##########\nFile path: rust/arrow/src/json/reader.rs\n##########\n@@ -57,6 +57,46 @@ use crate::record_batch::RecordBatch;\n use crate::util::bit_util;\n use crate::{array::*, buffer::Buffer};\n \n+#[derive(Debug, Clone)]\n+enum InferredType {\n\nReview comment:\n       This is a nice and easy to follow implementation. Nice work @houqp \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-07T12:11:28.182+0000",
                    "updated": "2021-02-07T12:11:28.182+0000",
                    "started": "2021-02-07T12:11:28.182+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "549256",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/549286",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r571636351\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       @houqp @alamb one downside for now is that we don't have utilities to deal with JSON data once it's inferred and interpreted as strings (matching Spark behaviour). For example, we don't have anything to convert \"[true, false]\" back to an array of those values.\r\n   \r\n   I suppose with schema inference we'll always have to make some compromises. I still prefer casting to list as that loses the least data, but if we use different behaviour, we could document the decision on the relevant function, so that other users could make changes in future (if they motivate for some other behaviour).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-07T15:43:58.611+0000",
                    "updated": "2021-02-07T15:43:58.611+0000",
                    "started": "2021-02-07T15:43:58.610+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "549286",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/551768",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#issuecomment-778134781\n\n\n   @houqp  -- I think this one is ready to go other than \r\n   \r\n   > The only question I think should be answered / explained before this is merged is why the checked in file test/data/mixed_arrays.json ends up with one fewer column in the inferred schema after this PR.\r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-12T11:16:23.043+0000",
                    "updated": "2021-02-12T11:16:23.043+0000",
                    "started": "2021-02-12T11:16:23.043+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "551768",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552084",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#issuecomment-778534603\n\n\n   sorry for the delay, i have been busy lately. will update the PR this weekend to address all the feedback commented so far.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-13T01:01:56.105+0000",
                    "updated": "2021-02-13T01:01:56.105+0000",
                    "started": "2021-02-13T01:01:56.105+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552084",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552257",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575729282\n\n\n\n##########\nFile path: rust/arrow/src/json/reader.rs\n##########\n@@ -1874,9 +1997,7 @@ mod tests {\n                 .downcast_ref::<ListArray>()\n                 .unwrap();\n             let bb = bb.values();\n-            let bb = bb.as_any().downcast_ref::<Float64Array>().unwrap();\n-            assert_eq!(10, bb.len());\n-            assert!(4.0 - bb.value(9) < f64::EPSILON);\n\nReview comment:\n       b column is of list type, but the last row has a value of `\"b\":4`, so i replaced it with `\"b\": []` in the test data. I am going to revert my test data change to maintain the old behavior based on our previous discussions.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-13T23:52:20.773+0000",
                    "updated": "2021-02-13T23:52:20.773+0000",
                    "started": "2021-02-13T23:52:20.773+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552257",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552283",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#issuecomment-778723586\n\n\n   @alamb @nevi-me added more doc string to `infer_json_schema_from_iterator` to document the coercion rules. Ready for another round of review.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T04:39:10.870+0000",
                    "updated": "2021-02-14T04:39:10.870+0000",
                    "started": "2021-02-14T04:39:10.870+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552283",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552285",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575753005\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       I have updated the PR to implement the old behavior so the inference rules are consistent with rules used in the actual value conversion code.\r\n   \r\n   After thinking more on this, I think Spark's behavior would be a better design in the long run for the following two reasons:\r\n   \r\n   * It preserves more info from the original JSON data. Once we convert scalar to array of scalar in Arrow, we will lose the information that some of the original values were just scalars. It's better to let users decide how they want to handle incompatible types in their query plans. For example, one might want to simply discard all rows with scalar values as a data cleaning step.\r\n   * Converting fields with incompatible types into string is unavoidable for more complex cases anyway. For example, when a field contains scalar, list and object type, there no other option other than reading the value as JSON string.\r\n   \r\n   Perhaps we can refactor the code to match Spark's behavior after we added more JSON parsing kernels.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T04:47:52.847+0000",
                    "updated": "2021-02-14T04:47:52.847+0000",
                    "started": "2021-02-14T04:47:52.847+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552285",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552286",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575753025\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       I think that spark's behavior is correct. Our JSON reader and schema inferer is in my opinion very broken for list arrays.\r\n   \r\n   ```\r\n   {\"a\": \"hello\"}\r\n   {\"a\": \"world\"}\r\n   {\"a\": \"this\"}\r\n   {\"a\": null}\r\n   {\"a\": \"hello\"}\r\n   {\"a\": \"world\"}\r\n   {\"a\": \"this\"}\r\n   {\"a\": null}\r\n   {\"a\": \"hello\"}\r\n   {\"a\": \"world\"}\r\n   {\"a\": \"this\"}\r\n   {\"a\": null}\r\n   {\"a\": [\"a\"]}\r\n   ```\r\n   \r\n   yields a `ListArray<String>` where each scalar is being interpreted as a one-element list. I can't see how this is reasonable.\r\n   \r\n   @houqp I have code to handle arbitrary nested lists on my computer, but it requires that we do not make this kind of crazy stuff, i.e. it works as expected if no casting like the above is allowed.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T04:48:05.848+0000",
                    "updated": "2021-02-14T04:48:05.848+0000",
                    "started": "2021-02-14T04:48:05.848+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552286",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552288",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#issuecomment-778725085\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=h1) Report\n   > Merging [#9412](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=desc) (fb42b39) into [master](https://codecov.io/gh/apache/arrow/commit/88e9eb852755072b948393d99d08211c3e01ce38?el=desc) (88e9eb8) will **increase** coverage by `0.02%`.\n   > The diff coverage is `89.89%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9412/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9412      +/-   ##\n   ==========================================\n   + Coverage   82.27%   82.29%   +0.02%     \n   ==========================================\n     Files         234      234              \n     Lines       54594    54661      +67     \n   ==========================================\n   + Hits        44919    44986      +67     \n     Misses       9675     9675              \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/arrow/src/json/reader.rs](https://codecov.io/gh/apache/arrow/pull/9412/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvanNvbi9yZWFkZXIucnM=) | `83.63% <89.89%> (+0.81%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=footer). Last update [88e9eb8...fb42b39](https://codecov.io/gh/apache/arrow/pull/9412?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T04:55:13.383+0000",
                    "updated": "2021-02-14T04:55:13.383+0000",
                    "started": "2021-02-14T04:55:13.382+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552288",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552290",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575754856\n\n\n\n##########\nFile path: rust/arrow/src/json/reader.rs\n##########\n@@ -57,6 +57,46 @@ use crate::record_batch::RecordBatch;\n use crate::util::bit_util;\n use crate::{array::*, buffer::Buffer};\n \n+#[derive(Debug, Clone)]\n+enum InferredType {\n\nReview comment:\n       I agree. Much simpler!\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T05:10:25.013+0000",
                    "updated": "2021-02-14T05:10:25.013+0000",
                    "started": "2021-02-14T05:10:25.013+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552290",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552291",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575754916\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       > I have code to handle arbitrary nested lists\r\n   \r\n   @jorgecarleitao could you expand a little bit more on this or share some of the code snippet? Don't we already support reading nested list values?\r\n   \r\n   @nevi-me was mostly concerned with not able to operate on string fields that contains serialized JSON value, I wonder if your code can help alleviate that concern.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T05:10:27.942+0000",
                    "updated": "2021-02-14T05:10:27.942+0000",
                    "started": "2021-02-14T05:10:27.942+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552291",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552295",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575756059\n\n\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       Sorry, scratch what I said. It is an unrelated issue that I mixed up.\r\n   \n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       Sorry, scratch what I said wrt to the implementation. It is an unrelated issue that I mixed up.\r\n   \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T05:26:43.549+0000",
                    "updated": "2021-02-14T05:26:43.549+0000",
                    "started": "2021-02-14T05:26:43.549+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552295",
                    "issueId": "13356645"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/worklog/552297",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9412:\nURL: https://github.com/apache/arrow/pull/9412#discussion_r575760813\n\n\n\n##########\nFile path: rust/arrow/src/json/reader.rs\n##########\n@@ -330,136 +307,237 @@ pub fn infer_json_schema<R: Read>(\n     infer_json_schema_from_iterator(ValueIter::new(reader, max_read_records))\n }\n \n+fn set_object_scalar_field_type(\n+    field_types: &mut HashMap<String, InferredType>,\n+    key: &str,\n+    ftype: DataType,\n+) -> Result<()> {\n+    if !field_types.contains_key(key) {\n+        field_types.insert(key.to_string(), InferredType::Scalar(HashSet::new()));\n+    }\n+\n+    match field_types.get_mut(key).unwrap() {\n+        InferredType::Scalar(hs) => {\n+            hs.insert(ftype);\n+            Ok(())\n+        }\n+        // in case of column contains both scalar type and scalar array type, we convert type of\n+        // this column to scalar array.\n+        scalar_array @ InferredType::Array(_) => {\n+            let mut hs = HashSet::new();\n+            hs.insert(ftype);\n+            scalar_array.merge(InferredType::Scalar(hs))?;\n+            Ok(())\n+        }\n+        t => Err(ArrowError::JsonError(format!(\n+            \"Expected scalar or scalar array JSON type, found: {:?}\",\n+            t,\n+        ))),\n+    }\n+}\n+\n+fn infer_scalar_array_type(array: &[Value]) -> Result<InferredType> {\n+    let mut hs = HashSet::new();\n+\n+    for v in array {\n+        match v {\n+            Value::Null => {}\n+            Value::Number(n) => {\n+                if n.is_i64() {\n+                    hs.insert(DataType::Int64);\n+                } else {\n+                    hs.insert(DataType::Float64);\n+                }\n+            }\n+            Value::Bool(_) => {\n+                hs.insert(DataType::Boolean);\n+            }\n+            Value::String(_) => {\n+                hs.insert(DataType::Utf8);\n+            }\n+            Value::Array(_) | Value::Object(_) => {\n+                return Err(ArrowError::JsonError(format!(\n+                    \"Expected scalar value for scalar array, got: {:?}\",\n+                    v\n+                )));\n+            }\n+        }\n+    }\n+\n+    Ok(InferredType::Scalar(hs))\n+}\n+\n+fn infer_nested_array_type(array: &[Value]) -> Result<InferredType> {\n+    let mut inner_ele_type = InferredType::Any;\n+\n+    for v in array {\n+        match v {\n+            Value::Array(inner_array) => {\n+                inner_ele_type.merge(infer_array_element_type(inner_array)?)?;\n+            }\n+            x => {\n+                return Err(ArrowError::JsonError(format!(\n+                    \"Got non array element in nested array: {:?}\",\n+                    x\n+                )));\n+            }\n+        }\n+    }\n+\n+    Ok(InferredType::Array(Box::new(inner_ele_type)))\n+}\n+\n+fn infer_struct_array_type(array: &[Value]) -> Result<InferredType> {\n+    let mut field_types = HashMap::new();\n+\n+    for v in array {\n+        match v {\n+            Value::Object(map) => {\n+                collect_field_types_from_object(&mut field_types, map)?;\n+            }\n+            _ => {\n+                return Err(ArrowError::JsonError(format!(\n+                    \"Expected struct value for struct array, got: {:?}\",\n+                    v\n+                )));\n+            }\n+        }\n+    }\n+\n+    Ok(InferredType::Object(field_types))\n+}\n+\n+fn infer_array_element_type(array: &[Value]) -> Result<InferredType> {\n+    match array.iter().take(1).next() {\n+        None => Ok(InferredType::Any), // empty array, return any type that can be updated later\n+        Some(a) => match a {\n+            Value::Array(_) => infer_nested_array_type(array),\n+            Value::Object(_) => infer_struct_array_type(array),\n+            _ => infer_scalar_array_type(array),\n+        },\n+    }\n+}\n+\n+fn collect_field_types_from_object(\n+    field_types: &mut HashMap<String, InferredType>,\n+    map: &JsonMap<String, Value>,\n+) -> Result<()> {\n+    for (k, v) in map {\n+        match v {\n+            Value::Array(array) => {\n+                let ele_type = infer_array_element_type(array)?;\n+\n+                if !field_types.contains_key(k) {\n+                    match ele_type {\n+                        InferredType::Scalar(_) => {\n+                            field_types.insert(\n+                                k.to_string(),\n+                                InferredType::Array(Box::new(InferredType::Scalar(\n+                                    HashSet::new(),\n+                                ))),\n+                            );\n+                        }\n+                        InferredType::Object(_) => {\n+                            field_types.insert(\n+                                k.to_string(),\n+                                InferredType::Array(Box::new(InferredType::Object(\n+                                    HashMap::new(),\n+                                ))),\n+                            );\n+                        }\n+                        InferredType::Any | InferredType::Array(_) => {\n+                            // set inner type to any for nested array as well\n+                            // so it can be updated properly from subsequent type merges\n+                            field_types.insert(\n+                                k.to_string(),\n+                                InferredType::Array(Box::new(InferredType::Any)),\n+                            );\n+                        }\n+                    }\n+                }\n+\n+                match field_types.get_mut(k).unwrap() {\n+                    InferredType::Array(inner_type) => {\n+                        inner_type.merge(ele_type)?;\n+                    }\n+                    // in case of column contains both scalar type and scalar array type, we\n+                    // convert type of this column to scalar array.\n+                    field_type @ InferredType::Scalar(_) => {\n+                        field_type.merge(ele_type)?;\n+                        *field_type = InferredType::Array(Box::new(field_type.clone()));\n+                    }\n+                    t => {\n+                        return Err(ArrowError::JsonError(format!(\n+                            \"Expected array json type, found: {:?}\",\n+                            t,\n+                        )));\n+                    }\n+                }\n+            }\n+            Value::Bool(_) => {\n+                set_object_scalar_field_type(field_types, k, DataType::Boolean)?;\n+            }\n+            Value::Null => {\n+                // do nothing, we treat json as nullable by default when\n+                // inferring\n+            }\n+            Value::Number(n) => {\n+                if n.is_f64() {\n+                    set_object_scalar_field_type(field_types, k, DataType::Float64)?;\n+                } else {\n+                    // default to i64\n+                    set_object_scalar_field_type(field_types, k, DataType::Int64)?;\n+                }\n+            }\n+            Value::String(_) => {\n+                set_object_scalar_field_type(field_types, k, DataType::Utf8)?;\n+            }\n+            Value::Object(inner_map) => {\n+                if !field_types.contains_key(k) {\n+                    field_types\n+                        .insert(k.to_string(), InferredType::Object(HashMap::new()));\n+                }\n+                match field_types.get_mut(k).unwrap() {\n+                    InferredType::Object(inner_field_types) => {\n+                        collect_field_types_from_object(inner_field_types, inner_map)?;\n+                    }\n+                    t => {\n+                        return Err(ArrowError::JsonError(format!(\n+                            \"Expected object json type, found: {:?}\",\n+                            t,\n+                        )));\n+                    }\n+                }\n+            }\n+        }\n+    }\n+\n+    Ok(())\n+}\n+\n /// Infer the fields of a JSON file by reading all items from the JSON Value Iterator.\n+///\n+/// The following type coercion logic is implemented:\n+/// * `Int64` and `Float64` are converted to `Float64`\n+/// * Lists and scalars are coerced to a list of a compatible scalar\n\nReview comment:\n       This line (appears elsewhere) should no longer apply when following same behaviour as Spark\n\n##########\nFile path: rust/arrow/test/data/mixed_arrays.json\n##########\n@@ -1,4 +1,4 @@\n-{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":4.1}\n+{\"a\":1, \"b\":[2.0, 1.3, -6.1], \"c\":[false, true], \"d\":[\"4.1\"]}\n {\"a\":-10, \"b\":[2.0, 1.3, -6.1], \"c\":null, \"d\":null}\n-{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":\"text\"}\n-{\"a\":3, \"b\":4, \"c\": true, \"d\":[1, false, \"array\", 2.4]}\n+{\"a\":2, \"b\":[2.0, null, -6.1], \"c\":[false, null], \"d\":[\"text\"]}\n+{\"a\":3, \"b\":[], \"c\": [], \"d\":[\"array\"]}\n\nReview comment:\n       Is the conclusion then to keep the existing behaviour? I'm a bit confused \ud83d\ude43\r\n   \r\n   I went through the code, still a green light from me; so we can merge this\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-14T06:26:32.959+0000",
                    "updated": "2021-02-14T06:26:32.959+0000",
                    "started": "2021-02-14T06:26:32.958+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "552297",
                    "issueId": "13356645"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/3",
            "id": "3",
            "description": "A task that needs to be done.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype",
            "name": "Task",
            "subtask": false,
            "avatarId": 21148
        },
        "timespent": 15600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@51bdc832[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a7dbbd3[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@f07dadc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@18335bcc[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5159889c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@42cb1b91[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@732be82e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@71c420bc[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6c444b70[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@76c9c2fa[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5a0f2e95[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@a1e24a8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15600,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Feb 18 11:57:58 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-02-18T11:57:58.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11491/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-02-04T05:09:11.000+0000",
        "updated": "2021-02-18T11:58:06.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] Support json schema inference for nested list and struct",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13356645/comment/17286433",
                    "id": "17286433",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9412\n[https://github.com/apache/arrow/pull/9412]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-02-18T11:57:58.097+0000",
                    "updated": "2021-02-18T11:57:58.097+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nc7s:",
        "customfield_12314139": null
    }
}