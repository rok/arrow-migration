{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13121385",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385",
    "key": "ARROW-1866",
    "fields": {
        "parent": {
            "id": "13099860",
            "key": "ARROW-1463",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13099860",
            "fields": {
                "summary": "[JAVA] Restructure ValueVector hierarchy to minimize compile-time generated code",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                    "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                    "name": "Resolved",
                    "id": "5",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                    "id": "4",
                    "description": "An improvement or enhancement to an existing feature or task.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                    "name": "Improvement",
                    "subtask": false,
                    "avatarId": 21140
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341352",
                "id": "12341352",
                "name": "0.8.0",
                "archived": false,
                "released": true,
                "releaseDate": "2017-12-18"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/7",
            "id": "7",
            "description": "Later",
            "name": "Later"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12521042",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12521042",
                "type": {
                    "id": "10032",
                    "name": "Blocker",
                    "inward": "is blocked by",
                    "outward": "blocks",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10032"
                },
                "outwardIssue": {
                    "id": "13118602",
                    "key": "ARROW-1815",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13118602",
                    "fields": {
                        "summary": "[Java] Rename MapVector to StructVector",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            },
            {
                "id": "12521041",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12521041",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13111269",
                    "key": "ARROW-1710",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13111269",
                    "fields": {
                        "summary": "[Java] Remove non-nullable vectors in new vector class hierarchy ",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bryanc",
            "name": "bryanc",
            "key": "bryanc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bryanc&avatarId=23479",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bryanc&avatarId=23479",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bryanc&avatarId=23479",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bryanc&avatarId=23479"
            },
            "displayName": "Bryan Cutler",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "name": "Closed",
            "id": "6",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328933",
                "id": "12328933",
                "name": "Java"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bryanc",
            "name": "bryanc",
            "key": "bryanc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bryanc&avatarId=23479",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bryanc&avatarId=23479",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bryanc&avatarId=23479",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bryanc&avatarId=23479"
            },
            "displayName": "Bryan Cutler",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bryanc",
            "name": "bryanc",
            "key": "bryanc",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bryanc&avatarId=23479",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bryanc&avatarId=23479",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bryanc&avatarId=23479",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bryanc&avatarId=23479"
            },
            "displayName": "Bryan Cutler",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1866/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5b31ea17[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@137f0f2f[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@13781c1e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@78956f29[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4682f467[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@685cab32[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b17c2cb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@68a80ea7[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@39d8ee19[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@34d0d72b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@31544ae0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@19a1b75b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Aug 27 14:41:41 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2017-12-04T18:13:50.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-1866/watchers",
            "watchCount": 2,
            "isWatching": true
        },
        "created": "2017-11-28T17:40:52.000+0000",
        "updated": "2022-08-27T14:41:41.000+0000",
        "timeoriginalestimate": null,
        "description": "{{NonNullableMapVector}} class can be merged into {{MapVector}} and removed as part of removing the non nullable vectors.",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Java] Combine MapVector and NonNullableMapVector Classes",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16269998",
                    "id": "16269998",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler opened a new pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371\n \n \n   This merges the two `MapVector` classes and removes the `NonNullableMapVector` class as a followup to #1341.  There is only a nullable version of `MapVector` now.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T02:55:51.584+0000",
                    "updated": "2017-11-29T02:55:51.584+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270001",
                    "id": "16270001",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347737455\n \n \n   This is a WIP, still need to make another pass through to clean up.  Also, I'm not too sure about the purpose of `SingleMapWriter`, is it optimized for a single field or for the non-nullable MapVector?  I'll have to check into it later\r\n   cc @icexelloss @siddharthteotia \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T02:57:56.502+0000",
                    "updated": "2017-11-29T02:57:56.502+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270004",
                    "id": "16270004",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153683453\n \n \n\n ##########\n File path: java/vector/src/main/codegen/templates/MapWriters.java\n ##########\n @@ -20,11 +20,7 @@\n <#list [\"Nullable\", \"Single\"] as mode>\n \n Review comment:\n   Is there any point to have a SingleMapVector?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T02:58:25.318+0000",
                    "updated": "2017-11-29T02:58:25.318+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270007",
                    "id": "16270007",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153683561\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,33 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n   private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n \n Review comment:\n   could not have this as `final` anymore because it depends on `fieldType` being set in the constructor.  Previously it was set under the super class.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T02:59:32.947+0000",
                    "updated": "2017-11-29T02:59:32.947+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270008",
                    "id": "16270008",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153683606\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -145,37 +188,80 @@ public TransferPair getTransferPair(String ref, BufferAllocator allocator, CallB\n     return new NullableMapTransferPair(this, new MapVector(ref, allocator, fieldType, callBack), false);\n   }\n \n-  protected class NullableMapTransferPair extends MapTransferPair {\n+  protected class NullableMapTransferPair implements TransferPair {\n \n-    private MapVector target;\n+    private final TransferPair[] pairs;\n+    private final MapVector from;\n+    private MapVector to;\n \n     protected NullableMapTransferPair(MapVector from, MapVector to, boolean allocate) {\n-      super(from, to, allocate);\n-      this.target = to;\n+      this.from = from;\n+      this.to = to;\n+      this.pairs = new TransferPair[from.size()];\n+      // TODO: ?? this.to.ephPair = null;\n \n Review comment:\n   Check on this\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T03:00:01.371+0000",
                    "updated": "2017-11-29T03:00:01.371+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270033",
                    "id": "16270033",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153683695\n \n \n\n ##########\n File path: java/vector/src/test/java/org/apache/arrow/vector/complex/writer/TestComplexWriter.java\n ##########\n @@ -849,11 +848,12 @@ public void testSingleMapWriter1() {\n     /* initialize a SingleMapWriter with empty MapVector and then lazily\n      * create all vectors with expected initialCapacity.\n      */\n-    NonNullableMapVector parent = NonNullableMapVector.empty(\"parent\", allocator);\n+    MapVector parent = MapVector.empty(\"parent\", allocator);\n     SingleMapWriter singleMapWriter = new SingleMapWriter(parent);\n \n     int initialCapacity = 1024;\n     singleMapWriter.setInitialCapacity(initialCapacity);\n+    singleMapWriter.allocate();\n \n Review comment:\n   now need to make sure the validity buffer is allocated\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T03:00:54.305+0000",
                    "updated": "2017-11-29T03:00:54.305+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270970",
                    "id": "16270970",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153826312\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -116,6 +137,19 @@ private void setReaderAndWriterIndex() {\n     throw new UnsupportedOperationException(\"There are no inner vectors. Use getFieldBuffers\");\n   }\n \n+  @Override\n+  protected boolean supportsDirectRead() {\n \n Review comment:\n   what is this for?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T15:46:44.512+0000",
                    "updated": "2017-11-29T15:46:44.512+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16270975",
                    "id": "16270975",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347903125\n \n \n   LGTM at high level. @BryanCutler I don't know about SingleMapWriter either. Is that orthogonal or related to this change?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T15:51:01.578+0000",
                    "updated": "2017-11-29T15:51:01.578+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271356",
                    "id": "16271356",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347961402\n \n \n   > I don't know about SingleMapWriter either. Is that orthogonal or related to this change?\r\n   \r\n   With this change `SingleMapWriter` is now the same same as `NullableMapWriter` so they can also be combined and `SingleMapWriter` can be removed.  This is also the same for `SingleMapReaderImpl`. \r\n   \r\n   @siddharthteotia and @jacques-n do you have any objections to removing the `SingleMapWriter/Reader` classes here as well?\r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:00:33.002+0000",
                    "updated": "2017-11-29T19:00:33.002+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271362",
                    "id": "16271362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347962629\n \n \n   I could also remove the codegen file `MapWriters.java` and just have one non codegen class `MapWriter`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:04:46.277+0000",
                    "updated": "2017-11-29T19:04:46.277+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271369",
                    "id": "16271369",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153885958\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -116,6 +137,19 @@ private void setReaderAndWriterIndex() {\n     throw new UnsupportedOperationException(\"There are no inner vectors. Use getFieldBuffers\");\n   }\n \n+  @Override\n+  protected boolean supportsDirectRead() {\n \n Review comment:\n   Not sure, it was in `NonNullableMapVector` so I brought it over.  This doesn't seem to be used anywhere and overrides from `AbstractContainerVector` that returns false.  @siddharthteotia do you know what this was used for and if it is still needed?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:10:54.755+0000",
                    "updated": "2017-11-29T19:10:54.755+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271382",
                    "id": "16271382",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347966543\n \n \n   > I could also remove the codegen file MapWriters.java and just have one non codegen class MapWriter\r\n   \r\n   I think we probably still need to codegen the MapWriter class because it codegen methods for different types. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:18:16.532+0000",
                    "updated": "2017-11-29T19:18:16.532+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271395",
                    "id": "16271395",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153890118\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,33 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n   private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n+  private NullableMapWriter writer;\n \n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  protected final FieldType fieldType;\n+  public int valueCount;\n \n Review comment:\n   Any reason this should be public?  This class has `getValueCount` and `setValueCount`\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:25:49.506+0000",
                    "updated": "2017-11-29T19:25:49.506+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271437",
                    "id": "16271437",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153683453\n \n \n\n ##########\n File path: java/vector/src/main/codegen/templates/MapWriters.java\n ##########\n @@ -20,11 +20,7 @@\n <#list [\"Nullable\", \"Single\"] as mode>\n \n Review comment:\n   Is there any point to have a SingleMapWriter?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:51:37.695+0000",
                    "updated": "2017-11-29T19:51:37.695+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271441",
                    "id": "16271441",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153898044\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,32 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n-  private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n-\n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  private final FieldType fieldType;\n+  private int valueCount;\n \n Review comment:\n   `valueCount` was public in `NonNullableMapVector` but I don't think it should be here\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:54:56.934+0000",
                    "updated": "2017-11-29T19:54:56.934+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271443",
                    "id": "16271443",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: [WIP] ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153898044\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,32 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n-  private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n-\n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  private final FieldType fieldType;\n+  private int valueCount;\n \n Review comment:\n   `valueCount` was public in `NonNullableMapVector` but I don't think it should be here so I made it private\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:55:07.912+0000",
                    "updated": "2017-11-29T19:55:07.912+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271451",
                    "id": "16271451",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-347978327\n \n \n   Removing WIP, I think this should be ok to merge (pending tests) unless we decide to remove `SingleMapWriter` here\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-29T19:59:17.580+0000",
                    "updated": "2017-11-29T19:59:17.580+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271940",
                    "id": "16271940",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on a change in pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153962135\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,32 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n-  private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n-\n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  private final FieldType fieldType;\n+  private int valueCount;\n+  private final NullableMapReaderImpl reader;\n \n Review comment:\n   Do we want to do something with the name here? i.e `MapReaderImpl` and `MapWriterImpl` ?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:07:35.108+0000",
                    "updated": "2017-11-30T01:07:35.108+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271943",
                    "id": "16271943",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on a change in pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153962298\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -145,37 +188,79 @@ public TransferPair getTransferPair(String ref, BufferAllocator allocator, CallB\n     return new NullableMapTransferPair(this, new MapVector(ref, allocator, fieldType, callBack), false);\n   }\n \n-  protected class NullableMapTransferPair extends MapTransferPair {\n+  protected class NullableMapTransferPair implements TransferPair {\n \n Review comment:\n   `NullableMapTransferPair` -> `MapTransferPair`? \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:08:43.801+0000",
                    "updated": "2017-11-30T01:08:43.801+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271945",
                    "id": "16271945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on a change in pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153962408\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/impl/NullableMapReaderImpl.java\n ##########\n @@ -29,8 +28,8 @@\n   private MapVector nullableMapVector;\n \n   public NullableMapReaderImpl(MapVector vector) {\n-    super((MapVector) vector);\n-    this.nullableMapVector = (MapVector) vector;\n+    super(vector);\n+    this.nullableMapVector = vector;\n \n Review comment:\n   nit: `this.mapVector`?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:09:31.632+0000",
                    "updated": "2017-11-30T01:09:31.632+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271963",
                    "id": "16271963",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348051260\n \n \n   I looked at `SingleMap` reader and writer. I think the purpose of these two classes is to handle non nullable map vectors so we should probably remove them.\r\n   \r\n   @BryanCutler it seems your PR make `SingleMap` and `NullableMap` reader writer identical, is that correct?\r\n   \r\n   @siddharthteotia Does Dremio code uses `SingleMap` reader writer? \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:16:14.052+0000",
                    "updated": "2017-11-30T01:16:14.052+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271970",
                    "id": "16271970",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153963988\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -35,27 +38,32 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n-  private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n-\n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  private final FieldType fieldType;\n+  private int valueCount;\n+  private final NullableMapReaderImpl reader;\n \n Review comment:\n   I'm ok with the change, but I held off on renaming classes outside of the vectors until we have a consensus \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:21:55.541+0000",
                    "updated": "2017-11-30T01:21:55.541+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271971",
                    "id": "16271971",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348052207\n \n \n   @BryanCutler , yes Dremio uses SingleMapWriter/Reader. What is the concern here?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:21:59.725+0000",
                    "updated": "2017-11-30T01:21:59.725+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271972",
                    "id": "16271972",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on a change in pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#discussion_r153964040\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n ##########\n @@ -145,37 +188,79 @@ public TransferPair getTransferPair(String ref, BufferAllocator allocator, CallB\n     return new NullableMapTransferPair(this, new MapVector(ref, allocator, fieldType, callBack), false);\n   }\n \n-  protected class NullableMapTransferPair extends MapTransferPair {\n+  protected class NullableMapTransferPair implements TransferPair {\n \n Review comment:\n   I think this would be ok to rename since its a protected inner class\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:22:17.119+0000",
                    "updated": "2017-11-30T01:22:17.119+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271977",
                    "id": "16271977",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348052207\n \n \n   @BryanCutler ,  @icexelloss , yes Dremio uses SingleMapWriter/Reader. What is the concern here?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:25:21.624+0000",
                    "updated": "2017-11-30T01:25:21.624+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271979",
                    "id": "16271979",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348053061\n \n \n   Let us not hold off making any changes to NullableMapVector and MapVector. I think this PR should just remove the newly added NonNullableMapVector class in the hierarchy and bring the hierarchy to the state it was before. \r\n   \r\n   Meanwhile we can assess the usage of both types of vectors in Dremio and then document the changes (if any) required to these 2 vectors. \r\n   \r\n   I don't think there is any harm in keeping these 2 vectors around for the time being. They are not breaking anything.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:26:50.675+0000",
                    "updated": "2017-11-30T01:26:50.675+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16271990",
                    "id": "16271990",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348053061\n \n \n   Let us hold off making any changes to NullableMapVector and MapVector. I think this PR should just remove the newly added NonNullableMapVector class in the hierarchy and bring the hierarchy to the state it was before. \r\n   \r\n   Meanwhile we can assess the usage of both types of vectors in Dremio and then document the changes (if any) required to these 2 vectors. \r\n   \r\n   I don't think there is any harm in keeping these 2 vectors around for the time being. They are not breaking anything.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T01:37:53.431+0000",
                    "updated": "2017-11-30T01:37:53.431+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16272038",
                    "id": "16272038",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348060793\n \n \n   > Let us hold off making any changes to NullableMapVector and MapVector. I think this PR should just remove the newly added NonNullableMapVector class in the hierarchy and bring the hierarchy to the state it was before.\r\n   Meanwhile we can assess the usage of both types of vectors in Dremio and then document the changes (if any) required to these 2 vectors.\r\n   I don't think there is any harm in keeping these 2 vectors around for the time being. They are not breaking anything.\r\n   \r\n   There is only two vectors currently - `MapVector` and `NonNullableMapVector`. @siddharthteotia what do you suggest we to do?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T02:13:46.466+0000",
                    "updated": "2017-11-30T02:13:46.466+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16272039",
                    "id": "16272039",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348060793\n \n \n   > Let us hold off making any changes to NullableMapVector and MapVector. I think this PR should just remove the newly added NonNullableMapVector class in the hierarchy and bring the hierarchy to the state it was before.\r\n   Meanwhile we can assess the usage of both types of vectors in Dremio and then document the changes (if any) required to these 2 vectors.\r\n   I don't think there is any harm in keeping these 2 vectors around for the time being. They are not breaking anything.\r\n   \r\n   There are only two vectors currently - `MapVector` and `NonNullableMapVector`. @siddharthteotia what do you suggest we to do?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T02:13:52.512+0000",
                    "updated": "2017-11-30T02:13:52.512+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16272195",
                    "id": "16272195",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348089231\n \n \n   My suggestion is to keep the old pair of NullableMapVector and MapVector as is and just remove the new NonNullable* class -- basically let's have the MapVector hierarchy back to what it was before with MapVector being the base class and NullableMapVector being the subclass. \r\n   \r\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T05:48:51.672+0000",
                    "updated": "2017-11-30T05:48:51.672+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16272241",
                    "id": "16272241",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348100328\n \n \n   @siddharthteotia just to be clear, the end result of this PR is to flatten the 2 map vectors classes into 1 `MapVector` and no functionality was added or removed.  If you prefer we revert back to these vectors before #1341 to assess the impact of the change in Dremio, then I'm ok with that.  Is it primarily a question of performance you would like to check?  My thought is that it would be good to be consistent with the rest of the vectors that no longer have a Nullable prefix and get as much of the refactoring done as possible for the 0.8 release.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T07:00:41.279+0000",
                    "updated": "2017-11-30T07:00:41.279+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273134",
                    "id": "16273134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348279859\n \n \n   @siddharthteotia perhaps you can elaborate more on if combining the 2 MapVectors is something you would be ok with in the future and when you might be able to sign off on that?  Also, are ok with the renaming to `StructVector` that was discussed for ARROW-1815?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T18:36:20.333+0000",
                    "updated": "2017-11-30T18:36:20.333+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273147",
                    "id": "16273147",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348281518\n \n \n   I thought we've reached consensus about this but maybe not. I have also put up https://docs.google.com/document/d/1n4qjO20wZyS7wSpISgYdIVuD22zstLgP-7gXxS5_7_E/edit?usp=sharing to help discuss vector naming so we can make progress.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T18:42:30.625+0000",
                    "updated": "2017-11-30T18:42:30.625+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273174",
                    "id": "16273174",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348285791\n \n \n   Thanks for putting that together @icexelloss , it looks good but I think the question we need to answer first is if we plan to combine `MapVector` and `NonNullableMapVector` and if not then what to name these 2 classes?  @siddharthteotia would like to revert back to the previous names of `NullableMapVector` and `MapVector`, what are your thoughts on that?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T18:57:34.693+0000",
                    "updated": "2017-11-30T18:57:34.693+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273183",
                    "id": "16273183",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348286242\n \n \n   I still don't see why we need to keep nullable and non nullable version of MapVector. I am also waiting on @siddharthteotia for his comment.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T18:59:11.892+0000",
                    "updated": "2017-11-30T18:59:11.892+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273221",
                    "id": "16273221",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348293303\n \n \n   My suggestion is to keep the old pair of NullableMapVector and MapVector as is and just remove the new NonNullable* class -- basically let's have the MapVector hierarchy back to what it was before with MapVector being the base class and NullableMapVector being the subclass.\r\n   \r\n   Since the implications of combining them are to the reader and writer as well and @BryanCutler proposed to remove them, I would like to assess their usage in Dremio. For example, we have a data structure  writer called VectorContainerWriter which has a MapVector inside and a SingleMapWriter to populate the data structure. \r\n   \r\n   I am just asking to keep these  2 vectors around as is for the time being. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T19:23:32.457+0000",
                    "updated": "2017-11-30T19:23:32.457+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273223",
                    "id": "16273223",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348293303\n \n \n   My suggestion is to keep the old pair of NullableMapVector and MapVector as is and just remove the new NonNullable* class -- basically let's have the MapVector hierarchy back to what it was before with MapVector being the base class and NullableMapVector being the subclass.\r\n   \r\n   Since the implications of combining them are to the reader and writer as well and @BryanCutler proposed to remove them, I would like to assess their usage in Dremio. For example, we have a data structure  writer called VectorContainerWriter which has a MapVector inside and a SingleMapWriter to populate the data structure. \r\n   \r\n   I am just asking to keep these  2 vectors around as is for the time being. Later on we can combine them and decide what to do with reader/writer.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T19:24:16.318+0000",
                    "updated": "2017-11-30T19:24:16.318+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273252",
                    "id": "16273252",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348296114\n \n \n   I did not remove anything outside of the vector hierarchy, I just brought up that we could combine the readers and writers as well.  However, doing this is out of scope for what we have discussed so I only did minimal changes required to get things working.  Does that alleviate some of your concern?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T19:33:52.936+0000",
                    "updated": "2017-11-30T19:33:52.936+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273274",
                    "id": "16273274",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348299006\n \n \n   Seems there are some code in Dremio that is going to be affected by removing non nullable MapVector and SingleMapWriter but not too many: (Hopefully this is up to date) \r\n   \r\n   https://github.com/dremio/dremio-oss/search?p=2&q=MapVector&type=&utf8=%E2%9C%93\r\n   https://github.com/dremio/dremio-oss/search?utf8=%E2%9C%93&q=SingleMapWriter&type=\r\n   \r\n   I don't know what's the best way to proceed. Maybe we can give it a couple of days for @siddharthteotia to evaluate if removing non nullable vectors are OK for Dremio. \r\n   \r\n   Any thoughts?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T19:44:26.397+0000",
                    "updated": "2017-11-30T19:44:26.397+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273276",
                    "id": "16273276",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348299006\n \n \n   Seems there are some code in Dremio that is going to be affected by removing non nullable MapVector and SingleMapWriter but not too many: (Hopefully this is up to date) \r\n   \r\n   https://github.com/dremio/dremio-oss/search?p=2&q=MapVector&type=&utf8=%E2%9C%93\r\n   https://github.com/dremio/dremio-oss/search?utf8=%E2%9C%93&q=SingleMapWriter&type=\r\n   \r\n   I don't know what's the best way to proceed. Maybe we can give it a couple of days for @siddharthteotia to evaluate if removing non nullable vectors is OK for Dremio. \r\n   \r\n   Any thoughts?\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T19:44:54.458+0000",
                    "updated": "2017-11-30T19:44:54.458+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273356",
                    "id": "16273356",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348310872\n \n \n   This PR does not remove SingleMapWriter, but since it now uses the nullable\n   MapVector as the container, it is functionally equivalent to\n   NullableMapWriter.\n   \n   On Nov 30, 2017 11:44 AM, \"Li Jin\" <notifications@github.com> wrote:\n   \n   > Seems there are some code in Dremio that is going to be affected by\n   > removing non nullable MapVector and SingleMapWriter but not too many:\n   > (Hopefully this is up to date)\n   >\n   > https://github.com/dremio/dremio-oss/search?p=2&q=\n   > MapVector&type=&utf8=%E2%9C%93\n   > https://github.com/dremio/dremio-oss/search?utf8=%E2%9C%\n   > 93&q=SingleMapWriter&type=\n   >\n   > I don't know what's the best way to proceed. Maybe we can give it a couple\n   > of days for @siddharthteotia <https://github.com/siddharthteotia> to\n   > evaluate if removing non nullable vectors are OK for Dremio.\n   >\n   > Any thoughts?\n   >\n   > \u2014\n   > You are receiving this because you were mentioned.\n   > Reply to this email directly, view it on GitHub\n   > <https://github.com/apache/arrow/pull/1371#issuecomment-348299006>, or mute\n   > the thread\n   > <https://github.com/notifications/unsubscribe-auth/AEUwdViMkgm6K1rWXuJUVdMDmhMaxmFtks5s7wWbgaJpZM4QuWKm>\n   > .\n   >\n   \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T20:26:46.650+0000",
                    "updated": "2017-11-30T20:26:46.650+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273401",
                    "id": "16273401",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348318247\n \n \n   @BryanCutler yeah I see your point but @siddharthteotia seems to be saying Dremio uses non-nullable MapVector as well so he wants to take a look.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T20:56:27.804+0000",
                    "updated": "2017-11-30T20:56:27.804+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16273431",
                    "id": "16273431",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348321215\n \n \n   Yes, I just wanted to be clear that removing the non-nullable MapVector was the only refactoring done here.   Hopefully that can help assess the impact.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-11-30T21:08:16.801+0000",
                    "updated": "2017-11-30T21:08:16.801+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16274611",
                    "id": "16274611",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348546181\n \n \n   N.B. Dremio is open source, so others are also free to look at this code: https://github.com/dremio/dremio-oss -- I have been asking for someone to set up integration tests to be able to run Dremio's tests against Arrow master, that would be hugely helpful in situations like these. There might be some unpublished changes to Dremio trunk, though. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T16:48:21.865+0000",
                    "updated": "2017-12-01T16:48:21.865+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16274655",
                    "id": "16274655",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "icexelloss commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348553936\n \n \n   +1. \r\n   \r\n   I also feel the issue is also we (Bryan and I) don't know enough about Dremio codebase to assess the impact of certain changes to Dremio such as removing non nullable map vectors. I also feel maybe @siddharthteotia is too resource bound on keeping up with master refactoring PRs. I am willing to help make downstream changes to Dremio just as we make downstream changes to Spark but I don't know if https://github.com/dremio/dremio-oss is update to date.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T17:17:31.585+0000",
                    "updated": "2017-12-01T17:17:31.585+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16274769",
                    "id": "16274769",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348577147\n \n \n   I'm also willing to make downstream changes to Dremio if that would help.  I think the underlying issue here is that I (and I believe Li too) was under the assumption that removing the non-nullable MapVector was part of the agenda for the Java refactoring, while @siddharthteotia wants keep as they were before ARROW-1710.  Here are the options we have, as I see it, to proceed:\r\n   \r\n   1. Keep this PR open and assess the impact on downstream projects.  If all checks out, then hopefully we can get this in before 0.8.0 is cut.\r\n   \r\n   2.  Close this PR for now.  Since we are planning to change the name of `MapVector` (this is still part of the refactoring plan for 0.8.0?) then start with that and rename to `NullableStructVector` and `StructVector` or some variant.\r\n   \r\n   3.  Close this PR for now, change the names back to `NullableMapVector` and `MapVector`, hold off on renaming to StructVector, and put these in a future plan to discuss later.\r\n   \r\n   Of course I prefer (1) but I understand if constraints prevent this, it would just be nice to get confirmation if that is the case or there is a disagreement in doing this at all.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T18:51:11.135+0000",
                    "updated": "2017-12-01T18:51:11.135+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16274810",
                    "id": "16274810",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348577147\n \n \n   I'm also willing to make downstream changes to Dremio if that would help.  I think the underlying issue here is that I (and I believe Li too) was under the assumption that removing the non-nullable MapVector was part of the agenda for the Java refactoring, while @siddharthteotia wants keep as they were before ARROW-1710.  Here are the options we have, as I see it, to proceed:\r\n   \r\n   1. Keep this PR open and assess the impact on downstream projects.  If all checks out, then hopefully we can get this in before 0.8.0 is cut.\r\n   \r\n   2.  Close this PR for now.  Since we are planning to change the name of `MapVector` (this is still part of the refactoring plan for 0.8.0?) then start with that and rename to `NullableStructVector` and `StructVector` or some variant.\r\n   \r\n   3.  Close this PR for now, change the names back to `NullableMapVector` and `MapVector`, hold off on renaming to StructVector, and put these in a future plan to discuss later.\r\n   \r\n   Of course I prefer (1) but I understand if constraints prevent this, it would just be nice to get confirmation if that is the case and if there is disagreement with doing (2).\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T19:16:22.085+0000",
                    "updated": "2017-12-01T19:16:22.085+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16275111",
                    "id": "16275111",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348632802\n \n \n   My suggestion is to go with 3rd option here https://github.com/apache/arrow/pull/1371#issuecomment-348577147\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T22:37:07.222+0000",
                    "updated": "2017-12-01T22:37:07.222+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16275114",
                    "id": "16275114",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "siddharthteotia commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348632802\n \n \n   My suggestion is to go with 3rd option here https://github.com/apache/arrow/pull/1371#issuecomment-348577147\r\n   Same as what I mentioned here https://github.com/apache/arrow/pull/1371#issuecomment-348293303\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-01T22:39:34.782+0000",
                    "updated": "2017-12-01T22:39:34.782+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16275404",
                    "id": "16275404",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "jacques-n commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348667143\n \n \n   What do people think of?\r\n   * Keep the two level hierarchy\r\n   * Rename NonNullableMapVector > StructVector\r\n   * Mark existing MapVector as deprecated\r\n   \r\n   @BryanCutler, I think the SingleMapWriter has more differences than Nullability. I think it is specifically used to treat the top of a record as a pseudo-map where needed. \r\n   \r\n   We do some fairly complex runtime code generation associated with this structure in Dremio. It relates to these pieces of code [1][2][3] (among others) and it will take some time to really remember & understand the impact of what you're proposing to provide good feedback.\r\n   \r\n   [1] https://github.com/dremio/dremio-oss/blob/master/sabot/kernel/src/main/java/org/apache/arrow/vector/complex/FieldIdUtil2.java\r\n   [2] https://github.com/dremio/dremio-oss/blob/master/sabot/kernel/src/main/java/com/dremio/exec/expr/EvaluationVisitor.java#L341\r\n   [3] https://github.com/dremio/dremio-oss/blob/master/sabot/kernel/src/main/java/com/dremio/exec/expr/EvaluationVisitor.java#L405\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-02T04:22:25.167+0000",
                    "updated": "2017-12-02T04:22:25.167+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16276124",
                    "id": "16276124",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "wesm commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-348819514\n \n \n   In\r\n   \r\n   > Rename NonNullableMapVector > StructVector\r\n   \r\n   Structs are nullable in general, so the `StructVector` needs to accommodate null structs\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-03T22:11:21.889+0000",
                    "updated": "2017-12-03T22:11:21.889+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16277176",
                    "id": "16277176",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler commented on issue #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371#issuecomment-349052439\n \n \n   Thanks for the details @jacques-n, I am fine with keeping the 2 level hierarchy for now and it seems like we need some more discussion to move forward with `StructType` naming.  I'll proceed with option (3) and restore the previous `MapVector` class names. \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-04T18:13:12.214+0000",
                    "updated": "2017-12-04T18:13:12.214+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/16277177",
                    "id": "16277177",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "BryanCutler closed pull request #1371: ARROW-1866: [Java] Combine MapVector classes and remove NonNullableMapVector\nURL: https://github.com/apache/arrow/pull/1371\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/java/vector/src/main/codegen/templates/MapWriters.java b/java/vector/src/main/codegen/templates/MapWriters.java\nindex a5ac1b717..5caffdd2d 100644\n--- a/java/vector/src/main/codegen/templates/MapWriters.java\n+++ b/java/vector/src/main/codegen/templates/MapWriters.java\n@@ -20,11 +20,7 @@\n <#list [\"Nullable\", \"Single\"] as mode>\n <@pp.changeOutputFile name=\"/org/apache/arrow/vector/complex/impl/${mode}MapWriter.java\" />\n <#assign index = \"idx()\">\n-<#if mode == \"Single\">\n-<#assign containerClass = \"NonNullableMapVector\" />\n-<#else>\n <#assign containerClass = \"MapVector\" />\n-</#if>\n \n <#include \"/@includes/license.ftl\" />\n \n@@ -50,11 +46,6 @@\n   private int initialCapacity;\n   private final Map<String, FieldWriter> fields = Maps.newHashMap();\n   public ${mode}MapWriter(${containerClass} container) {\n-    <#if mode == \"Single\">\n-    if (container instanceof MapVector) {\n-      throw new IllegalArgumentException(\"Invalid container: \" + container);\n-    }\n-    </#if>\n     this.container = container;\n     this.initialCapacity = 0;\n     for (Field child : container.getField().getChildren()) {\n@@ -197,10 +188,7 @@ public void setPosition(int index) {\n \n   @Override\n   public void start() {\n-    <#if mode == \"Single\">\n-    <#else>\n     container.setIndexDefined(idx());\n-    </#if>\n   }\n \n   @Override\ndiff --git a/java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java b/java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\nindex 075ae83ea..00bdc3d3d 100644\n--- a/java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n+++ b/java/vector/src/main/java/org/apache/arrow/vector/complex/MapVector.java\n@@ -21,12 +21,15 @@\n import static com.google.common.base.Preconditions.checkNotNull;\n \n import java.util.ArrayList;\n-import java.util.Arrays;\n-import java.util.Collections;\n+import java.util.Collection;\n+import java.util.Iterator;\n import java.util.List;\n+import java.util.Map;\n \n import com.google.common.collect.ObjectArrays;\n \n+import com.google.common.collect.Ordering;\n+import com.google.common.primitives.Ints;\n import io.netty.buffer.ArrowBuf;\n import org.apache.arrow.memory.BaseAllocator;\n import org.apache.arrow.memory.BufferAllocator;\n@@ -35,27 +38,32 @@\n import org.apache.arrow.vector.complex.impl.NullableMapWriter;\n import org.apache.arrow.vector.holders.ComplexHolder;\n import org.apache.arrow.vector.ipc.message.ArrowFieldNode;\n+import org.apache.arrow.vector.types.Types;\n import org.apache.arrow.vector.types.pojo.ArrowType;\n import org.apache.arrow.vector.types.pojo.ArrowType.Struct;\n import org.apache.arrow.vector.types.pojo.DictionaryEncoding;\n import org.apache.arrow.vector.types.pojo.FieldType;\n import org.apache.arrow.vector.types.pojo.Field;\n import org.apache.arrow.vector.util.CallBack;\n+import org.apache.arrow.vector.util.JsonStringHashMap;\n import org.apache.arrow.vector.util.OversizedAllocationException;\n import org.apache.arrow.vector.util.TransferPair;\n \n-public class MapVector extends NonNullableMapVector implements FieldVector {\n+import javax.annotation.Nullable;\n+\n+public class MapVector extends AbstractMapVector implements FieldVector {\n \n   public static MapVector empty(String name, BufferAllocator allocator) {\n     FieldType fieldType = FieldType.nullable(Struct.INSTANCE);\n     return new MapVector(name, allocator, fieldType, null);\n   }\n \n-  private final NullableMapReaderImpl reader = new NullableMapReaderImpl(this);\n-  private final NullableMapWriter writer = new NullableMapWriter(this);\n-\n   protected ArrowBuf validityBuffer;\n   private int validityAllocationSizeInBytes;\n+  private final FieldType fieldType;\n+  private int valueCount;\n+  private final NullableMapReaderImpl reader;\n+  private final NullableMapWriter writer;\n \n   // deprecated, use FieldType or static constructor instead\n   @Deprecated\n@@ -70,14 +78,27 @@ public MapVector(String name, BufferAllocator allocator, DictionaryEncoding dict\n   }\n \n   public MapVector(String name, BufferAllocator allocator, FieldType fieldType, CallBack callBack) {\n-    super(name, checkNotNull(allocator), fieldType, callBack);\n+    super(name, checkNotNull(allocator), callBack);\n+    this.fieldType = checkNotNull(fieldType);\n+    this.valueCount = 0;\n     this.validityBuffer = allocator.getEmpty();\n     this.validityAllocationSizeInBytes = BitVectorHelper.getValidityBufferSize(BaseValueVector.INITIAL_VALUE_ALLOCATION);\n+    this.reader = new NullableMapReaderImpl(this);\n+    this.writer = new NullableMapWriter(this);  // NOTE: fieldType must be set before this\n+  }\n+\n+  @Override\n+  public Types.MinorType getMinorType() {\n+    return Types.MinorType.MAP;\n   }\n \n   @Override\n   public Field getField() {\n-    Field f = super.getField();\n+    List<Field> children = new ArrayList<>();\n+    for (ValueVector child : getChildren()) {\n+      children.add(child.getField());\n+    }\n+    Field f = new Field(name, fieldType, children);\n     FieldType type = new FieldType(true, f.getType(), f.getFieldType().getDictionary(), f.getFieldType().getMetadata());\n     return new Field(f.getName(), type, f.getChildren());\n   }\n@@ -116,6 +137,19 @@ private void setReaderAndWriterIndex() {\n     throw new UnsupportedOperationException(\"There are no inner vectors. Use getFieldBuffers\");\n   }\n \n+  @Override\n+  protected boolean supportsDirectRead() {\n+    return true;\n+  }\n+\n+  public Iterator<String> fieldNameIterator() {\n+    return getChildFieldNames().iterator();\n+  }\n+\n+  public ValueVector getVectorById(int id) {\n+    return getChildByOrdinal(id);\n+  }\n+\n   @Override\n   public NullableMapReaderImpl getReader() {\n     return reader;\n@@ -125,6 +159,15 @@ public NullableMapWriter getWriter() {\n     return writer;\n   }\n \n+  transient private NullableMapTransferPair ephPair;\n+\n+  public void copyFromSafe(int fromIndex, int thisIndex, MapVector from) {\n+    if (ephPair == null || ephPair.from != from) {\n+      ephPair = (NullableMapTransferPair) from.makeTransferPair(this);\n+    }\n+    ephPair.copyValueSafe(fromIndex, thisIndex);\n+  }\n+\n   @Override\n   public TransferPair getTransferPair(BufferAllocator allocator) {\n     return new NullableMapTransferPair(this, new MapVector(name, allocator, fieldType, null), false);\n@@ -145,37 +188,79 @@ public TransferPair getTransferPair(String ref, BufferAllocator allocator, CallB\n     return new NullableMapTransferPair(this, new MapVector(ref, allocator, fieldType, callBack), false);\n   }\n \n-  protected class NullableMapTransferPair extends MapTransferPair {\n+  protected class NullableMapTransferPair implements TransferPair {\n \n-    private MapVector target;\n+    private final TransferPair[] pairs;\n+    private final MapVector from;\n+    private final MapVector to;\n \n     protected NullableMapTransferPair(MapVector from, MapVector to, boolean allocate) {\n-      super(from, to, allocate);\n-      this.target = to;\n+      this.from = from;\n+      this.to = to;\n+      this.pairs = new TransferPair[from.size()];\n+      this.to.ephPair = null;\n+\n+      int i = 0;\n+      FieldVector vector;\n+      for (String child : from.getChildFieldNames()) {\n+        int preSize = to.size();\n+        vector = from.getChild(child);\n+        if (vector == null) {\n+          continue;\n+        }\n+        //DRILL-1872: we add the child fields for the vector, looking up the field by name. For a map vector,\n+        // the child fields may be nested fields of the top level child. For example if the structure\n+        // of a child field is oa.oab.oabc then we add oa, then add oab to oa then oabc to oab.\n+        // But the children member of a Materialized field is a HashSet. If the fields are added in the\n+        // children HashSet, and the hashCode of the Materialized field includes the hash code of the\n+        // children, the hashCode value of oa changes *after* the field has been added to the HashSet.\n+        // (This is similar to what happens in ScanBatch where the children cannot be added till they are\n+        // read). To take care of this, we ensure that the hashCode of the MaterializedField does not\n+        // include the hashCode of the children but is based only on MaterializedField$key.\n+        final FieldVector newVector = to.addOrGet(child, vector.getField().getFieldType(), vector.getClass());\n+        if (allocate && to.size() != preSize) {\n+          newVector.allocateNew();\n+        }\n+        pairs[i++] = vector.makeTransferPair(newVector);\n+      }\n     }\n \n     @Override\n     public void transfer() {\n-      target.clear();\n-      target.validityBuffer = validityBuffer.transferOwnership(target.allocator).buffer;\n-      super.transfer();\n+      to.clear();\n+      to.validityBuffer = validityBuffer.transferOwnership(to.allocator).buffer;\n+      for (final TransferPair p : pairs) {\n+        p.transfer();\n+      }\n+      to.valueCount = from.valueCount;\n+      from.clear();\n       clear();\n     }\n \n+    @Override\n+    public ValueVector getTo() {\n+      return to;\n+    }\n+\n     @Override\n     public void copyValueSafe(int fromIndex, int toIndex) {\n-      while (toIndex >= target.getValidityBufferValueCapacity()) {\n-        target.reallocValidityBuffer();\n+      while (toIndex >= to.getValidityBufferValueCapacity()) {\n+        to.reallocValidityBuffer();\n+      }\n+      BitVectorHelper.setValidityBit(to.validityBuffer, toIndex, isSet(fromIndex));\n+      for (TransferPair p : pairs) {\n+        p.copyValueSafe(fromIndex, toIndex);\n       }\n-      BitVectorHelper.setValidityBit(target.validityBuffer, toIndex, isSet(fromIndex));\n-      super.copyValueSafe(fromIndex, toIndex);\n     }\n \n     @Override\n     public void splitAndTransfer(int startIndex, int length) {\n-      target.clear();\n-      splitAndTransferValidityBuffer(startIndex, length, target);\n-      super.splitAndTransfer(startIndex, length);\n+      to.clear();\n+      splitAndTransferValidityBuffer(startIndex, length, to);\n+      for (TransferPair p : pairs) {\n+        p.splitAndTransfer(startIndex, length);\n+      }\n+      to.setValueCount(length);\n     }\n   }\n \n@@ -252,8 +337,22 @@ private int getValidityBufferValueCapacity() {\n    */\n   @Override\n   public int getValueCapacity() {\n+    if (size() == 0) {\n+      return 0;\n+    }\n+\n+    final Ordering<ValueVector> natural = new Ordering<ValueVector>() {\n+      @Override\n+      public int compare(@Nullable ValueVector left, @Nullable ValueVector right) {\n+        return Ints.compare(\n+            checkNotNull(left).getValueCapacity(),\n+            checkNotNull(right).getValueCapacity()\n+        );\n+      }\n+    };\n+\n     return Math.min(getValidityBufferValueCapacity(),\n-            super.getValueCapacity());\n+        natural.min(getChildren()).getValueCapacity());\n   }\n \n   /**\n@@ -293,6 +392,12 @@ public int getValueCapacity() {\n   @Override\n   public void close() {\n     clearValidityBuffer();\n+    final Collection<FieldVector> vectors = getChildren();\n+    for (final FieldVector v : vectors) {\n+      v.close();\n+    }\n+    vectors.clear();\n+    valueCount = 0;\n     super.close();\n   }\n \n@@ -302,7 +407,10 @@ public void close() {\n   @Override\n   public void clear() {\n     clearValidityBuffer();\n-    super.clear();\n+    for (final ValueVector v : getChildren()) {\n+      v.clear();\n+    }\n+    valueCount = 0;\n   }\n \n   /**\n@@ -320,11 +428,15 @@ private void clearValidityBuffer() {\n    */\n   @Override\n   public int getBufferSize() {\n-    if (valueCount == 0) {\n+    if (valueCount == 0 || size() == 0) {\n       return 0;\n     }\n-    return super.getBufferSize() +\n-            BitVectorHelper.getValidityBufferSize(valueCount);\n+    long bufferSize = 0;\n+    for (final ValueVector v : (Iterable<ValueVector>) this) {\n+      bufferSize += v.getBufferSize();\n+    }\n+\n+    return ((int) bufferSize) + BitVectorHelper.getValidityBufferSize(valueCount);\n   }\n \n   /**\n@@ -338,14 +450,21 @@ public int getBufferSizeFor(final int valueCount) {\n     if (valueCount == 0) {\n       return 0;\n     }\n-    return super.getBufferSizeFor(valueCount)\n-            + BitVectorHelper.getValidityBufferSize(valueCount);\n+\n+    long bufferSize = 0;\n+    for (final ValueVector v : (Iterable<ValueVector>) this) {\n+      bufferSize += v.getBufferSizeFor(valueCount);\n+    }\n+\n+    return ((int) bufferSize) + BitVectorHelper.getValidityBufferSize(valueCount);\n   }\n \n   @Override\n   public void setInitialCapacity(int numRecords) {\n     validityAllocationSizeInBytes = BitVectorHelper.getValidityBufferSize(numRecords);\n-    super.setInitialCapacity(numRecords);\n+    for (final ValueVector v : (Iterable<ValueVector>) this) {\n+      v.setInitialCapacity(numRecords);\n+    }\n   }\n \n   @Override\n@@ -437,19 +556,34 @@ public ArrowBuf getOffsetBuffer() {\n     throw new UnsupportedOperationException();\n   }\n \n+  @Override\n+  public int getValueCount() {\n+    return valueCount;\n+  }\n+\n   @Override\n   public Object getObject(int index) {\n     if (isSet(index) == 0) {\n       return null;\n     } else {\n-      return super.getObject(index);\n+      Map<String, Object> vv = new JsonStringHashMap<>();\n+      for (String child : getChildFieldNames()) {\n+        ValueVector v = getChild(child);\n+        if (v != null && index < v.getValueCount()) {\n+          Object value = v.getObject(index);\n+          if (value != null) {\n+            vv.put(child, value);\n+          }\n+        }\n+      }\n+      return vv;\n     }\n   }\n \n-  @Override\n   public void get(int index, ComplexHolder holder) {\n     holder.isSet = isSet(index);\n-    super.get(index, holder);\n+    reader.setPosition(index);\n+    holder.reader = reader;\n   }\n \n   public int getNullCount() {\n@@ -490,7 +624,9 @@ public void setValueCount(int valueCount) {\n       /* realloc the inner buffers if needed */\n       reallocValidityBuffer();\n     }\n-    super.setValueCount(valueCount);\n+    for (final ValueVector v : getChildren()) {\n+      v.setValueCount(valueCount);\n+    }\n     this.valueCount = valueCount;\n   }\n \n@@ -498,6 +634,19 @@ public void reset() {\n     valueCount = 0;\n   }\n \n+  @Override\n+  public void initializeChildrenFromFields(List<Field> children) {\n+    for (Field field : children) {\n+      FieldVector vector = (FieldVector) this.add(field.getName(), field.getFieldType());\n+      vector.initializeChildrenFromFields(field.getChildren());\n+    }\n+  }\n+\n+  @Override\n+  public List<FieldVector> getChildrenFromFields() {\n+    return getChildren();\n+  }\n+\n   @Override\n   @Deprecated\n   public Accessor getAccessor() {\ndiff --git a/java/vector/src/main/java/org/apache/arrow/vector/complex/NonNullableMapVector.java b/java/vector/src/main/java/org/apache/arrow/vector/complex/NonNullableMapVector.java\ndeleted file mode 100644\nindex cc3ac4148..000000000\n--- a/java/vector/src/main/java/org/apache/arrow/vector/complex/NonNullableMapVector.java\n+++ /dev/null\n@@ -1,352 +0,0 @@\n-/**\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- * http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing, software\n- * distributed under the License is distributed on an \"AS IS\" BASIS,\n- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n- * See the License for the specific language governing permissions and\n- * limitations under the License.\n- */\n-\n-package org.apache.arrow.vector.complex;\n-\n-import static com.google.common.base.Preconditions.checkNotNull;\n-\n-import java.util.ArrayList;\n-import java.util.Collection;\n-import java.util.Iterator;\n-import java.util.List;\n-import java.util.Map;\n-\n-import javax.annotation.Nullable;\n-\n-import com.google.common.base.Preconditions;\n-import com.google.common.collect.Ordering;\n-import com.google.common.primitives.Ints;\n-\n-import io.netty.buffer.ArrowBuf;\n-\n-import org.apache.arrow.memory.BufferAllocator;\n-import org.apache.arrow.vector.*;\n-import org.apache.arrow.vector.complex.impl.SingleMapReaderImpl;\n-import org.apache.arrow.vector.complex.reader.FieldReader;\n-import org.apache.arrow.vector.holders.ComplexHolder;\n-import org.apache.arrow.vector.types.Types.MinorType;\n-import org.apache.arrow.vector.types.pojo.ArrowType;\n-import org.apache.arrow.vector.types.pojo.Field;\n-import org.apache.arrow.vector.types.pojo.FieldType;\n-import org.apache.arrow.vector.util.CallBack;\n-import org.apache.arrow.vector.util.JsonStringHashMap;\n-import org.apache.arrow.vector.util.TransferPair;\n-\n-public class NonNullableMapVector extends AbstractMapVector {\n-  //private static final org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(NonNullableMapVector.class);\n-\n-  public static NonNullableMapVector empty(String name, BufferAllocator allocator) {\n-    FieldType fieldType = new FieldType(false, ArrowType.Struct.INSTANCE, null, null);\n-    return new NonNullableMapVector(name, allocator, fieldType, null);\n-  }\n-\n-  private final SingleMapReaderImpl reader = new SingleMapReaderImpl(this);\n-  protected final FieldType fieldType;\n-  public int valueCount;\n-\n-  // deprecated, use FieldType or static constructor instead\n-  @Deprecated\n-  public NonNullableMapVector(String name, BufferAllocator allocator, CallBack callBack) {\n-    this(name, allocator, new FieldType(false, ArrowType.Struct.INSTANCE, null, null), callBack);\n-  }\n-\n-  public NonNullableMapVector(String name, BufferAllocator allocator, FieldType fieldType, CallBack callBack) {\n-    super(name, allocator, callBack);\n-    this.fieldType = checkNotNull(fieldType);\n-    this.valueCount = 0;\n-  }\n-\n-  @Override\n-  public FieldReader getReader() {\n-    return reader;\n-  }\n-\n-  transient private MapTransferPair ephPair;\n-\n-  public void copyFromSafe(int fromIndex, int thisIndex, NonNullableMapVector from) {\n-    if (ephPair == null || ephPair.from != from) {\n-      ephPair = (MapTransferPair) from.makeTransferPair(this);\n-    }\n-    ephPair.copyValueSafe(fromIndex, thisIndex);\n-  }\n-\n-  @Override\n-  protected boolean supportsDirectRead() {\n-    return true;\n-  }\n-\n-  public Iterator<String> fieldNameIterator() {\n-    return getChildFieldNames().iterator();\n-  }\n-\n-  @Override\n-  public void setInitialCapacity(int numRecords) {\n-    for (final ValueVector v : (Iterable<ValueVector>) this) {\n-      v.setInitialCapacity(numRecords);\n-    }\n-  }\n-\n-  @Override\n-  public int getBufferSize() {\n-    if (valueCount == 0 || size() == 0) {\n-      return 0;\n-    }\n-    long buffer = 0;\n-    for (final ValueVector v : (Iterable<ValueVector>) this) {\n-      buffer += v.getBufferSize();\n-    }\n-\n-    return (int) buffer;\n-  }\n-\n-  @Override\n-  public int getBufferSizeFor(final int valueCount) {\n-    if (valueCount == 0) {\n-      return 0;\n-    }\n-\n-    long bufferSize = 0;\n-    for (final ValueVector v : (Iterable<ValueVector>) this) {\n-      bufferSize += v.getBufferSizeFor(valueCount);\n-    }\n-\n-    return (int) bufferSize;\n-  }\n-\n-  @Override\n-  public ArrowBuf getValidityBuffer() {\n-    throw new UnsupportedOperationException();\n-  }\n-\n-  @Override\n-  public ArrowBuf getDataBuffer() {\n-    throw new UnsupportedOperationException();\n-  }\n-\n-  @Override\n-  public ArrowBuf getOffsetBuffer() {\n-    throw new UnsupportedOperationException();\n-  }\n-\n-  @Override\n-  public TransferPair getTransferPair(BufferAllocator allocator) {\n-    return getTransferPair(name, allocator, null);\n-  }\n-\n-  @Override\n-  public TransferPair getTransferPair(String ref, BufferAllocator allocator, CallBack callBack) {\n-    return new MapTransferPair(this, new NonNullableMapVector(name, allocator, fieldType, callBack), false);\n-  }\n-\n-  @Override\n-  public TransferPair makeTransferPair(ValueVector to) {\n-    return new MapTransferPair(this, (NonNullableMapVector) to);\n-  }\n-\n-  @Override\n-  public TransferPair getTransferPair(String ref, BufferAllocator allocator) {\n-    return new MapTransferPair(this, new NonNullableMapVector(ref, allocator, fieldType, callBack), false);\n-  }\n-\n-  protected static class MapTransferPair implements TransferPair {\n-    private final TransferPair[] pairs;\n-    private final NonNullableMapVector from;\n-    private final NonNullableMapVector to;\n-\n-    public MapTransferPair(NonNullableMapVector from, NonNullableMapVector to) {\n-      this(from, to, true);\n-    }\n-\n-    protected MapTransferPair(NonNullableMapVector from, NonNullableMapVector to, boolean allocate) {\n-      this.from = from;\n-      this.to = to;\n-      this.pairs = new TransferPair[from.size()];\n-      this.to.ephPair = null;\n-\n-      int i = 0;\n-      FieldVector vector;\n-      for (String child : from.getChildFieldNames()) {\n-        int preSize = to.size();\n-        vector = from.getChild(child);\n-        if (vector == null) {\n-          continue;\n-        }\n-        //DRILL-1872: we add the child fields for the vector, looking up the field by name. For a map vector,\n-        // the child fields may be nested fields of the top level child. For example if the structure\n-        // of a child field is oa.oab.oabc then we add oa, then add oab to oa then oabc to oab.\n-        // But the children member of a Materialized field is a HashSet. If the fields are added in the\n-        // children HashSet, and the hashCode of the Materialized field includes the hash code of the\n-        // children, the hashCode value of oa changes *after* the field has been added to the HashSet.\n-        // (This is similar to what happens in ScanBatch where the children cannot be added till they are\n-        // read). To take care of this, we ensure that the hashCode of the MaterializedField does not\n-        // include the hashCode of the children but is based only on MaterializedField$key.\n-        final FieldVector newVector = to.addOrGet(child, vector.getField().getFieldType(), vector.getClass());\n-        if (allocate && to.size() != preSize) {\n-          newVector.allocateNew();\n-        }\n-        pairs[i++] = vector.makeTransferPair(newVector);\n-      }\n-    }\n-\n-    @Override\n-    public void transfer() {\n-      for (final TransferPair p : pairs) {\n-        p.transfer();\n-      }\n-      to.valueCount = from.valueCount;\n-      from.clear();\n-    }\n-\n-    @Override\n-    public ValueVector getTo() {\n-      return to;\n-    }\n-\n-    @Override\n-    public void copyValueSafe(int from, int to) {\n-      for (TransferPair p : pairs) {\n-        p.copyValueSafe(from, to);\n-      }\n-    }\n-\n-    @Override\n-    public void splitAndTransfer(int startIndex, int length) {\n-      for (TransferPair p : pairs) {\n-        p.splitAndTransfer(startIndex, length);\n-      }\n-      to.setValueCount(length);\n-    }\n-  }\n-\n-  @Override\n-  public int getValueCapacity() {\n-    if (size() == 0) {\n-      return 0;\n-    }\n-\n-    final Ordering<ValueVector> natural = new Ordering<ValueVector>() {\n-      @Override\n-      public int compare(@Nullable ValueVector left, @Nullable ValueVector right) {\n-        return Ints.compare(\n-            checkNotNull(left).getValueCapacity(),\n-            checkNotNull(right).getValueCapacity()\n-        );\n-      }\n-    };\n-\n-    return natural.min(getChildren()).getValueCapacity();\n-  }\n-\n-  @Override\n-  public Accessor getAccessor() {\n-    throw new UnsupportedOperationException(\"accessor is not needed for MAP\");\n-  }\n-\n-  @Override\n-  public Mutator getMutator() {\n-    throw new UnsupportedOperationException(\"mutator is not needed for MAP\");\n-  }\n-\n-  @Override\n-  public Object getObject(int index) {\n-    Map<String, Object> vv = new JsonStringHashMap<>();\n-    for (String child : getChildFieldNames()) {\n-      ValueVector v = getChild(child);\n-      if (v != null && index < v.getValueCount()) {\n-        Object value = v.getObject(index);\n-        if (value != null) {\n-          vv.put(child, value);\n-        }\n-      }\n-    }\n-    return vv;\n-  }\n-\n-  @Override\n-  public boolean isNull(int index) { return false; }\n-  @Override\n-  public int getNullCount() { return 0; }\n-\n-  public void get(int index, ComplexHolder holder) {\n-    reader.setPosition(index);\n-    holder.reader = reader;\n-  }\n-\n-  @Override\n-  public int getValueCount() {\n-    return valueCount;\n-  }\n-\n-  public ValueVector getVectorById(int id) {\n-  return getChildByOrdinal(id);\n-}\n-\n-  @Override\n-  public void setValueCount(int valueCount) {\n-    for (final ValueVector v : getChildren()) {\n-      v.setValueCount(valueCount);\n-    }\n-    NonNullableMapVector.this.valueCount = valueCount;\n-  }\n-\n-  @Override\n-  public void clear() {\n-    for (final ValueVector v : getChildren()) {\n-      v.clear();\n-    }\n-    valueCount = 0;\n-  }\n-\n-  @Override\n-  public Field getField() {\n-    List<Field> children = new ArrayList<>();\n-    for (ValueVector child : getChildren()) {\n-      children.add(child.getField());\n-    }\n-    return new Field(name, fieldType, children);\n-  }\n-\n-  @Override\n-  public MinorType getMinorType() {\n-    return MinorType.MAP;\n-  }\n-\n-  @Override\n-  public void close() {\n-    final Collection<FieldVector> vectors = getChildren();\n-    for (final FieldVector v : vectors) {\n-      v.close();\n-    }\n-    vectors.clear();\n-\n-    valueCount = 0;\n-\n-    super.close();\n-  }\n-\n-  public void initializeChildrenFromFields(List<Field> children) {\n-    for (Field field : children) {\n-      FieldVector vector = (FieldVector) this.add(field.getName(), field.getFieldType());\n-      vector.initializeChildrenFromFields(field.getChildren());\n-    }\n-  }\n-\n-  public List<FieldVector> getChildrenFromFields() {\n-    return getChildren();\n-  }\n-}\ndiff --git a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/ComplexWriterImpl.java b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/ComplexWriterImpl.java\nindex 970b90ef5..71bd9ae1c 100644\n--- a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/ComplexWriterImpl.java\n+++ b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/ComplexWriterImpl.java\n@@ -20,7 +20,6 @@\n \n import org.apache.arrow.vector.complex.ListVector;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.complex.StateTool;\n import org.apache.arrow.vector.complex.writer.BaseWriter.ComplexWriter;\n import org.apache.arrow.vector.types.pojo.Field;\n@@ -131,7 +130,7 @@ public MapWriter directMap() {\n     switch (mode) {\n \n       case INIT:\n-        mapRoot = nullableMapWriterFactory.build((MapVector) container);\n+        mapRoot = nullableMapWriterFactory.build(container);\n         mapRoot.setPosition(idx());\n         mode = Mode.MAP;\n         break;\ndiff --git a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/NullableMapReaderImpl.java b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/NullableMapReaderImpl.java\nindex acf155af7..d3e0eee97 100644\n--- a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/NullableMapReaderImpl.java\n+++ b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/NullableMapReaderImpl.java\n@@ -19,7 +19,6 @@\n \n package org.apache.arrow.vector.complex.impl;\n \n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.complex.writer.BaseWriter.MapWriter;\n import org.apache.arrow.vector.types.pojo.Field;\n@@ -29,8 +28,8 @@\n   private MapVector nullableMapVector;\n \n   public NullableMapReaderImpl(MapVector vector) {\n-    super((MapVector) vector);\n-    this.nullableMapVector = (MapVector) vector;\n+    super(vector);\n+    this.nullableMapVector = vector;\n   }\n \n   @Override\ndiff --git a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/SingleMapReaderImpl.java b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/SingleMapReaderImpl.java\nindex 0341b622e..5cb4e9196 100644\n--- a/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/SingleMapReaderImpl.java\n+++ b/java/vector/src/main/java/org/apache/arrow/vector/complex/impl/SingleMapReaderImpl.java\n@@ -24,7 +24,6 @@\n \n import org.apache.arrow.vector.ValueVector;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.NonNullableMapVector;\n import org.apache.arrow.vector.complex.reader.FieldReader;\n import org.apache.arrow.vector.complex.writer.BaseWriter.MapWriter;\n import org.apache.arrow.vector.types.Types.MinorType;\n@@ -35,10 +34,10 @@\n @SuppressWarnings(\"unused\")\n public class SingleMapReaderImpl extends AbstractFieldReader {\n \n-  private final NonNullableMapVector vector;\n+  private final MapVector vector;\n   private final Map<String, FieldReader> fields = Maps.newHashMap();\n \n-  public SingleMapReaderImpl(NonNullableMapVector vector) {\n+  public SingleMapReaderImpl(MapVector vector) {\n     this.vector = vector;\n   }\n \n@@ -89,7 +88,7 @@ public MinorType getMinorType() {\n \n   @Override\n   public boolean isSet() {\n-    return true;\n+    return !vector.isNull(idx());\n   }\n \n   @Override\ndiff --git a/java/vector/src/test/java/org/apache/arrow/vector/complex/impl/TestPromotableWriter.java b/java/vector/src/test/java/org/apache/arrow/vector/complex/impl/TestPromotableWriter.java\nindex 38b78424d..464dbed4b 100644\n--- a/java/vector/src/test/java/org/apache/arrow/vector/complex/impl/TestPromotableWriter.java\n+++ b/java/vector/src/test/java/org/apache/arrow/vector/complex/impl/TestPromotableWriter.java\n@@ -25,7 +25,6 @@\n import org.apache.arrow.memory.BufferAllocator;\n import org.apache.arrow.vector.DirtyRootAllocator;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.complex.UnionVector;\n import org.apache.arrow.vector.complex.writer.BaseWriter.MapWriter;\n import org.apache.arrow.vector.types.pojo.ArrowType;\ndiff --git a/java/vector/src/test/java/org/apache/arrow/vector/complex/writer/TestComplexWriter.java b/java/vector/src/test/java/org/apache/arrow/vector/complex/writer/TestComplexWriter.java\nindex bd8489eb2..5671f3c6d 100644\n--- a/java/vector/src/test/java/org/apache/arrow/vector/complex/writer/TestComplexWriter.java\n+++ b/java/vector/src/test/java/org/apache/arrow/vector/complex/writer/TestComplexWriter.java\n@@ -34,7 +34,6 @@\n import org.apache.arrow.vector.IntVector;\n import org.apache.arrow.vector.complex.ListVector;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.NonNullableMapVector;\n import org.apache.arrow.vector.complex.UnionVector;\n import org.apache.arrow.vector.complex.impl.ComplexWriterImpl;\n import org.apache.arrow.vector.complex.impl.SingleMapReaderImpl;\n@@ -849,11 +848,12 @@ public void testSingleMapWriter1() {\n     /* initialize a SingleMapWriter with empty MapVector and then lazily\n      * create all vectors with expected initialCapacity.\n      */\n-    NonNullableMapVector parent = NonNullableMapVector.empty(\"parent\", allocator);\n+    MapVector parent = MapVector.empty(\"parent\", allocator);\n     SingleMapWriter singleMapWriter = new SingleMapWriter(parent);\n \n     int initialCapacity = 1024;\n     singleMapWriter.setInitialCapacity(initialCapacity);\n+    singleMapWriter.allocate();\n \n     IntWriter intWriter = singleMapWriter.integer(\"intField\");\n     BigIntWriter bigIntWriter = singleMapWriter.bigInt(\"bigIntField\");\ndiff --git a/java/vector/src/test/java/org/apache/arrow/vector/ipc/BaseFileTest.java b/java/vector/src/test/java/org/apache/arrow/vector/ipc/BaseFileTest.java\nindex 3514acaa2..79b388482 100644\n--- a/java/vector/src/test/java/org/apache/arrow/vector/ipc/BaseFileTest.java\n+++ b/java/vector/src/test/java/org/apache/arrow/vector/ipc/BaseFileTest.java\n@@ -38,7 +38,6 @@\n import org.apache.arrow.vector.VectorSchemaRoot;\n import org.apache.arrow.vector.complex.ListVector;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.complex.impl.ComplexWriterImpl;\n import org.apache.arrow.vector.complex.impl.UnionListWriter;\n import org.apache.arrow.vector.complex.reader.FieldReader;\ndiff --git a/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestArrowFile.java b/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestArrowFile.java\nindex 0cfc9ba91..d2dea0523 100644\n--- a/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestArrowFile.java\n+++ b/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestArrowFile.java\n@@ -43,7 +43,6 @@\n import org.apache.arrow.vector.VectorUnloader;\n import org.apache.arrow.vector.complex.FixedSizeListVector;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.dictionary.DictionaryProvider.MapDictionaryProvider;\n import org.apache.arrow.vector.ipc.message.ArrowBlock;\n import org.apache.arrow.vector.ipc.message.ArrowBuffer;\ndiff --git a/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestJSONFile.java b/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestJSONFile.java\nindex 625717048..27b377bf4 100644\n--- a/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestJSONFile.java\n+++ b/java/vector/src/test/java/org/apache/arrow/vector/ipc/TestJSONFile.java\n@@ -25,7 +25,6 @@\n import org.apache.arrow.vector.FieldVector;\n import org.apache.arrow.vector.VectorSchemaRoot;\n import org.apache.arrow.vector.complex.MapVector;\n-import org.apache.arrow.vector.complex.MapVector;\n import org.apache.arrow.vector.dictionary.DictionaryProvider;\n import org.apache.arrow.vector.dictionary.DictionaryProvider.MapDictionaryProvider;\n import org.apache.arrow.vector.types.pojo.Schema;\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2017-12-04T18:13:12.728+0000",
                    "updated": "2017-12-04T18:13:12.728+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13121385/comment/17585784",
                    "id": "17585784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "body": "Transitioning issue from Resolved to Closed to based on resolution field value.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "created": "2022-08-27T14:41:41.163+0000",
                    "updated": "2022-08-27T14:41:41.163+0000"
                }
            ],
            "maxResults": 54,
            "total": 54,
            "startAt": 0
        },
        "customfield_12311820": "0|i3nap3:",
        "customfield_12314139": null
    }
}