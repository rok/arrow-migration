{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13378165",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165",
    "key": "ARROW-12761",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9000,
            "total": 9000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12761/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 15,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/601211",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic opened a new pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-24T14:26:43.005+0000",
                    "updated": "2021-05-24T14:26:43.005+0000",
                    "started": "2021-05-24T14:26:43.005+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "601211",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/601213",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#issuecomment-847083731\n\n\n   https://issues.apache.org/jira/browse/ARROW-12761\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-24T14:33:24.000+0000",
                    "updated": "2021-05-24T14:33:24.000+0000",
                    "started": "2021-05-24T14:33:24.000+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "601213",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/601664",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r638725724\n\n\n\n##########\nFile path: r/tests/testthat/test-csv.R\n##########\n@@ -317,7 +317,7 @@ test_that(\"Write a CSV file with different batch sizes\", {\n test_that(\"Write a CSV file with invalid input type\", {\n   expect_error(\n     write_csv_arrow(Array$create(1:5), csv_file),\n-    regexp = 'x must be a \"ArrowTabular\"'\n+    regexp = \"Cannot write to CSV. 'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not 'Array'\"\n\nReview comment:\n       This is also not strictly about this pull request, but I believe the \ud83d\udce6 would benefit from switching to testthat 3rd edition `expect_snaphot()` ... https://testthat.r-lib.org/articles/third-edition.html\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,9 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format){\n+  if(!inherits(x, \"ArrowTabular\")){\n+    stop(paste0(\"Cannot write to \", format, \". 'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '\", class(x)[1], \"'\"))\n\nReview comment:\n       This might be more of a general thing than related to this specific pull request, but perhaps we could use `rlang::abort()` and take advantage of the bullets, e.g. \r\n   \r\n   ```r\r\n   abort(c(\r\n     paste0(\"Cannot write to \", format, \".), \r\n     x = paste0(\"'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '\", class(x)[1], \"'\")\r\n   ))\r\n   ```\r\n   \r\n   Or if we were willing to use `glue::` \r\n   \r\n   ```r\r\n   abort(c(\r\n     glue(\"Cannot write to { format }.\"), \r\n     x = glue(\"'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '{ class(x)[1] }'\")\r\n   ))\r\n   ```\r\n   \r\n   Relatedly, we tend to use backticks when naming objects and calls, i.e. \r\n   \r\n   ```r\r\n   glue(\"`x` must be an object\") ...\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-25T12:07:40.424+0000",
                    "updated": "2021-05-25T12:07:40.424+0000",
                    "started": "2021-05-25T12:07:40.423+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "601664",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/601754",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r638834438\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,9 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format){\n+  if(!inherits(x, \"ArrowTabular\")){\n+    stop(paste0(\"Cannot write to \", format, \". 'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '\", class(x)[1], \"'\"))\n\nReview comment:\n       Great idea, have changed to use `rlang::abort`. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-25T14:20:16.810+0000",
                    "updated": "2021-05-25T14:20:16.810+0000",
                    "started": "2021-05-25T14:20:16.809+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "601754",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/602424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r639909406\n\n\n\n##########\nFile path: r/tests/testthat/test-csv.R\n##########\n@@ -317,7 +317,7 @@ test_that(\"Write a CSV file with different batch sizes\", {\n test_that(\"Write a CSV file with invalid input type\", {\n   expect_error(\n     write_csv_arrow(Array$create(1:5), csv_file),\n-    regexp = 'x must be a \"ArrowTabular\"'\n+    regexp = \"Cannot write to CSV. 'x' must be an object of class 'data.frame', 'RecordBatch', or 'Table', not 'Array'\"\n\nReview comment:\n       Sounds good - Jon opened a ticket to do that\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-26T16:36:12.961+0000",
                    "updated": "2021-05-26T16:36:12.961+0000",
                    "started": "2021-05-26T16:36:12.961+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "602424",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/602784",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "romainfrancois commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r640381291\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,18 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format) {\n+  if (!inherits(x, \"ArrowTabular\")) {\n+    abort(\n+      c(\n+        paste0(\"Cannot write to \", format, \".\"),\n+        x = paste0(\n+          \"`x` must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '\",\n+          class(x)[1],\n+          \"'\"\n+        )\n+      )\n+    )\n+  }\n+}\n\nReview comment:\n       ```suggestion\r\n   }\r\n   \r\n   ```\r\n   \r\n   GitHub seems concerned that this does not have a newline. \r\n   \r\n   Should this perhaps end with `invisible(x)` ? Probably not important with the current use case, but that would allow e.g. `do_something(check_tabular(x), ...)`\r\n   \r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-27T08:01:56.793+0000",
                    "updated": "2021-05-27T08:01:56.793+0000",
                    "started": "2021-05-27T08:01:56.793+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "602784",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/602833",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r640456625\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,18 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format) {\n+  if (!inherits(x, \"ArrowTabular\")) {\n+    abort(\n+      c(\n+        paste0(\"Cannot write to \", format, \".\"),\n+        x = paste0(\n+          \"`x` must be an object of class 'data.frame', 'RecordBatch', or 'Table', not '\",\n+          class(x)[1],\n+          \"'\"\n+        )\n+      )\n+    )\n+  }\n+}\n\nReview comment:\n       Thanks for looking at this- have updated it to do this now to return `invisible(x)` & will update the tests to use `expect_snapshot_error` when making a PR to upgrade to testthat 3e.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-05-27T09:31:54.329+0000",
                    "updated": "2021-05-27T09:31:54.329+0000",
                    "started": "2021-05-27T09:31:54.329+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "602833",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/604647",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r643343363\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,19 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format) {\n\nReview comment:\n       I like factoring out a function to encapsulate common logic, but I have some concerns with this one. The name is too generic--I would expect `check_tabular <- function(x) inherits(x, \"ArrowTabular\")`--but this is much more specific and doesn't really describe what it does, which I think will make this harder to maintain and use going forward.\r\n   \r\n   * Nothing about the function name suggests that it is only for writing to a format, but the error message says that\r\n   * It checks whether you have `ArrowTabular` but then the error message says data.frame or ArrowTabular. This happens to work because you call it after converting data.frame to Table inside each function where this is used, but it wouldn't necessarily work if you used it in another function.\r\n   * It says \"`x` must be ...\" but nothing guarantees that the argument name in the parent function is called `x`\r\n   \r\n   Some suggestions:\r\n   \r\n   * Rename to `assert_` something since, like the other assert_ functions, this raises an error if the condition is not met. \r\n   * Either make the full error message (i.e. what currently is `paste0(\"Cannot write to \", format, \".\")` a function argument so that the function isn't specific to writing, or put \"write\" somewhere in the function name so that it's clear that it's only for validating writing.\r\n   * Use some `call` parsing to get the actual argument name from the caller (that is, don't assume it's called `x`) (Would `asserthat` do this for you, or have code you can refer to for inspiration?)\r\n   * Change the assertion to `if (!inherits(x, c(\"data.frame\", \"ArrowTabular\")))` so that it matches the message. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-01T17:30:26.459+0000",
                    "updated": "2021-06-01T17:30:26.459+0000",
                    "started": "2021-06-01T17:30:26.459+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "604647",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/605136",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r643894665\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,19 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+check_tabular <- function(x, format) {\n\nReview comment:\n       Cheers for the feedback @nealrichardson, and thanks for the `assertthat` hint, I have learned a LOT about evaluation this morning working that one out :grin: \r\n   \r\n   I've made a number of changes - let me know how it looks now or if there's still more to do.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T12:06:10.299+0000",
                    "updated": "2021-06-02T12:06:10.299+0000",
                    "started": "2021-06-02T12:06:10.298+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605136",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/605351",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r644135689\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n\nReview comment:\n       Can you add a comment pointing to `assertthat` and how this works?\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       What do you think about saying \"must be\" instead of \"is not\"?\r\n   \r\n   Also, previously you had said what the class of `x` was: is that feasible here? (Ok if not or not worth it, just observing that it was nice.)\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       Also, I don't think the eval(substitute(substitute())) is totally safe: \r\n   \r\n   ```\r\n   > assert_that(is_writable_table(c(\"a\", \"b\")))\r\n   Error in stop(assertError(attr(res, \"msg\"))) : bad error message\r\n   ```\r\n   \r\n   `deparse(call$x)` seems to work:\r\n   \r\n   ```\r\n   > attr(is_writable_table, \"fail\") <- function(call, env){\r\n     paste0(deparse(call$x),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\r\n   }\r\n   > assert_that(is_writable_table(c(\"a\", \"b\")))\r\n   Error: c(\"a\", \"b\") is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\r\n   > assert_that(is_writable_table(letters))\r\n   Error: letters is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T16:48:08.076+0000",
                    "updated": "2021-06-02T16:48:08.076+0000",
                    "started": "2021-06-02T16:48:08.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605351",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/605383",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r644177675\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       I think that \"must be\" sounds better than \"is not\" after reading the tidyverse style guide's approach to errors since updating this PR ;) Yeah, makes sense - is a little more informative, will update.\r\n   \r\n   I'll have a look into alternatives.  My problem was that when I try it with `deparse(call$x)` it works when called directly like you have above, but when I run the unit tests and it's being called from the `write_*` functions, the error message then reads `x must be an object of class 'data.frame', 'RecordBatch', or 'Table'.`.  I guess it's looking at the wrong level, but I wasn't sure how to get it to look at the right one.  Any ideas?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T17:29:49.524+0000",
                    "updated": "2021-06-02T17:29:49.524+0000",
                    "started": "2021-06-02T17:29:49.524+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605383",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/605506",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r644285045\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       I don't think that's bad because `x` is the name of the argument in these functions. If the argument were named something else, it would use that name:\r\n   \r\n   ```\r\n   > f <- function(zzz) {\r\n     assert_that(is_writable_table(zzz))\r\n   }\r\n   > f(letters)\r\n   Error: zzz is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\r\n   > f(c(\"a\", \"b\"))\r\n   Error: zzz is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\r\n   ```\r\n   \r\n   This is how `assertthat` does it too. See https://github.com/hadley/assertthat/blob/master/R/base-is.r for example.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T20:08:27.065+0000",
                    "updated": "2021-06-02T20:08:27.065+0000",
                    "started": "2021-06-02T20:08:27.064+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605506",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/605560",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r644333487\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       Ah, thanks, had got mixed up with something else you said, but makes sense now.\r\n   \r\n   Worked out a way of putting the object's class back into the error message so have pushed that change now, as well as the comment about what that attribute does.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-02T21:30:09.626+0000",
                    "updated": "2021-06-02T21:30:09.626+0000",
                    "started": "2021-06-02T21:30:09.626+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605560",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/606526",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387#discussion_r644333487\n\n\n\n##########\nFile path: r/R/util.R\n##########\n@@ -110,3 +110,11 @@ handle_embedded_nul_error <- function(e) {\n   }\n   stop(e)\n }\n+\n+is_writable_table <- function(x) {\n+  inherits(x, c(\"data.frame\", \"ArrowTabular\"))\n+}\n+\n+attr(is_writable_table, \"fail\") <- function(call, env){\n+  paste0(eval(substitute(substitute(y, env), list(y = call$x))),\" is not an object of class 'data.frame', 'RecordBatch', or 'Table'.\")\n\nReview comment:\n       Ah, thanks, had got mixed up with something else you said, but makes sense now.\r\n   \r\n   Worked out a way of putting the object's class back into the error message so have pushed that change now, as well as the comment about what that attribute does.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-04T07:53:43.747+0000",
                    "updated": "2021-06-04T07:53:43.747+0000",
                    "started": "2021-06-04T07:53:43.747+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "606526",
                    "issueId": "13378165"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/worklog/607165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #10387:\nURL: https://github.com/apache/arrow/pull/10387\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-04T15:53:20.769+0000",
                    "updated": "2021-06-04T15:53:20.769+0000",
                    "started": "2021-06-04T15:53:20.769+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "607165",
                    "issueId": "13378165"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4dd1c74d[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@643e53ea[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d87291b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@4b309042[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@294118c6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4cfacdcc[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@28d1fab9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@672cdd61[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@468a6e6a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@5c844fda[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7ba772c1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7ae16f01[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9000,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Jun 04 15:53:13 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-06-04T15:53:13.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12761/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-05-12T19:02:00.000+0000",
        "updated": "2021-06-04T15:53:21.000+0000",
        "timeoriginalestimate": null,
        "description": "When I run this:\r\n{code:java}\r\nmt_array <- Array$create(mtcars)\r\nwrite_to_raw(mt_array){code}\r\nI get this error:\r\n{code:java}\r\n Error: schema must be a \"Schema\" {code}\r\nWe should add a manual check of the type of the input that returns a more informative error message if the object is not a data.frame, RecordBatch or Table",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Better error handling for write_to_raw",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/comment/17343539",
                    "id": "17343539",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "The error is actually not in write_to_raw, I don't think. It's probably here: https://github.com/apache/arrow/blob/master/r/R/ipc_stream.R#L48\r\n\r\nI think you fix it by adding validation in L42 that x is ArrowTabular. You might want to check for this validation logic gap in the other write_* functions too.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-05-12T19:54:17.533+0000",
                    "updated": "2021-05-12T19:54:17.533+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13378165/comment/17357459",
                    "id": "17357459",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 10387\n[https://github.com/apache/arrow/pull/10387]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-06-04T15:53:13.431+0000",
                    "updated": "2021-06-04T15:53:13.431+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0qzfs:",
        "customfield_12314139": null
    }
}