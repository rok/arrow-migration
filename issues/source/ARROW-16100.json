{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13437329",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13437329",
    "key": "ARROW-16100",
    "fields": {
        "fixVersions": [],
        "resolution": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "name": "Open",
            "id": "1",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                "id": 2,
                "key": "new",
                "colorName": "blue-gray",
                "name": "To Do"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
            "name": "jonkeane",
            "key": "jonkeane",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Jonathan Keane",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
            "name": "jonkeane",
            "key": "jonkeane",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Jonathan Keane",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16100/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5de47be9[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@299fcda4[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@298744e1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7e224e98[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@79bee34b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3c0fd6f1[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2f3c2ddd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4386f02c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4dacf7ac[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@fd618b6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@414a9e54[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@35b901c1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Apr 07 23:07:19 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": null,
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16100/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2022-04-01T20:10:34.000+0000",
        "updated": "2022-04-07T23:07:19.000+0000",
        "timeoriginalestimate": null,
        "description": "When checking these against the known-good answers for scale factor 1, all of the queries are off (two are close enough that they get past arrowbench's pretty loose validation).\r\n\r\nLooking at the TPC-H tools, the validation for dbgen is:\r\n\r\nbq. b. Base Data Validation\r\nbq.   The base data set is produced using cmd_base_sf<n> where <n> is the scale \r\nbq.   factor to be generated. The resulting files will be produced in the current \r\nbq.   working directory.  The generated files will be of the form <name>.tbl.<nnn>,\r\nbq.   where <name> will is the name of one of the tables in the TPCH schema, and \r\nbq.   <nnn> identifies a particular data generation step.\r\nbq. \r\nbq.   The file set produced by genbaserefdata.sh should match the <name>.tbl.<nnn> \r\nbq.   files found in the reference data set for the same scale factor.\r\n\r\nAnd the data that this generator is producing does not conform to that. Even if I sort the data by columns that they appear to be in the dbgen (or duckdb) produced data, the data we get from our TPC-H generator does not match. \r\n\r\nWe might want a mode where we produce random TPC-H like data. But for benchmarking we need a way to produce actual TPC-H compliant data out of the box (we can deal with rows in a shuffled order if we need to, but the content of the data must be the same.\r\n\r\nMaybe taking a look at [DuckDB's implementation of the random seeds|https://github.com/duckdb/duckdb/blob/master/extension/tpch/dbgen/dbgen.cpp#L25-L74] might help with a way to accomplish this?\r\n\r\nHere's an example of generating data with duckdb (first ten lines of lineitems \u2014 and it's the same each time I generate it):\r\n\r\n{code}\r\n> print(out, width = 500)\r\n   l_orderkey l_partkey l_suppkey l_linenumber l_quantity l_extendedprice l_discount l_tax l_returnflag l_linestatus l_shipdate l_commitdate l_receiptdate    l_shipinstruct l_shipmode                           l_comment\r\n1           1    155190      7706            1         17        21168.23       0.04  0.02            N            O 1996-03-13   1996-02-12    1996-03-22 DELIVER IN PERSON      TRUCK             egular courts above the\r\n2           1     67310      7311            2         36        45983.16       0.09  0.06            N            O 1996-04-12   1996-02-28    1996-04-20  TAKE BACK RETURN       MAIL  ly final dependencies: slyly bold \r\n3           1     63700      3701            3          8        13309.60       0.10  0.02            N            O 1996-01-29   1996-03-05    1996-01-31  TAKE BACK RETURN    REG AIR       riously. regular, express dep\r\n4           1      2132      4633            4         28        28955.64       0.09  0.06            N            O 1996-04-21   1996-03-30    1996-05-16              NONE        AIR             lites. fluffily even de\r\n5           1     24027      1534            5         24        22824.48       0.10  0.04            N            O 1996-03-30   1996-03-14    1996-04-01              NONE        FOB             pending foxes. slyly re\r\n6           1     15635       638            6         32        49620.16       0.07  0.02            N            O 1996-01-30   1996-02-07    1996-02-03 DELIVER IN PERSON       MAIL                   arefully slyly ex\r\n7           2    106170      1191            1         38        44694.46       0.00  0.05            N            O 1997-01-28   1997-01-14    1997-02-02  TAKE BACK RETURN       RAIL     ven requests. deposits breach a\r\n8           3      4297      1798            1         45        54058.05       0.06  0.00            R            F 1994-02-02   1994-01-04    1994-02-23              NONE        AIR ongside of the furiously brave acco\r\n9           3     19036      6540            2         49        46796.47       0.10  0.00            R            F 1993-11-09   1993-12-20    1993-11-24  TAKE BACK RETURN       RAIL               unusual accounts. eve\r\n10          3    128449      3474            3         27        39890.88       0.06  0.07            A            F 1994-01-16   1993-11-22    1994-01-23 DELIVER IN PERSON       SHIP                    nal foxes wake. \r\n{code}\r\n\r\nAnd the first ten lines of lineitems I generated with the official dbgen:\r\n\r\n{code}\r\nhead lineitem.tbl\r\n1|155190|7706|1|17|21168.23|0.04|0.02|N|O|1996-03-13|1996-02-12|1996-03-22|DELIVER IN PERSON|TRUCK|egular courts above the|\r\n1|67310|7311|2|36|45983.16|0.09|0.06|N|O|1996-04-12|1996-02-28|1996-04-20|TAKE BACK RETURN|MAIL|ly final dependencies: slyly bold |\r\n1|63700|3701|3|8|13309.60|0.10|0.02|N|O|1996-01-29|1996-03-05|1996-01-31|TAKE BACK RETURN|REG AIR|riously. regular, express dep|\r\n1|2132|4633|4|28|28955.64|0.09|0.06|N|O|1996-04-21|1996-03-30|1996-05-16|NONE|AIR|lites. fluffily even de|\r\n1|24027|1534|5|24|22824.48|0.10|0.04|N|O|1996-03-30|1996-03-14|1996-04-01|NONE|FOB| pending foxes. slyly re|\r\n1|15635|638|6|32|49620.16|0.07|0.02|N|O|1996-01-30|1996-02-07|1996-02-03|DELIVER IN PERSON|MAIL|arefully slyly ex|\r\n2|106170|1191|1|38|44694.46|0.00|0.05|N|O|1997-01-28|1997-01-14|1997-02-02|TAKE BACK RETURN|RAIL|ven requests. deposits breach a|\r\n3|4297|1798|1|45|54058.05|0.06|0.00|R|F|1994-02-02|1994-01-04|1994-02-23|NONE|AIR|ongside of the furiously brave acco|\r\n3|19036|6540|2|49|46796.47|0.10|0.00|R|F|1993-11-09|1993-12-20|1993-11-24|TAKE BACK RETURN|RAIL| unusual accounts. eve|\r\n3|128449|3474|3|27|39890.88|0.06|0.07|A|F|1994-01-16|1993-11-22|1994-01-23|DELIVER IN PERSON|SHIP|nal foxes wake. |\r\n{code}\r\n\r\nAnd the first ten lines of the validation file form the TPC-H tools:\r\n\r\n{code}\r\nhead lineitem.tbl.1\r\n1|155190|7706|1|17|21168.23|0.04|0.02|N|O|1996-03-13|1996-02-12|1996-03-22|DELIVER IN PERSON|TRUCK|egular courts above the|\r\n1|67310|7311|2|36|45983.16|0.09|0.06|N|O|1996-04-12|1996-02-28|1996-04-20|TAKE BACK RETURN|MAIL|ly final dependencies: slyly bold |\r\n1|63700|3701|3|8|13309.60|0.10|0.02|N|O|1996-01-29|1996-03-05|1996-01-31|TAKE BACK RETURN|REG AIR|riously. regular, express dep|\r\n1|2132|4633|4|28|28955.64|0.09|0.06|N|O|1996-04-21|1996-03-30|1996-05-16|NONE|AIR|lites. fluffily even de|\r\n1|24027|1534|5|24|22824.48|0.10|0.04|N|O|1996-03-30|1996-03-14|1996-04-01|NONE|FOB| pending foxes. slyly re|\r\n1|15635|638|6|32|49620.16|0.07|0.02|N|O|1996-01-30|1996-02-07|1996-02-03|DELIVER IN PERSON|MAIL|arefully slyly ex|\r\n2|106170|1191|1|38|44694.46|0.00|0.05|N|O|1997-01-28|1997-01-14|1997-02-02|TAKE BACK RETURN|RAIL|ven requests. deposits breach a|\r\n3|4297|1798|1|45|54058.05|0.06|0.00|R|F|1994-02-02|1994-01-04|1994-02-23|NONE|AIR|ongside of the furiously brave acco|\r\n3|19036|6540|2|49|46796.47|0.10|0.00|R|F|1993-11-09|1993-12-20|1993-11-24|TAKE BACK RETURN|RAIL| unusual accounts. eve|\r\n3|128449|3474|3|27|39890.88|0.06|0.07|A|F|1994-01-16|1993-11-22|1994-01-23|DELIVER IN PERSON|SHIP|nal foxes wake. |\r\n{code}\r\n\r\nNote, you can generate this tpc-h data from https://github.com/apache/arrow/pull/12769 with the following. This shuffling is needed because we can only write datasets from execnodes (without materializing into memory entirely), so we move the files around as if they were single file writes:\r\n\r\n{code}\r\npath <- tpch_dbgen_write(1, \"some/path\")\r\n\r\nfrom_dataset_to_parquet <- function(path, scale_factor) {\r\n  ds_files <- list.files(path, recursive = TRUE, full.names = TRUE)\r\n  # we can only deal with single parquet files in each partition this way\r\n  if (!all(grepl(\"data-0.parquet$\", ds_files))) {\r\n    stop(\"At least one partition has more than one file\")\r\n  }\r\n  \r\n  ds_files_to <- gsub(\r\n    \"/data-0.parquet\", \r\n    paste0(\"_\", format(scale_factor, scientific = FALSE), \".parquet\"), \r\n    ds_files\r\n  )\r\n  file.rename(ds_files, ds_files_to)\r\n  \r\n  # cleanup empty folders, this might be a bit aggressive\r\n  folders_to_remove <- gsub(\"/data-0.parquet\", \"\", ds_files)\r\n  unlink(folders_to_remove, recursive = TRUE)\r\n}\r\n\r\nfrom_dataset_to_parquet(path, 1)\r\n{code}\r\n",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Add ability to generate TPC-H data that matches the reference data exactly",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13437329/comment/17519162",
                    "id": "17519162",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I believe at this point we have tackled the segmentation faults as part of the R bindings PR.  Given that we are probably not going to proceed with exposing this feature via R until the randomness issue is resolved we will want to port those fixes into their own PR.  I'll create a new issue for this.  We can retitle this issue to focus on the randomness issue (since we have a lot of good content in the description).\r\n\r\nRegarding the randomness issue, [~jonkeane][~sakras] and I had a brief chat.  This shouldn't interfere with our ability to do internal profiling but we likely prevents using the generated data for benchmarking (where we want to make sure we are more consistent and deterministic).  We currently generate data and random numbers in a column-major fashion.  The official generators generate data and random numbers in a row-major fashion.  In addition, we generate data across multiple threads which could cause issues as well.\r\n\r\nWe could write a separate row-major generator (hopefully sharing some utilities) or we could try and use the generator as is and instead generate a table of random numbers for each batch and then transpose it and use the transposed random numbers.  Or we could generate a large batch of random numbers and \"seek\" around the batch.  There may be other complications as well to ensure compatibility between the two generators.  This will probably be a significant chunk of work.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-04-07T20:51:51.250+0000",
                    "updated": "2022-04-07T20:51:51.250+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13437329/comment/17519229",
                    "id": "17519229",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Agreed. Either of those approaches sound like they might be fruitful! It's a bit hidden above, but https://github.com/duckdb/duckdb/blob/master/extension/tpch/dbgen/dbgen.cpp#L25-L74 might also be helpful and https://github.com/duckdb/duckdb/blob/31db2bada7548a700d26f61665828dd127abd2a8/extension/tpch/dbgen/dbgen.cpp#L533-L540 is where it looks like it's set|unset.\r\n\r\nAlso note that the answers for queries that include anything besides aggregations of numerics will have randomness with random data (so we can't quite count on the answers being close enough in the limit with enough samples)\r\n\r\n{code}\r\n> library(arrowbench)\r\n> library(dplyr, warn.conflicts=FALSE)\r\n> options(arrow.skip_nul = TRUE)\r\n> \r\n> query_id <- 2\r\n> \r\n> input_funcs <- get_input_func(\r\n+   engine = \"arrow\",\r\n+   scale_factor = 1,\r\n+   query_id = query_id,\r\n+   format = \"parquet\"\r\n+ )\r\n> \r\n> result <- get_query_func(query_id, \"arrow\")(input_funcs)\r\n> \r\n> ans <- tpch_answer(1, query_id = query_id)\r\n> \r\n> waldo::compare(result, ans)\r\nold vs new\r\n             s_acctbal             s_name         n_name p_partkey         p_mfgr                                s_address         s_phone                                                                                            s_comment\r\n- old[1, ]     9973.06 Supplie#r000009288 UNITED KINGDOM     79287 Manufacturer#4 RiRNXmGRQdw1lbm5hcjV94                   33-645-115-8290 tions snooze permanently final sentiments --daring, close pinto beans should have to eat            \r\n+ new[1, ]     9938.53 Supplier#000005359 UNITED KINGDOM    185358 Manufacturer#4 bgxj2K0w1kJvxYl5mhCfou,W                 33-429-790-6131 uriously regular requests hag                                                                       \r\n- old[2, ]     9955.58 Supplie#r000008234 GERMANY            88233 Manufacturer#5 yg83WC5I YIhQPeTMQmXa                    17-560-538-8734 s promise; silent pinto beans may use? furious theodolites wake ruthlessly duri                     \r\n+ new[2, ]     9937.84 Supplier#000005969 ROMANIA           108438 Manufacturer#1 rdnmd9c8EG1EIAYY3LPVa4yUNx6OwyVaQ        29-520-692-3537 efully express instructions. regular requests against the slyly fin                                 \r\n- old[3, ]     9946.47 Supplie#r000001975 RUSSIA            161974 Manufacturer#1 wdsf5tQIrJKBNmu8I  eY pmAv akzRDSydc     32-937-928-5861 the sometimes permanent frets must haggle som                                                       \r\n+ new[3, ]     9936.22 Supplier#000005250 UNITED KINGDOM       249 Manufacturer#4 qX AB0vP8mJEWeBuY9jri                    33-320-228-2957 etect about the furiously final accounts. slyly ironic pinto beans sleep inside the furiously       \r\n- old[4, ]     9938.94 Supplie#r000006635 FRANCE             41626 Manufacturer#5 kIxC63UH H0et,bSwBA6O81PJ                16-750-637-3467 e through the idly daring warhorses --permanent patterns serve; escapades over th                   \r\n+ new[4, ]     9923.77 Supplier#000002324 GERMANY            29821 Manufacturer#4 uXcnR7tv87dG                             17-779-299-1839 ackages boost blithely. blithely regular deposits c                                                 \r\n- old[5, ]     9916.93 Supplie#r000004383 ROMANIA            84382 Manufacturer#5 tkEkQY F4J4JDu2WRYDk,owFCP7Qh1eOgHWSk9   29-283-925-2487 telets could poach busy waters! bl                                                                  \r\n+ new[5, ]     9871.22 Supplier#000006373 GERMANY            43868 Manufacturer#5 iSLO35z7Ae                               17-813-485-8637 etect blithely bold asymptotes. fluffily ironic platelets wake furiously; blit                      \r\n- old[6, ]     9884.91 Supplie#r000009799 RUSSIA             24794 Manufacturer#5 YvXpPGXYAg2TJLZJDW3LtRqbv97RzF6As        32-406-413-9944  the always furious pains                                                                           \r\n+ new[6, ]     9870.78 Supplier#000001286 GERMANY            81285 Manufacturer#2 3gq0mZLHI5OTM6 tBYmLTHZaulCYnlECzQ7nj    17-516-924-4574  regular accounts. furiously unusual courts above the fi                                            \r\n- old[7, ]     9884.91 Supplie#r000009799 RUSSIA             34792 Manufacturer#2 YvXpPGXYAg2TJLZJDW3LtRqbv97RzF6As        32-406-413-9944  the always furious pains                                                                           \r\n+ new[7, ]     9870.78 Supplier#000001286 GERMANY           181285 Manufacturer#4 3gq0mZLHI5OTM6 tBYmLTHZaulCYnlECzQ7nj    17-516-924-4574  regular accounts. furiously unusual courts above the fi                                            \r\n- old[8, ]     9836.42 Supplie#r000001571 UNITED KINGDOM     39067 Manufacturer#3 8lAIPuLFKWVfDQO LXavjzxLkVNF0sw8a6       33-788-833-6417  dogged orbits beyond the escapades shall                                                           \r\n+ new[8, ]     9852.52 Supplier#000008973 RUSSIA             18972 Manufacturer#2 zVfUT3Np22kUC05tYWHBotaR                 32-188-594-7038 rns wake final foxes. carefully unusual depende                                                     \r\n- old[9, ]     9836.42 Supplie#r000001571 UNITED KINGDOM    134031 Manufacturer#2 8lAIPuLFKWVfDQO LXavjzxLkVNF0sw8a6       33-788-833-6417  dogged orbits beyond the escapades shall                                                           \r\n+ new[9, ]     9847.83 Supplier#000008097 RUSSIA            130557 Manufacturer#2 veMRTQBmUResNvfD3                        32-375-640-3593  the special excuses. silent sentiments serve carefully final ac                                    \r\n- old[10, ]    9781.88 Supplie#r000005361 ROMANIA             2860 Manufacturer#4 lZYHncM3vjsXc3PPqaFlTO                   29-345-620-9471 players --daring, careful forges past the enticing, thin sentiments try to kindle stealthily fr     \r\n+ new[10, ]    9847.57 Supplier#000006345 FRANCE             86344 Manufacturer#1 68yX tGXAkVRSxUGNSjJdptw 8O878xaFnaoQK   16-886-766-7945 ges. slyly regular requests are. ruthless, express excuses cajole blithely across the unu           \r\nand 90 more ...\r\n\r\n     old$s_acctbal | new$s_acctbal                \r\n [1] 9973.1        - 9938.5        [1]            \r\n [2] 9955.6        - 9937.8        [2]            \r\n [3] 9946.5        - 9936.2        [3]            \r\n [4] 9938.9        - 9923.8        [4]            \r\n [5] 9916.9        - 9871.2        [5]            \r\n [6] 9884.9        - 9870.8        [6]            \r\n [7] 9884.9        - 9870.8        [7]            \r\n [8] 9836.4        - 9852.5        [8]            \r\n [9] 9836.4        - 9847.8        [9]            \r\n[10] 9781.9        - 9847.6        [10]           \r\n ... ...             ...           and 90 more ...\r\n\r\n     old$s_name           | new$s_name                          \r\n [1] \"Supplie#r000009288\" - \"Supplier#000005359\" [1]            \r\n [2] \"Supplie#r000008234\" - \"Supplier#000005969\" [2]            \r\n [3] \"Supplie#r000001975\" - \"Supplier#000005250\" [3]            \r\n [4] \"Supplie#r000006635\" - \"Supplier#000002324\" [4]            \r\n [5] \"Supplie#r000004383\" - \"Supplier#000006373\" [5]            \r\n [6] \"Supplie#r000009799\" - \"Supplier#000001286\" [6]            \r\n [7] \"Supplie#r000009799\" - \"Supplier#000001286\" [7]            \r\n [8] \"Supplie#r000001571\" - \"Supplier#000008973\" [8]            \r\n [9] \"Supplie#r000001571\" - \"Supplier#000008097\" [9]            \r\n[10] \"Supplie#r000005361\" - \"Supplier#000006345\" [10]           \r\n ... ...                    ...                  and 90 more ...\r\n\r\n     old$n_name       | new$n_name                      \r\n [1] \"UNITED KINGDOM\" | \"UNITED KINGDOM\" [1]            \r\n [2] \"GERMANY\"        - \"ROMANIA\"        [2]            \r\n [3] \"RUSSIA\"         - \"UNITED KINGDOM\" [3]            \r\n [4] \"FRANCE\"         - \"GERMANY\"        [4]            \r\n [5] \"ROMANIA\"        - \"GERMANY\"        [5]            \r\n [6] \"RUSSIA\"         - \"GERMANY\"        [6]            \r\n [7] \"RUSSIA\"         - \"GERMANY\"        [7]            \r\n [8] \"UNITED KINGDOM\" - \"RUSSIA\"         [8]            \r\n [9] \"UNITED KINGDOM\" - \"RUSSIA\"         [9]            \r\n[10] \"ROMANIA\"        - \"FRANCE\"         [10]           \r\n ... ...                ...              and 90 more ...\r\n\r\n     old$p_partkey | new$p_partkey                \r\n [1] 79287         - 185358        [1]            \r\n [2] 88233         - 108438        [2]            \r\n [3] 161974        - 249           [3]            \r\n [4] 41626         - 29821         [4]            \r\n [5] 84382         - 43868         [5]            \r\n [6] 24794         - 81285         [6]            \r\n [7] 34792         - 181285        [7]            \r\n [8] 39067         - 18972         [8]            \r\n [9] 134031        - 130557        [9]            \r\n[10] 2860          - 86344         [10]           \r\n ... ...             ...           and 90 more ...\r\n\r\n     old$p_mfgr       | new$p_mfgr                      \r\n [1] \"Manufacturer#4\" | \"Manufacturer#4\" [1]            \r\n [2] \"Manufacturer#5\" - \"Manufacturer#1\" [2]            \r\n [3] \"Manufacturer#1\" - \"Manufacturer#4\" [3]            \r\n [4] \"Manufacturer#5\" - \"Manufacturer#4\" [4]            \r\n [5] \"Manufacturer#5\" | \"Manufacturer#5\" [5]            \r\n [6] \"Manufacturer#5\" - \"Manufacturer#2\" [6]            \r\n [7] \"Manufacturer#2\" - \"Manufacturer#4\" [7]            \r\n [8] \"Manufacturer#3\" - \"Manufacturer#2\" [8]            \r\n [9] \"Manufacturer#2\" | \"Manufacturer#2\" [9]            \r\n[10] \"Manufacturer#4\" - \"Manufacturer#1\" [10]           \r\n ... ...                ...              and 90 more ...\r\n\r\nold$s_address vs new$s_address\r\n- \"RiRNXmGRQdw1lbm5hcjV94\"\r\n+ \"bgxj2K0w1kJvxYl5mhCfou,W\"\r\n- \"yg83WC5I YIhQPeTMQmXa\"\r\n+ \"rdnmd9c8EG1EIAYY3LPVa4yUNx6OwyVaQ\"\r\n- \"wdsf5tQIrJKBNmu8I  eY pmAv akzRDSydc\"\r\n+ \"qX AB0vP8mJEWeBuY9jri\"\r\n- \"kIxC63UH H0et,bSwBA6O81PJ\"\r\n+ \"uXcnR7tv87dG\"\r\n- \"tkEkQY F4J4JDu2WRYDk,owFCP7Qh1eOgHWSk9\"\r\n+ \"iSLO35z7Ae\"\r\n- \"YvXpPGXYAg2TJLZJDW3LtRqbv97RzF6As\"\r\n+ \"3gq0mZLHI5OTM6 tBYmLTHZaulCYnlECzQ7nj\"\r\n- \"YvXpPGXYAg2TJLZJDW3LtRqbv97RzF6As\"\r\n+ \"3gq0mZLHI5OTM6 tBYmLTHZaulCYnlECzQ7nj\"\r\n- \"8lAIPuLFKWVfDQO LXavjzxLkVNF0sw8a6 \"\r\n+ \"zVfUT3Np22kUC05tYWHBotaR\"\r\n- \"8lAIPuLFKWVfDQO LXavjzxLkVNF0sw8a6 \"\r\n+ \"veMRTQBmUResNvfD3\"\r\n- \"lZYHncM3vjsXc3PPqaFlTO\"\r\n+ \"68yX tGXAkVRSxUGNSjJdptw 8O878xaFnaoQK\"\r\nand 90 more ...\r\n\r\n     old$s_phone       | new$s_phone                      \r\n [1] \"33-645-115-8290\" - \"33-429-790-6131\" [1]            \r\n [2] \"17-560-538-8734\" - \"29-520-692-3537\" [2]            \r\n [3] \"32-937-928-5861\" - \"33-320-228-2957\" [3]            \r\n [4] \"16-750-637-3467\" - \"17-779-299-1839\" [4]            \r\n [5] \"29-283-925-2487\" - \"17-813-485-8637\" [5]            \r\n [6] \"32-406-413-9944\" - \"17-516-924-4574\" [6]            \r\n [7] \"32-406-413-9944\" - \"17-516-924-4574\" [7]            \r\n [8] \"33-788-833-6417\" - \"32-188-594-7038\" [8]            \r\n [9] \"33-788-833-6417\" - \"32-375-640-3593\" [9]            \r\n[10] \"29-345-620-9471\" - \"16-886-766-7945\" [10]           \r\n ... ...                 ...               and 90 more ...\r\n\r\nold$s_comment vs new$s_comment\r\n- \"tions snooze permanently final sentiments --daring, close pinto beans should have to eat\"\r\n+ \"uriously regular requests hag\"\r\n- \"s promise; silent pinto beans may use? furious theodolites wake ruthlessly duri\"\r\n+ \"efully express instructions. regular requests against the slyly fin\"\r\n- \"the sometimes permanent frets must haggle som\"\r\n+ \"etect about the furiously final accounts. slyly ironic pinto beans sleep inside the furiously\"\r\n- \"e through the idly daring warhorses --permanent patterns serve; escapades over th\"\r\n+ \"ackages boost blithely. blithely regular deposits c\"\r\n- \"telets could poach busy waters! bl\"\r\n+ \"etect blithely bold asymptotes. fluffily ironic platelets wake furiously; blit\"\r\n- \" the always furious pains \"\r\n+ \" regular accounts. furiously unusual courts above the fi\"\r\n- \" the always furious pains \"\r\n+ \" regular accounts. furiously unusual courts above the fi\"\r\n- \" dogged orbits beyond the escapades shall \"\r\n+ \"rns wake final foxes. carefully unusual depende\"\r\n- \" dogged orbits beyond the escapades shall \"\r\n+ \" the special excuses. silent sentiments serve carefully final ac\"\r\n- \"players --daring, careful forges past the enticing, thin sentiments try to kindle stealthily fr\"\r\n+ \"ges. slyly regular requests are. ruthless, express excuses cajole blithely across the unu\"\r\nand 90 more ...\r\n{code} ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-04-07T23:07:19.025+0000",
                    "updated": "2022-04-07T23:07:19.025+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z112q8:",
        "customfield_12314139": null
    }
}