{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13359160",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160",
    "key": "ARROW-11680",
    "fields": {
        "parent": {
            "id": "13358002",
            "key": "ARROW-11588",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13358002",
            "fields": {
                "summary": "[C++] Add traceable general purpose queue(s)",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                    "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                    "name": "Closed",
                    "id": "6",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/3",
                    "id": "3",
                    "description": "A task that needs to be done.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype",
                    "name": "Task",
                    "subtask": false,
                    "avatarId": 21148
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
            "name": "westonpace",
            "key": "westonpace",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Weston Pace",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13800,
            "total": 13800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11680/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/553990",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace opened a new pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519\n\n\n   See issue for rationale / description.\r\n   \r\n   To consider:\r\n    * I based licensing text on other vendored libraries but I'm no expert in how exactly to dot all the i's and cross all the t's.\r\n    * The constructor can throw if allocation of the ring buffer fails.  In general, this sort of queue shouldn't be all that large anyways so this seems unlikely.  We could modify the constructor to be private with a factory method that returns `Result` but at the moment I'm not making any changes to the existing code and so I'm hesitant to start doing so for this reason.\r\n    * There is a test case for the above point but I could take it out if desired.\r\n    * There is a comparative benchmark for boost.  I'm not sure if we want to leave that in?\r\n    * I've renamed folly::ProducerConsumerQueue to arrow::util::SpscQueue.  I feel the name ProducerConsumerQueue is too vague and could lead to improper usage.  This queue is not safe for multiple readers or multiple writers.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T00:33:26.327+0000",
                    "updated": "2021-02-18T00:33:26.327+0000",
                    "started": "2021-02-18T00:33:26.327+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553990",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/553991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-780947189\n\n\n   https://issues.apache.org/jira/browse/ARROW-11680\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T00:33:50.486+0000",
                    "updated": "2021-02-18T00:33:50.486+0000",
                    "started": "2021-02-18T00:33:50.486+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553991",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/553995",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "budgetdevv commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-780949942\n\n\n   Ooo\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T00:40:56.908+0000",
                    "updated": "2021-02-18T00:40:56.908+0000",
                    "started": "2021-02-18T00:40:56.908+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553995",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/553997",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-780950896\n\n\n   What did the benchmark results look like for you compared to boost::lockfree?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T00:43:38.882+0000",
                    "updated": "2021-02-18T00:43:38.882+0000",
                    "started": "2021-02-18T00:43:38.882+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553997",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/553998",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-780951570\n\n\n   @lidavidm On my system I got...\r\n   ```\r\n   -------------------------------------------------------------------------------------\r\n   Benchmark                           Time             CPU   Iterations UserCounters...\r\n   -------------------------------------------------------------------------------------\r\n   throughput/real_time          6056466 ns        72028 ns          108 items_per_second=16.5113M/s\r\n   throughput_boost/real_time   16383556 ns        98380 ns           42 items_per_second=6.10368M/s\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T00:45:49.410+0000",
                    "updated": "2021-02-18T00:45:49.410+0000",
                    "started": "2021-02-18T00:45:49.410+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "553998",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554158",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578278810\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n\nReview comment:\n       This looks a bit weird... `hardware_destructive_interference_size` is supposed to be the L1 cache size. But x86 CPUs usually have 64-byte cachelines, while other systems may have 128-byte cachelines. Is the condition reversed?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T09:55:03.099+0000",
                    "updated": "2021-02-18T09:55:03.099+0000",
                    "started": "2021-02-18T09:55:03.098+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554158",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554159",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578279748\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n\nReview comment:\n       I'm not sure how we want to go about this, but often we try to enclose vendored code in an additional `arrow_vendored` namespace (because when Arrow C++ is used as a library, there may be otherwise be symbol clashes with other uses of Folly by the application - which is very bad if they use a different version of Folly).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T09:56:17.522+0000",
                    "updated": "2021-02-18T09:56:17.522+0000",
                    "started": "2021-02-18T09:56:17.522+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554159",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554162",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578283673\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n\nReview comment:\n       Ah, I see there's an extensive explanation upstream. Nevermind.\r\n   https://github.com/facebook/folly/blob/master/folly/lang/Align.h#L108\r\n   \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T10:01:40.096+0000",
                    "updated": "2021-02-18T10:01:40.096+0000",
                    "started": "2021-02-18T10:01:40.096+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554162",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554163",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578284829\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n+\n+}  // namespace\n+\n+/*\n+ * ProducerConsumerQueue is a one producer and one consumer queue\n+ * without locks.\n+ */\n+template <class T>\n+struct ProducerConsumerQueue {\n+  typedef T value_type;\n+\n+  ProducerConsumerQueue(const ProducerConsumerQueue&) = delete;\n+  ProducerConsumerQueue& operator=(const ProducerConsumerQueue&) = delete;\n+\n+  // size must be >= 2.\n+  //\n+  // Also, note that the number of usable slots in the queue at any\n+  // given time is actually (size-1), so if you start with an empty queue,\n+  // isFull() will return true after size-1 insertions.\n+  explicit ProducerConsumerQueue(uint32_t size)\n+      : size_(size),\n+        records_(static_cast<T*>(std::malloc(sizeof(T) * size))),\n+        readIndex_(0),\n+        writeIndex_(0) {\n+    assert(size >= 2);\n+    if (!records_) {\n+      throw std::bad_alloc();\n+    }\n+  }\n+\n+  ~ProducerConsumerQueue() {\n+    // We need to destruct anything that may still exist in our queue.\n+    // (No real synchronization needed at destructor time: only one\n+    // thread can be doing this.)\n+    if (!std::is_trivially_destructible<T>::value) {\n+      size_t readIndex = readIndex_;\n+      size_t endIndex = writeIndex_;\n+      while (readIndex != endIndex) {\n+        records_[readIndex].~T();\n+        if (++readIndex == size_) {\n+          readIndex = 0;\n+        }\n+      }\n+    }\n+\n+    std::free(records_);\n+  }\n+\n+  template <class... Args>\n+  bool write(Args&&... recordArgs) {\n+    auto const currentWrite = writeIndex_.load(std::memory_order_relaxed);\n+    auto nextRecord = currentWrite + 1;\n+    if (nextRecord == size_) {\n+      nextRecord = 0;\n+    }\n+    if (nextRecord != readIndex_.load(std::memory_order_acquire)) {\n+      new (&records_[currentWrite]) T(std::forward<Args>(recordArgs)...);\n+      writeIndex_.store(nextRecord, std::memory_order_release);\n+      return true;\n+    }\n+\n+    // queue is full\n+    return false;\n\nReview comment:\n       Well... what does this mean for our uses? Is there a way to wait (without spinning) for the queue to be non-full?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T10:03:19.241+0000",
                    "updated": "2021-02-18T10:03:19.241+0000",
                    "started": "2021-02-18T10:03:19.241+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554163",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554164",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-781230370\n\n\n   Can you push a dummy changeset that adds a use of this queue inside the core library? Some CI builds don't enable tests or benchmarks, and wouldn't validate that this is indeed usable.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T10:04:39.477+0000",
                    "updated": "2021-02-18T10:04:39.477+0000",
                    "started": "2021-02-18T10:04:39.477+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554164",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554381",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578643277\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n+\n+}  // namespace\n+\n+/*\n+ * ProducerConsumerQueue is a one producer and one consumer queue\n+ * without locks.\n+ */\n+template <class T>\n+struct ProducerConsumerQueue {\n+  typedef T value_type;\n+\n+  ProducerConsumerQueue(const ProducerConsumerQueue&) = delete;\n+  ProducerConsumerQueue& operator=(const ProducerConsumerQueue&) = delete;\n+\n+  // size must be >= 2.\n+  //\n+  // Also, note that the number of usable slots in the queue at any\n+  // given time is actually (size-1), so if you start with an empty queue,\n+  // isFull() will return true after size-1 insertions.\n+  explicit ProducerConsumerQueue(uint32_t size)\n+      : size_(size),\n+        records_(static_cast<T*>(std::malloc(sizeof(T) * size))),\n+        readIndex_(0),\n+        writeIndex_(0) {\n+    assert(size >= 2);\n+    if (!records_) {\n+      throw std::bad_alloc();\n+    }\n+  }\n+\n+  ~ProducerConsumerQueue() {\n+    // We need to destruct anything that may still exist in our queue.\n+    // (No real synchronization needed at destructor time: only one\n+    // thread can be doing this.)\n+    if (!std::is_trivially_destructible<T>::value) {\n+      size_t readIndex = readIndex_;\n+      size_t endIndex = writeIndex_;\n+      while (readIndex != endIndex) {\n+        records_[readIndex].~T();\n+        if (++readIndex == size_) {\n+          readIndex = 0;\n+        }\n+      }\n+    }\n+\n+    std::free(records_);\n+  }\n+\n+  template <class... Args>\n+  bool write(Args&&... recordArgs) {\n+    auto const currentWrite = writeIndex_.load(std::memory_order_relaxed);\n+    auto nextRecord = currentWrite + 1;\n+    if (nextRecord == size_) {\n+      nextRecord = 0;\n+    }\n+    if (nextRecord != readIndex_.load(std::memory_order_acquire)) {\n+      new (&records_[currentWrite]) T(std::forward<Args>(recordArgs)...);\n+      writeIndex_.store(nextRecord, std::memory_order_release);\n+      return true;\n+    }\n+\n+    // queue is full\n+    return false;\n\nReview comment:\n       No, there is not.  One could write a wait layer on top of it, introducing mutexes, etc. but then it is no longer a lockfree queue.  In the places I've seen such queues used starvation should be a very rare occurrence or guaranteed not to happen.  For my immediate purposes I know the queue will never be exhausted because of other protections.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T18:15:11.582+0000",
                    "updated": "2021-02-18T18:15:11.582+0000",
                    "started": "2021-02-18T18:15:11.582+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554381",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554382",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-781540297\n\n\n   @pitrou Yes, I will.  I need it for ARROW-11590 so I can work on that.  There also isn't much point in merging this change until there is something that uses the queue too.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T18:16:47.712+0000",
                    "updated": "2021-02-18T18:16:47.712+0000",
                    "started": "2021-02-18T18:16:47.712+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554382",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554411",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578676996\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n+\n+}  // namespace\n+\n+/*\n+ * ProducerConsumerQueue is a one producer and one consumer queue\n+ * without locks.\n+ */\n+template <class T>\n+struct ProducerConsumerQueue {\n+  typedef T value_type;\n+\n+  ProducerConsumerQueue(const ProducerConsumerQueue&) = delete;\n+  ProducerConsumerQueue& operator=(const ProducerConsumerQueue&) = delete;\n+\n+  // size must be >= 2.\n+  //\n+  // Also, note that the number of usable slots in the queue at any\n+  // given time is actually (size-1), so if you start with an empty queue,\n+  // isFull() will return true after size-1 insertions.\n+  explicit ProducerConsumerQueue(uint32_t size)\n+      : size_(size),\n+        records_(static_cast<T*>(std::malloc(sizeof(T) * size))),\n+        readIndex_(0),\n+        writeIndex_(0) {\n+    assert(size >= 2);\n+    if (!records_) {\n+      throw std::bad_alloc();\n+    }\n+  }\n+\n+  ~ProducerConsumerQueue() {\n+    // We need to destruct anything that may still exist in our queue.\n+    // (No real synchronization needed at destructor time: only one\n+    // thread can be doing this.)\n+    if (!std::is_trivially_destructible<T>::value) {\n+      size_t readIndex = readIndex_;\n+      size_t endIndex = writeIndex_;\n+      while (readIndex != endIndex) {\n+        records_[readIndex].~T();\n+        if (++readIndex == size_) {\n+          readIndex = 0;\n+        }\n+      }\n+    }\n+\n+    std::free(records_);\n+  }\n+\n+  template <class... Args>\n+  bool write(Args&&... recordArgs) {\n+    auto const currentWrite = writeIndex_.load(std::memory_order_relaxed);\n+    auto nextRecord = currentWrite + 1;\n+    if (nextRecord == size_) {\n+      nextRecord = 0;\n+    }\n+    if (nextRecord != readIndex_.load(std::memory_order_acquire)) {\n+      new (&records_[currentWrite]) T(std::forward<Args>(recordArgs)...);\n+      writeIndex_.store(nextRecord, std::memory_order_release);\n+      return true;\n+    }\n+\n+    // queue is full\n+    return false;\n\nReview comment:\n       So this is not for our thread pool, for example?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T19:07:20.514+0000",
                    "updated": "2021-02-18T19:07:20.514+0000",
                    "started": "2021-02-18T19:07:20.513+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554411",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/554459",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r578742222\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n+\n+// Vendored from folly/Portability.h\n+namespace {\n+#if defined(__arm__)\n+#define FOLLY_ARM 1\n+#else\n+#define FOLLY_ARM 0\n+#endif\n+\n+#if defined(__s390x__)\n+#define FOLLY_S390X 1\n+#else\n+#define FOLLY_S390X 0\n+#endif\n+\n+constexpr bool kIsArchArm = FOLLY_ARM == 1;\n+constexpr bool kIsArchS390X = FOLLY_S390X == 1;\n+}  // namespace\n+\n+// Vendored from folly/lang/Align.h\n+namespace {\n+\n+constexpr std::size_t hardware_destructive_interference_size =\n+    (kIsArchArm || kIsArchS390X) ? 64 : 128;\n+\n+}  // namespace\n+\n+/*\n+ * ProducerConsumerQueue is a one producer and one consumer queue\n+ * without locks.\n+ */\n+template <class T>\n+struct ProducerConsumerQueue {\n+  typedef T value_type;\n+\n+  ProducerConsumerQueue(const ProducerConsumerQueue&) = delete;\n+  ProducerConsumerQueue& operator=(const ProducerConsumerQueue&) = delete;\n+\n+  // size must be >= 2.\n+  //\n+  // Also, note that the number of usable slots in the queue at any\n+  // given time is actually (size-1), so if you start with an empty queue,\n+  // isFull() will return true after size-1 insertions.\n+  explicit ProducerConsumerQueue(uint32_t size)\n+      : size_(size),\n+        records_(static_cast<T*>(std::malloc(sizeof(T) * size))),\n+        readIndex_(0),\n+        writeIndex_(0) {\n+    assert(size >= 2);\n+    if (!records_) {\n+      throw std::bad_alloc();\n+    }\n+  }\n+\n+  ~ProducerConsumerQueue() {\n+    // We need to destruct anything that may still exist in our queue.\n+    // (No real synchronization needed at destructor time: only one\n+    // thread can be doing this.)\n+    if (!std::is_trivially_destructible<T>::value) {\n+      size_t readIndex = readIndex_;\n+      size_t endIndex = writeIndex_;\n+      while (readIndex != endIndex) {\n+        records_[readIndex].~T();\n+        if (++readIndex == size_) {\n+          readIndex = 0;\n+        }\n+      }\n+    }\n+\n+    std::free(records_);\n+  }\n+\n+  template <class... Args>\n+  bool write(Args&&... recordArgs) {\n+    auto const currentWrite = writeIndex_.load(std::memory_order_relaxed);\n+    auto nextRecord = currentWrite + 1;\n+    if (nextRecord == size_) {\n+      nextRecord = 0;\n+    }\n+    if (nextRecord != readIndex_.load(std::memory_order_acquire)) {\n+      new (&records_[currentWrite]) T(std::forward<Args>(recordArgs)...);\n+      writeIndex_.store(nextRecord, std::memory_order_release);\n+      return true;\n+    }\n+\n+    // queue is full\n+    return false;\n\nReview comment:\n       Right.  I had originally thought \"one queue to fix it all\" but I was overly ambitious.  Not only is the spinning a problem but the SPSC part is a problem too.  A work stealing thread pool could potentially have multiple consumers and any thread pool, even the one we have today, will have multiple producers.  I'll clean up the text on ARROW-11588 so it is less about \"one queue\" and more about traceability.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-18T21:01:40.143+0000",
                    "updated": "2021-02-18T21:01:40.143+0000",
                    "started": "2021-02-18T21:01:40.143+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "554459",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556099",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-783782790\n\n\n   > Can you push a dummy changeset that adds a use of this queue inside the core library? Some CI builds don't enable tests or benchmarks, and wouldn't validate that this is indeed usable.\r\n   \r\n   ARROW-11590 is now passing and can serve as an example of how to use this.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T00:40:06.742+0000",
                    "updated": "2021-02-23T00:40:06.742+0000",
                    "started": "2021-02-23T00:40:06.742+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556099",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556102",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r580694354\n\n\n\n##########\nFile path: cpp/src/arrow/vendored/ProducerConsumerQueue.h\n##########\n@@ -0,0 +1,211 @@\n+// Vendored from git tag v2021.02.15.00\n+\n+/*\n+ * Copyright (c) Facebook, Inc. and its affiliates.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+// @author Bo Hu (bhu@fb.com)\n+// @author Jordan DeLong (delong.j@fb.com)\n+\n+#pragma once\n+\n+#include <atomic>\n+#include <cassert>\n+#include <cstdlib>\n+#include <memory>\n+#include <stdexcept>\n+#include <type_traits>\n+#include <utility>\n+\n+namespace folly {\n\nReview comment:\n       I wrapped it in `arrow_vendored`\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T00:42:07.378+0000",
                    "updated": "2021-02-23T00:42:07.378+0000",
                    "started": "2021-02-23T00:42:07.377+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556102",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556106",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#issuecomment-783786543\n\n\n   Some of the MSVC builds were complaining.  It appears that `alignas` with overaligned sizes was not properly supported in some of the older MSVC compilers.  Since the alignment is merely to ensure that the read and write indices are on separate cache lines and strict alignment isn't actually needed I changed the `alignas` statements to char padding instead.\r\n   \r\n   ```\r\n   alignas(hardware_destructive_interference_size) AtomicIndex readIndex_;\r\n   alignas(hardware_destructive_interference_size) AtomicIndex writeIndex_;\r\n   ```\r\n   vs\r\n   ```\r\n   AtomicIndex readIndex_;\r\n   char pad1_[hardware_destructive_interference_size - sizeof(AtomicIndex)];\r\n   AtomicIndex writeIndex_;\r\n   ```\r\n   \r\n   I verified with benchmarks.\r\n   `alignas` -> 16 million/second\r\n   `nothing` -> 12 million/second\r\n   `padding` -> 16 million/second\r\n   \r\n   However, this area is a little out of my depth, so if someone wants to confirm my reasoning I'd be grateful.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T00:50:13.052+0000",
                    "updated": "2021-02-23T00:50:13.052+0000",
                    "started": "2021-02-23T00:50:13.051+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556106",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556335",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r581035043\n\n\n\n##########\nFile path: LICENSE.txt\n##########\n@@ -2119,6 +2119,11 @@ DEALINGS IN THE SOFTWARE.\n \n --------------------------------------------------------------------------------\n \n+Some source code from Folly (https://github.com/facebook/folly) has been adapted\n+for PyArrow. Folly is released under the Apache License, Version 2.0.\n\nReview comment:\n       Can you mention the file name, as for other notices? Also, not sure why \"PyArrow\" specifically.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T13:30:50.526+0000",
                    "updated": "2021-02-23T13:30:50.526+0000",
                    "started": "2021-02-23T13:30:50.526+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556335",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556575",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kou commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r581422485\n\n\n\n##########\nFile path: cpp/src/arrow/util/queue.h\n##########\n@@ -0,0 +1,29 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License. template <typename T>\n\nReview comment:\n       ```suggestion\r\n   // under the License.\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T22:04:14.804+0000",
                    "updated": "2021-02-23T22:04:14.804+0000",
                    "started": "2021-02-23T22:04:14.804+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556575",
                    "issueId": "13359160"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/worklog/556606",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #9519:\nURL: https://github.com/apache/arrow/pull/9519#discussion_r581443079\n\n\n\n##########\nFile path: cpp/src/arrow/util/queue.h\n##########\n@@ -0,0 +1,29 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License. template <typename T>\n\nReview comment:\n       Oops, thanks!\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T22:42:21.810+0000",
                    "updated": "2021-02-23T22:42:21.810+0000",
                    "started": "2021-02-23T22:42:21.809+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556606",
                    "issueId": "13359160"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 13800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@72d694a0[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@474ad36e[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@eb23f79[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@1ff25c62[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@481f9c4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@72fa5d20[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6dacfdf1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6030bd6a[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6b742771[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4b476462[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@418e5b8e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@24b07538[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13800,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 09 15:16:35 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-03-09T15:16:35.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11680/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2021-02-18T00:27:23.000+0000",
        "updated": "2021-03-09T15:16:42.000+0000",
        "timeoriginalestimate": null,
        "description": "Rationale for vendoring:\r\n\r\nFolly contains hundreds of files, requires boost & C++14.\u00a0 The ProducerConsumerQueue class could be extracted out of three of those files and hasn't been changed since 2018.\u00a0 The queue does not appear to have any open issues.\r\n\r\nComparisons with alternatives:\r\n\r\nI have included a benchmark comparing folly with boost (since boost::lockfree::spsc_queue is already included in arrow, I think).\u00a0 Boost does not support a move workflow for spsc_queue and performs worse.\r\n\r\nI have not compared with any other alternatives but the utility is small and straightforward enough I am doubtful there would be significant differences.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Add vendored version of folly's spsc queue",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/comment/17286384",
                    "id": "17286384",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Is single-producer single-consumer sufficient for our needs (or do I mistunderstand \"spsc\")?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-02-18T09:31:45.646+0000",
                    "updated": "2021-02-18T09:31:45.646+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13359160/comment/17298111",
                    "id": "17298111",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 9519\n[https://github.com/apache/arrow/pull/9519]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-03-09T15:16:35.881+0000",
                    "updated": "2021-03-09T15:16:35.881+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nrq8:",
        "customfield_12314139": null
    }
}