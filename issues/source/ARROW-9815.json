{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13323824",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824",
    "key": "ARROW-9815",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 21000,
            "total": 21000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9815/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 35,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473061",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao opened a new pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018\n\n\n   @andygrove and @alamb , I have no formal training in thread and mutex management, so I am not certain about this proposal or the following explanation:\r\n   \r\n   My understanding is that because the result of\r\n   \r\n   ```\r\n   ctx_state\r\n                   .lock()\r\n                   .expect(\"failed to lock mutex\")\r\n                   .scalar_functions\r\n                   .lock()\r\n                   .expect(\"failed to lock mutex\")\r\n                   .get(name)\r\n   ```\r\n   \r\n   is of temporary lifetime, using this in `match` blocks any access to `scalar_functions` until we leave the match, which deadlocks when we recursively call the function. Here I just cloned `.scalar_functions` so that we allow the lock to be released.\r\n   \r\n   I may also be dead wrong in every word that I wrote above.\r\n   \r\n   This does work, but if you could validate my reasoning above, I would appreciate very much!\r\n   \r\n   Note that we are also doing the same for `.datasources` in this file, which I suspect will also deadlock if when we have a plan with two sources. I did not touch that as I do not know the idiom/pattern to address this (locking within recursions).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T19:55:19.950+0000",
                    "updated": "2020-08-20T19:55:19.950+0000",
                    "started": "2020-08-20T19:55:19.950+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473061",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473065",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-677876253\n\n\n   https://issues.apache.org/jira/browse/ARROW-9815\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T20:05:44.011+0000",
                    "updated": "2020-08-20T20:05:44.011+0000",
                    "started": "2020-08-20T20:05:44.011+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473065",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473077",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-677894563\n\n\n   I left a second commit, which is *in alternative* to the first one. The main difference between them is that the latter does not lock mutexes inside the recursion, which often helps avoiding deadlocks.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T20:45:08.326+0000",
                    "updated": "2020-08-20T20:45:08.326+0000",
                    "started": "2020-08-20T20:45:08.326+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473077",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473126",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-677958379\n\n\n   > I left a second commit, which is _in alternative_ to the first one. The main difference between them is that the latter does not lock mutexes inside the recursion, which often helps avoiding deadlocks.\r\n   \r\n   I found reviewing with `w=1` easier for the second commit -- link https://github.com/apache/arrow/pull/8018/commits/2ff23f67e3d9de9419faea89d7702af449d82791?w=1\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T23:39:07.375+0000",
                    "updated": "2020-08-20T23:39:07.375+0000",
                    "started": "2020-08-20T23:39:07.375+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473126",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473127",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#discussion_r474329092\n\n\n\n##########\nFile path: rust/datafusion/tests/sql.rs\n##########\n@@ -201,6 +201,18 @@ fn csv_query_avg_sqrt() -> Result<()> {\n     Ok(())\n }\n \n+#[test]\n+fn csv_query_sqrt_sqrt() -> Result<()> {\n\nReview comment:\n       ```suggestion\r\n   // ARROW-9851: This query deadlocked when processing a\r\n   // udf that called another udf\r\n   fn csv_query_sqrt_sqrt() -> Result<()> {\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-20T23:42:56.367+0000",
                    "updated": "2020-08-20T23:42:56.367+0000",
                    "started": "2020-08-20T23:42:56.367+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473127",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473165",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-677999442\n\n\n   Thanks @jorgecarleitao I think both approaches look good too. Another potential solution is just to put the mutex lock in a smaller scope by putting it in curly braces e.g.\r\n   \r\n   ```rust\r\n   let scalar_functions = {\r\n       ctx_state\r\n                   .expect(\"failed to lock mutex\")\r\n                       .lock()\r\n                   .scalar_functions\r\n                       .expect(\"failed to lock mutex\")\r\n                   .lock()\r\n                       .scalar_functions\r\n                   .expect(\"failed to lock mutex\")\r\n                       .lock()\r\n                   .get(name)\r\n                       .expect(\"Unable to lock mutex\")\r\n               {\r\n                       .clone()\r\n   };\r\n   ```\r\n   \r\n   This way, the mutex gets released within this block instead of being kept open.\r\n   \r\n   @alamb Yes, the locking is yet more tech debt to be addressed. These things need to be mutable due to the dynamic/interactive nature of the context, but I'm sure there is a cleaner solution.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T02:15:48.408+0000",
                    "updated": "2020-08-21T02:15:48.408+0000",
                    "started": "2020-08-21T02:15:48.408+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473165",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473194",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678032001\n\n\n   Thank you both for the help.\r\n   \r\n   IMO having this in pure functions make it more explicit about the functionality's dependency on \"self\" (via the arguments it needs). For example, it is now clear that `create_physical_expr` and `create_aggregate_expr` only need the scalar functions, not everything from \"self\". If we `pub` those functions, others can also re-use them without having to use the struct ExecutionContext from DataFusion.\r\n   \r\n   I agree with you @alamb that the create_* may end up clustered with arguments. I think that there may be a change that would place all those in a struct a-la contextState that does not need to lock (e.g. just `HashMap`), so that they can be easily reused on a recursion without locking on every recursion, both of the plan and every expression on it.\r\n   \r\n   @andygrove , feel free to pick either commit to push, or if you prefer the third option you mentioned, that I will work it out and push.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T04:31:00.359+0000",
                    "updated": "2020-08-21T04:31:00.359+0000",
                    "started": "2020-08-21T04:31:00.359+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473194",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473290",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678281123\n\n\n   I had another thought on this. We do need the `ExecutionContextState` to be mutable, but only up until execution begins. Perhaps we should rename `ExecutionContextState` to `MutableExecutionContextState` and create a new `ExecutionContextState` that does not have mutexes and just contains a read-only copy of state that is needed during execution?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T13:08:11.334+0000",
                    "updated": "2020-08-21T13:08:11.334+0000",
                    "started": "2020-08-21T13:08:11.333+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473290",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473310",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678333145\n\n\n   > I had another thought on this. We do need the `ExecutionContextState` to be mutable, but only up until execution begins. Perhaps we should rename `ExecutionContextState` to `MutableExecutionContextState` and create a new `ExecutionContextState` that does not have mutexes and just contains a read-only copy of state that is needed during execution?\r\n   \r\n   @andygrove  that sounds like a better idea to me. What I don't get is why a separate type would be needed to differentiate between mutable and non mutable versions of state -- the Rust type system has the notion of mutable/non-mutable built in deeply.\r\n   \r\n   So maybe, for example, anything that needs a mutable `ExecutionContextState` could be passed a `&mut ExecutionContextState` (the conversion to physical plan, for example), and anything during execution that needs a read only `ExecutionContextState` could be passed an `Arc<ExecutionContextState`.\r\n   \r\n   I am probably missing something obvious\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T14:54:43.714+0000",
                    "updated": "2020-08-21T14:54:43.714+0000",
                    "started": "2020-08-21T14:54:43.714+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473310",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473325",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678369613\n\n\n   @alamb I think you are right. Rather than having `Arc<Mutex<_>>` within `ExecutionContextState`, we should have `Arc<Mutex<ExecutionContextState>>` where we need mutability and then `clone()` the state to get a read-only snapshot when we need it for execution.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T16:07:21.920+0000",
                    "updated": "2020-08-21T16:07:21.920+0000",
                    "started": "2020-08-21T16:07:21.920+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473325",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678406791\n\n\n   That definitely sounds cleaner to me\n   \n   On Fri, Aug 21, 2020 at 12:07 PM Andy Grove <notifications@github.com>\n   wrote:\n   \n   > @alamb <https://github.com/alamb> I think you are right. Rather than\n   > having Arc<Mutex<_>> within ExecutionContextState, we should have\n   > Arc<Mutex<ExecutionContextState>> where we need mutability and then\n   > clone() the state to get a read-only snapshot when we need it for\n   > execution.\n   >\n   > \u2014\n   > You are receiving this because you were mentioned.\n   > Reply to this email directly, view it on GitHub\n   > <https://github.com/apache/arrow/pull/8018#issuecomment-678369613>, or\n   > unsubscribe\n   > <https://github.com/notifications/unsubscribe-auth/AADXZMNL3AKJJYNL7NO7ZLLSB2LTTANCNFSM4QGRFXAQ>\n   > .\n   >\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T17:36:35.907+0000",
                    "updated": "2020-08-21T17:36:35.907+0000",
                    "started": "2020-08-21T17:36:35.907+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473362",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473400",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678428145\n\n\n   You agree, I agree, we all agree!!! \ud83c\udf89\ud83c\udf89\ud83c\udf89\ud83c\udf89 I will re-visit this and re-submit a PR with this.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-21T18:27:27.971+0000",
                    "updated": "2020-08-21T18:27:27.971+0000",
                    "started": "2020-08-21T18:27:27.971+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473400",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473534",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678609613\n\n\n   Hey both, I think I implemented what we discussed, but the devil is always in the details.\r\n   \r\n   The main changes are:\r\n   \r\n   * `ExecutionContextState::datasources` and `ExecutionContextState::scalar_functions` are now boxed, not `Arc`. This is so that when we lock `ExecutionContextState`, both get locked, which means that we only need to lock `ExecutionContextState` (but threads can't change each independently).\r\n   * `ExecutionContextState` is no longer clonable.\r\n   * optimizers now expect references, not `Arc<Mutex<_>>`.\r\n   * `SqlToRel` is now lifetimed, as it is now bound to `ExecutionContextState`.\r\n   \r\n   I feel that we should probably have a test to demonstrate the that `ExecutionContext` is thread safe (e.g. run two queries from two different threads).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-22T07:45:39.154+0000",
                    "updated": "2020-08-22T07:45:39.154+0000",
                    "started": "2020-08-22T07:45:39.154+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473534",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473535",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao edited a comment on pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018#issuecomment-678609613\n\n\n   Hey both, I think I implemented what we discussed, but the devil is always in the details.\r\n   \r\n   The main changes are:\r\n   \r\n   * `ExecutionContextState::datasources` and `ExecutionContextState::scalar_functions` are now boxed, not `Arc`. This is so that when we lock `ExecutionContextState`, both get locked, which means that we only need to lock `ExecutionContextState` (but threads can't change each independently).\r\n   * `ExecutionContextState` is no longer clonable.\r\n   * optimizers now expect references, not `Arc<Mutex<_>>`.\r\n   * `SqlToRel` is now lifetimed, as it is now bound to `ExecutionContextState`.\r\n   \r\n   I feel that we should probably have a test to demonstrate that the `ExecutionContext` is thread safe (e.g. run two queries from two different threads).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-22T07:46:02.128+0000",
                    "updated": "2020-08-22T07:46:02.128+0000",
                    "started": "2020-08-22T07:46:02.128+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473535",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473567",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove closed pull request #8018:\nURL: https://github.com/apache/arrow/pull/8018\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-22T17:05:55.044+0000",
                    "updated": "2020-08-22T17:05:55.044+0000",
                    "started": "2020-08-22T17:05:55.044+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473567",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473648",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb opened a new pull request #8031:\nURL: https://github.com/apache/arrow/pull/8031\n\n\n   Inspired by the conversation on https://github.com/apache/arrow/pull/8018/files, I have been bothered by the use of Arc/Mutex and the resulting code complication in ExecutionContext and LogicalPlanning.\r\n   \r\n   The more I read the code, the more I am convinced that `ExecutionContextState` needs to be mutable *before* planning, but once planning has started the state is all read only (and any relevant state is copied / cloned into the `ExecutionPlan`) so the only thing Mutex/Arc are doing is making lurking bugs like ARROW-9815 more likely and requiring copies. \r\n   \r\n   This PR proposes a modest change to add a trait for looking up scalar functions by name, and thus removes the direct use of Box / HashMaps / etc in the TypeCoercion optimizer pass.\r\n   \r\n   I have several other changes in mind to avoid the need for Box / Mutex entirely in ExecutionContext but I want to keep the individual PRs small.\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-23T14:10:42.173+0000",
                    "updated": "2020-08-23T14:10:42.173+0000",
                    "started": "2020-08-23T14:10:42.173+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473648",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473650",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #8031:\nURL: https://github.com/apache/arrow/pull/8031#discussion_r475224655\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -189,16 +190,7 @@ impl ExecutionContext {\n     /// Register a scalar UDF\n     pub fn register_udf(&mut self, f: ScalarFunction) {\n         let mut state = self.state.lock().expect(\"failed to lock mutex\");\n-        state.scalar_functions.insert(f.name.clone(), Box::new(f));\n-    }\n-\n-    /// Get a reference to the registered scalar functions\n-    pub fn scalar_functions(&self) -> Box<HashMap<String, Box<ScalarFunction>>> {\n\nReview comment:\n       This function actually deep-copied the HashMap. After this PR it does not\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -317,22 +309,9 @@ impl ExecutionContext {\n \n     /// Optimize the logical plan by applying optimizer rules\n     pub fn optimize(&self, plan: &LogicalPlan) -> Result<LogicalPlan> {\n-        let rules: Vec<Box<dyn OptimizerRule>> = vec![\n-            Box::new(ProjectionPushDown::new()),\n-            Box::new(FilterPushDown::new()),\n-            Box::new(TypeCoercionRule::new(\n-                self.state\n-                    .lock()\n-                    .expect(\"failed to lock mutex\")\n-                    .scalar_functions\n-                    .as_ref(),\n-            )),\n-        ];\n-        let mut plan = plan.clone();\n-\n-        for mut rule in rules {\n-            plan = rule.optimize(&plan)?;\n-        }\n+        let plan = ProjectionPushDown::new().optimize(&plan)?;\n+        let plan = FilterPushDown::new().optimize(&plan)?;\n+        let plan = TypeCoercionRule::new(self).optimize(&plan)?;\n\nReview comment:\n       Now, this code makes it clear that the TypeCoercisonRule optimizer pass is a short lived object (and can't possibly outlive the `ExecutionContext`)\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -427,6 +406,16 @@ impl ExecutionContext {\n     }\n }\n \n+impl ScalarFunctionProvider for ExecutionContext {\n+    fn lookup(&self, name: &str) -> Option<Arc<ScalarFunction>> {\n+        self.state\n\nReview comment:\n       My long term plan is to remove the Mutex entirely from `ExecutionContext` and thus this can be made simpler\n\n##########\nFile path: rust/datafusion/src/optimizer/type_coercion.rs\n##########\n@@ -38,17 +35,21 @@ use utils::optimize_explain;\n /// Optimizer that applies coercion rules to expressions in the logical plan.\n ///\n /// This optimizer does not alter the structure of the plan, it only changes expressions on it.\n-pub struct TypeCoercionRule {\n-    scalar_functions: Arc<HashMap<String, Box<ScalarFunction>>>,\n+pub struct TypeCoercionRule<'a, P>\n+where\n+    P: ScalarFunctionProvider,\n+{\n+    scalar_functions: &'a P,\n }\n \n-impl TypeCoercionRule {\n+impl<'a, P> TypeCoercionRule<'a, P>\n+where\n+    P: ScalarFunctionProvider,\n+{\n     /// Create a new type coercion optimizer rule using meta-data about registered\n     /// scalar functions\n-    pub fn new(scalar_functions: &HashMap<String, Box<ScalarFunction>>) -> Self {\n-        Self {\n-            scalar_functions: Arc::new(scalar_functions.clone()),\n\nReview comment:\n       This used to copy the entire HashMap\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-23T14:17:18.040+0000",
                    "updated": "2020-08-23T14:17:18.040+0000",
                    "started": "2020-08-23T14:17:18.040+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473650",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473651",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8031:\nURL: https://github.com/apache/arrow/pull/8031#issuecomment-678779883\n\n\n   FYI @jorgecarleitao  and @andygrove \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-23T14:17:31.126+0000",
                    "updated": "2020-08-23T14:17:31.126+0000",
                    "started": "2020-08-23T14:17:31.126+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473651",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473652",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8031:\nURL: https://github.com/apache/arrow/pull/8031#issuecomment-678780263\n\n\n   https://issues.apache.org/jira/browse/ARROW-9815\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-23T14:20:45.798+0000",
                    "updated": "2020-08-23T14:20:45.798+0000",
                    "started": "2020-08-23T14:20:45.798+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473652",
                    "issueId": "13323824"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/worklog/473660",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #8031:\nURL: https://github.com/apache/arrow/pull/8031#discussion_r475229968\n\n\n\n##########\nFile path: rust/datafusion/src/execution/context.rs\n##########\n@@ -477,9 +466,9 @@ impl ExecutionConfig {\n /// Execution context for registering data sources and executing queries\n pub struct ExecutionContextState {\n     /// Data sources that are registered with the context\n-    pub datasources: Box<HashMap<String, Box<dyn TableProvider + Send + Sync>>>,\n+    pub datasources: HashMap<String, Box<dyn TableProvider + Send + Sync>>,\n     /// Scalar functions that are registered with the context\n-    pub scalar_functions: Box<HashMap<String, Box<ScalarFunction>>>,\n+    pub scalar_functions: HashMap<String, Arc<ScalarFunction>>,\n\nReview comment:\n       just for the sake of my understanding (prob a very basic CS question): why shouldn't we use simply `ScalarFunction` here? Is so that we can safely share this object with others without having to share the whole `HashMap`?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-08-23T15:03:54.372+0000",
                    "updated": "2020-08-23T15:03:54.372+0000",
                    "started": "2020-08-23T15:03:54.372+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "473660",
                    "issueId": "13323824"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 21000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1ca3fb4e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@57776ede[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d44eacc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@71a97624[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33a07e8a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@5daee35b[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@678670a8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5d24322a[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6dc0532a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@475ed1f2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1309ea81[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6f403fa8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 21000,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Aug 22 17:05:52 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-08-22T17:05:52.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-9815/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-08-20T19:46:40.000+0000",
        "updated": "2020-09-01T12:50:32.000+0000",
        "timeoriginalestimate": null,
        "description": "This one took me some time to understand, but I finally have a reproducible example: when two udfs are called, one after the other, we cause a deadlock when creating the physical plan.\r\n\r\nExample test\r\n\r\n{code}\r\n#[test]\r\nfn csv_query_sqrt_sqrt() -> Result<()> {\r\n    let mut ctx = create_ctx()?;\r\n    register_aggregate_csv(&mut ctx)?;\r\n    let sql = \"SELECT sqrt(sqrt(c12)) FROM aggregate_test_100 LIMIT 1\";\r\n    let actual = execute(&mut ctx, sql);\r\n    // sqrt(sqrt(c12=0.9294097332465232)) = 0.9818650561397431\r\n    let expected = \"0.9818650561397431\".to_string();\r\n    assert_eq!(actual.join(\"\\n\"), expected);\r\n    Ok(())\r\n}\r\n{code}\r\n\r\nI believe that this is due to the recursive nature of the physical planner, that locks scalar_functions within a match, which blocks the whole thing.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 21000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] [DataFusion] Deadlock in creation of physical plan with two udfs",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323824/comment/17182436",
                    "id": "17182436",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "Issue resolved by pull request 8018\n[https://github.com/apache/arrow/pull/8018]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-08-22T17:05:52.984+0000",
                    "updated": "2020-08-22T17:05:52.984+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0hynk:",
        "customfield_12314139": null
    }
}