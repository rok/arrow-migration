{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13424539",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539",
    "key": "ARROW-15438",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
            "name": "vibhatha",
            "key": "vibhatha",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Vibhatha Lakmal Abeykoon",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15438/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 30,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714405",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha opened a new pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252\n\n\n   Adding a fix: Could be caused due to the smaller number of data. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T11:27:31.759+0000",
                    "updated": "2022-01-25T11:27:31.759+0000",
                    "started": "2022-01-25T11:27:31.759+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714405",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714406",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021091474\n\n\n   https://issues.apache.org/jira/browse/ARROW-15438\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T11:27:54.506+0000",
                    "updated": "2022-01-25T11:27:54.506+0000",
                    "started": "2022-01-25T11:27:54.506+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714406",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714491",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "raulcd commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791743995\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Hi, thanks for the PR!\r\n   It is the first time I am contributing to the project reviewing some PRs and trying to understand the project a little better. I was taking a look and from what I can see on the rest of the test files there are not many prints on them. Was it for debugging? I would probably remove the print unless there is a reason to have it.\r\n   Thanks\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T14:04:33.593+0000",
                    "updated": "2022-01-25T14:04:33.593+0000",
                    "started": "2022-01-25T14:04:33.593+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714491",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714494",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791749029\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Yeah and also left the print statement for\r\n   Future debugging purpose \r\n   We can remove it too. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T14:09:51.929+0000",
                    "updated": "2022-01-25T14:09:51.929+0000",
                    "started": "2022-01-25T14:09:51.929+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714494",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714495",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791749029\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Thank you for the review. \r\n   Yeah and also left the print statement for\r\n   Future debugging purpose \r\n   We can remove it too. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T14:10:16.309+0000",
                    "updated": "2022-01-25T14:10:16.309+0000",
                    "started": "2022-01-25T14:10:16.309+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714495",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714593",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791843026\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Removed the logs \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T15:38:33.467+0000",
                    "updated": "2022-01-25T15:38:33.467+0000",
                    "started": "2022-01-25T15:38:33.466+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714593",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714900",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021091474\n\n\n   https://issues.apache.org/jira/browse/ARROW-15438\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T16:56:08.603+0000",
                    "updated": "2022-01-25T16:56:08.603+0000",
                    "started": "2022-01-25T16:56:08.602+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714900",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/714943",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791749029\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Yeah and also left the print statement for\r\n   Future debugging purpose \r\n   We can remove it too. \n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Thank you for the review. \r\n   Yeah and also left the print statement for\r\n   Future debugging purpose \r\n   We can remove it too. \n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Removed the logs \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T17:00:14.588+0000",
                    "updated": "2022-01-25T17:00:14.588+0000",
                    "started": "2022-01-25T17:00:14.587+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "714943",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715061",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "raulcd commented on a change in pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#discussion_r791743995\n\n\n\n##########\nFile path: python/pyarrow/tests/test_dataset.py\n##########\n@@ -3804,6 +3807,8 @@ def _get_compare_pair(data_source, record_batch, file_format, col_id):\n     num_of_files_generated, number_of_partitions \\\n         = _get_compare_pair(data_source_2, record_batch_1, file_format,\n                             partition_column_id)\n+    print(f\"Generated File Count: {num_of_files_generated}\")\n\nReview comment:\n       Hi, thanks for the PR!\r\n   It is the first time I am contributing to the project reviewing some PRs and trying to understand the project a little better. I was taking a look and from what I can see on the rest of the test files there are not many prints on them. Was it for debugging? I would probably remove the print unless there is a reason to have it.\r\n   Thanks\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T17:10:06.556+0000",
                    "updated": "2022-01-25T17:10:06.556+0000",
                    "started": "2022-01-25T17:10:06.556+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715061",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715085",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha opened a new pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252\n\n\n   Adding a fix: Could be caused due to the smaller number of data. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T17:12:14.367+0000",
                    "updated": "2022-01-25T17:12:14.367+0000",
                    "started": "2022-01-25T17:12:14.367+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715085",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715130",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021396494\n\n\n   @lidavidm can you verify that the patch resolves the issue?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T17:15:48.401+0000",
                    "updated": "2022-01-25T17:15:48.401+0000",
                    "started": "2022-01-25T17:15:48.401+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715130",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715137",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021399420\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T17:16:10.508+0000",
                    "updated": "2022-01-25T17:16:10.508+0000",
                    "started": "2022-01-25T17:16:10.508+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715137",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715196",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021485326\n\n\n   Basically you are getting \"very unlucky\" since ConsumingSinkNode does not serialize calls to Consume and all data in batches is ordered by the partition column, so what you get is that each batch gets partitioned, and then the threads _happen_ to line up such that each thread writes out the batch for partition A, then for partition B, ... and so on, so even if only one file can be open at a time, we don't ever need to open a second file for a partition.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T18:29:02.717+0000",
                    "updated": "2022-01-25T18:29:02.717+0000",
                    "started": "2022-01-25T18:29:02.717+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715196",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715197",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021485822\n\n\n   Oh, cross that part out about the data ordering. The partition step makes that moot.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T18:29:45.627+0000",
                    "updated": "2022-01-25T18:29:45.627+0000",
                    "started": "2022-01-25T18:29:45.627+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715197",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715199",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021487828\n\n\n   I'm not sure why use_threads doesn't affect this (but GLog below is showing various thread IDs):\r\n   \r\n   ```\r\n   pyarrow/tests/test_dataset.py::test_write_dataset_max_open_files WARNING: Logging before InitGoogleLogging() is written to STDERR\r\n   W20220125 13:26:12.820377 27754 file_base.cc:297] Next batch: c1:   [\r\n       1,\r\n       2,\r\n       3,\r\n       4,\r\n       0,\r\n       10,\r\n       20,\r\n       30,\r\n       40\r\n     ]\r\n   c2:   [\r\n       \"a\",\r\n       \"b\",\r\n       \"c\",\r\n       \"d\",\r\n       \"e\",\r\n       \"a\",\r\n       \"a\",\r\n       \"b\",\r\n       \"c\"\r\n     ]\r\n   W20220125 13:26:12.820533 27755 file_base.cc:297] Next batch: c1:   [\r\n       5,\r\n       6,\r\n       7,\r\n       8,\r\n       0,\r\n       1,\r\n       10,\r\n       20,\r\n       30\r\n     ]\r\n   c2:   [\r\n       \"a\",\r\n       \"b\",\r\n       \"c\",\r\n       \"d\",\r\n       \"e\",\r\n       \"c\",\r\n       \"a\",\r\n       \"b\",\r\n       \"c\"\r\n     ]\r\n   W20220125 13:26:12.820778 27757 file_base.cc:297] Next batch: c1:   [\r\n       9,\r\n       10,\r\n       11,\r\n       12,\r\n       0,\r\n       1,\r\n       30,\r\n       40,\r\n       50\r\n     ]\r\n   c2:   [\r\n       \"a\",\r\n       \"b\",\r\n       \"c\",\r\n       \"d\",\r\n       \"e\",\r\n       \"d\",\r\n       \"a\",\r\n       \"b\",\r\n       \"c\"\r\n     ]\r\n   W20220125 13:26:12.820991 27752 file_base.cc:297] Next batch: c1:   [\r\n       13,\r\n       14,\r\n       15,\r\n       16,\r\n       0,\r\n       1,\r\n       10,\r\n       20,\r\n       30,\r\n       40,\r\n       50\r\n     ]\r\n   c2:   [\r\n       \"a\",\r\n       \"b\",\r\n       \"c\",\r\n       \"d\",\r\n       \"e\",\r\n       \"b\",\r\n       \"b\",\r\n       \"a\",\r\n       \"d\",\r\n       \"b\",\r\n       \"a\"\r\n     ]\r\n   W20220125 13:26:12.821352 27754 file_base.cc:319] Next partition c1:   [\r\n       1,\r\n       10,\r\n       20\r\n     ]\r\n   W20220125 13:26:12.821383 27754 file_base.cc:320] Next destination c2=a\r\n   W20220125 13:26:12.821465 27754 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.821472 27754 dataset_writer.cc:309] Opening file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=a/part-0.parquet\r\n   W20220125 13:26:12.821590 27755 file_base.cc:319] Next partition c1:   [\r\n       5,\r\n       10\r\n     ]\r\n   W20220125 13:26:12.821632 27755 file_base.cc:320] Next destination c2=a\r\n   W20220125 13:26:12.821770 27757 file_base.cc:319] Next partition c1:   [\r\n       9,\r\n       30\r\n     ]\r\n   W20220125 13:26:12.821805 27757 file_base.cc:320] Next destination c2=a\r\n   W20220125 13:26:12.821910 27752 file_base.cc:319] Next partition c1:   [\r\n       13,\r\n       20,\r\n       50\r\n     ]\r\n   W20220125 13:26:12.821943 27752 file_base.cc:320] Next destination c2=a\r\n   W20220125 13:26:12.822041 27755 file_base.cc:319] Next partition c1:   [\r\n       6,\r\n       20\r\n     ]\r\n   W20220125 13:26:12.822079 27755 file_base.cc:320] Next destination c2=b\r\n   W20220125 13:26:12.822149 27755 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.822168 27755 dataset_writer.cc:502] Need to close file\r\n   W20220125 13:26:12.824494 27761 dataset_writer.cc:321] Closing file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=a/part-0.parquet\r\n   W20220125 13:26:12.824517 27761 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.824522 27761 dataset_writer.cc:309] Opening file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=b/part-0.parquet\r\n   W20220125 13:26:12.824643 27761 file_base.cc:319] Next partition c1:   [\r\n       2,\r\n       30\r\n     ]\r\n   W20220125 13:26:12.824677 27761 file_base.cc:320] Next destination c2=b\r\n   W20220125 13:26:12.824752 27761 file_base.cc:319] Next partition c1:   [\r\n       10,\r\n       40\r\n     ]\r\n   W20220125 13:26:12.824780 27761 file_base.cc:320] Next destination c2=b\r\n   W20220125 13:26:12.824851 27761 file_base.cc:319] Next partition c1:   [\r\n       14,\r\n       1,\r\n       10,\r\n       40\r\n     ]\r\n   W20220125 13:26:12.824880 27761 file_base.cc:320] Next destination c2=b\r\n   W20220125 13:26:12.824952 27761 file_base.cc:319] Next partition c1:   [\r\n       7,\r\n       1,\r\n       30\r\n     ]\r\n   W20220125 13:26:12.824980 27761 file_base.cc:320] Next destination c2=c\r\n   W20220125 13:26:12.825034 27761 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.825044 27761 dataset_writer.cc:502] Need to close file\r\n   W20220125 13:26:12.826997 27762 dataset_writer.cc:321] Closing file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=b/part-0.parquet\r\n   W20220125 13:26:12.827020 27762 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.827025 27762 dataset_writer.cc:309] Opening file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=c/part-0.parquet\r\n   W20220125 13:26:12.827148 27762 file_base.cc:319] Next partition c1:   [\r\n       3,\r\n       40\r\n     ]\r\n   W20220125 13:26:12.827184 27762 file_base.cc:320] Next destination c2=c\r\n   W20220125 13:26:12.827260 27762 file_base.cc:319] Next partition c1:   [\r\n       11,\r\n       50\r\n     ]\r\n   W20220125 13:26:12.827288 27762 file_base.cc:320] Next destination c2=c\r\n   W20220125 13:26:12.827361 27762 file_base.cc:319] Next partition c1:   [\r\n       15\r\n     ]\r\n   W20220125 13:26:12.827389 27762 file_base.cc:320] Next destination c2=c\r\n   W20220125 13:26:12.827461 27762 file_base.cc:319] Next partition c1:   [\r\n       4\r\n     ]\r\n   W20220125 13:26:12.827487 27762 file_base.cc:320] Next destination c2=d\r\n   W20220125 13:26:12.827543 27762 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.827553 27762 dataset_writer.cc:502] Need to close file\r\n   W20220125 13:26:12.829382 27761 dataset_writer.cc:321] Closing file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=c/part-0.parquet\r\n   W20220125 13:26:12.829403 27761 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.829409 27761 dataset_writer.cc:309] Opening file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=d/part-0.parquet\r\n   W20220125 13:26:12.829531 27761 file_base.cc:319] Next partition c1:   [\r\n       8\r\n     ]\r\n   W20220125 13:26:12.829560 27761 file_base.cc:320] Next destination c2=d\r\n   W20220125 13:26:12.829636 27761 file_base.cc:319] Next partition c1:   [\r\n       12,\r\n       1\r\n     ]\r\n   W20220125 13:26:12.829663 27761 file_base.cc:320] Next destination c2=d\r\n   W20220125 13:26:12.829735 27761 file_base.cc:319] Next partition c1:   [\r\n       16,\r\n       30\r\n     ]\r\n   W20220125 13:26:12.829762 27761 file_base.cc:320] Next destination c2=d\r\n   W20220125 13:26:12.829834 27761 file_base.cc:319] Next partition c1:   [\r\n       0\r\n     ]\r\n   W20220125 13:26:12.829860 27761 file_base.cc:320] Next destination c2=e\r\n   W20220125 13:26:12.829912 27761 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.829921 27761 dataset_writer.cc:502] Need to close file\r\n   W20220125 13:26:12.831791 27762 dataset_writer.cc:321] Closing file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=d/part-0.parquet\r\n   W20220125 13:26:12.831813 27762 dataset_writer.cc:499] Need to open file\r\n   W20220125 13:26:12.831820 27762 dataset_writer.cc:309] Opening file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=e/part-0.parquet\r\n   W20220125 13:26:12.831940 27762 file_base.cc:319] Next partition c1:   [\r\n       0\r\n     ]\r\n   W20220125 13:26:12.831971 27762 file_base.cc:320] Next destination c2=e\r\n   W20220125 13:26:12.832048 27762 file_base.cc:319] Next partition c1:   [\r\n       0\r\n     ]\r\n   W20220125 13:26:12.832075 27762 file_base.cc:320] Next destination c2=e\r\n   W20220125 13:26:12.832150 27762 file_base.cc:319] Next partition c1:   [\r\n       0\r\n     ]\r\n   W20220125 13:26:12.832176 27762 file_base.cc:320] Next destination c2=e\r\n   W20220125 13:26:12.834204 27762 dataset_writer.cc:321] Closing file /tmp/pytest-of-lidavidm/pytest-232/test_write_dataset_max_open_fi0/ds/max_1/c2=e/part-0.parquet\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T18:31:56.002+0000",
                    "updated": "2022-01-25T18:31:56.002+0000",
                    "started": "2022-01-25T18:31:56.002+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715199",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715202",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021488945\n\n\n   I would probably just remove the second half of the test (it's all tested in C++ anyways)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T18:33:34.088+0000",
                    "updated": "2022-01-25T18:33:34.088+0000",
                    "started": "2022-01-25T18:33:34.088+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715202",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715204",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on pull request #12252:\nURL: https://github.com/apache/arrow/pull/12252#issuecomment-1021491520\n\n\n   @lidavidm yes it is tested in C++. It's a richer API than Python\u2019s and the exact case intended can be written in C++ well. And we could remove it but an important part get missed. Does this also show a limitation in the Python API? \r\n   \r\n   @westonpace any thoughts on this? \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T18:37:02.877+0000",
                    "updated": "2022-01-25T18:37:02.877+0000",
                    "started": "2022-01-25T18:37:02.876+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715204",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715352",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace opened a new pull request #12263:\nURL: https://github.com/apache/arrow/pull/12263\n\n\n   The test could fail when writing due to a race condition.  If the batches were delivered `AAAAABBBBBCCCCC...` then by the time we need to close a file to make space we can close an already completed file (and so we won't have to open up a new one later) and we end up with 5 files for 5 partitions.\r\n   \r\n   Adding `use_threads=False` to the `write_dataset` call was not sufficient.  The `arrow::dataset::FileSystemDataset::Write` method was always using the CPU executor for the exec plan.  In other scanner methods we base the CPU executor on the scan options (`nullptr` if `scan_options->use_threads` is `false`).  Making both of these changes together seems to make the test reliably pass.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T22:54:36.869+0000",
                    "updated": "2022-01-25T22:54:36.869+0000",
                    "started": "2022-01-25T22:54:36.868+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715352",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715353",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12263:\nURL: https://github.com/apache/arrow/pull/12263#issuecomment-1021684894\n\n\n   https://issues.apache.org/jira/browse/ARROW-15438\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T22:54:59.503+0000",
                    "updated": "2022-01-25T22:54:59.503+0000",
                    "started": "2022-01-25T22:54:59.502+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715353",
                    "issueId": "13424539"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/worklog/715355",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs commented on pull request #12263:\nURL: https://github.com/apache/arrow/pull/12263#issuecomment-1021686025\n\n\n   Thanks Weston! \r\n   \r\n   @lidavidm could you please verify this locally?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-25T22:57:00.222+0000",
                    "updated": "2022-01-25T22:57:00.222+0000",
                    "started": "2022-01-25T22:57:00.222+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "715355",
                    "issueId": "13424539"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 18000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@646a2d90[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@46a0f09a[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@15fd7a4c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@54186c49[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1ea75aa7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4894399e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@36c515da[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@21285d6f[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@57e498f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6c4fd877[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@72ba7be1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@111a83fc[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18000,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jan 27 10:01:59 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-01-27T10:01:59.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15438/watchers",
            "watchCount": 6,
            "isWatching": false
        },
        "created": "2022-01-25T00:04:13.000+0000",
        "updated": "2022-02-01T09:12:07.000+0000",
        "timeoriginalestimate": null,
        "description": "Found during 7.0.0 verification\r\n{noformat}\r\npyarrow/tests/test_dataset.py::test_write_dataset_max_open_files FAILED \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0[ 30%]\r\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> traceback >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>tempdir = PosixPath('/tmp/pytest-of-root/pytest-1/test_write_dataset_max_open_fi0')\u00a0 \u00a0 def test_write_dataset_max_open_files(tempdir):\r\n\u00a0 \u00a0 \u00a0 \u00a0 directory = tempdir / 'ds'\r\n\u00a0 \u00a0 \u00a0 \u00a0 file_format = \"parquet\"\r\n\u00a0 \u00a0 \u00a0 \u00a0 partition_column_id = 1\r\n\u00a0 \u00a0 \u00a0 \u00a0 column_names = ['c1', 'c2']\r\n\u00a0 \u00a0 \u00a0 \u00a0 record_batch_1 = pa.record_batch(data=[[1, 2, 3, 4, 0, 10],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0['a', 'b', 'c', 'd', 'e', 'a']],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0names=column_names)\r\n\u00a0 \u00a0 \u00a0 \u00a0 record_batch_2 = pa.record_batch(data=[[5, 6, 7, 8, 0, 1],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0['a', 'b', 'c', 'd', 'e', 'c']],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0names=column_names)\r\n\u00a0 \u00a0 \u00a0 \u00a0 record_batch_3 = pa.record_batch(data=[[9, 10, 11, 12, 0, 1],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0['a', 'b', 'c', 'd', 'e', 'd']],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0names=column_names)\r\n\u00a0 \u00a0 \u00a0 \u00a0 record_batch_4 = pa.record_batch(data=[[13, 14, 15, 16, 0, 1],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0['a', 'b', 'c', 'd', 'e', 'b']],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0names=column_names)\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 table = pa.Table.from_batches([record_batch_1, record_batch_2,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0record_batch_3, record_batch_4])\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 partitioning = ds.partitioning(\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 pa.schema([(column_names[partition_column_id], pa.string())]),\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 flavor=\"hive\")\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 data_source_1 = directory / \"default\"\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 ds.write_dataset(data=table, base_dir=data_source_1,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0partitioning=partitioning, format=file_format)\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 # Here we consider the number of unique partitions created when\r\n\u00a0 \u00a0 \u00a0 \u00a0 # partitioning column contains duplicate records.\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 Returns: (number_of_files_generated, number_of_partitions)\r\n\u00a0 \u00a0 \u00a0 \u00a0 def _get_compare_pair(data_source, record_batch, file_format, col_id):\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 num_of_files_generated = _get_num_of_files_generated(\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 base_directory=data_source, file_format=file_format)\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 number_of_partitions = len(pa.compute.unique(record_batch[col_id]))\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return num_of_files_generated, number_of_partitions\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 # CASE 1: when max_open_files=default & max_open_files >= num_of_partitions\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 In case of a writing to disk via partitioning based on a\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 particular column (considering row labels in that column),\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 the number of unique rows must be equal\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 to the number of files generated\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 num_of_files_generated, number_of_partitions \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 = _get_compare_pair(data_source_1, record_batch_1, file_format,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 partition_column_id)\r\n\u00a0 \u00a0 \u00a0 \u00a0 assert num_of_files_generated == number_of_partitions\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 # CASE 2: when max_open_files > 0 & max_open_files < num_of_partitions\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 the number of files generated must be greater than the number of\r\n\u00a0 \u00a0 \u00a0 \u00a0 # \u00a0 \u00a0 \u00a0 \u00a0 partitions\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 data_source_2 = directory / \"max_1\"\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 max_open_files = 3\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 ds.write_dataset(data=table, base_dir=data_source_2,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0partitioning=partitioning, format=file_format,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0max_open_files=max_open_files)\r\n\u00a0 \u00a0\u00a0\r\n\u00a0 \u00a0 \u00a0 \u00a0 num_of_files_generated, number_of_partitions \\\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 = _get_compare_pair(data_source_2, record_batch_1, file_format,\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 partition_column_id)\r\n> \u00a0 \u00a0 \u00a0 assert num_of_files_generated > number_of_partitions\r\nE \u00a0 \u00a0 \u00a0 assert 5 > 5pyarrow/tests/test_dataset.py:3807: AssertionError\r\n {noformat}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Flaky test test_write_dataset_max_open_files",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481678",
                    "id": "17481678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "cc [~jorisvandenbossche]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2022-01-25T09:30:48.778+0000",
                    "updated": "2022-01-25T09:30:48.778+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481682",
                    "id": "17481682",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "This was added in ARROW-15019 (cc [~vibhatha])",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2022-01-25T09:37:41.759+0000",
                    "updated": "2022-01-25T09:37:41.759+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481686",
                    "id": "17481686",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~jorisvandenbossche] will take a look.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-25T09:41:54.949+0000",
                    "updated": "2022-01-25T09:41:54.949+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481751",
                    "id": "17481751",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I created a PR\r\n\r\n[~westonpace]\u00a0could this be happening due to the small data size?\u00a0\r\nI increased it and lowered the `max_open_files` and tested it.\u00a0\r\nSeems to be working, but can we fix this better. Am I missing something here?\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-25T11:28:56.433+0000",
                    "updated": "2022-01-25T11:29:07.634+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481829",
                    "id": "17481829",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "I also see this regularly on my local computer.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-01-25T13:43:23.497+0000",
                    "updated": "2022-01-25T13:43:23.497+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481833",
                    "id": "17481833",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~apitrou]\u00a0could it be due to the less data size?\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-25T13:49:37.435+0000",
                    "updated": "2022-01-25T13:49:37.435+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481834",
                    "id": "17481834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Since the intial data size was too small? What I did was increase it a little bit and reduce the `max_open_files`.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-25T13:50:11.122+0000",
                    "updated": "2022-01-25T13:50:11.122+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481856",
                    "id": "17481856",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "I have no idea. It may be timing-dependent?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-01-25T14:31:15.757+0000",
                    "updated": "2022-01-25T14:31:15.757+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481857",
                    "id": "17481857",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Is parallel writing enabled by default? If so, disabling it would probably make the test more robust.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-01-25T14:31:49.118+0000",
                    "updated": "2022-01-25T14:31:49.118+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17481868",
                    "id": "17481868",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Yes, most probably. I changed `use_threads`=False and reduced the `max_open_files` = 1 it reduces the low number of file generation to an extent.\u00a0\r\n\r\n\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-25T14:48:16.359+0000",
                    "updated": "2022-01-25T14:48:16.359+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17482100",
                    "id": "17482100",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Threading makes sense.  The WriteNode's InputReceived will be called 4 times (one per batch).  Each call will generate 5 calls to the dataset writer (one per partition in that batch).\r\n\r\nWe'd get more than 5 files if we get something like:\r\n\r\nB1P1, B1P2, B1P3, B1P4, B1P5, B2P1, ..., B4P5\r\n\r\nHowever, we'd only get 5 files if we get something like:\r\n\r\nB1P1, B2P1, B3P1, B4P1, B1P2, ... B4P5\r\n\r\nSince we scan the source in parallel both orders are possible.\r\n\r\n> Is parallel writing enabled by default? If so, disabling it would probably make the test more robust.\r\n\r\nThere is no easy way in the dataset writer to disable parallel writing (the CPU path is completely serial but it submits I/O tasks for each batch so you would need to shrink the I/O thread pool to size 1).\r\n\r\n>  I changed `use_threads`=False and reduced the `max_open_files` = 1 it reduces the low number of file generation to an extent. \r\n\r\nThis will disable parallel scanning which should be enough to prevent the flakiness (unless I am misunderstanding how the error is generated).  I'll try and setup a reproduction.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-25T20:46:46.731+0000",
                    "updated": "2022-01-25T20:46:46.731+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17482134",
                    "id": "17482134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I was able to reproduce fairly regularly and confirmed the issue was the order in which the batches were delivered to the dataset writer.  Unfortunately, we were also not completely respecting the {{use_threads}} option in {{write_dataset}}.  If {{use_threads=False}} then we would scan in serial but still send batches into the exec plan in parallel.  I added a new PR that sets {{use_threads=False}} (based on Vibhatha's PR) and also updates the Write method to be serial.\r\n\r\nI don't know if this bug should block the RC but if we cut another RC it would probably be nice to include.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-25T22:57:50.529+0000",
                    "updated": "2022-01-25T22:57:50.529+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17482140",
                    "id": "17482140",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "This is for the most part a flaky test, so while the fix is nice to have it shouldn't block the release IMHO.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-01-25T23:27:59.505+0000",
                    "updated": "2022-01-25T23:27:59.505+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13424539/comment/17483025",
                    "id": "17483025",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 12263\n[https://github.com/apache/arrow/pull/12263]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-01-27T10:01:59.982+0000",
                    "updated": "2022-01-27T10:01:59.982+0000"
                }
            ],
            "maxResults": 14,
            "total": 14,
            "startAt": 0
        },
        "customfield_12311820": "0|z0ywmw:",
        "customfield_12314139": null
    }
}