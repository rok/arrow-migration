{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13411345",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345",
    "key": "ARROW-14679",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available",
            "query-engine"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
            "name": "vibhatha",
            "key": "vibhatha",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
            },
            "displayName": "Vibhatha Lakmal Abeykoon",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
            "name": "jonkeane",
            "key": "jonkeane",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Jonathan Keane",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [
            {
                "id": "13419803",
                "key": "ARROW-15212",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/13419803",
                "fields": {
                    "summary": "[C++] Handle suffix argument in joins",
                    "status": {
                        "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                        "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                        "name": "Resolved",
                        "id": "5",
                        "statusCategory": {
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                            "id": 3,
                            "key": "done",
                            "colorName": "green",
                            "name": "Done"
                        }
                    },
                    "priority": {
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "name": "Major",
                        "id": "3"
                    },
                    "issuetype": {
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                        "id": "7",
                        "description": "The sub-task of the issue",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                        "name": "Sub-task",
                        "subtask": true,
                        "avatarId": 21146
                    }
                }
            }
        ],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
            "name": "jonkeane",
            "key": "jonkeane",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
            },
            "displayName": "Jonathan Keane",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 28200,
            "total": 28200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 19800,
            "total": 19800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14679/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 33,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/680441",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane opened a new pull request #11682:\nURL: https://github.com/apache/arrow/pull/11682\n\n\n   This is not working, needs more work in the hash join side.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-11T19:39:29.184+0000",
                    "updated": "2021-11-11T19:39:29.184+0000",
                    "started": "2021-11-11T19:39:29.184+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "680441",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/680442",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11682:\nURL: https://github.com/apache/arrow/pull/11682#issuecomment-966573387\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-11-11T19:39:51.973+0000",
                    "updated": "2021-11-11T19:39:51.973+0000",
                    "started": "2021-11-11T19:39:51.973+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "680442",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/726120",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#issuecomment-1038640117\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-14T04:52:07.199+0000",
                    "updated": "2022-02-14T04:52:07.199+0000",
                    "started": "2022-02-14T04:52:07.198+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726120",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/726592",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r806241299\n\n\n\n##########\nFile path: r/src/compute-exec.cpp\n##########\n@@ -217,7 +217,8 @@ std::shared_ptr<compute::ExecNode> ExecNode_Join(\n     const std::shared_ptr<compute::ExecNode>& input, int type,\n     const std::shared_ptr<compute::ExecNode>& right_data,\n     std::vector<std::string> left_keys, std::vector<std::string> right_keys,\n-    std::vector<std::string> left_output, std::vector<std::string> right_output) {\n+    std::vector<std::string> left_output, std::vector<std::string> right_output,\n+    std::string output_prefix_for_left, std::string output_prefix_for_right) {\n\nReview comment:\n       prefix -> suffix\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -143,8 +142,8 @@ test_that(\"Error handling\", {\n   )\n })\n \n-# TODO: test duplicate col names\n-# TODO: casting: int and float columns?\n+# # TODO: test duplicate col names\n+# # TODO: casting: int and float columns?\n\nReview comment:\n       ```suggestion\r\n   # TODO: test duplicate col names\r\n   # TODO: casting: int and float columns?\r\n   ```\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -278,7 +279,7 @@ ExecNode <- R6Class(\"ExecNode\",\n         ExecNode_Aggregate(self, options, target_names, out_field_names, key_names)\n       )\n     },\n-    Join = function(type, right_node, by, left_output, right_output) {\n+    Join = function(type, right_node, by, left_output, right_output, left_prefix, right_prefix) {\n\nReview comment:\n       prefix -> suffix\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -287,7 +288,9 @@ ExecNode <- R6Class(\"ExecNode\",\n           left_keys = names(by),\n           right_keys = by,\n           left_output = left_output,\n-          right_output = right_output\n+          right_output = right_output,\n+          output_prefix_for_left = left_prefix,\n\nReview comment:\n       prefix -> suffix\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-14T21:11:24.783+0000",
                    "updated": "2022-02-14T21:11:24.783+0000",
                    "started": "2022-02-14T21:11:24.782+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726592",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/726593",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r806242165\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -161,14 +160,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n+          right_output <- setdiff(names(.data$join$right_data), .data$join$by)\n           node <- node$Join(\n             type = .data$join$type,\n-            right_node = self$Build(.data$join$right_data),\n+            right_node = right_node,\n             by = .data$join$by,\n-            left_output = names(.data),\n-            right_output = setdiff(names(.data$join$right_data), .data$join$by)\n+            left_output = left_output,\n+            right_output = right_output,\n+            left_prefix = .data$join$suffix[[1]],\n+            right_prefix = .data$join$suffix[[2]]\n\nReview comment:\n       prefix -> suffix\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-14T21:11:47.350+0000",
                    "updated": "2022-02-14T21:11:47.350+0000",
                    "started": "2022-02-14T21:11:47.350+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726593",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/726748",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#issuecomment-1039722482\n\n\n   > I wasn't sure if your TODO task was meant to be finished or not so I noted the places where I saw prefix still in use.\r\n   \r\n   That\u2019s a modification still pending. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T00:40:07.816+0000",
                    "updated": "2022-02-15T00:40:07.816+0000",
                    "started": "2022-02-15T00:40:07.816+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726748",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/727386",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r806241299\n\n\n\n##########\nFile path: r/src/compute-exec.cpp\n##########\n@@ -217,7 +217,8 @@ std::shared_ptr<compute::ExecNode> ExecNode_Join(\n     const std::shared_ptr<compute::ExecNode>& input, int type,\n     const std::shared_ptr<compute::ExecNode>& right_data,\n     std::vector<std::string> left_keys, std::vector<std::string> right_keys,\n-    std::vector<std::string> left_output, std::vector<std::string> right_output) {\n+    std::vector<std::string> left_output, std::vector<std::string> right_output,\n+    std::string output_prefix_for_left, std::string output_prefix_for_right) {\n\nReview comment:\n       prefix -> suffix\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -143,8 +142,8 @@ test_that(\"Error handling\", {\n   )\n })\n \n-# TODO: test duplicate col names\n-# TODO: casting: int and float columns?\n+# # TODO: test duplicate col names\n+# # TODO: casting: int and float columns?\n\nReview comment:\n       ```suggestion\r\n   # TODO: test duplicate col names\r\n   # TODO: casting: int and float columns?\r\n   ```\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -278,7 +279,7 @@ ExecNode <- R6Class(\"ExecNode\",\n         ExecNode_Aggregate(self, options, target_names, out_field_names, key_names)\n       )\n     },\n-    Join = function(type, right_node, by, left_output, right_output) {\n+    Join = function(type, right_node, by, left_output, right_output, left_prefix, right_prefix) {\n\nReview comment:\n       prefix -> suffix\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -287,7 +288,9 @@ ExecNode <- R6Class(\"ExecNode\",\n           left_keys = names(by),\n           right_keys = by,\n           left_output = left_output,\n-          right_output = right_output\n+          right_output = right_output,\n+          output_prefix_for_left = left_prefix,\n\nReview comment:\n       prefix -> suffix\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -161,14 +160,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n+          right_output <- setdiff(names(.data$join$right_data), .data$join$by)\n           node <- node$Join(\n             type = .data$join$type,\n-            right_node = self$Build(.data$join$right_data),\n+            right_node = right_node,\n             by = .data$join$by,\n-            left_output = names(.data),\n-            right_output = setdiff(names(.data$join$right_data), .data$join$by)\n+            left_output = left_output,\n+            right_output = right_output,\n+            left_prefix = .data$join$suffix[[1]],\n+            right_prefix = .data$join$suffix[[2]]\n\nReview comment:\n       prefix -> suffix\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T18:46:37.212+0000",
                    "updated": "2022-02-15T18:46:37.212+0000",
                    "started": "2022-02-15T18:46:37.211+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727386",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/727401",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#issuecomment-1039722482\n\n\n   > I wasn't sure if your TODO task was meant to be finished or not so I noted the places where I saw prefix still in use.\r\n   \r\n   That\u2019s a modification still pending. \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T18:47:43.318+0000",
                    "updated": "2022-02-15T18:47:43.318+0000",
                    "started": "2022-02-15T18:47:43.317+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727401",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/737126",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on pull request #11682:\nURL: https://github.com/apache/arrow/pull/11682#issuecomment-1059787534\n\n\n   Closing in favor of #12113\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-05T15:58:54.742+0000",
                    "updated": "2022-03-05T15:58:54.742+0000",
                    "started": "2022-03-05T15:58:54.742+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "737126",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/737130",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#issuecomment-1059789949\n\n\n   working resolving some merge conflicts\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-05T16:13:58.814+0000",
                    "updated": "2022-03-05T16:13:58.814+0000",
                    "started": "2022-03-05T16:13:58.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "737130",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/739256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "westonpace commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r823289010\n\n\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n+        # helper function which adds the suffixes to the\n+        # selected column names\n+        # for join relation the selected columns are the\n+        # columns with same name in left and right relation\n+        col_names <- names(fields)\n+        new_col_names <- col_names %>% map(function(x) {\n+          if (is.element(x, common_cols)) {\n+            paste(x, suffix, sep = \"\")\n+          } else {\n+            x\n+          }\n+        })\n+        rlang::set_names(fields, new_col_names)\n\nReview comment:\n       I don't think the `rlang::` is needed here based on my scanning of where else `set_names` is used.\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n+        # helper function which adds the suffixes to the\n+        # selected column names\n+        # for join relation the selected columns are the\n+        # columns with same name in left and right relation\n+        col_names <- names(fields)\n+        new_col_names <- col_names %>% map(function(x) {\n+          if (is.element(x, common_cols)) {\n+            paste(x, suffix, sep = \"\")\n+          } else {\n+            x\n+          }\n+        })\n+        rlang::set_names(fields, new_col_names)\n+      }\n+      # adding suffixes to the common columns in left and right tables\n+      left_fields <- add_suffix(new_fields, common_cols, .data$join$suffix[[1]])\n\nReview comment:\n       I'm not sure this can be correct.  `new_fields` is not defined any longer.  Do you know if any of the tests exercise this path?  I don't really understand the purpose of the `implicit_schema` function.\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -19,7 +19,6 @@ do_exec_plan <- function(.data) {\n   plan <- ExecPlan$create()\n   final_node <- plan$Build(.data)\n   tab <- plan$Run(final_node)\n-\n\nReview comment:\n       Minor nit: Try and minimize unrelated whitespace-only changes when possible.\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n+        # helper function which adds the suffixes to the\n+        # selected column names\n+        # for join relation the selected columns are the\n+        # columns with same name in left and right relation\n+        col_names <- names(fields)\n+        new_col_names <- col_names %>% map(function(x) {\n+          if (is.element(x, common_cols)) {\n+            paste(x, suffix, sep = \"\")\n\nReview comment:\n       ```suggestion\r\n               paste0(x, suffix)\r\n   ```\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -166,14 +165,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n\nReview comment:\n       Why aren't we doing `setdiff(names(.data), .data$join$by)`?  It's possible I just don't understand but it seems like both sides would have the `by` columns.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-10T03:02:26.853+0000",
                    "updated": "2022-03-10T03:02:26.853+0000",
                    "started": "2022-03-10T03:02:26.853+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739256",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/739589",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r823923555\n\n\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n+        # helper function which adds the suffixes to the\n+        # selected column names\n+        # for join relation the selected columns are the\n+        # columns with same name in left and right relation\n+        col_names <- names(fields)\n+        new_col_names <- col_names %>% map(function(x) {\n+          if (is.element(x, common_cols)) {\n+            paste(x, suffix, sep = \"\")\n+          } else {\n+            x\n+          }\n+        })\n+        rlang::set_names(fields, new_col_names)\n+      }\n+      # adding suffixes to the common columns in left and right tables\n+      left_fields <- add_suffix(new_fields, common_cols, .data$join$suffix[[1]])\n\nReview comment:\n       I think it's defined up above on 103. The tests that exercise `implicit_schema` are at https://github.com/apache/arrow/blob/dfca6a704ad7e8e87e1c8c3d0224ba13b25786ea/r/tests/testthat/test-dplyr-collapse.R#L34-L87\r\n   \r\n   It would be fantastic to get a few of these joins to those tests too.\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n\nReview comment:\n       We also could move this to the top level of the file. That's more typical for helpers like this (and that'll mean we can test it separately if we wanted to). \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-10T16:39:18.723+0000",
                    "updated": "2022-03-10T16:39:18.723+0000",
                    "started": "2022-03-10T16:39:18.723+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739589",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/739599",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r823933696\n\n\n\n##########\nFile path: r/R/dplyr-collect.R\n##########\n@@ -103,10 +104,37 @@ implicit_schema <- function(.data) {\n     if (!is.null(.data$join) && !(.data$join$type %in% JoinType[1:4])) {\n       # Add cols from right side, except for semi/anti joins\n       right_cols <- .data$join$right_data$selected_columns\n-      new_fields <- c(new_fields, map(\n+      left_cols <- .data$selected_columns\n+      right_fields <- map(\n         right_cols[setdiff(names(right_cols), .data$join$by)],\n         ~ .$type(.data$join$right_data$.data$schema)\n-      ))\n+      )\n+      # get right table and left table column names excluding the join key\n+      right_cols_ex_by <- right_cols[setdiff(names(right_cols), .data$join$by)]\n+      left_cols_ex_by <- left_cols[setdiff(names(left_cols), .data$join$by)]\n+      # find the common column names in left and right tables\n+      common_cols <- intersect(names(right_cols_ex_by), names(left_cols_ex_by))\n+\n+      # helper method to add suffix\n+      add_suffix <- function(fields, common_cols, suffix) {\n\nReview comment:\n       Sure @jonkeane we can make that change. I originally wrote it that way, since it may not be used I put it into the call. But I can extract it and add a few test cases. That sounds good. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-10T16:47:16.426+0000",
                    "updated": "2022-03-10T16:47:16.426+0000",
                    "started": "2022-03-10T16:47:16.426+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739599",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/739601",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r823933982\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -166,14 +165,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n\nReview comment:\n       I will take a look at this one. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-10T16:47:31.496+0000",
                    "updated": "2022-03-10T16:47:31.496+0000",
                    "started": "2022-03-10T16:47:31.496+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739601",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/739609",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r823941962\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -248,6 +247,26 @@ test_that(\"arrow dplyr query correctly filters then joins\", {\n   )\n })\n \n+test_that(\"suffix\", {\n+  left_suf <- Table$create(\n+    key = c(1, 2),\n+    left_unique = c(2.1, 3.1),\n+    shared = c(10.1, 10.3)\n+  )\n+\n+  right_suf <- Table$create(\n+    key = c(1, 2, 3, 10, 20),\n+    right_unique = c(1.1, 1.2, 3.1, 4.1, 4.3),\n+    shared = c(20.1, 30, 40, 50, 60)\n+  )\n+\n+  join_op <- inner_join(left_suf, right_suf, by = \"key\", suffix = c(\"_left\", \"_right\"))\n+  output <- collect(join_op)\n+  res_col_names <- names(output)\n+  expected_col_names <- c(\"key\", \"left_unique\", \"shared_left\", \"right_unique\", \"shared_right\")\n+  expect_equal(expected_col_names, res_col_names)\n+})\n\nReview comment:\n       We should also try a version where we summarize first and then join (because of how the flow in implicit schema works):\r\n   \r\n   Something like:\r\n   \r\n   ```\r\n   left_suf <- Table$create(\r\n       key = c(1, 2, 1, 2),\r\n       left_unique = c(2.1, 3.1, 4.1, 6.1),\r\n       shared = c(10.1, 10.3, 10.2, 10.4)\r\n     )\r\n   \r\n     right_suf <- Table$create(\r\n       key = c(1, 2, 3, 10, 20),\r\n       right_unique = c(1.1, 1.2, 3.1, 4.1, 4.3),\r\n       shared = c(20.1, 30, 40, 50, 60)\r\n     )\r\n   \r\n   \r\n    joined <- left_suf %>%\r\n       group_by(key) %>%\r\n       summarize(left_unique = mean(left_unique), shared = mean(shared)) %>%\r\n       inner_join(right_suf, by = \"key\", suffix = c(\"_left\", \"_right\"))\r\n     \r\n     output <- collect(joined)\r\n     res_col_names <- names(output)\r\n     expected_col_names <- c(\"key\", \"left_unique\", \"shared_left\", \"right_unique\", \"shared_right\")\r\n     expect_equal(expected_col_names, res_col_names)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-10T16:55:32.282+0000",
                    "updated": "2022-03-10T16:55:32.282+0000",
                    "started": "2022-03-10T16:55:32.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "739609",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/741389",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r826508187\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -166,14 +165,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n\nReview comment:\n       I am not 100% understand why. I didn't change that line, but I added a few variables for readability of the code that's why it reflects as a change. But for my curiosity I made the change you requested, it breaks a few test cases when we do it like that. In this modification, I only inserted the prefix field and the suffix field.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-15T01:38:41.275+0000",
                    "updated": "2022-03-15T01:38:41.275+0000",
                    "started": "2022-03-15T01:38:41.275+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "741389",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/741390",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r826508187\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -166,14 +165,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n\nReview comment:\n       I do not 100% understand why. I didn't change that line, but I added a few variables for readability of the code that's why it reflects as a change. But for my curiosity I made the change you requested, it breaks a few test cases when we do it like that. In this modification, I only inserted the prefix field and the suffix field.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-15T01:39:13.656+0000",
                    "updated": "2022-03-15T01:39:13.656+0000",
                    "started": "2022-03-15T01:39:13.655+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "741390",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/741392",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r826508644\n\n\n\n##########\nFile path: r/R/query-engine.R\n##########\n@@ -166,14 +165,18 @@ ExecPlan <- R6Class(\"ExecPlan\",\n         # (as when we've done collapse() and not projected after) is cheap/no-op\n         projection <- c(.data$selected_columns, .data$temp_columns)\n         node <- node$Project(projection)\n-\n         if (!is.null(.data$join)) {\n+          right_node <- self$Build(.data$join$right_data)\n+          left_output <- names(.data)\n\nReview comment:\n       I am going to take a look inside and see why is that. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-15T01:39:52.956+0000",
                    "updated": "2022-03-15T01:39:52.956+0000",
                    "started": "2022-03-15T01:39:52.956+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "741392",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/741428",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r826566647\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -248,6 +247,26 @@ test_that(\"arrow dplyr query correctly filters then joins\", {\n   )\n })\n \n+test_that(\"suffix\", {\n+  left_suf <- Table$create(\n+    key = c(1, 2),\n+    left_unique = c(2.1, 3.1),\n+    shared = c(10.1, 10.3)\n+  )\n+\n+  right_suf <- Table$create(\n+    key = c(1, 2, 3, 10, 20),\n+    right_unique = c(1.1, 1.2, 3.1, 4.1, 4.3),\n+    shared = c(20.1, 30, 40, 50, 60)\n+  )\n+\n+  join_op <- inner_join(left_suf, right_suf, by = \"key\", suffix = c(\"_left\", \"_right\"))\n+  output <- collect(join_op)\n+  res_col_names <- names(output)\n+  expected_col_names <- c(\"key\", \"left_unique\", \"shared_left\", \"right_unique\", \"shared_right\")\n+  expect_equal(expected_col_names, res_col_names)\n+})\n\nReview comment:\n       @jonkeane I added this case 1:1, I can write a few if needed. What should be the best?  \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-15T04:17:45.224+0000",
                    "updated": "2022-03-15T04:17:45.224+0000",
                    "started": "2022-03-15T04:17:45.224+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "741428",
                    "issueId": "13411345"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/worklog/741429",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vibhatha commented on a change in pull request #12113:\nURL: https://github.com/apache/arrow/pull/12113#discussion_r826566930\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-join.R\n##########\n@@ -248,6 +247,26 @@ test_that(\"arrow dplyr query correctly filters then joins\", {\n   )\n })\n \n+test_that(\"suffix\", {\n+  left_suf <- Table$create(\n+    key = c(1, 2),\n+    left_unique = c(2.1, 3.1),\n+    shared = c(10.1, 10.3)\n+  )\n+\n+  right_suf <- Table$create(\n+    key = c(1, 2, 3, 10, 20),\n+    right_unique = c(1.1, 1.2, 3.1, 4.1, 4.3),\n+    shared = c(20.1, 30, 40, 50, 60)\n+  )\n+\n+  join_op <- inner_join(left_suf, right_suf, by = \"key\", suffix = c(\"_left\", \"_right\"))\n+  output <- collect(join_op)\n+  res_col_names <- names(output)\n+  expected_col_names <- c(\"key\", \"left_unique\", \"shared_left\", \"right_unique\", \"shared_right\")\n+  expect_equal(expected_col_names, res_col_names)\n+})\n\nReview comment:\n       Also I added a test case covering the `implicit_schema`. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-15T04:18:37.710+0000",
                    "updated": "2022-03-15T04:18:37.710+0000",
                    "started": "2022-03-15T04:18:37.710+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "741429",
                    "issueId": "13411345"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 19800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@280c0e6e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@786a1e60[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1524cbf7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3d154e2d[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5673a320[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1529d9c2[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2661c3e3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@31129524[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a334a85[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@210f7bc8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@9d9dad1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2c47c57b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 28200,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Mar 21 16:22:08 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-03-21T16:22:08.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14679/watchers",
            "watchCount": 5,
            "isWatching": false
        },
        "created": "2021-11-11T18:53:51.000+0000",
        "updated": "2022-04-18T14:49:25.000+0000",
        "timeoriginalestimate": null,
        "description": "If there is a name collision, we need to do something https://github.com/apache/arrow/blob/a3746040d8a3ddb84bab6c7ca4771b6c120e3444/r/R/dplyr-join.R#L31\r\n\r\nA few notes:\r\n* arrow doesn't seem to actually be able to apply the prefixes (I'm getting errors when trying), I couldn't tell if there were tests of this \u2014 I couldn't find any, so I'm not sure if I'm calling this wrong or if it's not working at all.\r\n* arrow always appends the affixes (where as dplyr only adds them if there is a name collision)\r\n* arrow only supports prefixes (can we configure this, or ask the clients to provide new names?) in the tests I wrote I've worked around this, but it would be nice to be able to match dplyr/allow things other than prefix\r\n",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 19800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] [C++] Handle suffix argument in joins",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17442427",
                    "id": "17442427",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I've uploaded my tests to show the failures. Feel free to either push changes to this branch, pull these tests into a new branch, or ignore them entirely.\r\n\r\nhttps://github.com/apache/arrow/pull/11682",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-11-11T19:39:45.676+0000",
                    "updated": "2021-11-11T19:39:45.676+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17451465",
                    "id": "17451465",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "[~jonkeane]I see a PR with purely R code.  Are C++ changes needed here?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-12-01T01:51:01.237+0000",
                    "updated": "2021-12-01T01:51:01.237+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17451466",
                    "id": "17451466",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "CC [~sakras] [~michalno]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-12-01T01:51:56.562+0000",
                    "updated": "2021-12-01T01:51:56.562+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17455278",
                    "id": "17455278",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "> I see a PR with purely R code. Are C++ changes needed here?\r\n\r\nThe PR only has failing tests. The changes will mostly (all?) need to on the C++ side. Feel free to close that PR and start a new branch, or pull from it (or push to it), whichever is easier!",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-08T14:33:25.982+0000",
                    "updated": "2021-12-08T14:33:25.982+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17466688",
                    "id": "17466688",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~jonkeane] [~westonpace]\u00a0\r\nIs the intent here is to match the dplyr R API for joins (left_join, inner_join, ...) match with the Arrow R join APIs?\u00a0\r\n\r\nA note on this, when looking into Pandas (join, merge) and deplyr (join), there is no concept called prefix, they only provide suffix. I guess this is a standard followed. But in our source we have prefixes. Should this be the first thing to fix, use suffix within C++ code instead of prefix and make it available to the other language bindings?\u00a0\r\n\r\nI want to make sure whether I have understood this correctly. For now I went throught the code base and see how it is being done. A related but not a direct issue is that, when we read the output from a join (given that we are using the execplan and a sink node to get the response out), we still have to provide a schema, so no matter which affix we use, the output table will have the name we provide as the schema. It is a bit bothering given that the schema should be sort of inferred with the given input data, but give user an opportunity to project what is needed. It is not clear how to grasp this idea clearly. Or is there a way to do the joins without using the ExecPlan by just calling the kernel (just curious are we exposing this kind of a functionality given an advance user just needs the join kernel and use their own dataflow model to move data among operators). May be I am not 100% familiary with the current approach, but just wanted to make a note about this.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-30T05:18:45.416+0000",
                    "updated": "2021-12-30T05:20:46.808+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17466957",
                    "id": "17466957",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "bq. Is the intent here is to match the dplyr R API for joins (left_join, inner_join, ...) match with the Arrow R join APIs? \r\n\r\nI would like to be able to match the dplyr API if possible. We can deviate from it if we have to for some reason (and we can also do some pre/post processing in R if we need to: e.g. rename columns in a project after the join)\r\n\r\nbq. A note on this, when looking into Pandas (join, merge) and deplyr (join), there is no concept called prefix, they only provide suffix\r\n\r\nYeah, suffix seems more right to me (if we only support one), though I will admit I haven't surveyed other systems to see what they use (many SQLs, you'ld need to reference the table as a prefiex (e.g. {{left_table.col AS col_new}} or the like). I tried to find what ibis does, but https://ibis-project.org/docs/generated/ibis.expr.api.TableExpr.inner_join.html doesn't have much info about that (that might be the wrong place to look for that too!). Would it make sense to make the choice of suffix/prefix an option? (that is not intended as a leading question \u2014 I'm not sure if the trade off of complexity is worth it here!)\r\n\r\nbq. A related but not a direct issue is that, when we read the output from a join (given that we are using the execplan and a sink node to get the response out), we still have to provide a schema, so no matter which affix we use, the output table will have the name we provide as the schema. It is a bit bothering given that the schema should be sort of inferred with the given input data, but give user an opportunity to project what is needed. \r\n\r\nHmmm maybe this is what I was running into when I couldn't get the prefixes to work at all (the tests on my branch). I haven't been able to trigger this feature successfully at all myself.\r\n\r\nI'm happy to split this into separate issues if that's easier (though I'm not totally sure that it's necessary), but there are three issues here that we should resolve:\r\n\r\n* Be able to successfully join two tables with columns that have the same names (but aren't used as keys). \r\n* Be able to only add the unique-name-making affixes to the columns that are duplicated (if I have two tables with the cols: [id, col_a, col_b] and [id, col_b, col_c, col_d] and I join them (with the key being id, I should get [id, col_a, col_b.x, col_b.y, col_c, col_d] (or the prefix version with x.col_b, y.col_b if we allow prefixes)\r\n* Be able to use suffixes\r\n\r\n\r\n\r\n\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-30T18:20:58.719+0000",
                    "updated": "2021-12-30T18:22:05.740+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17467099",
                    "id": "17467099",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "\" I'm happy to split this into separate issues if that's easier (though I'm not totally sure that it's necessary), but there are three issues here that we should resolve:\"\r\n\r\n> Yes, the subtask was just added to make it neater, but that is very optional :)\u00a0\r\n\r\n\u00a0\r\n * \"Be able to successfully join two tables with columns that have the same names (but aren't used as keys).\"\r\n\r\n * \r\n ** > I think the Pandas.merge is the expected functionality (please comment [~westonpace]\u00a0, [~jonkeane]).\u00a0\r\n * Be able to only add the unique-name-making affixes to the columns that are duplicated (if I have two tables with the cols: [id, col_a, col_b] and [id, col_b, col_c, col_d] and I join them (with the key being id, I should get [id, col_a, col_b.x, col_b.y, col_c, col_d] (or the prefix version with x.col_b, y.col_b if we allow prefixes)\r\n ** > First we need to decide whether to keep prefix or suffix. Having both doesn't make sense (my point of view) and it could be very confusing when we handle the case in the code. So we need to decide what option we need to expose. If we go for suffixes as Pandas is doing, we need to avoid using prefixes in the C++ core and replace it with suffixes. The related functionality change is trivial, but if we have already exposed this to multiple languages we have to change those function signatures and test cases. But there is another way, we can do a schema refactor just after getting the join respone and do a string comparison and do it in the R level, but that would be very untidy and hard to maintain.\u00a0\r\n * \"Be able to use suffixes\"\r\n> +1 for this and I suggest dropping prefix if it is possible and be consistent with the R stack and Pandas stack since most users are familar with suffixes.\r\n\r\n\"\r\n\r\n\u00a0\r\n\r\nPandas Example\r\n\r\n-----------------\u00a0 \u00a0\r\n{code:java}\r\n    import pandas as pd\r\n\r\n    df_l = pd.DataFrame({\"id\": [10, 20, 30, 40, 50, 10, 30],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"a\": [11, 12, 14, 14, 15, 16, 17],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"b\": [1, 2, 3, 4, 5, 6, 7]\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 })\r\n\u00a0\u00a0 \u00a0\r\n\u00a0 \u00a0 df_r = pd.DataFrame({\"id\": [10, 10, 12, 41, 51, 20, 30],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"a\": [21, 22, 24, 24, 25, 26, 27],\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"c\": [1, 2, 3, 4, 5, 6, 7]\r\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 })\r\n\u00a0\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\r\n\u00a0 \u00a0 print(df_l)\r\n\u00a0 \u00a0 print(\"-------------\")\r\n\u00a0 \u00a0 print(df_r)\r\n\u00a0\u00a0 \u00a0\r\n\u00a0 \u00a0 df_join = df_l.merge(df_r, on=\"id\", how=\"inner\", suffixes=(\".x\", \".y\"))\r\n\u00a0\u00a0 \u00a0\r\n\u00a0 \u00a0 print(df_join)\r\n\u00a0\u00a0 \u00a0\r\n\u00a0 \u00a0 \"\"\"\r\n\u00a0 \u00a0 Output:\r\n\u00a0\u00a0 \u00a0 \u00a0 id\u00a0 a.x\u00a0 b\u00a0 a.y\u00a0 c\r\n\u00a0 \u00a0 0\u00a0 10 \u00a0 11\u00a0 1 \u00a0 21\u00a0 1\r\n\u00a0 \u00a0 1\u00a0 10 \u00a0 11\u00a0 1 \u00a0 22\u00a0 2\r\n\u00a0 \u00a0 2\u00a0 10 \u00a0 16\u00a0 6 \u00a0 21\u00a0 1\r\n\u00a0 \u00a0 3\u00a0 10 \u00a0 16\u00a0 6 \u00a0 22\u00a0 2\r\n\u00a0 \u00a0 4\u00a0 20 \u00a0 12\u00a0 2 \u00a0 26\u00a0 6\r\n\u00a0 \u00a0 5\u00a0 30 \u00a0 14\u00a0 3 \u00a0 27\u00a0 7\r\n\u00a0 \u00a0 6\u00a0 30 \u00a0 17\u00a0 7 \u00a0 27\u00a0 7\r\n\u00a0 \u00a0 \"\"\"\r\n{code}\r\n\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-31T04:52:21.541+0000",
                    "updated": "2021-12-31T04:53:04.130+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17467277",
                    "id": "17467277",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Oh, I hadn't seen the subtask, oops. That's also a nice way to track the components, thanks for doing that!\r\n\r\nAnd looking at the pandas behavior that's what dplyr does as well \u2014 so I would say since both of those languages do it that way we should follow that.\r\n\r\nAs to if the prefix has already been exposed: technically it has, but I'm not actually certain any of the bindings have taken advantage of it (and honestly I'm not even certain it works completely). We could make the change to suffixes and then see if any tests fail (I don't think there are any C++ tests for this functionality \u2014 at least I haven't been able to find them, and the R tests on my branch fail already).  ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-12-31T15:43:42.014+0000",
                    "updated": "2021-12-31T15:43:42.014+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17467350",
                    "id": "17467350",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Great, let\u2019s first check it\u2019s usage and exposure in other languages or components and come up with test cases. Then incrementally will replace component by component.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-01T00:06:15.319+0000",
                    "updated": "2022-01-01T00:06:15.319+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17468872",
                    "id": "17468872",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I spoke with [~michalno] offline today and he confirmed that the current prefix decision was arbitrary so I agree we should just move over to suffix.  All exec node APIs are \"experimental\" so even if the prefix term has been exposed it shouldn't be a big issue to switch.  Let's not worry too much over it.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-04T21:55:44.859+0000",
                    "updated": "2022-01-04T21:55:44.859+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17468955",
                    "id": "17468955",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "I created a unit test to play around and observe the behavior.  [~vibhatha] can you include something like this (I'll put it at the end) in your PR?\r\n\r\n[~jonkeane] I observed some of the same things you observed:\r\n\r\n{quote}arrow doesn't seem to actually be able to apply the prefixes (I'm getting errors when trying), I couldn't tell if there were tests of this \u2014 I couldn't find any, so I'm not sure if I'm calling this wrong or if it's not working at all.{quote}\r\n\r\nI did not experience this.  The unit test appears to be working.\r\n\r\n{quote}arrow always appends the affixes (where as dplyr only adds them if there is a name collision){quote}\r\n\r\nYes, I noticed this as well.  If I understand correctly your desired behavior is:\r\n\r\n* If a column name is distinct between the two inputs then use the column name as-is.\r\n* If a column name is shared between the two inputs then attach the suffix to both output column names\r\n\r\nIn other words, if {{key, shared, left}} is joined with {{key, shared, right}} on {{key}} with suffixes {{_L, _R}} then the output would be {{key_L, shared_L, left, key_R, shared_R, right}}.\r\n\r\n{quote}arrow only supports prefixes...{quote}\r\n\r\nAs mentioned earlier I agree to moving to suffixes.\r\n\r\n-I also noticed one other issue.  The affix is not currently attached to key columns.  I assume this is desired as well (assuming the key column has the same name).-\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-05T02:09:32.504+0000",
                    "updated": "2022-01-05T02:16:00.887+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17468957",
                    "id": "17468957",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Forgot to add the unit test:\r\n\r\n{code}\r\nTEST(HashJoin, Prefix) {\r\n  BatchesWithSchema input_left;\r\n  input_left.batches = {ExecBatchFromJSON({int32(), int32(), int32()}, R\"([\r\n                   [1, 4, 7],\r\n                   [2, 5, 8],\r\n                   [3, 6, 9]\r\n                 ])\")};\r\n  input_left.schema = schema(\r\n      {field(\"lkey\", int32()), field(\"shared\", int32()), field(\"ldistinct\", int32())});\r\n\r\n  BatchesWithSchema input_right;\r\n  input_right.batches = {ExecBatchFromJSON({int32(), int32(), int32()}, R\"([\r\n                   [1, 10, 13],\r\n                   [2, 11, 14],\r\n                   [3, 12, 15]\r\n                 ])\")};\r\n  input_right.schema = schema(\r\n      {field(\"rkey\", int32()), field(\"shared\", int32()), field(\"rdistinct\", int32())});\r\n\r\n  BatchesWithSchema expected;\r\n  expected.batches = {\r\n      ExecBatchFromJSON({int32(), int32(), int32(), int32(), int32(), int32()}, R\"([\r\n    [1, 4, 7, 1, 10, 13],\r\n    [2, 5, 8, 2, 11, 14],\r\n    [3, 6, 9, 3, 12, 15]\r\n  ])\")};\r\n  // This is the current behavior, not the desired behavior.  Ideally it should be\r\n  // lkey, ldistinct, rkey, and rdistinct and NOT l_lkey, l_ldistinct, r_rkey, and\r\n  // r_rdistinct.  The l_shared and r_shared is correct.\r\n  expected.schema = schema({field(\"l_lkey\", int32()), field(\"l_shared\", int32()),\r\n                            field(\"l_ldistinct\", int32()), field(\"r_rkey\", int32()),\r\n                            field(\"r_shared\", int32()), field(\"r_rdistinct\", int32())});\r\n\r\n  ExecContext exec_ctx;\r\n\r\n  ASSERT_OK_AND_ASSIGN(auto plan, ExecPlan::Make(&exec_ctx));\r\n  AsyncGenerator<util::optional<ExecBatch>> sink_gen;\r\n\r\n  ExecNode* left_source;\r\n  ExecNode* right_source;\r\n  ASSERT_OK_AND_ASSIGN(\r\n      left_source,\r\n      MakeExecNode(\"source\", plan.get(), {},\r\n                   SourceNodeOptions{input_left.schema,\r\n                                     input_left.gen(/*parallel=*/true, /*slow=*/false)}));\r\n\r\n  ASSERT_OK_AND_ASSIGN(\r\n      right_source,\r\n      MakeExecNode(\"source\", plan.get(), {},\r\n                   SourceNodeOptions{input_right.schema,\r\n                                     input_right.gen(/*parallel=*/true, /*slow=*/false)}))\r\n\r\n  HashJoinNodeOptions join_opts{JoinType::INNER,\r\n                                /*left_keys=*/{\"lkey\"},\r\n                                /*right_keys=*/{\"rkey\"}, literal(true), \"l_\", \"r_\"};\r\n\r\n  ASSERT_OK_AND_ASSIGN(\r\n      auto hashjoin,\r\n      MakeExecNode(\"hashjoin\", plan.get(), {left_source, right_source}, join_opts));\r\n\r\n  ASSERT_OK_AND_ASSIGN(std::ignore, MakeExecNode(\"sink\", plan.get(), {hashjoin},\r\n                                                 SinkNodeOptions{&sink_gen}));\r\n\r\n  ASSERT_FINISHES_OK_AND_ASSIGN(auto result, StartAndCollect(plan.get(), sink_gen));\r\n\r\n  AssertExecBatchesEqual(expected.schema, expected.batches, result);\r\n  AssertSchemaEqual(expected.schema, hashjoin->output_schema());\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-05T02:14:57.644+0000",
                    "updated": "2022-01-05T02:17:33.729+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17468958",
                    "id": "17468958",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "{quote}I also noticed one other issue. The affix is not currently attached to key columns. I assume this is desired as well (assuming the key column has the same name).{quote}\r\n\r\nLooking more closely I see I was wrong about this.  The affix is being applied to key columns.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=westonpace",
                        "name": "westonpace",
                        "key": "westonpace",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Weston Pace",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-01-05T02:15:42.350+0000",
                    "updated": "2022-01-05T02:15:42.350+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17470260",
                    "id": "17470260",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "By the way, I am going to add an join example explicity in addition to the join related example in the streaming execution engine. The reason is most people are looking for joins. Is it okay to do that as well?\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-07T00:19:29.656+0000",
                    "updated": "2022-01-07T00:19:29.656+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17470261",
                    "id": "17470261",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~westonpace]\u00a0I added the test case, and will modify once the suffixes are properly added.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-07T00:20:09.257+0000",
                    "updated": "2022-01-07T00:20:09.257+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17471648",
                    "id": "17471648",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~westonpace],\u00a0created a PR for [C++] Handle suffix argument in joins",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-01-10T03:00:12.829+0000",
                    "updated": "2022-01-10T03:00:12.829+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17476166",
                    "id": "17476166",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "Postponing it to 8.0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2022-01-14T14:21:34.056+0000",
                    "updated": "2022-01-14T14:21:34.056+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17491796",
                    "id": "17491796",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~jonkeane] [~westonpace] I updated the PR since the sub-task is merged.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=vibhatha",
                        "name": "vibhatha",
                        "key": "vibhatha",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34044",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34044",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34044",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34044"
                        },
                        "displayName": "Vibhatha Lakmal Abeykoon",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-14T05:08:44.113+0000",
                    "updated": "2022-02-14T05:08:44.113+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13411345/comment/17509981",
                    "id": "17509981",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 12113\n[https://github.com/apache/arrow/pull/12113]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-03-21T16:22:08.949+0000",
                    "updated": "2022-03-21T16:22:08.949+0000"
                }
            ],
            "maxResults": 19,
            "total": 19,
            "startAt": 0
        },
        "customfield_12311820": "0|z0wntk:",
        "customfield_12314139": null
    }
}