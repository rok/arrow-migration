{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13345835",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835",
    "key": "ARROW-10900",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348823",
                "id": "12348823",
                "description": "",
                "name": "3.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-01-25"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rdettai",
            "name": "rdettai",
            "key": "rdettai",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=rdettai&avatarId=42994",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rdettai&avatarId=42994",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rdettai&avatarId=42994",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rdettai&avatarId=42994"
            },
            "displayName": "R\u00e9mi Dettai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rdettai",
            "name": "rdettai",
            "key": "rdettai",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=rdettai&avatarId=42994",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rdettai&avatarId=42994",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rdettai&avatarId=42994",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rdettai&avatarId=42994"
            },
            "displayName": "R\u00e9mi Dettai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=rdettai",
            "name": "rdettai",
            "key": "rdettai",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=rdettai&avatarId=42994",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=rdettai&avatarId=42994",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=rdettai&avatarId=42994",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=rdettai&avatarId=42994"
            },
            "displayName": "R\u00e9mi Dettai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 4200,
            "total": 4200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 4200,
            "total": 4200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10900/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 7,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/523954",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#issuecomment-744532747\n\n\n   >Not sure what you mean here!\r\n   \r\n   I meant `TableSource` :/\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-14T15:54:36.255+0000",
                    "updated": "2020-12-14T15:54:36.255+0000",
                    "started": "2020-12-14T15:54:36.255+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "523954",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/523956",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#issuecomment-744533089\n\n\n   https://issues.apache.org/jira/browse/ARROW-10900\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-14T15:55:10.858+0000",
                    "updated": "2020-12-14T15:55:10.858+0000",
                    "started": "2020-12-14T15:55:10.858+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "523956",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/524236",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "waynexia commented on a change in pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#discussion_r543037102\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/builder.rs\n##########\n@@ -90,77 +75,51 @@ impl LogicalPlanBuilder {\n         options: CsvReadOptions,\n         projection: Option<Vec<usize>>,\n     ) -> Result<Self> {\n-        let schema: Schema = match options.schema {\n-            Some(s) => s.to_owned(),\n-            None => CsvFile::try_new(path, options)?\n-                .schema()\n-                .as_ref()\n-                .to_owned(),\n-        };\n-\n-        let projected_schema = projection\n-            .map(|p| Schema::new(p.iter().map(|i| schema.field(*i).clone()).collect()))\n-            .map_or(SchemaRef::new(schema), SchemaRef::new)\n-            .to_dfschema_ref()?;\n-\n         let provider = Arc::new(CsvFile::try_new(path, options)?);\n-        let schema = provider.schema();\n-\n-        let table_scan = LogicalPlan::TableScan {\n-            schema_name: \"\".to_string(),\n-            source: TableSource::FromProvider(provider),\n-            table_schema: schema,\n-            projected_schema,\n-            projection: None,\n-        };\n-\n-        Ok(Self::from(&table_scan))\n+        Self::scan(\"\", provider, projection)\n     }\n \n     /// Scan a Parquet data source\n     pub fn scan_parquet(path: &str, projection: Option<Vec<usize>>) -> Result<Self> {\n         let provider = Arc::new(ParquetTable::try_new(path)?);\n+        Self::scan(\"\", provider, projection)\n+    }\n+\n+    /// Scan an empty data source, mainly used in tests\n+    pub fn scan_empty(\n+        name: &str,\n\nReview comment:\n       Maybe we can remove this parameter and provide `scan()` a placeholder like `\"\"`?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-15T04:28:58.927+0000",
                    "updated": "2020-12-15T04:28:58.927+0000",
                    "started": "2020-12-15T04:28:58.927+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "524236",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/524407",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "rdettai commented on a change in pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#discussion_r543331995\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/builder.rs\n##########\n@@ -90,77 +75,51 @@ impl LogicalPlanBuilder {\n         options: CsvReadOptions,\n         projection: Option<Vec<usize>>,\n     ) -> Result<Self> {\n-        let schema: Schema = match options.schema {\n-            Some(s) => s.to_owned(),\n-            None => CsvFile::try_new(path, options)?\n-                .schema()\n-                .as_ref()\n-                .to_owned(),\n-        };\n-\n-        let projected_schema = projection\n-            .map(|p| Schema::new(p.iter().map(|i| schema.field(*i).clone()).collect()))\n-            .map_or(SchemaRef::new(schema), SchemaRef::new)\n-            .to_dfschema_ref()?;\n-\n         let provider = Arc::new(CsvFile::try_new(path, options)?);\n-        let schema = provider.schema();\n-\n-        let table_scan = LogicalPlan::TableScan {\n-            schema_name: \"\".to_string(),\n-            source: TableSource::FromProvider(provider),\n-            table_schema: schema,\n-            projected_schema,\n-            projection: None,\n-        };\n-\n-        Ok(Self::from(&table_scan))\n+        Self::scan(\"\", provider, projection)\n     }\n \n     /// Scan a Parquet data source\n     pub fn scan_parquet(path: &str, projection: Option<Vec<usize>>) -> Result<Self> {\n         let provider = Arc::new(ParquetTable::try_new(path)?);\n+        Self::scan(\"\", provider, projection)\n+    }\n+\n+    /// Scan an empty data source, mainly used in tests\n+    pub fn scan_empty(\n+        name: &str,\n\nReview comment:\n       This is what I did originally, to match the other similar methods in the block (`scan_csv`, `scan_memory`...). But this one is used by many tests in the codebase, and often they are using names, so we would have needed to edit asserts all over the place. I find that it does not do much harm to leave the it here, but if there is a consensus on the fact that its better removed, I don't mind! \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-15T13:16:44.410+0000",
                    "updated": "2020-12-15T13:16:44.410+0000",
                    "started": "2020-12-15T13:16:44.409+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "524407",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/524555",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "waynexia commented on a change in pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#discussion_r543513945\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/builder.rs\n##########\n@@ -90,77 +75,51 @@ impl LogicalPlanBuilder {\n         options: CsvReadOptions,\n         projection: Option<Vec<usize>>,\n     ) -> Result<Self> {\n-        let schema: Schema = match options.schema {\n-            Some(s) => s.to_owned(),\n-            None => CsvFile::try_new(path, options)?\n-                .schema()\n-                .as_ref()\n-                .to_owned(),\n-        };\n-\n-        let projected_schema = projection\n-            .map(|p| Schema::new(p.iter().map(|i| schema.field(*i).clone()).collect()))\n-            .map_or(SchemaRef::new(schema), SchemaRef::new)\n-            .to_dfschema_ref()?;\n-\n         let provider = Arc::new(CsvFile::try_new(path, options)?);\n-        let schema = provider.schema();\n-\n-        let table_scan = LogicalPlan::TableScan {\n-            schema_name: \"\".to_string(),\n-            source: TableSource::FromProvider(provider),\n-            table_schema: schema,\n-            projected_schema,\n-            projection: None,\n-        };\n-\n-        Ok(Self::from(&table_scan))\n+        Self::scan(\"\", provider, projection)\n     }\n \n     /// Scan a Parquet data source\n     pub fn scan_parquet(path: &str, projection: Option<Vec<usize>>) -> Result<Self> {\n         let provider = Arc::new(ParquetTable::try_new(path)?);\n+        Self::scan(\"\", provider, projection)\n+    }\n+\n+    /// Scan an empty data source, mainly used in tests\n+    pub fn scan_empty(\n+        name: &str,\n\nReview comment:\n       Makes sense, I hadn't considered that. This change can be done in future PR if needed, so I agree we can keep them here.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-15T16:52:45.802+0000",
                    "updated": "2020-12-15T16:52:45.802+0000",
                    "started": "2020-12-15T16:52:45.802+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "524555",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/524734",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910#discussion_r543720947\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/builder.rs\n##########\n@@ -90,77 +75,51 @@ impl LogicalPlanBuilder {\n         options: CsvReadOptions,\n         projection: Option<Vec<usize>>,\n     ) -> Result<Self> {\n-        let schema: Schema = match options.schema {\n-            Some(s) => s.to_owned(),\n-            None => CsvFile::try_new(path, options)?\n-                .schema()\n-                .as_ref()\n-                .to_owned(),\n-        };\n-\n-        let projected_schema = projection\n-            .map(|p| Schema::new(p.iter().map(|i| schema.field(*i).clone()).collect()))\n-            .map_or(SchemaRef::new(schema), SchemaRef::new)\n-            .to_dfschema_ref()?;\n-\n         let provider = Arc::new(CsvFile::try_new(path, options)?);\n-        let schema = provider.schema();\n-\n-        let table_scan = LogicalPlan::TableScan {\n-            schema_name: \"\".to_string(),\n-            source: TableSource::FromProvider(provider),\n-            table_schema: schema,\n-            projected_schema,\n-            projection: None,\n-        };\n-\n-        Ok(Self::from(&table_scan))\n+        Self::scan(\"\", provider, projection)\n     }\n \n     /// Scan a Parquet data source\n     pub fn scan_parquet(path: &str, projection: Option<Vec<usize>>) -> Result<Self> {\n         let provider = Arc::new(ParquetTable::try_new(path)?);\n+        Self::scan(\"\", provider, projection)\n+    }\n+\n+    /// Scan an empty data source, mainly used in tests\n+    pub fn scan_empty(\n+        name: &str,\n\nReview comment:\n       I think keeping the name is reasonable here -- sometimes the name is needed when referring to the table in SQL, however, as this is part of the PlanBuilder I agree it isn't obviously going to be useful\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-15T22:08:04.844+0000",
                    "updated": "2020-12-15T22:08:04.844+0000",
                    "started": "2020-12-15T22:08:04.844+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "524734",
                    "issueId": "13345835"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/worklog/524735",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb closed pull request #8910:\nURL: https://github.com/apache/arrow/pull/8910\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-12-15T22:09:38.007+0000",
                    "updated": "2020-12-15T22:09:38.007+0000",
                    "started": "2020-12-15T22:09:38.007+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "524735",
                    "issueId": "13345835"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 4200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3c64e356[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@8f685cc[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d12ba3a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@17680b1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a36bd9b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@60445137[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@482ff46f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@7d6996d3[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32fc3680[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@70730401[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47481aec[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7626c3d8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 4200,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Dec 24 18:56:28 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-12-15T22:09:28.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10900/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2020-12-14T11:42:49.000+0000",
        "updated": "2020-12-24T18:56:28.000+0000",
        "timeoriginalestimate": null,
        "description": "Currently, the TableScan logical plan is quite complex. It can either reference a provider or a table name that is registered to the context.\r\n\r\nThis issue is about linking the logical plan to the TableProvider directly upon parsing of the SQL. This allows to simplify greatly the code and also makes the TableScan plan easier to use by external query plan manipulations.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 4200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust][DataFusion] Resolve TableScan provider eagerly",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/comment/17249982",
                    "id": "17249982",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 8910\n[https://github.com/apache/arrow/pull/8910]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-12-15T22:09:28.753+0000",
                    "updated": "2020-12-15T22:09:28.753+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13345835/comment/17254636",
                    "id": "17254636",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I added Remi to the contributors role in Jira and assigned this issue to him",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-12-24T18:56:28.778+0000",
                    "updated": "2020-12-24T18:56:28.778+0000"
                }
            ],
            "maxResults": 2,
            "total": 2,
            "startAt": 0
        },
        "customfield_12311820": "0|z0lhcw:",
        "customfield_12314139": null
    }
}