{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13413601",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601",
    "key": "ARROW-14815",
    "fields": {
        "parent": {
            "id": "13413587",
            "key": "ARROW-14806",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13413587",
            "fields": {
                "summary": "[R] Implement bindings for lubridate component extraction functions",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                    "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                    "name": "Resolved",
                    "id": "5",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                    "id": "2",
                    "description": "A new feature of the product, which has yet to be developed.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                    "name": "New Feature",
                    "subtask": false,
                    "avatarId": 21141
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "good-first-issue",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12633744",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12633744",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "outwardIssue": {
                    "id": "13428815",
                    "key": "ARROW-15701",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13428815",
                    "fields": {
                        "summary": "[R] month() should allow integer inputs",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 15000,
            "total": 15000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14815/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 25,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/726972",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg opened a new pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429\n\n\n   Once this PR is merged the following code snippet will be valid\r\n   \r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   suppressPackageStartupMessages(library(arrow))\r\n   \r\n   df <- tibble(\r\n     dates = as.Date(c(\"2021-04-30\", \"2021-07-31\", \"2021-10-31\", \"2021-01-31\"))\r\n     )\r\n   df %>% \r\n     record_batch() %>% \r\n     mutate(\r\n       semester_without_year = semester(dates),\r\n       semester_with_year = semester(dates, with_year = TRUE)) %>% \r\n     collect()\r\n   #> # A tibble: 4 \u00d7 3\r\n   #>   dates      semester_without_year semester_with_year\r\n   #>   <date>                     <int>              <dbl>\r\n   #> 1 2021-04-30                     1              2021.1\r\n   #> 2 2021-07-31                     2              2021.2\r\n   #> 3 2021-10-31                     2              2021.2\r\n   #> 4 2021-01-31                     1              2021.1\r\n   ```\r\n   \r\n   and identical with the `lubridate` result:\r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(\r\n     dates = as.Date(c(\"2021-04-30\", \"2021-07-31\", \"2021-10-31\", \"2021-01-31\"))\r\n     )\r\n   df %>% \r\n     mutate(\r\n       semester_without_year = semester(dates),\r\n       semester_with_year = semester(dates, with_year = TRUE))\r\n   #> # A tibble: 4 \u00d7 3\r\n   #>   dates      semester_without_year semester_with_year\r\n   #>   <date>                     <int>              <dbl>\r\n   #> 1 2021-04-30                     1              2021.1\r\n   #> 2 2021-07-31                     2              2021.2\r\n   #> 3 2021-10-31                     2              2021.2\r\n   #> 4 2021-01-31                     1              2021.1\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-15 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T11:16:42.614+0000",
                    "updated": "2022-02-15T11:16:42.614+0000",
                    "started": "2022-02-15T11:16:42.614+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726972",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/726973",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#issuecomment-1040150947\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T11:17:05.299+0000",
                    "updated": "2022-02-15T11:17:05.299+0000",
                    "started": "2022-02-15T11:17:05.299+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "726973",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/727529",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#issuecomment-1040150947\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T18:59:03.052+0000",
                    "updated": "2022-02-15T18:59:03.052+0000",
                    "started": "2022-02-15T18:59:03.052+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727529",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/727540",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg opened a new pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429\n\n\n   Once this PR is merged the following code snippet will be valid\r\n   \r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   suppressPackageStartupMessages(library(arrow))\r\n   \r\n   df <- tibble(\r\n     dates = as.Date(c(\"2021-04-30\", \"2021-07-31\", \"2021-10-31\", \"2021-01-31\"))\r\n     )\r\n   df %>% \r\n     record_batch() %>% \r\n     mutate(\r\n       semester_without_year = semester(dates),\r\n       semester_with_year = semester(dates, with_year = TRUE)) %>% \r\n     collect()\r\n   #> # A tibble: 4 \u00d7 3\r\n   #>   dates      semester_without_year semester_with_year\r\n   #>   <date>                     <int>              <dbl>\r\n   #> 1 2021-04-30                     1              2021.1\r\n   #> 2 2021-07-31                     2              2021.2\r\n   #> 3 2021-10-31                     2              2021.2\r\n   #> 4 2021-01-31                     1              2021.1\r\n   ```\r\n   \r\n   and identical with the `lubridate` result:\r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(\r\n     dates = as.Date(c(\"2021-04-30\", \"2021-07-31\", \"2021-10-31\", \"2021-01-31\"))\r\n     )\r\n   df %>% \r\n     mutate(\r\n       semester_without_year = semester(dates),\r\n       semester_with_year = semester(dates, with_year = TRUE))\r\n   #> # A tibble: 4 \u00d7 3\r\n   #>   dates      semester_without_year semester_with_year\r\n   #>   <date>                     <int>              <dbl>\r\n   #> 1 2021-04-30                     1              2021.1\r\n   #> 2 2021-07-31                     2              2021.2\r\n   #> 3 2021-10-31                     2              2021.2\r\n   #> 4 2021-01-31                     1              2021.1\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-15 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T18:59:40.506+0000",
                    "updated": "2022-02-15T18:59:40.506+0000",
                    "started": "2022-02-15T18:59:40.505+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727540",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/727790",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807278266\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,14 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"semester\", function(x, with_year = FALSE) {\n+    month <- call_binding(\"month\", x)\n+    semester <- call_binding(\"if_else\", month <= 6, 1L, 2L)\n+    if (with_year) {\n+      year <- call_binding(\"year\", x)\n+      return(year + semester / 10)\n\nReview comment:\n       \ud83d\ude31 This looks totally wrong, but it isn't. It's exactly what lubridate's semseter/quarter returns: a numeric where the decimal portion is the quarter or semester number (and not a decimal representation of such, or a string).\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n\nReview comment:\n       ```suggestion\r\n       month_as_int = c(1:12, NA),\r\n       month_as_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\r\n       dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\r\n   ```\r\n   \r\n   and then also test `month_as_int` and `month_as_str_pad` below too\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n+  )\n+\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n\nReview comment:\n       Would you mind also testing some bad / wrong inputs and confirming that the errors are what we expect? Something like:\r\n   \r\n   ```\r\n   expect_error(call_binding(\"semester\", \"not a month\"), \"...\")\r\n   ```\r\n   \r\n   And other inputs like `22`, `-4`, `NA`, etc. that are clearly out of bounds / won't coerce into a month? Alternatively (or even better...) might be to add these tests to the tests for the `month` binding since that's where that coercion happens, it will be used when we make a binding for `quarters` and it appears those tests weren't added (or I can't find them!) when we added `months`\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T20:25:33.559+0000",
                    "updated": "2022-02-15T20:25:33.559+0000",
                    "started": "2022-02-15T20:25:33.559+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727790",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/727824",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807300733\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,14 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"semester\", function(x, with_year = FALSE) {\n+    month <- call_binding(\"month\", x)\n+    semester <- call_binding(\"if_else\", month <= 6, 1L, 2L)\n+    if (with_year) {\n+      year <- call_binding(\"year\", x)\n+      return(year + semester / 10)\n\nReview comment:\n       Yes, initially I implemented it as a string, as at least that felt like adding a guardrail, but nope, it's numeric.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T20:47:04.320+0000",
                    "updated": "2022-02-15T20:47:04.320+0000",
                    "started": "2022-02-15T20:47:04.320+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727824",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/727826",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807300733\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,14 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"semester\", function(x, with_year = FALSE) {\n+    month <- call_binding(\"month\", x)\n+    semester <- call_binding(\"if_else\", month <= 6, 1L, 2L)\n+    if (with_year) {\n+      year <- call_binding(\"year\", x)\n+      return(year + semester / 10)\n\nReview comment:\n       Yes, initially I implemented it as a string, as at least that felt like adding some sort of a guardrail, but nope, it's numeric.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T20:47:28.614+0000",
                    "updated": "2022-02-15T20:47:28.614+0000",
                    "started": "2022-02-15T20:47:28.614+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727826",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728133",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#issuecomment-1041378890\n\n\n   Not sure if we should (and if _yes_, at what level) support integer / numeric arguments to `month()`. If the answer is _yes_, I feel that should not happen only inside / for semester. `lubridate::month()` has dual purpose - it can be used both to get and set months. arrow currently supports only extraction and, therefore, the input type needs to be `temporal`.   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T11:14:08.169+0000",
                    "updated": "2022-02-16T11:14:08.169+0000",
                    "started": "2022-02-16T11:14:08.169+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728133",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728194",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807963638\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n+  )\n+\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n\nReview comment:\n       I think the direction for this would be for `month` to support integer inputs and then all the tests to happen there. I've added a failing test for integer inputs and I will make a note / add a comment to move the test to the \"it works\" block once we support integer inputs for month. I have opened [ARROW-15701](https://issues.apache.org/jira/browse/ARROW-15701).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T13:26:48.755+0000",
                    "updated": "2022-02-16T13:26:48.755+0000",
                    "started": "2022-02-16T13:26:48.755+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728194",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728195",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807965478\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n\nReview comment:\n       I've added those as failing tests. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T13:28:13.199+0000",
                    "updated": "2022-02-16T13:28:13.199+0000",
                    "started": "2022-02-16T13:28:13.199+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728195",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728263",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r808102891\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n+  )\n+\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n\nReview comment:\n       Yup, totally agree that `month` is the thing that should do this to accept a broader array of inputs + testing there. I also commented on the Jira with some ideas about how to move forward there\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T15:15:52.723+0000",
                    "updated": "2022-02-16T15:15:52.723+0000",
                    "started": "2022-02-16T15:15:52.723+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728263",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728277",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r808112466\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,48 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n\nReview comment:\n       I see this repeated down below as well and we don't use all of the inputs here. We should either curate the inputs so that this tibble has all and only the columns that are used in this block (and same with the one below) or we should factor these out + put them up top or somewhere else such that we define it once and then use it in multiple `test_that` blocks.\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,48 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # test extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+})\n+\n+test_that(\"semester errors with integers and characters\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # extraction from integers should error as we currently do not support setting\n+  # month components with month, but this is supported by `lubridate::month()`\n+  # this should no longer fail once https://issues.apache.org/jira/browse/ARROW-15701\n+  # is addressed\n\nReview comment:\n       Thanks for adding this in as a comment here! It's minor, but makes it easier to find them later, I try and add a `# TODO: ...` line somewhere in these blocks (ideally on the line that has the jira ticket number)\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,48 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # test extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+})\n+\n+test_that(\"semester errors with integers and characters\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n\nReview comment:\n       ```suggestion\r\n       month_as_char_pad = sprintf(\"%02i\", month_as_int),\r\n   ```\r\n   \r\n   This gets what you need here, yeah?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T15:34:12.145+0000",
                    "updated": "2022-02-16T15:34:12.145+0000",
                    "started": "2022-02-16T15:34:12.144+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728277",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728332",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r808183192\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,48 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # test extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+})\n+\n+test_that(\"semester errors with integers and characters\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n\nReview comment:\n       Done.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T16:16:57.420+0000",
                    "updated": "2022-02-16T16:16:57.420+0000",
                    "started": "2022-02-16T16:16:57.420+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728332",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728333",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r808184060\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,48 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # test extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+})\n+\n+test_that(\"semester errors with integers and characters\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = ifelse(month_as_int < 10, paste0(\"0\", month_as_int), month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # extraction from integers should error as we currently do not support setting\n+  # month components with month, but this is supported by `lubridate::month()`\n+  # this should no longer fail once https://issues.apache.org/jira/browse/ARROW-15701\n+  # is addressed\n\nReview comment:\n       Done\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-16T16:17:29.971+0000",
                    "updated": "2022-02-16T16:17:29.971+0000",
                    "started": "2022-02-16T16:17:29.971+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728333",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728920",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r807965478\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n\nReview comment:\n       I added those as failing tests. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-17T13:04:43.924+0000",
                    "updated": "2022-02-17T13:04:43.924+0000",
                    "started": "2022-02-17T13:04:43.924+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728920",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/728963",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r809093956\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,19 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester\", {\n+  test_df <- tibble(\n+    month = c(1:12, NA),\n+    month_char_pad = ifelse(month < 10, paste0(\"0\", month), month),\n+    dates = as.Date(paste0(\"2021-\", month_char_pad, \"-15\"))\n+  )\n+\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n\nReview comment:\n       @jonkeane I decided to implement support for integer inputs in `month()`, but I do not have a working version yet.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-17T14:16:36.525+0000",
                    "updated": "2022-02-17T14:16:36.525+0000",
                    "started": "2022-02-17T14:16:36.524+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "728963",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/730029",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r810506760\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -115,6 +115,23 @@ register_bindings_datetime <- function() {\n       return(Expression$create(\"strftime\", x, options = list(format = format, locale = locale)))\n     }\n \n+    if (call_binding(\"is.integer\", x)) {\n+      if (inherits(x, \"Expression\")) {\n+        call_binding(\n+          \"if_else\",\n+          call_binding_agg(\"all\", call_binding(\"between\", x, 1, 12))$data,\n+          x,\n+          abort(\"bla: Values are not in 1:12\")\n+        )\n\nReview comment:\n       I suspect in this part of the branch what you'll need to do is (re) assign the `call_binding` to `x` or return it directly. (thought see the comment below that this probably needs to happen above or we'll need to take into account that `label` argument.\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -115,6 +115,23 @@ register_bindings_datetime <- function() {\n       return(Expression$create(\"strftime\", x, options = list(format = format, locale = locale)))\n     }\n \n+    if (call_binding(\"is.integer\", x)) {\n+      if (inherits(x, \"Expression\")) {\n+        call_binding(\n+          \"if_else\",\n+          call_binding_agg(\"all\", call_binding(\"between\", x, 1, 12))$data,\n+          x,\n+          abort(\"bla: Values are not in 1:12\")\n+        )\n+      } else {\n+        if (all(1 <= x & x <= 12)) {\n+          return(x)\n+        } else {\n+          abort(\"bla2: Values are not in 1:12\")\n+        }\n+      }\n+    }\n\nReview comment:\n       Thanks for this, this is on the right track. I suspect that we might want this to be a bit higher in the function call, since we can use numerics and labels in lubridate:\r\n   \r\n   ```\r\n   lubridate::month(2, label = TRUE)\r\n   [1] Feb\r\n   12 Levels: Jan < Feb < Mar < Apr < May < Jun < Jul < Aug < Sep < ... < Dec\r\n   ```\r\n   \r\n   Could you also add some tests for `month()` taking various inputs here?\r\n   \r\n   A few inputs that I would start with (though I'm sure there are a bunch that could get us into funny corners!):\r\n   \r\n   ```\r\n   month(1)\r\n   month(1.1)\r\n   month(4L)\r\n   month(4L, label = TRUE)\r\n   ```\r\n   \r\n   You might have already figured this out (in which case ignore this!), but an understanding of this will help you work on these bindings:\r\n   \r\n   We have a few of these helper functions in the package:\r\n   \r\n   * `call_function()` \u2014 this is exported and is a way to evaluate a specific arrow C++ compute function. This is helpful for answering questions like \"Does this C++ compute function support this input? What does the error look like when it doesn?\"\r\n   * `call_binding()` \u2014 (which is unexpected) makes it easy to call one of our dplyr bindings, but note that `call_binding()` creates an Arrow Expression, but doesn't actually evaluate it (since evaluating it might be expensive, that is deferred to when the query is actually running). This is how we construct binding calls that rely on other bindings. Running this standalone will _not_ evaluate on the data, but running it alone is good for catching type-checking errors.\r\n   * `arrow_eval()` \u2014 this will trigger actual evaluation (and is used inside of our dplyr evaluation code)\r\n   \r\n   So when you're experimenting you might call something like `arrow_eval(call_binding(\"month\", Expression$scalar(1L)), arrow_mask(list()))` to see what happens if we were to call and evaluate our `month` dplyr binding. The `arrow_mask(list())` at the end is because `arrow_eval()` is a tidy-eval style that one needs to provide a data mask.\r\n   \r\n   One last thing: for this binding, since the behavior depends (at least in some cases) on the actual data in the column: we might want to make a (test) helper that wraps `arrow_eval(..., arrow_mask(list()))` that makes it easier to push various kinds of data through one of our dplyr bindings and see the output (either the values or the errors). It's possible something like this exists (honestly, in some ways a dplyr pipeline kind of _is_ that wrapper \u2014 just with a lot more) but I'm not aware of a quick helper that makes constructing + triggering the bindings with various inputs easy.\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,40 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types and integers\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = sprintf(\"%02i\", month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # semester extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+  # semester extraction from months as integers\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(sem_month_as_int = semester(month_as_int)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  expect_error(\n+    call_binding(\"semester\", Expression$scalar(1:13))\n+  )\n\nReview comment:\n       Could you assert the error that you're getting here?\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -115,6 +115,23 @@ register_bindings_datetime <- function() {\n       return(Expression$create(\"strftime\", x, options = list(format = format, locale = locale)))\n     }\n \n+    if (call_binding(\"is.integer\", x)) {\n+      if (inherits(x, \"Expression\")) {\n+        call_binding(\n+          \"if_else\",\n+          call_binding_agg(\"all\", call_binding(\"between\", x, 1, 12))$data,\n\nReview comment:\n       I suspect that the `$data` isn't doing what you expect here. That's actually getting the _input_ to the `all` binding (not the result).\r\n   \r\n   We also should be careful that we don't want to go through the data more than once \u2014 is there a way we can construct a series of binding calls like this that get us to the answer (and then error if they run into a value that won't work?)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-19T15:46:15.861+0000",
                    "updated": "2022-02-19T15:46:15.861+0000",
                    "started": "2022-02-19T15:46:15.861+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730029",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/730373",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r811156508\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,40 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"semester works with temporal types and integers\", {\n+  test_df <- tibble(\n+    month_as_int = c(1:12, NA),\n+    month_as_char_pad = sprintf(\"%02i\", month_as_int),\n+    dates = as.Date(paste0(\"2021-\", month_as_char_pad, \"-15\"))\n+  )\n+\n+  # semester extraction from dates\n+  compare_dplyr_binding(\n+     .input %>%\n+      mutate(sem_wo_year = semester(dates),\n+             sem_w_year = semester(dates, with_year = TRUE)) %>%\n+      collect(),\n+     test_df\n+  )\n+  # semester extraction from months as integers\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(sem_month_as_int = semester(month_as_int)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  expect_error(\n+    call_binding(\"semester\", Expression$scalar(1:13))\n+  )\n\nReview comment:\n       Nope. Not yet, I would like to get an error, but it at the moment it's just a placeholder since the function doesn't yet error / work correctly.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T14:00:30.679+0000",
                    "updated": "2022-02-21T14:00:30.679+0000",
                    "started": "2022-02-21T14:00:30.678+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730373",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/730398",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429#discussion_r811219485\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -115,6 +115,23 @@ register_bindings_datetime <- function() {\n       return(Expression$create(\"strftime\", x, options = list(format = format, locale = locale)))\n     }\n \n+    if (call_binding(\"is.integer\", x)) {\n+      if (inherits(x, \"Expression\")) {\n+        call_binding(\n+          \"if_else\",\n+          call_binding_agg(\"all\", call_binding(\"between\", x, 1, 12))$data,\n+          x,\n+          abort(\"bla: Values are not in 1:12\")\n+        )\n+      } else {\n+        if (all(1 <= x & x <= 12)) {\n+          return(x)\n+        } else {\n+          abort(\"bla2: Values are not in 1:12\")\n+        }\n+      }\n+    }\n\nReview comment:\n       I have just spent half a day looking at the unit tests for `month()` and trying to figure out how to solve both `semester()` and `month()` in one go. I think solving all the outstanding issues with `month` (integer inputs, factor outputs etc.) is maybe a bit too much to accomplish in this PR. Therefore, I think the best course of action would be to keep the two issues separate - solve `semester()` in this PR and then, at a later date, iron any outstanding aspects of `month()` as part of [ARROW-15701](https://issues.apache.org/jira/browse/ARROW-15701).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T15:08:55.821+0000",
                    "updated": "2022-02-21T15:08:55.821+0000",
                    "started": "2022-02-21T15:08:55.821+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730398",
                    "issueId": "13413601"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/worklog/731135",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane closed pull request #12429:\nURL: https://github.com/apache/arrow/pull/12429\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-22T20:03:16.282+0000",
                    "updated": "2022-02-22T20:03:16.282+0000",
                    "started": "2022-02-22T20:03:16.281+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "731135",
                    "issueId": "13413601"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 15000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5289b4eb[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@58ec59ef[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@297e5bc5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@13675c24[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1aa39f9e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@505eec06[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@b2535bb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@228ade87[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24d3fa27[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@34a0c67[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21606958[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@55eae515[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 15000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Feb 22 20:03:04 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-02-22T20:03:04.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14815/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-11-24T12:04:56.000+0000",
        "updated": "2022-02-23T09:01:29.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 15000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Implement bindings for lubridate::semester",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413601/comment/17496293",
                    "id": "17496293",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 12429\n[https://github.com/apache/arrow/pull/12429]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-02-22T20:03:04.262+0000",
                    "updated": "2022-02-22T20:03:04.262+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0x1q0:",
        "customfield_12314139": null
    }
}