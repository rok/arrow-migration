{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13368904",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904",
    "key": "ARROW-12168",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12623844",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12623844",
                "type": {
                    "id": "12310660",
                    "name": "Completes",
                    "inward": "is fixed by",
                    "outward": "fixes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310660"
                },
                "outwardIssue": {
                    "id": "13302467",
                    "key": "ARROW-8673",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13302467",
                    "fields": {
                        "summary": "[Go] Implement IPC RecordBatch body compression from ARROW-300",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zeroshade",
            "name": "zeroshade",
            "key": "zeroshade",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=zeroshade&avatarId=31230",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=zeroshade&avatarId=31230",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=zeroshade&avatarId=31230",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=zeroshade&avatarId=31230"
            },
            "displayName": "Matthew Topol",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333772",
                "id": "12333772",
                "name": "Go"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zeroshade",
            "name": "zeroshade",
            "key": "zeroshade",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=zeroshade&avatarId=31230",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=zeroshade&avatarId=31230",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=zeroshade&avatarId=31230",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=zeroshade&avatarId=31230"
            },
            "displayName": "Matthew Topol",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=zeroshade",
            "name": "zeroshade",
            "key": "zeroshade",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=zeroshade&avatarId=31230",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=zeroshade&avatarId=31230",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=zeroshade&avatarId=31230",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=zeroshade&avatarId=31230"
            },
            "displayName": "Matthew Topol",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 30600,
            "total": 30600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 30600,
            "total": 30600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12168/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 51,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/574918",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade opened a new pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862\n\n\n   @sbinet @emkornfield \r\n   \r\n   This is my follow up from #9836\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-31T15:39:47.381+0000",
                    "updated": "2021-03-31T15:39:47.381+0000",
                    "started": "2021-03-31T15:39:47.381+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "574918",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/575137",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#issuecomment-811467002\n\n\n   https://issues.apache.org/jira/browse/ARROW-12168\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-31T21:09:22.858+0000",
                    "updated": "2021-03-31T21:09:22.858+0000",
                    "started": "2021-03-31T21:09:22.858+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "575137",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/575298",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#issuecomment-811621167\n\n\n   I'll try to review soon if @sbinet  can't but could you please remove the block on testing Go's ability to read integration test files and update docs for go in this PR (https://github.com/apache/arrow/pull/9822 also changed relevant files).  Note integration tests in CI are currently broken so you will have to run archery by hand to verify Go can read the files.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-01T04:02:23.652+0000",
                    "updated": "2021-04-01T04:02:23.652+0000",
                    "started": "2021-04-01T04:02:23.652+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "575298",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/575695",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#issuecomment-812115291\n\n\n   Ran archery locally with `--with-go true` and it successfully worked with the compression test cases.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-01T19:14:00.647+0000",
                    "updated": "2021-04-01T19:14:00.647+0000",
                    "started": "2021-04-01T19:14:00.647+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "575695",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576518",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606741292\n\n\n\n##########\nFile path: go/arrow/go.sum\n##########\n@@ -55,13 +67,11 @@ golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f/go.mod h1:RxMgew5VJxzue5/jJ\n golang.org/x/sync v0.0.0-20181108010431-42b317875d0f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n-golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a h1:1BGLXjeY4akVXGgbC9HugT3Jv3hCI0z56oJR5vAMgBU=\n golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n golang.org/x/sys v0.0.0-20200323222414-85ca7c5b95cd/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n golang.org/x/sys v0.0.0-20200909081042-eff7692f9009 h1:W0lCpv29Hv0UaM1LXb9QlBHLNP8UFfcKjblhVCWftOM=\n golang.org/x/sys v0.0.0-20200909081042-eff7692f9009/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n-golang.org/x/text v0.3.0 h1:g61tztE5qeGQ89tm6NTjjM9VPIm088od1l6aSorWRWg=\n\nReview comment:\n       it looks this is getting swapped for kr/text?  why the change?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T03:41:07.510+0000",
                    "updated": "2021-04-04T03:41:07.510+0000",
                    "started": "2021-04-04T03:41:07.510+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576518",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606741388\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n\nReview comment:\n       at least in other languages I'm familiar with there is some effort to hide the flat buffer details from consumers of the API.  Would it make sense to abstract that here?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T03:43:11.497+0000",
                    "updated": "2021-04-04T03:43:11.497+0000",
                    "started": "2021-04-04T03:43:11.497+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576519",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576520",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606741456\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n+\tt.Helper()\n+\n+\topts := []ipc.Option{ipc.WithSchema(schema), ipc.WithAllocator(mem)}\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\topts = append(opts, ipc.WithLZ4())\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\topts = append(opts, ipc.WithZstd())\n+\t}\n\nReview comment:\n       fail or at least warn on behavior for unrecognized type?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T03:44:16.167+0000",
                    "updated": "2021-04-04T03:44:16.167+0000",
                    "started": "2021-04-04T03:44:16.166+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576520",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576521",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606741498\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n+\tt.Helper()\n+\n+\topts := []ipc.Option{ipc.WithSchema(schema), ipc.WithAllocator(mem)}\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\topts = append(opts, ipc.WithLZ4())\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\topts = append(opts, ipc.WithZstd())\n+\t}\n+\n+\tw, err := ipc.NewFileWriter(f, opts...)\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\tdefer w.Close()\n+\n+\tfor i, rec := range recs {\n+\t\terr = w.Write(rec)\n+\t\tif err != nil {\n+\t\t\tt.Fatalf(\"could not write record[%d]: %v\", i, err)\n+\t\t}\n+\t}\n+\n+\terr = w.Close()\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\n+\terr = f.Sync()\n+\tif err != nil {\n+\t\tt.Fatalf(\"could not sync data to disk: %v\", err)\n+\t}\n+\n+\t_, err = f.Seek(0, io.SeekStart)\n\nReview comment:\n       why the seek to start?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T03:45:21.380+0000",
                    "updated": "2021-04-04T03:45:21.380+0000",
                    "started": "2021-04-04T03:45:21.380+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576521",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576522",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606741513\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -191,3 +233,32 @@ func WriteStream(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.S\n \t\tt.Fatal(err)\n \t}\n }\n+\n+// WriteStreamCompressed writes a list of records to the given file descriptor as an ARROW stream\n+// using the provided compression type.\n+func WriteStreamCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n\nReview comment:\n       same comment on the api.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T03:45:35.881+0000",
                    "updated": "2021-04-04T03:45:35.881+0000",
                    "started": "2021-04-04T03:45:35.881+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576522",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576586",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606819927\n\n\n\n##########\nFile path: go/arrow/go.sum\n##########\n@@ -55,13 +67,11 @@ golang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f/go.mod h1:RxMgew5VJxzue5/jJ\n golang.org/x/sync v0.0.0-20181108010431-42b317875d0f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\n golang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n-golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a h1:1BGLXjeY4akVXGgbC9HugT3Jv3hCI0z56oJR5vAMgBU=\n golang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\n golang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n golang.org/x/sys v0.0.0-20200323222414-85ca7c5b95cd/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n golang.org/x/sys v0.0.0-20200909081042-eff7692f9009 h1:W0lCpv29Hv0UaM1LXb9QlBHLNP8UFfcKjblhVCWftOM=\n golang.org/x/sys v0.0.0-20200909081042-eff7692f9009/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\n-golang.org/x/text v0.3.0 h1:g61tztE5qeGQ89tm6NTjjM9VPIm088od1l6aSorWRWg=\n\nReview comment:\n       It's not a change i made directly so my guess is that something underneath changed a dependency and I picked it up.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T15:54:10.668+0000",
                    "updated": "2021-04-04T15:54:10.668+0000",
                    "started": "2021-04-04T15:54:10.667+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576586",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576587",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606820150\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n\nReview comment:\n       So this is an internal package (note the \"internal\" in the path) which means it cannot be imported or called outside of the `arrow` repo here. This is only used for the unit tests so I figured it wasn't a problem to have it use the enum from the flatbuffer details directly in this situation since it's not an externally exposed API for consumers.\r\n   \r\n   The only externally exposed API for consumers is the `WithLZ4` and `WithZstd` functions that were added as options to be passed to the writer which explicitly doesn't expose the flatbuffer details to external consumers.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T15:56:23.892+0000",
                    "updated": "2021-04-04T15:56:23.892+0000",
                    "started": "2021-04-04T15:56:23.892+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576587",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576588",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606820199\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n+\tt.Helper()\n+\n+\topts := []ipc.Option{ipc.WithSchema(schema), ipc.WithAllocator(mem)}\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\topts = append(opts, ipc.WithLZ4())\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\topts = append(opts, ipc.WithZstd())\n+\t}\n\nReview comment:\n       sure i'll add a failure here for that.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T15:56:56.783+0000",
                    "updated": "2021-04-04T15:56:56.783+0000",
                    "started": "2021-04-04T15:56:56.783+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576588",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576589",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606820653\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -172,6 +173,47 @@ func WriteFile(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Sch\n \t}\n }\n \n+// WriteFile writes a list of records to the given file descriptor, as an ARROW file.\n+func WriteFileCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n+\tt.Helper()\n+\n+\topts := []ipc.Option{ipc.WithSchema(schema), ipc.WithAllocator(mem)}\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\topts = append(opts, ipc.WithLZ4())\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\topts = append(opts, ipc.WithZstd())\n+\t}\n+\n+\tw, err := ipc.NewFileWriter(f, opts...)\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\tdefer w.Close()\n+\n+\tfor i, rec := range recs {\n+\t\terr = w.Write(rec)\n+\t\tif err != nil {\n+\t\t\tt.Fatalf(\"could not write record[%d]: %v\", i, err)\n+\t\t}\n+\t}\n+\n+\terr = w.Close()\n+\tif err != nil {\n+\t\tt.Fatal(err)\n+\t}\n+\n+\terr = f.Sync()\n+\tif err != nil {\n+\t\tt.Fatalf(\"could not sync data to disk: %v\", err)\n+\t}\n+\n+\t_, err = f.Seek(0, io.SeekStart)\n\nReview comment:\n       So, I actually copied the existing WriteFile test function and then just added the compression to it, but looking at the code my guess is that it's because the file isn't being opened here, it's passed in. So doing the seek to start after writing just preps the file handle to immediately be able to read from it for the test rather than leaving it at the end of the file after doing the writes, which makes sense since this is only used for testing and can't be called externally\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T15:59:50.043+0000",
                    "updated": "2021-04-04T15:59:50.043+0000",
                    "started": "2021-04-04T15:59:50.043+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576589",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576590",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "zeroshade commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606820809\n\n\n\n##########\nFile path: go/arrow/internal/arrdata/ioutil.go\n##########\n@@ -191,3 +233,32 @@ func WriteStream(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.S\n \t\tt.Fatal(err)\n \t}\n }\n+\n+// WriteStreamCompressed writes a list of records to the given file descriptor as an ARROW stream\n+// using the provided compression type.\n+func WriteStreamCompressed(t *testing.T, f *os.File, mem memory.Allocator, schema *arrow.Schema, recs []array.Record, codec flatbuf.CompressionType) {\n\nReview comment:\n       same as i mentioned above, this is not an externally facing Consumable API because it's an \"internal\" package which cannot be imported outside of this repo. The \"internal\" package is a special package that prevents anything below it from being an externally facing public API.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:01:03.156+0000",
                    "updated": "2021-04-04T16:01:03.156+0000",
                    "started": "2021-04-04T16:01:03.155+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576590",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576592",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606821874\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n+func (zstdCompressor) MaxCompressedLen(len int) int {\n+\textra := ((128 << 10) - len) >> 11\n\nReview comment:\n       please be careful here with signed values here.   it looks like ZSTD_compressBound takes size_t which I believe is unsigned.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:10:02.960+0000",
                    "updated": "2021-04-04T16:10:02.960+0000",
                    "started": "2021-04-04T16:10:02.959+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576592",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576593",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606821976\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n\nReview comment:\n       mention the method name/macro here where it was taken from.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:10:55.894+0000",
                    "updated": "2021-04-04T16:10:55.894+0000",
                    "started": "2021-04-04T16:10:55.894+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576593",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576594",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606822024\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n\nReview comment:\n       It is strange this isn't provided as part of the library?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:11:18.815+0000",
                    "updated": "2021-04-04T16:11:18.815+0000",
                    "started": "2021-04-04T16:11:18.815+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576594",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576595",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606822059\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n+func (zstdCompressor) MaxCompressedLen(len int) int {\n+\textra := ((128 << 10) - len) >> 11\n+\tif len >= (128 << 10) {\n+\t\textra = 0\n+\t}\n+\treturn len + (len >> 8) + extra\n+}\n+\n+func (zstdCompressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeZSTD\n+}\n+\n+func getCompressor(codec flatbuf.CompressionType) compressor {\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\tw := lz4.NewWriter(nil)\n+\t\tw.Apply(lz4.ConcurrencyOption(1), lz4.ChecksumOption(false), lz4.BlockSizeOption(lz4.Block64Kb))\n\nReview comment:\n       maybe comment on how these options are chosen?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:11:53.763+0000",
                    "updated": "2021-04-04T16:11:53.763+0000",
                    "started": "2021-04-04T16:11:53.763+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576595",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576596",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606822097\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n+func (zstdCompressor) MaxCompressedLen(len int) int {\n+\textra := ((128 << 10) - len) >> 11\n+\tif len >= (128 << 10) {\n+\t\textra = 0\n+\t}\n+\treturn len + (len >> 8) + extra\n+}\n+\n+func (zstdCompressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeZSTD\n+}\n+\n+func getCompressor(codec flatbuf.CompressionType) compressor {\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\tw := lz4.NewWriter(nil)\n+\t\tw.Apply(lz4.ConcurrencyOption(1), lz4.ChecksumOption(false), lz4.BlockSizeOption(lz4.Block64Kb))\n+\t\treturn &lz4Compressor{w}\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\tenc, err := zstd.NewWriter(nil)\n+\t\tif err != nil {\n+\t\t\tpanic(err)\n\nReview comment:\n       shouldn't errors be propogated up?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:12:26.706+0000",
                    "updated": "2021-04-04T16:12:26.706+0000",
                    "started": "2021-04-04T16:12:26.706+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576596",
                    "issueId": "13368904"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/worklog/576597",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #9862:\nURL: https://github.com/apache/arrow/pull/9862#discussion_r606822157\n\n\n\n##########\nFile path: go/arrow/ipc/compression.go\n##########\n@@ -0,0 +1,106 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+// http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing, software\n+// distributed under the License is distributed on an \"AS IS\" BASIS,\n+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+// See the License for the specific language governing permissions and\n+// limitations under the License.\n+\n+package ipc\n+\n+import (\n+\t\"io\"\n+\n+\t\"github.com/apache/arrow/go/arrow/internal/flatbuf\"\n+\t\"github.com/klauspost/compress/zstd\"\n+\t\"github.com/pierrec/lz4/v4\"\n+)\n+\n+type compressor interface {\n+\tMaxCompressedLen(n int) int\n+\tReset(io.Writer)\n+\tio.WriteCloser\n+\tType() flatbuf.CompressionType\n+}\n+\n+type lz4Compressor struct {\n+\t*lz4.Writer\n+}\n+\n+func (lz4Compressor) MaxCompressedLen(n int) int {\n+\treturn lz4.CompressBlockBound(n)\n+}\n+\n+func (lz4Compressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeLZ4_FRAME\n+}\n+\n+type zstdCompressor struct {\n+\t*zstd.Encoder\n+}\n+\n+// from zstd.h\n+func (zstdCompressor) MaxCompressedLen(len int) int {\n+\textra := ((128 << 10) - len) >> 11\n+\tif len >= (128 << 10) {\n+\t\textra = 0\n+\t}\n+\treturn len + (len >> 8) + extra\n+}\n+\n+func (zstdCompressor) Type() flatbuf.CompressionType {\n+\treturn flatbuf.CompressionTypeZSTD\n+}\n+\n+func getCompressor(codec flatbuf.CompressionType) compressor {\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\tw := lz4.NewWriter(nil)\n+\t\tw.Apply(lz4.ConcurrencyOption(1), lz4.ChecksumOption(false), lz4.BlockSizeOption(lz4.Block64Kb))\n+\t\treturn &lz4Compressor{w}\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\tenc, err := zstd.NewWriter(nil)\n+\t\tif err != nil {\n+\t\t\tpanic(err)\n+\t\t}\n+\t\treturn zstdCompressor{enc}\n+\t}\n+\treturn nil\n+}\n+\n+type decompressor interface {\n+\tio.Reader\n+\tReset(io.Reader)\n+}\n+\n+type zstdDecompressor struct {\n+\t*zstd.Decoder\n+}\n+\n+func (z *zstdDecompressor) Reset(r io.Reader) {\n+\tif err := z.Decoder.Reset(r); err != nil {\n+\t\tpanic(err)\n+\t}\n+}\n+\n+func getDecompressor(codec flatbuf.CompressionType) decompressor {\n+\tswitch codec {\n+\tcase flatbuf.CompressionTypeLZ4_FRAME:\n+\t\treturn lz4.NewReader(nil)\n+\tcase flatbuf.CompressionTypeZSTD:\n+\t\tdec, err := zstd.NewReader(nil)\n+\t\tif err != nil {\n+\t\t\tpanic(err)\n\nReview comment:\n       same question on error management.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-04T16:12:59.624+0000",
                    "updated": "2021-04-04T16:12:59.624+0000",
                    "started": "2021-04-04T16:12:59.624+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "576597",
                    "issueId": "13368904"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 30600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@73456887[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@405ecba4[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4d382b5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@32e66a60[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3f10ed6a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@35d767bb[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2d898d9e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2c3d4725[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@147e9475[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1a1ad3fe[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7b1e485e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@3d5c3c77[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 30600,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Apr 07 15:23:27 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-04-07T15:23:27.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12168/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-03-31T15:26:49.000+0000",
        "updated": "2021-09-29T16:33:48.000+0000",
        "timeoriginalestimate": null,
        "description": "Add implementation for handling the optional compression for reading/writing Arrow IPC Format.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "8.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 30600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Go][IPC] Implement Compression handling for IPC",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13368904/comment/17316423",
                    "id": "17316423",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield",
                        "name": "emkornfield",
                        "key": "emkornfield",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Micah Kornfield",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 9862\n[https://github.com/apache/arrow/pull/9862]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=emkornfield",
                        "name": "emkornfield",
                        "key": "emkornfield",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Micah Kornfield",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-04-07T15:23:27.461+0000",
                    "updated": "2021-04-07T15:23:27.461+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0pf14:",
        "customfield_12314139": null
    }
}