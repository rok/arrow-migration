{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13398881",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881",
    "key": "ARROW-13860",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350323",
                "id": "12350323",
                "description": "",
                "name": "6.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-10-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/2",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg",
            "name": "Critical",
            "id": "2"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hideaki",
            "name": "hideaki",
            "key": "hideaki",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Hideaki Hayashi",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=hideaki",
            "name": "hideaki",
            "key": "hideaki",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Hideaki Hayashi",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 6000,
            "total": 6000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6000,
            "total": 6000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13860/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 10,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/659990",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson opened a new pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315\n\n\n   I'm backing out the previous change, which made `Table$create()` sometimes not return a Table, because that doesn't seem right (and causes the reported bug), but I'm still going to preserve the intent, which is that arrow_dplyr_query objects made from such a Table can pick up the metadata from the `grouped_df`. \r\n   \r\n   I'll finish this next week, if not sooner. Just pushing a WIP for now.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-05T00:02:05.754+0000",
                    "updated": "2021-10-05T00:02:05.754+0000",
                    "started": "2021-10-05T00:02:05.753+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "659990",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/659991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#issuecomment-933946589\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-05T00:02:19.811+0000",
                    "updated": "2021-10-05T00:02:19.811+0000",
                    "started": "2021-10-05T00:02:19.810+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "659991",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665307",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728368089\n\n\n\n##########\nFile path: r/R/schema.R\n##########\n@@ -133,6 +133,23 @@ Schema <- R6Class(\"Schema\",\n         self$set_pointer(out$pointer())\n         self\n       }\n+    },\n+    r_metadata = function(new) {\n+      # Helper for the R metadata that handles the serialization\n+      # See also method on ArrowTabular\n+      if (missing(new)) {\n+        out <- self$metadata$r\n+        if (!is.null(out)) {\n+          # Can't unserialize NULL\n+          out <- .unserialize_arrow_r_metadata(out)\n+        }\n+        # Returns either NULL or a named list\n+        out\n+      } else {\n+        # Set the R metadata\n+        self$metadata$r <- .serialize_arrow_r_metadata(new)\n+        self\n\nReview comment:\n       Could? Should? we merge this and the tabular method? They look the same to me (except the comment)\n\n##########\nFile path: r/R/table.R\n##########\n@@ -141,20 +144,6 @@ Table <- R6Class(\"Table\",\n     num_columns = function() Table__num_columns(self),\n     num_rows = function() Table__num_rows(self),\n     schema = function() Table__schema(self),\n-    metadata = function(new) {\n-      if (missing(new)) {\n-        # Get the metadata (from the schema)\n-        self$schema$metadata\n-      } else {\n-        # Set the metadata\n-        new <- prepare_key_value_metadata(new)\n-        out <- Table__ReplaceSchemaMetadata(self, new)\n-        # ReplaceSchemaMetadata returns a new object but we're modifying in place,\n-        # so swap in that new C++ object pointer into our R6 object\n-        self$set_pointer(out$pointer())\n-        self\n-      }\n-    },\n\nReview comment:\n       `Table$metadata()` would now dispatch through the `ArrowTabular$metadata()` method/binding now, correct?\n\n##########\nFile path: r/tests/testthat/test-metadata.R\n##########\n@@ -240,7 +241,7 @@ test_that(\"Row-level metadata (does not) roundtrip in datasets\", {\n   skip_if_not_available(\"parquet\")\n \n   local_edition(3)\n\nReview comment:\n       ```suggestion\r\n   ```\r\n   \r\n   This isn't related to the PR, but we no longer need this, right?\n\n##########\nFile path: r/R/metadata.R\n##########\n@@ -129,6 +133,19 @@ remove_attributes <- function(x) {\n }\n \n arrow_attributes <- function(x, only_top_level = FALSE) {\n+  if (inherits(x, \"grouped_df\")) {\n+    # Keep only the group var names, not the rest of the cached data that dplyr\n+    # uses, which may be large\n\nReview comment:\n       How large? We can do this as a follow on if we want, but I would be curious if removing it and then having dplyr regenerate it is worse or better (performance wise) compared to serializing the large cache.\n\n##########\nFile path: r/tests/testthat/test-parquet.R\n##########\n@@ -104,6 +104,12 @@ test_that(\"write_parquet() accepts RecordBatch too\", {\n   expect_equal(tab, Table$create(batch))\n })\n \n+test_that(\"write_parquet() handles grouped_df\", {\n+  library(dplyr, warn.conflicts = FALSE)\n+  df <- tibble::tibble(a = 1:4, b = 5) %>% group_by(b)\n+  expect_parquet_roundtrip(df, as_data_frame = TRUE)\n\nReview comment:\n       Does this test confirm that dplyr deals with recreating the cache as well?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T19:18:14.403+0000",
                    "updated": "2021-10-13T19:18:14.403+0000",
                    "started": "2021-10-13T19:18:14.403+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665307",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665332",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728399694\n\n\n\n##########\nFile path: r/R/schema.R\n##########\n@@ -133,6 +133,23 @@ Schema <- R6Class(\"Schema\",\n         self$set_pointer(out$pointer())\n         self\n       }\n+    },\n+    r_metadata = function(new) {\n+      # Helper for the R metadata that handles the serialization\n+      # See also method on ArrowTabular\n+      if (missing(new)) {\n+        out <- self$metadata$r\n+        if (!is.null(out)) {\n+          # Can't unserialize NULL\n+          out <- .unserialize_arrow_r_metadata(out)\n+        }\n+        # Returns either NULL or a named list\n+        out\n+      } else {\n+        # Set the R metadata\n+        self$metadata$r <- .serialize_arrow_r_metadata(new)\n+        self\n\nReview comment:\n       Could, IDK about should :shrug:. They are identical, though not sure it's worth the trouble/indirection to set it up since it's an active binding that switches based on whether the argument is missing.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T19:54:23.061+0000",
                    "updated": "2021-10-13T19:54:23.061+0000",
                    "started": "2021-10-13T19:54:23.061+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665332",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665338",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728403810\n\n\n\n##########\nFile path: r/R/metadata.R\n##########\n@@ -129,6 +133,19 @@ remove_attributes <- function(x) {\n }\n \n arrow_attributes <- function(x, only_top_level = FALSE) {\n+  if (inherits(x, \"grouped_df\")) {\n+    # Keep only the group var names, not the rest of the cached data that dplyr\n+    # uses, which may be large\n\nReview comment:\n       You basically get a data.frame that is `distinct(group_vars())` plus a list column of integer vectors of the row indices that match each condition:\r\n   \r\n   ```\r\n   > mtcars %>% group_by(cyl, hp) %>% attr(\"groups\")\r\n   # A tibble: 23 \u00d7 3\r\n        cyl    hp       .rows\r\n      <dbl> <dbl> <list<int>>\r\n    1     4    52         [1]\r\n    2     4    62         [1]\r\n    3     4    65         [1]\r\n    4     4    66         [2]\r\n    5     4    91         [1]\r\n    6     4    93         [1]\r\n    7     4    95         [1]\r\n    8     4    97         [1]\r\n    9     4   109         [1]\r\n   10     4   113         [1]\r\n   # \u2026 with 13 more rows\r\n   ```\r\n   \r\n   So clearly that gets big both when you have lots of rows and when you have high cardinality in your groups. I don't think it makes sense for us to save it to feather/parquet, and we don't need to because we can recreate it from just `group_vars()` on the round trip.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T20:00:34.050+0000",
                    "updated": "2021-10-13T20:00:34.050+0000",
                    "started": "2021-10-13T20:00:34.049+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665338",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665340",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728404410\n\n\n\n##########\nFile path: r/R/table.R\n##########\n@@ -141,20 +144,6 @@ Table <- R6Class(\"Table\",\n     num_columns = function() Table__num_columns(self),\n     num_rows = function() Table__num_rows(self),\n     schema = function() Table__schema(self),\n-    metadata = function(new) {\n-      if (missing(new)) {\n-        # Get the metadata (from the schema)\n-        self$schema$metadata\n-      } else {\n-        # Set the metadata\n-        new <- prepare_key_value_metadata(new)\n-        out <- Table__ReplaceSchemaMetadata(self, new)\n-        # ReplaceSchemaMetadata returns a new object but we're modifying in place,\n-        # so swap in that new C++ object pointer into our R6 object\n-        self$set_pointer(out$pointer())\n-        self\n-      }\n-    },\n\nReview comment:\n       Correct, I factored out the ReplaceSchemaMetadata piece that was different between Table and RecordBatch (bc static typing) and then moved the method to ArrowTabular\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T20:01:45.100+0000",
                    "updated": "2021-10-13T20:01:45.100+0000",
                    "started": "2021-10-13T20:01:45.100+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665340",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665342",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728406029\n\n\n\n##########\nFile path: r/tests/testthat/test-parquet.R\n##########\n@@ -104,6 +104,12 @@ test_that(\"write_parquet() accepts RecordBatch too\", {\n   expect_equal(tab, Table$create(batch))\n })\n \n+test_that(\"write_parquet() handles grouped_df\", {\n+  library(dplyr, warn.conflicts = FALSE)\n+  df <- tibble::tibble(a = 1:4, b = 5) %>% group_by(b)\n+  expect_parquet_roundtrip(df, as_data_frame = TRUE)\n\nReview comment:\n       It does, it calls `expect_equal(parquet_roundtrip(tab, ...), tab)` in the end, so we're asserting we get a `grouped_df` because that's what `df` is. FWIW this was the failing test I started with to reproduce the user's report.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T20:04:04.734+0000",
                    "updated": "2021-10-13T20:04:04.734+0000",
                    "started": "2021-10-13T20:04:04.734+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665342",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665343",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728407660\n\n\n\n##########\nFile path: r/tests/testthat/test-parquet.R\n##########\n@@ -104,6 +104,12 @@ test_that(\"write_parquet() accepts RecordBatch too\", {\n   expect_equal(tab, Table$create(batch))\n })\n \n+test_that(\"write_parquet() handles grouped_df\", {\n+  library(dplyr, warn.conflicts = FALSE)\n+  df <- tibble::tibble(a = 1:4, b = 5) %>% group_by(b)\n+  expect_parquet_roundtrip(df, as_data_frame = TRUE)\n\nReview comment:\n       Cool, this might be obvious, but it might be nice to comment that we're both ensuring + expecting that with a comment. I got it in the context of this PR, but I'm not sure I would remember that the roundtrip also includes this cache rebuilding.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T20:06:31.776+0000",
                    "updated": "2021-10-13T20:06:31.776+0000",
                    "started": "2021-10-13T20:06:31.775+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665343",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665361",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#discussion_r728443497\n\n\n\n##########\nFile path: r/tests/testthat/test-parquet.R\n##########\n@@ -104,6 +104,12 @@ test_that(\"write_parquet() accepts RecordBatch too\", {\n   expect_equal(tab, Table$create(batch))\n })\n \n+test_that(\"write_parquet() handles grouped_df\", {\n+  library(dplyr, warn.conflicts = FALSE)\n+  df <- tibble::tibble(a = 1:4, b = 5) %>% group_by(b)\n+  expect_parquet_roundtrip(df, as_data_frame = TRUE)\n\nReview comment:\n       ```suggestion\r\n     # Since `df` is a \"grouped_df\", this test asserts that we get a grouped_df back\r\n     expect_parquet_roundtrip(df, as_data_frame = TRUE)\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-13T21:00:12.481+0000",
                    "updated": "2021-10-13T21:00:12.481+0000",
                    "started": "2021-10-13T21:00:12.481+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665361",
                    "issueId": "13398881"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/worklog/665874",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot edited a comment on pull request #11315:\nURL: https://github.com/apache/arrow/pull/11315#issuecomment-943699516\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-10-17T00:41:13.426+0000",
                    "updated": "2021-10-17T00:41:13.426+0000",
                    "started": "2021-10-17T00:41:13.426+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "665874",
                    "issueId": "13398881"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 6000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@201c198a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7142ff3b[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d45765d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5b18ede9[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4b7c4184[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@197a5c0f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@f9b26e3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@13f0e55c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3a29e6c7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@71f85fa9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2702c34b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@33cc18f2[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6000,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Oct 14 20:19:52 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-10-14T20:19:52.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13860/watchers",
            "watchCount": 4,
            "isWatching": false
        },
        "created": "2021-09-02T07:32:14.000+0000",
        "updated": "2021-10-17T00:41:14.000+0000",
        "timeoriginalestimate": null,
        "description": "arrow 5.0.0 write_parquet throws error writing grouped data.frame.\r\n\r\nHere is how to reproduce it.\r\n\r\n{{library(dplyr)}}\r\n{{ arrow::write_parquet(mtcars %>% group_by(am),\"/tmp/mtcars_test.parquet\")}}\r\n{{# Error: x must be an object of class 'data.frame', 'RecordBatch', or 'Table', not 'arrow_dplyr_query\u2019.}}\r\n\r\n\u00a0\r\n\r\nWith arrow 4.0.1, this used to work fine.\r\n\r\n{{library(dplyr)}}\r\n{{arrow::write_parquet(mtcars %>% group_by(am),\"/tmp/mtcars_test.parquet\")}}\r\n{{x <- arrow::read_parquet(\"/tmp/mtcars_test.parquet\")}}\r\n{{x}}\r\n{{# A tibble: 32 x 11}}\r\n{{# Groups: \u00a0 am [2]}}\r\n{{#\u00a0 \u00a0 \u00a0mpg \u00a0 cyl \u00a0disp \u00a0 \u00a0hp \u00a0drat \u00a0 \u00a0wt \u00a0qsec \u00a0 \u00a0vs \u00a0 \u00a0am \u00a0gear \u00a0carb}}\r\n{{# * <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>}}\r\n{{# 1 \u00a021 \u00a0 \u00a0 \u00a0 6 \u00a0160 \u00a0 \u00a0110 \u00a03.9 \u00a0 2.62 \u00a016.5 \u00a0 \u00a0 0 \u00a0 \u00a0 1 \u00a0 \u00a0 4 \u00a0 \u00a0 4}}\r\n{{# 2 \u00a021 \u00a0 \u00a0 \u00a0 6 \u00a0160 \u00a0 \u00a0110 \u00a03.9 \u00a0 2.88 \u00a017.0 \u00a0 \u00a0 0 \u00a0 \u00a0 1 \u00a0 \u00a0 4 \u00a0 \u00a0 4}}\r\n{{# 3 \u00a022.8 \u00a0 \u00a0 4 \u00a0108 \u00a0 \u00a0 93 \u00a03.85 \u00a02.32 \u00a018.6 \u00a0 \u00a0 1 \u00a0 \u00a0 1 \u00a0 \u00a0 4 \u00a0 \u00a0 1}}\r\n{{# 4 \u00a021.4 \u00a0 \u00a0 6 \u00a0258 \u00a0 \u00a0110 \u00a03.08 \u00a03.22 \u00a019.4 \u00a0 \u00a0 1 \u00a0 \u00a0 0 \u00a0 \u00a0 3 \u00a0 \u00a0 1}}\r\n{{# 5 \u00a018.7 \u00a0 \u00a0 8 \u00a0360 \u00a0 \u00a0175 \u00a03.15 \u00a03.44 \u00a017.0 \u00a0 \u00a0 0 \u00a0 \u00a0 0 \u00a0 \u00a0 3 \u00a0 \u00a0 2}}\r\n{{# 6 \u00a018.1 \u00a0 \u00a0 6 \u00a0225 \u00a0 \u00a0105 \u00a02.76 \u00a03.46 \u00a020.2 \u00a0 \u00a0 1 \u00a0 \u00a0 0 \u00a0 \u00a0 3 \u00a0 \u00a0 1}}\r\n{{# 7 \u00a014.3 \u00a0 \u00a0 8 \u00a0360 \u00a0 \u00a0245 \u00a03.21 \u00a03.57 \u00a015.8 \u00a0 \u00a0 0 \u00a0 \u00a0 0 \u00a0 \u00a0 3 \u00a0 \u00a0 4}}\r\n{{# \u2026}}\r\n\r\n\u00a0\r\n\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] arrow 5.0.0 write_parquet throws error writing grouped data.frame",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "maxOS 11.1 Big Sur",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17409102",
                    "id": "17409102",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Thanks for the report!\r\n\r\nI dug into this and observed that it is happening because\r\n{code:java}\r\nwrite_parquet(x, ...) {code}\r\ncalls\r\n{code:java}\r\nx <- Table$create(){code}\r\nwhich changes\u00a0{{x}} into an {{arrow_dplyr_query}} because\u00a0{{x}}\u00a0has groups.\r\n\r\nThen it calls\r\n{code:java}\r\nis_writable_table(x){code}\r\nwhich triggers an error because\u00a0{{x}} does not inherit {{data.frame}} or {{ArrowTabular}}.\r\n\r\nIn version 4.0.1 of the arrow package, this did not trigger an error because the {{is_writable_table\\(x\\)}} function did not exist. It was introduced in #10387: [https://github.com/apache/arrow/commit/2e3a25e5f1329929e0fdb88ecc76bf404a5ccf57#diff-f6235d4767fc4a7ee1bb726d816b9742ef0bc07503dceb678fd3bc55ee15454b]\r\n\r\nBut I am confused: Before ARROW-11769, I thought groups were lost when a grouped R data.frame was converted to a {{Table}}. So how is it that in the example above, the groups were seemingly written to the Parquet file and read back in? Didn't we always call {{Table$create()}}\u00a0on the input to {{write_parquet()}} so shouldn't the groups have been lost?\r\n\r\ncc [~jonkeane] [~thisisnic]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-09-02T20:10:23.449+0000",
                    "updated": "2021-09-02T20:12:59.233+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17409141",
                    "id": "17409141",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "[~icook] I have no idea, but I ran a few things in Arrow 4.1 and make what you will of the below, but I think it might answer your question\r\n\r\n\r\n{code:java}\r\n> iris %>% group_by(Species) %>% record_batch() \r\n\r\nRecordBatch\r\n150 rows x 5 columns\r\n$Sepal.Length <double>\r\n$Sepal.Width <double>\r\n$Petal.Length <double>\r\n$Petal.Width <double>\r\n$Species <dictionary<values=string, indices=int8>>\r\n\r\nSee $metadata for additional Schema metadata\r\n\r\n> iris %>% group_by(Species) %>% record_batch() %>% collect()\r\n# A tibble: 150 x 5\r\n# Groups:   Species [3]\r\n   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\r\n *        <dbl>       <dbl>        <dbl>       <dbl> <fct>  \r\n 1          5.1         3.5          1.4         0.2 setosa \r\n 2          4.9         3            1.4         0.2 setosa \r\n 3          4.7         3.2          1.3         0.2 setosa \r\n 4          4.6         3.1          1.5         0.2 setosa \r\n 5          5           3.6          1.4         0.2 setosa \r\n 6          5.4         3.9          1.7         0.4 setosa \r\n 7          4.6         3.4          1.4         0.3 setosa \r\n 8          5           3.4          1.5         0.2 setosa \r\n 9          4.4         2.9          1.4         0.2 setosa \r\n10          4.9         3.1          1.5         0.1 setosa \r\n# \u2026 with 140 more rows\r\n\r\n> iris %>% record_batch() %>% group_by(Species) \r\nRecordBatch (query)\r\nSepal.Length: double\r\nSepal.Width: double\r\nPetal.Length: double\r\nPetal.Width: double\r\nSpecies: dictionary<values=string, indices=int8>\r\n\r\n* Grouped by Species\r\nSee $.data for the source Arrow object\r\n\r\n> iris %>% record_batch() %>% group_by(Species)  %>% collect()\r\n# A tibble: 150 x 5\r\n# Groups:   Species [3]\r\n   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\r\n          <dbl>       <dbl>        <dbl>       <dbl> <fct>  \r\n 1          5.1         3.5          1.4         0.2 setosa \r\n 2          4.9         3            1.4         0.2 setosa \r\n 3          4.7         3.2          1.3         0.2 setosa \r\n 4          4.6         3.1          1.5         0.2 setosa \r\n 5          5           3.6          1.4         0.2 setosa \r\n 6          5.4         3.9          1.7         0.4 setosa \r\n 7          4.6         3.4          1.4         0.3 setosa \r\n 8          5           3.4          1.5         0.2 setosa \r\n 9          4.4         2.9          1.4         0.2 setosa \r\n10          4.9         3.1          1.5         0.1 setosa \r\n# \u2026 with 140 more rows\r\n\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2021-09-02T22:30:48.803+0000",
                    "updated": "2021-09-02T22:31:05.257+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17409144",
                    "id": "17409144",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Ah, thanks [~thisisnic], so I guess we used to define the groups directly in the {{Table}} or {{RecordBatch}} object instead of creating an {{arrow_dplyr_query}}\u00a0object whenever there were groups.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-09-02T22:48:26.440+0000",
                    "updated": "2021-09-02T22:48:26.440+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17409150",
                    "id": "17409150",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "body": "[~icook] I think there might be other things at play as well as we also made big changes to {{arrow:::collect.arrow_dplyr_query()}} but honestly, it's confusing me more, so I'm leaving it as \"the output reported above is as expected and it's just the {{is_writable_table()}} bit that is a problem\".  ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
                        "name": "thisisnic",
                        "key": "thisisnic",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
                        },
                        "displayName": "Nicola Crane",
                        "active": true,
                        "timeZone": "Africa/Casablanca"
                    },
                    "created": "2021-09-02T23:17:11.643+0000",
                    "updated": "2021-09-02T23:17:11.643+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17409519",
                    "id": "17409519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "collect() isn't the issue, this is an unintended consequence of ARROW-11769 and we should figure out how to handle it.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-09-03T13:55:13.212+0000",
                    "updated": "2021-09-03T13:55:13.212+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13398881/comment/17429004",
                    "id": "17429004",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 11315\n[https://github.com/apache/arrow/pull/11315]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-10-14T20:19:52.773+0000",
                    "updated": "2021-10-14T20:19:52.773+0000"
                }
            ],
            "maxResults": 6,
            "total": 6,
            "startAt": 0
        },
        "customfield_12311820": "0|z0uj3c:",
        "customfield_12314139": null
    }
}