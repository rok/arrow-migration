{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13338434",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434",
    "key": "ARROW-10463",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348823",
                "id": "12348823",
                "description": "",
                "name": "3.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-01-25"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12602357",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12602357",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13301902",
                    "key": "ARROW-8631",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13301902",
                    "fields": {
                        "summary": "[C++][Dataset] Add ConvertOptions and ReadOptions to CsvFileFormat",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
            "name": "icook",
            "key": "icook",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
            },
            "displayName": "Ian Cook",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=GabeTheEngineer",
            "name": "GabeTheEngineer",
            "key": "gabetheengineer",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Gabriel Bassett",
            "active": true,
            "timeZone": "America/Chicago"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=GabeTheEngineer",
            "name": "GabeTheEngineer",
            "key": "gabetheengineer",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Gabriel Bassett",
            "active": true,
            "timeZone": "America/Chicago"
        },
        "aggregateprogress": {
            "progress": 19200,
            "total": 19200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 19200,
            "total": 19200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10463/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 32,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533227",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook opened a new pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143\n\n\n   Improves messaging for currently unsupported readr parse options and improves handling in related cases such as ambiguous partial argument names and invalid combinations of Arrow and readr options\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T21:14:27.319+0000",
                    "updated": "2021-01-08T21:14:27.319+0000",
                    "started": "2021-01-08T21:14:27.319+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533227",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533229",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757001158\n\n\n   https://issues.apache.org/jira/browse/ARROW-10463\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T21:14:43.963+0000",
                    "updated": "2021-01-08T21:14:43.963+0000",
                    "started": "2021-01-08T21:14:43.963+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533229",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533255",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757016760\n\n\n   @nealrichardson let me know if you'd also like to me to add a note here in the `dataset_factory()` docs explaining that some readr-style options are not supported https://github.com/apache/arrow/blob/master/r/R/dataset-factory.R#L107-L110\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T21:57:27.348+0000",
                    "updated": "2021-01-08T21:57:27.348+0000",
                    "started": "2021-01-08T21:57:27.347+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533255",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533259",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook edited a comment on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757016760\n\n\n   @nealrichardson let me know if you'd also like to me to explain in the `dataset_factory` and `FileFormat` docs that some readr-style options are not supported in `...`\r\n   - https://github.com/apache/arrow/blob/master/r/R/dataset-factory.R#L107-L110\r\n   - https://github.com/apache/arrow/blob/master/r/R/dataset-format.R#L43-L45\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T22:02:26.704+0000",
                    "updated": "2021-01-08T22:02:26.704+0000",
                    "started": "2021-01-08T22:02:26.704+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533259",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533260",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook edited a comment on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757016760\n\n\n   @nealrichardson let me know if you'd also like to me to add text in these two places in the `dataset_factory` and `FileFormat` docs explaining that some readr-style options are not supported in `...`\r\n   - https://github.com/apache/arrow/blob/master/r/R/dataset-factory.R#L107-L110\r\n   - https://github.com/apache/arrow/blob/master/r/R/dataset-format.R#L43-L45\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T22:03:09.824+0000",
                    "updated": "2021-01-08T22:03:09.824+0000",
                    "started": "2021-01-08T22:03:09.824+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533260",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533276",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554241301\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       If I read the code correctly, we're not distinguishing between arguments that are valid CsvReadOptions/CsvConvertOptions and just not supported in datasets yet (what ARROW-8631 is about) and plain garbage `asdfasdrfwea` options. Is that distinction worth making? I.e. is erroring with `Unsupported option: na` clear enough that we're not going to get another bug report about this?\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n\nReview comment:\n       Why does this need to be asserted? Because the validating code assumes it?\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n\nReview comment:\n       You don't have to use it here, but for reference we have an `oxford_paste` utility function for making human-readable, appropriately comma'd error message strings: https://github.com/apache/arrow/blob/master/r/R/util.R#L18\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n+         call. = FALSE)\n+  }\n+  is_ambig_opt <- is.na(pmatch(opt_names, c(arrow_opts, readr_opts)))\n\nReview comment:\n       Could you add a comment here explaining how this catches ambiguous args? I don't use `pmatch` enough for this to be immediately apparent. \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T23:15:49.325+0000",
                    "updated": "2021-01-08T23:15:49.325+0000",
                    "started": "2021-01-08T23:15:49.325+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533276",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533277",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757043963\n\n\n   > @nealrichardson let me know if you'd also like to me to add text in these two places in the `dataset_factory` and `FileFormat` docs explaining that some readr-style options are not supported in `...`\r\n   \r\n   You could, but IMO a better (though not mutually exclusive) solution would be to use the error message to tell you that more clearly https://github.com/apache/arrow/pull/9143#discussion_r554241301\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T23:17:16.673+0000",
                    "updated": "2021-01-08T23:17:16.673+0000",
                    "started": "2021-01-08T23:17:16.672+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533277",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533278",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson edited a comment on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757043963\n\n\n   > @nealrichardson let me know if you'd also like to me to add text in these two places in the `dataset_factory` and `FileFormat` docs explaining that some readr-style options are not supported in `...`\r\n   \r\n   You could, but IMO a better (though not mutually exclusive) solution would be to use the error message to tell you that more clearly https://github.com/apache/arrow/pull/9143#discussion_r554241301. I don't assume people read help pages, at least not that closely.\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-08T23:18:00.082+0000",
                    "updated": "2021-01-08T23:18:00.082+0000",
                    "started": "2021-01-08T23:18:00.082+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533278",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533310",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554271178\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n\nReview comment:\n       The code in `csv_file_format_parse_options()` in `dataset-format.R` will error or behave incorrectly if any of the Arrow file parsing options (`delimiter`, `quoting`, etc.) happens to have exactly the same name as any of the supported readr-style options (`delim`, `quote`, etc.). Some future change might accidentally cause these two lists of option names to overlap, so I added this test which will fail if that happens.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T01:34:43.838+0000",
                    "updated": "2021-01-09T01:34:43.838+0000",
                    "started": "2021-01-09T01:34:43.838+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533310",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533323",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554277501\n\n\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n+         call. = FALSE)\n+  }\n+  is_ambig_opt <- is.na(pmatch(opt_names, c(arrow_opts, readr_opts)))\n\nReview comment:\n       `arrow_opts` is a vector of the names of the allowed arguments to `CsvParseOptions$create()` (Arrow-style arguments). `readr_opts` is a vector of the names of the allowed arguments to `readr_to_csv_parse_options()` (readr-style arguments).\r\n   ```r\r\n   arrow_opts\r\n   ## [1] \"delimiter\"          \"quoting\"            \"quote_char\"         \"double_quote\"       \"escaping\"          \r\n   ## [6] \"escape_char\"        \"newlines_in_values\" \"ignore_empty_lines\"\r\n   \r\n   readr_opts\r\n   ## [1] \"delim\"            \"quote\"            \"escape_double\"    \"escape_backslash\" \"skip_empty_rows\"\r\n   ```\r\n   The function we're inside here (`csv_file_format_parse_options()`) allows _either_ of these sets of arguments. These two sets of argument names are mutually exclusive, but R's partial matching of argument names throws a wrench in that. For example, if someone shortens either `delimiter` or `delim` to just `del`, that would work fine in a function that accepts _only_ Arrow-style arguments or _only_ readr-style options, but here it creates ambiguity\u2014we can't tell if the user is intending to specify Arrow-style arguments or readr-style arguments.\r\n   \r\n   ```r\r\n   open_dataset(\"/path/to/csv/\", format = \"csv\", del = \";\")\r\n   ## \ud83d\udc80\r\n   ```\r\n   So `pmatch()` to the rescue. `pmatch()`, when called like it is here, uses the same algorithm for partial matching that R uses to identify named arguments in function calls. `pmatch(x, y)` returns a vector of the same length as `x`, and in each position, the value will be `NA` if and only if the character string in that position in `x` _cannot_ be unambiguously matched to exactly one character string in `y`. So if there are any `NA` values in the vector returned by `pmatch()`, that means at least one of the argument names is ambiguous.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T02:25:44.947+0000",
                    "updated": "2021-01-09T02:25:44.947+0000",
                    "started": "2021-01-09T02:25:44.947+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533323",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533324",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554278223\n\n\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n\nReview comment:\n       Oh nice. Do we have any go-to functions for handling singular/plural (so that the \"s\" in \"options\" could be conditionally excluded/included)?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T02:33:12.391+0000",
                    "updated": "2021-01-09T02:33:12.391+0000",
                    "started": "2021-01-09T02:33:12.390+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533324",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533327",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554280501\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n\nReview comment:\n       Ok, that's what I figured. Could you please add a comment here explaining that?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T02:55:06.374+0000",
                    "updated": "2021-01-09T02:55:06.374+0000",
                    "started": "2021-01-09T02:55:06.373+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533327",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533328",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554280774\n\n\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n\nReview comment:\n       I don't think we do, though I've definitely written various `pluralize` util functions in the past, and we could add one here (if a dependency doesn't already provide one; we should check `asserthat` and `rlang`)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T02:57:21.092+0000",
                    "updated": "2021-01-09T02:57:21.092+0000",
                    "started": "2021-01-09T02:57:21.092+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533328",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533329",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554280947\n\n\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n+         call. = FALSE)\n+  }\n+  is_ambig_opt <- is.na(pmatch(opt_names, c(arrow_opts, readr_opts)))\n\nReview comment:\n       Got it. So this works because we've already filtered out the case where there's no match in each list separately, so if there's no unambiguous match when together, it must mean that there were multiple matches.\r\n   \r\n   Can you add an inline comment to that effect? \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T02:58:54.360+0000",
                    "updated": "2021-01-09T02:58:54.360+0000",
                    "started": "2021-01-09T02:58:54.359+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533329",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533452",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554441947\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       Right. If you think it's worth it, I'll add some additional code here to get the full list of rlang options that `read_delim_arrow()`supports and compute a set difference with the names of the rlang options currently supported here. Then in the case where the user specifies one of those options, I'll give a more specific error message.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T15:58:52.686+0000",
                    "updated": "2021-01-09T15:58:52.686+0000",
                    "started": "2021-01-09T15:58:52.685+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533452",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533453",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554441947\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       Right. If you think it's worth it, I'll add some additional code here to get the full list of rlang options that `read_delim_arrow()` supports and compute a set difference with the names of the rlang options currently supported here. Then in the case where the user specifies one of those options, I'll give a more specific error message.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T15:59:05.636+0000",
                    "updated": "2021-01-09T15:59:05.636+0000",
                    "started": "2021-01-09T15:59:05.636+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533453",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533492",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554476336\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       Yeah, I think we need to distinguish in the error message between \"your fault\" and \"our fault/not implemented\"--what you as a user do with that information is very different.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-09T21:42:19.861+0000",
                    "updated": "2021-01-09T21:42:19.861+0000",
                    "started": "2021-01-09T21:42:19.861+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533492",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533640",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#discussion_r554241301\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       If I read the code correctly, we're not distinguishing between arguments that are valid CsvReadOptions/CsvConvertOptions and just not supported in datasets yet (what ARROW-8631 is about) and plain garbage `asdfasdrfwea` options. Is that distinction worth making? I.e. is erroring with `Unsupported option: na` clear enough that we're not going to get another bug report about this?\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n\nReview comment:\n       Why does this need to be asserted? Because the validating code assumes it?\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n\nReview comment:\n       You don't have to use it here, but for reference we have an `oxford_paste` utility function for making human-readable, appropriately comma'd error message strings: https://github.com/apache/arrow/blob/master/r/R/util.R#L18\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n+         call. = FALSE)\n+  }\n+  is_ambig_opt <- is.na(pmatch(opt_names, c(arrow_opts, readr_opts)))\n\nReview comment:\n       Could you add a comment here explaining how this catches ambiguous args? I don't use `pmatch` enough for this to be immediately apparent. \n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n\nReview comment:\n       Ok, that's what I figured. Could you please add a comment here explaining that?\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n\nReview comment:\n       I don't think we do, though I've definitely written various `pluralize` util functions in the past, and we could add one here (if a dependency doesn't already provide one; we should check `asserthat` and `rlang`)\n\n##########\nFile path: r/R/dataset-format.R\n##########\n@@ -104,9 +104,31 @@ CsvFileFormat$create <- function(..., opts = csv_file_format_parse_options(...))\n }\n \n csv_file_format_parse_options <- function(...) {\n+  opt_names <- names(list(...))\n   # Support both the readr spelling of options and the arrow spelling\n-  readr_opts <- c(\"delim\", \"quote\", \"escape_double\", \"escape_backslash\", \"skip_empty_rows\")\n-  if (any(readr_opts %in% names(list(...)))) {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+  is_arrow_opt <- !is.na(pmatch(opt_names, arrow_opts))\n+  is_readr_opt <- !is.na(pmatch(opt_names, readr_opts))\n+  bad_opts <- opt_names[!is_arrow_opt & !is_readr_opt]\n+  if (length(bad_opts)) {\n+    stop(\"Unsupported options: \",\n+         paste(bad_opts, collapse = \", \"),\n+         call. = FALSE)\n+  }\n+  is_ambig_opt <- is.na(pmatch(opt_names, c(arrow_opts, readr_opts)))\n\nReview comment:\n       Got it. So this works because we've already filtered out the case where there's no match in each list separately, so if there's no unambiguous match when together, it must mean that there were multiple matches.\r\n   \r\n   Can you add an inline comment to that effect? \n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -303,11 +303,54 @@ test_that(\"Other text delimited dataset\", {\n       filter(integer > 6) %>%\n       summarize(mean = mean(integer))\n   )\n+})\n+\n+test_that(\"readr parse options\", {\n+  arrow_opts <- names(formals(CsvParseOptions$create))\n+  readr_opts <- names(formals(readr_to_csv_parse_options))\n+\n+  # Arrow and readr options are mutually exclusive\n+  expect_equal(\n+    intersect(arrow_opts, readr_opts),\n+    character(0)\n+  )\n \n-  # Now with readr option spelling (and omitting format = \"text\")\n-  ds3 <- open_dataset(tsv_dir, partitioning = \"part\", delim = \"\\t\")\n+  # With unsupported readr parse options\n+  # (remove this after ARROW-8631)\n+  if (!\"na\" %in% readr_opts) {\n\nReview comment:\n       Yeah, I think we need to distinguish in the error message between \"your fault\" and \"our fault/not implemented\"--what you as a user do with that information is very different.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-10T04:04:42.062+0000",
                    "updated": "2021-01-10T04:04:42.062+0000",
                    "started": "2021-01-10T04:04:42.061+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533640",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533670",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757001158\n\n\n   https://issues.apache.org/jira/browse/ARROW-10463\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-10T04:07:17.932+0000",
                    "updated": "2021-01-10T04:07:17.932+0000",
                    "started": "2021-01-10T04:07:17.931+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533670",
                    "issueId": "13338434"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/worklog/533722",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook edited a comment on pull request #9143:\nURL: https://github.com/apache/arrow/pull/9143#issuecomment-757016760\n\n\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-10T04:12:47.722+0000",
                    "updated": "2021-01-10T04:12:47.722+0000",
                    "started": "2021-01-10T04:12:47.722+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "533722",
                    "issueId": "13338434"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 19200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@395dd434[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a10e5b0[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1ab06baa[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@67703029[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76195346[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@64c2a66e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7db67c67[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1b21ea80[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@279e19c1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@561e2a8a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1805216a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@ce4ad00[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 19200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jan 12 03:31:02 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-01-12T03:31:02.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10463/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2020-11-02T14:32:01.000+0000",
        "updated": "2021-01-12T03:31:14.000+0000",
        "timeoriginalestimate": null,
        "description": "While read_csv_arrow()'s signature matches readr,\u00a0 the readr_to_csv_parse_options() function (called by way of open_dataset()) only appears to capture a subset of those options:\r\n\r\n(https://github.com/apache/arrow/blob/883eb572bc64430307112895976ba79df10c8c7d/r/R/csv.R#L464)\r\n{code:java}\r\nreadr_to_csv_parse_options <- function(delim = \",\",\r\n quote = '\"',\r\n escape_double = TRUE,\r\n escape_backslash = FALSE,\r\n skip_empty_rows = TRUE){code}\r\nI ran into this trying to use a non-standard 'na' value:\r\n\r\n\u00a0\r\n{code:java}\r\nopen_dataset(\"/path/to/csv/directory/\", schema = sch, partitioning=NULL, format=\"csv\", delim=\";\", na=\"\\\\N\", escape_backslash=TRUE, escape_double=FALSE`)\r\nError in readr_to_csv_parse_options(...) : unused argument (na = \"\\\\N\")\r\n{code}\r\n\u00a0",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 19200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Better messaging for currently unsupported CSV options in open_dataset",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/comment/17224778",
                    "id": "17224778",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Thanks for the report. This is actually ARROW-8631--the single file reader supports this option but CSV datasets do not. The Arrow CSV reader collects options into three separate objects, and {{na}} goes into ConvertOptions: https://github.com/apache/arrow/blob/883eb572bc64430307112895976ba79df10c8c7d/r/R/csv.R#L178. But the Dataset module only knows about ReadOptions, so it tries to interpret all {{...}} args as ReadOptions https://github.com/apache/arrow/blob/883eb572bc64430307112895976ba79df10c8c7d/r/R/dataset-format.R#L125\r\n\r\nARROW-8631 is the ticket to implement this feature; I'll use this ticket to make the error message clearer in R in the meantime.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2020-11-02T16:10:36.976+0000",
                    "updated": "2020-11-02T16:10:36.976+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/comment/17262867",
                    "id": "17262867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "[PR #9143|https://github.com/apache/arrow/pull/9143] improves the error message that occurs when the user specifies unsupported readr-style options. The example above would yield this error message:\r\n{code:r}\r\n Error: The following option is supported in \"read_delim_arrow\" functions but not yet supported here: \"na\" \r\n{code}\r\nThe added code matches both full and partial option names and improves handling of several other modes of unsupported options.\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-01-11T18:55:59.366+0000",
                    "updated": "2021-01-11T18:55:59.366+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13338434/comment/17263050",
                    "id": "17263050",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 9143\n[https://github.com/apache/arrow/pull/9143]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-01-12T03:31:02.494+0000",
                    "updated": "2021-01-12T03:31:02.494+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z0k7rc:",
        "customfield_12314139": null
    }
}