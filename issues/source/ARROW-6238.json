{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13250844",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844",
    "key": "ARROW-6238",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "dataset",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12569631",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12569631",
                "type": {
                    "id": "12310060",
                    "name": "Container",
                    "inward": "Is contained by",
                    "outward": "contains",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310060"
                },
                "outwardIssue": {
                    "id": "13248893",
                    "key": "ARROW-6138",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13248893",
                    "fields": {
                        "summary": "[C++] Add a basic (single RecordBatch) implementation of Dataset",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            },
            {
                "id": "12568467",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12568467",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "inwardIssue": {
                    "id": "13250886",
                    "key": "ARROW-6242",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250886",
                    "fields": {
                        "summary": "[C++] Implements basic Dataset/Scanner/ScannerBuilder",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                            "id": "2",
                            "description": "A new feature of the product, which has yet to be developed.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                            "name": "New Feature",
                            "subtask": false,
                            "avatarId": 21141
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6238/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 24,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/298044",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implements SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140\n \n \n   The Simple* family of classes are iterator backed by explicit vectors. This can be useful to represent a memory datasource that rarely changes, e.g. a constant join table.\r\n   \r\n   - SimpleDataSource is backed by a vector<DataFragment>.\r\n   - SimpleDataFragment is backed by a vector<RecordBatch>.\r\n   - SimpleScanTask is backed by a vector<RecordBatch>.\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T17:16:56.817+0000",
                    "updated": "2019-08-20T17:16:56.817+0000",
                    "started": "2019-08-20T17:16:56.816+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "298044",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/298063",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implements SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r315817367\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.h\n ##########\n @@ -53,6 +53,23 @@ class ARROW_DS_EXPORT DataFragment {\n   virtual ~DataFragment() = default;\n };\n \n+/// \\brief A trivial DataFragment that yields ScanTask out of a fixed set of\n+/// RecordBatch.\n+class ARROW_DS_EXPORT SimpleDataFragment : public DataFragment {\n+ public:\n+  explicit SimpleDataFragment(std::vector<std::shared_ptr<RecordBatch>> record_batches);\n+\n+  Status Scan(std::shared_ptr<ScanContext> scan_context,\n+                  std::unique_ptr<ScanTaskIterator>* out) override;\n+\n+  bool splittable() const override { return false; }\n \n Review comment:\n   I'm not sure about this interface, I think we should delete until we make use of it, YAGNI.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T17:38:48.577+0000",
                    "updated": "2019-08-20T17:38:48.577+0000",
                    "started": "2019-08-20T17:38:48.577+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "298063",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/298125",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5140: ARROW-6238: [C++][Dataset] Implements SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r315872851\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.h\n ##########\n @@ -53,6 +53,23 @@ class ARROW_DS_EXPORT DataFragment {\n   virtual ~DataFragment() = default;\n };\n \n+/// \\brief A trivial DataFragment that yields ScanTask out of a fixed set of\n+/// RecordBatch.\n+class ARROW_DS_EXPORT SimpleDataFragment : public DataFragment {\n+ public:\n+  explicit SimpleDataFragment(std::vector<std::shared_ptr<RecordBatch>> record_batches);\n+\n+  Status Scan(std::shared_ptr<ScanContext> scan_context,\n+                  std::unique_ptr<ScanTaskIterator>* out) override;\n+\n+  bool splittable() const override { return false; }\n \n Review comment:\n   sounds fine to me; sub-file data fragments sounds like something we'd want to handle at the DataSource level anyhow\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-20T19:50:57.720+0000",
                    "updated": "2019-08-20T19:50:57.720+0000",
                    "started": "2019-08-20T19:50:57.720+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "298125",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299516",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316762220\n \n \n\n ##########\n File path: cpp/src/arrow/util/iterator.h\n ##########\n @@ -78,8 +78,35 @@ class VectorIterator : public Iterator<T> {\n };\n \n template <typename T>\n-std::unique_ptr<VectorIterator<T>> MakeIterator(std::vector<T> v) {\n+std::unique_ptr<Iterator<T>> MakeIterator(std::vector<T> v) {\n   return std::unique_ptr<VectorIterator<T>>(new VectorIterator<T>(std::move(v)));\n }\n \n+template <typename Fn, typename I, typename O = typename std::result_of<Fn(I)>::type>\n+class MapIterator : public Iterator<O> {\n \n Review comment:\n   Add a small docstring?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:49.961+0000",
                    "updated": "2019-08-22T16:15:49.961+0000",
                    "started": "2019-08-22T16:15:49.960+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299516",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299517",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316762526\n \n \n\n ##########\n File path: cpp/src/arrow/util/iterator.h\n ##########\n @@ -78,8 +78,35 @@ class VectorIterator : public Iterator<T> {\n };\n \n template <typename T>\n-std::unique_ptr<VectorIterator<T>> MakeIterator(std::vector<T> v) {\n+std::unique_ptr<Iterator<T>> MakeIterator(std::vector<T> v) {\n   return std::unique_ptr<VectorIterator<T>>(new VectorIterator<T>(std::move(v)));\n }\n \n+template <typename Fn, typename I, typename O = typename std::result_of<Fn(I)>::type>\n+class MapIterator : public Iterator<O> {\n+ public:\n+  explicit MapIterator(Fn map, std::unique_ptr<Iterator<I>> it)\n+      : map_(map), it_(std::move(it)) {}\n \n Review comment:\n   Why no `std::move` for `map`? Some callables, e.g. closures, may have a non-trivial payload.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.222+0000",
                    "updated": "2019-08-22T16:15:50.222+0000",
                    "started": "2019-08-22T16:15:50.222+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299517",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299518",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316763872\n \n \n\n ##########\n File path: cpp/src/arrow/testing/gtest_util.h\n ##########\n @@ -345,4 +346,71 @@ void AssertSortedEquals(std::vector<T> u, std::vector<T> v) {\n   ASSERT_EQ(u, v);\n }\n \n+// Mixin used to generate trivial Array/RecordBatch/RecordBatchReader\n+class ArrowBaseFixtureMixin {\n \n Review comment:\n   I think we should avoid \"fixtures\" that have no internal state. They complicate usage vs. a bunch of utility functions.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.516+0000",
                    "updated": "2019-08-22T16:15:50.516+0000",
                    "started": "2019-08-22T16:15:50.516+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299518",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299519",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316764813\n \n \n\n ##########\n File path: cpp/src/arrow/testing/gtest_util.h\n ##########\n @@ -345,4 +346,71 @@ void AssertSortedEquals(std::vector<T> u, std::vector<T> v) {\n   ASSERT_EQ(u, v);\n }\n \n+// Mixin used to generate trivial Array/RecordBatch/RecordBatchReader\n+class ArrowBaseFixtureMixin {\n+ public:\n+  template <typename T>\n+  std::shared_ptr<Array> GetArray(int64_t size, std::shared_ptr<DataType> type,\n \n Review comment:\n   Call this `GetZerosArray` or `GetArrayOfZeros`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.524+0000",
                    "updated": "2019-08-22T16:15:50.524+0000",
                    "started": "2019-08-22T16:15:50.524+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299519",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299520",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316767830\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n \n Review comment:\n   This helper function could be folded into `Scan`, no?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.565+0000",
                    "updated": "2019-08-22T16:15:50.565+0000",
                    "started": "2019-08-22T16:15:50.565+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299520",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299521",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316767014\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches,\n+    std::unique_ptr<ScanTaskIterator>* out) {\n+  auto it = MakeIterator(std::move(record_batches));\n+\n+  // Wraps a RecordBatch in a ScanTask\n+  auto map = [](std::shared_ptr<RecordBatch> batch) -> std::unique_ptr<ScanTask> {\n+    std::vector<std::shared_ptr<RecordBatch>> batches{batch};\n+    return internal::make_unique<SimpleScanTask>(std::move(batches));\n+  };\n+\n+  *out = MakeMapIterator(map, std::move(it));\n+  return Status::OK();\n+}\n+\n+Status SimpleDataFragment::Scan(std::shared_ptr<ScanContext> scan_context,\n+                                std::unique_ptr<ScanTaskIterator>* out) {\n+  // Make an explicit copy of record_batches_ to ensure GetTasks can be called\n \n Review comment:\n   By \"GetTasks\", you mean \"Scan\"?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.588+0000",
                    "updated": "2019-08-22T16:15:50.588+0000",
                    "started": "2019-08-22T16:15:50.588+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299521",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299522",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316765448\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/test_util.h\n ##########\n @@ -133,6 +133,50 @@ class GeneratedRecordBatch : public RecordBatchReader {\n   Gen gen_;\n };\n \n+class DatasetFixtureMixin : public ::testing::Test {\n+ public:\n+  DatasetFixtureMixin() : ctx_(std::make_shared<ScanContext>()) {}\n+\n+ protected:\n+  std::shared_ptr<ScanOptions> options_;\n+  std::shared_ptr<ScanContext> ctx_;\n+};\n+\n+class TestDataFragmentMixin : public DatasetFixtureMixin {\n+ public:\n+  /// \\brief Ensure that record batches found in reader are equals to the\n+  /// record batches yielded by the data fragment.\n+  void EnsureEquals(RecordBatchReader* expected, DataFragment* fragment) {\n \n Review comment:\n   Call this `AssertFragmentEqual`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.591+0000",
                    "updated": "2019-08-22T16:15:50.591+0000",
                    "started": "2019-08-22T16:15:50.591+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299522",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299523",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316765778\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/test_util.h\n ##########\n @@ -133,6 +133,50 @@ class GeneratedRecordBatch : public RecordBatchReader {\n   Gen gen_;\n };\n \n+class DatasetFixtureMixin : public ::testing::Test {\n+ public:\n+  DatasetFixtureMixin() : ctx_(std::make_shared<ScanContext>()) {}\n+\n+ protected:\n+  std::shared_ptr<ScanOptions> options_;\n+  std::shared_ptr<ScanContext> ctx_;\n+};\n+\n+class TestDataFragmentMixin : public DatasetFixtureMixin {\n+ public:\n+  /// \\brief Ensure that record batches found in reader are equals to the\n+  /// record batches yielded by the data fragment.\n+  void EnsureEquals(RecordBatchReader* expected, DataFragment* fragment) {\n+    std::unique_ptr<ScanTaskIterator> it;\n+    ARROW_EXPECT_OK(fragment->Scan(ctx_, &it));\n+\n+    ARROW_EXPECT_OK(it->Visit([expected](std::unique_ptr<ScanTask> task) -> Status {\n+      auto batch_it = task->Scan();\n+      return batch_it->Visit([expected](std::shared_ptr<RecordBatch> rhs) -> Status {\n+        std::shared_ptr<RecordBatch> lhs;\n+        RETURN_NOT_OK(expected->ReadNext(&lhs));\n+        EXPECT_NE(lhs, nullptr);\n+        AssertBatchesEqual(*lhs, *rhs);\n+        return Status::OK();\n+      });\n+    }));\n+  }\n+};\n+\n+class TestDataSourceMixin : public TestDataFragmentMixin {\n+ public:\n+  /// \\brief Ensure that record batches found in reader are equals to the\n+  /// record batches yielded by the data fragments of a source.\n+  void EnsureEquals(RecordBatchReader* expected, DataSource* source) {\n \n Review comment:\n   `AssertDataSourceEqual`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T16:15:50.640+0000",
                    "updated": "2019-08-22T16:15:50.640+0000",
                    "started": "2019-08-22T16:15:50.639+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299523",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299582",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316791508\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n \n Review comment:\n   Yes, this got lost in a rebase (which renamed the function).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T17:12:23.820+0000",
                    "updated": "2019-08-22T17:12:23.820+0000",
                    "started": "2019-08-22T17:12:23.819+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299582",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299583",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316791508\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n \n Review comment:\n   Yes, this got lost in a rebase (which renamed the function).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T17:12:43.853+0000",
                    "updated": "2019-08-22T17:12:43.853+0000",
                    "started": "2019-08-22T17:12:43.852+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299583",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299584",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316791731\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches,\n+    std::unique_ptr<ScanTaskIterator>* out) {\n+  auto it = MakeIterator(std::move(record_batches));\n+\n+  // Wraps a RecordBatch in a ScanTask\n+  auto map = [](std::shared_ptr<RecordBatch> batch) -> std::unique_ptr<ScanTask> {\n+    std::vector<std::shared_ptr<RecordBatch>> batches{batch};\n+    return internal::make_unique<SimpleScanTask>(std::move(batches));\n+  };\n+\n+  *out = MakeMapIterator(map, std::move(it));\n+  return Status::OK();\n+}\n+\n+Status SimpleDataFragment::Scan(std::shared_ptr<ScanContext> scan_context,\n+                                std::unique_ptr<ScanTaskIterator>* out) {\n+  // Make an explicit copy of record_batches_ to ensure GetTasks can be called\n \n Review comment:\n   Yes, this got lost in a rebase (which renamed the function).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T17:12:50.915+0000",
                    "updated": "2019-08-22T17:12:50.915+0000",
                    "started": "2019-08-22T17:12:50.915+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299584",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299592",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r316793390\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -0,0 +1,56 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+#include \"arrow/dataset/dataset.h\"\n+\n+#include <memory>\n+#include <utility>\n+\n+#include \"arrow/dataset/scanner.h\"\n+#include \"arrow/util/stl.h\"\n+\n+namespace arrow {\n+namespace dataset {\n+\n+SimpleDataFragment::SimpleDataFragment(\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches)\n+    : record_batches_(std::move(record_batches)) {}\n+\n+Status ScanTaskIteratorFromRecordBatches(\n \n Review comment:\n   The later function was initially more verbose thus the separation, I'll fold it.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T17:17:01.468+0000",
                    "updated": "2019-08-22T17:17:01.468+0000",
                    "started": "2019-08-22T17:17:01.468+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299592",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/299841",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#issuecomment-524131140\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=h1) Report\n   > Merging [#5140](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/3c9236d198b93ae3f59d39ce958909a1909078f5?src=pr&el=desc) will **increase** coverage by `1.58%`.\n   > The diff coverage is `78.07%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/5140/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #5140      +/-   ##\n   ==========================================\n   + Coverage   87.63%   89.22%   +1.58%     \n   ==========================================\n     Files        1022      742     -280     \n     Lines      146258   105507   -40751     \n     Branches     1437        0    -1437     \n   ==========================================\n   - Hits       128174    94137   -34037     \n   + Misses      17722    11370    -6352     \n   + Partials      362        0     -362\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/dataset/scanner.cc](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L3NjYW5uZXIuY2M=) | `100% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/dataset/dataset\\_test.cc](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L2RhdGFzZXRfdGVzdC5jYw==) | `100% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/dataset/test\\_util.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L3Rlc3RfdXRpbC5o) | `91.83% <100%> (+2.36%)` | :arrow_up: |\n   | [cpp/src/arrow/util/iterator.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2l0ZXJhdG9yLmg=) | `100% <100%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/arrow/dataset/scanner.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L3NjYW5uZXIuaA==) | `100% <100%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/arrow/dataset/dataset.cc](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L2RhdGFzZXQuY2M=) | `100% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/testing/gtest\\_util.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy90ZXN0aW5nL2d0ZXN0X3V0aWwuaA==) | `80.53% <45.94%> (-16.84%)` | :arrow_down: |\n   | [cpp/src/arrow/dataset/dataset.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9kYXRhc2V0L2RhdGFzZXQuaA==) | `76.92% <50%> (-23.08%)` | :arrow_down: |\n   | [cpp/src/arrow/testing/util.h](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy90ZXN0aW5nL3V0aWwuaA==) | `91.3% <80%> (-3.15%)` | :arrow_down: |\n   | [cpp/src/arrow/csv/column\\_builder.cc](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvY29sdW1uX2J1aWxkZXIuY2M=) | `95.54% <0%> (-1.49%)` | :arrow_down: |\n   | ... and [289 more](https://codecov.io/gh/apache/arrow/pull/5140/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=footer). Last update [3c9236d...2d41566](https://codecov.io/gh/apache/arrow/pull/5140?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-23T00:52:35.248+0000",
                    "updated": "2019-08-23T00:52:35.248+0000",
                    "started": "2019-08-23T00:52:35.247+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299841",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/300315",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on issue #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#issuecomment-524352247\n \n \n   @pitrou comments were addressed.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-23T15:10:23.781+0000",
                    "updated": "2019-08-23T15:10:23.781+0000",
                    "started": "2019-08-23T15:10:23.780+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "300315",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/300865",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r317404440\n \n \n\n ##########\n File path: cpp/src/arrow/testing/gtest_util.h\n ##########\n @@ -345,4 +346,70 @@ void AssertSortedEquals(std::vector<T> u, std::vector<T> v) {\n   ASSERT_EQ(u, v);\n }\n \n+// Mixin used to generate trivial Array/RecordBatch/RecordBatchReader\n+template <typename T>\n+static inline std::shared_ptr<Array> GetArray(int64_t size,\n+                                              std::shared_ptr<DataType> type,\n+                                              T value = 0) {\n+  using BuilderType = typename CTypeTraits<T>::BuilderType;\n+  auto builder_fn = [](BuilderType* builder) { builder->UnsafeAppend(T(0)); };\n+  ASSERT_OK_AND_ASSIGN(auto array, ArrayFromBuilderVisitor(type, size, builder_fn));\n+  return array;\n+}\n \n Review comment:\n   Personally I would implement `Zeros<T>(size)` to go alongside the current functions in testing/random.h\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-25T15:58:54.943+0000",
                    "updated": "2019-08-25T15:58:54.943+0000",
                    "started": "2019-08-25T15:58:54.943+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "300865",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/300866",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r317404480\n \n \n\n ##########\n File path: cpp/src/arrow/testing/util.h\n ##########\n @@ -177,4 +177,26 @@ Result<std::shared_ptr<Array>> ArrayFromBuilderVisitor(\n   return ArrayFromBuilderVisitor(type, length, length, std::forward<Fn>(fn));\n }\n \n+class RepeatedRecordBatch : public RecordBatchReader {\n+ public:\n+  RepeatedRecordBatch(int64_t repetitions, std::shared_ptr<RecordBatch> batch)\n+      : repetitions_(repetitions), batch_(std::move(batch)) {}\n+\n+  std::shared_ptr<Schema> schema() const override { return batch_->schema(); }\n+\n+  Status ReadNext(std::shared_ptr<RecordBatch>* batch) override {\n+    if (repetitions_ > 0) {\n+      *batch = batch_;\n+      --repetitions_;\n+    } else {\n+      *batch = nullptr;\n+    }\n+    return Status::OK();\n+  }\n+\n+ private:\n+  int64_t repetitions_;\n+  std::shared_ptr<RecordBatch> batch_;\n+};\n \n Review comment:\n   I still find this really narrow -- I commented on ARROW-6161 about this. Wouldn't passing `std::vector<shared_ptr<RecordBatch>>` be more generally useful? You can even create a function `RepeatVector(val, num)` to make generating the vector easy\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-25T15:58:54.946+0000",
                    "updated": "2019-08-25T15:58:54.946+0000",
                    "started": "2019-08-25T15:58:54.946+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "300866",
                    "issueId": "13250844"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/worklog/300867",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5140: ARROW-6238: [C++][Dataset] Implement SimpleDataSource, SimpleDataFragment and SimpleScanTask\nURL: https://github.com/apache/arrow/pull/5140#discussion_r317404571\n \n \n\n ##########\n File path: cpp/src/arrow/testing/gtest_util.h\n ##########\n @@ -345,4 +346,70 @@ void AssertSortedEquals(std::vector<T> u, std::vector<T> v) {\n   ASSERT_EQ(u, v);\n }\n \n+// Mixin used to generate trivial Array/RecordBatch/RecordBatchReader\n+template <typename T>\n+static inline std::shared_ptr<Array> GetArray(int64_t size,\n+                                              std::shared_ptr<DataType> type,\n+                                              T value = 0) {\n+  using BuilderType = typename CTypeTraits<T>::BuilderType;\n+  auto builder_fn = [](BuilderType* builder) { builder->UnsafeAppend(T(0)); };\n+  ASSERT_OK_AND_ASSIGN(auto array, ArrayFromBuilderVisitor(type, size, builder_fn));\n+  return array;\n+}\n+\n+static inline std::shared_ptr<Array> GetArrayOfZeros(int64_t size,\n+                                                     std::shared_ptr<DataType> type) {\n+  switch (type->id()) {\n+    case Type::BOOL:\n+      return GetArray<bool>(size, type);\n+    case Type::UINT8:\n+      return GetArray<uint8_t>(size, type);\n+    case Type::UINT16:\n+      return GetArray<uint16_t>(size, type);\n+    case Type::UINT32:\n+      return GetArray<uint32_t>(size, type);\n+    case Type::UINT64:\n+      return GetArray<uint64_t>(size, type);\n+    case Type::INT8:\n+      return GetArray<int8_t>(size, type);\n+    case Type::INT16:\n+      return GetArray<int16_t>(size, type);\n+    case Type::INT32:\n+      return GetArray<int32_t>(size, type);\n+    case Type::INT64:\n+      return GetArray<int64_t>(size, type);\n+    case Type::FLOAT:\n+      return GetArray<float>(size, type);\n+    case Type::DOUBLE:\n+      return GetArray<double>(size, type);\n+    default:\n+      std::abort();\n+      break;\n+  }\n+\n+  return nullptr;\n+}\n+\n+static inline std::shared_ptr<RecordBatch> GetRecordBatch(\n+    int64_t size, std::shared_ptr<Schema> schema) {\n+  std::vector<std::shared_ptr<Array>> arrays;\n+\n+  for (const auto& field : schema->fields()) {\n+    arrays.emplace_back(GetArrayOfZeros(size, field->type()));\n+  }\n+\n+  return RecordBatch::Make(schema, size, arrays);\n+}\n+\n+static inline std::shared_ptr<RecordBatchReader> GetRecordBatchReader(\n+    int64_t n_batch, std::shared_ptr<RecordBatch> batch) {\n+  return std::make_shared<RepeatedRecordBatch>(n_batch, batch);\n+}\n+\n+static inline std::shared_ptr<RecordBatchReader> GetRecordBatchReader(\n+    int64_t n_batch, int64_t batch_size, std::shared_ptr<Schema> schema) {\n+  auto batch = GetRecordBatch(batch_size, std::move(schema));\n+  return GetRecordBatchReader(n_batch, std::move(batch));\n+}\n \n Review comment:\n   I don't feel like these functions belong here\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-25T15:58:54.946+0000",
                    "updated": "2019-08-25T15:58:54.946+0000",
                    "started": "2019-08-25T15:58:54.946+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "300867",
                    "issueId": "13250844"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 11400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1962a496[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6cb54c12[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5833df44[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@1ea0cd8c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24a0cae1[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3cfb4263[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7a746347[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@62201d28[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40f5244f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@267b9e68[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7f4cafbb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@1de73427[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 11400,
        "customfield_12312520": null,
        "customfield_12312521": "Sun Aug 25 15:59:42 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-08-25T15:59:42.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6238/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-08-14T18:28:40.000+0000",
        "updated": "2019-09-10T14:09:37.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 11400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Implement SimpleDataSource/SimpleDataFragment",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250844/comment/16915279",
                    "id": "16915279",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 5140\n[https://github.com/apache/arrow/pull/5140]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-25T15:59:42.403+0000",
                    "updated": "2019-08-25T15:59:42.403+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z05o4w:",
        "customfield_12314139": null
    }
}