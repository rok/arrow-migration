{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13413590",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590",
    "key": "ARROW-14808",
    "fields": {
        "parent": {
            "id": "13413587",
            "key": "ARROW-14806",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13413587",
            "fields": {
                "summary": "[R] Implement bindings for lubridate component extraction functions",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                    "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                    "name": "Resolved",
                    "id": "5",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                        "id": 3,
                        "key": "done",
                        "colorName": "green",
                        "name": "Done"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
                    "id": "2",
                    "description": "A new feature of the product, which has yet to be developed.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
                    "name": "New Feature",
                    "subtask": false,
                    "avatarId": 21141
                }
            }
        },
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "good-first-issue",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "aggregateprogress": {
            "progress": 52200,
            "total": 52200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 52200,
            "total": 52200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14808/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 87,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/727152",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg opened a new pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433\n\n\n   The following will be supported in arrow (`base::as.Date()` included to show the difference to `date()`, but not supported):\r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(a = as.POSIXct(\"2012-03-26 23:12:13\", tz = \"America/New_York\"))\r\n   \r\n   df %>%\r\n     mutate(\r\n       a_date = date(a),\r\n       a_date_base = as.Date(a))\r\n   #> # A tibble: 1 \u00d7 3\r\n   #>   a                   a_date     a_date_base\r\n   #>   <dttm>              <date>     <date>     \r\n   #> 1 2012-03-26 23:12:13 2012-03-26 2012-03-27\r\n   ```\r\n   \r\n   ``` r\r\n   suppressPackageStartupMessages(library(arrow))\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(a = as.POSIXct(\"2012-03-26 23:12:13\", tz = \"America/New_York\"))\r\n   df %>% \r\n     arrow_table() %>% \r\n     mutate(\r\n       a_date = date(a)\r\n     ) %>% \r\n     collect()\r\n   #> # A tibble: 1 \u00d7 2\r\n   #>   a                   a_date    \r\n   #>   <dttm>              <date>    \r\n   #> 1 2012-03-26 23:12:13 2012-03-26\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-15 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T17:07:40.150+0000",
                    "updated": "2022-02-15T17:07:40.150+0000",
                    "started": "2022-02-15T17:07:40.150+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727152",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/727154",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#issuecomment-1040543051\n\n\n   https://issues.apache.org/jira/browse/ARROW-14808\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T17:08:15.283+0000",
                    "updated": "2022-02-15T17:08:15.283+0000",
                    "started": "2022-02-15T17:08:15.283+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727154",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/727620",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#issuecomment-1040543051\n\n\n   https://issues.apache.org/jira/browse/ARROW-14808\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T19:05:46.231+0000",
                    "updated": "2022-02-15T19:05:46.231+0000",
                    "started": "2022-02-15T19:05:46.231+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727620",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/727647",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg opened a new pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433\n\n\n   The following will be supported in arrow (`base::as.Date()` included to show the difference to `date()`, but not supported):\r\n   ``` r\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(a = as.POSIXct(\"2012-03-26 23:12:13\", tz = \"America/New_York\"))\r\n   \r\n   df %>%\r\n     mutate(\r\n       a_date = date(a),\r\n       a_date_base = as.Date(a))\r\n   #> # A tibble: 1 \u00d7 3\r\n   #>   a                   a_date     a_date_base\r\n   #>   <dttm>              <date>     <date>     \r\n   #> 1 2012-03-26 23:12:13 2012-03-26 2012-03-27\r\n   ```\r\n   \r\n   ``` r\r\n   suppressPackageStartupMessages(library(arrow))\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   df <- tibble(a = as.POSIXct(\"2012-03-26 23:12:13\", tz = \"America/New_York\"))\r\n   df %>% \r\n     arrow_table() %>% \r\n     mutate(\r\n       a_date = date(a)\r\n     ) %>% \r\n     collect()\r\n   #> # A tibble: 1 \u00d7 2\r\n   #>   a                   a_date    \r\n   #>   <dttm>              <date>    \r\n   #> 1 2012-03-26 23:12:13 2012-03-26\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-15 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-15T19:07:33.402+0000",
                    "updated": "2022-02-15T19:07:33.402+0000",
                    "started": "2022-02-15T19:07:33.402+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "727647",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730043",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r810508832\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,23 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n\nReview comment:\n       This is only necessary in our testing \u2014 right? Something about the way that `compare_dplyr_binding()` or testthat works makes it so we're not getting `lubridate::date()` by default here even though presumably we should since we  call `library(lubridate, warn.conflicts = FALSE)` at the top of this file, yeah?\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Similar to https://github.com/apache/arrow/pull/12431#discussion_r810508212 are the errors that we get if `x` here is something that would be workable for our users?\r\n   \r\n   Separately, what happens if you pass an R object to this instead of a column in an arrow table? Does that work ok?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-19T16:08:34.560+0000",
                    "updated": "2022-02-19T16:08:34.560+0000",
                    "started": "2022-02-19T16:08:34.560+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730043",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730256",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r810919455\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,23 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n\nReview comment:\n       As far as I can tell, that is correct. I never had this issue in an interactive session after loading lubridate I don't think we will be 100% sure until we support namespacing with `pkg::function()` syntax. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T09:17:37.884+0000",
                    "updated": "2022-02-21T09:17:37.884+0000",
                    "started": "2022-02-21T09:17:37.884+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730256",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730303",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r810919455\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,23 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n\nReview comment:\n       As far as I can tell, that is correct. I never had this issue in an interactive session, after attaching lubridate. I don't think we will be 100% sure until we support namespacing with `pkg::function()` syntax. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T10:57:06.407+0000",
                    "updated": "2022-02-21T10:57:06.407+0000",
                    "started": "2022-02-21T10:57:06.406+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730303",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730308",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r810919455\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -711,3 +711,23 @@ test_that(\"am/pm mirror lubridate\", {\n   )\n \n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n\nReview comment:\n       As far as I can tell, that is correct (it is only necessary for testing). I never had this issue in an interactive session, after attaching lubridate. I don't think we will be 100% sure until we support namespacing with `pkg::function()` syntax. \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T11:10:14.178+0000",
                    "updated": "2022-02-21T11:10:14.178+0000",
                    "started": "2022-02-21T11:10:14.178+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730308",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730315",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r811036678\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Q1: I have added some unit tests for _unsupported_ types. And discovered that, unlike {lubridate}, you can cast a `date` from an `integer` in {arrow}. It looks like the integer is interpreted as number of days since epoch. \r\n   ``` r\r\n   suppressPackageStartupMessages(library(arrow))\r\n   call_binding(\"date\", Scalar$create(32L))\r\n   #> Scalar\r\n   #> 1970-02-02\r\n   \r\n   lubridate::date(32L)\r\n   #> Error in as.POSIXlt.numeric(x, tz = tz(x)): 'origin' must be supplied\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-21 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup> \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T11:31:02.329+0000",
                    "updated": "2022-02-21T11:31:02.329+0000",
                    "started": "2022-02-21T11:31:02.329+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730315",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730317",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r811045008\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Q2: Not sure what we want to achieve by calling a binding (in this case `\"date\"`) on an R object. Do we want to support this (should all bindings support R objects as inputs?) or do we just want to make sure the error message is meaningful? \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-21T11:42:21.116+0000",
                    "updated": "2022-02-21T11:42:21.116+0000",
                    "started": "2022-02-21T11:42:21.116+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730317",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730792",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r811830139\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       > Not sure what we want to achieve by calling a binding (in this case \"date\") on an R object\r\n   \r\n   I may be misinterpreting this, but I think maybe what Jon is getting at is whether you could do something like this in an arrow-dplyr chain:\r\n   \r\n   ```\r\n   library(dplyr)\r\n   library(lubridate)\r\n   \r\n   arbitrary_date_object <- ymd_hms(\"2012-03-26 23:12:13\") + days(1:32)\r\n   \r\n   mtcars %>%\r\n     mutate(x = date(arbitrary_date_object))\r\n   \r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-22T11:08:03.513+0000",
                    "updated": "2022-02-22T11:08:03.513+0000",
                    "started": "2022-02-22T11:08:03.513+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730792",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730900",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r811954177\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Thanks, @thisisnic for that example. I think that sort of use of R objects is not supported at all in an _arrow_ pipeline (see my _reprex_ below). So neither the binding for `date()`, nor any of the other lubridate ones would work in that context. \r\n   \r\n   ``` r\r\n   suppressPackageStartupMessages(library(arrow))\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   arbitrary_date_object <- ymd_hms(\"2012-03-26 23:12:13\") + days(1:32)\r\n   # dplyr pipeline\r\n   mtcars %>% \r\n     mutate(x = arbitrary_date_object) %>% \r\n     head(4)\r\n   #>                 mpg cyl disp  hp drat    wt  qsec vs am gear carb\r\n   #> Mazda RX4      21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\r\n   #> Mazda RX4 Wag  21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\r\n   #> Datsun 710     22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\r\n   #> Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\r\n   #>                                  x\r\n   #> Mazda RX4      2012-03-27 23:12:13\r\n   #> Mazda RX4 Wag  2012-03-28 23:12:13\r\n   #> Datsun 710     2012-03-29 23:12:13\r\n   #> Hornet 4 Drive 2012-03-30 23:12:13\r\n   \r\n   # arrow pipeline\r\n   mtcars %>% \r\n     arrow_table() %>% \r\n     mutate(x = arbitrary_date_object) %>% \r\n     collect() %>% \r\n     head(4)\r\n   #> Warning: In x = arbitrary_date_object, only values of size one are recycled;\r\n   #> pulling data into R\r\n   #>    mpg cyl disp  hp drat    wt  qsec vs am gear carb                   x\r\n   #> 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 2012-03-27 23:12:13\r\n   #> 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 2012-03-28 23:12:13\r\n   #> 3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 2012-03-29 23:12:13\r\n   #> 4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1 2012-03-30 23:12:13\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-22 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-22T13:38:24.961+0000",
                    "updated": "2022-02-22T13:38:24.961+0000",
                    "started": "2022-02-22T13:38:24.961+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730900",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/730999",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r812033214\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Take a look at that warning/error message though: recycling of length one _does_ work. \r\n   \r\n   If you want some more context on that I would recommend looking at the PR / jiras related to the error message there \"only values of size one are recycled\" (or possibly even comments around that code. That's what I'd do in this scenario, at least!) and that should have some more context about what/why/how that works.\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-22T14:55:39.070+0000",
                    "updated": "2022-02-22T14:55:39.070+0000",
                    "started": "2022-02-22T14:55:39.070+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "730999",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/731494",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r812745417\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -147,5 +147,7 @@ register_bindings_datetime <- function() {\n   register_binding(\"pm\", function(x) {\n     !call_binding(\"am\", x)\n   })\n-\n+  register_binding(\"date\", function(x) {\n+    x$cast(date32())\n+  })\n\nReview comment:\n       Recycling a vector of length one works. \r\n   ``` r\r\n   suppressPackageStartupMessages(library(arrow))\r\n   suppressPackageStartupMessages(library(dplyr))\r\n   suppressPackageStartupMessages(library(lubridate))\r\n   \r\n   arbitrary_date_object <- ymd_hms(\"2012-03-26 23:12:13\")\r\n   # dplyr pipeline\r\n   mtcars %>% \r\n     mutate(x = arbitrary_date_object) %>% \r\n     head(4)\r\n   #>                 mpg cyl disp  hp drat    wt  qsec vs am gear carb\r\n   #> Mazda RX4      21.0   6  160 110 3.90 2.620 16.46  0  1    4    4\r\n   #> Mazda RX4 Wag  21.0   6  160 110 3.90 2.875 17.02  0  1    4    4\r\n   #> Datsun 710     22.8   4  108  93 3.85 2.320 18.61  1  1    4    1\r\n   #> Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1\r\n   #>                                  x\r\n   #> Mazda RX4      2012-03-26 23:12:13\r\n   #> Mazda RX4 Wag  2012-03-26 23:12:13\r\n   #> Datsun 710     2012-03-26 23:12:13\r\n   #> Hornet 4 Drive 2012-03-26 23:12:13\r\n   \r\n   # arrow pipeline\r\n   mtcars %>% \r\n     arrow_table() %>% \r\n     mutate(x = arbitrary_date_object) %>% \r\n     collect() %>% \r\n     head(4)\r\n   #>    mpg cyl disp  hp drat    wt  qsec vs am gear carb                   x\r\n   #> 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4 2012-03-26 23:12:13\r\n   #> 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4 2012-03-26 23:12:13\r\n   #> 3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1 2012-03-26 23:12:13\r\n   #> 4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1 2012-03-26 23:12:13\r\n   ```\r\n   \r\n   <sup>Created on 2022-02-23 by the [reprex package](https://reprex.tidyverse.org) (v2.0.1)</sup>\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-23T10:23:21.076+0000",
                    "updated": "2022-02-23T10:23:21.076+0000",
                    "started": "2022-02-23T10:23:21.076+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "731494",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/731943",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r813328095\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -164,4 +164,10 @@ register_bindings_datetime <- function() {\n       return(semester)\n     }\n   })\n+  register_binding(\"date\", function(x) {\n+    if (inherits(x, \"POSIXct\")) {\n+      x <- vec_to_Array(x, date32())\n+    }\n+    x$cast(date32())\n\nReview comment:\n       This implementation made me think of the various `as.*` methods we have defined [1] (since this is similar to `as.Date()`). Which all use a simpler setup to create a cast operation. However, I noticed that for those, they are using `Expression$create(...)` rather than the `build_expr(...)` helper [2]. That `build_expr(...)` here _should_ handle the wrapping of R objects into Scalars that you're doing in this first bit here. Can you try that out and confirm that it does what we are looking for with inputs that are both columns in an arrow table/recordbatch/dataset etc. as well as if it's a single value from R (i.e. `mutate(term_start = date(\"2020-01-01\")`). \r\n   \r\n   Separately: We should also open a jira if one doesn't exist to clean up those `as.*` methods to use `build_expr()`\r\n   \r\n   \r\n   [1] https://github.com/apache/arrow/blob/a916e6015d7cab397d3b769d760b943a60ea3d97/r/R/dplyr-funcs-type.R#L45-L78\r\n   [2] https://github.com/apache/arrow/blob/a916e6015d7cab397d3b769d760b943a60ea3d97/r/R/expression.R#L195-L259\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-23T21:22:02.658+0000",
                    "updated": "2022-02-23T21:22:02.658+0000",
                    "started": "2022-02-23T21:22:02.658+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "731943",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/732194",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r813710773\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -164,4 +164,10 @@ register_bindings_datetime <- function() {\n       return(semester)\n     }\n   })\n+  register_binding(\"date\", function(x) {\n+    if (inherits(x, \"POSIXct\")) {\n+      x <- vec_to_Array(x, date32())\n+    }\n+    x$cast(date32())\n\nReview comment:\n       [ARROW-15775](https://issues.apache.org/jira/browse/ARROW-15775) for cleaning up `as.*` methods\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T09:47:11.158+0000",
                    "updated": "2022-02-24T09:47:11.158+0000",
                    "started": "2022-02-24T09:47:11.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732194",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/732197",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r813721357\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -164,4 +164,10 @@ register_bindings_datetime <- function() {\n       return(semester)\n     }\n   })\n+  register_binding(\"date\", function(x) {\n+    if (inherits(x, \"POSIXct\")) {\n+      x <- vec_to_Array(x, date32())\n+    }\n+    x$cast(date32())\n\nReview comment:\n       We do not have a separate ticket for `as.Date()`. I will try to tackle it here.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T09:59:24.567+0000",
                    "updated": "2022-02-24T09:59:24.567+0000",
                    "started": "2022-02-24T09:59:24.567+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732197",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/732198",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r813721357\n\n\n\n##########\nFile path: r/R/dplyr-funcs-datetime.R\n##########\n@@ -164,4 +164,10 @@ register_bindings_datetime <- function() {\n       return(semester)\n     }\n   })\n+  register_binding(\"date\", function(x) {\n+    if (inherits(x, \"POSIXct\")) {\n+      x <- vec_to_Array(x, date32())\n+    }\n+    x$cast(date32())\n\nReview comment:\n       We do not have a separate ticket for `as.Date()`. I will try to tackle it in this PR.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T09:59:37.996+0000",
                    "updated": "2022-02-24T09:59:37.996+0000",
                    "started": "2022-02-24T09:59:37.996+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732198",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/732324",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "dragosmg commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r813912419\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -801,3 +801,85 @@ test_that(\"dst extracts daylight savings time correctly\", {\n     test_df\n   )\n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(a_date = date(a)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(a_date_base = as.Date(a)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  r_date_object <- lubridate::ymd_hms(\"2012-03-26 23:12:13\")\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(b = date(r_date_object)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(b_base = as.Date(r_date_object)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n\nReview comment:\n       Do we want to remove all the tests below this point?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T14:07:10.616+0000",
                    "updated": "2022-02-24T14:07:10.616+0000",
                    "started": "2022-02-24T14:07:10.616+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732324",
                    "issueId": "13413590"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/worklog/732764",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #12433:\nURL: https://github.com/apache/arrow/pull/12433#discussion_r814346290\n\n\n\n##########\nFile path: r/R/dplyr-funcs-type.R\n##########\n@@ -76,6 +76,13 @@ register_bindings_type_cast <- function() {\n   register_binding(\"as.numeric\", function(x) {\n     Expression$create(\"cast\", x, options = cast_options(to_type = float64()))\n   })\n+  register_binding(\"as.Date\", function(x) {\n+    # base::as.Date() first converts to UTC and then extracts the date, which is\n+    # why we need to go through timestamp() first - see unit tests for the real\n+    # life impact of the difference between lubridate::date() and base::as.Date()\n+    y <- build_expr(\"cast\", x, options = cast_options(to_type = timestamp()))\n\nReview comment:\n       I assume that this line is depending on the default timezone for `timestamp()` to be UTC, yeah? Maybe we should be explicit about that here since to make it a little bit easier to read | reason about? \n\n##########\nFile path: r/tests/testthat/test-dplyr-funcs-datetime.R\n##########\n@@ -801,3 +801,85 @@ test_that(\"dst extracts daylight savings time correctly\", {\n     test_df\n   )\n })\n+\n+test_that(\"date works in arrow\", {\n+  # https://issues.apache.org/jira/browse/ARROW-13168\n+  skip_on_os(\"windows\")\n+  # this date is specific since lubridate::date() is different from base::as.Date()\n+  # since as.Date returns the UTC date and date() doesn't\n+  test_df <- tibble(\n+    a = as.POSIXct(c(\"2012-03-26 23:12:13\", NA), tz = \"America/New_York\"))\n+\n+  # we can't (for now) use namespacing, so we need to make sure lubridate::date()\n+  # and not base::date() is being used\n+  # TODO remove once https://issues.apache.org/jira/browse/ARROW-14575 is done\n+  date <- lubridate::date\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(a_date = date(a)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(a_date_base = as.Date(a)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  r_date_object <- lubridate::ymd_hms(\"2012-03-26 23:12:13\")\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(b = date(r_date_object)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  compare_dplyr_binding(\n+    .input %>%\n+      mutate(b_base = as.Date(r_date_object)) %>%\n+      collect(),\n+    test_df\n+  )\n+\n+  skip(\"All these will fail as we're not actually forcing evaluation\")\n+  # a timestamp is cast correctly to date\n+  expect_equal(\n+    call_binding(\"date\", Array$create(as.POSIXct(\"2022-02-21\"))),\n+    Array$create(as.POSIXct(\"2022-02-21\"), type = date32())\n+  )\n+\n+  # date() supports R objects\n+  expect_equal(\n+    call_binding(\"date\", as.POSIXct(\"2022-02-21\")),\n+    Array$create(as.POSIXct(\"2022-02-21\"), type = date32())\n+  )\n+})\n+\n+test_that(\"date() errors with unsupported inputs\", {\n+  skip(\"All these will fail as we're not actually forcing evaluation\")\n+  expect_error(\n+    call_binding(\"date\", Scalar$create(\"a string\")),\n+    \"NotImplemented: Unsupported cast from string to date32 using function cast_date32\"\n+  )\n+\n+  expect_error(\n+    call_binding(\"date\", Scalar$create(32.2)),\n+    \"NotImplemented: Unsupported cast from double to date32 using function cast_date32\"\n+  )\n+\n+  expect_error(\n+    arrow_eval(call_binding(\"date\", Scalar$create(TRUE)), mask = arrow_mask(list())),\n+    \"NotImplemented: Unsupported cast from bool to date32 using function cast_date32\"\n+  )\n+\n+  # if we are aiming for equivalent behaviour to lubridate this should fail, but\n+  # it doesn't as it is supported in arrow, where integer casting to date returns\n+  # the date x days away from epoch\n+  skip(\"supported in arrow, but not in lubridate\")\n+  expect_error(\n+    call_binding(\"date\", Scalar$create(32L)),\n+    \"NotImplemented: Unsupported cast from integer to date32 using function cast_date32\"\n+  )\n\nReview comment:\n       I would say that we should test this, even if we're diverging from dplyr. If it's easier to do this in a dplyr pipeline compared with evaluating the binding directly, feel free to do that.\r\n   \r\n   Interestingly(?) `lubridate::date()` doesn't outright reject numerics (though one needs to supply an origin in R, which does error). I wonder if there is an issue | if we should raise one with lubridate to either support that, or error with something more helpful. Though if lubridate did support this via POSIXlt, instead of being one day after the epoch, it is actually one second after the epoch(!):\r\n   \r\n   ```\r\n   > as.POSIXlt(1, origin = as.Date(\"1970-01-01\"), tz = \"UTC\")\r\n   [1] \"1970-01-01 00:00:01 UTC\"\r\n   ``` \r\n   \r\n   Anyway TL;DR, having arrow support `date(1)` being one day after the epoch I think is totally fine, but we should make a test for that here that confirms that we expect that behavior.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T23:17:11.378+0000",
                    "updated": "2022-02-24T23:17:11.378+0000",
                    "started": "2022-02-24T23:17:11.377+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732764",
                    "issueId": "13413590"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 52200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@f6f6f5c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76539ff6[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@38ac2450[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@526ab09c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1212c101[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3346512e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6a117db2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6d78de3c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6966005b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@68a8e378[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@935ff32[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@22174916[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 52200,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Mar 03 17:42:32 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-03-03T17:42:32.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14808/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-11-24T11:51:54.000+0000",
        "updated": "2022-03-04T08:41:43.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "14.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 52200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Implement bindings for lubridate::date",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13413590/comment/17500934",
                    "id": "17500934",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 12433\n[https://github.com/apache/arrow/pull/12433]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-03-03T17:42:32.160+0000",
                    "updated": "2022-03-03T17:42:32.160+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0x1nk:",
        "customfield_12314139": null
    }
}