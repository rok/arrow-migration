{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13247637",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637",
    "key": "ARROW-6060",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345978",
                "id": "12345978",
                "description": "",
                "name": "0.15.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-10-05"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345727",
                "id": "12345727",
                "name": "0.14.1",
                "archived": false,
                "released": true,
                "releaseDate": "2019-07-22"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12568139",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12568139",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "inwardIssue": {
                    "id": "13246168",
                    "key": "ARROW-5993",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13246168",
                    "fields": {
                        "summary": "[Python] Reading a dictionary column from Parquet results in disproportionate memory usage",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12568914",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12568914",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "inwardIssue": {
                    "id": "13253561",
                    "key": "ARROW-6380",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13253561",
                    "fields": {
                        "summary": "Method pyarrow.parquet.read_table has memory spikes from version 0.14",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12568072",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12568072",
                "type": {
                    "id": "12310560",
                    "name": "Problem/Incident",
                    "inward": "is caused by",
                    "outward": "causes",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310560"
                },
                "outwardIssue": {
                    "id": "13246168",
                    "key": "ARROW-5993",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13246168",
                    "fields": {
                        "summary": "[Python] Reading a dictionary column from Parquet results in disproportionate memory usage",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12566689",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12566689",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "outwardIssue": {
                    "id": "13247624",
                    "key": "ARROW-6059",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247624",
                    "fields": {
                        "summary": "[Python] Regression memory issue when calling pandas.read_parquet",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
                            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
                            "name": "Closed",
                            "id": "6",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            },
            {
                "id": "12567836",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12567836",
                "type": {
                    "id": "10030",
                    "name": "Reference",
                    "inward": "is related to",
                    "outward": "relates to",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"
                },
                "inwardIssue": {
                    "id": "13250664",
                    "key": "ARROW-6230",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13250664",
                    "fields": {
                        "summary": "[R] Reading in Parquet files are 20x slower than reading fst files in R",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
            "name": "bkietz",
            "key": "bkietz",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
            },
            "displayName": "Ben Kietzman",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
            "name": "kwunlyou",
            "key": "kwunlyou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Kun Liu",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
            "name": "kwunlyou",
            "key": "kwunlyou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Kun Liu",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6060/votes",
            "votes": 1,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 20,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289136",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016\n \n \n   @wesm  ChunkedBinaryBuilder was increasing capacity by the growth factor on every call to Reserve. Now it will only do so if added capacity is required\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-05T18:59:18.873+0000",
                    "updated": "2019-08-05T18:59:18.873+0000",
                    "started": "2019-08-05T18:59:18.872+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289136",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289215",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016#issuecomment-518407126\n \n \n   Can you add a unit test to verify the desired behavior?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-05T21:27:12.078+0000",
                    "updated": "2019-08-05T21:27:12.078+0000",
                    "started": "2019-08-05T21:27:12.078+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289215",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289376",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016#issuecomment-518465896\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=h1) Report\n   > :exclamation: No coverage uploaded for pull request base (`master@7aefa50`). [Click here to learn what that means](https://docs.codecov.io/docs/error-reference#section-missing-base-commit).\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/5016/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff            @@\n   ##             master    #5016   +/-   ##\n   =========================================\n     Coverage          ?   89.17%           \n   =========================================\n     Files             ?      727           \n     Lines             ?   102887           \n     Branches          ?        0           \n   =========================================\n     Hits              ?    91754           \n     Misses            ?    11133           \n     Partials          ?        0\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/array/builder\\_binary.cc](https://codecov.io/gh/apache/arrow/pull/5016/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9hcnJheS9idWlsZGVyX2JpbmFyeS5jYw==) | `85.55% <100%> (\u00f8)` | |\n   | [cpp/src/arrow/array/builder\\_binary.h](https://codecov.io/gh/apache/arrow/pull/5016/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9hcnJheS9idWlsZGVyX2JpbmFyeS5o) | `92.92% <100%> (\u00f8)` | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=footer). Last update [7aefa50...a5398da](https://codecov.io/gh/apache/arrow/pull/5016?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T01:59:50.690+0000",
                    "updated": "2019-08-06T01:59:50.690+0000",
                    "started": "2019-08-06T01:59:50.689+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289376",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289569",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016#discussion_r310967968\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   How is that? We're reserving `4.5 * chunksize` total, no?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T09:29:56.714+0000",
                    "updated": "2019-08-06T09:29:56.714+0000",
                    "started": "2019-08-06T09:29:56.714+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289569",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289656",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311067202\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   In between Reserve calls, no data is appended to the builder, so there is no need to allocate any additional memory. \r\n   \r\n   If you look at the bug report in ARROW-6060 the issue appears to be that memory was being allocated when there was no need. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:39:30.086+0000",
                    "updated": "2019-08-06T13:39:30.086+0000",
                    "started": "2019-08-06T13:39:30.086+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289656",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289657",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311068042\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   To review the docstring for Reserve\r\n   \r\n   ```\r\n     /// \\brief Ensure that there is enough space allocated to add the indicated\r\n     /// number of elements without any further calls to Resize. Overallocation is\r\n     /// used in order to minimize the impact of incremental Reserve() calls.\r\n     ///\r\n     /// \\param[in] additional_capacity the number of additional array values\r\n     /// \\return Status\r\n   ```\r\n   \r\n   So if there is already enough memory allocated then Reserve should be a no-op\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:40:57.846+0000",
                    "updated": "2019-08-06T13:40:57.846+0000",
                    "started": "2019-08-06T13:40:57.845+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289657",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289660",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311069935\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   (it might be worth stating in the docstring that calls to Reserve are not cumulative)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:44:20.833+0000",
                    "updated": "2019-08-06T13:44:20.833+0000",
                    "started": "2019-08-06T13:44:20.833+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289660",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289663",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311070620\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   > (it might be worth stating in the docstring that calls to Reserve are not cumulative)\r\n   \r\n   Really? They are. It's the (confusing) difference between Resize and Reserve.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:45:31.073+0000",
                    "updated": "2019-08-06T13:45:31.073+0000",
                    "started": "2019-08-06T13:45:31.073+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289663",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289664",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311070931\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   i.e. Reserve(100) should reserve allocated space for 100 _additional_ items.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:46:09.058+0000",
                    "updated": "2019-08-06T13:46:09.058+0000",
                    "started": "2019-08-06T13:46:09.057+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289664",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289677",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311076363\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   Yes, but in addition to what? For the current Reserve implementations the current length of the builder is considered (which for this test case remains 0, since I never Append anything)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:56:18.549+0000",
                    "updated": "2019-08-06T13:56:18.549+0000",
                    "started": "2019-08-06T13:56:18.548+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289677",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311076522\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   My intuition would be that Reserve ensure there's enough space for 100 items, if you call it without adding data, it should be a noop.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T13:56:36.259+0000",
                    "updated": "2019-08-06T13:56:36.259+0000",
                    "started": "2019-08-06T13:56:36.259+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289678",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289685",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311080335\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   Hmm, I see. Well I'd say that `Reserve` is really confusing then :-)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:03:40.028+0000",
                    "updated": "2019-08-06T14:03:40.028+0000",
                    "started": "2019-08-06T14:03:40.028+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289685",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289688",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311081685\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   @wesm I've added a note to the docstring\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:06:16.921+0000",
                    "updated": "2019-08-06T14:06:16.921+0000",
                    "started": "2019-08-06T14:06:16.920+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289688",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289696",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311084656\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   This is a good opportunity to clarify the docstring if there is still confusion. \r\n   \r\n   `Reserve`: pre-allocate space for an _absolute, additional_ amount of data\r\n   `Resize`: pre-allocate space for an _absolute_ amount of data (regardless of how much has already been appended)\r\n   \r\n   As we've seen here getting the behavior of Reserve wrong has made the 0.14.x release basically unusable for a number of users, so there are consequences to this \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:11:34.065+0000",
                    "updated": "2019-08-06T14:11:34.065+0000",
                    "started": "2019-08-06T14:11:34.065+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289696",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289697",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311084656\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   This is a good opportunity to clarify the docstring if there is still confusion. \r\n   \r\n   `Reserve`: pre-allocate space for an _absolute, additional_ amount of data (prior calls to `Reserve` are not taken into consideration, so `Reserve(1000)->Reserve(2000)` is the same as `Reserve(2000)`)\r\n   `Resize`: pre-allocate space for an _absolute_ amount of data (regardless of how much has already been appended)\r\n   \r\n   As we've seen here getting the behavior of Reserve wrong has made the 0.14.x release basically unusable for a number of users, so there are consequences to this \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:12:14.441+0000",
                    "updated": "2019-08-06T14:12:14.441+0000",
                    "started": "2019-08-06T14:12:14.440+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289697",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289723",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311085684\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   @bkietz is it possible to have a more aggressive test, e.g. one that uses 16mb in the normal case and 16g in the falling one?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:13:31.465+0000",
                    "updated": "2019-08-06T14:13:31.465+0000",
                    "started": "2019-08-06T14:13:31.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289723",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289735",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311093037\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   @fsaintjacques in the failing case to balloon to 16G all I'd need to do is increase the [loop max](https://github.com/apache/arrow/pull/5016/files/9c5f9aad99067591ede26bc2ee06eb59dec14cca#diff-30e1e8083901d7b9b2abf6c430ff5c1fR530); the calls to Reserve would continue increasing capacity by the growth factor (1.5) until we run out of memory. I'm not sure what merit increasing the test's scale has\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:26:37.088+0000",
                    "updated": "2019-08-06T14:26:37.088+0000",
                    "started": "2019-08-06T14:26:37.087+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289735",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/289740",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#discussion_r311096542\n \n \n\n ##########\n File path: cpp/src/arrow/array-binary-test.cc\n ##########\n @@ -522,6 +522,19 @@ TEST_F(TestChunkedBinaryBuilder, BasicOperation) {\n   }\n }\n \n+TEST_F(TestChunkedBinaryBuilder, Reserve) {\n+  const int32_t chunksize = 1000;\n+  Init(chunksize);\n+  auto bytes_before_reserve = default_memory_pool()->bytes_allocated();\n+  ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  for (int i = 0; i < 8; ++i) {\n+    ASSERT_OK(builder_->Reserve(chunksize / 2));\n+  }\n+  // no new memory will be allocated since capacity was sufficient for the loop's\n \n Review comment:\n   Agreed with @bkietz. We don't need to test to crash, just fail, if `Reserve()` is buggy.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-06T14:32:07.720+0000",
                    "updated": "2019-08-06T14:32:07.720+0000",
                    "started": "2019-08-06T14:32:07.720+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "289740",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/290353",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-07T10:31:33.890+0000",
                    "updated": "2019-08-07T10:31:33.890+0000",
                    "started": "2019-08-07T10:31:33.889+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "290353",
                    "issueId": "13247637"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/worklog/290448",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5016: ARROW-6060: [C++] ChunkedBinaryBuilder should only grow when necessary, address runaway memory use in Parquet binary column read\nURL: https://github.com/apache/arrow/pull/5016#issuecomment-519087783\n \n \n   I checked the memory use script from the JIRA issue and peak memory use is back in line with expectations\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-07T13:06:08.464+0000",
                    "updated": "2019-08-07T13:06:08.464+0000",
                    "started": "2019-08-07T13:06:08.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "290448",
                    "issueId": "13247637"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 12000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5f135ee2[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4991507d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@44aefbfb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@77f59ab[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d8ed87b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2671a65d[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1533e04b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@68fc4147[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@431a1123[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@68721453[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@624990ae[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@68b513d9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12000,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Aug 07 10:31:22 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-08-07T10:31:22.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6060/watchers",
            "watchCount": 7,
            "isWatching": false
        },
        "created": "2019-07-29T11:49:18.000+0000",
        "updated": "2019-08-30T14:02:42.000+0000",
        "timeoriginalestimate": null,
        "description": "\u00a0I tried to load a parquet file of about 1.8Gb using the following code. It crashed due to out of memory issue.\r\n{code:java}\r\nimport pyarrow.parquet as pq\r\npq.read_table('/tmp/test.parquet'){code}\r\n\u00a0However, it worked well with use_threads=True as follows\r\n{code:java}\r\npq.read_table('/tmp/test.parquet', use_threads=False){code}\r\nIf pyarrow is downgraded to 0.12.1, there is no such problem.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] too large memory cost using pyarrow.parquet.read_table with use_threads=True",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16895308",
                    "id": "16895308",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Can you provide an example file that we can use to try to find what's wrong?",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-07-29T14:38:03.249+0000",
                    "updated": "2019-07-29T14:38:03.249+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16895331",
                    "id": "16895331",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
                        "name": "kwunlyou",
                        "key": "kwunlyou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Kun Liu",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Thanks for the response, [~wesmckinn].\r\n\r\nI am trying to generate a sample file and reproduce the error as the original file is not possible to disclose. The pandas types of\u00a0columns\u00a0in the parquet file are just unicode, bytes, and int64.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
                        "name": "kwunlyou",
                        "key": "kwunlyou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Kun Liu",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2019-07-29T15:09:03.861+0000",
                    "updated": "2019-07-29T15:09:03.861+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16895387",
                    "id": "16895387",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
                        "name": "kwunlyou",
                        "key": "kwunlyou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Kun Liu",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "[~wesmckinn] I used the following code to generate a sample parquet.\u00a0\r\n{code:java}\r\nimport pandas as pd\r\nfrom pandas.util.testing import rands\r\n\r\ndef generate_strings(length, nunique, string_length=10):\r\n    unique_values = [rands(string_length) for i in range(nunique)]\r\n    values = unique_values * (length // nunique)\r\n    return values\r\n\r\ndf = pd.DataFrame()\r\ndf['a'] = generate_strings(100000000, 10000)\r\ndf['b'] = generate_strings(100000000, 10000)\r\ndf.to_parquet('/tmp/test.parquet')\r\n{code}\r\nAnd run following\r\n{code:java}\r\nimport pyarrow.parquet as pq\r\n pq.read_table('/tmp/test.parquet') # crash\r\n pq.read_table('/tmp/test.parquet', use_threads=False) # works{code}\r\n\r\n Btw, my machine has 16GB RAM.\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kwunlyou",
                        "name": "kwunlyou",
                        "key": "kwunlyou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Kun Liu",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2019-07-29T15:52:39.809+0000",
                    "updated": "2019-07-29T15:53:02.531+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16899250",
                    "id": "16899250",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kaaveland",
                        "name": "kaaveland",
                        "key": "kaaveland",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robin K\u00e5veland",
                        "active": true,
                        "timeZone": "Europe/Oslo"
                    },
                    "body": "I've had to downgrade our VMs to 0.13.0 today, I was observing parquet files that we could load just fine with 16GB of RAM earlier fail to load using VMs with 28GB of RAM. Unfortunately, I can't disclose any of the data either. We are using {{parquet.ParquetDataset.read()}}, but observe the problem even if we read single pieces of the parquet data sets (the pieces are between 100MB and 200MB). Most of our columns are unicode and probably would be friendly to dictionary encoding. The files have been written by spark. Normally, these datasets would take a while to load, so memory consumption would grow steadily for ~10 seconds, but now it seems like we invoke the OOM-killer in only a few seconds, so allocation seems very spiky.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kaaveland",
                        "name": "kaaveland",
                        "key": "kaaveland",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Robin K\u00e5veland",
                        "active": true,
                        "timeZone": "Europe/Oslo"
                    },
                    "created": "2019-08-02T22:26:11.056+0000",
                    "updated": "2019-08-02T22:26:27.858+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16899511",
                    "id": "16899511",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "I confirmed the peak memory use problem with the following code (thanks for the help reproducing!):\r\n\r\n{code}\r\nimport pandas as pd\r\nfrom pandas.util.testing import rands\r\n\r\nimport pyarrow as pa\r\nimport pyarrow.parquet as pq\r\n\r\nimport gc\r\nclass memory_use:\r\n    \r\n    def __init__(self):\r\n        self.start_use = pa.total_allocated_bytes()        \r\n        self.pool = pa.default_memory_pool()\r\n        self.start_peak_use = self.pool.max_memory()\r\n        \r\n    def __enter__(self):\r\n        return\r\n    \r\n    def __exit__(self, type, value, traceback):\r\n        gc.collect()\r\n        print(\"Change in memory use: {}\"\r\n              .format(pa.total_allocated_bytes() - self.start_use))\r\n        print(\"Change in peak use: {}\"\r\n              .format(self.pool.max_memory() - self.start_peak_use))\r\n\r\ndef generate_strings(length, nunique, string_length=10):\r\n    unique_values = [rands(string_length) for i in range(nunique)]\r\n    values = unique_values * (length // nunique)\r\n    return values\r\n\r\ndf = pd.DataFrame()\r\ndf['a'] = generate_strings(100000000, 10000)\r\ndf['b'] = generate_strings(100000000, 10000)\r\ndf.to_parquet('/tmp/test.parquet')\r\n\r\nwith memory_use():\r\n    table = pq.read_table('/tmp/test.parquet')\r\n{code}\r\n\r\nI have with 0.13.0:\r\n\r\n{code}\r\nChange in memory use: 2825000192\r\nChange in peak use: 3827684608\r\n{code}\r\n\r\nand with 0.14.1 and master\r\n\r\n{code}\r\nChange in memory use: 2825000192\r\nChange in peak use: 20585786752\r\n{code}\r\n\r\nSo peak memory use is about 20GB now where it was less than 4GB before. I'm not sure which patch caused this but there have been a _lot_ of patches related to builders in the last several months so my guess is that one of the builders has a bug in its memory allocation logic\r\n\r\ncc [~bkietz] [~pitrou] [~npr] ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-03T19:29:52.896+0000",
                    "updated": "2019-08-03T19:29:52.896+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16899512",
                    "id": "16899512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Note that with my patch for ARROW-3325 the memory use is very low comparatively:\r\n\r\n{code}\r\nwith memory_use():\r\n    table = pq.read_table('/tmp/test.parquet', read_dictionary=['a', 'b'])\r\n\r\nChange in memory use: 825560448\r\nChange in peak use: 1484772224\r\n{code}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-03T19:31:23.052+0000",
                    "updated": "2019-08-03T19:31:36.956+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16899520",
                    "id": "16899520",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "git bisect reveals this issue was introduced by ARROW-3762\r\n\r\nhttps://github.com/apache/arrow/commit/a634f925d06e58141261e60dec322186e22b750c\r\n\r\n[~bkietz] since you last worked on this builder would you mind taking a look? ",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-03T19:53:43.641+0000",
                    "updated": "2019-08-03T19:53:43.641+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16900139",
                    "id": "16900139",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Will do",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-08-05T15:03:01.054+0000",
                    "updated": "2019-08-05T15:03:01.054+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13247637/comment/16901960",
                    "id": "16901960",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 5016\n[https://github.com/apache/arrow/pull/5016]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2019-08-07T10:31:22.617+0000",
                    "updated": "2019-08-07T10:31:22.617+0000"
                }
            ],
            "maxResults": 9,
            "total": 9,
            "startAt": 0
        },
        "customfield_12311820": "0|z054dk:",
        "customfield_12314139": null
    }
}