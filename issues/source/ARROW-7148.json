{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13267771",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771",
    "key": "ARROW-7148",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "dataset",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12574448",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12574448",
                "type": {
                    "id": "12310010",
                    "name": "Incorporates",
                    "inward": "is part of",
                    "outward": "incorporates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"
                },
                "outwardIssue": {
                    "id": "13266973",
                    "key": "ARROW-7094",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13266973",
                    "fields": {
                        "summary": "[C++] FileSystemDataSource should use an owning pointer for fs::Filesystem",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            },
            {
                "id": "12574449",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12574449",
                "type": {
                    "id": "12310010",
                    "name": "Incorporates",
                    "inward": "is part of",
                    "outward": "incorporates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"
                },
                "outwardIssue": {
                    "id": "13267769",
                    "key": "ARROW-7147",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267769",
                    "fields": {
                        "summary": "[C++][Dataset] Refactor dataset's API to use Result<T>",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                            "id": "7",
                            "description": "The sub-task of the issue",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                            "name": "Sub-task",
                            "subtask": true,
                            "avatarId": 21146
                        }
                    }
                }
            },
            {
                "id": "12574447",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12574447",
                "type": {
                    "id": "12310010",
                    "name": "Incorporates",
                    "inward": "is part of",
                    "outward": "incorporates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310010"
                },
                "outwardIssue": {
                    "id": "13268850",
                    "key": "ARROW-7188",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13268850",
                    "fields": {
                        "summary": "[C++][Doc] doxygen broken on master: missing param implicit_casts",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
                            "name": "Minor",
                            "id": "4"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [
            {
                "id": "13266973",
                "key": "ARROW-7094",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/13266973",
                "fields": {
                    "summary": "[C++] FileSystemDataSource should use an owning pointer for fs::Filesystem",
                    "status": {
                        "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                        "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                        "name": "Resolved",
                        "id": "5",
                        "statusCategory": {
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                            "id": 3,
                            "key": "done",
                            "colorName": "green",
                            "name": "Done"
                        }
                    },
                    "priority": {
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "name": "Major",
                        "id": "3"
                    },
                    "issuetype": {
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                        "id": "7",
                        "description": "The sub-task of the issue",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                        "name": "Sub-task",
                        "subtask": true,
                        "avatarId": 21146
                    }
                }
            },
            {
                "id": "13267769",
                "key": "ARROW-7147",
                "self": "https://issues.apache.org/jira/rest/api/2/issue/13267769",
                "fields": {
                    "summary": "[C++][Dataset] Refactor dataset's API to use Result<T>",
                    "status": {
                        "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                        "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                        "name": "Resolved",
                        "id": "5",
                        "statusCategory": {
                            "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                            "id": 3,
                            "key": "done",
                            "colorName": "green",
                            "name": "Done"
                        }
                    },
                    "priority": {
                        "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                        "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                        "name": "Major",
                        "id": "3"
                    },
                    "issuetype": {
                        "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
                        "id": "7",
                        "description": "The sub-task of the issue",
                        "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
                        "name": "Sub-task",
                        "subtask": true,
                        "avatarId": 21146
                    }
                }
            }
        ],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=fsaintjacques",
            "name": "fsaintjacques",
            "key": "fsaintjacques",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=fsaintjacques&avatarId=37276",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=fsaintjacques&avatarId=37276",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=fsaintjacques&avatarId=37276",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=fsaintjacques&avatarId=37276"
            },
            "displayName": "Francois Saint-Jacques",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 18000,
            "total": 18000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7148/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 37,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345299",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857\n \n \n   - Make use of `Result<T>` instead of Status/output-parameter (fixes ARROW-7147).\r\n   - Make use of type forward aliases, e.g. the KlassPtr pattern. This ensure a normalization of the correct pointer type and a shorter types to write.\r\n   - Use std::shared_ptr everywhere for normalization.\r\n   - Move implicit filter cast into R binding (fixes ARROW-7188).\r\n   - Fix type validation issue.\r\n   - Force FileSystemDataSource to use an owning pointer for the filesystem (fixes ARROW-7094).\r\n   - Make constructors private.\r\n   - Delete not implemented format header, i.e. CSV, JSON and Feather.\r\n   - Delete unused classes ProjectedRecordBatchReader.\r\n   - Fold SimplerScanner into Scanner.\r\n   - Rename FileBasedDataFragment to FileBasedDataFragment and\r\n     FileSystemBasedDataSource to FileSystemDataSource.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T13:56:28.137+0000",
                    "updated": "2019-11-18T13:56:28.137+0000",
                    "started": "2019-11-18T13:56:28.136+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345299",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345303",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#issuecomment-555028126\n \n \n   https://issues.apache.org/jira/browse/ARROW-7148\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T14:03:23.629+0000",
                    "updated": "2019-11-18T14:03:23.629+0000",
                    "started": "2019-11-18T14:03:23.629+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345303",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345379",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347469936\n \n \n\n ##########\n File path: r/src/expression.cpp\n ##########\n @@ -20,82 +20,72 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::FieldExpression> dataset___expr__field_ref(\n-    std::string name) {\n-  return std::make_shared<arrow::dataset::FieldExpression>(std::move(name));\n+ds::ExpressionPtr dataset___expr__field_ref(std::string name) {\n+  return std::make_shared<ds::FieldExpression>(std::move(name));\n }\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::ComparisonExpression> dataset___expr__equal(\n-    const std::shared_ptr<arrow::dataset::Expression>& lhs,\n-    const std::shared_ptr<arrow::dataset::Expression>& rhs) {\n-  return arrow::dataset::equal(lhs, rhs);\n+ds::ExpressionPtr dataset___expr__equal(const ds::ExpressionPtr& lhs,\n+                                        const ds::ExpressionPtr& rhs) {\n+  return ds::equal(lhs, rhs);\n }\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::ComparisonExpression> dataset___expr__not_equal(\n-    const std::shared_ptr<arrow::dataset::Expression>& lhs,\n-    const std::shared_ptr<arrow::dataset::Expression>& rhs) {\n+ds::ExpressionPtr dataset___expr__not_equal(const ds::ExpressionPtr& lhs,\n+                                            const ds::ExpressionPtr& rhs) {\n   return arrow::dataset::not_equal(lhs, rhs);\n \n Review comment:\n   ```suggestion\r\n     return ds::not_equal(lhs, rhs);\r\n   ```\r\n   and same for the rest, right?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:16:15.348+0000",
                    "updated": "2019-11-18T16:16:15.348+0000",
                    "started": "2019-11-18T16:16:15.348+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345379",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345380",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347460382\n \n \n\n ##########\n File path: r/src/dataset.cpp\n ##########\n @@ -20,116 +20,98 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSourceDiscovery> dataset___FSDSDiscovery__Make(\n-    const std::shared_ptr<arrow::fs::FileSystem>& fs,\n-    const std::shared_ptr<arrow::fs::Selector>& selector) {\n-  std::shared_ptr<arrow::dataset::DataSourceDiscovery> discovery;\n+ds::DataSourceDiscoveryPtr dataset___FSDSDiscovery__Make(\n \n Review comment:\n   I gather that these `*Ptr` classes are just shorthand for the `std::shared_ptr<>` business. Just an observation, it looks a little confusing that some classes have this helper and others don't. Is this related to the Result business (and we'll be putting this everywhere along with result) or is it just some other sugar?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:16:15.412+0000",
                    "updated": "2019-11-18T16:16:15.412+0000",
                    "started": "2019-11-18T16:16:15.412+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345380",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345381",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347471170\n \n \n\n ##########\n File path: r/src/dataset.cpp\n ##########\n @@ -20,116 +20,98 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSourceDiscovery> dataset___FSDSDiscovery__Make(\n-    const std::shared_ptr<arrow::fs::FileSystem>& fs,\n-    const std::shared_ptr<arrow::fs::Selector>& selector) {\n-  std::shared_ptr<arrow::dataset::DataSourceDiscovery> discovery;\n+ds::DataSourceDiscoveryPtr dataset___FSDSDiscovery__Make(\n+    const std::shared_ptr<fs::FileSystem>& fs,\n+    const std::shared_ptr<fs::Selector>& selector) {\n   // TODO(npr): add format as an argument, don't hard-code Parquet\n-  auto format = std::make_shared<arrow::dataset::ParquetFileFormat>();\n+  auto format = std::make_shared<ds::ParquetFileFormat>();\n   // TODO(fsaintjacques): Make options configurable\n-  auto options = arrow::dataset::FileSystemDiscoveryOptions{};\n+  auto options = ds::FileSystemDiscoveryOptions{};\n \n-  STOP_IF_NOT_OK(arrow::dataset::FileSystemDataSourceDiscovery::Make(\n-      fs.get(), *selector, format, std::move(options), &discovery));\n-  return discovery;\n+  return ValueOrStop(\n+      ds::FileSystemDataSourceDiscovery::Make(fs, *selector, format, options));\n }\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSource> dataset___DSDiscovery__Finish(\n-    const std::shared_ptr<arrow::dataset::DataSourceDiscovery>& discovery) {\n-  std::shared_ptr<arrow::dataset::DataSource> out;\n-  STOP_IF_NOT_OK(discovery->Finish(&out));\n-  return out;\n+ds::DataSourcePtr dataset___DSDiscovery__Finish(\n+    const ds::DataSourceDiscoveryPtr& discovery) {\n+  return ValueOrStop(discovery->Finish());\n \n Review comment:\n   Observation: it looks odd/inconsistent to have `STOP_IF_NOT_OK` but then `ValueOrStop`\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:16:15.427+0000",
                    "updated": "2019-11-18T16:16:15.427+0000",
                    "started": "2019-11-18T16:16:15.427+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345381",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345382",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347471122\n \n \n\n ##########\n File path: r/src/expression.cpp\n ##########\n @@ -20,82 +20,72 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::FieldExpression> dataset___expr__field_ref(\n-    std::string name) {\n-  return std::make_shared<arrow::dataset::FieldExpression>(std::move(name));\n+ds::ExpressionPtr dataset___expr__field_ref(std::string name) {\n \n Review comment:\n   Why are these changed to have the parent class as the return value? Just makes for some mismatch because the R classes still use the subclass. Can we use `Expression` everywhere and reduce that boilerplate?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:16:15.491+0000",
                    "updated": "2019-11-18T16:16:15.491+0000",
                    "started": "2019-11-18T16:16:15.491+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345382",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345383",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347471842\n \n \n\n ##########\n File path: r/src/arrow_types.h\n ##########\n @@ -240,7 +241,17 @@ std::shared_ptr<arrow::Array> Array__from_vector(SEXP x, SEXP type);\n std::shared_ptr<arrow::RecordBatch> RecordBatch__from_arrays(SEXP, SEXP);\n std::shared_ptr<arrow::RecordBatch> RecordBatch__from_dataframe(Rcpp::DataFrame tbl);\n \n+namespace ds = ::arrow::dataset;\n+namespace fs = ::arrow::fs;\n \n Review comment:\n   Can you substitute `fs` in `r/src/filesystem.cpp` everywhere, like you did for `dataset.cpp`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:16:15.495+0000",
                    "updated": "2019-11-18T16:16:15.495+0000",
                    "started": "2019-11-18T16:16:15.494+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345383",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345384",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347458787\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/dataset.cc\n ##########\n @@ -32,49 +32,46 @@ namespace dataset {\n DataFragment::DataFragment() : scan_options_(ScanOptions::Defaults()) {}\n \n SimpleDataFragment::SimpleDataFragment(\n-    std::vector<std::shared_ptr<RecordBatch>> record_batches,\n-    std::shared_ptr<ScanOptions> scan_options)\n+    std::vector<std::shared_ptr<RecordBatch>> record_batches, ScanOptionsPtr scan_options)\n     : DataFragment(std::move(scan_options)), record_batches_(std::move(record_batches)) {}\n \n SimpleDataFragment::SimpleDataFragment(\n     std::vector<std::shared_ptr<RecordBatch>> record_batches)\n     : SimpleDataFragment(std::move(record_batches), ScanOptions::Defaults()) {}\n \n-Status SimpleDataFragment::Scan(std::shared_ptr<ScanContext> scan_context,\n-                                ScanTaskIterator* out) {\n+Result<ScanTaskIterator> SimpleDataFragment::Scan(ScanContextPtr context) {\n   // Make an explicit copy of record_batches_ to ensure Scan can be called\n   // multiple times.\n   auto batches_it = MakeVectorIterator(record_batches_);\n \n   // RecordBatch -> ScanTask\n   auto scan_options = scan_options_;\n-  auto fn = [=](std::shared_ptr<RecordBatch> batch) -> std::unique_ptr<ScanTask> {\n+  auto fn = [=](std::shared_ptr<RecordBatch> batch) -> ScanTaskPtr {\n     std::vector<std::shared_ptr<RecordBatch>> batches{batch};\n     return ::arrow::internal::make_unique<SimpleScanTask>(\n-        std::move(batches), std::move(scan_options), std::move(scan_context));\n+        std::move(batches), std::move(scan_options), std::move(context));\n   };\n \n-  *out = MakeMapIterator(fn, std::move(batches_it));\n-  return Status::OK();\n+  return MakeMapIterator(fn, std::move(batches_it));\n }\n \n-Status Dataset::Make(std::vector<std::shared_ptr<DataSource>> sources,\n-                     std::shared_ptr<Schema> schema, std::shared_ptr<Dataset>* out) {\n-  // TODO: Ensure schema and sources align.\n-  *out = std::make_shared<Dataset>(std::move(sources), std::move(schema));\n+Result<DatasetPtr> Dataset::Make(DataSourceVector sources,\n+                                 std::shared_ptr<Schema> schema) {\n+  DatasetPtr dataset;\n+  dataset.reset(new Dataset(std::move(sources), std::move(schema)));\n+  return dataset;\n \n Review comment:\n   ```suggestion\r\n     return DatasetPtr(new Dataset(std::move(sources), std::move(schema)));\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.308+0000",
                    "updated": "2019-11-18T16:20:47.308+0000",
                    "started": "2019-11-18T16:20:47.307+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345384",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345385",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347460853\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/discovery.cc\n ##########\n @@ -82,17 +80,15 @@ Status FileSystemDataSourceDiscovery::Make(fs::FileSystem* fs,\n     filtered.push_back(stat);\n   }\n \n-  out->reset(new FileSystemDataSourceDiscovery(fs, std::move(filtered), std::move(format),\n-                                               std::move(options)));\n-\n-  return Status::OK();\n+  DataSourceDiscoveryPtr discovery;\n+  discovery.reset(new FileSystemDataSourceDiscovery(\n+      fs, std::move(filtered), std::move(format), std::move(options)));\n+  return discovery;\n \n Review comment:\n   ```suggestion\r\n     return DiscoveryPtr(new FileSystemDataSourceDiscovery(\r\n         fs, std::move(filtered), std::move(format), std::move(options)));\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.311+0000",
                    "updated": "2019-11-18T16:20:47.311+0000",
                    "started": "2019-11-18T16:20:47.310+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345385",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345386",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347460357\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/discovery.cc\n ##########\n @@ -72,7 +70,7 @@ Status FileSystemDataSourceDiscovery::Make(fs::FileSystem* fs,\n \n       if (options.exclude_invalid_files) {\n         bool supported = true;\n-        RETURN_NOT_OK(format->IsSupported(FileSource(path, fs), &supported));\n+        RETURN_NOT_OK(format->IsSupported(FileSource(path, fs.get()), &supported));\n \n Review comment:\n   Is there a reason we don't have `Result<bool> FileFormat::IsSupported(FileSource)`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.331+0000",
                    "updated": "2019-11-18T16:20:47.331+0000",
                    "started": "2019-11-18T16:20:47.331+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345386",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345387",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347467968\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/scanner.cc\n ##########\n @@ -36,20 +36,21 @@ namespace dataset {\n ScanOptions::ScanOptions()\n     : filter(scalar(true)), evaluator(ExpressionEvaluator::Null()) {}\n \n-std::shared_ptr<ScanOptions> ScanOptions::Defaults() {\n-  return std::shared_ptr<ScanOptions>(new ScanOptions);\n-}\n+ScanOptionsPtr ScanOptions::Defaults() { return ScanOptionsPtr(new ScanOptions); }\n \n-RecordBatchIterator SimpleScanTask::Scan() { return MakeVectorIterator(record_batches_); }\n+Result<RecordBatchIterator> SimpleScanTask::Scan() {\n+  return MakeVectorIterator(record_batches_);\n+}\n \n /// \\brief GetScanTaskIterator transforms an Iterator<DataFragment> in a\n /// flattened Iterator<ScanTask>.\n static ScanTaskIterator GetScanTaskIterator(DataFragmentIterator fragments,\n-                                            std::shared_ptr<ScanContext> context) {\n+                                            ScanContextPtr context) {\n   // DataFragment -> ScanTaskIterator\n   auto fn = [context](std::shared_ptr<DataFragment> fragment,\n                       ScanTaskIterator* out) -> Status {\n-    return fragment->Scan(context, out);\n+    ARROW_ASSIGN_OR_RAISE(*out, fragment->Scan(context));\n \n Review comment:\n   ```suggestion\r\n       return fragment->Scan(context)).Value(out);\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.559+0000",
                    "updated": "2019-11-18T16:20:47.559+0000",
                    "started": "2019-11-18T16:20:47.559+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345387",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345388",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347471878\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/scanner_test.cc\n ##########\n @@ -119,43 +119,44 @@ TEST_F(TestSimpleScanner, ToTable) {\n   auto fragment = std::make_shared<SimpleDataFragment>(batches);\n   DataFragmentVector fragments{1, fragment};\n \n-  std::vector<std::shared_ptr<DataSource>> sources = {\n+  DataSourceVector sources = {\n       std::make_shared<SimpleDataSource>(fragments),\n   };\n \n   options_->schema = s;\n-  auto scanner = std::make_shared<SimpleScanner>(sources, options_, ctx_);\n+  auto scanner = std::make_shared<Scanner>(sources, options_, ctx_);\n   std::shared_ptr<Table> actual;\n \n   options_->use_threads = false;\n-  ASSERT_OK(scanner->ToTable(&actual));\n+  ASSERT_OK_AND_ASSIGN(actual, scanner->ToTable());\n   AssertTablesEqual(*expected, *actual);\n \n   // There is no guarantee on the ordering when using multiple threads, but\n   // since the RecordBatch is always the same it will pass.\n   options_->use_threads = true;\n-  ASSERT_OK(scanner->ToTable(&actual));\n+  ASSERT_OK_AND_ASSIGN(actual, scanner->ToTable());\n   AssertTablesEqual(*expected, *actual);\n }\n \n class TestScannerBuilder : public ::testing::Test {\n   void SetUp() {\n-    std::vector<std::shared_ptr<DataSource>> sources;\n+    DataSourceVector sources;\n \n     schema_ = schema({\n         field(\"b\", boolean()),\n         field(\"i8\", int8()),\n         field(\"i16\", int16()),\n-        field(\"i32\", int16()),\n-        field(\"i64\", int16()),\n+        field(\"i32\", int32()),\n+        field(\"i64\", int64()),\n \n Review comment:\n   :)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.695+0000",
                    "updated": "2019-11-18T16:20:47.695+0000",
                    "started": "2019-11-18T16:20:47.695+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345388",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345389",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347471417\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/scanner_internal.h\n ##########\n @@ -37,7 +37,8 @@ static inline RecordBatchIterator FilterRecordBatch(\n   auto filter_fn = [filter, evaluator](std::shared_ptr<RecordBatch> in,\n                                        std::shared_ptr<RecordBatch>* out) {\n     ARROW_ASSIGN_OR_RAISE(auto selection_datum, evaluator->Evaluate(*filter, *in));\n-    return evaluator->Filter(selection_datum, in, out);\n+    ARROW_ASSIGN_OR_RAISE(*out, evaluator->Filter(selection_datum, in));\n \n Review comment:\n   ```suggestion\r\n       return evaluator->Filter(selection_datum, in)).Value(out);\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.700+0000",
                    "updated": "2019-11-18T16:20:47.700+0000",
                    "started": "2019-11-18T16:20:47.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345389",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345390",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347474470\n \n \n\n ##########\n File path: r/src/arrow_types.h\n ##########\n @@ -240,7 +241,17 @@ std::shared_ptr<arrow::Array> Array__from_vector(SEXP x, SEXP type);\n std::shared_ptr<arrow::RecordBatch> RecordBatch__from_arrays(SEXP, SEXP);\n std::shared_ptr<arrow::RecordBatch> RecordBatch__from_dataframe(Rcpp::DataFrame tbl);\n \n+namespace ds = ::arrow::dataset;\n+namespace fs = ::arrow::fs;\n+\n namespace arrow {\n+\n+template <typename R>\n+auto ValueOrStop(R&& result) -> decltype(std::forward<R>(result).ValueOrDie()) {\n \n Review comment:\n   +1\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.701+0000",
                    "updated": "2019-11-18T16:20:47.701+0000",
                    "started": "2019-11-18T16:20:47.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345390",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345391",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347468401\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/scanner.cc\n ##########\n @@ -60,19 +61,18 @@ static ScanTaskIterator GetScanTaskIterator(DataFragmentIterator fragments,\n }\n \n static ScanTaskIterator ProjectAndFilterScanTaskIterator(\n-    ScanTaskIterator it, std::shared_ptr<Expression> filter,\n+    ScanTaskIterator it, ExpressionPtr filter,\n     std::shared_ptr<ExpressionEvaluator> evaluator,\n     std::shared_ptr<RecordBatchProjector> projector) {\n   // Wrap the scanner ScanTask with a FilterAndProjectScanTask\n-  auto wrap_scan_task = [filter, evaluator, projector](\n-                            std::unique_ptr<ScanTask> task) -> std::unique_ptr<ScanTask> {\n+  auto wrap_scan_task = [filter, evaluator, projector](ScanTaskPtr task) -> ScanTaskPtr {\n     return internal::make_unique<FilterAndProjectScanTask>(std::move(task), filter,\n \n Review comment:\n   it looks a bit funny to have `make_unique` here since you're return type is `shared_ptr`, but it's not at all incorrect\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.701+0000",
                    "updated": "2019-11-18T16:20:47.701+0000",
                    "started": "2019-11-18T16:20:47.701+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345391",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345392",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347463439\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/file_base.h\n ##########\n @@ -182,32 +179,30 @@ class ARROW_DS_EXPORT FileSystemBasedDataSource : public DataSource {\n   /// \\param[in] partitions optional partitions attached to FileStats found in\n   ///            `stats`.\n   /// \\param[in] format file format to create fragments from.\n-  /// \\param[out] out pointer storing the resulting DataSource.\n   ///\n   /// The caller is not required to provide a complete coverage of nodes and\n   /// partitions.\n-  static Status Make(fs::FileSystem* filesystem, std::vector<fs::FileStats> stats,\n-                     std::shared_ptr<Expression> source_partition,\n-                     PathPartitions partitions, std::shared_ptr<FileFormat> format,\n-                     std::shared_ptr<DataSource>* out);\n+  static Result<DataSourcePtr> Make(fs::FileSystemPtr filesystem,\n+                                    fs::FileStatsVector stats,\n+                                    ExpressionPtr source_partition,\n+                                    PathPartitions partitions, FileFormatPtr format);\n \n   std::string type() const override { return \"filesystem_data_source\"; }\n \n  protected:\n-  DataFragmentIterator GetFragmentsImpl(std::shared_ptr<ScanOptions> options) override;\n+  DataFragmentIterator GetFragmentsImpl(ScanOptionsPtr options) override;\n \n-  FileSystemBasedDataSource(fs::FileSystem* filesystem, fs::PathForest forest,\n-                            std::shared_ptr<Expression> source_partition,\n-                            PathPartitions partitions,\n-                            std::shared_ptr<FileFormat> format);\n+  FileSystemDataSource(fs::FileSystemPtr filesystem, fs::PathForest forest,\n+                       ExpressionPtr source_partition, PathPartitions partitions,\n+                       FileFormatPtr format);\n \n-  bool PartitionMatches(const fs::FileStats& stats, std::shared_ptr<Expression> filter);\n+  bool PartitionMatches(const fs::FileStats& stats, ExpressionPtr filter);\n \n-  fs::FileSystem* filesystem_ = NULLPTR;\n+  fs::FileSystemPtr filesystem_ = NULLPTR;\n \n Review comment:\n   smart pointers default to nullptr\r\n   ```suggestion\r\n     fs::FileSystemPtr filesystem_;\r\n   ```\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:20:47.785+0000",
                    "updated": "2019-11-18T16:20:47.785+0000",
                    "started": "2019-11-18T16:20:47.784+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345392",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345396",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347479941\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/discovery.cc\n ##########\n @@ -72,7 +70,7 @@ Status FileSystemDataSourceDiscovery::Make(fs::FileSystem* fs,\n \n       if (options.exclude_invalid_files) {\n         bool supported = true;\n-        RETURN_NOT_OK(format->IsSupported(FileSource(path, fs), &supported));\n+        RETURN_NOT_OK(format->IsSupported(FileSource(path, fs.get()), &supported));\n \n Review comment:\n   Because rebase (wasn't in master when I branched), I'll fix it :)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:28:43.565+0000",
                    "updated": "2019-11-18T16:28:43.565+0000",
                    "started": "2019-11-18T16:28:43.565+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345396",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345405",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347487163\n \n \n\n ##########\n File path: cpp/src/arrow/dataset/scanner.cc\n ##########\n @@ -60,19 +61,18 @@ static ScanTaskIterator GetScanTaskIterator(DataFragmentIterator fragments,\n }\n \n static ScanTaskIterator ProjectAndFilterScanTaskIterator(\n-    ScanTaskIterator it, std::shared_ptr<Expression> filter,\n+    ScanTaskIterator it, ExpressionPtr filter,\n     std::shared_ptr<ExpressionEvaluator> evaluator,\n     std::shared_ptr<RecordBatchProjector> projector) {\n   // Wrap the scanner ScanTask with a FilterAndProjectScanTask\n-  auto wrap_scan_task = [filter, evaluator, projector](\n-                            std::unique_ptr<ScanTask> task) -> std::unique_ptr<ScanTask> {\n+  auto wrap_scan_task = [filter, evaluator, projector](ScanTaskPtr task) -> ScanTaskPtr {\n     return internal::make_unique<FilterAndProjectScanTask>(std::move(task), filter,\n \n Review comment:\n   Will, fix.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T16:41:22.535+0000",
                    "updated": "2019-11-18T16:41:22.535+0000",
                    "started": "2019-11-18T16:41:22.535+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345405",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345423",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347504928\n \n \n\n ##########\n File path: r/src/dataset.cpp\n ##########\n @@ -20,116 +20,98 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSourceDiscovery> dataset___FSDSDiscovery__Make(\n-    const std::shared_ptr<arrow::fs::FileSystem>& fs,\n-    const std::shared_ptr<arrow::fs::Selector>& selector) {\n-  std::shared_ptr<arrow::dataset::DataSourceDiscovery> discovery;\n+ds::DataSourceDiscoveryPtr dataset___FSDSDiscovery__Make(\n \n Review comment:\n   We might put this everywhere eventually. For now it's only applied to classes declared in the datasets module (which is why we have `DataSourcePtr` but not `RecordBatchPtr`). I'll write a follow up JIRA for adding similar aliases throughout Arrow\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T17:15:20.703+0000",
                    "updated": "2019-11-18T17:15:20.703+0000",
                    "started": "2019-11-18T17:15:20.702+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345423",
                    "issueId": "13267771"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/worklog/345424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #5857: ARROW-7148: [C++][Dataset] Major API cleanup\nURL: https://github.com/apache/arrow/pull/5857#discussion_r347505511\n \n \n\n ##########\n File path: r/src/dataset.cpp\n ##########\n @@ -20,116 +20,98 @@\n #if defined(ARROW_R_WITH_ARROW)\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSourceDiscovery> dataset___FSDSDiscovery__Make(\n-    const std::shared_ptr<arrow::fs::FileSystem>& fs,\n-    const std::shared_ptr<arrow::fs::Selector>& selector) {\n-  std::shared_ptr<arrow::dataset::DataSourceDiscovery> discovery;\n+ds::DataSourceDiscoveryPtr dataset___FSDSDiscovery__Make(\n+    const std::shared_ptr<fs::FileSystem>& fs,\n+    const std::shared_ptr<fs::Selector>& selector) {\n   // TODO(npr): add format as an argument, don't hard-code Parquet\n-  auto format = std::make_shared<arrow::dataset::ParquetFileFormat>();\n+  auto format = std::make_shared<ds::ParquetFileFormat>();\n   // TODO(fsaintjacques): Make options configurable\n-  auto options = arrow::dataset::FileSystemDiscoveryOptions{};\n+  auto options = ds::FileSystemDiscoveryOptions{};\n \n-  STOP_IF_NOT_OK(arrow::dataset::FileSystemDataSourceDiscovery::Make(\n-      fs.get(), *selector, format, std::move(options), &discovery));\n-  return discovery;\n+  return ValueOrStop(\n+      ds::FileSystemDataSourceDiscovery::Make(fs, *selector, format, options));\n }\n \n // [[arrow::export]]\n-std::shared_ptr<arrow::dataset::DataSource> dataset___DSDiscovery__Finish(\n-    const std::shared_ptr<arrow::dataset::DataSourceDiscovery>& discovery) {\n-  std::shared_ptr<arrow::dataset::DataSource> out;\n-  STOP_IF_NOT_OK(discovery->Finish(&out));\n-  return out;\n+ds::DataSourcePtr dataset___DSDiscovery__Finish(\n+    const ds::DataSourceDiscoveryPtr& discovery) {\n+  return ValueOrStop(discovery->Finish());\n \n Review comment:\n   `StopIfNoValue`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-11-18T17:16:32.234+0000",
                    "updated": "2019-11-18T17:16:32.234+0000",
                    "started": "2019-11-18T17:16:32.233+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "345424",
                    "issueId": "13267771"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 18000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@9c6a153[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4a405a7f[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6c847f25[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@24df5368[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@693ae2e7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@1d381199[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@528a284c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@c107566[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@328393d9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6f6af8c9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6ca17520[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@63158697[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 18000,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Nov 18 23:55:19 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-11-18T23:55:19.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7148/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-11-12T16:25:21.000+0000",
        "updated": "2020-04-10T15:32:28.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 18000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Dataset] API cleanup",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13267771/comment/16976998",
                    "id": "16976998",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 5857\n[https://github.com/apache/arrow/pull/5857]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2019-11-18T23:55:19.767+0000",
                    "updated": "2019-11-18T23:55:19.767+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z08ipk:",
        "customfield_12314139": null
    }
}