{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13438437",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437",
    "key": "ARROW-16144",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351550",
                "id": "12351550",
                "name": "9.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-08-03"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350591",
                "id": "12350591",
                "description": "",
                "name": "7.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-02-03"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=boshek",
            "name": "boshek",
            "key": "boshek",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Sam Albers",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=cboettig",
            "name": "cboettig",
            "key": "cboettig",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Carl Boettiger",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=cboettig",
            "name": "cboettig",
            "key": "cboettig",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
            },
            "displayName": "Carl Boettiger",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16144/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 11,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/771671",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#issuecomment-1129474342\n\n   https://issues.apache.org/jira/browse/ARROW-16144\n\n\n",
                    "created": "2022-05-18T01:29:20.706+0000",
                    "updated": "2022-05-18T01:29:20.706+0000",
                    "started": "2022-05-18T01:29:20.705+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771671",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/771672",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#issuecomment-1129474353\n\n   :warning: Ticket **has not been started in JIRA**, please click 'Start Progress'.\n\n\n",
                    "created": "2022-05-18T01:29:22.917+0000",
                    "updated": "2022-05-18T01:29:22.917+0000",
                    "started": "2022-05-18T01:29:22.916+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771672",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/771919",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r875991641\n\n\n##########\nr/R/io.R:\n##########\n@@ -322,6 +333,10 @@ detect_compression <- function(path) {\n     return(\"uncompressed\")\n   }\n \n+  ## Remove any trailing slashes\n\nReview Comment:\n   ```suggestion\r\n     # Remove any trailing slashes, which FileSystem$from_uri may add\r\n   ```\n\n\n\n##########\nr/R/io.R:\n##########\n@@ -309,11 +310,21 @@ make_output_stream <- function(x, filesystem = NULL) {\n     filesystem <- fs_and_path$fs\n     x <- fs_and_path$path\n   }\n+\n+  if (is.null(compression)) {\n+    # Infer compression from sink\n+    compression <- detect_compression(x)\n+  }\n+\n   assert_that(is.string(x))\n-  if (is.null(filesystem)) {\n-    FileOutputStream$create(x)\n+  if (is.null(filesystem) && is_compressed(compression)) {\n+    CompressedOutputStream$create(x) ##compressed local\n+  } else if (is.null(filesystem) && !is_compressed(compression)) {\n+    FileOutputStream$create(x) ## uncompressed local\n+  } else if (!is.null(filesystem) && is_compressed(compression)) {\n+    CompressedOutputStream$create(filesystem$OpenOutputStream(x)) ## compressed s3\n   } else {\n-    filesystem$OpenOutputStream(x)\n+    filesystem$OpenOutputStream(x) ## uncompressed s3\n\nReview Comment:\n   Not only S3, any remote file system (GCS, Azure are coming soon, for example)\n\n\n\n##########\nr/tests/testthat/test-csv.R:\n##########\n@@ -564,6 +564,29 @@ test_that(\"write_csv_arrow can write from RecordBatchReader objects\", {\n   expect_equal(nrow(tbl_in), 3)\n })\n \n+test_that(\"write_csv_arrow() compresses by file extension\", {\n+  skip_if_not_available(\"gzip\")\n+  tfgz <- tempfile(fileext = \".csv.gz\")\n+  tf <- tempfile(fileext = \".csv\")\n+  on.exit(unlink(tf))\n+  on.exit(unlink(tfgz))\n+\n+  write_csv_arrow(tbl, tf)\n+  write_csv_arrow(tbl, tfgz)\n+  expect_lt(file.size(tfgz), file.size(tf))\n+})\n+\n+test_that(\"read/write compressed file\", {\n\nReview Comment:\n   Why is this a separate test? You could read in the file(s) in the previous test\n\n\n\n##########\nr/tests/testthat/test-s3-minio.R:\n##########\n@@ -54,6 +54,24 @@ if (arrow_with_s3() && process_is_running(\"minio server\")) {\n     )\n   })\n \n+  test_that(\"read/write compressed csv by filesystem\", {\n+    dat <- tibble(x = seq(1, 10, by = 0.2))\n\nReview Comment:\n   Does this need to be skipped if gzip is not present or have we already skipped by this point?\n\n\n\n",
                    "created": "2022-05-18T14:47:52.667+0000",
                    "updated": "2022-05-18T14:47:52.667+0000",
                    "started": "2022-05-18T14:47:52.667+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771919",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/771930",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r875999848\n\n\n##########\nr/R/io.R:\n##########\n@@ -292,7 +292,7 @@ make_readable_file <- function(file, mmap = TRUE, compression = NULL, filesystem\n   file\n }\n \n-make_output_stream <- function(x, filesystem = NULL) {\n+make_output_stream <- function(x, filesystem = NULL, compression = NULL) {\n\nReview Comment:\n   One thing to watch out here: sometimes people name their parquet files `something.parquet.snappy`, but you wouldn't use a CompressedOutputStream for that, you'd pass the compression option to the parquet writer itself. I would guess that the make_readable_file() path handles this already, maybe that can be a model (or maybe it doesn't and needs to).\n\n\n\n##########\nr/R/io.R:\n##########\n@@ -301,6 +301,7 @@ make_output_stream <- function(x, filesystem = NULL) {\n     return(MakeRConnectionOutputStream(x))\n   }\n \n+\n\nReview Comment:\n   ```suggestion\r\n   ```\n\n\n\n",
                    "created": "2022-05-18T14:52:07.846+0000",
                    "updated": "2022-05-18T14:52:07.846+0000",
                    "started": "2022-05-18T14:52:07.846+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771930",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/771931",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r876000318\n\n\n##########\nr/R/io.R:\n##########\n@@ -322,6 +333,10 @@ detect_compression <- function(path) {\n     return(\"uncompressed\")\n   }\n \n+  ## Remove any trailing slashes\n+  path <- gsub(\"/$\", \"\", path)\n+\n\nReview Comment:\n   ```suggestion\r\n   ```\n\n\n\n",
                    "created": "2022-05-18T14:52:32.879+0000",
                    "updated": "2022-05-18T14:52:32.879+0000",
                    "started": "2022-05-18T14:52:32.879+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "771931",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "boshek commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r876183135\n\n\n##########\nr/R/io.R:\n##########\n@@ -292,7 +292,7 @@ make_readable_file <- function(file, mmap = TRUE, compression = NULL, filesystem\n   file\n }\n \n-make_output_stream <- function(x, filesystem = NULL) {\n+make_output_stream <- function(x, filesystem = NULL, compression = NULL) {\n\nReview Comment:\n   So for the `parquet.snappy` or even `snappy.parquet` I think it works because \"snappy\" isn't included here: \r\n   https://github.com/apache/arrow/blob/3df2e0568240d6b629c0a3163df21a1a2a160810/r/R/io.R#L325-L330\r\n   \r\n   But if someone tried something like this we do get an error that isn't super informative. I _think_ this is outside this PR so could the resolution here be to open another ticket for this specifically? \r\n   ``` r\r\n   library(arrow, warn.conflicts = FALSE)\r\n   tf <- tempfile(fileext = \".parquet.gz\")\r\n   write_parquet(data.frame(x = 1:5), tf, compression = \"gzip\", compression_level = 5)\r\n   read_parquet(tf)\r\n   #> Error: file must be a \"RandomAccessFile\"\r\n   ```\n\n\n\n##########\nr/tests/testthat/test-s3-minio.R:\n##########\n@@ -54,6 +54,24 @@ if (arrow_with_s3() && process_is_running(\"minio server\")) {\n     )\n   })\n \n+  test_that(\"read/write compressed csv by filesystem\", {\n+    dat <- tibble(x = seq(1, 10, by = 0.2))\n\nReview Comment:\n   I will add in to be defensive. \n\n\n\n",
                    "created": "2022-05-18T17:53:27.411+0000",
                    "updated": "2022-05-18T17:53:27.411+0000",
                    "started": "2022-05-18T17:53:27.410+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772056",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772058",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "boshek commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r876183537\n\n\n##########\nr/tests/testthat/test-csv.R:\n##########\n@@ -564,6 +564,29 @@ test_that(\"write_csv_arrow can write from RecordBatchReader objects\", {\n   expect_equal(nrow(tbl_in), 3)\n })\n \n+test_that(\"write_csv_arrow() compresses by file extension\", {\n+  skip_if_not_available(\"gzip\")\n+  tfgz <- tempfile(fileext = \".csv.gz\")\n+  tf <- tempfile(fileext = \".csv\")\n+  on.exit(unlink(tf))\n+  on.exit(unlink(tfgz))\n+\n+  write_csv_arrow(tbl, tf)\n+  write_csv_arrow(tbl, tfgz)\n+  expect_lt(file.size(tfgz), file.size(tf))\n+})\n+\n+test_that(\"read/write compressed file\", {\n\nReview Comment:\n   Oh good point no reason. \n\n\n\n",
                    "created": "2022-05-18T17:53:52.416+0000",
                    "updated": "2022-05-18T17:53:52.416+0000",
                    "started": "2022-05-18T17:53:52.415+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772058",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772141",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r876393144\n\n\n##########\nr/R/io.R:\n##########\n@@ -292,7 +292,7 @@ make_readable_file <- function(file, mmap = TRUE, compression = NULL, filesystem\n   file\n }\n \n-make_output_stream <- function(x, filesystem = NULL) {\n+make_output_stream <- function(x, filesystem = NULL, compression = NULL) {\n\nReview Comment:\n   Sure, this fails on master too so ok to make a separate JIRA.\n\n\n\n",
                    "created": "2022-05-18T21:21:49.435+0000",
                    "updated": "2022-05-18T21:21:49.435+0000",
                    "started": "2022-05-18T21:21:49.435+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772141",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772144",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on code in PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#discussion_r876393144\n\n\n##########\nr/R/io.R:\n##########\n@@ -292,7 +292,7 @@ make_readable_file <- function(file, mmap = TRUE, compression = NULL, filesystem\n   file\n }\n \n-make_output_stream <- function(x, filesystem = NULL) {\n+make_output_stream <- function(x, filesystem = NULL, compression = NULL) {\n\nReview Comment:\n   Sure, this fails on master too so ok to make a separate JIRA (please link to it here when you make it).\n\n\n\n",
                    "created": "2022-05-18T21:24:44.645+0000",
                    "updated": "2022-05-18T21:24:44.645+0000",
                    "started": "2022-05-18T21:24:44.644+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772144",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772145",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #13183: ARROW-16144: [R] Write compressed data streams (particularly over S3)\nURL: https://github.com/apache/arrow/pull/13183\n\n\n",
                    "created": "2022-05-18T21:25:02.052+0000",
                    "updated": "2022-05-18T21:25:02.052+0000",
                    "started": "2022-05-18T21:25:02.052+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772145",
                    "issueId": "13438437"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/worklog/772276",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ursabot commented on PR #13183:\nURL: https://github.com/apache/arrow/pull/13183#issuecomment-1131232486\n\n   Benchmark runs are scheduled for baseline = ce4dcbdf5f1bcfb3f23b494598b9125c8e7ee52e and contender = d2cbe9e0e2ce206fba71d3d171babe36bada1a9d. d2cbe9e0e2ce206fba71d3d171babe36bada1a9d is a master commit associated with this PR. Results will be available as each benchmark for each run completes.\n   Conbench compare runs links:\n   [Finished :arrow_down:0.0% :arrow_up:0.0%] [ec2-t3-xlarge-us-east-2](https://conbench.ursa.dev/compare/runs/fd040c4d0b6a48758dfd898cbfba4b86...36a656f35d7a4d48b792a81906043fc1/)\n   [Failed :arrow_down:1.29% :arrow_up:0.0%] [test-mac-arm](https://conbench.ursa.dev/compare/runs/c48cb85c068f48a083d80fc67e0995e9...b9f36d3481b94ae28f1e85e1c960a4ea/)\n   [Failed :arrow_down:0.0% :arrow_up:0.0%] [ursa-i9-9960x](https://conbench.ursa.dev/compare/runs/90ae49d1c11441618a2107fe3f9f16f1...9ff3b051ad0c43e39f60dbe5713897db/)\n   [Finished :arrow_down:0.28% :arrow_up:0.08%] [ursa-thinkcentre-m75q](https://conbench.ursa.dev/compare/runs/17b705000e04465a90f8f99f5c4eeafc...01a4529c238f4b77ba0f1279a08cb291/)\n   Buildkite builds:\n   [Finished] [`d2cbe9e0` ec2-t3-xlarge-us-east-2](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/789)\n   [Failed] [`d2cbe9e0` test-mac-arm](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/786)\n   [Failed] [`d2cbe9e0` ursa-i9-9960x](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/776)\n   [Finished] [`d2cbe9e0` ursa-thinkcentre-m75q](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/792)\n   [Finished] [`ce4dcbdf` ec2-t3-xlarge-us-east-2](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ec2-t3-xlarge-us-east-2/builds/788)\n   [Failed] [`ce4dcbdf` test-mac-arm](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-test-mac-arm/builds/785)\n   [Failed] [`ce4dcbdf` ursa-i9-9960x](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-i9-9960x/builds/775)\n   [Finished] [`ce4dcbdf` ursa-thinkcentre-m75q](https://buildkite.com/apache-arrow/arrow-bci-benchmark-on-ursa-thinkcentre-m75q/builds/791)\n   Supported benchmarks:\n   ec2-t3-xlarge-us-east-2: Supported benchmark langs: Python, R. Runs only benchmarks with cloud = True\n   test-mac-arm: Supported benchmark langs: C++, Python, R\n   ursa-i9-9960x: Supported benchmark langs: Python, R, JavaScript\n   ursa-thinkcentre-m75q: Supported benchmark langs: C++, Java\n   \n\n\n",
                    "created": "2022-05-19T05:42:23.718+0000",
                    "updated": "2022-05-19T05:42:23.718+0000",
                    "started": "2022-05-19T05:42:23.717+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "772276",
                    "issueId": "13438437"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 6600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4c8dffb8[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@42975080[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3c41ac02[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@442ae85a[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47042fc7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@4f1d6e18[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7e0dea45[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6d76a5e6[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@bead598[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2fa31753[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e6d8f20[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@666c549e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6600,
        "customfield_12312520": null,
        "customfield_12312521": "Wed May 18 21:25:03 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-05-18T21:25:03.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-16144/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2022-04-07T17:03:25.000+0000",
        "updated": "2022-05-19T05:42:24.000+0000",
        "timeoriginalestimate": null,
        "description": "The python bindings have `CompressedOutputStream`, but\u00a0 I don't see how we can do this on the R side (e.g. with `write_csv_arrow()`).\u00a0 It would be wonderful if we could both read and write compressed streams, particularly for CSV and particularly for remote filesystems, where this can provide considerable performance improvements.\u00a0 \r\n\r\n(For comparison, readr will write a compressed stream automatically based on the extension for the given filename, e.g. `readr::write_csv(data, \"file.csv.gz\")` or `write_csv(\"data.file.xz\")`\u00a0 )",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Write compressed data streams (particularly over S3)",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/comment/17520635",
                    "id": "17520635",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "body": "I'm fairly sure this is implemented...is this the kind of behaviour you were looking for?\r\n\r\n{code:R}\r\nlibrary(arrow, warn.conflicts = FALSE)\r\n\r\ntf <- tempfile(fileext = \".gz\")\r\nwrite_csv_arrow(mtcars, tf)\r\nreadr::read_csv(gzfile(tf))\r\n#> Rows: 32 Columns: 11\r\n#> \u2500\u2500 Column specification \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n#> Delimiter: \",\"\r\n#> dbl (11): mpg, cyl, disp, hp, drat, wt, qsec, vs, am, gear, carb\r\n#> \r\n#> \u2139 Use `spec()` to retrieve the full column specification for this data.\r\n#> \u2139 Specify the column types or set `show_col_types = FALSE` to quiet this message.\r\n#> # A tibble: 32 \u00d7 11\r\n#>      mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb\r\n#>    <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\r\n#>  1  21       6  160    110  3.9   2.62  16.5     0     1     4     4\r\n#>  2  21       6  160    110  3.9   2.88  17.0     0     1     4     4\r\n#>  3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1\r\n#>  4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1\r\n#>  5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2\r\n#>  6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1\r\n#>  7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4\r\n#>  8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2\r\n#>  9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2\r\n#> 10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4\r\n#> # \u2026 with 22 more rows\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "created": "2022-04-11T15:04:42.770+0000",
                    "updated": "2022-04-11T15:04:42.770+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/comment/17520814",
                    "id": "17520814",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=cboettig",
                        "name": "cboettig",
                        "key": "cboettig",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Carl Boettiger",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Hi, sorry, but I believe this is not compressing the file at all.\u00a0\u00a0 (Note that there's no need to use `gzfile` in your call to readr, nor does it cause a failure if the file is not compressed.\u00a0 `connection` types can be confusing in R.\u00a0 \r\n\r\nWitness this example: with readr, changing the extension to include .gz results in a smaller file with a different hash, but in arrow I get the identical hash and file size, so I think no compression is happening.\u00a0 \r\n\r\n\r\n\r\n{code:java}\r\nlibrary(arrow, warn.conflicts = FALSE)tf <- tempfile(fileext = \".gz\")\r\ntf_plain <- tempfile(fileext = \".csv\")## In readr, compressed & non-compressed have different hashes as expected\r\nreadr::write_csv(mtcars, tf)\r\ngz <- openssl::sha256(file(tf, \"rb\"))\r\nreadr::write_csv(mtcars, tf_plain)\r\nplain <- openssl::sha256(file(tf_plain, \"rb\"))\r\ntestthat::expect_lt(fs::file_size(tf), fs::file_size(tf_plain))\r\ntestthat::expect_false(identical(gz, plain))\r\nwrite_csv_arrow(mtcars, tf)\r\ngz <- openssl::sha256(file(tf, \"rb\"))\r\nwrite_csv_arrow(mtcars, tf_plain)\r\nplain <- openssl::sha256(file(tf_plain, \"rb\"))# these fail\r\ntestthat::expect_lt(fs::file_size(tf), fs::file_size(tf_plain))\r\n#> Error: fs::file_size(tf) is not strictly less than fs::file_size(tf_plain). Difference: 0\r\ntestthat::expect_false(identical(gz, plain))\u00a0\r\n#> Error: identical(gz, plain) is not FALSE\r\n#>\u00a0\r\n#> `actual`: \u00a0 TRUE\u00a0\r\n#> `expected`: FALSE\r\n{code}\r\n\r\nI should also have mentioned, I'm hoping with arrow that I can use this with the S3 object store explicitly, e.g.\u00a0\r\n\r\n\r\n{code:java}\r\ns3 <- s3_bucket(\"test\", endpoint_override= \"minio.thelio.carlboettiger.info\")\r\npath <- s3$path(\"cars.csv.gz\")\r\nopenssl::sha256(url(\"https://minio.thelio.carlboettiger.info/test/cars.csv.gz\")) {code}\r\n\u00a0\r\n\r\nBut that doesn't work either.\u00a0 Also I would expect to have finer control over output stream to write generic compressed objects with the filesystem interface, e.g. using something like s3$OpenCompressedOutputStream, just like we can use s3$OpenOutputStream.\u00a0 \r\n\r\nThanks so much for your help.\u00a0 Arrow is just such an amazing library, and really a game-changer for data science workflows in R in particular.\u00a0 Very much appreciate all you do and eagerly watch for each release!\r\n\r\n\u00a0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=cboettig",
                        "name": "cboettig",
                        "key": "cboettig",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34058",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34058",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34058",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34058"
                        },
                        "displayName": "Carl Boettiger",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2022-04-11T21:25:29.198+0000",
                    "updated": "2022-04-11T21:25:29.198+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/comment/17521132",
                    "id": "17521132",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "body": "Thank you for catching my error here! I know that we did some compression detection but it turns out that's only on read: https://github.com/apache/arrow/blob/master/r/R/io.R#L240-L298\r\n\r\nYou can use {{OpenOutputStream}} and {{CompressedOutputStream}} for any filesystem (including S3), although we would need to implement the compression detection based on filename for this to \"just work\" with the .gz suffix:\r\n\r\n{code:R}\r\nlibrary(arrow, warn.conflicts = FALSE)\r\n\r\ndir <- tempfile()\r\ndir.create(dir)\r\nsubdir <- file.path(dir, \"bucket\")\r\ndir.create(subdir)\r\n\r\n\r\nminio_server <- processx::process$new(\"minio\", args = c(\"server\", dir), supervise = TRUE)\r\nSys.sleep(1)\r\nstopifnot(minio_server$is_alive())\r\n\r\ns3_uri <- \"s3://minioadmin:minioadmin@?scheme=http&endpoint_override=localhost%3A9000\"\r\nbucket <- s3_bucket(s3_uri)\r\n\r\ndata <- data.frame(x = 1:1e4)\r\n\r\nout_compressed <- CompressedOutputStream$create(bucket$OpenOutputStream(\"bucket/data.csv.gz\"))\r\nwrite_csv_arrow(data, out_compressed)\r\nout_compressed$close()\r\n\r\n\r\nout <- bucket$OpenOutputStream(\"bucket/data.csv\")\r\nwrite_csv_arrow(data, out)\r\nout$close()\r\n\r\nfile.size(file.path(subdir, \"data.csv.gz\"))\r\n#> [1] 22627\r\nfile.size(file.path(subdir, \"data.csv\"))\r\n#> [1] 48898\r\n\r\nminio_server$interrupt()\r\n#> [1] TRUE\r\nSys.sleep(1)\r\nstopifnot(!minio_server$is_alive())\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=paleolimbot",
                        "name": "paleolimbot",
                        "key": "paleolimbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=paleolimbot&avatarId=47795",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paleolimbot&avatarId=47795",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paleolimbot&avatarId=47795",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paleolimbot&avatarId=47795"
                        },
                        "displayName": "Dewey Dunnington",
                        "active": true,
                        "timeZone": "America/Halifax"
                    },
                    "created": "2022-04-12T13:04:23.499+0000",
                    "updated": "2022-04-12T13:05:08.152+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13438437/comment/17539090",
                    "id": "17539090",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 13183\n[https://github.com/apache/arrow/pull/13183]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-05-18T21:25:03.074+0000",
                    "updated": "2022-05-18T21:25:03.074+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z119gw:",
        "customfield_12314139": null
    }
}