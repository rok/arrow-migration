{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13386334",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334",
    "key": "ARROW-13200",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12618270",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12618270",
                "type": {
                    "id": "10001",
                    "name": "dependent",
                    "inward": "is depended upon by",
                    "outward": "depends upon",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/10001"
                },
                "outwardIssue": {
                    "id": "13383508",
                    "key": "ARROW-13064",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13383508",
                    "fields": {
                        "summary": "[C++] Add a general \"if, ifelse, ..., else\" kernel (\"CASE WHEN\")",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                            "id": "4",
                            "description": "An improvement or enhancement to an existing feature or task.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                            "name": "Improvement",
                            "subtask": false,
                            "avatarId": 21140
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
            "name": "icook",
            "key": "icook",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
            },
            "displayName": "Ian Cook",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
            "name": "icook",
            "key": "icook",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
            },
            "displayName": "Ian Cook",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
            "name": "icook",
            "key": "icook",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
            },
            "displayName": "Ian Cook",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13200/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624002",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook opened a new pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T05:57:05.283+0000",
                    "updated": "2021-07-17T05:57:05.283+0000",
                    "started": "2021-07-17T05:57:05.283+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624002",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624003",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#issuecomment-881836620\n\n\n   https://issues.apache.org/jira/browse/ARROW-13200\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T05:57:09.158+0000",
                    "updated": "2021-07-17T05:57:09.158+0000",
                    "started": "2021-07-17T05:57:09.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624003",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624039",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#issuecomment-881929900\n\n\n   Let's merge #10724 before we merge this. I will rebase and resolve the conflicts after #10724 is merged.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T17:18:35.542+0000",
                    "updated": "2021-07-17T17:18:35.542+0000",
                    "started": "2021-07-17T17:18:35.541+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624039",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624040",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#issuecomment-881930188\n\n\n   @github-actions crossbow submit test-r-without-arrow test-r-minimal-build\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T17:20:41.255+0000",
                    "updated": "2021-07-17T17:20:41.255+0000",
                    "started": "2021-07-17T17:20:41.255+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624040",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624041",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#issuecomment-881930316\n\n\n   Revision: db7c0d267b6dbc1c35d29d4d08aafcd7f99e2334\n   \n   Submitted crossbow builds: [ursacomputing/crossbow @ actions-610](https://github.com/ursacomputing/crossbow/branches/all?query=actions-610)\n   \n   |Task|Status|\n   |----|------|\n   |test-r-minimal-build|[![Azure](https://dev.azure.com/ursacomputing/crossbow/_apis/build/status/ursacomputing.crossbow?branchName=actions-610-azure-test-r-minimal-build)](https://dev.azure.com/ursacomputing/crossbow/_build/latest?definitionId=1&branchName=actions-610-azure-test-r-minimal-build)|\n   |test-r-without-arrow|[![Azure](https://dev.azure.com/ursacomputing/crossbow/_apis/build/status/ursacomputing.crossbow?branchName=actions-610-azure-test-r-without-arrow)](https://dev.azure.com/ursacomputing/crossbow/_build/latest?definitionId=1&branchName=actions-610-azure-test-r-without-arrow)|\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T17:21:36.685+0000",
                    "updated": "2021-07-17T17:21:36.685+0000",
                    "started": "2021-07-17T17:21:36.685+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624041",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624042",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671724634\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -169,7 +169,7 @@ nse_funcs$is.integer64 <- function(x) {\n   x$type_id() == Type[\"INT64\"]\n }\n nse_funcs$is.logical <- function(x) {\n-  x$type_id() == Type[\"BOOL\"]\n+  is.logical(x) || (inherits(x, \"Expression\") && x$type_id() == Type[\"BOOL\"])\n\nReview comment:\n       This is a dup of a change made in #10724 \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T17:45:04.958+0000",
                    "updated": "2021-07-17T17:45:04.958+0000",
                    "started": "2021-07-17T17:45:04.958+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624042",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624043",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671724845\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -651,3 +651,47 @@ nse_funcs$log <- function(x, base = exp(1)) {\n }\n \n nse_funcs$logb <- nse_funcs$log\n+\n+nse_funcs$case_when <- function(...) {\n+  formulas <- list2(...)\n+  n <- length(formulas)\n+  if (n == 0) {\n+    abort(\"No cases provided in case_when()\")\n+  }\n+  query <- vector(\"list\", n)\n+  value <- vector(\"list\", n)\n+  mask <- caller_env()\n+  for (i in seq_len(n)) {\n+    f <- formulas[[i]]\n+    if (!inherits(f, \"formula\")) {\n+      abort(\"Each argument to case_when() must be a two-sided formula\")\n+    }\n+    query[[i]] <- arrow_eval(f[[2]], mask)\n+    value[[i]] <- arrow_eval(f[[3]], mask)\n+    if (!nse_funcs$is.logical(query[[i]])) {\n+      abort(\"Left side of each formula in case_when() must be a logical expression\")\n+    }\n+    # TODO: remove these checks after the case_when kernel supports variable-width\n+    # types (ARROW-13222)\n+    has_bad_r_type <- inherits(value[[i]], c(\"character\", \"raw\", \"list\", \"factor\"))\n+    has_bad_arrow_type <- inherits(value[[i]], \"Expression\") &&\n+      value[[i]]$type_id() %in% Type[c(\n+      \"STRING\", \"BINARY\", \"LIST\", \"MAP\", \"STRUCT\", \"SPARSE_UNION\",\n+      \"DENSE_UNION\", \"DICTIONARY\", \"EXTENSION\", \"FIXED_SIZE_LIST\",\n+      \"LARGE_STRING\", \"LARGE_BINARY\", \"LARGE_LIST\")]\n\nReview comment:\n       Some of these types are not testable in R but are obviously variable-width. For the ones that are testable in R, I tested them to confirm they don't yet work with the `case_when` kernel, and I tested all the others to confirm they do work.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T17:47:48.204+0000",
                    "updated": "2021-07-17T17:47:48.204+0000",
                    "started": "2021-07-17T17:47:48.204+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624043",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624047",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671727895\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -651,3 +651,47 @@ nse_funcs$log <- function(x, base = exp(1)) {\n }\n \n nse_funcs$logb <- nse_funcs$log\n+\n+nse_funcs$case_when <- function(...) {\n+  formulas <- list2(...)\n+  n <- length(formulas)\n+  if (n == 0) {\n+    abort(\"No cases provided in case_when()\")\n+  }\n+  query <- vector(\"list\", n)\n+  value <- vector(\"list\", n)\n+  mask <- caller_env()\n+  for (i in seq_len(n)) {\n+    f <- formulas[[i]]\n+    if (!inherits(f, \"formula\")) {\n+      abort(\"Each argument to case_when() must be a two-sided formula\")\n+    }\n+    query[[i]] <- arrow_eval(f[[2]], mask)\n+    value[[i]] <- arrow_eval(f[[3]], mask)\n+    if (!nse_funcs$is.logical(query[[i]])) {\n+      abort(\"Left side of each formula in case_when() must be a logical expression\")\n+    }\n+    # TODO: remove these checks after the case_when kernel supports variable-width\n+    # types (ARROW-13222)\n\nReview comment:\n       Can we just let the Arrow C++ library error out if it doesn't support the types? Is our error message that much better? Seems like extra work to try to keep this validation in sync with the C++ library.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T18:18:47.282+0000",
                    "updated": "2021-07-17T18:18:47.282+0000",
                    "started": "2021-07-17T18:18:47.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624047",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624048",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671728080\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr.R\n##########\n@@ -1063,4 +1063,123 @@ test_that(\"trig functions\", {\n     df\n   )\n \n-})\n\\ No newline at end of file\n+})\n+\n+test_that(\"case_when()\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(lgl ~ dbl, !false ~ dbl + dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(cw = case_when(int > 5 ~ 1, TRUE ~ 0)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(chr %in% letters[1:3] ~ 1L) + 41L) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      filter(case_when(\n+        dbl + int - 1.1 == dbl2 ~ TRUE,\n+        NA ~ NA,\n+        TRUE ~ FALSE\n+      ) & !is.na(dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+\n+  # dplyr::case_when() errors if values on right side of formulas do not have\n+  # exactly the same type, but the Arrow case_when kernel allows compatible types\n+  expect_equal(\n+    tbl %>%\n+      mutate(i64 = as.integer64(1e10)) %>%\n+      Table$create() %>%\n+      transmute(cw = case_when(\n+        is.na(fct) ~ int,\n+        is.na(chr) ~ dbl,\n+        TRUE ~ i64\n+      )) %>%\n+      collect(),\n+    tbl %>%\n+      transmute(\n+        cw = ifelse(is.na(fct), int, ifelse(is.na(chr), dbl, 1e10))\n+      )\n+  )\n+\n+  # expected errors (which are caught by abandon_ship() and changed to warnings)\n+  # TODO: Find a way to test these directly without abandon_ship() interfering\n\nReview comment:\n       `expect_error(nse_funcs$case_when(), \"case_when\")`?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T18:20:41.940+0000",
                    "updated": "2021-07-17T18:20:41.940+0000",
                    "started": "2021-07-17T18:20:41.940+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624048",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624049",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671728387\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr.R\n##########\n@@ -1063,4 +1063,123 @@ test_that(\"trig functions\", {\n     df\n   )\n \n-})\n\\ No newline at end of file\n+})\n+\n+test_that(\"case_when()\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(lgl ~ dbl, !false ~ dbl + dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(cw = case_when(int > 5 ~ 1, TRUE ~ 0)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(chr %in% letters[1:3] ~ 1L) + 41L) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      filter(case_when(\n+        dbl + int - 1.1 == dbl2 ~ TRUE,\n+        NA ~ NA,\n+        TRUE ~ FALSE\n+      ) & !is.na(dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+\n+  # dplyr::case_when() errors if values on right side of formulas do not have\n+  # exactly the same type, but the Arrow case_when kernel allows compatible types\n+  expect_equal(\n+    tbl %>%\n+      mutate(i64 = as.integer64(1e10)) %>%\n+      Table$create() %>%\n+      transmute(cw = case_when(\n+        is.na(fct) ~ int,\n+        is.na(chr) ~ dbl,\n+        TRUE ~ i64\n+      )) %>%\n+      collect(),\n+    tbl %>%\n+      transmute(\n+        cw = ifelse(is.na(fct), int, ifelse(is.na(chr), dbl, 1e10))\n+      )\n+  )\n+\n+  # expected errors (which are caught by abandon_ship() and changed to warnings)\n+  # TODO: Find a way to test these directly without abandon_ship() interfering\n\nReview comment:\n       For the zero-cases error, yes, that would work. But for the other errors I don't think it would.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T18:23:37.307+0000",
                    "updated": "2021-07-17T18:23:37.307+0000",
                    "started": "2021-07-17T18:23:37.307+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624049",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624050",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#issuecomment-881939617\n\n\n   I've merged the news PR, so after you rebase please add a bullet in the new dplyr functions section for this (noting any type limitations) and also note if_else there too (which I think doesn't have those same type limitations?)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T18:24:30.616+0000",
                    "updated": "2021-07-17T18:24:30.616+0000",
                    "started": "2021-07-17T18:24:30.616+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624050",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624051",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671729110\n\n\n\n##########\nFile path: r/R/dplyr-functions.R\n##########\n@@ -651,3 +651,47 @@ nse_funcs$log <- function(x, base = exp(1)) {\n }\n \n nse_funcs$logb <- nse_funcs$log\n+\n+nse_funcs$case_when <- function(...) {\n+  formulas <- list2(...)\n+  n <- length(formulas)\n+  if (n == 0) {\n+    abort(\"No cases provided in case_when()\")\n+  }\n+  query <- vector(\"list\", n)\n+  value <- vector(\"list\", n)\n+  mask <- caller_env()\n+  for (i in seq_len(n)) {\n+    f <- formulas[[i]]\n+    if (!inherits(f, \"formula\")) {\n+      abort(\"Each argument to case_when() must be a two-sided formula\")\n+    }\n+    query[[i]] <- arrow_eval(f[[2]], mask)\n+    value[[i]] <- arrow_eval(f[[3]], mask)\n+    if (!nse_funcs$is.logical(query[[i]])) {\n+      abort(\"Left side of each formula in case_when() must be a logical expression\")\n+    }\n+    # TODO: remove these checks after the case_when kernel supports variable-width\n+    # types (ARROW-13222)\n\nReview comment:\n       Yep, agreed, there's really not much (any?) benefit to having these checks here. Removed in 2ee3c8c5909857452d89a722459127ddde723c05.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T18:31:55.388+0000",
                    "updated": "2021-07-17T18:31:55.388+0000",
                    "started": "2021-07-17T18:31:55.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624051",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624054",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671732914\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr.R\n##########\n@@ -1063,4 +1063,123 @@ test_that(\"trig functions\", {\n     df\n   )\n \n-})\n\\ No newline at end of file\n+})\n+\n+test_that(\"case_when()\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(lgl ~ dbl, !false ~ dbl + dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(cw = case_when(int > 5 ~ 1, TRUE ~ 0)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(chr %in% letters[1:3] ~ 1L) + 41L) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      filter(case_when(\n+        dbl + int - 1.1 == dbl2 ~ TRUE,\n+        NA ~ NA,\n+        TRUE ~ FALSE\n+      ) & !is.na(dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+\n+  # dplyr::case_when() errors if values on right side of formulas do not have\n+  # exactly the same type, but the Arrow case_when kernel allows compatible types\n+  expect_equal(\n+    tbl %>%\n+      mutate(i64 = as.integer64(1e10)) %>%\n+      Table$create() %>%\n+      transmute(cw = case_when(\n+        is.na(fct) ~ int,\n+        is.na(chr) ~ dbl,\n+        TRUE ~ i64\n+      )) %>%\n+      collect(),\n+    tbl %>%\n+      transmute(\n+        cw = ifelse(is.na(fct), int, ifelse(is.na(chr), dbl, 1e10))\n+      )\n+  )\n+\n+  # expected errors (which are caught by abandon_ship() and changed to warnings)\n+  # TODO: Find a way to test these directly without abandon_ship() interfering\n\nReview comment:\n       I tried several approaches for testing these errors directly, but I ended up with various errors and rlang data mask warnings. IMO: let's leave this as is with the TODO to revisit later.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T19:10:38.912+0000",
                    "updated": "2021-07-17T19:10:38.912+0000",
                    "started": "2021-07-17T19:10:38.912+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624054",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624065",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671745349\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr.R\n##########\n@@ -1063,4 +1063,123 @@ test_that(\"trig functions\", {\n     df\n   )\n \n-})\n\\ No newline at end of file\n+})\n+\n+test_that(\"case_when()\", {\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(lgl ~ dbl, !false ~ dbl + dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      mutate(cw = case_when(int > 5 ~ 1, TRUE ~ 0)) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      transmute(cw = case_when(chr %in% letters[1:3] ~ 1L) + 41L) %>%\n+      collect(),\n+    tbl\n+  )\n+  expect_dplyr_equal(\n+    input %>%\n+      filter(case_when(\n+        dbl + int - 1.1 == dbl2 ~ TRUE,\n+        NA ~ NA,\n+        TRUE ~ FALSE\n+      ) & !is.na(dbl2)) %>%\n+      collect(),\n+    tbl\n+  )\n+\n+  # dplyr::case_when() errors if values on right side of formulas do not have\n+  # exactly the same type, but the Arrow case_when kernel allows compatible types\n+  expect_equal(\n+    tbl %>%\n+      mutate(i64 = as.integer64(1e10)) %>%\n+      Table$create() %>%\n+      transmute(cw = case_when(\n+        is.na(fct) ~ int,\n+        is.na(chr) ~ dbl,\n+        TRUE ~ i64\n+      )) %>%\n+      collect(),\n+    tbl %>%\n+      transmute(\n+        cw = ifelse(is.na(fct), int, ifelse(is.na(chr), dbl, 1e10))\n+      )\n+  )\n+\n+  # expected errors (which are caught by abandon_ship() and changed to warnings)\n+  # TODO: Find a way to test these directly without abandon_ship() interfering\n\nReview comment:\n       ```suggestion\r\n     # TODO: ARROW-13370 to test the messages better\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T21:24:31.635+0000",
                    "updated": "2021-07-17T21:24:31.635+0000",
                    "started": "2021-07-17T21:24:31.635+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624065",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624066",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737#discussion_r671745447\n\n\n\n##########\nFile path: r/src/compute.cpp\n##########\n@@ -241,6 +241,13 @@ std::shared_ptr<arrow::compute::FunctionOptions> make_compute_options(\n     return out;\n   }\n \n+  if (func_name == \"make_struct\") {\n+    using Options = arrow::compute::MakeStructOptions;\n+    // TODO: accept `field_nullability` and `field_metadata` options\n\nReview comment:\n       ```suggestion\r\n       // TODO (ARROW-13371): accept `field_nullability` and `field_metadata` options\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-17T21:25:34.964+0000",
                    "updated": "2021-07-17T21:25:34.964+0000",
                    "started": "2021-07-17T21:25:34.964+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624066",
                    "issueId": "13386334"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/worklog/624080",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook closed pull request #10737:\nURL: https://github.com/apache/arrow/pull/10737\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-07-18T03:11:15.970+0000",
                    "updated": "2021-07-18T03:11:15.970+0000",
                    "started": "2021-07-18T03:11:15.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "624080",
                    "issueId": "13386334"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@43f1e9ec[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d3e8f52[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@23c2ffe3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6a4fa0d6[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@933bc2f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@60c173ac[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@54c8a5b0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4316f6ef[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@57d0f866[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3ce7ad23[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2d137a2a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@59c640e9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Sun Jul 18 03:11:10 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-07-18T03:11:09.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13200/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-06-28T20:16:13.000+0000",
        "updated": "2021-07-18T03:11:17.000+0000",
        "timeoriginalestimate": null,
        "description": "ARROW-13064 adds a {{case_when}}\u00a0kernel that works like a SQL {{CASE WHEN}} expression. This allows us to implement a binding for the {{dplyr}} function {{case_when()}}.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Add binding for case_when()",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13386334/comment/17382700",
                    "id": "17382700",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 10737\n[https://github.com/apache/arrow/pull/10737]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=icook",
                        "name": "icook",
                        "key": "icook",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=icook&avatarId=29388",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=icook&avatarId=29388",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=icook&avatarId=29388",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=icook&avatarId=29388"
                        },
                        "displayName": "Ian Cook",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-07-18T03:11:10.013+0000",
                    "updated": "2021-07-18T03:11:10.013+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0sdr4:",
        "customfield_12314139": null
    }
}