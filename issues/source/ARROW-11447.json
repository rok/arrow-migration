{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13355739",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739",
    "key": "ARROW-11447",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11447/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 21,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/544907",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan opened a new pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381\n\n\n   This adds a `shift` function (now only accept primitive arrays) that shifts an array left or right by `offset`.\r\n   \r\n   This is something that could be used to implement `LAG` `LEAD` etc. in DataFusion and other crates.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-31T15:29:50.081+0000",
                    "updated": "2021-01-31T15:29:50.081+0000",
                    "started": "2021-01-31T15:29:50.081+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "544907",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/544908",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-770400024\n\n\n   https://issues.apache.org/jira/browse/ARROW-11447\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-31T15:30:13.381+0000",
                    "updated": "2021-01-31T15:30:13.381+0000",
                    "started": "2021-01-31T15:30:13.380+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "544908",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/544909",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-770402549\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=h1) Report\n   > Merging [#9381](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=desc) (3cfc067) into [master](https://codecov.io/gh/apache/arrow/commit/b18c5677ecc5058333b69d08f82b267f79d2df8d?el=desc) (b18c567) will **increase** coverage by `0.05%`.\n   > The diff coverage is `100.00%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9381/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #9381      +/-   ##\n   ==========================================\n   + Coverage   81.96%   82.02%   +0.05%     \n   ==========================================\n     Files         230      231       +1     \n     Lines       53374    53520     +146     \n   ==========================================\n   + Hits        43750    43898     +148     \n   + Misses       9624     9622       -2     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/arrow/src/compute/kernels/window.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL3dpbmRvdy5ycw==) | `100.00% <100.00%> (\u00f8)` | |\n   | [rust/arrow/src/compute/kernels/concat.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvY29tcHV0ZS9rZXJuZWxzL2NvbmNhdC5ycw==) | `100.00% <0.00%> (\u00f8)` | |\n   | [rust/parquet/src/encodings/encoding.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9wYXJxdWV0L3NyYy9lbmNvZGluZ3MvZW5jb2RpbmcucnM=) | `95.05% <0.00%> (+0.19%)` | :arrow_up: |\n   | [rust/arrow/src/array/transform/mod.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvYXJyYXkvdHJhbnNmb3JtL21vZC5ycw==) | `93.20% <0.00%> (+0.27%)` | :arrow_up: |\n   | [rust/arrow/src/array/transform/structure.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvYXJyYXkvdHJhbnNmb3JtL3N0cnVjdHVyZS5ycw==) | `83.33% <0.00%> (+3.33%)` | :arrow_up: |\n   | [rust/arrow/src/array/transform/fixed\\_binary.rs](https://codecov.io/gh/apache/arrow/pull/9381/diff?src=pr&el=tree#diff-cnVzdC9hcnJvdy9zcmMvYXJyYXkvdHJhbnNmb3JtL2ZpeGVkX2JpbmFyeS5ycw==) | `84.21% <0.00%> (+5.26%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=footer). Last update [b18c567...3cfc067](https://codecov.io/gh/apache/arrow/pull/9381?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-31T15:48:31.837+0000",
                    "updated": "2021-01-31T15:48:31.837+0000",
                    "started": "2021-01-31T15:48:31.837+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "544909",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ritchie46 commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771805111\n\n\n   LGTM\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-02T17:14:54.700+0000",
                    "updated": "2021-02-02T17:14:54.700+0000",
                    "started": "2021-02-02T17:14:54.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546134",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546208",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ritchie46 edited a comment on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771805111\n\n\n   LGTM\r\n   \r\n   _edit_: The shift direction is opposite to what pandas has implemented though. In Polars I have followed pandas' direction:\r\n   \r\n   that a positive input shifts values to the right.\r\n   \r\n   as it seemed intuitive to me as well. I don't know what other tools do.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-02T19:05:16.289+0000",
                    "updated": "2021-02-02T19:05:16.289+0000",
                    "started": "2021-02-02T19:05:16.288+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546208",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546211",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ritchie46 edited a comment on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771805111\n\n\n   \r\n   _edit_: The shift direction is opposite to what pandas has implemented though. In Polars I have followed pandas' direction:\r\n   \r\n   that a positive input shifts values to the right.\r\n   \r\n   as it seemed intuitive to me as well. I don't know what other tools do.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-02T19:08:21.616+0000",
                    "updated": "2021-02-02T19:08:21.616+0000",
                    "started": "2021-02-02T19:08:21.616+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546211",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546225",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771913447\n\n\n   Hm, interesting indeed @ritchie46 I wrongly assumed that was pandas approach, but I now realize I recently saw `shift(1)` being used for implementing something similar to `LAG`. We should do whatever is standard I would say, maybe we should look at some other libraries as well.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-02T19:27:00.466+0000",
                    "updated": "2021-02-02T19:27:00.466+0000",
                    "started": "2021-02-02T19:27:00.466+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546225",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546613",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ritchie46 commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771805111\n\n\n   LGTM\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-03T01:22:06.787+0000",
                    "updated": "2021-02-03T01:22:06.787+0000",
                    "started": "2021-02-03T01:22:06.787+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546613",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546669",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771913447\n\n\n   Hm, interesting indeed @ritchie46 I wrongly assumed that was pandas approach, but I now realize I recently saw `shift(1)` being used for implementing something similar to `LAG`. We should do whatever is standard I would say, maybe we should look at some other libraries as well.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-03T01:27:34.414+0000",
                    "updated": "2021-02-03T01:27:34.414+0000",
                    "started": "2021-02-03T01:27:34.414+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546669",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/546775",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ritchie46 edited a comment on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-771805111\n\n\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-03T01:37:39.131+0000",
                    "updated": "2021-02-03T01:37:39.131+0000",
                    "started": "2021-02-03T01:37:39.131+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "546775",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/547959",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#discussion_r570614353\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+pub fn shift<T>(values: &PrimitiveArray<T>, offset: i64) -> Result<ArrayRef>\n+where\n+    T: ArrowPrimitiveType,\n+{\n+    // Compute slice\n+    let slice_offset = clamp(offset, 0, values.len() as i64) as usize;\n\nReview comment:\n       This is very neat :)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-04T23:26:38.932+0000",
                    "updated": "2021-02-04T23:26:38.932+0000",
                    "started": "2021-02-04T23:26:38.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "547959",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548261",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nevi-me commented on a change in pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#discussion_r570614353\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+pub fn shift<T>(values: &PrimitiveArray<T>, offset: i64) -> Result<ArrayRef>\n+where\n+    T: ArrowPrimitiveType,\n+{\n+    // Compute slice\n+    let slice_offset = clamp(offset, 0, values.len() as i64) as usize;\n\nReview comment:\n       This is very neat :)\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T10:00:55.451+0000",
                    "updated": "2021-02-05T10:00:55.451+0000",
                    "started": "2021-02-05T10:00:55.451+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548261",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548593",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#discussion_r570891227\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n\nReview comment:\n       I wonder if you can add a doc example here, something like https://github.com/apache/arrow/blob/master/rust/arrow/src/compute/kernels/take.rs#L62-L76 just to show the behavior (lifting / simplifying one of unit tests is probably a good level)\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+pub fn shift<T>(values: &PrimitiveArray<T>, offset: i64) -> Result<ArrayRef>\n+where\n+    T: ArrowPrimitiveType,\n+{\n+    // Compute slice\n+    let slice_offset = clamp(offset, 0, values.len() as i64) as usize;\n+    let length = values.len() - abs(offset) as usize;\n+    let slice = values.slice(slice_offset, length);\n+\n+    // Generate array with remaining `null` items\n+    let nulls = abs(offset as i64) as usize;\n+\n+    let mut null_array = MutableBuffer::new(nulls);\n+    let mut null_data = MutableBuffer::new(nulls * T::get_byte_width());\n+    null_array.extend_zeros(nulls);\n+    null_data.extend_zeros(nulls * T::get_byte_width());\n+\n+    let null_data = ArrayData::new(\n+        T::DATA_TYPE,\n+        nulls as usize,\n+        Some(nulls),\n+        Some(null_array.into()),\n+        0,\n+        vec![null_data.into()],\n+        vec![],\n+    );\n+\n+    // Concatenate both arrays, add nulls after if shift > 0 else before\n+    let null_arr = make_array(Arc::new(null_data));\n+    if offset > 0 {\n+        concat(&[slice.as_ref(), null_arr.as_ref()])\n+    } else {\n+        concat(&[null_arr.as_ref(), slice.as_ref()])\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use crate::array::Int32Array;\n+\n+    use super::*;\n+\n+    #[test]\n+    fn test_shift_neg() {\n+        let a: Int32Array = vec![Some(1), None, Some(4)].into();\n+        let res = shift(&a, -1).unwrap();\n+\n+        let b = res.as_any().downcast_ref::<Int32Array>().unwrap();\n+        assert_eq!(a.len(), res.len());\n+        assert_eq!(false, b.is_valid(0));\n+        assert_eq!(1, b.value(1));\n+        assert_eq!(false, b.is_valid(2));\n\nReview comment:\n       ```suggestion\r\n           let expected: Int32Array = vec![None, Some(1), None].into();\r\n   \r\n           assert_eq!(b, &expected);\r\n   ```\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n\nReview comment:\n       It might also be good to specify what happens if you shift by more than the size of the array (e.g. that there is no error, just the entire array is returned as null)\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+pub fn shift<T>(values: &PrimitiveArray<T>, offset: i64) -> Result<ArrayRef>\n+where\n+    T: ArrowPrimitiveType,\n+{\n+    // Compute slice\n+    let slice_offset = clamp(offset, 0, values.len() as i64) as usize;\n+    let length = values.len() - abs(offset) as usize;\n+    let slice = values.slice(slice_offset, length);\n+\n+    // Generate array with remaining `null` items\n+    let nulls = abs(offset as i64) as usize;\n+\n+    let mut null_array = MutableBuffer::new(nulls);\n+    let mut null_data = MutableBuffer::new(nulls * T::get_byte_width());\n+    null_array.extend_zeros(nulls);\n+    null_data.extend_zeros(nulls * T::get_byte_width());\n+\n+    let null_data = ArrayData::new(\n+        T::DATA_TYPE,\n+        nulls as usize,\n+        Some(nulls),\n+        Some(null_array.into()),\n+        0,\n+        vec![null_data.into()],\n+        vec![],\n+    );\n+\n+    // Concatenate both arrays, add nulls after if shift > 0 else before\n+    let null_arr = make_array(Arc::new(null_data));\n+    if offset > 0 {\n+        concat(&[slice.as_ref(), null_arr.as_ref()])\n+    } else {\n+        concat(&[null_arr.as_ref(), slice.as_ref()])\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use crate::array::Int32Array;\n+\n+    use super::*;\n+\n+    #[test]\n+    fn test_shift_neg() {\n+        let a: Int32Array = vec![Some(1), None, Some(4)].into();\n+        let res = shift(&a, -1).unwrap();\n+\n+        let b = res.as_any().downcast_ref::<Int32Array>().unwrap();\n+        assert_eq!(a.len(), res.len());\n+        assert_eq!(false, b.is_valid(0));\n+        assert_eq!(1, b.value(1));\n+        assert_eq!(false, b.is_valid(2));\n+    }\n+\n+    #[test]\n+    fn test_shift_pos() {\n+        let a: Int32Array = vec![Some(1), None, Some(4)].into();\n+        let res = shift(&a, 1).unwrap();\n+\n+        let b = res.as_any().downcast_ref::<Int32Array>().unwrap();\n+        assert_eq!(a.len(), res.len());\n+        assert_eq!(false, b.is_valid(0));\n+        assert_eq!(4, b.value(1));\n+        assert_eq!(false, b.is_valid(2));\n\nReview comment:\n       ```suggestion\r\n           let expected: Int32Array = vec![None, Some(1), None].into();\r\n   \r\n           assert_eq!(b, &expected);\r\n   ```\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,100 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+pub fn shift<T>(values: &PrimitiveArray<T>, offset: i64) -> Result<ArrayRef>\n+where\n+    T: ArrowPrimitiveType,\n+{\n+    // Compute slice\n+    let slice_offset = clamp(offset, 0, values.len() as i64) as usize;\n+    let length = values.len() - abs(offset) as usize;\n+    let slice = values.slice(slice_offset, length);\n+\n+    // Generate array with remaining `null` items\n+    let nulls = abs(offset as i64) as usize;\n+\n+    let mut null_array = MutableBuffer::new(nulls);\n+    let mut null_data = MutableBuffer::new(nulls * T::get_byte_width());\n+    null_array.extend_zeros(nulls);\n+    null_data.extend_zeros(nulls * T::get_byte_width());\n+\n+    let null_data = ArrayData::new(\n+        T::DATA_TYPE,\n+        nulls as usize,\n+        Some(nulls),\n+        Some(null_array.into()),\n+        0,\n+        vec![null_data.into()],\n+        vec![],\n+    );\n+\n+    // Concatenate both arrays, add nulls after if shift > 0 else before\n+    let null_arr = make_array(Arc::new(null_data));\n+    if offset > 0 {\n+        concat(&[slice.as_ref(), null_arr.as_ref()])\n+    } else {\n+        concat(&[null_arr.as_ref(), slice.as_ref()])\n+    }\n+}\n+\n+#[cfg(test)]\n+mod tests {\n+    use crate::array::Int32Array;\n+\n+    use super::*;\n+\n+    #[test]\n+    fn test_shift_neg() {\n+        let a: Int32Array = vec![Some(1), None, Some(4)].into();\n+        let res = shift(&a, -1).unwrap();\n+\n+        let b = res.as_any().downcast_ref::<Int32Array>().unwrap();\n+        assert_eq!(a.len(), res.len());\n+        assert_eq!(false, b.is_valid(0));\n+        assert_eq!(1, b.value(1));\n+        assert_eq!(false, b.is_valid(2));\n\nReview comment:\n       FWIW I agree with @ritchie46  that I expect `shift([1,NULL,4], -1)` to shift LEFT -- so `[NULL, 4, NULL]` rather than right ( aka [NULL, 1, NULL]`)\r\n   \r\n   I don't think Postgres has any similar function I could find to guide us. I would vote to be consistent with Pandas -- which appears to shift right with a positive shift: https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.shift.html\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T11:24:26.772+0000",
                    "updated": "2021-02-05T11:24:26.772+0000",
                    "started": "2021-02-05T11:24:26.772+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548593",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548599",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-773986297\n\n\n   I agree it is best to have the order the same as pandas, it also seems other libraries do LAG / right shift for positive values as well.\r\n   \r\n   Cleaned it up a bit, added a doc test.\r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T11:50:57.053+0000",
                    "updated": "2021-02-05T11:50:57.053+0000",
                    "started": "2021-02-05T11:50:57.053+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548599",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548602",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#discussion_r570918542\n\n\n\n##########\nFile path: rust/arrow/src/compute/kernels/window.rs\n##########\n@@ -0,0 +1,110 @@\n+// Licensed to the Apache Software Foundation (ASF) under one\n+// or more contributor license agreements.  See the NOTICE file\n+// distributed with this work for additional information\n+// regarding copyright ownership.  The ASF licenses this file\n+// to you under the Apache License, Version 2.0 (the\n+// \"License\"); you may not use this file except in compliance\n+// with the License.  You may obtain a copy of the License at\n+//\n+//   http://www.apache.org/licenses/LICENSE-2.0\n+//\n+// Unless required by applicable law or agreed to in writing,\n+// software distributed under the License is distributed on an\n+// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+// KIND, either express or implied.  See the License for the\n+// specific language governing permissions and limitations\n+// under the License.\n+\n+//! Defines windowing functions, like `shift`ing\n+\n+use crate::compute::concat;\n+use num::{abs, clamp};\n+use std::sync::Arc;\n+\n+use crate::{\n+    array::{make_array, ArrayData, PrimitiveArray},\n+    datatypes::ArrowPrimitiveType,\n+    error::Result,\n+};\n+use crate::{\n+    array::{Array, ArrayRef},\n+    buffer::MutableBuffer,\n+};\n+\n+/// Shifts array by defined number of items (to left or right)\n+/// A positive value for `offset` shifts the array to the left (LAG)\n+/// a negative value shifts the array to the left.\n+/// # Examples\n+/// ```\n+/// use arrow::array::Int32Array;\n+/// use arrow::error::Result;\n+/// use arrow::compute::shift;\n+///\n+/// let a: Int32Array = vec![Some(1), None, Some(4)].into();\n+/// // shift array 1 element to the left\n\nReview comment:\n       ```suggestion\r\n   /// // shift array 1 element to the right\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T11:58:58.839+0000",
                    "updated": "2021-02-05T11:58:58.839+0000",
                    "started": "2021-02-05T11:58:58.839+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548602",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548603",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-773990003\n\n\n   Looking good -- thanks @Dandandan \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T11:59:01.747+0000",
                    "updated": "2021-02-05T11:59:01.747+0000",
                    "started": "2021-02-05T11:59:01.747+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548603",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548841",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-774258321\n\n\n   Looks like there is an error in the simd tests: https://github.com/apache/arrow/pull/9381/checks?check_run_id=1838559432\r\n   \r\n   ```\r\n   \r\n   \r\n   ---- src/compute/kernels/window.rs - compute::kernels::window::shift (line 38) stdout ----\r\n   error[E0615]: attempted to take value of method `as_ref` on type `Arc<dyn Array>`\r\n     --> src/compute/kernels/window.rs:47:16\r\n      |\r\n   12 | assert_eq!(res.as_ref, &expected)\r\n      |                ^^^^^^ method, not a field\r\n      |\r\n   help: use parentheses to call the method\r\n      |\r\n   12 | assert_eq!(res.as_ref(), &expected)\r\n      |                      ^^\r\n   \r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T20:03:29.811+0000",
                    "updated": "2021-02-05T20:03:29.811+0000",
                    "started": "2021-02-05T20:03:29.811+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548841",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/548876",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-774316829\n\n\n   I think this one is ready to go -- I'll plan to merge it tomorrow unless someone else beats me to it\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-05T22:14:01.806+0000",
                    "updated": "2021-02-05T22:14:01.806+0000",
                    "started": "2021-02-05T22:14:01.806+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "548876",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/549010",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb closed pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-06T11:17:57.153+0000",
                    "updated": "2021-02-06T11:17:57.153+0000",
                    "started": "2021-02-06T11:17:57.153+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "549010",
                    "issueId": "13355739"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/worklog/549011",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9381:\nURL: https://github.com/apache/arrow/pull/9381#issuecomment-774456614\n\n\n   Thanks again @Dandandan \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-06T11:18:10.229+0000",
                    "updated": "2021-02-06T11:18:10.229+0000",
                    "started": "2021-02-06T11:18:10.229+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "549011",
                    "issueId": "13355739"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 12600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@219f350a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32c77896[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2778c700[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2e7208b1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1f8a87a2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@5c0a25ac[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3daba9ea[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@322096e[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@48de293f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@45f442cd[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@25f05760[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@368a53c9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12600,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Feb 06 11:17:42 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-02-06T11:17:42.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11447/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-01-31T15:24:06.000+0000",
        "updated": "2021-02-06T11:23:06.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] Add shift kernel",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13355739/comment/17280154",
                    "id": "17280154",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9381\n[https://github.com/apache/arrow/pull/9381]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-02-06T11:17:42.639+0000",
                    "updated": "2021-02-06T11:17:42.639+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0n6mo:",
        "customfield_12314139": null
    }
}