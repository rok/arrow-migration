{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13381886",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886",
    "key": "ARROW-12942",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349983",
                "id": "12349983",
                "description": "",
                "name": "5.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-07-28"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12350125",
                "id": "12350125",
                "name": "4.0.1",
                "archived": false,
                "released": true,
                "releaseDate": "2021-05-26"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=crystrix",
            "name": "crystrix",
            "key": "crystrix",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=crystrix&avatarId=46009",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=crystrix&avatarId=46009",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=crystrix&avatarId=46009",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=crystrix&avatarId=46009"
            },
            "displayName": "Chenxi Li",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=crystrix",
            "name": "crystrix",
            "key": "crystrix",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=crystrix&avatarId=46009",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=crystrix&avatarId=46009",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=crystrix&avatarId=46009",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=crystrix&avatarId=46009"
            },
            "displayName": "Chenxi Li",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=crystrix",
            "name": "crystrix",
            "key": "crystrix",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=crystrix&avatarId=46009",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=crystrix&avatarId=46009",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=crystrix&avatarId=46009",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=crystrix&avatarId=46009"
            },
            "displayName": "Chenxi Li",
            "active": true,
            "timeZone": "Asia/Shanghai"
        },
        "aggregateprogress": {
            "progress": 4200,
            "total": 4200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 4200,
            "total": 4200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12942/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 7,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/605883",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Crystrix opened a new pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443\n\n\n   If there are new groups in the subsequent chunks of a chunked array, the result of Arrow compute hash_min_max is incorrect.\r\n   For example, a table with two chunks, the second chunk has a new group key\r\n   ```\r\n   First chunk: {\"argument\": 1, \"key\": 0},\r\n   Second chunk: {\"argument\": 0,  \"key\": 1}\r\n   ```\r\n   the result of hash_min_max by \"key\" with such data is\r\n   ```\r\n   [{\"min\": null, \"max\": null}, 0],\r\n   [{\"min\": 0, \"max\": 0}, 1]\r\n   ```\r\n   But it should be\r\n   ```\r\n   [{\"min\": 1, \"max\": 1}, 0],\r\n   [{\"min\": 0, \"max\": 0}, 1]\r\n   ```\r\n   \r\n   The root cause is that `has_values_` and `has_nulls_` are `BufferBuilder` which has no `_size` and `capacity_` property.  So `MakeResizeImpl` function init a `TypedBufferBuilder` with the `BufferBuilder` with `_size` and  `capacity_` of 0. After the first chunk is processed, in the consumption of the second chunk,  `MakeResizeImpl` is called to reserve enough space for the next chunk. Then as the `_size` and  `capacity_` are zero, the original `BufferBuilder` is overwritten by `Reserve`, and outputs an incorrect result.\r\n   \r\n   This MR separates `has_values_` and `has_nulls_` with a `TypedBufferBuilder<bool>` which can keep the `_size` and `capacity_` property. Then in the consumption of the second chunk, the space of `has_values_` and `has_nulls_` is reserved after the data of the first chunk.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-03T12:16:55.395+0000",
                    "updated": "2021-06-03T12:16:55.395+0000",
                    "started": "2021-06-03T12:16:55.395+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605883",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/605884",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443#issuecomment-853824476\n\n\n   https://issues.apache.org/jira/browse/ARROW-12942\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-03T12:17:31.810+0000",
                    "updated": "2021-06-03T12:17:31.810+0000",
                    "started": "2021-06-03T12:17:31.810+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "605884",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/606593",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443#issuecomment-853824476\n\n\n   https://issues.apache.org/jira/browse/ARROW-12942\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-04T08:02:07.155+0000",
                    "updated": "2021-06-04T08:02:07.155+0000",
                    "started": "2021-06-04T08:02:07.154+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "606593",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/606788",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Crystrix opened a new pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443\n\n\n   If there are new groups in the subsequent chunks of a chunked array, the result of Arrow compute hash_min_max is incorrect.\r\n   For example, a table with two chunks, the second chunk has a new group key\r\n   ```\r\n   First chunk: {\"argument\": 1, \"key\": 0},\r\n   Second chunk: {\"argument\": 0,  \"key\": 1}\r\n   ```\r\n   the result of hash_min_max by \"key\" with such data is\r\n   ```\r\n   [{\"min\": null, \"max\": null}, 0],\r\n   [{\"min\": 0, \"max\": 0}, 1]\r\n   ```\r\n   But it should be\r\n   ```\r\n   [{\"min\": 1, \"max\": 1}, 0],\r\n   [{\"min\": 0, \"max\": 0}, 1]\r\n   ```\r\n   \r\n   The root cause is that `has_values_` and `has_nulls_` are `BufferBuilder` which has no `_size` and `capacity_` property.  So `MakeResizeImpl` function init a `TypedBufferBuilder` with the `BufferBuilder` with `_size` and  `capacity_` of 0. After the first chunk is processed, in the consumption of the second chunk,  `MakeResizeImpl` is called to reserve enough space for the next chunk. Then as the `_size` and  `capacity_` are zero, the original `BufferBuilder` is overwritten by `Reserve`, and outputs an incorrect result.\r\n   \r\n   This MR separates `has_values_` and `has_nulls_` with a `TypedBufferBuilder<bool>` which can keep the `_size` and `capacity_` property. Then in the consumption of the second chunk, the space of `has_values_` and `has_nulls_` is reserved after the data of the first chunk.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-04T08:24:06.222+0000",
                    "updated": "2021-06-04T08:24:06.222+0000",
                    "started": "2021-06-04T08:24:06.222+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "606788",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/608017",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on a change in pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443#discussion_r646816751\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1000,16 +1010,16 @@ struct GroupedMinMaxImpl : public GroupedAggregator {\n \n     mins_ = BufferBuilder(ctx->memory_pool());\n     maxes_ = BufferBuilder(ctx->memory_pool());\n-    has_values_ = BufferBuilder(ctx->memory_pool());\n-    has_nulls_ = BufferBuilder(ctx->memory_pool());\n+    has_values_ = TypedBufferBuilder<bool>(ctx->memory_pool());\n+    has_nulls_ = TypedBufferBuilder<bool>(ctx->memory_pool());\n \n     GetImpl get_impl;\n     RETURN_NOT_OK(VisitTypeInline(*input_type, &get_impl));\n \n     consume_impl_ = std::move(get_impl.consume_impl);\n     resize_min_impl_ = std::move(get_impl.resize_min_impl);\n     resize_max_impl_ = std::move(get_impl.resize_max_impl);\n-    resize_bitmap_impl_ = MakeResizeImpl(false);\n+    resize_bitmap_impl_ = MakeResizeImplForBitmap(false);\n\nReview comment:\n       I think it's unnecessary to have a separate `std::function` for resizing the bitmaps, let's just linline the calls to TypedBufferBuilder::Append inside the MaybeReserve call\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-07T17:51:36.258+0000",
                    "updated": "2021-06-07T17:51:36.258+0000",
                    "started": "2021-06-07T17:51:36.258+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "608017",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/608276",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Crystrix commented on a change in pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443#discussion_r647126649\n\n\n\n##########\nFile path: cpp/src/arrow/compute/kernels/hash_aggregate.cc\n##########\n@@ -1000,16 +1010,16 @@ struct GroupedMinMaxImpl : public GroupedAggregator {\n \n     mins_ = BufferBuilder(ctx->memory_pool());\n     maxes_ = BufferBuilder(ctx->memory_pool());\n-    has_values_ = BufferBuilder(ctx->memory_pool());\n-    has_nulls_ = BufferBuilder(ctx->memory_pool());\n+    has_values_ = TypedBufferBuilder<bool>(ctx->memory_pool());\n+    has_nulls_ = TypedBufferBuilder<bool>(ctx->memory_pool());\n \n     GetImpl get_impl;\n     RETURN_NOT_OK(VisitTypeInline(*input_type, &get_impl));\n \n     consume_impl_ = std::move(get_impl.consume_impl);\n     resize_min_impl_ = std::move(get_impl.resize_min_impl);\n     resize_max_impl_ = std::move(get_impl.resize_max_impl);\n-    resize_bitmap_impl_ = MakeResizeImpl(false);\n+    resize_bitmap_impl_ = MakeResizeImplForBitmap(false);\n\nReview comment:\n       Sure, now `resize_bitmap_impl_` is replaced with `Append` in `MaybeReserve`\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-08T05:42:59.464+0000",
                    "updated": "2021-06-08T05:42:59.464+0000",
                    "started": "2021-06-08T05:42:59.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "608276",
                    "issueId": "13381886"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/worklog/608557",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz closed pull request #10443:\nURL: https://github.com/apache/arrow/pull/10443\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-06-08T16:03:16.366+0000",
                    "updated": "2021-06-08T16:03:16.366+0000",
                    "started": "2021-06-08T16:03:16.366+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "608557",
                    "issueId": "13381886"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 4200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2af58e29[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6b52b359[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3a10230b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@44a6876b[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5ad29d39[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@75dc71d3[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4eef0c18[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@3e824771[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@70773ecd[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@66b38bf9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@500ad4fb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@7c1fb844[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 4200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jun 08 16:03:14 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-06-08T16:03:14.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-12942/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-06-03T11:02:14.000+0000",
        "updated": "2021-06-08T16:03:17.000+0000",
        "timeoriginalestimate": null,
        "description": "If there are new groups in the subsequent chunks of a chunked array, the result of Arrow compute hash_min_max is incorrect.\r\nFor example, a table with two chunks, the second chunk has a new group key\r\n{code:java}\r\nFirst chunk: {\"argument\": 1, \"key\": 0},\r\nSecond chunk: {\"argument\": 0,  \"key\": 1}\r\n{code}\r\nthe result of hash_min_max by \"key\" with such data is\r\n{code:java}\r\n[{\"min\": null, \"max\": null}, 0],\r\n[{\"min\": 0, \"max\": 0}, 1]\r\n{code}\r\nBut it should be \r\n{code:java}\r\n[{\"min\": 1, \"max\": 1}, 0],\r\n[{\"min\": 0, \"max\": 0}, 1]\r\n{code}",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 4200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Compute] The result of Arrow compute hash_min_max is incorrect if there are new groups in the subsequent chunks",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13381886/comment/17359438",
                    "id": "17359438",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 10443\n[https://github.com/apache/arrow/pull/10443]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-06-08T16:03:14.697+0000",
                    "updated": "2021-06-08T16:03:14.697+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0rmbs:",
        "customfield_12314139": null
    }
}