{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13353584",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584",
    "key": "ARROW-11330",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
            "name": "alamb",
            "key": "alamb",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
            },
            "displayName": "Andrew Lamb",
            "active": true,
            "timeZone": "America/New_York"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
            "name": "alamb",
            "key": "alamb",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
            },
            "displayName": "Andrew Lamb",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
            "name": "alamb",
            "key": "alamb",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
            },
            "displayName": "Andrew Lamb",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 8400,
            "total": 8400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11330/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 14,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538611",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb opened a new pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278\n\n\n   ## Problem:\r\n   * There are several places in the DataFusion codebase where a walk of an Expression tree is needed\r\n   * The logic of how to walk the tree is replicated\r\n   * Adding new expression types often require many mechanically different but semantically the same changes in many places where no special treatment of such types is needed\r\n   \r\n   This PR introduces a `ExpressionVisitor` trait and the `Expr::accept` function to consolidate this walking of the expression tree. It does not intend to change any functionality. \r\n   \r\n   If folks like this pattern, I have ideas for a similar type of trait `ExpressionRewriter` which can be used to rewrite expressions (much like `clone_with_replacement`) as a subsquent PR. I think this was mentioned by @Dandandan  in the [Rust roadmap](https://docs.google.com/document/d/1qspsOM_dknOxJKdGvKbC1aoVoO0M3i6x1CIo58mmN2Y/edit#heading=h.kstb571j5g5j)\r\n   \r\n   \r\n   cc @jorgecarleitao @Dandandan and @andygrove \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T18:51:11.382+0000",
                    "updated": "2021-01-20T18:51:11.382+0000",
                    "started": "2021-01-20T18:51:11.382+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538611",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538613",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#discussion_r561197743\n\n\n\n##########\nFile path: rust/datafusion/src/optimizer/utils.rs\n##########\n@@ -46,75 +50,48 @@ pub fn exprlist_to_column_names(\n \n /// Recursively walk an expression tree, collecting the unique set of column names\n /// referenced in the expression\n-pub fn expr_to_column_names(expr: &Expr, accum: &mut HashSet<String>) -> Result<()> {\n\nReview comment:\n       This is a pretty good example of the kind of repetition that can be removed using this visitor pattern.\r\n   Note that I still left all expr types enumerated so that anyone who adds a new Expr type need to update this code, and (hopefully) think if they need to add special handling for that new expr types\r\n   \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T18:52:43.782+0000",
                    "updated": "2021-01-20T18:52:43.782+0000",
                    "started": "2021-01-20T18:52:43.781+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538613",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538620",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-763867008\n\n\n   https://issues.apache.org/jira/browse/ARROW-11330\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T19:06:45.718+0000",
                    "updated": "2021-01-20T19:06:45.718+0000",
                    "started": "2021-01-20T19:06:45.718+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538620",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538645",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-763885202\n\n\n   I took a quick look and this looks good to me. I will try and review in more detail tonight.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T19:38:48.043+0000",
                    "updated": "2021-01-20T19:38:48.043+0000",
                    "started": "2021-01-20T19:38:48.042+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538645",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538657",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#discussion_r561229060\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n\nReview comment:\n       ```suggestion\r\n       /// Performs a depth first walk of an expression and\r\n   ```\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n+    /// its children, calling `visitor.pre_visit` and\n\nReview comment:\n       ```suggestion\r\n       /// its children, calling [`ExpressionVisitor::pre_visit`] and\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T19:49:01.845+0000",
                    "updated": "2021-01-20T19:49:01.845+0000",
                    "started": "2021-01-20T19:49:01.845+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538657",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538674",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-763902393\n\n\n   I just wanted to add that there is no need to wait for me to review before merging.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T20:10:28.847+0000",
                    "updated": "2021-01-20T20:10:28.847+0000",
                    "started": "2021-01-20T20:10:28.847+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538674",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538753",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-764011355\n\n\n   Thanks @jorgecarleitao  and @Dandandan . I am personally quite excited at using this same idea for expression rewriting. \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T23:05:11.460+0000",
                    "updated": "2021-01-20T23:05:11.460+0000",
                    "started": "2021-01-20T23:05:11.459+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538753",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/538754",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#discussion_r561366255\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n+    /// its children, calling `visitor.pre_visit` and\n+    /// `visitor.post_visit`.\n+    ///\n+    /// Implements the [visitor pattern](https://en.wikipedia.org/wiki/Visitor_pattern) to\n+    /// separate expression algorithms from the structure of the\n+    /// `Expr` tree and make it easier to add new types of expressions\n+    /// and algorithms that walk the tree.\n+    ///\n+    /// For an expression tree such as\n+    /// BinaryExpr (GT)\n+    ///    left: Column(\"foo\")\n+    ///    right: Column(\"bar\")\n+    ///\n+    /// The nodes are visited using the following order\n+    /// ```text\n+    /// pre_visit(BinaryExpr(GT))\n+    /// pre_visit(Column(\"foo\"))\n+    /// pre_visit(Column(\"bar\"))\n+    /// post_visit(Column(\"bar\"))\n+    /// post_visit(Column(\"bar\"))\n+    /// post_visit(BinaryExpr(GT))\n+    /// ```\n+    ///\n+    /// If an Err result is returned, recursion is stopped immediately\n+    ///\n+    /// If `Recursion::Stop` is returned on a call to pre_visit, no\n+    /// children of that expression are visited, nor is post_visit\n+    /// called on that expression\n+    ///\n+    pub fn accept<V: ExpressionVisitor>(&self, visitor: V) -> Result<V> {\n+        let visitor = match visitor.pre_visit(self)? {\n+            Recursion::Continue(visitor) => visitor,\n+            // If the recursion should stop, do not visit children\n+            Recursion::Stop(visitor) => return Ok(visitor),\n+        };\n+\n+        // recurse (and cover all expression types)\n+        let visitor = match self {\n+            Expr::Alias(expr, _) => expr.accept(visitor),\n+            Expr::Column(..) => Ok(visitor),\n+            Expr::ScalarVariable(..) => Ok(visitor),\n+            Expr::Literal(..) => Ok(visitor),\n+            Expr::BinaryExpr { left, right, .. } => {\n+                let visitor = left.accept(visitor)?;\n+                right.accept(visitor)\n+            }\n+            Expr::Not(expr) => expr.accept(visitor),\n+            Expr::IsNotNull(expr) => expr.accept(visitor),\n+            Expr::IsNull(expr) => expr.accept(visitor),\n+            Expr::Negative(expr) => expr.accept(visitor),\n+            Expr::Between {\n+                expr, low, high, ..\n+            } => {\n+                let visitor = expr.accept(visitor)?;\n+                let visitor = low.accept(visitor)?;\n+                high.accept(visitor)\n+            }\n+            Expr::Case {\n+                expr,\n+                when_then_expr,\n+                else_expr,\n+            } => {\n+                let visitor = if let Some(expr) = expr.as_ref() {\n+                    expr.accept(visitor)\n+                } else {\n+                    Ok(visitor)\n+                }?;\n+                let visitor = when_then_expr.iter().try_fold(\n+                    visitor,\n+                    |visitor, (when, then)| {\n+                        let visitor = when.accept(visitor)?;\n+                        then.accept(visitor)\n+                    },\n+                )?;\n+                if let Some(else_expr) = else_expr.as_ref() {\n+                    else_expr.accept(visitor)\n+                } else {\n+                    Ok(visitor)\n+                }\n+            }\n+            Expr::Cast { expr, .. } => expr.accept(visitor),\n+            Expr::Sort { expr, .. } => expr.accept(visitor),\n+            Expr::ScalarFunction { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::ScalarUDF { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::AggregateFunction { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::AggregateUDF { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::InList { expr, list, .. } => {\n+                let visitor = expr.accept(visitor)?;\n+                list.iter()\n+                    .try_fold(visitor, |visitor, arg| arg.accept(visitor))\n+            }\n+            Expr::Wildcard => Ok(visitor),\n+        }?;\n+\n+        visitor.post_visit(self)\n+    }\n+}\n+\n+/// Controls how the visitor recursion should proceed.\n+pub enum Recursion<V: ExpressionVisitor> {\n+    /// Attempt to visit all the children, recursively, of this expression.\n+    Continue(V),\n+    /// Do not visit the children of this expression, though the walk\n+    /// of parents of this expression will not be affected\n+    Stop(V),\n+}\n+\n+/// Encode the traversal of an expression tree. When passed to\n+/// `visit_expression`, `ExpressionVisitor::visit` is invoked\n\nReview comment:\n       ```suggestion\r\n   /// `Expr::accept`, `ExpressionVisitor::visit` is invoked\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-20T23:06:14.446+0000",
                    "updated": "2021-01-20T23:06:14.446+0000",
                    "started": "2021-01-20T23:06:14.446+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "538754",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539014",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb closed pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-21T12:20:47.633+0000",
                    "updated": "2021-01-21T12:20:47.633+0000",
                    "started": "2021-01-21T12:20:47.633+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539014",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539531",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-763902393\n\n\n   I just wanted to add that there is no need to wait for me to review before merging.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T05:38:24.929+0000",
                    "updated": "2021-01-22T05:38:24.929+0000",
                    "started": "2021-01-22T05:38:24.929+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539531",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539873",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb closed pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:29:38.970+0000",
                    "updated": "2021-01-22T06:29:38.970+0000",
                    "started": "2021-01-22T06:29:38.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539873",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539895",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on a change in pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#discussion_r561229060\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n\nReview comment:\n       ```suggestion\r\n       /// Performs a depth first walk of an expression and\r\n   ```\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n+    /// its children, calling `visitor.pre_visit` and\n\nReview comment:\n       ```suggestion\r\n       /// its children, calling [`ExpressionVisitor::pre_visit`] and\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:33:06.416+0000",
                    "updated": "2021-01-22T06:33:06.416+0000",
                    "started": "2021-01-22T06:33:06.415+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539895",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539938",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#issuecomment-764011355\n\n\n   Thanks @jorgecarleitao  and @Dandandan . I am personally quite excited at using this same idea for expression rewriting. \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:38:19.610+0000",
                    "updated": "2021-01-22T06:38:19.610+0000",
                    "started": "2021-01-22T06:38:19.610+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539938",
                    "issueId": "13353584"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/worklog/539974",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9278:\nURL: https://github.com/apache/arrow/pull/9278#discussion_r561366255\n\n\n\n##########\nFile path: rust/datafusion/src/logical_plan/expr.rs\n##########\n@@ -422,6 +422,136 @@ impl Expr {\n             nulls_first,\n         }\n     }\n+\n+    /// Performs a depth first depth first walk of an expression and\n+    /// its children, calling `visitor.pre_visit` and\n+    /// `visitor.post_visit`.\n+    ///\n+    /// Implements the [visitor pattern](https://en.wikipedia.org/wiki/Visitor_pattern) to\n+    /// separate expression algorithms from the structure of the\n+    /// `Expr` tree and make it easier to add new types of expressions\n+    /// and algorithms that walk the tree.\n+    ///\n+    /// For an expression tree such as\n+    /// BinaryExpr (GT)\n+    ///    left: Column(\"foo\")\n+    ///    right: Column(\"bar\")\n+    ///\n+    /// The nodes are visited using the following order\n+    /// ```text\n+    /// pre_visit(BinaryExpr(GT))\n+    /// pre_visit(Column(\"foo\"))\n+    /// pre_visit(Column(\"bar\"))\n+    /// post_visit(Column(\"bar\"))\n+    /// post_visit(Column(\"bar\"))\n+    /// post_visit(BinaryExpr(GT))\n+    /// ```\n+    ///\n+    /// If an Err result is returned, recursion is stopped immediately\n+    ///\n+    /// If `Recursion::Stop` is returned on a call to pre_visit, no\n+    /// children of that expression are visited, nor is post_visit\n+    /// called on that expression\n+    ///\n+    pub fn accept<V: ExpressionVisitor>(&self, visitor: V) -> Result<V> {\n+        let visitor = match visitor.pre_visit(self)? {\n+            Recursion::Continue(visitor) => visitor,\n+            // If the recursion should stop, do not visit children\n+            Recursion::Stop(visitor) => return Ok(visitor),\n+        };\n+\n+        // recurse (and cover all expression types)\n+        let visitor = match self {\n+            Expr::Alias(expr, _) => expr.accept(visitor),\n+            Expr::Column(..) => Ok(visitor),\n+            Expr::ScalarVariable(..) => Ok(visitor),\n+            Expr::Literal(..) => Ok(visitor),\n+            Expr::BinaryExpr { left, right, .. } => {\n+                let visitor = left.accept(visitor)?;\n+                right.accept(visitor)\n+            }\n+            Expr::Not(expr) => expr.accept(visitor),\n+            Expr::IsNotNull(expr) => expr.accept(visitor),\n+            Expr::IsNull(expr) => expr.accept(visitor),\n+            Expr::Negative(expr) => expr.accept(visitor),\n+            Expr::Between {\n+                expr, low, high, ..\n+            } => {\n+                let visitor = expr.accept(visitor)?;\n+                let visitor = low.accept(visitor)?;\n+                high.accept(visitor)\n+            }\n+            Expr::Case {\n+                expr,\n+                when_then_expr,\n+                else_expr,\n+            } => {\n+                let visitor = if let Some(expr) = expr.as_ref() {\n+                    expr.accept(visitor)\n+                } else {\n+                    Ok(visitor)\n+                }?;\n+                let visitor = when_then_expr.iter().try_fold(\n+                    visitor,\n+                    |visitor, (when, then)| {\n+                        let visitor = when.accept(visitor)?;\n+                        then.accept(visitor)\n+                    },\n+                )?;\n+                if let Some(else_expr) = else_expr.as_ref() {\n+                    else_expr.accept(visitor)\n+                } else {\n+                    Ok(visitor)\n+                }\n+            }\n+            Expr::Cast { expr, .. } => expr.accept(visitor),\n+            Expr::Sort { expr, .. } => expr.accept(visitor),\n+            Expr::ScalarFunction { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::ScalarUDF { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::AggregateFunction { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::AggregateUDF { args, .. } => args\n+                .iter()\n+                .try_fold(visitor, |visitor, arg| arg.accept(visitor)),\n+            Expr::InList { expr, list, .. } => {\n+                let visitor = expr.accept(visitor)?;\n+                list.iter()\n+                    .try_fold(visitor, |visitor, arg| arg.accept(visitor))\n+            }\n+            Expr::Wildcard => Ok(visitor),\n+        }?;\n+\n+        visitor.post_visit(self)\n+    }\n+}\n+\n+/// Controls how the visitor recursion should proceed.\n+pub enum Recursion<V: ExpressionVisitor> {\n+    /// Attempt to visit all the children, recursively, of this expression.\n+    Continue(V),\n+    /// Do not visit the children of this expression, though the walk\n+    /// of parents of this expression will not be affected\n+    Stop(V),\n+}\n+\n+/// Encode the traversal of an expression tree. When passed to\n+/// `visit_expression`, `ExpressionVisitor::visit` is invoked\n\nReview comment:\n       ```suggestion\r\n   /// `Expr::accept`, `ExpressionVisitor::visit` is invoked\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-01-22T06:42:29.989+0000",
                    "updated": "2021-01-22T06:42:29.989+0000",
                    "started": "2021-01-22T06:42:29.989+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "539974",
                    "issueId": "13353584"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 8400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@16e745ea[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@64d568c3[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@70fd7b6f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3fa186c3[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@683dccff[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@795d854e[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6260bf09[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@51c4aa18[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5718deeb[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@427a56b3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@25053102[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5165dbd0[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 8400,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jan 21 12:20:51 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-01-21T12:20:51.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11330/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-01-20T18:41:30.000+0000",
        "updated": "2021-01-22T06:42:31.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 8400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust][DataFusion] Add ExpressionVisitor pattern",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13353584/comment/17269259",
                    "id": "17269259",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9278\n[https://github.com/apache/arrow/pull/9278]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-01-21T12:20:51.831+0000",
                    "updated": "2021-01-21T12:20:51.831+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0mtc8:",
        "customfield_12314139": null
    }
}