{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13222452",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452",
    "key": "ARROW-4957",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12345977",
                "id": "12345977",
                "description": "",
                "name": "2.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-10-19"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "beginner",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12347769",
                "id": "12347769",
                "description": "",
                "name": "1.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-07-24"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [
            {
                "id": "12598188",
                "self": "https://issues.apache.org/jira/rest/api/2/issueLink/12598188",
                "type": {
                    "id": "12310000",
                    "name": "Duplicate",
                    "inward": "is duplicated by",
                    "outward": "duplicates",
                    "self": "https://issues.apache.org/jira/rest/api/2/issueLinkType/12310000"
                },
                "inwardIssue": {
                    "id": "13323668",
                    "key": "ARROW-9809",
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13323668",
                    "fields": {
                        "summary": "[Rust] [DataFusion] logical schema = physical schema is not true",
                        "status": {
                            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
                            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
                            "name": "Resolved",
                            "id": "5",
                            "statusCategory": {
                                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                                "id": 3,
                                "key": "done",
                                "colorName": "green",
                                "name": "Done"
                            }
                        },
                        "priority": {
                            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                            "name": "Major",
                            "id": "3"
                        },
                        "issuetype": {
                            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
                            "id": "1",
                            "description": "A problem which impairs or prevents the functions of the product.",
                            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
                            "name": "Bug",
                            "subtask": false,
                            "avatarId": 21133
                        }
                    }
                }
            }
        ],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
            "name": "andygrove",
            "key": "andygrove",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
            },
            "displayName": "Andy Grove",
            "active": true,
            "timeZone": "America/Denver"
        },
        "aggregateprogress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4957/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/217621",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019\n \n \n   This PR re-implements get_supertype to be easier to read and maintain\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-23T17:31:17.819+0000",
                    "updated": "2019-03-23T17:31:17.819+0000",
                    "started": "2019-03-23T17:31:17.818+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "217621",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/217622",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on issue #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#issuecomment-475889281\n \n \n   @kszucs Please take a look when you can\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-23T17:33:17.897+0000",
                    "updated": "2019-03-23T17:33:17.897+0000",
                    "started": "2019-03-23T17:33:17.896+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "217622",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/218093",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on issue #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#issuecomment-476248772\n \n \n   @paddyhoran @sunchao Some code cleanup that would be good to get into 0.13\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-25T15:29:35.773+0000",
                    "updated": "2019-03-25T15:29:35.773+0000",
                    "started": "2019-03-25T15:29:35.772+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "218093",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/219846",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sunchao commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#discussion_r269874974\n \n \n\n ##########\n File path: rust/datafusion/src/optimizer/utils.rs\n ##########\n @@ -98,117 +98,117 @@ pub fn exprlist_to_fields(expr: &Vec<Expr>, input_schema: &Schema) -> Result<Vec\n \n /// Given two datatypes, determine the supertype that both types can safely be cast to\n pub fn get_supertype(l: &DataType, r: &DataType) -> Result<DataType> {\n-    match _get_supertype(l, r) {\n-        Some(dt) => Ok(dt),\n-        None => match _get_supertype(r, l) {\n-            Some(dt) => Ok(dt),\n-            None => Err(ExecutionError::InternalError(format!(\n-                \"Failed to determine supertype of {:?} and {:?}\",\n-                l, r\n-            ))),\n-        },\n+    use arrow::datatypes::DataType::*;\n+    let d = if l == r {\n \n Review comment:\n   In the old implementation the super type of `UInt16` and `Int8` is `None` but now it is `Int16`. Why is that? Also do you know how C++ handles this case?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-28T06:57:25.019+0000",
                    "updated": "2019-03-28T06:57:25.019+0000",
                    "started": "2019-03-28T06:57:25.018+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "219846",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/219847",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sunchao commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#discussion_r269875221\n \n \n\n ##########\n File path: rust/datafusion/src/optimizer/utils.rs\n ##########\n @@ -217,9 +217,133 @@ mod tests {\n     use super::*;\n     use crate::logicalplan::Expr;\n     use arrow::datatypes::DataType;\n+    use arrow::datatypes::DataType::*;\n     use std::collections::HashSet;\n     use std::sync::Arc;\n \n+    #[test]\n+    fn test_supertype_numeric_types() {\n+        let types = vec![\n+            UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64, Float32, Float64,\n+        ];\n+        let mut result = String::new();\n+        for l in &types {\n+            for r in &types {\n+                result.push_str(&format!(\n+                    \"supertype of {:?} and {:?} is {:?}\n+\\n\",\n+                    l,\n+                    r,\n+                    get_supertype(l, r).unwrap()\n+                ));\n+            }\n+        }\n+        assert_eq!(\n \n Review comment:\n   Can we avoid comparing with string? whenever there's an error it is very hard to find out since you are comparing two huge strings.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-28T06:57:25.021+0000",
                    "updated": "2019-03-28T06:57:25.021+0000",
                    "started": "2019-03-28T06:57:25.021+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "219847",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/227870",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#discussion_r275487385\n \n \n\n ##########\n File path: rust/datafusion/src/optimizer/utils.rs\n ##########\n @@ -98,117 +98,117 @@ pub fn exprlist_to_fields(expr: &Vec<Expr>, input_schema: &Schema) -> Result<Vec\n \n /// Given two datatypes, determine the supertype that both types can safely be cast to\n pub fn get_supertype(l: &DataType, r: &DataType) -> Result<DataType> {\n-    match _get_supertype(l, r) {\n-        Some(dt) => Ok(dt),\n-        None => match _get_supertype(r, l) {\n-            Some(dt) => Ok(dt),\n-            None => Err(ExecutionError::InternalError(format!(\n-                \"Failed to determine supertype of {:?} and {:?}\",\n-                l, r\n-            ))),\n-        },\n+    use arrow::datatypes::DataType::*;\n+    let d = if l == r {\n \n Review comment:\n   It is not statically compatible in C++ (safely). https://github.com/apache/arrow/blob/master/cpp/src/arrow/compute/kernels/cast.cc#L156-L208\r\n   \r\n   It can be safe to cast, but it needs a runtime check.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-04-15T18:30:50.523+0000",
                    "updated": "2019-04-15T18:30:50.523+0000",
                    "started": "2019-04-15T18:30:50.522+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "227870",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/227871",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#discussion_r275490011\n \n \n\n ##########\n File path: rust/datafusion/src/optimizer/utils.rs\n ##########\n @@ -98,117 +98,117 @@ pub fn exprlist_to_fields(expr: &Vec<Expr>, input_schema: &Schema) -> Result<Vec\n \n /// Given two datatypes, determine the supertype that both types can safely be cast to\n pub fn get_supertype(l: &DataType, r: &DataType) -> Result<DataType> {\n-    match _get_supertype(l, r) {\n-        Some(dt) => Ok(dt),\n-        None => match _get_supertype(r, l) {\n-            Some(dt) => Ok(dt),\n-            None => Err(ExecutionError::InternalError(format!(\n-                \"Failed to determine supertype of {:?} and {:?}\",\n-                l, r\n-            ))),\n-        },\n+    use arrow::datatypes::DataType::*;\n+    let d = if l == r {\n+        Some(l.clone())\n+    } else if l == &Utf8 || r == &Utf8 {\n+        Some(Utf8)\n+    } else if is_signed_int(l) {\n \n Review comment:\n   This block is hard to follow, I'd rewrite this with small functions.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-04-15T18:30:50.560+0000",
                    "updated": "2019-04-15T18:30:50.560+0000",
                    "started": "2019-04-15T18:30:50.559+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "227871",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/247409",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#issuecomment-495223946\n \n \n   Can this PR be merged?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-05-23T13:43:22.838+0000",
                    "updated": "2019-05-23T13:43:22.838+0000",
                    "started": "2019-05-23T13:43:22.837+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "247409",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/247835",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sunchao commented on issue #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#issuecomment-495448759\n \n \n   I think there are a few pending comments to be resolved. @andygrove can you take a look?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-05-24T02:20:21.345+0000",
                    "updated": "2019-05-24T02:20:21.345+0000",
                    "started": "2019-05-24T02:20:21.345+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "247835",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/248430",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on issue #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019#issuecomment-495930317\n \n \n   Sorry, I haven't had any spare time for a while due to work commitments. I am closing this and will try again another time.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-05-25T16:18:57.876+0000",
                    "updated": "2019-05-25T16:18:57.876+0000",
                    "started": "2019-05-25T16:18:57.876+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "248430",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/248431",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #4019: ARROW-4957: [Rust] [DataFusion] Re-implement get_supertype \nURL: https://github.com/apache/arrow/pull/4019\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-05-25T16:18:58.020+0000",
                    "updated": "2019-05-25T16:18:58.020+0000",
                    "started": "2019-05-25T16:18:58.019+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "248431",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436760",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove opened a new pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253\n\n\n   Re-implement get_supertype so that it is complete and easier to comprehend.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T13:26:15.182+0000",
                    "updated": "2020-05-23T13:26:15.182+0000",
                    "started": "2020-05-23T13:26:15.182+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436760",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436761",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#issuecomment-633054362\n\n\n   https://issues.apache.org/jira/browse/ARROW-4957\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T13:31:55.797+0000",
                    "updated": "2020-05-23T13:31:55.797+0000",
                    "started": "2020-05-23T13:31:55.797+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436761",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436791",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#discussion_r429568842\n\n\n\n##########\nFile path: rust/datafusion/src/logicalplan.rs\n##########\n@@ -725,36 +725,47 @@ impl fmt::Debug for LogicalPlan {\n /// Verify a given type cast can be performed\n pub fn can_coerce_from(type_into: &DataType, type_from: &DataType) -> bool {\n     use self::DataType::*;\n+\n+    if type_from == type_into {\n+        return true;\n+    }\n+\n     match type_into {\n         Int8 => match type_from {\n             Int8 => true,\n             _ => false,\n         },\n         Int16 => match type_from {\n-            Int8 | Int16 | UInt8 => true,\n+            Int8 | Int16 => true,\n+            UInt8 => true,\n             _ => false,\n         },\n         Int32 => match type_from {\n-            Int8 | Int16 | Int32 | UInt8 | UInt16 => true,\n+            Int8 | Int16 | Int32 => true,\n+            UInt8 | UInt16 => true,\n             _ => false,\n         },\n         Int64 => match type_from {\n-            Int8 | Int16 | Int32 | Int64 | UInt8 | UInt16 | UInt32 => true,\n+            Int8 | Int16 | Int32 | Int64 => true,\n+            UInt8 | UInt16 | UInt32 => true,\n             _ => false,\n         },\n         UInt8 => match type_from {\n             UInt8 => true,\n             _ => false,\n         },\n         UInt16 => match type_from {\n+            Int8 => true,\n\nReview comment:\n       for my own curiosity, what's the expected behavior when a negative int8 is coerced into uint16?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T18:42:17.780+0000",
                    "updated": "2020-05-23T18:42:17.780+0000",
                    "started": "2020-05-23T18:42:17.780+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436791",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436796",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#discussion_r429569531\n\n\n\n##########\nFile path: rust/datafusion/src/optimizer/utils.rs\n##########\n@@ -131,116 +131,90 @@ pub fn exprlist_to_fields(expr: &[Expr], input_schema: &Schema) -> Result<Vec<Fi\n \n /// Given two datatypes, determine the supertype that both types can safely be cast to\n pub fn get_supertype(l: &DataType, r: &DataType) -> Result<DataType> {\n-    match _get_supertype(l, r) {\n-        Some(dt) => Ok(dt),\n-        None => _get_supertype(r, l).ok_or_else(|| {\n-            ExecutionError::InternalError(format!(\n-                \"Failed to determine supertype of {:?} and {:?}\",\n-                l, r\n-            ))\n-        }),\n-    }\n-}\n-\n-/// Given two datatypes, determine the supertype that both types can safely be cast to\n-fn _get_supertype(l: &DataType, r: &DataType) -> Option<DataType> {\n     use arrow::datatypes::DataType::*;\n-    match (l, r) {\n-        (UInt8, Int8) => Some(Int8),\n-        (UInt8, Int16) => Some(Int16),\n-        (UInt8, Int32) => Some(Int32),\n-        (UInt8, Int64) => Some(Int64),\n-\n-        (UInt16, Int16) => Some(Int16),\n-        (UInt16, Int32) => Some(Int32),\n-        (UInt16, Int64) => Some(Int64),\n-\n-        (UInt32, Int32) => Some(Int32),\n-        (UInt32, Int64) => Some(Int64),\n-\n-        (UInt64, Int64) => Some(Int64),\n-\n-        (Int8, UInt8) => Some(Int8),\n-\n-        (Int16, UInt8) => Some(Int16),\n-        (Int16, UInt16) => Some(Int16),\n-\n-        (Int32, UInt8) => Some(Int32),\n-        (Int32, UInt16) => Some(Int32),\n-        (Int32, UInt32) => Some(Int32),\n-\n-        (Int64, UInt8) => Some(Int64),\n-        (Int64, UInt16) => Some(Int64),\n-        (Int64, UInt32) => Some(Int64),\n-        (Int64, UInt64) => Some(Int64),\n-\n-        (UInt8, UInt8) => Some(UInt8),\n-        (UInt8, UInt16) => Some(UInt16),\n-        (UInt8, UInt32) => Some(UInt32),\n-        (UInt8, UInt64) => Some(UInt64),\n-        (UInt8, Float32) => Some(Float32),\n-        (UInt8, Float64) => Some(Float64),\n \n-        (UInt16, UInt8) => Some(UInt16),\n-        (UInt16, UInt16) => Some(UInt16),\n-        (UInt16, UInt32) => Some(UInt32),\n-        (UInt16, UInt64) => Some(UInt64),\n-        (UInt16, Float32) => Some(Float32),\n-        (UInt16, Float64) => Some(Float64),\n-\n-        (UInt32, UInt8) => Some(UInt32),\n-        (UInt32, UInt16) => Some(UInt32),\n-        (UInt32, UInt32) => Some(UInt32),\n-        (UInt32, UInt64) => Some(UInt64),\n-        (UInt32, Float32) => Some(Float32),\n-        (UInt32, Float64) => Some(Float64),\n-\n-        (UInt64, UInt8) => Some(UInt64),\n-        (UInt64, UInt16) => Some(UInt64),\n-        (UInt64, UInt32) => Some(UInt64),\n-        (UInt64, UInt64) => Some(UInt64),\n-        (UInt64, Float32) => Some(Float32),\n-        (UInt64, Float64) => Some(Float64),\n-\n-        (Int8, Int8) => Some(Int8),\n-        (Int8, Int16) => Some(Int16),\n-        (Int8, Int32) => Some(Int32),\n-        (Int8, Int64) => Some(Int64),\n-        (Int8, Float32) => Some(Float32),\n-        (Int8, Float64) => Some(Float64),\n-\n-        (Int16, Int8) => Some(Int16),\n-        (Int16, Int16) => Some(Int16),\n-        (Int16, Int32) => Some(Int32),\n-        (Int16, Int64) => Some(Int64),\n-        (Int16, Float32) => Some(Float32),\n-        (Int16, Float64) => Some(Float64),\n-\n-        (Int32, Int8) => Some(Int32),\n-        (Int32, Int16) => Some(Int32),\n-        (Int32, Int32) => Some(Int32),\n-        (Int32, Int64) => Some(Int64),\n-        (Int32, Float32) => Some(Float32),\n-        (Int32, Float64) => Some(Float64),\n-\n-        (Int64, Int8) => Some(Int64),\n-        (Int64, Int16) => Some(Int64),\n-        (Int64, Int32) => Some(Int64),\n-        (Int64, Int64) => Some(Int64),\n-        (Int64, Float32) => Some(Float32),\n-        (Int64, Float64) => Some(Float64),\n-\n-        (Float32, Float32) => Some(Float32),\n-        (Float32, Float64) => Some(Float64),\n-        (Float64, Float32) => Some(Float64),\n-        (Float64, Float64) => Some(Float64),\n-\n-        (Utf8, _) => Some(Utf8),\n-        (_, Utf8) => Some(Utf8),\n-\n-        (Boolean, Boolean) => Some(Boolean),\n+    if l == r {\n+        return Ok(l.clone());\n+    }\n \n+    let super_type = match l {\n+        UInt8 => match r {\n+            UInt16 | UInt32 | UInt64 => Some(r.clone()),\n+            Int16 | Int32 | Int64 => Some(r.clone()),\n+            Float32 | Float64 => Some(r.clone()),\n+            _ => None,\n+        },\n+        UInt16 => match r {\n+            UInt8 => Some(l.clone()),\n+            UInt32 | UInt64 => Some(r.clone()),\n+            Int8 => Some(l.clone()),\n+            Int32 | Int64 => Some(r.clone()),\n+            Float32 | Float64 => Some(r.clone()),\n+            _ => None,\n+        },\n+        UInt32 => match r {\n+            UInt8 | UInt16 => Some(l.clone()),\n+            UInt64 => Some(r.clone()),\n+            Int8 | Int16 => Some(l.clone()),\n+            Int64 => Some(r.clone()),\n+            Float32 | Float64 => Some(r.clone()),\n+            _ => None,\n+        },\n+        UInt64 => match r {\n+            UInt8 | UInt16 | UInt32 => Some(l.clone()),\n+            Int8 | Int16 | Int32 => Some(l.clone()),\n+            Float32 | Float64 => Some(r.clone()),\n+            _ => None,\n+        },\n+        Int8 => match r {\n\nReview comment:\n       should we support signed and unsigned with the same width as well? for example (int8, uint8) -> int16.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T18:53:45.003+0000",
                    "updated": "2020-05-23T18:53:45.003+0000",
                    "started": "2020-05-23T18:53:45.003+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436796",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436810",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on a change in pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#discussion_r429575153\n\n\n\n##########\nFile path: rust/datafusion/src/logicalplan.rs\n##########\n@@ -725,36 +725,47 @@ impl fmt::Debug for LogicalPlan {\n /// Verify a given type cast can be performed\n pub fn can_coerce_from(type_into: &DataType, type_from: &DataType) -> bool {\n     use self::DataType::*;\n+\n+    if type_from == type_into {\n+        return true;\n+    }\n+\n     match type_into {\n         Int8 => match type_from {\n             Int8 => true,\n             _ => false,\n         },\n         Int16 => match type_from {\n-            Int8 | Int16 | UInt8 => true,\n+            Int8 | Int16 => true,\n+            UInt8 => true,\n             _ => false,\n         },\n         Int32 => match type_from {\n-            Int8 | Int16 | Int32 | UInt8 | UInt16 => true,\n+            Int8 | Int16 | Int32 => true,\n+            UInt8 | UInt16 => true,\n             _ => false,\n         },\n         Int64 => match type_from {\n-            Int8 | Int16 | Int32 | Int64 | UInt8 | UInt16 | UInt32 => true,\n+            Int8 | Int16 | Int32 | Int64 => true,\n+            UInt8 | UInt16 | UInt32 => true,\n             _ => false,\n         },\n         UInt8 => match type_from {\n             UInt8 => true,\n             _ => false,\n         },\n         UInt16 => match type_from {\n+            Int8 => true,\n\nReview comment:\n       looking at the code, looks like it will return null for negative values. if that's the case, we should be able to support conversion from signed to unsigned with the same width as well right?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T20:17:43.377+0000",
                    "updated": "2020-05-23T20:17:43.377+0000",
                    "started": "2020-05-23T20:17:43.377+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436810",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436813",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on a change in pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#discussion_r429578850\n\n\n\n##########\nFile path: rust/datafusion/src/logicalplan.rs\n##########\n@@ -725,36 +725,47 @@ impl fmt::Debug for LogicalPlan {\n /// Verify a given type cast can be performed\n pub fn can_coerce_from(type_into: &DataType, type_from: &DataType) -> bool {\n     use self::DataType::*;\n+\n+    if type_from == type_into {\n+        return true;\n+    }\n+\n     match type_into {\n         Int8 => match type_from {\n             Int8 => true,\n             _ => false,\n         },\n         Int16 => match type_from {\n-            Int8 | Int16 | UInt8 => true,\n+            Int8 | Int16 => true,\n+            UInt8 => true,\n             _ => false,\n         },\n         Int32 => match type_from {\n-            Int8 | Int16 | Int32 | UInt8 | UInt16 => true,\n+            Int8 | Int16 | Int32 => true,\n+            UInt8 | UInt16 => true,\n             _ => false,\n         },\n         Int64 => match type_from {\n-            Int8 | Int16 | Int32 | Int64 | UInt8 | UInt16 | UInt32 => true,\n+            Int8 | Int16 | Int32 | Int64 => true,\n+            UInt8 | UInt16 | UInt32 => true,\n             _ => false,\n         },\n         UInt8 => match type_from {\n             UInt8 => true,\n             _ => false,\n         },\n         UInt16 => match type_from {\n+            Int8 => true,\n\nReview comment:\n       Thanks, this is actually a bug. The goal of this can_coalesce method is to determine if DataFusion can safely cast from one type to another without any data loss, so it can add implicit casts in queries. This is convenient when the user is comparing two expressions of different types.\r\n   \r\n   Separately from this, users can add any explicit CAST they want to in their query plan.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T21:14:41.463+0000",
                    "updated": "2020-05-23T21:14:41.463+0000",
                    "started": "2020-05-23T21:14:41.462+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436813",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436820",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#issuecomment-633144310\n\n\n   @houqp I pushed more changes. There will be more to do but for now, DataFusion will only add implicit casts when safe (so no more conversions between signed and unsigned int types).\r\n   \r\n   Also, for now, no unsafe casts are supported explicitly either. I will create a JIRA to add support for explicit casts between signed and unsigned types.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T21:43:41.021+0000",
                    "updated": "2020-05-23T21:43:41.021+0000",
                    "started": "2020-05-23T21:43:41.021+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436820",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436827",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "houqp commented on pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#issuecomment-633146402\n\n\n   Since integer to float conversion can also cause data loss, do we want to leave that to explicit cast path as well?\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-23T22:04:05.697+0000",
                    "updated": "2020-05-23T22:04:05.697+0000",
                    "started": "2020-05-23T22:04:05.696+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436827",
                    "issueId": "13222452"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/worklog/436905",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "andygrove commented on pull request #7253:\nURL: https://github.com/apache/arrow/pull/7253#issuecomment-633254544\n\n\n   I'm rethinking the approach here. I am fixing two things in this PR and it might be better to attempt to address them separately. The initial goal was to re-implement `get_supertype` for the implicit casting case. \r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-05-24T16:17:43.179+0000",
                    "updated": "2020-05-24T16:17:43.179+0000",
                    "started": "2020-05-24T16:17:43.179+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "436905",
                    "issueId": "13222452"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 13200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@3fc0ac72[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@33f5ea91[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@603df6e3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7c803917[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41e72078[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@38adb197[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@37a8d28f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4a9d0dec[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32811027[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@67f53ee9[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1638a432[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@34e82974[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13200,
        "customfield_12312520": null,
        "customfield_12312521": "Sun Aug 30 06:48:09 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-09-03T20:09:10.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4957/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2019-03-19T00:31:51.000+0000",
        "updated": "2020-09-03T20:09:10.000+0000",
        "timeoriginalestimate": null,
        "description": "The current implementation of\u00a0get_supertype (used in type coercion logic) is very hacky and should be re-implemented with better unit tests as well.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] [DataFusion] Implement get_supertype correctly",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/comment/17013738",
                    "id": "17013738",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "The pull request was closed because of inactivity, so I'm postponing it to 1.0",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2020-01-12T12:10:21.594+0000",
                    "updated": "2020-01-12T12:10:21.594+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/comment/17181297",
                    "id": "17181297",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "body": "I have unassigned myself from this issue since I have too many other issues I am working on and don't want to block progress on this",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=andygrove",
                        "name": "andygrove",
                        "key": "andygrove",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=andygrove&avatarId=28239",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=andygrove&avatarId=28239",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=andygrove&avatarId=28239",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=andygrove&avatarId=28239"
                        },
                        "displayName": "Andy Grove",
                        "active": true,
                        "timeZone": "America/Denver"
                    },
                    "created": "2020-08-20T15:56:43.123+0000",
                    "updated": "2020-08-20T15:56:43.123+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13222452/comment/17187145",
                    "id": "17187145",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I believe that this was fixed as part of ARROW-9809.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-08-30T06:48:09.242+0000",
                    "updated": "2020-08-30T06:48:09.242+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z00ua0:",
        "customfield_12314139": null
    }
}