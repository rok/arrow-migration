{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13360177",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177",
    "key": "ARROW-11733",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12335005",
                "id": "12335005",
                "name": "Rust - DataFusion"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=Dandandan",
            "name": "Dandandan",
            "key": "dandandan",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Dani\u00ebl Heres",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 6600,
            "total": 6600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11733/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 11,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/555991",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan opened a new pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-22T19:40:10.879+0000",
                    "updated": "2021-02-22T19:40:10.879+0000",
                    "started": "2021-02-22T19:40:10.878+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "555991",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556001",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#issuecomment-783644886\n\n\n   https://issues.apache.org/jira/browse/ARROW-11733\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-22T20:14:24.686+0000",
                    "updated": "2021-02-22T20:14:24.686+0000",
                    "started": "2021-02-22T20:14:24.686+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556001",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556221",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#issuecomment-783989976\n\n\n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=h1) Report\n   > Merging [#9548](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=desc) (bbba43f) into [master](https://codecov.io/gh/apache/arrow/commit/39b23b7c4e75c4c1a151e254c3d27d68f2d129bb?el=desc) (39b23b7) will **increase** coverage by `0.00%`.\n   > The diff coverage is `81.13%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/9548/graphs/tree.svg?width=650&height=150&src=pr&token=LpTCFbqVT1)](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=tree)\n   \n   ```diff\n   @@           Coverage Diff           @@\n   ##           master    #9548   +/-   ##\n   =======================================\n     Coverage   82.28%   82.29%           \n   =======================================\n     Files         244      244           \n     Lines       55616    55659   +43     \n   =======================================\n   + Hits        45766    45804   +38     \n   - Misses       9850     9855    +5     \n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [rust/datafusion/src/physical\\_plan/repartition.rs](https://codecov.io/gh/apache/arrow/pull/9548/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL3JlcGFydGl0aW9uLnJz) | `77.52% <80.76%> (+2.71%)` | :arrow_up: |\n   | [rust/datafusion/src/physical\\_plan/hash\\_join.rs](https://codecov.io/gh/apache/arrow/pull/9548/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL2hhc2hfam9pbi5ycw==) | `83.52% <100.00%> (\u00f8)` | |\n   | [rust/datafusion/src/physical\\_plan/mod.rs](https://codecov.io/gh/apache/arrow/pull/9548/diff?src=pr&el=tree#diff-cnVzdC9kYXRhZnVzaW9uL3NyYy9waHlzaWNhbF9wbGFuL21vZC5ycw==) | `88.00% <0.00%> (+2.00%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=footer). Last update [39b23b7...bbba43f](https://codecov.io/gh/apache/arrow/pull/9548?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T08:04:23.398+0000",
                    "updated": "2021-02-23T08:04:23.398+0000",
                    "started": "2021-02-23T08:04:23.397+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556221",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556617",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#issuecomment-784571729\n\n\n   The integration failure looks like https://issues.apache.org/jira/browse/ARROW-11717\r\n   \r\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T22:55:09.550+0000",
                    "updated": "2021-02-23T22:55:09.550+0000",
                    "started": "2021-02-23T22:55:09.550+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556617",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556619",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#discussion_r581451845\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/repartition.rs\n##########\n@@ -305,6 +347,33 @@ mod tests {\n         Ok(())\n     }\n \n+    #[tokio::test(flavor = \"multi_thread\")]\n+    async fn many_to_many_hash_partition() -> Result<()> {\n+        // define input partitions\n+        let schema = test_schema();\n+        let partition = create_vec_batches(&schema, 50);\n+        let partitions = vec![partition.clone(), partition.clone(), partition.clone()];\n+\n+        let output_partitions = repartition(\n+            &schema,\n+            partitions,\n+            Partitioning::Hash(\n+                vec![Arc::new(crate::physical_plan::expressions::Column::new(\n+                    &\"c0\",\n+                ))],\n+                8,\n+            ),\n+        )\n+        .await?;\n+\n+        let total_rows: usize = output_partitions.iter().map(|x| x.len()).sum();\n+\n+        assert_eq!(8, output_partitions.len());\n\nReview comment:\n       would it make sense here also to assert on the distribution of rows (e.g. ensure that each batch has ~ 50*3 rows?\n\n##########\nFile path: rust/datafusion/src/physical_plan/repartition.rs\n##########\n@@ -120,23 +120,71 @@ impl ExecutionPlan for RepartitionExec {\n                 let (sender, receiver) = unbounded::<Option<ArrowResult<RecordBatch>>>();\n                 channels.push((sender, receiver));\n             }\n+            let random = ahash::RandomState::new();\n+\n             // launch one async task per *input* partition\n             for i in 0..num_input_partitions {\n+                let random_state = random.clone();\n                 let input = self.input.clone();\n                 let mut channels = channels.clone();\n                 let partitioning = self.partitioning.clone();\n                 let join_handle: JoinHandle<Result<()>> = tokio::spawn(async move {\n                     let mut stream = input.execute(i).await?;\n                     let mut counter = 0;\n                     while let Some(result) = stream.next().await {\n-                        match partitioning {\n+                        match &partitioning {\n                             Partitioning::RoundRobinBatch(_) => {\n                                 let output_partition = counter % num_output_partitions;\n                                 let tx = &mut channels[output_partition].0;\n                                 tx.send(Some(result)).map_err(|e| {\n                                     DataFusionError::Execution(e.to_string())\n                                 })?;\n                             }\n+                            Partitioning::Hash(exprs, _) => {\n+                                let input_batch = result?;\n+                                let arrays = exprs\n+                                    .iter()\n+                                    .map(|expr| {\n+                                        Ok(expr\n+                                            .evaluate(&input_batch)?\n+                                            .into_array(input_batch.num_rows()))\n+                                    })\n+                                    .collect::<Result<Vec<_>>>()?;\n+                                // Hash arrays and compute buckets based on number of partitions\n+                                let hashes = create_hashes(&arrays, &random_state)?;\n+                                let mut indices = vec![vec![]; num_output_partitions];\n+                                for (index, hash) in hashes.iter().enumerate() {\n+                                    indices\n+                                        [(*hash % num_output_partitions as u64) as usize]\n+                                        .push(index as u64)\n+                                }\n+                                for num_output_partition in 0..num_output_partitions {\n+                                    let indices =\n\nReview comment:\n       what is this `clone` needed for? Couldn't we just consume `indicies`? I am probably missing something. \n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-23T23:00:03.481+0000",
                    "updated": "2021-02-23T23:00:03.481+0000",
                    "started": "2021-02-23T23:00:03.481+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556619",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556766",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#discussion_r581663717\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/repartition.rs\n##########\n@@ -120,23 +120,71 @@ impl ExecutionPlan for RepartitionExec {\n                 let (sender, receiver) = unbounded::<Option<ArrowResult<RecordBatch>>>();\n                 channels.push((sender, receiver));\n             }\n+            let random = ahash::RandomState::new();\n+\n             // launch one async task per *input* partition\n             for i in 0..num_input_partitions {\n+                let random_state = random.clone();\n                 let input = self.input.clone();\n                 let mut channels = channels.clone();\n                 let partitioning = self.partitioning.clone();\n                 let join_handle: JoinHandle<Result<()>> = tokio::spawn(async move {\n                     let mut stream = input.execute(i).await?;\n                     let mut counter = 0;\n                     while let Some(result) = stream.next().await {\n-                        match partitioning {\n+                        match &partitioning {\n                             Partitioning::RoundRobinBatch(_) => {\n                                 let output_partition = counter % num_output_partitions;\n                                 let tx = &mut channels[output_partition].0;\n                                 tx.send(Some(result)).map_err(|e| {\n                                     DataFusionError::Execution(e.to_string())\n                                 })?;\n                             }\n+                            Partitioning::Hash(exprs, _) => {\n+                                let input_batch = result?;\n+                                let arrays = exprs\n+                                    .iter()\n+                                    .map(|expr| {\n+                                        Ok(expr\n+                                            .evaluate(&input_batch)?\n+                                            .into_array(input_batch.num_rows()))\n+                                    })\n+                                    .collect::<Result<Vec<_>>>()?;\n+                                // Hash arrays and compute buckets based on number of partitions\n+                                let hashes = create_hashes(&arrays, &random_state)?;\n+                                let mut indices = vec![vec![]; num_output_partitions];\n+                                for (index, hash) in hashes.iter().enumerate() {\n+                                    indices\n+                                        [(*hash % num_output_partitions as u64) as usize]\n+                                        .push(index as u64)\n+                                }\n+                                for num_output_partition in 0..num_output_partitions {\n+                                    let indices =\n\nReview comment:\n       in this case, couldn't do before as I was indexing the vec with indices for each partition before.\r\n   Now solved with `into_iter()` to the vec.\r\n   (This still does one extra conversion from `Vec<u64>` to `PrimitiveArray`, that could be a future optimization\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T06:29:16.393+0000",
                    "updated": "2021-02-24T06:29:16.393+0000",
                    "started": "2021-02-24T06:29:16.393+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556766",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556767",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#discussion_r581663717\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/repartition.rs\n##########\n@@ -120,23 +120,71 @@ impl ExecutionPlan for RepartitionExec {\n                 let (sender, receiver) = unbounded::<Option<ArrowResult<RecordBatch>>>();\n                 channels.push((sender, receiver));\n             }\n+            let random = ahash::RandomState::new();\n+\n             // launch one async task per *input* partition\n             for i in 0..num_input_partitions {\n+                let random_state = random.clone();\n                 let input = self.input.clone();\n                 let mut channels = channels.clone();\n                 let partitioning = self.partitioning.clone();\n                 let join_handle: JoinHandle<Result<()>> = tokio::spawn(async move {\n                     let mut stream = input.execute(i).await?;\n                     let mut counter = 0;\n                     while let Some(result) = stream.next().await {\n-                        match partitioning {\n+                        match &partitioning {\n                             Partitioning::RoundRobinBatch(_) => {\n                                 let output_partition = counter % num_output_partitions;\n                                 let tx = &mut channels[output_partition].0;\n                                 tx.send(Some(result)).map_err(|e| {\n                                     DataFusionError::Execution(e.to_string())\n                                 })?;\n                             }\n+                            Partitioning::Hash(exprs, _) => {\n+                                let input_batch = result?;\n+                                let arrays = exprs\n+                                    .iter()\n+                                    .map(|expr| {\n+                                        Ok(expr\n+                                            .evaluate(&input_batch)?\n+                                            .into_array(input_batch.num_rows()))\n+                                    })\n+                                    .collect::<Result<Vec<_>>>()?;\n+                                // Hash arrays and compute buckets based on number of partitions\n+                                let hashes = create_hashes(&arrays, &random_state)?;\n+                                let mut indices = vec![vec![]; num_output_partitions];\n+                                for (index, hash) in hashes.iter().enumerate() {\n+                                    indices\n+                                        [(*hash % num_output_partitions as u64) as usize]\n+                                        .push(index as u64)\n+                                }\n+                                for num_output_partition in 0..num_output_partitions {\n+                                    let indices =\n\nReview comment:\n       in this case, couldn't do before as I was indexing the vec with indices for each partition before.\r\n   Now solved with `into_iter()` on the vec.\r\n   (This still does one extra conversion from `Vec<u64>` to `PrimitiveArray`, that could be a future optimization\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T06:29:29.238+0000",
                    "updated": "2021-02-24T06:29:29.238+0000",
                    "started": "2021-02-24T06:29:29.237+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556767",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/556769",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on a change in pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#discussion_r581664638\n\n\n\n##########\nFile path: rust/datafusion/src/physical_plan/repartition.rs\n##########\n@@ -305,6 +347,33 @@ mod tests {\n         Ok(())\n     }\n \n+    #[tokio::test(flavor = \"multi_thread\")]\n+    async fn many_to_many_hash_partition() -> Result<()> {\n+        // define input partitions\n+        let schema = test_schema();\n+        let partition = create_vec_batches(&schema, 50);\n+        let partitions = vec![partition.clone(), partition.clone(), partition.clone()];\n+\n+        let output_partitions = repartition(\n+            &schema,\n+            partitions,\n+            Partitioning::Hash(\n+                vec![Arc::new(crate::physical_plan::expressions::Column::new(\n+                    &\"c0\",\n+                ))],\n+                8,\n+            ),\n+        )\n+        .await?;\n+\n+        let total_rows: usize = output_partitions.iter().map(|x| x.len()).sum();\n+\n+        assert_eq!(8, output_partitions.len());\n\nReview comment:\n       Makes sense, but not sure how to do that currently, as it depends on random state (it could happen that all of them end up on same hash / partition in a very rare case).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-24T06:31:35.865+0000",
                    "updated": "2021-02-24T06:31:35.865+0000",
                    "started": "2021-02-24T06:31:35.865+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "556769",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/558716",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "Dandandan commented on pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#issuecomment-786865143\n\n\n   @alamb from my side the PR is good to go\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-26T20:02:53.286+0000",
                    "updated": "2021-02-26T20:02:53.286+0000",
                    "started": "2021-02-26T20:02:53.285+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558716",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/558779",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548#issuecomment-786917507\n\n\n   Thanks @Dandandan  -- looks great. \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-26T22:03:40.992+0000",
                    "updated": "2021-02-26T22:03:40.992+0000",
                    "started": "2021-02-26T22:03:40.992+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558779",
                    "issueId": "13360177"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/worklog/558780",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb closed pull request #9548:\nURL: https://github.com/apache/arrow/pull/9548\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-02-26T22:03:43.835+0000",
                    "updated": "2021-02-26T22:03:43.835+0000",
                    "started": "2021-02-26T22:03:43.835+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "558780",
                    "issueId": "13360177"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 6600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@1486bce2[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@75813a96[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7fc0295c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@3e9f9b8[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6703a2a7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3e243ffa[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40d06bab[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@cb86e30[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76d4f39a[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6990d955[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2a5e6aff[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@65d8486a[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 6600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Feb 26 22:03:37 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-02-26T22:03:37.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11733/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-02-22T19:39:32.000+0000",
        "updated": "2021-02-26T22:03:44.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 6600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust][DataFusion] Support hash repartitioning",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360177/comment/17291932",
                    "id": "17291932",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 9548\n[https://github.com/apache/arrow/pull/9548]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=alamb",
                        "name": "alamb",
                        "key": "alamb",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=alamb&avatarId=43364",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=alamb&avatarId=43364",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=alamb&avatarId=43364",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=alamb&avatarId=43364"
                        },
                        "displayName": "Andrew Lamb",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2021-02-26T22:03:37.454+0000",
                    "updated": "2021-02-26T22:03:37.454+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nxzs:",
        "customfield_12314139": null
    }
}