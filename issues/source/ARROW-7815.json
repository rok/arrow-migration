{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13284339",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339",
    "key": "ARROW-7815",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12346687",
                "id": "12346687",
                "description": "",
                "name": "0.17.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-04-20"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 10200,
            "total": 10200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7815/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 19,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/384524",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396\n \n \n   This should fix the following issues:\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20260\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20282\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20307\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20324\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20330\r\n   https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=20575\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-10T16:04:14.674+0000",
                    "updated": "2020-02-10T16:04:14.674+0000",
                    "started": "2020-02-10T16:04:14.673+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "384524",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/384526",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r377157238\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n \n Review comment:\n   @fsaintjacques IIRC, you requested something like the following changes some time ago?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-10T16:05:34.030+0000",
                    "updated": "2020-02-10T16:05:34.030+0000",
                    "started": "2020-02-10T16:05:34.029+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "384526",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/384528",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#issuecomment-584197922\n \n \n   https://issues.apache.org/jira/browse/ARROW-7815\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-10T16:06:30.247+0000",
                    "updated": "2020-02-10T16:06:30.247+0000",
                    "started": "2020-02-10T16:06:30.246+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "384528",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386035",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378348902\n \n \n\n ##########\n File path: cpp/src/arrow/util/bit_util.h\n ##########\n @@ -119,7 +119,11 @@ constexpr int64_t CeilDiv(int64_t value, int64_t divisor) {\n   return (value == 0) ? 0 : 1 + (value - 1) / divisor;\n }\n \n-constexpr int64_t BytesForBits(int64_t bits) { return (bits + 7) >> 3; }\n+// Return the number of bytes needed to fit the given number of bits\n+constexpr int64_t BytesForBits(int64_t bits) {\n+  // This formula avoids integer overflow on very large `bits`\n+  return (bits >> 3) + ((bits & 7) != 0);\n \n Review comment:\n   I think this is just the beginning.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.597+0000",
                    "updated": "2020-02-12T16:18:24.597+0000",
                    "started": "2020-02-12T16:18:24.596+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386035",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386036",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378337246\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n-  // The bit width for each buffer in this DataType's representation\n-  // (kVariableSizeBuffer if the item size for a given buffer is unknown or variable,\n-  //  kAlwaysNullBuffer if the buffer is always null).\n-  // Child types are not included, they should be inspected separately.\n-  std::vector<int64_t> bit_widths;\n-  bool has_dictionary;\n-\n-  static constexpr int64_t kAlwaysNullBuffer = 0;\n-  static constexpr int64_t kVariableSizeBuffer = -1;\n+  enum BufferKind { FIXED_WIDTH, VARIABLE_WIDTH, BITMAP, ALWAYS_NULL };\n \n Review comment:\n   Can you explain the implication of  `ALWAYS_NULL` via a comment?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.600+0000",
                    "updated": "2020-02-12T16:18:24.600+0000",
                    "started": "2020-02-12T16:18:24.600+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386036",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386037",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378355611\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n-  // The bit width for each buffer in this DataType's representation\n-  // (kVariableSizeBuffer if the item size for a given buffer is unknown or variable,\n-  //  kAlwaysNullBuffer if the buffer is always null).\n-  // Child types are not included, they should be inspected separately.\n-  std::vector<int64_t> bit_widths;\n-  bool has_dictionary;\n-\n-  static constexpr int64_t kAlwaysNullBuffer = 0;\n-  static constexpr int64_t kVariableSizeBuffer = -1;\n+  enum BufferKind { FIXED_WIDTH, VARIABLE_WIDTH, BITMAP, ALWAYS_NULL };\n+\n+  /// Layout specification for a single data type buffer\n+  struct BufferSpec {\n \n Review comment:\n   Should we take the opportunity to encode the expected minimum size of the buffer as a function of the number of values (when possible)? This would be useful for, say, the offsets which have the `length+1` trick.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.706+0000",
                    "updated": "2020-02-12T16:18:24.706+0000",
                    "started": "2020-02-12T16:18:24.706+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386037",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386038",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378353515\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -475,7 +496,7 @@ class ARROW_EXPORT NullType : public DataType {\n   std::string ToString() const override;\n \n   DataTypeLayout layout() const override {\n-    return {{DataTypeLayout::kAlwaysNullBuffer}, false};\n+    return DataTypeLayout({DataTypeLayout::AlwaysNull()});\n \n Review comment:\n   Is it a failure to pass `{}` vs `{nullptr}` in Null arrays buffers?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.710+0000",
                    "updated": "2020-02-12T16:18:24.710+0000",
                    "started": "2020-02-12T16:18:24.709+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386038",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386039",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378349567\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -449,7 +467,10 @@ class ARROW_EXPORT CTypeImpl : public BASE {\n \n   int bit_width() const override { return static_cast<int>(sizeof(C_TYPE) * CHAR_BIT); }\n \n-  DataTypeLayout layout() const override { return {{1, bit_width()}, false}; }\n+  DataTypeLayout layout() const override {\n+    return DataTypeLayout(\n+        {DataTypeLayout::Bitmap(), DataTypeLayout::FixedWidth(sizeof(C_TYPE))});\n \n Review comment:\n   General question applicable to all types, when `nullable=false`, should we return `AlwaysNull` instead of `Bitmap` for the bitmap buffer?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.815+0000",
                    "updated": "2020-02-12T16:18:24.815+0000",
                    "started": "2020-02-12T16:18:24.814+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386039",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386040",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378352768\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n \n Review comment:\n   I did want something like this, but it doesn't exactly solve the issue. What I wanted to get rid of are the multiple `buffers[0]` with `0`, `1`, `2` scattered around where you have to know the index. DataTypeLayout is a step in automating this process.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:18:24.926+0000",
                    "updated": "2020-02-12T16:18:24.926+0000",
                    "started": "2020-02-12T16:18:24.925+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386040",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386056",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378367248\n \n \n\n ##########\n File path: cpp/src/arrow/util/bit_util.h\n ##########\n @@ -119,7 +119,11 @@ constexpr int64_t CeilDiv(int64_t value, int64_t divisor) {\n   return (value == 0) ? 0 : 1 + (value - 1) / divisor;\n }\n \n-constexpr int64_t BytesForBits(int64_t bits) { return (bits + 7) >> 3; }\n+// Return the number of bytes needed to fit the given number of bits\n+constexpr int64_t BytesForBits(int64_t bits) {\n+  // This formula avoids integer overflow on very large `bits`\n+  return (bits >> 3) + ((bits & 7) != 0);\n \n Review comment:\n   You mean of avoiding overflow in various places? I agree.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:32:13.054+0000",
                    "updated": "2020-02-12T16:32:13.054+0000",
                    "started": "2020-02-12T16:32:13.053+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386056",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386057",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378367561\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -449,7 +467,10 @@ class ARROW_EXPORT CTypeImpl : public BASE {\n \n   int bit_width() const override { return static_cast<int>(sizeof(C_TYPE) * CHAR_BIT); }\n \n-  DataTypeLayout layout() const override { return {{1, bit_width()}, false}; }\n+  DataTypeLayout layout() const override {\n+    return DataTypeLayout(\n+        {DataTypeLayout::Bitmap(), DataTypeLayout::FixedWidth(sizeof(C_TYPE))});\n \n Review comment:\n   I don't think so. There could be a non-null all-ones bitmap buffer.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:32:42.971+0000",
                    "updated": "2020-02-12T16:32:42.971+0000",
                    "started": "2020-02-12T16:32:42.970+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386057",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386059",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378368023\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -475,7 +496,7 @@ class ARROW_EXPORT NullType : public DataType {\n   std::string ToString() const override;\n \n   DataTypeLayout layout() const override {\n-    return {{DataTypeLayout::kAlwaysNullBuffer}, false};\n+    return DataTypeLayout({DataTypeLayout::AlwaysNull()});\n \n Review comment:\n   I think so, at least as the current Arrow codebase.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:33:22.788+0000",
                    "updated": "2020-02-12T16:33:22.788+0000",
                    "started": "2020-02-12T16:33:22.788+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386059",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386060",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378368023\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -475,7 +496,7 @@ class ARROW_EXPORT NullType : public DataType {\n   std::string ToString() const override;\n \n   DataTypeLayout layout() const override {\n-    return {{DataTypeLayout::kAlwaysNullBuffer}, false};\n+    return DataTypeLayout({DataTypeLayout::AlwaysNull()});\n \n Review comment:\n   I think so, at least as of the current Arrow codebase.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:33:31.303+0000",
                    "updated": "2020-02-12T16:33:31.303+0000",
                    "started": "2020-02-12T16:33:31.303+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386060",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386061",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378369112\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n-  // The bit width for each buffer in this DataType's representation\n-  // (kVariableSizeBuffer if the item size for a given buffer is unknown or variable,\n-  //  kAlwaysNullBuffer if the buffer is always null).\n-  // Child types are not included, they should be inspected separately.\n-  std::vector<int64_t> bit_widths;\n-  bool has_dictionary;\n-\n-  static constexpr int64_t kAlwaysNullBuffer = 0;\n-  static constexpr int64_t kVariableSizeBuffer = -1;\n+  enum BufferKind { FIXED_WIDTH, VARIABLE_WIDTH, BITMAP, ALWAYS_NULL };\n+\n+  /// Layout specification for a single data type buffer\n+  struct BufferSpec {\n \n Review comment:\n   Or there could be an additional `OFFSETS` BufferKind?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T16:34:58.311+0000",
                    "updated": "2020-02-12T16:34:58.311+0000",
                    "started": "2020-02-12T16:34:58.311+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386061",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386132",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378447626\n \n \n\n ##########\n File path: cpp/src/arrow/util/bit_util.h\n ##########\n @@ -119,7 +119,11 @@ constexpr int64_t CeilDiv(int64_t value, int64_t divisor) {\n   return (value == 0) ? 0 : 1 + (value - 1) / divisor;\n }\n \n-constexpr int64_t BytesForBits(int64_t bits) { return (bits + 7) >> 3; }\n+// Return the number of bytes needed to fit the given number of bits\n+constexpr int64_t BytesForBits(int64_t bits) {\n+  // This formula avoids integer overflow on very large `bits`\n+  return (bits >> 3) + ((bits & 7) != 0);\n \n Review comment:\n   yes.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T18:55:51.246+0000",
                    "updated": "2020-02-12T18:55:51.246+0000",
                    "started": "2020-02-12T18:55:51.245+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386132",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386134",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378448209\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n-  // The bit width for each buffer in this DataType's representation\n-  // (kVariableSizeBuffer if the item size for a given buffer is unknown or variable,\n-  //  kAlwaysNullBuffer if the buffer is always null).\n-  // Child types are not included, they should be inspected separately.\n-  std::vector<int64_t> bit_widths;\n-  bool has_dictionary;\n-\n-  static constexpr int64_t kAlwaysNullBuffer = 0;\n-  static constexpr int64_t kVariableSizeBuffer = -1;\n+  enum BufferKind { FIXED_WIDTH, VARIABLE_WIDTH, BITMAP, ALWAYS_NULL };\n+\n+  /// Layout specification for a single data type buffer\n+  struct BufferSpec {\n \n Review comment:\n   You still can compute the size of bitmaps and fixed width buffers.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T18:56:53.585+0000",
                    "updated": "2020-02-12T18:56:53.585+0000",
                    "started": "2020-02-12T18:56:53.585+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386134",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386135",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "fsaintjacques commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378448425\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -191,16 +192,33 @@ class ARROW_EXPORT Fingerprintable {\n \n }  // namespace detail\n \n+/// EXPERIMENTAL: Layout specification for a data type\n struct ARROW_EXPORT DataTypeLayout {\n-  // The bit width for each buffer in this DataType's representation\n-  // (kVariableSizeBuffer if the item size for a given buffer is unknown or variable,\n-  //  kAlwaysNullBuffer if the buffer is always null).\n-  // Child types are not included, they should be inspected separately.\n-  std::vector<int64_t> bit_widths;\n-  bool has_dictionary;\n-\n-  static constexpr int64_t kAlwaysNullBuffer = 0;\n-  static constexpr int64_t kVariableSizeBuffer = -1;\n+  enum BufferKind { FIXED_WIDTH, VARIABLE_WIDTH, BITMAP, ALWAYS_NULL };\n+\n+  /// Layout specification for a single data type buffer\n+  struct BufferSpec {\n \n Review comment:\n   `OFFSETS` BufferKind is also a good thing.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T18:57:17.090+0000",
                    "updated": "2020-02-12T18:57:17.090+0000",
                    "started": "2020-02-12T18:57:17.090+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386135",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386289",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396#discussion_r378554676\n \n \n\n ##########\n File path: cpp/src/arrow/type.h\n ##########\n @@ -475,7 +496,7 @@ class ARROW_EXPORT NullType : public DataType {\n   std::string ToString() const override;\n \n   DataTypeLayout layout() const override {\n-    return {{DataTypeLayout::kAlwaysNullBuffer}, false};\n+    return DataTypeLayout({DataTypeLayout::AlwaysNull()});\n \n Review comment:\n   I think that is the case\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T22:41:58.451+0000",
                    "updated": "2020-02-12T22:41:58.451+0000",
                    "started": "2020-02-12T22:41:58.450+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386289",
                    "issueId": "13284339"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/worklog/386311",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #6396: ARROW-7815: [C++] Improve input validation\nURL: https://github.com/apache/arrow/pull/6396\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-02-12T23:28:58.021+0000",
                    "updated": "2020-02-12T23:28:58.021+0000",
                    "started": "2020-02-12T23:28:58.021+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "386311",
                    "issueId": "13284339"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 10200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2307750a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7029909[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@15a1e03f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6f8e953[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40e4a410[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7e118c55[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@642b3bb0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2558e417[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40f90088[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@32785fe6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@f3304a2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6da9210f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 10200,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Feb 12 23:28:58 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-02-12T23:28:58.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-7815/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-02-10T15:09:14.000+0000",
        "updated": "2020-02-12T23:28:58.000+0000",
        "timeoriginalestimate": null,
        "description": "More issues have been discovered with OSS-Fuzz, we need to enhance input validation.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 50m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 10200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Fix crashes on corrupt IPC input (OSS-Fuzz)",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13284339/comment/17035792",
                    "id": "17035792",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 6396\n[https://github.com/apache/arrow/pull/6396]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-02-12T23:28:58.590+0000",
                    "updated": "2020-02-12T23:28:58.590+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0bbxc:",
        "customfield_12314139": null
    }
}