{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13252327",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327",
    "key": "ARROW-6321",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12340948",
                "id": "12340948",
                "description": "",
                "name": "0.16.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-02-07"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6321/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/299376",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162\n \n \n   https://issues.apache.org/jira/browse/ARROW-6321\r\n   \r\n   This adds some code to create pandas ExtensionBlocks on the conversion to pandas. The approach taken is that for this case, instead of converting the Arrow array to a numpy array that can be stored in the block, the arrow_to_pandas C++ code sents the actual Arrow array to the pyarrow compat code (no conversion), and then there can be a mechanism to convert the arrow Array to a pandas ExtensionArray called from pyarrow.\r\n   \r\n   As example (to test this), I changed the `integer_object_nulls` option (if triggered) to return a pandas nullable IntegerArray instead of object dtype array. And then in the pyarrow code for now hardcoded a conversion from pyarrow integer array to pandas IntegerArray. \r\n   \r\n   This (hardcoded) example works:\r\n   \r\n   ```\r\n   In [1]: df = pd.DataFrame({'a': [1, 2, 3], 'b': np.array([0, 1, None], dtype='object')}) \r\n      ...: table = pa.table(df)\r\n   \r\n   In [2]: table\r\n   Out[2]: \r\n   pyarrow.Table\r\n   a: int64\r\n   b: int64\r\n   metadata\r\n   --------\r\n   {b'pandas': ...\r\n   \r\n   In [3]: table.to_pandas()   # default, you get floats if there are NULLs\r\n   Out[3]: \r\n      a    b\r\n   0  1  0.0\r\n   1  2  1.0\r\n   2  3  NaN\r\n   \r\n   In [4]: table.to_pandas(integer_object_nulls=True)\r\n   Out[4]: \r\n      a    b\r\n   0  1    0\r\n   1  2    1\r\n   2  3  NaN\r\n   \r\n   In [5]: table.to_pandas(integer_object_nulls=True).dtypes\r\n   Out[5]: \r\n   a    int64\r\n   b    Int64   # <--- nullable integer type (ExtensionArray)\r\n   dtype: object\r\n   ```\r\n   \r\n   What is missing:\r\n   \r\n   - a mechanism to indicate to the C++ `ConvertTableToPandas` function which columns to convert to extension block (maybe with a similar option as the current \"categorical_columns\" option?)\r\n   - a mechanism to know how to convert the Arrow array to a pandas ExtensionArray (this is related to https://issues.apache.org/jira/browse/ARROW-2428\r\n   \r\n   \r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-08-22T12:00:23.928+0000",
                    "updated": "2019-08-22T12:00:23.928+0000",
                    "started": "2019-08-22T12:00:23.927+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "299376",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/310473",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-530322239\n \n \n   This is ready to be reviewed now.  \r\n   Note, this PR still includes some custom code in `pandas_compat.py` to convert a pyarrow array to a pandas IntegerArray. This is of course something that should not stay, but for now is to be able to test this.  \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-11T10:31:34.459+0000",
                    "updated": "2019-09-11T10:31:34.459+0000",
                    "started": "2019-09-11T10:31:34.458+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "310473",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314385",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r325731464\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1279,6 +1281,55 @@ class CategoricalBlock : public PandasBlock {\n   bool needs_copy_;\n };\n \n+class ExtensionBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+\n+  // Don't create a block array here, only the placement array\n+  Status Allocate() override {\n+    PyAcquireGIL lock;\n+\n+    npy_intp placement_dims[1] = {num_columns_};\n+    PyObject* placement_arr = PyArray_SimpleNew(1, placement_dims, NPY_INT64);\n+\n+    RETURN_IF_PYERROR();\n+\n+    placement_arr_.reset(placement_arr);\n+\n+    placement_data_ = reinterpret_cast<int64_t*>(\n+        PyArray_DATA(reinterpret_cast<PyArrayObject*>(placement_arr)));\n+\n+    return Status::OK();\n+  }\n+\n+  Status Write(const std::shared_ptr<ChunkedArray>& data, int64_t abs_placement,\n+               int64_t rel_placement) override {\n+    PyAcquireGIL lock;\n+\n+    PyObject* py_array;\n+    py_array = wrap_chunked_array(data);\n+    py_array_.reset(py_array);\n+\n+    placement_data_[rel_placement] = abs_placement;\n+    return Status::OK();\n+  }\n+\n+  Status GetPyResult(PyObject** output) override {\n \n Review comment:\n   AFAICT this just duplicates the base class implementation. Why did you redefine it?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T15:17:24.520+0000",
                    "updated": "2019-09-18T15:17:24.520+0000",
                    "started": "2019-09-18T15:17:24.519+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314385",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314386",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r325737793\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1424,7 +1479,11 @@ class DataFrameBlockCreator {\n     for (int i = 0; i < table_->num_columns(); ++i) {\n       std::shared_ptr<ChunkedArray> col = table_->column(i);\n       PandasBlock::type output_type = PandasBlock::OBJECT;\n-      RETURN_NOT_OK(GetPandasBlockType(*col, options_, &output_type));\n+      if (extension_columns_.count(table_->field(i)->name())) {\n \n Review comment:\n   Hmm... I don't understand why we're using an explicit `extension_columns`. Shouldn't we simply detect an arrow ExtensionType?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T15:17:24.523+0000",
                    "updated": "2019-09-18T15:17:24.523+0000",
                    "started": "2019-09-18T15:17:24.522+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314386",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314387",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r325735924\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1279,6 +1281,55 @@ class CategoricalBlock : public PandasBlock {\n   bool needs_copy_;\n };\n \n+class ExtensionBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+\n+  // Don't create a block array here, only the placement array\n \n Review comment:\n   So you're not handling the extension storage anywhere? Why is this?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T15:17:24.615+0000",
                    "updated": "2019-09-18T15:17:24.615+0000",
                    "started": "2019-09-18T15:17:24.614+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314387",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r325761078\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1279,6 +1281,55 @@ class CategoricalBlock : public PandasBlock {\n   bool needs_copy_;\n };\n \n+class ExtensionBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+\n+  // Don't create a block array here, only the placement array\n \n Review comment:\n   What do you mean with \"extension storage\"? \r\n   The goal of this ExtensionBlock is to not convert the arrow array to a numpy array, but to pass it through as a pyarrow array to the caller of the `ConvertTableToPandas` function.\r\n   \r\n   What is maybe confusing is that this is called \"ExtensionBlock\", as it is not necessarily for *arrow* extension types, but meant for *pandas* extension arrays (and those two don't necessarily map)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T16:01:04.762+0000",
                    "updated": "2019-09-18T16:01:04.762+0000",
                    "started": "2019-09-18T16:01:04.761+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314424",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314425",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r325761587\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1279,6 +1281,55 @@ class CategoricalBlock : public PandasBlock {\n   bool needs_copy_;\n };\n \n+class ExtensionBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+\n+  // Don't create a block array here, only the placement array\n+  Status Allocate() override {\n+    PyAcquireGIL lock;\n+\n+    npy_intp placement_dims[1] = {num_columns_};\n+    PyObject* placement_arr = PyArray_SimpleNew(1, placement_dims, NPY_INT64);\n+\n+    RETURN_IF_PYERROR();\n+\n+    placement_arr_.reset(placement_arr);\n+\n+    placement_data_ = reinterpret_cast<int64_t*>(\n+        PyArray_DATA(reinterpret_cast<PyArrayObject*>(placement_arr)));\n+\n+    return Status::OK();\n+  }\n+\n+  Status Write(const std::shared_ptr<ChunkedArray>& data, int64_t abs_placement,\n+               int64_t rel_placement) override {\n+    PyAcquireGIL lock;\n+\n+    PyObject* py_array;\n+    py_array = wrap_chunked_array(data);\n+    py_array_.reset(py_array);\n+\n+    placement_data_[rel_placement] = abs_placement;\n+    return Status::OK();\n+  }\n+\n+  Status GetPyResult(PyObject** output) override {\n \n Review comment:\n   The `PyDict_SetItemString(result, \"py_array\", py_array_.obj());` is different. This is putting a pyarrow array in the result dict.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T16:01:05.003+0000",
                    "updated": "2019-09-18T16:01:05.003+0000",
                    "started": "2019-09-18T16:01:05.003+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314425",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314430",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-532755816\n \n \n   > Hmm... I don't understand why we're using an explicit extension_columns. Shouldn't we simply detect an arrow ExtensionType?\r\n   \r\n   Let me try to clarify (the fact that both pandas and arrow use \"extension\" for potentially different things does not make it clearer ..). \r\n   I named it here \"ExtensionBlock\" in the arrow C++ code because it is meant to create a *pandas* ExtensionBlock (pandas stores the data in a blocks in a BlockManager, pandas.ExtensionArrays are stored in an ExtensionBlock). The \"extension\" here thus refers to pandas' notion of it, not necessarily arrow's notion of \"extension type\".\r\n   \r\n   So the goal of the explicit `extension_columns` is meant to indicate which columns should be converted to ExtensionBlocks. The reason that I not simply use the arrow types for this (i.e. doing this when the columns has an arrow extension type), is because there is not necessarily a 1 to 1 mapping of the extension concept in pandas and the extension concept in arrow. Let me give two examples:\r\n   \r\n   - Pandas has an experimental \"nullable integer\" type which is implemented as a pandas.ExtensionArray (basically kind of a masked array). Converting that to arrow gives you simply an arrow integer type, and not an extension type (since arrow can natively have missing values, we don't need an extension type here). \r\n     But when you want to convert back to pandas, a user might want to opt in to create this nullable integer ExtensionArray instead of a float numpy array. So in such a case we need to convert a IntegerType (not an extension type) in `ConvertTableToPandas` to an ExtensionBlock. \r\n   - Another example is fletcher, where they wrap arrow arrays inside pandas ExtensionArrays to store them directly in pandas DataFrames. Again, those are ExtensionArrays on the pandas side, but don't need to map to an extension type on the arrow side.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T16:10:53.443+0000",
                    "updated": "2019-09-18T16:10:53.443+0000",
                    "started": "2019-09-18T16:10:53.443+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314430",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314502",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-532782977\n \n \n   Ok, I'll admit my cluelessness on this :-) Perhaps @wesm  and @xhochy want to take a look.\r\n   (it seems you'll also need to rebase)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T17:22:11.432+0000",
                    "updated": "2019-09-18T17:22:11.432+0000",
                    "started": "2019-09-18T17:22:11.432+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314502",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314506",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-532755816\n \n \n   > Hmm... I don't understand why we're using an explicit extension_columns. Shouldn't we simply detect an arrow ExtensionType?\r\n   \r\n   Let me try to clarify (the fact that both pandas and arrow use \"extension\" for potentially different things does not make it clearer ..). \r\n   I named it here \"ExtensionBlock\" in the arrow C++ code because it is meant to create a *pandas* ExtensionBlock (pandas stores the data in blocks in a BlockManager, pandas.ExtensionArrays are stored in an ExtensionBlock). The \"extension\" here thus refers to pandas' notion of it, not necessarily arrow's notion of \"extension type\".\r\n   \r\n   So the goal of the explicit `extension_columns` is meant to indicate which columns should be converted to ExtensionBlocks. The reason that I not simply use the arrow types for this (i.e. doing this when the columns has an arrow extension type), is because there is not necessarily a 1 to 1 mapping of the extension concept in pandas and the extension concept in arrow. Let me give two examples:\r\n   \r\n   - Pandas has an experimental \"nullable integer\" type which is implemented as a pandas.ExtensionArray (basically kind of a masked array). Converting that to arrow gives you simply an arrow integer type, and not an extension type (since arrow can natively have missing values, we don't need an extension type here). \r\n     But when you want to convert back to pandas, a user might want to opt in to create this nullable integer ExtensionArray instead of a float numpy array. So in such a case we need to convert a IntegerType (not an extension type) in `ConvertTableToPandas` to an ExtensionBlock. \r\n   - Another example is fletcher, where they wrap arrow arrays inside pandas ExtensionArrays to store them directly in pandas DataFrames. Again, those are ExtensionArrays on the pandas side, but don't need to map to an extension type on the arrow side.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T17:34:01.035+0000",
                    "updated": "2019-09-18T17:34:01.035+0000",
                    "started": "2019-09-18T17:34:01.034+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314506",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/314507",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-532755816\n \n \n   > Hmm... I don't understand why we're using an explicit extension_columns. Shouldn't we simply detect an arrow ExtensionType?\r\n   \r\n   Let me try to clarify (the fact that both pandas and arrow use \"extension\" for potentially different things does not make it clearer ..). \r\n   I named it here \"ExtensionBlock\" in the arrow C++ code because it is meant to create a *pandas* ExtensionBlock (pandas stores the data in blocks in a BlockManager, pandas.ExtensionArrays are stored in an ExtensionBlock). The \"extension\" here thus refers to pandas' notion of it, not necessarily arrow's notion of \"extension type\".\r\n   \r\n   So the goal of the explicit `extension_columns` is meant to indicate which columns should be converted to ExtensionBlocks. The reason that I not simply use the arrow types for this (i.e. doing this when the column has an arrow extension type), is because there is not necessarily a 1 to 1 mapping of the extension concept in pandas and the extension concept in arrow. Let me give two examples:\r\n   \r\n   - Pandas has an experimental \"nullable integer\" type which is implemented as a pandas.ExtensionArray (basically kind of a masked array). Converting that to arrow gives you simply an arrow integer type, and not an extension type (since arrow can natively have missing values, we don't need an extension type here). \r\n     But when you want to convert back to pandas, a user might want to opt in to create this nullable integer ExtensionArray instead of a float numpy array. So in such a case we need to convert a IntegerType (not an extension type) in `ConvertTableToPandas` to an ExtensionBlock. \r\n   - Another example is fletcher, where they wrap arrow arrays inside pandas ExtensionArrays to store them directly in pandas DataFrames. Again, those are ExtensionArrays on the pandas side, but don't need to map to an extension type on the arrow side.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-18T17:34:26.163+0000",
                    "updated": "2019-09-18T17:34:26.163+0000",
                    "started": "2019-09-18T17:34:26.162+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "314507",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/318913",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-535446561\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=h1) Report\n   > Merging [#5162](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/07ab5083d5a2925ced6f8168b60b8fa336f4eccc?src=pr&el=desc) will **increase** coverage by `0.56%`.\n   > The diff coverage is `95.18%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/5162/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #5162      +/-   ##\n   ==========================================\n   + Coverage    88.7%   89.26%   +0.56%     \n   ==========================================\n     Files         961      769     -192     \n     Lines      128021   112614   -15407     \n     Branches     1501        0    -1501     \n   ==========================================\n   - Hits       113555   100529   -13026     \n   + Misses      14101    12085    -2016     \n   + Partials      365        0     -365\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/python/arrow\\_to\\_pandas.h](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vYXJyb3dfdG9fcGFuZGFzLmg=) | `100% <\u00f8> (\u00f8)` | :arrow_up: |\n   | [cpp/src/arrow/python/pyarrow.cc](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vcHlhcnJvdy5jYw==) | `29.54% <100%> (+1.63%)` | :arrow_up: |\n   | [python/pyarrow/table.pxi](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvdGFibGUucHhp) | `87.63% <66.66%> (+0.05%)` | :arrow_up: |\n   | [python/pyarrow/pandas\\_compat.py](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvcGFuZGFzX2NvbXBhdC5weQ==) | `97% <93.75%> (-0.15%)` | :arrow_down: |\n   | [python/pyarrow/tests/test\\_pandas.py](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvdGVzdHMvdGVzdF9wYW5kYXMucHk=) | `94.51% <95.23%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/arrow/python/arrow\\_to\\_pandas.cc](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vYXJyb3dfdG9fcGFuZGFzLmNj) | `92.22% <97.56%> (+0.18%)` | :arrow_up: |\n   | [cpp/src/arrow/filesystem/s3\\_internal.h](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9maWxlc3lzdGVtL3MzX2ludGVybmFsLmg=) | `90.74% <0%> (-3.71%)` | :arrow_down: |\n   | [cpp/src/arrow/json/converter.cc](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9qc29uL2NvbnZlcnRlci5jYw==) | `90.05% <0%> (-1.76%)` | :arrow_down: |\n   | [cpp/src/arrow/json/chunked\\_builder.cc](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9qc29uL2NodW5rZWRfYnVpbGRlci5jYw==) | `79.91% <0%> (-1.68%)` | :arrow_down: |\n   | [go/arrow/ipc/writer.go](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree#diff-Z28vYXJyb3cvaXBjL3dyaXRlci5nbw==) | | |\n   | ... and [193 more](https://codecov.io/gh/apache/arrow/pull/5162/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=footer). Last update [07ab508...969182d](https://codecov.io/gh/apache/arrow/pull/5162?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-09-26T10:42:36.701+0000",
                    "updated": "2019-09-26T10:42:36.701+0000",
                    "started": "2019-09-26T10:42:36.700+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "318913",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322797",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r331171442\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1424,7 +1479,11 @@ class DataFrameBlockCreator {\n     for (int i = 0; i < table_->num_columns(); ++i) {\n       std::shared_ptr<ChunkedArray> col = table_->column(i);\n       PandasBlock::type output_type = PandasBlock::OBJECT;\n-      RETURN_NOT_OK(GetPandasBlockType(*col, options_, &output_type));\n+      if (extension_columns_.count(table_->field(i)->name())) {\n \n Review comment:\n   I was also confused by this. I looked at the unit test below and there are a couple of different things going on:\r\n   \r\n   * Creating pandas ExtensionArray values from built-in Arrow types\r\n   * Converting Arrow ExtensionType data \r\n   \r\n   This seems to do the former but not the latter. What is the use case for the former, mainly getting IntegerArray out? \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T17:56:58.474+0000",
                    "updated": "2019-10-03T17:56:58.474+0000",
                    "started": "2019-10-03T17:56:58.473+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322797",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322798",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on pull request #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#discussion_r331171203\n \n \n\n ##########\n File path: cpp/src/arrow/python/arrow_to_pandas.cc\n ##########\n @@ -1279,6 +1281,55 @@ class CategoricalBlock : public PandasBlock {\n   bool needs_copy_;\n };\n \n+class ExtensionBlock : public PandasBlock {\n+ public:\n+  using PandasBlock::PandasBlock;\n+\n+  // Don't create a block array here, only the placement array\n+  Status Allocate() override {\n+    PyAcquireGIL lock;\n+\n+    npy_intp placement_dims[1] = {num_columns_};\n+    PyObject* placement_arr = PyArray_SimpleNew(1, placement_dims, NPY_INT64);\n+\n+    RETURN_IF_PYERROR();\n+\n+    placement_arr_.reset(placement_arr);\n+\n+    placement_data_ = reinterpret_cast<int64_t*>(\n+        PyArray_DATA(reinterpret_cast<PyArrayObject*>(placement_arr)));\n+\n+    return Status::OK();\n+  }\n+\n+  Status Write(const std::shared_ptr<ChunkedArray>& data, int64_t abs_placement,\n+               int64_t rel_placement) override {\n+    PyAcquireGIL lock;\n+\n+    PyObject* py_array;\n+    py_array = wrap_chunked_array(data);\n+    py_array_.reset(py_array);\n+\n+    placement_data_[rel_placement] = abs_placement;\n+    return Status::OK();\n+  }\n+\n+  Status GetPyResult(PyObject** output) override {\n \n Review comment:\n   It's somewhat of a hack but it's a way to pass through the Arrow data so that it gets converted elsewhere\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T17:56:58.648+0000",
                    "updated": "2019-10-03T17:56:58.648+0000",
                    "started": "2019-10-03T17:56:58.647+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322798",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322800",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "wesm commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538056824\n \n \n   Ah I read @jorisvandenbossche comments now. Since this is strictly internal and non-public-API code I am okay with it. Do you want to make any more changes to this patch beyond rebasing and getting the tests passing?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T17:58:38.512+0000",
                    "updated": "2019-10-03T17:58:38.512+0000",
                    "started": "2019-10-03T17:58:38.512+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322800",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322814",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538060597\n \n \n   >  Do you want to make any more changes to this patch beyond rebasing and getting the tests passing?\r\n   \r\n   For me it is fine to get this in. It's also included in https://github.com/apache/arrow/pull/5512 since I needed it there. But if we are fine with the arrow_to_pandas.cc ::ExtensionBlock (which is indeed the internal part), then that makes the diff of the other PR a bit smaller. \r\n   \r\n   Will rebase this.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T18:08:50.651+0000",
                    "updated": "2019-10-03T18:08:50.651+0000",
                    "started": "2019-10-03T18:08:50.650+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322814",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322873",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538087779\n \n \n   Travis is failing on the `arrow-flight-test ` C++ test, not sure if that can be related to the changes in this PR\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T19:21:07.071+0000",
                    "updated": "2019-10-03T19:21:07.071+0000",
                    "started": "2019-10-03T19:21:07.070+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322873",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/322874",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538087779\n \n \n   The \"Ursabot / AMD64 Conda Python 3.6\" build is failing on the `arrow-flight-test ` C++ test, not sure if that can be related to the changes in this PR\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-03T19:22:16.290+0000",
                    "updated": "2019-10-03T19:22:16.290+0000",
                    "started": "2019-10-03T19:22:16.289+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "322874",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/323213",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538254810\n \n \n   @ursabot build\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-04T06:14:11.561+0000",
                    "updated": "2019-10-04T06:14:11.561+0000",
                    "started": "2019-10-04T06:14:11.560+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "323213",
                    "issueId": "13252327"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/worklog/323377",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #5162: ARROW-6321: [Python] Ability to create ExtensionBlock on conversion to pandas\nURL: https://github.com/apache/arrow/pull/5162#issuecomment-538372320\n \n \n   I retriggered the builds, and all green now\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-10-04T12:15:50.399+0000",
                    "updated": "2019-10-04T12:15:50.399+0000",
                    "started": "2019-10-04T12:15:50.398+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "323377",
                    "issueId": "13252327"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 13200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@5160c339[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@48a1686e[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3da1a508[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7e0048ca[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@469cbc96[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@52547a3c[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@626d0c9b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@1ed75e04[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3d8c3944[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4c783153[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@467bf593[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6278b426[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Oct 08 22:07:45 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-10-08T22:07:45.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-6321/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-08-22T08:53:01.000+0000",
        "updated": "2019-10-08T22:07:45.000+0000",
        "timeoriginalestimate": null,
        "description": "To be able to create a pandas DataFrame in {{to_pandas()}} that holds ExtensionArrays (e.g. towards ARROW-2428 to register a conversion), we first need to add to the {{table_to_blockmanager}} / {{ConvertTableToPandas}} conversion utilities the ability to create an pandas {{ExtensionBlock}} that can hold a pandas {{ExtensionArray}}.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Ability to create ExtensionBlock on conversion to pandas",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13252327/comment/16947208",
                    "id": "16947208",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 5162\n[https://github.com/apache/arrow/pull/5162]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=wesm",
                        "name": "wesm",
                        "key": "wesmckinn",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=wesmckinn&avatarId=29931",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=wesmckinn&avatarId=29931",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=wesmckinn&avatarId=29931",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=wesmckinn&avatarId=29931"
                        },
                        "displayName": "Wes McKinney",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2019-10-08T22:07:45.256+0000",
                    "updated": "2019-10-08T22:07:45.256+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z05x60:",
        "customfield_12314139": null
    }
}