{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13218994",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994",
    "key": "ARROW-4734",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343937",
                "id": "12343937",
                "description": "",
                "name": "0.13.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-04-01"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=anson627",
            "name": "anson627",
            "key": "anson627",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Anson Qian",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333772",
                "id": "12333772",
                "name": "Go"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=anson627",
            "name": "anson627",
            "key": "anson627",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Anson Qian",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=anson627",
            "name": "anson627",
            "key": "anson627",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34050",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34050",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34050",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34050"
            },
            "displayName": "Anson Qian",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 11400,
            "total": 11400,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4734/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 24,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/211228",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-471680893\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=h1) Report\n   > Merging [#3866](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/750896fadb1dee805a1d643d4f46a6b016237e5d?src=pr&el=desc) will **decrease** coverage by `19.01%`.\n   > The diff coverage is `100%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3866/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree)\n   \n   ```diff\n   @@             Coverage Diff             @@\n   ##           master    #3866       +/-   ##\n   ===========================================\n   - Coverage   87.83%   68.82%   -19.02%     \n   ===========================================\n     Files         725       60      -665     \n     Lines       87601     4128    -83473     \n     Branches     1252        0     -1252     \n   ===========================================\n   - Hits        76948     2841    -74107     \n   + Misses      10539     1181     -9358     \n   + Partials      114      106        -8\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/csv/writer.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3dyaXRlci5nbw==) | `95.71% <100%> (+0.4%)` | :arrow_up: |\n   | [python/pyarrow/ipc.pxi](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-cHl0aG9uL3B5YXJyb3cvaXBjLnB4aQ==) | | |\n   | [cpp/src/arrow/csv/chunker-test.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvY2h1bmtlci10ZXN0LmNj) | | |\n   | [cpp/src/parquet/column\\_page.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2NvbHVtbl9wYWdlLmg=) | | |\n   | [cpp/src/parquet/bloom\\_filter-test.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wYXJxdWV0L2Jsb29tX2ZpbHRlci10ZXN0LmNj) | | |\n   | [cpp/src/arrow/array/builder\\_decimal.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9hcnJheS9idWlsZGVyX2RlY2ltYWwuY2M=) | | |\n   | [cpp/src/plasma/client.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvY2xpZW50LmNj) | | |\n   | [cpp/src/arrow/io/test-common.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9pby90ZXN0LWNvbW1vbi5o) | | |\n   | [cpp/src/arrow/util/int-util-test.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2ludC11dGlsLXRlc3QuY2M=) | | |\n   | [cpp/src/arrow/python/io.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9weXRob24vaW8uY2M=) | | |\n   | ... and [656 more](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=footer). Last update [750896f...3fd87ce](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-11T19:12:36.774+0000",
                    "updated": "2019-03-11T19:12:36.774+0000",
                    "started": "2019-03-11T19:12:36.774+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "211228",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/211577",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r264565209\n \n \n\n ##########\n File path: go/arrow/csv/writer.go\n ##########\n @@ -127,3 +127,19 @@ func (w *Writer) Write(record array.Record) error {\n \n \treturn w.w.WriteAll(recs)\n }\n+\n+// WriteHeader writes a header as one row to the CSV file\n+func (w *Writer) WriteHeader(header string) error {\n \n Review comment:\n   I wouldn't expose `WriteHeader`: a header is something that has a particular meaning, and is present only once at the top of a CSV file.\r\n   best to keep this close to ourselves and don't let users possibly mess with it :)\r\n   \r\n   also, what you've implemented isn't writing a header, it's more like adding a comment.\r\n   \r\n   a header, in CSV speak, is the first non-comment line that gives the name of each column.\r\n   for the example/test we use, what the header should look like is:\r\n   ```\r\n   bool;i8;i16;i32;i64;u8;u16;u32;u64;f32;f64;str\r\n   ```\r\n   (if `;` is the `w.w.Comma`)\r\n   \r\n   the CSV header can thus be completely infered and automatically generated from the `w.schema`.\r\n   \r\n   the way I had envisionned it was to have a `WithHeader(bool)` option (for both `Reader` and `Writer`) that would automatically trigger the generation of the header in the `Writer` case (but only for the first batch of records, and only once) and the deciphering of the header (optionally making sure it matches the schema) in the `Reader` case.\r\n   \r\n   finally: I believe a `WriteComment(string) error` method would be useful (but the string passed to it would be automatically prepended with the correct `w.w.Comment` rune.\r\n   not sure if `WriteComment` should be able to handle possible embedded `\\n` characters inside of the comment though (or multiline comments.)\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-12T08:31:44.442+0000",
                    "updated": "2019-03-12T08:31:44.442+0000",
                    "started": "2019-03-12T08:31:44.441+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "211577",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/211901",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anson627 commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r264805046\n \n \n\n ##########\n File path: go/arrow/csv/writer.go\n ##########\n @@ -127,3 +127,19 @@ func (w *Writer) Write(record array.Record) error {\n \n \treturn w.w.WriteAll(recs)\n }\n+\n+// WriteHeader writes a header as one row to the CSV file\n+func (w *Writer) WriteHeader(header string) error {\n \n Review comment:\n   Sorry I misunderstand header vs comment. Let me open a separate JIRA for comment and address separately.\r\n   \r\n   I will work on the WithHeader support\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-12T17:45:55.694+0000",
                    "updated": "2019-03-12T17:45:55.694+0000",
                    "started": "2019-03-12T17:45:55.693+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "211901",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/212756",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-471680893\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=h1) Report\n   > Merging [#3866](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/95d62caff4c352dba848221454d55c21b8857448?src=pr&el=desc) will **decrease** coverage by `0.16%`.\n   > The diff coverage is `80%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3866/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3866      +/-   ##\n   ==========================================\n   - Coverage   87.78%   87.62%   -0.17%     \n   ==========================================\n     Files         727      653      -74     \n     Lines       87892    82493    -5399     \n     Branches     1252        0    -1252     \n   ==========================================\n   - Hits        77158    72285    -4873     \n   + Misses      10616    10098     -518     \n   + Partials      118      110       -8\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/csv/writer.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3dyaXRlci5nbw==) | `91.13% <60%> (-4.52%)` | :arrow_down: |\n   | [go/arrow/csv/common.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L2NvbW1vbi5nbw==) | `75% <77.77%> (+0.53%)` | :arrow_up: |\n   | [go/arrow/csv/reader.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3JlYWRlci5nbw==) | `81.22% <85.36%> (+0.79%)` | :arrow_up: |\n   | [go/arrow/math/uint64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfc3NlNF9hbWQ2NC5nbw==) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X3NzZTRfYW1kNjQuZ28=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/memory/memory\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/int64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9pbnQ2NF9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [cpp/src/arrow/util/bpacking.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2JwYWNraW5nLmg=) | `99.84% <0%> (-0.01%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X2FtZDY0Lmdv) | `33.33% <0%> (\u00f8)` | :arrow_up: |\n   | [cpp/src/plasma/thirdparty/ae/ae.c](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9wbGFzbWEvdGhpcmRwYXJ0eS9hZS9hZS5j) | `72.03% <0%> (\u00f8)` | :arrow_up: |\n   | ... and [83 more](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=footer). Last update [95d62ca...e39affe](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-13T22:59:38.837+0000",
                    "updated": "2019-03-13T22:59:38.837+0000",
                    "started": "2019-03-13T22:59:38.837+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "212756",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213271",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anson627 commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-472971453\n \n \n   @sbinet I update the PR as what we discussed, can you help to take a look?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T17:16:37.877+0000",
                    "updated": "2019-03-14T17:16:37.877+0000",
                    "started": "2019-03-14T17:16:37.877+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213271",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213325",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265712103\n \n \n\n ##########\n File path: go/arrow/csv/writer.go\n ##########\n @@ -27,8 +28,9 @@ import (\n \n // Writer wraps encoding/csv.Writer and writes array.Record based on a schema.\n type Writer struct {\n-\tw      *csv.Writer\n-\tschema *arrow.Schema\n+\tw          *csv.Writer\n+\tschema     *arrow.Schema\n+\twithHeader bool\n \n Review comment:\n   ditto: I'd call it `header`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:06.993+0000",
                    "updated": "2019-03-14T18:37:06.993+0000",
                    "started": "2019-03-14T18:37:06.993+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213325",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213327",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265710279\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -76,6 +86,49 @@ func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n \treturn rr\n }\n \n+func (r *Reader) readHeader() error {\n+\trecords, err := r.r.Read()\n+\tif err != nil {\n+\t\treturn errors.New(\"failed to read file\")\n+\t}\n+\n+\tvar fields []arrow.Field\n+\tfor _, name := range records {\n \n Review comment:\n   I don't think that's the correct handling of the header.\r\n   AFAIK, CSV header lines just hint at the name of the column of data.\r\n   they don't say anything about the type of the column of data.\r\n   \r\n   _e.g._ I believe one could very well have to deal with headers like so:\r\n   ```\r\n   city;population\r\n   New-York;8,622,698\r\n   Chicago;2,000,001\r\n   ```\r\n   \r\n   so... all we can do is modify/update the name of the column.\r\n   what do you think?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:06.994+0000",
                    "updated": "2019-03-14T18:37:06.994+0000",
                    "started": "2019-03-14T18:37:06.994+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213327",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213326",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265708159\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -76,6 +86,49 @@ func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n \treturn rr\n }\n \n+func (r *Reader) readHeader() error {\n+\trecords, err := r.r.Read()\n+\tif err != nil {\n+\t\treturn errors.New(\"failed to read file\")\n \n Review comment:\n   I would create a global error value with a nice name and a nicer error message, specifying that we couldn't read the header.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:06.994+0000",
                    "updated": "2019-03-14T18:37:06.994+0000",
                    "started": "2019-03-14T18:37:06.993+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213326",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213328",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265710572\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -43,6 +45,8 @@ type Reader struct {\n \tnext  func() bool\n \n \tmem memory.Allocator\n+\n+\twithHeader bool\n \n Review comment:\n   I would just call it `header`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:06.996+0000",
                    "updated": "2019-03-14T18:37:06.996+0000",
                    "started": "2019-03-14T18:37:06.996+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213328",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213329",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265712594\n \n \n\n ##########\n File path: go/arrow/csv/writer.go\n ##########\n @@ -44,6 +46,12 @@ func NewWriter(w io.Writer, schema *arrow.Schema, opts ...Option) *Writer {\n \t\topt(ww)\n \t}\n \n+\tif ww.withHeader {\n+\t\tif err := ww.writeHeader(); err != nil {\n \n Review comment:\n   here as well, I'd opt for moving this to the `Write()` method, guarded with a `sync.Once`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:07.002+0000",
                    "updated": "2019-03-14T18:37:07.002+0000",
                    "started": "2019-03-14T18:37:07.002+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213329",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213330",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265707431\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -51,14 +55,20 @@ type Reader struct {\n // NewReader panics if the given schema contains fields that have types that are not\n // primitive types.\n func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n-\tvalidate(schema)\n-\n \trr := &Reader{r: csv.NewReader(r), schema: schema, refs: 1, chunk: 1}\n \trr.r.ReuseRecord = true\n \tfor _, opt := range opts {\n \t\topt(rr)\n \t}\n \n+\tif rr.withHeader {\n+\t\tif err := rr.readHeader(); err != nil {\n+\t\t\tpanic(fmt.Errorf(\"failed to read header %v\", err))\n+\t\t}\n+\t}\n+\n+\tvalidate(rr.schema)\n \n Review comment:\n   I would leave the schema validation where it was and only perform the \"readHeader\" part during the actual reading of the data.\r\n   this way, we can return the error, if any, instead of panicking.\r\n   \r\n   so, I'd put the call to `readHeader` inside `Next()`, guarded with a `sync.Once`.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T18:37:07.183+0000",
                    "updated": "2019-03-14T18:37:07.183+0000",
                    "started": "2019-03-14T18:37:07.182+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213330",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213411",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anson627 commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265762231\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -76,6 +86,49 @@ func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n \treturn rr\n }\n \n+func (r *Reader) readHeader() error {\n+\trecords, err := r.r.Read()\n+\tif err != nil {\n+\t\treturn errors.New(\"failed to read file\")\n+\t}\n+\n+\tvar fields []arrow.Field\n+\tfor _, name := range records {\n \n Review comment:\n   oh, I see, sorry for the misunderstanding! Previously I thought we want to encode/decode field type as header. Sounds good.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T20:54:55.116+0000",
                    "updated": "2019-03-14T20:54:55.116+0000",
                    "started": "2019-03-14T20:54:55.116+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213411",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213440",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265783682\n \n \n\n ##########\n File path: go/arrow/csv/writer.go\n ##########\n @@ -50,11 +53,20 @@ func NewWriter(w io.Writer, schema *arrow.Schema, opts ...Option) *Writer {\n func (w *Writer) Schema() *arrow.Schema { return w.schema }\n \n // Write writes a single Record as one row to the CSV file\n-func (w *Writer) Write(record array.Record) error {\n+func (w *Writer) Write(record array.Record) (err error) {\n \n Review comment:\n   named return values are always a bit error prone.\r\n   I'd just keep simply `error` (not `(err error)`) and define a `var err error` before the `if w.header` line.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T22:04:19.380+0000",
                    "updated": "2019-03-14T22:04:19.380+0000",
                    "started": "2019-03-14T22:04:19.380+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213440",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213441",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r265784061\n \n \n\n ##########\n File path: go/arrow/schema.go\n ##########\n @@ -112,9 +112,10 @@ func NewSchema(fields []Field, metadata *Metadata) *Schema {\n \treturn sc\n }\n \n-func (sc *Schema) Metadata() Metadata { return sc.meta }\n-func (sc *Schema) Fields() []Field    { return sc.fields }\n-func (sc *Schema) Field(i int) Field  { return sc.fields[i] }\n+func (sc *Schema) Metadata() Metadata           { return sc.meta }\n+func (sc *Schema) Fields() []Field              { return sc.fields }\n+func (sc *Schema) Field(i int) Field            { return sc.fields[i] }\n+func (sc *Schema) SetFieldName(i int, n string) { sc.fields[i].Name = n }\n \n Review comment:\n   done like this, this breaks the `FieldByName` method as we haven't updated the `index` field of `Schema`.\r\n   \r\n   perhaps the easiest (and preserve the \"functional, immutable\" aspect of `Schema`) way is to get rid of this `SetFieldName` method and just recreate a new Schema (with the new Field name) in the `Reader.readHeader` method.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T22:04:19.415+0000",
                    "updated": "2019-03-14T22:04:19.415+0000",
                    "started": "2019-03-14T22:04:19.415+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213441",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213454",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-471680893\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=h1) Report\n   > Merging [#3866](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/95d62caff4c352dba848221454d55c21b8857448?src=pr&el=desc) will **decrease** coverage by `0.08%`.\n   > The diff coverage is `72.5%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3866/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3866      +/-   ##\n   ==========================================\n   - Coverage   87.78%   87.69%   -0.09%     \n   ==========================================\n     Files         727      652      -75     \n     Lines       87892    83920    -3972     \n     Branches     1252        0    -1252     \n   ==========================================\n   - Hits        77158    73597    -3561     \n   + Misses      10616    10213     -403     \n   + Partials      118      110       -8\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/csv/reader.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3JlYWRlci5nbw==) | `79.7% <69.23%> (-0.73%)` | :arrow_down: |\n   | [go/arrow/csv/writer.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3dyaXRlci5nbw==) | `91.46% <71.42%> (-4.19%)` | :arrow_down: |\n   | [go/arrow/schema.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvc2NoZW1hLmdv) | `96.05% <75%> (-1.29%)` | :arrow_down: |\n   | [go/arrow/csv/common.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L2NvbW1vbi5nbw==) | `75% <77.77%> (+0.53%)` | :arrow_up: |\n   | [go/arrow/math/uint64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfc3NlNF9hbWQ2NC5nbw==) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X3NzZTRfYW1kNjQuZ28=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/memory/memory\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/int64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9pbnQ2NF9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [cpp/src/arrow/util/decimal.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2RlY2ltYWwuaA==) | `85.71% <0%> (-14.29%)` | :arrow_down: |\n   | [cpp/src/arrow/compute/logical\\_type.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jb21wdXRlL2xvZ2ljYWxfdHlwZS5jYw==) | `52.68% <0%> (-9.65%)` | :arrow_down: |\n   | ... and [338 more](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=footer). Last update [95d62ca...66daa0b](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-14T22:25:53.564+0000",
                    "updated": "2019-03-14T22:25:53.564+0000",
                    "started": "2019-03-14T22:25:53.564+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213454",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/213550",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-471680893\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=h1) Report\n   > Merging [#3866](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/95d62caff4c352dba848221454d55c21b8857448?src=pr&el=desc) will **decrease** coverage by `0.16%`.\n   > The diff coverage is `75.6%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3866/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3866      +/-   ##\n   ==========================================\n   - Coverage   87.78%   87.61%   -0.17%     \n   ==========================================\n     Files         727      653      -74     \n     Lines       87892    84058    -3834     \n     Branches     1252        0    -1252     \n   ==========================================\n   - Hits        77158    73651    -3507     \n   + Misses      10616    10297     -319     \n   + Partials      118      110       -8\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/csv/writer.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3dyaXRlci5nbw==) | `91.56% <71.42%> (-4.09%)` | :arrow_down: |\n   | [go/arrow/csv/reader.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3JlYWRlci5nbw==) | `80.19% <77.77%> (-0.24%)` | :arrow_down: |\n   | [go/arrow/csv/common.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L2NvbW1vbi5nbw==) | `75% <77.77%> (+0.53%)` | :arrow_up: |\n   | [go/arrow/math/uint64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfc3NlNF9hbWQ2NC5nbw==) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X3NzZTRfYW1kNjQuZ28=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/memory/memory\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/int64\\_sse4\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9pbnQ2NF9zc2U0X2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [cpp/src/arrow/compute/kernel.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jb21wdXRlL2tlcm5lbC5o) | `62.63% <0%> (-26.05%)` | :arrow_down: |\n   | [cpp/src/arrow/visitor.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy92aXNpdG9yLmg=) | `50% <0%> (-16.67%)` | :arrow_down: |\n   | [cpp/src/arrow/util/decimal.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2RlY2ltYWwuaA==) | `85.71% <0%> (-14.29%)` | :arrow_down: |\n   | ... and [342 more](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=footer). Last update [95d62ca...50ec667](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-15T03:53:12.673+0000",
                    "updated": "2019-03-15T03:53:12.673+0000",
                    "started": "2019-03-15T03:53:12.672+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "213550",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/214062",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anson627 commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-473453058\n \n \n   @sbinet ping\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-15T21:53:59.060+0000",
                    "updated": "2019-03-15T21:53:59.060+0000",
                    "started": "2019-03-15T21:53:59.059+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "214062",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/214210",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "sbinet commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r266196158\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -76,6 +80,28 @@ func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n \treturn rr\n }\n \n+func (r *Reader) readHeader() error {\n+\trecords, err := r.r.Read()\n+\tif err != nil {\n+\t\treturn ErrFailedFileRead\n \n Review comment:\n   I am not sure I am completely happy with this.\r\n   on the one hand, I'd like to clearly convey at which stage (header reading) the Reader failed.\r\n   but on the other hand, I'd also like to know why it failed.\r\n   \r\n   perhaps we should just use `github.com/pkg/errors.Wrapf` ?\r\n   WDYT?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-16T09:48:11.125+0000",
                    "updated": "2019-03-16T09:48:11.125+0000",
                    "started": "2019-03-16T09:48:11.125+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "214210",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/214453",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "anson627 commented on pull request #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#discussion_r266244943\n \n \n\n ##########\n File path: go/arrow/csv/reader.go\n ##########\n @@ -76,6 +80,28 @@ func NewReader(r io.Reader, schema *arrow.Schema, opts ...Option) *Reader {\n \treturn rr\n }\n \n+func (r *Reader) readHeader() error {\n+\trecords, err := r.r.Read()\n+\tif err != nil {\n+\t\treturn ErrFailedFileRead\n \n Review comment:\n   Agree, I added dependency on `github.com/pkg/errors` and used Wrapf to include the low level error, I also updated the message to make failure stage clear.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-17T15:33:52.395+0000",
                    "updated": "2019-03-17T15:33:52.395+0000",
                    "started": "2019-03-17T15:33:52.394+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "214453",
                    "issueId": "13218994"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/worklog/214463",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3866: ARROW-4734: [Go] Add option to write a header for CSV writer\nURL: https://github.com/apache/arrow/pull/3866#issuecomment-471680893\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=h1) Report\n   > Merging [#3866](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/95d62caff4c352dba848221454d55c21b8857448?src=pr&el=desc) will **decrease** coverage by `0.2%`.\n   > The diff coverage is `75.6%`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3866/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3866      +/-   ##\n   ==========================================\n   - Coverage   87.78%   87.58%   -0.21%     \n   ==========================================\n     Files         727      653      -74     \n     Lines       87892    84092    -3800     \n     Branches     1252        0    -1252     \n   ==========================================\n   - Hits        77158    73653    -3505     \n   + Misses      10616    10325     -291     \n   + Partials      118      114       -4\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/csv/writer.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3dyaXRlci5nbw==) | `91.56% <71.42%> (-4.09%)` | :arrow_down: |\n   | [go/arrow/csv/reader.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L3JlYWRlci5nbw==) | `80.19% <77.77%> (-0.24%)` | :arrow_down: |\n   | [go/arrow/csv/common.go](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Z28vYXJyb3cvY3N2L2NvbW1vbi5nbw==) | `75% <77.77%> (+0.53%)` | :arrow_up: |\n   | [cpp/src/arrow/compute/kernel.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jb21wdXRlL2tlcm5lbC5o) | `62.63% <0%> (-26.05%)` | :arrow_down: |\n   | [cpp/src/arrow/visitor.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy92aXNpdG9yLmg=) | `50% <0%> (-16.67%)` | :arrow_down: |\n   | [cpp/src/arrow/util/decimal.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2RlY2ltYWwuaA==) | `85.71% <0%> (-14.29%)` | :arrow_down: |\n   | [cpp/src/arrow/compute/logical\\_type.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jb21wdXRlL2xvZ2ljYWxfdHlwZS5jYw==) | `52.68% <0%> (-9.65%)` | :arrow_down: |\n   | [cpp/src/arrow/compute/expression.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jb21wdXRlL2V4cHJlc3Npb24uY2M=) | `40.1% <0%> (-7.23%)` | :arrow_down: |\n   | [cpp/src/arrow/visitor\\_inline.h](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy92aXNpdG9yX2lubGluZS5o) | `88.5% <0%> (-6.44%)` | :arrow_down: |\n   | [cpp/src/gandiva/tree\\_expr\\_builder.cc](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree#diff-Y3BwL3NyYy9nYW5kaXZhL3RyZWVfZXhwcl9idWlsZGVyLmNj) | `51.3% <0%> (-6.43%)` | :arrow_down: |\n   | ... and [333 more](https://codecov.io/gh/apache/arrow/pull/3866/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=footer). Last update [95d62ca...af73b2e](https://codecov.io/gh/apache/arrow/pull/3866?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-03-17T16:17:11.725+0000",
                    "updated": "2019-03-17T16:17:11.725+0000",
                    "started": "2019-03-17T16:17:11.724+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "214463",
                    "issueId": "13218994"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 11400,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@ad9e17a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@15b9a4dc[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@603fd79[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5e443621[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c5c9834[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@6f19b979[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@766869d6[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@9e2bc04[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@61170834[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4367b71e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@76f4407d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6a6ac03b[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 11400,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Mar 18 07:22:47 UTC 2019",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-03-18T07:22:47.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4734/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-03-01T19:36:54.000+0000",
        "updated": "2019-03-18T07:22:53.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 10m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 11400
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Go] Add option to write a header for CSV writer",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13218994/comment/16794801",
                    "id": "16794801",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=sbinet",
                        "name": "sbinet",
                        "key": "sbinet",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=sbinet&avatarId=36072",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sbinet&avatarId=36072",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sbinet&avatarId=36072",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sbinet&avatarId=36072"
                        },
                        "displayName": "Sebastien Binet",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 3866\n[https://github.com/apache/arrow/pull/3866]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=sbinet",
                        "name": "sbinet",
                        "key": "sbinet",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=sbinet&avatarId=36072",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=sbinet&avatarId=36072",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=sbinet&avatarId=36072",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=sbinet&avatarId=36072"
                        },
                        "displayName": "Sebastien Binet",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2019-03-18T07:22:47.090+0000",
                    "updated": "2019-03-18T07:22:47.090+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z00908:",
        "customfield_12314139": null
    }
}