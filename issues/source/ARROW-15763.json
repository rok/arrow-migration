{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13430175",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175",
    "key": "ARROW-15763",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12351051",
                "id": "12351051",
                "description": "",
                "name": "8.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2022-05-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=yibocai",
            "name": "yibocai",
            "key": "yibo",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=yibo&avatarId=47542",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yibo&avatarId=47542",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yibo&avatarId=47542",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yibo&avatarId=47542"
            },
            "displayName": "Yibo Cai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=yibocai",
            "name": "yibocai",
            "key": "yibo",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=yibo&avatarId=47542",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yibo&avatarId=47542",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yibo&avatarId=47542",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yibo&avatarId=47542"
            },
            "displayName": "Yibo Cai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=yibocai",
            "name": "yibocai",
            "key": "yibo",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=yibo&avatarId=47542",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=yibo&avatarId=47542",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=yibo&avatarId=47542",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=yibo&avatarId=47542"
            },
            "displayName": "Yibo Cai",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 28800,
            "total": 28800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 28800,
            "total": 28800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15763/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 48,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732084",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#issuecomment-1049435842\n\n\n   https://issues.apache.org/jira/browse/ARROW-15763\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T02:35:12.169+0000",
                    "updated": "2022-02-24T02:35:12.169+0000",
                    "started": "2022-02-24T02:35:12.169+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732084",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732089",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r813500124\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -170,11 +178,17 @@ class UnquotedColumnPopulator : public ColumnPopulator {\n       RETURN_NOT_OK(CheckStringArrayHasNoStructuralChars(*casted_array_, delimiter_));\n     }\n \n-    for (int x = 0; x < casted_array_->length(); x++) {\n-      row_lengths[x] += casted_array_->IsNull(x)\n-                            ? static_cast<int32_t>(null_string_->size())\n-                            : casted_array_->value_length(x);\n-    }\n\nReview comment:\n       `VisistArrayDataInline` processes continuous non-null / null blocks in batch and performs better than this bit by bit checking, though looks doing more work (extracts the string_view but only string length is needed).\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T02:40:17.160+0000",
                    "updated": "2022-02-24T02:40:17.160+0000",
                    "started": "2022-02-24T02:40:17.160+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732089",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732092",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#issuecomment-1049440543\n\n\n   Benchmark on xeon gold 5218, clang-12\r\n   ```\r\n   ---------------------\r\n   Non-regressions: (20)\r\n   ---------------------\r\n                      benchmark        baseline       contender  change %\r\n        WriteCsvStringNoQuote/0 680.119 MiB/sec   1.495 GiB/sec   125.081    'null_percent': 0.0\r\n        WriteCsvStringNoQuote/1 646.242 MiB/sec   1.347 GiB/sec   113.452    'null_percent': 1.0\r\n       WriteCsvStringNoQuote/10 576.935 MiB/sec   1.059 GiB/sec    87.873   'null_percent': 10.0\r\n       WriteCsvStringNoQuote/50 320.139 MiB/sec 454.702 MiB/sec    42.033   'null_percent': 50.0\r\n     WriteCsvStringWithQuote/10 323.390 MiB/sec 426.259 MiB/sec    31.810   'null_percent': 10.0\r\n    WriteCsvNumericCheckQuote/0 186.543 MiB/sec 233.563 MiB/sec    25.206    'null_percent': 0.0\r\n    WriteCsvNumericCheckQuote/1 178.710 MiB/sec 220.409 MiB/sec    23.333    'null_percent': 1.0\r\n   WriteCsvNumericCheckQuote/10 159.888 MiB/sec 192.138 MiB/sec    20.171   'null_percent': 10.0\r\n    WriteCsvStringRejectQuote/0   1.191 GiB/sec   1.415 GiB/sec    18.837    'null_percent': 0.0\r\n   WriteCsvNumericCheckQuote/50  92.471 MiB/sec 104.572 MiB/sec    13.086   'null_percent': 50.0\r\n              WriteCsvNumeric/0 164.814 MiB/sec 174.640 MiB/sec     5.962    'null_percent': 0.0\r\n    WriteCsvStringRejectQuote/1   1.153 GiB/sec   1.218 GiB/sec     5.664    'null_percent': 1.0\r\n     WriteCsvStringWithQuote/50 275.784 MiB/sec 286.287 MiB/sec     3.809   'null_percent': 50.0\r\n      WriteCsvStringWithQuote/0 465.196 MiB/sec 476.836 MiB/sec     2.502    'null_percent': 0.0\r\n   WriteCsvStringRejectQuote/50 403.224 MiB/sec 411.146 MiB/sec     1.965   'null_percent': 50.0\r\n             WriteCsvNumeric/50  87.601 MiB/sec  88.467 MiB/sec     0.989   'null_percent': 50.0\r\n      WriteCsvStringWithQuote/1 453.827 MiB/sec 455.022 MiB/sec     0.263    'null_percent': 1.0\r\n              WriteCsvNumeric/1 163.118 MiB/sec 162.101 MiB/sec    -0.624    'null_percent': 1.0\r\n             WriteCsvNumeric/10 145.664 MiB/sec 142.291 MiB/sec    -2.316   'null_percent': 10.0\r\n   WriteCsvStringRejectQuote/10 979.231 MiB/sec 936.657 MiB/sec    -4.348   'null_percent': 10.0\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T02:46:38.128+0000",
                    "updated": "2022-02-24T02:46:38.128+0000",
                    "started": "2022-02-24T02:46:38.128+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732092",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732093",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#issuecomment-1049441572\n\n\n   Benchmark on neoverse n1, clang-12\r\n   ```\r\n   ---------------------\r\n   Non-regressions: (20)\r\n   ---------------------\r\n                      benchmark        baseline       contender  change %\r\n        WriteCsvStringNoQuote/0 675.934 MiB/sec   1.304 GiB/sec    97.523   'null_percent': 0.0\r\n        WriteCsvStringNoQuote/1 645.460 MiB/sec   1.206 GiB/sec    91.368   'null_percent': 1.0\r\n       WriteCsvStringNoQuote/10 583.017 MiB/sec 981.308 MiB/sec    68.316  'null_percent': 10.0\r\n       WriteCsvStringNoQuote/50 345.953 MiB/sec 464.440 MiB/sec    34.249  'null_percent': 50.0\r\n    WriteCsvNumericCheckQuote/0 196.353 MiB/sec 241.285 MiB/sec    22.883   'null_percent': 0.0\r\n    WriteCsvNumericCheckQuote/1 190.527 MiB/sec 229.677 MiB/sec    20.548   'null_percent': 1.0\r\n   WriteCsvNumericCheckQuote/10 174.117 MiB/sec 204.907 MiB/sec    17.684  'null_percent': 10.0\r\n    WriteCsvStringRejectQuote/0 998.643 MiB/sec   1.129 GiB/sec    15.786   'null_percent': 0.0\r\n   WriteCsvNumericCheckQuote/50 104.152 MiB/sec 116.598 MiB/sec    11.949  'null_percent': 50.0\r\n   WriteCsvStringRejectQuote/50 408.427 MiB/sec 452.847 MiB/sec    10.876  'null_percent': 50.0\r\n     WriteCsvStringWithQuote/10 339.292 MiB/sec 371.360 MiB/sec     9.451  'null_percent': 10.0\r\n    WriteCsvStringRejectQuote/1 980.232 MiB/sec   1.039 GiB/sec     8.532   'null_percent': 1.0\r\n   WriteCsvStringRejectQuote/10 840.288 MiB/sec 901.794 MiB/sec     7.320  'null_percent': 10.0\r\n             WriteCsvNumeric/50  96.203 MiB/sec 102.765 MiB/sec     6.821  'null_percent': 50.0\r\n      WriteCsvStringWithQuote/1 421.020 MiB/sec 444.353 MiB/sec     5.542   'null_percent': 1.0\r\n              WriteCsvNumeric/0 169.933 MiB/sec 178.323 MiB/sec     4.937   'null_percent': 0.0\r\n              WriteCsvNumeric/1 166.580 MiB/sec 170.426 MiB/sec     2.309   'null_percent': 1.0\r\n     WriteCsvStringWithQuote/50 286.035 MiB/sec 292.085 MiB/sec     2.115  'null_percent': 50.0\r\n             WriteCsvNumeric/10 151.705 MiB/sec 154.560 MiB/sec     1.882  'null_percent': 10.0\r\n      WriteCsvStringWithQuote/0 455.511 MiB/sec 456.726 MiB/sec     0.267   'null_percent': 0.0\r\n   ```\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T02:49:03.720+0000",
                    "updated": "2022-02-24T02:49:03.720+0000",
                    "started": "2022-02-24T02:49:03.720+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732093",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732100",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r813509167\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -81,7 +81,15 @@ RecordBatchIterator RecordBatchSliceIterator(const RecordBatch& batch,\n \n // Counts the number of quotes in s.\n int64_t CountQuotes(arrow::util::string_view s) {\n-  return static_cast<int64_t>(std::count(s.begin(), s.end(), '\"'));\n+  // std::count uses 64 bit counter, not necessary for StringType\n+  // 32 bit counter performs much better\n\nReview comment:\n       Probably due to more efficient using of simd registers.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T03:04:23.142+0000",
                    "updated": "2022-02-24T03:04:23.142+0000",
                    "started": "2022-02-24T03:04:23.142+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732100",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732102",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r813510537\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -265,24 +279,41 @@ class QuotedColumnPopulator : public ColumnPopulator {\n \n   Status UpdateRowLengths(int32_t* row_lengths) override {\n     const StringArray& input = *casted_array_;\n-    int row_number = 0;\n-    row_needs_escaping_.resize(casted_array_->length());\n-    VisitArrayDataInline<StringType>(\n-        *input.data(),\n-        [&](arrow::util::string_view s) {\n-          // Each quote in the value string needs to be escaped.\n-          int64_t escaped_count = CountQuotes(s);\n-          // TODO: Maybe use 64 bit row lengths or safe cast?\n-          row_needs_escaping_[row_number] = escaped_count > 0;\n-          row_lengths[row_number] += static_cast<int32_t>(s.length()) +\n-                                     static_cast<int32_t>(escaped_count + kQuoteCount);\n-          row_number++;\n-        },\n-        [&]() {\n-          row_needs_escaping_[row_number] = false;\n-          row_lengths[row_number] += static_cast<int32_t>(null_string_->size());\n-          row_number++;\n-        });\n+\n+    row_needs_escaping_.resize(casted_array_->length(), false);\n+\n+    if (NoQuoteInArray(input)) {\n\nReview comment:\n       Scan whole string array for quote in batch. Go fast path if there's no quote.\r\n   It does introduces some overhead when there is quote in the array. Benchmark doesn't show regression as improvement in CountQuotes compensated it.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T03:08:29.846+0000",
                    "updated": "2022-02-24T03:08:29.846+0000",
                    "started": "2022-02-24T03:08:29.845+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732102",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732104",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r813512570\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer_test.cc\n##########\n@@ -240,6 +241,10 @@ std::vector<WriterTestParams> GenerateTestCases() {\n       reject_structural_params({nullptr, \"a\", nullptr, \"c,d\", nullptr, \",e\", \"f\"}, \"c,d\"),\n       reject_structural_params({\"a\", \"b\", nullptr, \"c,d\", nullptr, nullptr}, \"c,d\"),\n       // exercise simd code with strings total length >= 16\n+      {abc_schema, populated_batch,\n+       DefaultTestOptions(/*include_header=*/false, \"\", QuotingStyle::AllValid, \"\\n\", ',',\n+                          /*batch_size=*/100),\n\nReview comment:\n       Process test data [1] as a single batch (batch_size > rows) so the string array size > 16.\r\n   [1] https://github.com/apache/arrow/blob/master/cpp/src/arrow/csv/writer_test.cc#L101\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T03:14:45.736+0000",
                    "updated": "2022-02-24T03:14:45.736+0000",
                    "started": "2022-02-24T03:14:45.736+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732104",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732716",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814297936\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n\nReview comment:\n       should we have a predessor loop that loops until alignment so we can then do aligned values here?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T21:51:32.985+0000",
                    "updated": "2022-02-24T21:51:32.985+0000",
                    "started": "2022-02-24T21:51:32.985+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732716",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732717",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814301794\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n\nReview comment:\n       Have we defined standard for using XSIMD?  We can achieve similar results with slightly modified code: https://godbolt.org/z/qeM3YEYzK\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T21:57:26.525+0000",
                    "updated": "2022-02-24T21:57:26.525+0000",
                    "started": "2022-02-24T21:57:26.524+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732717",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732718",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814301794\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n\nReview comment:\n       Have we defined standard for using XSIMD?  We can achieve similar results with slightly modified code: https://godbolt.org/z/qeM3YEYzK without ifdefs?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T21:57:38.986+0000",
                    "updated": "2022-02-24T21:57:38.986+0000",
                    "started": "2022-02-24T21:57:38.986+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732718",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732719",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814302649\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -81,7 +81,15 @@ RecordBatchIterator RecordBatchSliceIterator(const RecordBatch& batch,\n \n // Counts the number of quotes in s.\n int64_t CountQuotes(arrow::util::string_view s) {\n-  return static_cast<int64_t>(std::count(s.begin(), s.end(), '\"'));\n+  // std::count uses 64 bit counter, not necessary for StringType\n\nReview comment:\n       What about LargeString?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T21:58:46.801+0000",
                    "updated": "2022-02-24T21:58:46.801+0000",
                    "started": "2022-02-24T21:58:46.800+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732719",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732725",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814305971\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n\nReview comment:\n       https://godbolt.org/z/o3dWdrqqz makes use of count quote.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T22:04:02.308+0000",
                    "updated": "2022-02-24T22:04:02.308+0000",
                    "started": "2022-02-24T22:04:02.308+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732725",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732727",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814307720\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n+      if (xsimd::any(v == '\"')) {\n+        return false;\n+      }\n+      offset += 16;\n+    }\n+#endif\n+    while (offset < buffer_size) {\n+      if (data[offset] == '\"') {\n\nReview comment:\n       I think it might be the same to use CountQuote here?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T22:06:58.577+0000",
                    "updated": "2022-02-24T22:06:58.577+0000",
                    "started": "2022-02-24T22:06:58.577+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732727",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732728",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814308037\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -170,11 +178,17 @@ class UnquotedColumnPopulator : public ColumnPopulator {\n       RETURN_NOT_OK(CheckStringArrayHasNoStructuralChars(*casted_array_, delimiter_));\n     }\n \n-    for (int x = 0; x < casted_array_->length(); x++) {\n-      row_lengths[x] += casted_array_->IsNull(x)\n-                            ? static_cast<int32_t>(null_string_->size())\n-                            : casted_array_->value_length(x);\n-    }\n\nReview comment:\n       Nice fix, not sure why I didn't use this initially.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T22:07:21.385+0000",
                    "updated": "2022-02-24T22:07:21.385+0000",
                    "started": "2022-02-24T22:07:21.385+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732728",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732729",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814309331\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -265,24 +279,41 @@ class QuotedColumnPopulator : public ColumnPopulator {\n \n   Status UpdateRowLengths(int32_t* row_lengths) override {\n     const StringArray& input = *casted_array_;\n-    int row_number = 0;\n-    row_needs_escaping_.resize(casted_array_->length());\n-    VisitArrayDataInline<StringType>(\n-        *input.data(),\n-        [&](arrow::util::string_view s) {\n-          // Each quote in the value string needs to be escaped.\n-          int64_t escaped_count = CountQuotes(s);\n-          // TODO: Maybe use 64 bit row lengths or safe cast?\n-          row_needs_escaping_[row_number] = escaped_count > 0;\n-          row_lengths[row_number] += static_cast<int32_t>(s.length()) +\n-                                     static_cast<int32_t>(escaped_count + kQuoteCount);\n-          row_number++;\n-        },\n-        [&]() {\n-          row_needs_escaping_[row_number] = false;\n-          row_lengths[row_number] += static_cast<int32_t>(null_string_->size());\n-          row_number++;\n-        });\n+\n+    row_needs_escaping_.resize(casted_array_->length(), false);\n+\n+    if (NoQuoteInArray(input)) {\n\nReview comment:\n       It is surprising the fast path helps here.  is that because the visitor can now generate simd for the fast path?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-24T22:09:16.962+0000",
                    "updated": "2022-02-24T22:09:16.962+0000",
                    "started": "2022-02-24T22:09:16.961+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732729",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732800",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814405967\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -265,24 +279,41 @@ class QuotedColumnPopulator : public ColumnPopulator {\n \n   Status UpdateRowLengths(int32_t* row_lengths) override {\n     const StringArray& input = *casted_array_;\n-    int row_number = 0;\n-    row_needs_escaping_.resize(casted_array_->length());\n-    VisitArrayDataInline<StringType>(\n-        *input.data(),\n-        [&](arrow::util::string_view s) {\n-          // Each quote in the value string needs to be escaped.\n-          int64_t escaped_count = CountQuotes(s);\n-          // TODO: Maybe use 64 bit row lengths or safe cast?\n-          row_needs_escaping_[row_number] = escaped_count > 0;\n-          row_lengths[row_number] += static_cast<int32_t>(s.length()) +\n-                                     static_cast<int32_t>(escaped_count + kQuoteCount);\n-          row_number++;\n-        },\n-        [&]() {\n-          row_needs_escaping_[row_number] = false;\n-          row_lengths[row_number] += static_cast<int32_t>(null_string_->size());\n-          row_number++;\n-        });\n+\n+    row_needs_escaping_.resize(casted_array_->length(), false);\n+\n+    if (NoQuoteInArray(input)) {\n\nReview comment:\n       Profiling shows the original hotspot is counting quotes in string_view for each iteration. Fast path doesn't count quotes.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-25T01:27:18.282+0000",
                    "updated": "2022-02-25T01:27:18.282+0000",
                    "started": "2022-02-25T01:27:18.282+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732800",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732807",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814418677\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n\nReview comment:\n       No obvious difference for aligned access per my test, probably because this code is not the hotspot.\r\n   That said, unaligned loading does have observable penalty for trivial code, e.g., https://quick-bench.com/q/MLvhY9_3IRZK0UR66DL1KFOF0xc\r\n   \r\n   We don't have standard for using xsimd.\r\n   \r\n   Yes we can leverage compiler auto-vectorization to avoid explicit simd code. Like your example, compiler is able to vectorize `std::count` like code pretty well. One reason I'm using xsimd here is there's already a similar optimization in csv writer to find string cell with illegal chars: https://github.com/apache/arrow/blob/master/cpp/src/arrow/csv/writer.cc#L213-L249\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-25T02:00:52.290+0000",
                    "updated": "2022-02-25T02:00:52.290+0000",
                    "started": "2022-02-25T02:00:52.290+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732807",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732810",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814420890\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -328,6 +359,31 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   }\n \n  private:\n+  // Returns true if there's no quote in the string array\n+  // similar to std::find, but with much better performance\n+  static bool NoQuoteInArray(const StringArray& array) {\n+    const uint8_t* const data = array.raw_data() + array.value_offset(0);\n+    const int64_t buffer_size = array.total_values_length();\n+    int64_t offset = 0;\n+#if defined(ARROW_HAVE_SSE4_2) || defined(ARROW_HAVE_NEON)\n+    using simd_batch = xsimd::make_sized_batch_t<uint8_t, 16>;\n+    while ((offset + 16) <= buffer_size) {\n+      const auto v = simd_batch::load_unaligned(data + offset);\n+      if (xsimd::any(v == '\"')) {\n+        return false;\n+      }\n+      offset += 16;\n+    }\n+#endif\n+    while (offset < buffer_size) {\n+      if (data[offset] == '\"') {\n\nReview comment:\n       Will revisit this function, together with the above simd code, to see if we can get a simpler code without performance loss.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-25T02:07:06.564+0000",
                    "updated": "2022-02-25T02:07:06.564+0000",
                    "started": "2022-02-25T02:07:06.564+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732810",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/732834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814444011\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -81,7 +81,15 @@ RecordBatchIterator RecordBatchSliceIterator(const RecordBatch& batch,\n \n // Counts the number of quotes in s.\n int64_t CountQuotes(arrow::util::string_view s) {\n-  return static_cast<int64_t>(std::count(s.begin(), s.end(), '\"'));\n+  // std::count uses 64 bit counter, not necessary for StringType\n\nReview comment:\n       An easy approach might be to check s.size(), if it can fit in 32 bits, go the 32 bit code, otherwise call std::count directly.\r\n   Per my test, there's no performance loss, probably because the branch is almost always correctly predicted.\r\n   Will try refine this code, at least it should static_assert if we use LargeString.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-25T03:13:55.467+0000",
                    "updated": "2022-02-25T03:13:55.467+0000",
                    "started": "2022-02-25T03:13:55.467+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "732834",
                    "issueId": "13430175"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/worklog/733003",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "cyb70289 commented on a change in pull request #12504:\nURL: https://github.com/apache/arrow/pull/12504#discussion_r814666866\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -81,7 +81,15 @@ RecordBatchIterator RecordBatchSliceIterator(const RecordBatch& batch,\n \n // Counts the number of quotes in s.\n int64_t CountQuotes(arrow::util::string_view s) {\n-  return static_cast<int64_t>(std::count(s.begin(), s.end(), '\"'));\n+  // std::count uses 64 bit counter, not necessary for StringType\n\nReview comment:\n       Restored to `std::count`. The improvement is not obvious overall, not deserves the effort.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-02-25T10:47:22.728+0000",
                    "updated": "2022-02-25T10:47:22.728+0000",
                    "started": "2022-02-25T10:47:22.727+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "733003",
                    "issueId": "13430175"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 28800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6375f17c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@253d675a[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@464114ec[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@808bcc9[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3b87c904[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2e3769b9[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@601feee7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2d3cf8d9[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2876cb93[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@3d191585[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@22eeac17[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@685e72a3[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 28800,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 01 13:26:21 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2022-03-01T13:26:21.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15763/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2022-02-23T10:18:48.000+0000",
        "updated": "2022-03-01T21:12:18.000+0000",
        "timeoriginalestimate": null,
        "description": "Profiling shows for string inputs, csv writer spends most of the time in counting quotes for every string, this can probably be improved by checking quotes before-ahead in batch.\r\nFor numeric inputs, the casting (number -> string) dominates the performance.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "8h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 28800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Improve csv writer",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13430175/comment/17499533",
                    "id": "17499533",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 12504\n[https://github.com/apache/arrow/pull/12504]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2022-03-01T13:26:21.825+0000",
                    "updated": "2022-03-01T13:26:21.825+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0zv5s:",
        "customfield_12314139": null
    }
}