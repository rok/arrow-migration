{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13340069",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069",
    "key": "ARROW-10561",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12348823",
                "id": "12348823",
                "description": "",
                "name": "3.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-01-25"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333773",
                "id": "12333773",
                "name": "Rust"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
            "name": "jorgecarleitao",
            "key": "jorgecarleitao",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
            },
            "displayName": "Jorge Leit\u00e3o",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12600,
            "total": 12600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10561/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 21,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510512",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao opened a new pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645\n\n\n   This PR addresses 3 small issues on `MutableBuffer`:\r\n   \r\n   1. `write_bytes` is incorrect, as it double-increments `len`: the length is incremented both on `self.write` and also by `write_bytes` itself. This leads to more allocations than necessary.\r\n   2. `write` is implemented from the trait `io::Write`. However, this trait is suitable for fallible IO operations. In the case of a write to memory, it isn't really fallible because we can always call `reserve` to allocate more space.\r\n   3. `write` and `write_bytes` are really similar.\r\n   \r\n   This PR replaces both `write_bytes` and `write` by `extend_from_slice` (inspired by [`Vec::extend_from_slice`](https://doc.rust-lang.org/std/vec/struct.Vec.html#method.extend_from_slice). This has the same performance (a single capacity comparison) or better. Compared to the current code, the main difference is that this is infallible as it `reserve` more space if the required size is insufficient.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-11T23:36:37.630+0000",
                    "updated": "2020-11-11T23:36:37.630+0000",
                    "started": "2020-11-11T23:36:37.630+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510512",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510522",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-725727007\n\n\n   https://issues.apache.org/jira/browse/ARROW-10561\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-11T23:46:36.016+0000",
                    "updated": "2020-11-11T23:46:36.016+0000",
                    "started": "2020-11-11T23:46:36.015+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510522",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510654",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-725910876\n\n\n   @alamb @jhorstmann @vertexclique , I think I need your help here. This change is causing a segfault in one of the benchmarks, even though I have not changed any unsafe code and think the change is reasonable.\r\n   \r\n   I narrowed it down to the function `set_bits_raw`. I think that this function is accessing a byte too many. However, my bit knowledge is limited here. I filled ARROW-10562 with why I think the function has an issue. IMO the reason this has not surfaced before is that we were allocating too much memory in the boolean buffers, and thus the memory address was fine.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T08:03:25.498+0000",
                    "updated": "2020-11-12T08:03:25.498+0000",
                    "started": "2020-11-12T08:03:25.498+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510654",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510655",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-725910876\n\n\n   @alamb @jhorstmann @vertexclique , I think I need your help here. This change is causing a segfault in one of the benchmarks, even though I have not changed any unsafe code and think the change is reasonable.\r\n   \r\n   I narrowed it down to the function `set_bits_raw`. I think that this function is accessing a byte too many. However, my bit knowledge is limited here. I filled ARROW-10562 with why I think the function has an issue. IMO the reason this has not surfaced before is that we were allocating too much memory in the boolean buffers, and thus the memory address was fine.\r\n   \r\n   (IMO we should just make that thing safe...)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T08:04:22.606+0000",
                    "updated": "2020-11-12T08:04:22.606+0000",
                    "started": "2020-11-12T08:04:22.606+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510655",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510684",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vertexclique commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-725957761\n\n\n   My suggestion for this is merging https://github.com/apache/arrow/pull/8634 then implementing bit ops over that interface. And get rid of bit_util.rs. That's going to remove all these issues in a single shot. \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T09:29:36.465+0000",
                    "updated": "2020-11-12T09:29:36.465+0000",
                    "started": "2020-11-12T09:29:36.465+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510684",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510688",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "vertexclique edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-725957761\n\n\n   My suggestion for this is merging https://github.com/apache/arrow/pull/8598 then implementing bit ops over that interface. And get rid of bit_util.rs. That's going to remove all these issues in a single shot. \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T09:40:46.625+0000",
                    "updated": "2020-11-12T09:40:46.625+0000",
                    "started": "2020-11-12T09:40:46.625+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510688",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510725",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jhorstmann commented on a change in pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#discussion_r522001562\n\n\n\n##########\nFile path: rust/arrow/src/array/builder.rs\n##########\n@@ -397,18 +396,9 @@ impl<T: ArrowPrimitiveType> BufferBuilder<T> {\n     /// Writes a byte slice to the underlying buffer and updates the `len`, i.e. the\n     /// number array elements in the builder.  Also, converts the `io::Result`\n     /// required by the `Write` trait to the Arrow `Result` type.\n-    fn write_bytes(&mut self, bytes: &[u8], len_added: usize) -> Result<()> {\n-        let write_result = self.buffer.write(bytes);\n-        // `io::Result` has many options one of which we use, so pattern matching is\n-        // overkill here\n-        if write_result.is_err() {\n-            Err(ArrowError::MemoryError(\n-                \"Could not write to Buffer, not big enough\".to_string(),\n-            ))\n-        } else {\n-            self.len += len_added;\n-            Ok(())\n-        }\n+    fn write_bytes(&mut self, bytes: &[u8], len_added: usize) {\n\nReview comment:\n       @jorgecarleitao My guess would be that the issue is related to this `len_added` parameter. In the filter kernel this was used for additional padding, most other users probably interpreted this as the length of the bytes array. I would suggest removing this parameter, since you already implemented a workaround in the filter kernel.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T10:31:47.649+0000",
                    "updated": "2020-11-12T10:31:47.649+0000",
                    "started": "2020-11-12T10:31:47.648+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510725",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/510731",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jhorstmann commented on a change in pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#discussion_r522016134\n\n\n\n##########\nFile path: rust/arrow/src/array/builder.rs\n##########\n@@ -525,7 +515,7 @@ impl<T: ArrowPrimitiveType> ArrayBuilder for PrimitiveBuilder<T> {\n                 let sliced = array.buffers()[0].data();\n                 // slice into data by factoring (offset and length) * byte width\n                 self.values_builder\n-                    .write_bytes(&sliced[(offset * mul)..((len + offset) * mul)], len)?;\n+                    .write_bytes(&sliced[(offset * mul)..((len + offset) * mul)], len);\n\nReview comment:\n       I couldn't reproduce the issue yet, but this line looks a bit suspicious. The first parameter has a larger len (in bytes) than the second `len` parameter indicates (number of `T` elements).\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-12T10:55:11.887+0000",
                    "updated": "2020-11-12T10:55:11.887+0000",
                    "started": "2020-11-12T10:55:11.887+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "510731",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511198",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726510728\n\n\n   Ok, I confirm that this error is due to a wrong byte offset on the `set_bits_raw` and that this undefined behavior is already present in `master`:\r\n   \r\n   ```\r\n   Switched to branch 'master'\r\n   Your branch is up to date with 'upstream/master'.\r\n      Compiling arrow v3.0.0-SNAPSHOT (/Users/jorgecarleitao/projects/arrow/rust/arrow)\r\n       Finished bench [optimized] target(s) in 53.79s\r\n        Running /Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c\r\n   Gnuplot not found, using plotters backend\r\n   bench_primitive         time:   [522.83 us 523.58 us 524.34 us]                            \r\n                           thrpt:  [7.4499 GiB/s 7.4607 GiB/s 7.4713 GiB/s]\r\n                    change:\r\n                           time:   [-6.7844% -4.8815% -3.0463%] (p = 0.00 < 0.05)\r\n                           thrpt:  [+3.1420% +5.1320% +7.2782%]\r\n                           Performance has improved.\r\n   Found 9 outliers among 100 measurements (9.00%)\r\n     3 (3.00%) high mild\r\n     6 (6.00%) high severe\r\n   \r\n   Benchmarking bench_bool: Warming up for 3.0000 serror: process didn't exit successfully: `/Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c --bench` (signal: 11, SIGSEGV: invalid memory reference)\r\n   ```\r\n   \r\n   This PR removes now also removes that function altogether and replaces it by a safe counterpart. I suspect that there will be a performance regression, but I do not know enough of bit operations to be able to fix the function (and it is not clear whether we should, as per @vertexclique suggestion of using `bitvec`).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T04:52:37.298+0000",
                    "updated": "2020-11-13T04:52:37.298+0000",
                    "started": "2020-11-13T04:52:37.298+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511198",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511204",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726510728\n\n\n   Ok, I confirm that this error is due to a wrong pointer offset on the `set_bits_raw` and that this undefined behavior is already present in `master`:\r\n   \r\n   ```\r\n   Switched to branch 'master'\r\n   Your branch is up to date with 'upstream/master'.\r\n      Compiling arrow v3.0.0-SNAPSHOT (/Users/jorgecarleitao/projects/arrow/rust/arrow)\r\n       Finished bench [optimized] target(s) in 53.79s\r\n        Running /Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c\r\n   Gnuplot not found, using plotters backend\r\n   bench_primitive         time:   [522.83 us 523.58 us 524.34 us]                            \r\n                           thrpt:  [7.4499 GiB/s 7.4607 GiB/s 7.4713 GiB/s]\r\n                    change:\r\n                           time:   [-6.7844% -4.8815% -3.0463%] (p = 0.00 < 0.05)\r\n                           thrpt:  [+3.1420% +5.1320% +7.2782%]\r\n                           Performance has improved.\r\n   Found 9 outliers among 100 measurements (9.00%)\r\n     3 (3.00%) high mild\r\n     6 (6.00%) high severe\r\n   \r\n   Benchmarking bench_bool: Warming up for 3.0000 serror: process didn't exit successfully: `/Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c --bench` (signal: 11, SIGSEGV: invalid memory reference)\r\n   ```\r\n   \r\n   This PR removes now also removes that function altogether and replaces it by a safe counterpart. I suspect that there will be a performance regression, but I do not know enough of bit operations to be able to fix the function (and it is not clear whether we should, as per @vertexclique suggestion of using `bitvec`).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T05:06:11.859+0000",
                    "updated": "2020-11-13T05:06:11.859+0000",
                    "started": "2020-11-13T05:06:11.858+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511204",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511205",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726510728\n\n\n   Ok, I confirm that this error is due to a wrong pointer offset on the `set_bits_raw` and that this undefined behavior is already present in `master`:\r\n   \r\n   ```\r\n   Switched to branch 'master'\r\n   Your branch is up to date with 'upstream/master'.\r\n      Compiling arrow v3.0.0-SNAPSHOT (/Users/jorgecarleitao/projects/arrow/rust/arrow)\r\n       Finished bench [optimized] target(s) in 53.79s\r\n        Running /Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c\r\n   Gnuplot not found, using plotters backend\r\n   bench_primitive         time:   [522.83 us 523.58 us 524.34 us]                            \r\n                           thrpt:  [7.4499 GiB/s 7.4607 GiB/s 7.4713 GiB/s]\r\n                    change:\r\n                           time:   [-6.7844% -4.8815% -3.0463%] (p = 0.00 < 0.05)\r\n                           thrpt:  [+3.1420% +5.1320% +7.2782%]\r\n                           Performance has improved.\r\n   Found 9 outliers among 100 measurements (9.00%)\r\n     3 (3.00%) high mild\r\n     6 (6.00%) high severe\r\n   \r\n   Benchmarking bench_bool: Warming up for 3.0000 serror: process didn't exit successfully: `/Users/jorgecarleitao/projects/arrow/rust/target/release/deps/builder-65ece1c06584e62c --bench` (signal: 11, SIGSEGV: invalid memory reference)\r\n   ```\r\n   \r\n   This PR now also removes that function altogether and replaces it by a safe counterpart. I suspect that there will be a performance regression, but I do not know enough of bit operations to be able to fix the function (and it is not clear whether we should, as per @vertexclique suggestion of using `bitvec`).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T05:06:34.911+0000",
                    "updated": "2020-11-13T05:06:34.911+0000",
                    "started": "2020-11-13T05:06:34.910+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511205",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511321",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726724609\n\n\n   I am going to take another hard look at https://github.com/apache/arrow/pull/8598 and see if we can get enough consensus to get it merged\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T11:56:22.717+0000",
                    "updated": "2020-11-13T11:56:22.717+0000",
                    "started": "2020-11-13T11:56:22.716+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511321",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511326",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726736494\n\n\n   In terms of evidence that there is a problem on master, I ran the arrow test suite under `valgind` @ 30516049522c1a527ffb375e7790102f58edb4f9 on master and it does flag an invalid read (that could cause a segfault depending on the circumstances). Here is the error it flagged:\r\n   \r\n   ```\r\n   test compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8 ... ==5483== Invalid read of size 1\r\n   ==5483==    at 0x55D7B2: arrow::util::bit_util::set_bits_raw (bit_util.rs:128)\r\n   ==5483==    by 0x605D49: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::append_n (builder.rs:339)\r\n   ==5483==    by 0x62C854: arrow::array::builder::PrimitiveBuilder<T>::append_slice (builder.rs:591)\r\n   ==5483==    by 0xA992F6: arrow::array::builder::StringBuilder::append_value (builder.rs:1781)\r\n   ==5483==    by 0x6A309B: arrow::array::builder::StringDictionaryBuilder<K>::append (builder.rs:2435)\r\n   ==5483==    by 0x302DA3: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8 (cast.rs:2612)\r\n   ==5483==    by 0x31E499: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8::{{closure}} (cast.rs:2598)\r\n   ==5483==    by 0xA751ED: core::ops::function::FnOnce::call_once (function.rs:232)\r\n   ==5483==    by 0xB97365: call_once<(),FnOnce<()>> (boxed.rs:1008)\r\n   ==5483==    by 0xB97365: call_once<(),alloc::boxed::Box<FnOnce<()>>> (panic.rs:318)\r\n   ==5483==    by 0xB97365: do_call<std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>,()> (panicking.rs:331)\r\n   ==5483==    by 0xB97365: try<(),std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>> (panicking.rs:274)\r\n   ==5483==    by 0xB97365: catch_unwind<std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>,()> (panic.rs:394)\r\n   ==5483==    by 0xB97365: run_test_in_process (lib.rs:541)\r\n   ==5483==    by 0xB97365: test::run_test::run_test_inner::{{closure}} (lib.rs:450)\r\n   ==5483==    by 0xB969F8: test::run_test::run_test_inner (lib.rs:475)\r\n   ==5483==    by 0xB94BE9: test::run_test (lib.rs:505)\r\n   ==5483==    by 0xB829D8: run_tests<closure-2> (lib.rs:284)\r\n   ==5483==    by 0xB829D8: test::console::run_tests_console (console.rs:280)\r\n   ==5483==  Address 0x65c1900 is 0 bytes after a block of size 128 alloc'd\r\n   ==5483==    at 0x4C34443: memalign (vg_replace_malloc.c:906)\r\n   ==5483==    by 0x4C34546: posix_memalign (vg_replace_malloc.c:1070)\r\n   ==5483==    by 0xEB42F3: aligned_malloc (alloc.rs:95)\r\n   ==5483==    by 0xEB42F3: alloc (alloc.rs:22)\r\n   ==5483==    by 0xEB42F3: realloc_fallback (alloc.rs:39)\r\n   ==5483==    by 0xEB42F3: realloc (alloc.rs:50)\r\n   ==5483==    by 0xEB42F3: __rdl_realloc (alloc.rs:320)\r\n   ==5483==    by 0x55348C: alloc::alloc::realloc (alloc.rs:124)\r\n   ==5483==    by 0x71FB58: arrow::memory::reallocate (memory.rs:187)\r\n   ==5483==    by 0x9D5606: arrow::buffer::MutableBuffer::reserve (buffer.rs:665)\r\n   ==5483==    by 0x5FFC65: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::reserve (builder.rs:307)\r\n   ==5483==    by 0x605BEF: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::append_n (builder.rs:335)\r\n   ==5483==    by 0x62C854: arrow::array::builder::PrimitiveBuilder<T>::append_slice (builder.rs:591)\r\n   ==5483==    by 0xA992F6: arrow::array::builder::StringBuilder::append_value (builder.rs:1781)\r\n   ==5483==    by 0x6A309B: arrow::array::builder::StringDictionaryBuilder<K>::append (builder.rs:2435)\r\n   ==5483==    by 0x302DA3: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8 (cast.rs:2612)\r\n   ==5483== \r\n   ==5483== Invalid write of size 1\r\n   ==5483==    at 0x55D7B4: arrow::util::bit_util::set_bits_raw (bit_util.rs:128)\r\n   ==5483==    by 0x605D49: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::append_n (builder.rs:339)\r\n   ==5483==    by 0x62C854: arrow::array::builder::PrimitiveBuilder<T>::append_slice (builder.rs:591)\r\n   ==5483==    by 0xA992F6: arrow::array::builder::StringBuilder::append_value (builder.rs:1781)\r\n   ==5483==    by 0x6A309B: arrow::array::builder::StringDictionaryBuilder<K>::append (builder.rs:2435)\r\n   ==5483==    by 0x302DA3: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8 (cast.rs:2612)\r\n   ==5483==    by 0x31E499: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8::{{closure}} (cast.rs:2598)\r\n   ==5483==    by 0xA751ED: core::ops::function::FnOnce::call_once (function.rs:232)\r\n   ==5483==    by 0xB97365: call_once<(),FnOnce<()>> (boxed.rs:1008)\r\n   ==5483==    by 0xB97365: call_once<(),alloc::boxed::Box<FnOnce<()>>> (panic.rs:318)\r\n   ==5483==    by 0xB97365: do_call<std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>,()> (panicking.rs:331)\r\n   ==5483==    by 0xB97365: try<(),std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>> (panicking.rs:274)\r\n   ==5483==    by 0xB97365: catch_unwind<std::panic::AssertUnwindSafe<alloc::boxed::Box<FnOnce<()>>>,()> (panic.rs:394)\r\n   ==5483==    by 0xB97365: run_test_in_process (lib.rs:541)\r\n   ==5483==    by 0xB97365: test::run_test::run_test_inner::{{closure}} (lib.rs:450)\r\n   ==5483==    by 0xB969F8: test::run_test::run_test_inner (lib.rs:475)\r\n   ==5483==    by 0xB94BE9: test::run_test (lib.rs:505)\r\n   ==5483==    by 0xB829D8: run_tests<closure-2> (lib.rs:284)\r\n   ==5483==    by 0xB829D8: test::console::run_tests_console (console.rs:280)\r\n   ==5483==  Address 0x65c1900 is 0 bytes after a block of size 128 alloc'd\r\n   ==5483==    at 0x4C34443: memalign (vg_replace_malloc.c:906)\r\n   ==5483==    by 0x4C34546: posix_memalign (vg_replace_malloc.c:1070)\r\n   ==5483==    by 0xEB42F3: aligned_malloc (alloc.rs:95)\r\n   ==5483==    by 0xEB42F3: alloc (alloc.rs:22)\r\n   ==5483==    by 0xEB42F3: realloc_fallback (alloc.rs:39)\r\n   ==5483==    by 0xEB42F3: realloc (alloc.rs:50)\r\n   ==5483==    by 0xEB42F3: __rdl_realloc (alloc.rs:320)\r\n   ==5483==    by 0x55348C: alloc::alloc::realloc (alloc.rs:124)\r\n   ==5483==    by 0x71FB58: arrow::memory::reallocate (memory.rs:187)\r\n   ==5483==    by 0x9D5606: arrow::buffer::MutableBuffer::reserve (buffer.rs:665)\r\n   ==5483==    by 0x5FFC65: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::reserve (builder.rs:307)\r\n   ==5483==    by 0x605BEF: <arrow::array::builder::BufferBuilder<T> as arrow::array::builder::BufferBuilderTrait<T>>::append_n (builder.rs:335)\r\n   ==5483==    by 0x62C854: arrow::array::builder::PrimitiveBuilder<T>::append_slice (builder.rs:591)\r\n   ==5483==    by 0xA992F6: arrow::array::builder::StringBuilder::append_value (builder.rs:1781)\r\n   ==5483==    by 0x6A309B: arrow::array::builder::StringDictionaryBuilder<K>::append (builder.rs:2435)\r\n   ==5483==    by 0x302DA3: arrow::compute::kernels::cast::tests::test_cast_dict_to_dict_bad_index_value_utf8 (cast.rs:2612)\r\n   ==5483== \r\n   ```\r\n   \r\n   My interpretation of this report is that `arrow::buffer::MutableBuffer::reserve` is reading off the end of the array. I haven't studied the code closely.\r\n   \r\n   The actual command I used is below in case anyone is interested\r\n   PARQUET_TEST_DATA=`pwd`/../../cpp/submodules/parquet-testing/data ARROW_TEST_DATA=`pwd`/../../testing/data valgrind /home/andrew/Software/arrow/rust/target/debug/deps/arrow-b9bea680be7dc6e4\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T12:24:59.894+0000",
                    "updated": "2020-11-13T12:24:59.894+0000",
                    "started": "2020-11-13T12:24:59.894+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511326",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511328",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726737738\n\n\n   (if you be so kind, could you quickly run fd75933 , just to test whether this PR addresses the issue?)\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T12:28:00.485+0000",
                    "updated": "2020-11-13T12:28:00.485+0000",
                    "started": "2020-11-13T12:28:00.485+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511328",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511329",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726742048\n\n\n   > (if you be so kind, could you quickly run fd75933 , just to test whether this PR addresses the issue?)\r\n   \r\n   @jorgecarleitao  -- I did so. There are no errors reported by valgrind when I ran commit fd75933bead400a3943af1d336c006c6656d6f80 (HEAD, jorgecarleitao/buffer_write)\r\n   \r\n   \r\n   ```\r\n   ==7779== For lists of detected and suppressed errors, rerun with: -s\r\n   ==7779== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\r\n   ```\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T12:38:36.238+0000",
                    "updated": "2020-11-13T12:38:36.238+0000",
                    "started": "2020-11-13T12:38:36.238+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511329",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511335",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726749635\n\n\n   FWIW I ran the code in #8598 under valgrind and it does not appear to fix the issue https://github.com/apache/arrow/pull/8598#issuecomment-726749085\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T12:56:42.705+0000",
                    "updated": "2020-11-13T12:56:42.705+0000",
                    "started": "2020-11-13T12:56:42.704+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511335",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511336",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726749635\n\n\n   FWIW I ran the code in #8598 under valgrind and it does not appear to fix the issue -- see details in https://github.com/apache/arrow/pull/8598#issuecomment-726749085\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T12:56:55.532+0000",
                    "updated": "2020-11-13T12:56:55.532+0000",
                    "started": "2020-11-13T12:56:55.531+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511336",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511339",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "alamb commented on a change in pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#discussion_r522935301\n\n\n\n##########\nFile path: rust/arrow/src/util/bit_util.rs\n##########\n@@ -99,36 +99,6 @@ pub unsafe fn unset_bit_raw(data: *mut u8, i: usize) {\n     *data.add(i >> 3) ^= BIT_MASK[i & 7];\n }\n \n-/// Sets bits in the non-inclusive range `start..end` for `data`\n-///\n-/// # Safety\n-///\n-/// Note this doesn't do any bound checking, for performance reason. The caller is\n-/// responsible to guarantee that both `start` and `end` are within bounds.\n-#[inline]\n-pub unsafe fn set_bits_raw(data: *mut u8, start: usize, end: usize) {\n\nReview comment:\n       \ud83c\udf89 \n\n##########\nFile path: rust/arrow/src/array/builder.rs\n##########\n@@ -525,7 +515,7 @@ impl<T: ArrowPrimitiveType> ArrayBuilder for PrimitiveBuilder<T> {\n                 let sliced = array.buffers()[0].data();\n                 // slice into data by factoring (offset and length) * byte width\n                 self.values_builder\n-                    .write_bytes(&sliced[(offset * mul)..((len + offset) * mul)], len)?;\n+                    .write_bytes(&sliced[(offset * mul)..((len + offset) * mul)], len);\n\nReview comment:\n       Nice \ud83d\udc41\ufe0f  -- I agree that removing the `len` parameter entirely would be the best course of action here\n\n##########\nFile path: rust/arrow/src/array/builder.rs\n##########\n@@ -397,18 +396,9 @@ impl<T: ArrowPrimitiveType> BufferBuilder<T> {\n     /// Writes a byte slice to the underlying buffer and updates the `len`, i.e. the\n     /// number array elements in the builder.  Also, converts the `io::Result`\n     /// required by the `Write` trait to the Arrow `Result` type.\n-    fn write_bytes(&mut self, bytes: &[u8], len_added: usize) -> Result<()> {\n-        let write_result = self.buffer.write(bytes);\n-        // `io::Result` has many options one of which we use, so pattern matching is\n-        // overkill here\n-        if write_result.is_err() {\n-            Err(ArrowError::MemoryError(\n-                \"Could not write to Buffer, not big enough\".to_string(),\n-            ))\n-        } else {\n-            self.len += len_added;\n-            Ok(())\n-        }\n+    fn write_bytes(&mut self, bytes: &[u8], len_added: usize) {\n\nReview comment:\n       I agree with @jhorstmann  here that we should remove `len_added` (maybe as another PR) -- the length that is actually added is the `bytes.len()` rather than `len_added` so having the caller have to provide both leaves the opportunity for additional latent bugs\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T13:08:30.411+0000",
                    "updated": "2020-11-13T13:08:30.411+0000",
                    "started": "2020-11-13T13:08:30.411+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511339",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511341",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao commented on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726756578\n\n\n   Thanks a lot, @alamb , really useful data points \u2764\ufe0f\r\n   \r\n   For me that is enough of a reason: fix UB with `safe` code, and figure out a way to perform multi-bit assignment on a single call fast on a subsequent PR.\r\n   \r\n   I also agree with @jhorstmann about the `len_added`. I did not want to change the API for builders in this PR because this already does a backward incompatible change on `MutableBuffer` and one change like this per PR avoids mixing the discussions).\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T13:11:54.388+0000",
                    "updated": "2020-11-13T13:11:54.388+0000",
                    "started": "2020-11-13T13:11:54.388+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511341",
                    "issueId": "13340069"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/worklog/511343",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorgecarleitao edited a comment on pull request #8645:\nURL: https://github.com/apache/arrow/pull/8645#issuecomment-726756578\n\n\n   Thanks a lot, @alamb , really useful data points \u2764\ufe0f\r\n   \r\n   For me that is enough of a reason: fix UB with `safe` code, and figure out a way to perform multi-bit assignment on a single call fast on a subsequent PR.\r\n   \r\n   I also agree with @jhorstmann about the `len_added`. I did not want to change the API for builders in this PR because this already does a backward incompatible change on `MutableBuffer` and one change like this per PR avoids mixing the discussions.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-11-13T13:12:20.465+0000",
                    "updated": "2020-11-13T13:12:20.465+0000",
                    "started": "2020-11-13T13:12:20.464+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "511343",
                    "issueId": "13340069"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 12600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@11a93c70[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@64c8049f[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41564eb3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@651e56fa[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@62cdb42[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3a0ec653[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@49de3477[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5e600230[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3e762475[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@720641b6[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4a43be0d[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@14ec44f7[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12600,
        "customfield_12312520": null,
        "customfield_12312521": "Sat Nov 14 07:25:40 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-11-14T07:25:40.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-10561/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2020-11-11T23:09:53.000+0000",
        "updated": "2020-11-14T07:25:49.000+0000",
        "timeoriginalestimate": null,
        "description": null,
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Rust] Simplify `MutableBuffer::write` and `MutableBuffer::write_bytes`",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13340069/comment/17231951",
                    "id": "17231951",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Issue resolved by pull request 8645\n[https://github.com/apache/arrow/pull/8645]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorgecarleitao",
                        "name": "jorgecarleitao",
                        "key": "jorgecarleitao",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=jorgecarleitao&avatarId=43827",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jorgecarleitao&avatarId=43827",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jorgecarleitao&avatarId=43827",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jorgecarleitao&avatarId=43827"
                        },
                        "displayName": "Jorge Leit\u00e3o",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2020-11-14T07:25:40.698+0000",
                    "updated": "2020-11-14T07:25:40.698+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0khu8:",
        "customfield_12314139": null
    }
}