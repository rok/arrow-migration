{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13357189",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189",
    "key": "ARROW-11516",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 4800,
            "total": 4800,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 4800,
            "total": 4800,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11516/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 8,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562681",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson opened a new pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659\n\n\n   This refactors the expression-building code to take a variable number of arguments. That way, we can support a range of unary/binary/varargs compute kernels without having to declare up front which are which.\r\n   \r\n   In many cases, the newly exposed compute kernels don't take additional options, so they will just work. For those that do, we'll likely need to add some special C++ bindings to pass those through, unless we can come up with a clever solution in the compute module to facilitate that. Either way, this is left to a followup.\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-08T23:03:09.886+0000",
                    "updated": "2021-03-08T23:03:09.886+0000",
                    "started": "2021-03-08T23:03:09.885+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562681",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562683",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#issuecomment-793151701\n\n\n   https://issues.apache.org/jira/browse/ARROW-11516\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-08T23:03:39.642+0000",
                    "updated": "2021-03-08T23:03:39.642+0000",
                    "started": "2021-03-08T23:03:39.641+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562683",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562813",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#discussion_r589936444\n\n\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -269,40 +266,40 @@ Expression$scalar <- function(x) {\n   dataset___expr__scalar(Scalar$create(x))\n }\n \n-build_dataset_expression <- function(.Generic, e1, e2, ...) {\n-  if (.Generic %in% names(.unary_function_map) || nargs() == 2L) {\n-    expr <- Expression$create(.unary_function_map[[.Generic]] %||% .Generic, e1)\n-  } else if (.Generic == \"%in%\") {\n+build_dataset_expression <- function(FUN,\n+                                     ...,\n+                                     args = list(...),\n+                                     options = empty_named_list()) {\n+  if (FUN == \"%in%\") {\n     # Special-case %in%, which is different from the Array function name\n-    expr <- Expression$create(\"is_in\", e1,\n+    expr <- Expression$create(\"is_in\", args[[1]],\n       options = list(\n-        value_set = Array$create(e2),\n+        value_set = Array$create(args[[2]]),\n         skip_nulls = TRUE\n       )\n     )\n   } else {\n-    if (!inherits(e1, \"Expression\")) {\n-      e1 <- Expression$scalar(e1)\n-    }\n-    if (!inherits(e2, \"Expression\")) {\n-      e2 <- Expression$scalar(e2)\n-    }\n+    args <- lapply(args, function(x) {\n+      if (!inherits(x, \"Expression\")) {\n+        x <- Expression$scalar(x)\n+      }\n+      x\n+    })\n \n     # In Arrow, \"divide\" is one function, which does integer division on\n     # integer inputs and floating-point division on floats\n-    if (.Generic == \"/\") {\n+    if (FUN == \"/\") {\n       # TODO: omg so many ways it's wrong to assume these types\n-      e1 <- e1$cast(float64())\n-      e2 <- e2$cast(float64())\n-    } else if (.Generic == \"%/%\") {\n+      args <- lapply(args, function(x) x$cast(float64()))\n+    } else if (FUN == \"%/%\") {\n       # In R, integer division works like floor(float division)\n-      out <- build_dataset_expression(\"/\", e1, e2)\n+      out <- build_dataset_expression(\"/\", args = args)\n\nReview comment:\n       Does any of this change what kinds of error messages happen where there are illegal numbers of operands (e.g. ```` `/`(1,2,3)````)?\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-09T04:39:33.647+0000",
                    "updated": "2021-03-09T04:39:33.647+0000",
                    "started": "2021-03-09T04:39:33.647+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562813",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562816",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#discussion_r589939579\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -548,6 +548,18 @@ test_that(\"filter() with strings\", {\n   )\n })\n \n+test_that(\"filter() with arrow compute functions by name\", {\n+  skip_if_not_available(\"parquet\")\n+  ds <- open_dataset(dataset_dir, partitioning = schema(part = uint8()))\n+  expect_equivalent(\n+    ds %>%\n+      select(part, lgl) %>%\n+      filter(arrow_is_valid(lgl), arrow_equal(part, 1)) %>%\n+      collect(),\n+    tibble(part = 1L, lgl = df1$lgl[!is.na(df1$lgl)])\n\nReview comment:\n       It's unclear why/how this reference table should be equivalent to the test result\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -548,6 +548,18 @@ test_that(\"filter() with strings\", {\n   )\n })\n \n+test_that(\"filter() with arrow compute functions by name\", {\n+  skip_if_not_available(\"parquet\")\n+  ds <- open_dataset(dataset_dir, partitioning = schema(part = uint8()))\n+  expect_equivalent(\n+    ds %>%\n+      select(part, lgl) %>%\n+      filter(arrow_is_valid(lgl), arrow_equal(part, 1)) %>%\n+      collect(),\n+    tibble(part = 1L, lgl = df1$lgl[!is.na(df1$lgl)])\n\nReview comment:\n       It's unclear why/how this reference tibble should be equivalent to the test result\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-09T04:48:04.750+0000",
                    "updated": "2021-03-09T04:48:04.750+0000",
                    "started": "2021-03-09T04:48:04.749+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562816",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562830",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#discussion_r589950504\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -548,6 +548,18 @@ test_that(\"filter() with strings\", {\n   )\n })\n \n+test_that(\"filter() with arrow compute functions by name\", {\n+  skip_if_not_available(\"parquet\")\n+  ds <- open_dataset(dataset_dir, partitioning = schema(part = uint8()))\n+  expect_equivalent(\n+    ds %>%\n+      select(part, lgl) %>%\n+      filter(arrow_is_valid(lgl), arrow_equal(part, 1)) %>%\n+      collect(),\n+    tibble(part = 1L, lgl = df1$lgl[!is.na(df1$lgl)])\n\nReview comment:\n       `is_valid` is equivalent to `!is.na()` (and it's not something you can otherwise access). Is a comment to that effect sufficient, or do you have a different suggestion?\r\n   \r\n   FTR if you search this file for `df1$lgl[!is.na(df1$lgl)]`, you'll see the test I based this on. Happy to use a different test if you think better.\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-09T05:21:05.554+0000",
                    "updated": "2021-03-09T05:21:05.554+0000",
                    "started": "2021-03-09T05:21:05.554+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562830",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/562832",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#discussion_r589952643\n\n\n\n##########\nFile path: r/R/expression.R\n##########\n@@ -269,40 +266,40 @@ Expression$scalar <- function(x) {\n   dataset___expr__scalar(Scalar$create(x))\n }\n \n-build_dataset_expression <- function(.Generic, e1, e2, ...) {\n-  if (.Generic %in% names(.unary_function_map) || nargs() == 2L) {\n-    expr <- Expression$create(.unary_function_map[[.Generic]] %||% .Generic, e1)\n-  } else if (.Generic == \"%in%\") {\n+build_dataset_expression <- function(FUN,\n+                                     ...,\n+                                     args = list(...),\n+                                     options = empty_named_list()) {\n+  if (FUN == \"%in%\") {\n     # Special-case %in%, which is different from the Array function name\n-    expr <- Expression$create(\"is_in\", e1,\n+    expr <- Expression$create(\"is_in\", args[[1]],\n       options = list(\n-        value_set = Array$create(e2),\n+        value_set = Array$create(args[[2]]),\n         skip_nulls = TRUE\n       )\n     )\n   } else {\n-    if (!inherits(e1, \"Expression\")) {\n-      e1 <- Expression$scalar(e1)\n-    }\n-    if (!inherits(e2, \"Expression\")) {\n-      e2 <- Expression$scalar(e2)\n-    }\n+    args <- lapply(args, function(x) {\n+      if (!inherits(x, \"Expression\")) {\n+        x <- Expression$scalar(x)\n+      }\n+      x\n+    })\n \n     # In Arrow, \"divide\" is one function, which does integer division on\n     # integer inputs and floating-point division on floats\n-    if (.Generic == \"/\") {\n+    if (FUN == \"/\") {\n       # TODO: omg so many ways it's wrong to assume these types\n-      e1 <- e1$cast(float64())\n-      e2 <- e2$cast(float64())\n-    } else if (.Generic == \"%/%\") {\n+      args <- lapply(args, function(x) x$cast(float64()))\n+    } else if (FUN == \"%/%\") {\n       # In R, integer division works like floor(float division)\n-      out <- build_dataset_expression(\"/\", e1, e2)\n+      out <- build_dataset_expression(\"/\", args = args)\n\nReview comment:\n       If I read the code correctly, no. In the dplyr context, the expression builders on master would pass `e1, e2, ...` on through, so either way you'll get a message from the C++ library saying something like \"divide_checked takes 2 arguments but you gave 3\".\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-09T05:24:26.403+0000",
                    "updated": "2021-03-09T05:24:26.403+0000",
                    "started": "2021-03-09T05:24:26.403+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "562832",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/563100",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659#discussion_r590424752\n\n\n\n##########\nFile path: r/tests/testthat/test-dataset.R\n##########\n@@ -548,6 +548,18 @@ test_that(\"filter() with strings\", {\n   )\n })\n \n+test_that(\"filter() with arrow compute functions by name\", {\n+  skip_if_not_available(\"parquet\")\n+  ds <- open_dataset(dataset_dir, partitioning = schema(part = uint8()))\n+  expect_equivalent(\n+    ds %>%\n+      select(part, lgl) %>%\n+      filter(arrow_is_valid(lgl), arrow_equal(part, 1)) %>%\n+      collect(),\n+    tibble(part = 1L, lgl = df1$lgl[!is.na(df1$lgl)])\n\nReview comment:\n       I think the equivalence would be clearer if the reference result were created in the same manner as the tested result:\r\n   ```suggestion\r\n       ds %>%\r\n          select(part, lgl) %>%\r\n          filter(!is.na(lgl), part == 1L) %>%\r\n          collect()\r\n   ```\n\n\n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-09T14:37:40.994+0000",
                    "updated": "2021-03-09T14:37:40.994+0000",
                    "started": "2021-03-09T14:37:40.994+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "563100",
                    "issueId": "13357189"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/worklog/563910",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson closed pull request #9659:\nURL: https://github.com/apache/arrow/pull/9659\n\n\n   \n\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-03-10T17:39:24.287+0000",
                    "updated": "2021-03-10T17:39:24.287+0000",
                    "started": "2021-03-10T17:39:24.286+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "563910",
                    "issueId": "13357189"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/2",
            "id": "2",
            "description": "A new feature of the product, which has yet to be developed.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype",
            "name": "New Feature",
            "subtask": false,
            "avatarId": 21141
        },
        "timespent": 4800,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@603625e[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2b9f7ee7[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@b36b6df[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@5b8e8918[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1a1cd16e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@5ddfd1fe[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@636114d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4c8897e9[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3063a8b7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@1390df64[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@783cbe76[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@70034947[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 4800,
        "customfield_12312520": null,
        "customfield_12312521": "Wed Mar 10 17:39:13 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-03-10T17:39:13.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11516/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2021-02-05T23:17:50.000+0000",
        "updated": "2021-03-10T17:39:25.000+0000",
        "timeoriginalestimate": null,
        "description": "Followup to ARROW-9856. Use list_compute_functions (added here) to make all Arrow C++ compute functions available directly by name (in case you want to use the non-checked arithmetic, or an ascii specific kernel, or something without a natural R analogue). Will require a bit more refactoring to handle variable numbers of args, as well as some additional options handling.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "1h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 4800
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Allow all C++ compute functions to be called by name in dplyr",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13357189/comment/17299007",
                    "id": "17299007",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "Issue resolved by pull request 9659\n[https://github.com/apache/arrow/pull/9659]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2021-03-10T17:39:13.633+0000",
                    "updated": "2021-03-10T17:39:13.633+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nfkg:",
        "customfield_12314139": null
    }
}