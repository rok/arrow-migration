{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13207413",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413",
    "key": "ARROW-4147",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12343858",
                "id": "12343858",
                "description": "",
                "name": "0.12.0",
                "archived": false,
                "released": true,
                "releaseDate": "2019-01-20"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pravindra",
            "name": "pravindra",
            "key": "pravindra",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
            },
            "displayName": "Pindikura Ravindra",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328933",
                "id": "12328933",
                "name": "Java"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pravindra",
            "name": "pravindra",
            "key": "pravindra",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
            },
            "displayName": "Pindikura Ravindra",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=pravindra",
            "name": "pravindra",
            "key": "pravindra",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34055",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34055",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34055",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34055"
            },
            "displayName": "Pindikura Ravindra",
            "active": true,
            "timeZone": "Asia/Kolkata"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4147/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/180573",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on pull request #3298: ARROW-4147: reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298\n \n \n   - some code reorg to avoid duplication\r\n   - changed the default initial alloc from 4096 to 3970\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-03T08:49:10.340+0000",
                    "updated": "2019-01-03T08:49:10.340+0000",
                    "started": "2019-01-03T08:49:10.339+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "180573",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/180580",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3298: ARROW-4147: reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-451090489\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=h1) Report\n   > Merging [#3298](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/12912741c2cbb33fad2965ee3abc4d3b47a63515?src=pr&el=desc) will **increase** coverage by `<.01%`.\n   > The diff coverage is `n/a`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3298/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3298      +/-   ##\n   ==========================================\n   + Coverage    88.5%   88.51%   +<.01%     \n   ==========================================\n     Files         539      539              \n     Lines       72968    72968              \n   ==========================================\n   + Hits        64583    64586       +3     \n   + Misses       8278     8275       -3     \n     Partials      107      107\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/csv/column-builder.cc](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy9jc3YvY29sdW1uLWJ1aWxkZXIuY2M=) | `97.4% <0%> (+1.94%)` | :arrow_up: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=footer). Last update [1291274...552babb](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-03T09:24:33.019+0000",
                    "updated": "2019-01-03T09:24:33.019+0000",
                    "started": "2019-01-03T09:24:33.018+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "180580",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/181549",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on issue #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-451736559\n \n \n   addressed review comments in the parent PR https://github.com/apache/arrow/pull/3246\r\n   \r\n   @jacques-n @siddharthteotia \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-06T12:06:34.929+0000",
                    "updated": "2019-01-06T12:06:34.929+0000",
                    "started": "2019-01-06T12:06:34.929+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "181549",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182268",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-451090489\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=h1) Report\n   > Merging [#3298](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/1143942bc5264d89a343031e522ffc5aa7abf7b3?src=pr&el=desc) will **decrease** coverage by `0.01%`.\n   > The diff coverage is `n/a`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3298/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3298      +/-   ##\n   ==========================================\n   - Coverage   88.58%   88.57%   -0.02%     \n   ==========================================\n     Files         546      546              \n     Lines       73059    73057       -2     \n   ==========================================\n   - Hits        64721    64709      -12     \n   - Misses       8233     8239       +6     \n   - Partials      105      109       +4\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [go/arrow/math/int64\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9pbnQ2NF9hdngyX2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/memory/memory\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hdngyX2FtZDY0Lmdv) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X2F2eDJfYW1kNjQuZ28=) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/math/uint64\\_avx2\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYXZ4Ml9hbWQ2NC5nbw==) | `0% <0%> (-100%)` | :arrow_down: |\n   | [go/arrow/memory/memory\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWVtb3J5L21lbW9yeV9hbWQ2NC5nbw==) | `28.57% <0%> (-14.29%)` | :arrow_down: |\n   | [go/arrow/math/math\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9tYXRoX2FtZDY0Lmdv) | `31.57% <0%> (-5.27%)` | :arrow_down: |\n   | [cpp/src/arrow/util/bpacking.h](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2JwYWNraW5nLmg=) | `99.84% <0%> (-0.01%)` | :arrow_down: |\n   | [go/arrow/math/float64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9mbG9hdDY0X2FtZDY0Lmdv) | `33.33% <0%> (\u00f8)` | :arrow_up: |\n   | [go/arrow/math/int64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC9pbnQ2NF9hbWQ2NC5nbw==) | `33.33% <0%> (\u00f8)` | :arrow_up: |\n   | [go/arrow/math/uint64\\_amd64.go](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Z28vYXJyb3cvbWF0aC91aW50NjRfYW1kNjQuZ28=) | `33.33% <0%> (\u00f8)` | :arrow_up: |\n   | ... and [4 more](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree-more) | |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=footer). Last update [1143942...3e1751a](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T08:34:32.422+0000",
                    "updated": "2019-01-08T08:34:32.422+0000",
                    "started": "2019-01-08T08:34:32.422+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182268",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182315",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r245945962\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -33,7 +34,13 @@\n \n   public static final String MAX_ALLOCATION_SIZE_PROPERTY = \"arrow.vector.max_allocation_bytes\";\n   public static final int MAX_ALLOCATION_SIZE = Integer.getInteger(MAX_ALLOCATION_SIZE_PROPERTY, Integer.MAX_VALUE);\n-  public static final int INITIAL_VALUE_ALLOCATION = 4096;\n+  /*\n+   * For all fixed width vectors, the value and validity buffers are sliced from a single buffer.\n+   * Similarly, for variable width vectors, the offsets and validity buffers are sliced from a\n+   * single buffer. To ensure the single buffer is power-of-2 size, the initial value allocation\n \n Review comment:\n   So what exactly is the value capacity we are allocating for. If the joint buffer that will be sliced has first 512 bytes for bitmap then we are having a value count of 4096 for the validity buffer and something less for data buffer. I remember that validity and data buffer move together (alloc, realloc and then load). Is that not true now and the value capacity of each buffer will vary slightly?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T10:30:20.673+0000",
                    "updated": "2019-01-08T10:30:20.673+0000",
                    "started": "2019-01-08T10:30:20.673+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182315",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182325",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r245949817\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -33,7 +34,13 @@\n \n   public static final String MAX_ALLOCATION_SIZE_PROPERTY = \"arrow.vector.max_allocation_bytes\";\n   public static final int MAX_ALLOCATION_SIZE = Integer.getInteger(MAX_ALLOCATION_SIZE_PROPERTY, Integer.MAX_VALUE);\n-  public static final int INITIAL_VALUE_ALLOCATION = 4096;\n+  /*\n+   * For all fixed width vectors, the value and validity buffers are sliced from a single buffer.\n+   * Similarly, for variable width vectors, the offsets and validity buffers are sliced from a\n+   * single buffer. To ensure the single buffer is power-of-2 size, the initial value allocation\n \n Review comment:\n   I think we should change the vector.getValueCapacity() method to now take min (validity buffer value capacity, data buffer value capacity) since these buffers no longer move together.\r\n   \r\n   Initially when default starting value capacity was 4096, we allocated 512 bytes of validity buffer and let's sat 4096*4 = 16KB of data buffer for an IntVector.  Now if we stick to the same numbers for the join buffer allocation, it is evident that we will over-allocate due to power of 2 semantics since 512 + 16KB will ask for a chunk of 32KB.\r\n   \r\n   It seems like in the revised scheme we are still keeping 512 bytes for validity buffer (what I see from comments), so for the above example, we would be asking 512 + 3970*4 => something more than 16KB so still doesn't help.\r\n   \r\n   However, if we validity size is 3970/8 = 496 and data buffer size is 3970*4, then we will allocate 16KB chunk since the compound size is just under 16KB. From your comments, it implies that we are still keeping 512 bytes for validity buffer so I am a bit confused here.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T10:41:19.304+0000",
                    "updated": "2019-01-08T10:41:19.304+0000",
                    "started": "2019-01-08T10:41:19.303+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182325",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182362",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r245983023\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -33,7 +34,13 @@\n \n   public static final String MAX_ALLOCATION_SIZE_PROPERTY = \"arrow.vector.max_allocation_bytes\";\n   public static final int MAX_ALLOCATION_SIZE = Integer.getInteger(MAX_ALLOCATION_SIZE_PROPERTY, Integer.MAX_VALUE);\n-  public static final int INITIAL_VALUE_ALLOCATION = 4096;\n+  /*\n+   * For all fixed width vectors, the value and validity buffers are sliced from a single buffer.\n+   * Similarly, for variable width vectors, the offsets and validity buffers are sliced from a\n+   * single buffer. To ensure the single buffer is power-of-2 size, the initial value allocation\n \n Review comment:\n   sorry for the confusion - I meant to say approx. 512. I've fixed the comment now (it's 504 bytes for the bitmap). Also, added a test to verify that the additional allocation is < 5%.\r\n   \r\n   Regarding the other questions \r\n   - the validity and value buffers still move together. in both alloc/realloc, we allocate a single buffer and slice into two.\r\n   - the allocated value capacity can be slightly > INITIAL_VALUE_ALLOCATION, depending on the vector type.\r\n   - the  vector.getValueCapacity() already takes a minimum of validity buffer capacity and value buffer capacity (even before my change).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T12:46:50.112+0000",
                    "updated": "2019-01-08T12:46:50.112+0000",
                    "started": "2019-01-08T12:46:50.111+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182362",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182377",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "codecov-io commented on issue #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-451090489\n \n \n   # [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=h1) Report\n   > Merging [#3298](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=desc) into [master](https://codecov.io/gh/apache/arrow/commit/1143942bc5264d89a343031e522ffc5aa7abf7b3?src=pr&el=desc) will **decrease** coverage by `<.01%`.\n   > The diff coverage is `n/a`.\n   \n   [![Impacted file tree graph](https://codecov.io/gh/apache/arrow/pull/3298/graphs/tree.svg?width=650&token=LpTCFbqVT1&height=150&src=pr)](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree)\n   \n   ```diff\n   @@            Coverage Diff             @@\n   ##           master    #3298      +/-   ##\n   ==========================================\n   - Coverage   88.58%   88.58%   -0.01%     \n   ==========================================\n     Files         546      546              \n     Lines       73059    73057       -2     \n   ==========================================\n   - Hits        64721    64719       -2     \n     Misses       8233     8233              \n     Partials      105      105\n   ```\n   \n   \n   | [Impacted Files](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=tree) | Coverage \u0394 | |\n   |---|---|---|\n   | [cpp/src/arrow/util/bpacking.h](https://codecov.io/gh/apache/arrow/pull/3298/diff?src=pr&el=tree#diff-Y3BwL3NyYy9hcnJvdy91dGlsL2JwYWNraW5nLmg=) | `99.84% <0%> (-0.01%)` | :arrow_down: |\n   \n   ------\n   \n   [Continue to review full report at Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=continue).\n   > **Legend** - [Click here to learn more](https://docs.codecov.io/docs/codecov-delta)\n   > `\u0394 = absolute <relative> (impact)`, `\u00f8 = not affected`, `? = missing data`\n   > Powered by [Codecov](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=footer). Last update [1143942...84dcf83](https://codecov.io/gh/apache/arrow/pull/3298?src=pr&el=lastupdated). Read the [comment docs](https://docs.codecov.io/docs/pull-request-comments).\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T13:14:39.298+0000",
                    "updated": "2019-01-08T13:14:39.298+0000",
                    "started": "2019-01-08T13:14:39.298+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182377",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182485",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jacques-n commented on issue #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-452352005\n \n \n   I'm fine in general on this but it would be great if @siddharthteotia could go through in detail.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T16:01:53.207+0000",
                    "updated": "2019-01-08T16:01:53.207+0000",
                    "started": "2019-01-08T16:01:53.206+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182485",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182655",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r246136436\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -33,7 +34,13 @@\n \n   public static final String MAX_ALLOCATION_SIZE_PROPERTY = \"arrow.vector.max_allocation_bytes\";\n   public static final int MAX_ALLOCATION_SIZE = Integer.getInteger(MAX_ALLOCATION_SIZE_PROPERTY, Integer.MAX_VALUE);\n-  public static final int INITIAL_VALUE_ALLOCATION = 4096;\n+  /*\n+   * For all fixed width vectors, the value and validity buffers are sliced from a single buffer.\n+   * Similarly, for variable width vectors, the offsets and validity buffers are sliced from a\n+   * single buffer. To ensure the single buffer is power-of-2 size, the initial value allocation\n \n Review comment:\n   Got it. Thanks\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T20:14:36.988+0000",
                    "updated": "2019-01-08T20:14:36.988+0000",
                    "started": "2019-01-08T20:14:36.987+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182655",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182677",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r246150498\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -98,5 +106,94 @@ protected ArrowBuf releaseBuffer(ArrowBuf buffer) {\n   protected static int getValidityBufferSizeFromCount(final int valueCount) {\n     return (int) Math.ceil(valueCount / 8.0);\n   }\n+\n+  /* round up to the next multiple of 8 */\n+  private static long roundUp8(long size) {\n+    return ((size + 7) / 8) * 8;\n+  }\n+\n+  protected long computeCombinedBufferSize(int valueCount, int typeWidth) {\n+    Preconditions.checkArgument(valueCount >= 0, \"valueCount must be >= 0\");\n+    Preconditions.checkArgument(typeWidth >= 0, \"typeWidth must be >= 0\");\n+\n+    // compute size of validity buffer.\n+    long bufferSize = roundUp8(getValidityBufferSizeFromCount(valueCount));\n+\n+    // add the size of the value buffer.\n+    if (typeWidth == 0) {\n+      // for boolean type, value-buffer and validity-buffer are of same size.\n+      bufferSize *= 2;\n+    } else {\n+      bufferSize += roundUp8(valueCount * typeWidth);\n \n Review comment:\n   The data buffer size should be evenly divisible by the type size right? Why are we using it for all types?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T21:03:30.842+0000",
                    "updated": "2019-01-08T21:03:30.842+0000",
                    "started": "2019-01-08T21:03:30.841+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182677",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182678",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147:[Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r246150498\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -98,5 +106,94 @@ protected ArrowBuf releaseBuffer(ArrowBuf buffer) {\n   protected static int getValidityBufferSizeFromCount(final int valueCount) {\n     return (int) Math.ceil(valueCount / 8.0);\n   }\n+\n+  /* round up to the next multiple of 8 */\n+  private static long roundUp8(long size) {\n+    return ((size + 7) / 8) * 8;\n+  }\n+\n+  protected long computeCombinedBufferSize(int valueCount, int typeWidth) {\n+    Preconditions.checkArgument(valueCount >= 0, \"valueCount must be >= 0\");\n+    Preconditions.checkArgument(typeWidth >= 0, \"typeWidth must be >= 0\");\n+\n+    // compute size of validity buffer.\n+    long bufferSize = roundUp8(getValidityBufferSizeFromCount(valueCount));\n+\n+    // add the size of the value buffer.\n+    if (typeWidth == 0) {\n+      // for boolean type, value-buffer and validity-buffer are of same size.\n+      bufferSize *= 2;\n+    } else {\n+      bufferSize += roundUp8(valueCount * typeWidth);\n \n Review comment:\n   The data buffer size should be evenly divisible by the type size right? Why are we using the round up to multiple of 8 for all types. \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-08T21:04:10.744+0000",
                    "updated": "2019-01-08T21:04:10.744+0000",
                    "started": "2019-01-08T21:04:10.743+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182678",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182832",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on pull request #3298: ARROW-4147: [Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r246251475\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -98,5 +106,94 @@ protected ArrowBuf releaseBuffer(ArrowBuf buffer) {\n   protected static int getValidityBufferSizeFromCount(final int valueCount) {\n     return (int) Math.ceil(valueCount / 8.0);\n   }\n+\n+  /* round up to the next multiple of 8 */\n+  private static long roundUp8(long size) {\n+    return ((size + 7) / 8) * 8;\n+  }\n+\n+  protected long computeCombinedBufferSize(int valueCount, int typeWidth) {\n+    Preconditions.checkArgument(valueCount >= 0, \"valueCount must be >= 0\");\n+    Preconditions.checkArgument(typeWidth >= 0, \"typeWidth must be >= 0\");\n+\n+    // compute size of validity buffer.\n+    long bufferSize = roundUp8(getValidityBufferSizeFromCount(valueCount));\n+\n+    // add the size of the value buffer.\n+    if (typeWidth == 0) {\n+      // for boolean type, value-buffer and validity-buffer are of same size.\n+      bufferSize *= 2;\n+    } else {\n+      bufferSize += roundUp8(valueCount * typeWidth);\n \n Review comment:\n   the bitmap slice starts after the data slice. we need the bitmap to be on a 8-byte boundary - allows us to treat the bitmap as an array of uint64 (in dremio pivot/unpivot, in gandiva).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-09T03:36:42.362+0000",
                    "updated": "2019-01-09T03:36:42.362+0000",
                    "started": "2019-01-09T03:36:42.361+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182832",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147: [Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#discussion_r246251987\n \n \n\n ##########\n File path: java/vector/src/main/java/org/apache/arrow/vector/BaseValueVector.java\n ##########\n @@ -98,5 +106,94 @@ protected ArrowBuf releaseBuffer(ArrowBuf buffer) {\n   protected static int getValidityBufferSizeFromCount(final int valueCount) {\n     return (int) Math.ceil(valueCount / 8.0);\n   }\n+\n+  /* round up to the next multiple of 8 */\n+  private static long roundUp8(long size) {\n+    return ((size + 7) / 8) * 8;\n+  }\n+\n+  protected long computeCombinedBufferSize(int valueCount, int typeWidth) {\n+    Preconditions.checkArgument(valueCount >= 0, \"valueCount must be >= 0\");\n+    Preconditions.checkArgument(typeWidth >= 0, \"typeWidth must be >= 0\");\n+\n+    // compute size of validity buffer.\n+    long bufferSize = roundUp8(getValidityBufferSizeFromCount(valueCount));\n+\n+    // add the size of the value buffer.\n+    if (typeWidth == 0) {\n+      // for boolean type, value-buffer and validity-buffer are of same size.\n+      bufferSize *= 2;\n+    } else {\n+      bufferSize += roundUp8(valueCount * typeWidth);\n \n Review comment:\n   I see.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-09T03:40:45.938+0000",
                    "updated": "2019-01-09T03:40:45.938+0000",
                    "started": "2019-01-09T03:40:45.937+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182834",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/182835",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "siddharthteotia commented on pull request #3298: ARROW-4147: [Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-09T03:41:04.643+0000",
                    "updated": "2019-01-09T03:41:04.643+0000",
                    "started": "2019-01-09T03:41:04.643+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "182835",
                    "issueId": "13207413"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13207413/worklog/183045",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pravindra commented on issue #3298: ARROW-4147: [Java] reduce heap usage for varwidth vectors\nURL: https://github.com/apache/arrow/pull/3298#issuecomment-452677564\n \n \n   thanks @siddharthteotia \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2019-01-09T12:20:00.990+0000",
                    "updated": "2019-01-09T12:20:00.990+0000",
                    "started": "2019-01-09T12:20:00.989+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "183045",
                    "issueId": "13207413"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@d05b658[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@24b7f86[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5d8a75b5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@46486cd[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@632237f5[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@737684d2[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7d5f60d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5d2dc35c[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2fc2da93[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@68d58bad[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6e8a0fa3[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@5d0e060d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "2019-01-03 07:35:51.0",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2019-01-09T03:44:39.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-4147/watchers",
            "watchCount": 1,
            "isWatching": false
        },
        "created": "2019-01-03T07:35:51.000+0000",
        "updated": "2019-01-09T12:20:00.000+0000",
        "timeoriginalestimate": null,
        "description": "This is a follow up to ARROW-1807. The same changes need to be done for variable len vectors too.\r\n\r\nAlso, the default value for initial allocations (4096) causes a lot of wastage, and needs to be changed (to 3970).",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[JAVA] Reduce heap usage for variable width vectors",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [],
            "maxResults": 0,
            "total": 0,
            "startAt": 0
        },
        "customfield_12311820": "0|u00h20:",
        "customfield_12314139": null
    }
}