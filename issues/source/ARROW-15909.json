{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13433170",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170",
    "key": "ARROW-15909",
    "fields": {
        "fixVersions": [],
        "resolution": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "name": "Open",
            "id": "1",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                "id": 2,
                "key": "new",
                "colorName": "blue-gray",
                "name": "To Do"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12334621",
                "id": "12334621",
                "name": "FlightRPC"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=lidavidm",
            "name": "lidavidm",
            "key": "lidavidm",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "David Li",
            "active": true,
            "timeZone": "America/New_York"
        },
        "aggregateprogress": {
            "progress": 16200,
            "total": 16200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 16200,
            "total": 16200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15909/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 27,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743424",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659\n\n\n   This isn't perfect because some exceptions are meant to propagate to the client, some are unintended, and it's not always clear which is which, but this should at least make development easier.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-17T20:48:31.240+0000",
                    "updated": "2022-03-17T20:48:31.240+0000",
                    "started": "2022-03-17T20:48:31.239+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743424",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743426",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1071444693\n\n\n   https://issues.apache.org/jira/browse/ARROW-15909\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-17T20:48:56.116+0000",
                    "updated": "2022-03-17T20:48:56.116+0000",
                    "started": "2022-03-17T20:48:56.116+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743426",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743584",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#discussion_r829694665\n\n\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1490,20 +1491,47 @@ cdef class RecordBatchStream(FlightDataStream):\n         self.data_source = data_source\n         self.write_options = _get_options(options).c_options\n \n-    cdef CFlightDataStream* to_stream(self) except *:\n+    cdef CFlightDataStream* to_stream(self, logger) except *:\n         cdef:\n             shared_ptr[CRecordBatchReader] reader\n         if isinstance(self.data_source, RecordBatchReader):\n             reader = (<RecordBatchReader> self.data_source).reader\n         elif isinstance(self.data_source, lib.Table):\n-            table = (<Table> self.data_source).table\n-            reader.reset(new TableBatchReader(deref(table)))\n+            reader.reset(new TableBatchReader(\n+                (<Table> self.data_source).sp_table))\n         else:\n             raise RuntimeError(\"Can't construct RecordBatchStream \"\n                                \"from type {}\".format(type(self.data_source)))\n         return new CRecordBatchStream(reader, self.write_options)\n \n \n+class _WithLogger(collections.namedtuple(\n+        '_WithLogger', ['this', 'logger'])):\n+    \"\"\"Combine a server object with additional logging state.\n+\n+    This avoids exposing the logger in the public API (by storing it\n+    on self, which even a name-mangled method can't avoid) and\n+    potentially clashing with application code.\n+    \"\"\"\n+\n+    def log_exception(self, method, exc):\n+        \"\"\"Log an uncaught exception in the handler for an RPC method.\"\"\"\n+        if not self.logger:\n+            return\n+        # Don't log all kinds of errors. FlightError is explicitly for\n+        # sending RPC errors; NotImplementedError is likely noise.\n+        # Other errors are unclear, so log to be safe. For instance:\n+        # both ValueError and ArrowInvalid map to INVALID_ARGUMENT,\n+        # but ValueError is likely a stray exception (so log it) and\n+        # ArrowInvalid is likely intentional (so don't)\n\nReview comment:\n       Extreme nit: `... (so don't).`  <-- period?\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1707,16 +1735,26 @@ cdef class ClientAuthSender(_Weakrefable):\n         return result\n \n \n-cdef CStatus _data_stream_next(void* self, CFlightPayload* payload) except *:\n+cdef CStatus _data_stream_next(void* c_state,\n+                               CFlightPayload* payload) except *:\n     \"\"\"Callback for implementing FlightDataStream in Python.\"\"\"\n+    server_state = <object> c_state\n+    try:\n+        if not isinstance(server_state.this, GeneratorStream):\n+            raise RuntimeError(\n+                \"self object in callback is not GeneratorStream\")\n+        stream = <GeneratorStream> server_state.this\n+        return _data_stream_do_next(stream, server_state, payload)\n+    except Exception as e:\n+        server_state.log_exception(\"do_get\", e)\n\nReview comment:\n       Is this a \"do_get\" operation?\r\n   [In `_do_get`](https://github.com/apache/arrow/pull/12659/files#diff-0ed358f5d42920d7f94cc500791976a2c158c4d72f4a6b231393534b2d13683bR1957), name is also \"do_get\".\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1866,41 +1919,49 @@ cdef CStatus _do_put(void* self, const CServerCallContext& context,\n         FlightDescriptor descriptor = \\\n             FlightDescriptor.__new__(FlightDescriptor)\n \n+    server_state = <object> c_state\n     descriptor.descriptor = reader.get().descriptor()\n     py_reader.reader.reset(reader.release())\n     py_writer.writer.reset(writer.release())\n     try:\n-        (<object> self).do_put(ServerCallContext.wrap(context), descriptor,\n-                               py_reader, py_writer)\n+        server_state.this.do_put(ServerCallContext.wrap(context), descriptor,\n+                                 py_reader, py_writer)\n         return CStatus_OK()\n\nReview comment:\n       Nit: The general convention seems to be to place `return CStatus_OK()` at end of function.\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1910,27 +1971,32 @@ cdef CStatus _do_exchange(void* self, const CServerCallContext& context,\n         FlightDescriptor descriptor = \\\n             FlightDescriptor.__new__(FlightDescriptor)\n \n+    server_state = <object> c_state\n     descriptor.descriptor = reader.get().descriptor()\n     py_reader.reader.reset(reader.release())\n     py_writer.writer.reset(writer.release())\n     try:\n-        (<object> self).do_exchange(ServerCallContext.wrap(context),\n-                                    descriptor, py_reader, py_writer)\n+        server_state.this.do_exchange(ServerCallContext.wrap(context),\n+                                      descriptor, py_reader, py_writer)\n         return CStatus_OK()\n\nReview comment:\n       Another inlined return statement.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T05:11:24.695+0000",
                    "updated": "2022-03-18T05:11:24.695+0000",
                    "started": "2022-03-18T05:11:24.694+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743584",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743585",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1072038608\n\n\n   This looks good. Simply left minor comments.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T05:11:57.266+0000",
                    "updated": "2022-03-18T05:11:57.266+0000",
                    "started": "2022-03-18T05:11:57.266+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743585",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743850",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm opened a new pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659\n\n\n   This isn't perfect because some exceptions are meant to propagate to the client, some are unintended, and it's not always clear which is which, but this should at least make development easier.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T14:41:46.149+0000",
                    "updated": "2022-03-18T14:41:46.149+0000",
                    "started": "2022-03-18T14:41:46.149+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743850",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/743928",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on a change in pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#discussion_r829694665\n\n\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1490,20 +1491,47 @@ cdef class RecordBatchStream(FlightDataStream):\n         self.data_source = data_source\n         self.write_options = _get_options(options).c_options\n \n-    cdef CFlightDataStream* to_stream(self) except *:\n+    cdef CFlightDataStream* to_stream(self, logger) except *:\n         cdef:\n             shared_ptr[CRecordBatchReader] reader\n         if isinstance(self.data_source, RecordBatchReader):\n             reader = (<RecordBatchReader> self.data_source).reader\n         elif isinstance(self.data_source, lib.Table):\n-            table = (<Table> self.data_source).table\n-            reader.reset(new TableBatchReader(deref(table)))\n+            reader.reset(new TableBatchReader(\n+                (<Table> self.data_source).sp_table))\n         else:\n             raise RuntimeError(\"Can't construct RecordBatchStream \"\n                                \"from type {}\".format(type(self.data_source)))\n         return new CRecordBatchStream(reader, self.write_options)\n \n \n+class _WithLogger(collections.namedtuple(\n+        '_WithLogger', ['this', 'logger'])):\n+    \"\"\"Combine a server object with additional logging state.\n+\n+    This avoids exposing the logger in the public API (by storing it\n+    on self, which even a name-mangled method can't avoid) and\n+    potentially clashing with application code.\n+    \"\"\"\n+\n+    def log_exception(self, method, exc):\n+        \"\"\"Log an uncaught exception in the handler for an RPC method.\"\"\"\n+        if not self.logger:\n+            return\n+        # Don't log all kinds of errors. FlightError is explicitly for\n+        # sending RPC errors; NotImplementedError is likely noise.\n+        # Other errors are unclear, so log to be safe. For instance:\n+        # both ValueError and ArrowInvalid map to INVALID_ARGUMENT,\n+        # but ValueError is likely a stray exception (so log it) and\n+        # ArrowInvalid is likely intentional (so don't)\n\nReview comment:\n       Extreme nit: `... (so don't).`  <-- period?\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1707,16 +1735,26 @@ cdef class ClientAuthSender(_Weakrefable):\n         return result\n \n \n-cdef CStatus _data_stream_next(void* self, CFlightPayload* payload) except *:\n+cdef CStatus _data_stream_next(void* c_state,\n+                               CFlightPayload* payload) except *:\n     \"\"\"Callback for implementing FlightDataStream in Python.\"\"\"\n+    server_state = <object> c_state\n+    try:\n+        if not isinstance(server_state.this, GeneratorStream):\n+            raise RuntimeError(\n+                \"self object in callback is not GeneratorStream\")\n+        stream = <GeneratorStream> server_state.this\n+        return _data_stream_do_next(stream, server_state, payload)\n+    except Exception as e:\n+        server_state.log_exception(\"do_get\", e)\n\nReview comment:\n       Is this a \"do_get\" operation?\r\n   [In `_do_get`](https://github.com/apache/arrow/pull/12659/files#diff-0ed358f5d42920d7f94cc500791976a2c158c4d72f4a6b231393534b2d13683bR1957), name is also \"do_get\".\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1866,41 +1919,49 @@ cdef CStatus _do_put(void* self, const CServerCallContext& context,\n         FlightDescriptor descriptor = \\\n             FlightDescriptor.__new__(FlightDescriptor)\n \n+    server_state = <object> c_state\n     descriptor.descriptor = reader.get().descriptor()\n     py_reader.reader.reset(reader.release())\n     py_writer.writer.reset(writer.release())\n     try:\n-        (<object> self).do_put(ServerCallContext.wrap(context), descriptor,\n-                               py_reader, py_writer)\n+        server_state.this.do_put(ServerCallContext.wrap(context), descriptor,\n+                                 py_reader, py_writer)\n         return CStatus_OK()\n\nReview comment:\n       Nit: The general convention seems to be to place `return CStatus_OK()` at end of function.\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1910,27 +1971,32 @@ cdef CStatus _do_exchange(void* self, const CServerCallContext& context,\n         FlightDescriptor descriptor = \\\n             FlightDescriptor.__new__(FlightDescriptor)\n \n+    server_state = <object> c_state\n     descriptor.descriptor = reader.get().descriptor()\n     py_reader.reader.reset(reader.release())\n     py_writer.writer.reset(writer.release())\n     try:\n-        (<object> self).do_exchange(ServerCallContext.wrap(context),\n-                                    descriptor, py_reader, py_writer)\n+        server_state.this.do_exchange(ServerCallContext.wrap(context),\n+                                      descriptor, py_reader, py_writer)\n         return CStatus_OK()\n\nReview comment:\n       Another inlined return statement.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T14:48:57.310+0000",
                    "updated": "2022-03-18T14:48:57.310+0000",
                    "started": "2022-03-18T14:48:57.309+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "743928",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/744037",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "edponce commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1072038608\n\n\n   This looks good. Simply left minor comments.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T14:59:30.161+0000",
                    "updated": "2022-03-18T14:59:30.161+0000",
                    "started": "2022-03-18T14:59:30.161+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "744037",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/744054",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1071444693\n\n\n   https://issues.apache.org/jira/browse/ARROW-15909\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T15:01:10.503+0000",
                    "updated": "2022-03-18T15:01:10.503+0000",
                    "started": "2022-03-18T15:01:10.503+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "744054",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/744323",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#discussion_r830267707\n\n\n\n##########\nFile path: python/pyarrow/_flight.pyx\n##########\n@@ -1707,16 +1735,26 @@ cdef class ClientAuthSender(_Weakrefable):\n         return result\n \n \n-cdef CStatus _data_stream_next(void* self, CFlightPayload* payload) except *:\n+cdef CStatus _data_stream_next(void* c_state,\n+                               CFlightPayload* payload) except *:\n     \"\"\"Callback for implementing FlightDataStream in Python.\"\"\"\n+    server_state = <object> c_state\n+    try:\n+        if not isinstance(server_state.this, GeneratorStream):\n+            raise RuntimeError(\n+                \"self object in callback is not GeneratorStream\")\n+        stream = <GeneratorStream> server_state.this\n+        return _data_stream_do_next(stream, server_state, payload)\n+    except Exception as e:\n+        server_state.log_exception(\"do_get\", e)\n\nReview comment:\n       Yes, basically DoGet returns a Stream and the Stream is consumed by the C++ side to finish off the call. So this is still within the DoGet RPC even if control flow is outside the Cython do_get code.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T18:48:35.639+0000",
                    "updated": "2022-03-18T18:48:35.639+0000",
                    "started": "2022-03-18T18:48:35.639+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "744323",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/744326",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1072703736\n\n\n   Thanks for the review!\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-18T18:48:51.811+0000",
                    "updated": "2022-03-18T18:48:51.811+0000",
                    "started": "2022-03-18T18:48:51.810+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "744326",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745910",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075353726\n\n\n   It's not clear to me what the intended purpose is. Why not log all exceptions?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T16:25:11.394+0000",
                    "updated": "2022-03-22T16:25:11.394+0000",
                    "started": "2022-03-22T16:25:11.393+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745910",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745935",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075381164\n\n\n   Certain exceptions are made to be raised to indicate errors to the client, and aren't meant to indicate an error condition on the server. This is rather confusing, unfortunately (hence why grpc-java differentiates the two and provides a callback to send errors to the client instead).\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T16:55:42.224+0000",
                    "updated": "2022-03-22T16:55:42.224+0000",
                    "started": "2022-03-22T16:55:42.224+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745935",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745936",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075382034\n\n\n   Perhaps we can provide such a callback too?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T16:57:25.017+0000",
                    "updated": "2022-03-22T16:57:25.017+0000",
                    "started": "2022-03-22T16:57:25.017+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745936",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745938",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075383401\n\n\n   We certainly could; that would be a breaking change. (Well, we could place it in the `context`, actually - that should be OK.) I'd prefer to tackle that separately, though\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:00:12.730+0000",
                    "updated": "2022-03-22T17:00:12.730+0000",
                    "started": "2022-03-22T17:00:12.729+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745938",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745941",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075385396\n\n\n   Well, the changes in this PR can probably be vastly simplified if we add an error callback.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:02:35.875+0000",
                    "updated": "2022-03-22T17:02:35.875+0000",
                    "started": "2022-03-22T17:02:35.874+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745941",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745942",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075388941\n\n\n   Note that CPython has a dedicated API to print unraisable errors, you may not need to use the logging module: https://docs.python.org/3/c-api/exceptions.html#c.PyErr_WriteUnraisable\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:04:23.036+0000",
                    "updated": "2022-03-22T17:04:23.036+0000",
                    "started": "2022-03-22T17:04:23.036+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745942",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745943",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075386901\n\n\n   I think most everything will stay the same, except we wouldn't filter the exceptions we log. (We could probably simplify things, though, if we used `self.__log`; I'm not a fan of exposing that to user code, even as a name-mangled property, but I don't feel too strongly about it either.)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:04:25.504+0000",
                    "updated": "2022-03-22T17:04:25.504+0000",
                    "started": "2022-03-22T17:04:25.503+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745943",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745946",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075392880\n\n\n   For that [`sys.unraisablehook()`](https://docs.python.org/3/library/sys.html#sys.unraisablehook) can be overriden. I have no preference personally, but not having to rely on a logger may make things easier compared to your current approach.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:07:19.159+0000",
                    "updated": "2022-03-22T17:07:19.159+0000",
                    "started": "2022-03-22T17:07:19.158+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745946",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745948",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075390255\n\n\n   Logging would be preferable to integrate with logging frameworks, though (e.g. if a service logs things to Datadog or some other vendor tool - that way uncaught exceptions could also be propagated)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:08:52.931+0000",
                    "updated": "2022-03-22T17:08:52.931+0000",
                    "started": "2022-03-22T17:08:52.930+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745948",
                    "issueId": "13433170"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/worklog/745951",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on pull request #12659:\nURL: https://github.com/apache/arrow/pull/12659#issuecomment-1075397713\n\n\n   Ah, interesting. That should work.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-03-22T17:14:38.180+0000",
                    "updated": "2022-03-22T17:14:38.180+0000",
                    "started": "2022-03-22T17:14:38.180+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "745951",
                    "issueId": "13433170"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 16200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@52c1677[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@32412933[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@41a5e3a0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7a964216[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21b49601[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@7b86bc93[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@15d0f8a0[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@5d1e8efe[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@581f1fc2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@16b35276[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@434adf8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2df4bafe[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 16200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Jul 12 14:04:22 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": null,
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-15909/watchers",
            "watchCount": 2,
            "isWatching": true
        },
        "created": "2022-03-10T16:24:31.000+0000",
        "updated": "2022-08-09T11:42:45.000+0000",
        "timeoriginalestimate": null,
        "description": "This is a super common pitfall and it would be nice to just handle this for users. That said given some methods are \"async\" (e.g. DoGet) there are a few places we'd have to do this logging/not all things will get fully caught, but we should at least get the basics.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "4.5h",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 16200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python][FlightRPC] Log uncaught exceptions by default",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13433170/comment/17565563",
                    "id": "17565563",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "body": "This issue was last updated over 90 days ago, which may be an indication it is no longer being actively worked. To better reflect the current state, the issue is being unassigned. Please feel free to re-take assignment of the issue if it is being actively worked, or if you plan to start that work soon.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=toddfarmer",
                        "name": "toddfarmer",
                        "key": "JIRAUSER288796",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39935",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39935",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39935",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39935"
                        },
                        "displayName": "Todd Farmer",
                        "active": true,
                        "timeZone": "America/Boise"
                    },
                    "created": "2022-07-12T14:04:22.467+0000",
                    "updated": "2022-07-12T14:04:22.467+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z10dko:",
        "customfield_12314139": null
    }
}