{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13391254",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13391254",
    "key": "ARROW-13427",
    "fields": {
        "fixVersions": [],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/10004",
            "id": "10004",
            "description": "Not A Bug",
            "name": "Not A Bug"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/6",
            "description": "The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/closed.png",
            "name": "Closed",
            "id": "6",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333556",
                "id": "12333556",
                "name": "C"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgan2012",
            "name": "jgan2012",
            "key": "jgan2012",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Jim Gan",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgan2012",
            "name": "jgan2012",
            "key": "jgan2012",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Jim Gan",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13427/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@2d2203a8[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@49d39d92[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@53074aa8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@6ed6257[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@f850aca[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@481b618a[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21a0202b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@4c320192[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6bc68184[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@78c2aa47[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@58437c0c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@4a1d807[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Thu Jul 22 18:14:03 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-07-22T18:14:03.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-13427/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-07-22T06:16:50.000+0000",
        "updated": "2021-07-22T18:14:03.000+0000",
        "timeoriginalestimate": null,
        "description": "I'm not sure if this issue is related to\u00a0\r\n\r\nhttps://issues.apache.org/jira/browse/ARROW-10054\r\n\r\n{code}\r\n[2021-07-22 02:43:17,457 INFO get_bucket_trig_feat_raw2.py:100] read batch 0\r\n/arrow/cpp/src/arrow/array/data.cc:94: Check failed: (off) <= (length) Slice offset greater than array length\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(+0x554d58)[0x7f491040bd58]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZN5arrow4util8ArrowLogD1Ev+0xdd)[0x7f491040c5ad]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZNK5arrow9ArrayData5SliceEll+0x3c5)[0x7f491054c1f5]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZNK5arrow5Array5SliceEll+0x18)[0x7f491055e708]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZN5arrow8internal23ScalarFromArraySlotImpl5VisitINS_8ListTypeEEENS_6StatusERKNS_13BaseListArrayIT_EE+0x45)[0x7f4910582ab5]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZN5arrow16VisitArrayInlineINS_8internal23ScalarFromArraySlotImplEEENS_6StatusERKNS_5ArrayEPT_+0xce)[0x7f49105904fe]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZNO5arrow8internal23ScalarFromArraySlotImpl6FinishEv+0x11b)[0x7f49105917fb]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/libarrow.so.200(_ZNK5arrow5Array9GetScalarEl+0x35)[0x7f4910569ce5]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x189e28)[0x7f4914042e28]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0xbab9c)[0x7f4913f73b9c]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0xb5368)[0x7f4913f6e368]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0xc709f)[0x7f4913f8009f]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x11785e)[0x7f4913fd085e]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x12256b)[0x7f4913fdb56b]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x13398c)[0x7f4913fec98c]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x12256b)[0x7f4913fdb56b]\r\n/usr/local/lib64/python3.6/site-packages/pyarrow/lib.cpython-36m-x86_64-linux-gnu.so(+0x146823)[0x7f4913fff823]\r\n/lib64/libpython3.6m.so.1.0(_PyCFunction_FastCallDict+0x31a)[0x7f492888f6ba]\r\n/lib64/libpython3.6m.so.1.0(+0x167a50)[0x7f492888fa50]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x16818f)[0x7f492889018f]\r\n/lib64/libpython3.6m.so.1.0(+0x139f22)[0x7f4928861f22]\r\n/lib64/libpython3.6m.so.1.0(+0x13741a)[0x7f492885f41a]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x7b6)[0x7f49288b8806]\r\n/lib64/libpython3.6m.so.1.0(+0x142a3a)[0x7f492886aa3a]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x142a3a)[0x7f492886aa3a]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(PyEval_EvalCodeEx+0x337)[0x7f492889a397]\r\n/lib64/libpython3.6m.so.1.0(PyEval_EvalCode+0x1b)[0x7f492889b0eb]\r\n/lib64/libpython3.6m.so.1.0(+0x212d00)[0x7f492893ad00]\r\n/lib64/libpython3.6m.so.1.0(_PyCFunction_FastCallDict+0x92)[0x7f492888f432]\r\n/lib64/libpython3.6m.so.1.0(+0x167a50)[0x7f492888fa50]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(+0x114497)[0x7f492883c497]\r\n/lib64/libpython3.6m.so.1.0(+0x142bf0)[0x7f492886abf0]\r\n/lib64/libpython3.6m.so.1.0(+0x167b36)[0x7f492888fb36]\r\n/lib64/libpython3.6m.so.1.0(_PyEval_EvalFrameDefault+0x474)[0x7f49288b84c4]\r\n/lib64/libpython3.6m.so.1.0(PyEval_EvalCodeEx+0x337)[0x7f492889a397]\r\n/lib64/libpython3.6m.so.1.0(+0x173153)[0x7f492889b153]\r\n/lib64/libpython3.6m.so.1.0(PyObject_Call+0x47)[0x7f492883dfb7]\r\n/lib64/libpython3.6m.so.1.0(+0x213f31)[0x7f492893bf31]\r\n/lib64/libpython3.6m.so.1.0(Py_Main+0x2f0)[0x7f492893c360]\r\n/opt/python/bin/python3.6(main+0x116)[0x55c723ec4b96]\r\n/lib64/libc.so.6(__libc_start_main+0xf3)[0x7f49279df6a3]\r\n/opt/python/bin/python3.6(_start+0x2e)[0x55c723ec4d1e]\r\n21/07/22 02:43:17,631 ERROR Executor: Exception in task 298.0 in stage 5.0 (TID 303)\r\norg.apache.spark.SparkException: Python worker exited unexpectedly (crashed)\r\n at org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:536)\r\n at org.apache.spark.api.python.BasePythonRunner$ReaderIterator$$anonfun$1.applyOrElse(PythonRunner.scala:525)\r\n at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:38)\r\n at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:643)\r\n at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:621)\r\n at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:456)\r\n at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\r\n at scala.collection.Iterator$GroupedIterator.fill(Iterator.scala:1209)\r\n at scala.collection.Iterator$GroupedIterator.hasNext(Iterator.scala:1215)\r\n at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:458)\r\n at org.apache.spark.shuffle.sort.UnsafeShuffleWriter.write(UnsafeShuffleWriter.java:177)\r\n at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)\r\n at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)\r\n at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:52)\r\n at org.apache.spark.scheduler.Task.run(Task.scala:127)\r\n at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$3(Executor.scala:472)\r\n at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1377)\r\n at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:475)\r\n at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n at java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.EOFException\r\n at java.io.DataInputStream.readInt(DataInputStream.java:392)\r\n at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:628)\r\n ... 17 more\r\n{code}",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "pa_table.to_pydict() crashed\u00a0, Check failed: (off) <= (length) Slice offset greater than array length",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": "python arrow run in spark env SparkContext: Running Spark version 3.0.4.4\r\n\r\n\r\npyarrow version 2.0.0",
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13391254/comment/17385571",
                    "id": "17385571",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Can you try with PyArrow 4.0.1? 2.0.0 is a bit old already.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-07-22T14:51:33.742+0000",
                    "updated": "2021-07-22T14:51:33.742+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13391254/comment/17385693",
                    "id": "17385693",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgan2012",
                        "name": "jgan2012",
                        "key": "jgan2012",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jim Gan",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "I switched to use PyArrrow 4.0.1 now and will see if such an error occurs again.\r\n\r\n\u00a0\r\n\r\nThe crash in to_pydict() occurred after encountering a corrupted arrow file (read size was different from actual size)\r\n\r\n\u00a0\r\n\r\nIt would be great that such crash could be prevented because it killed the long running pyspark job(pipeline).\u00a0 In my case it is OK to skip or ignore the corrupted arrow files.\r\n\r\n\u00a0\r\n\r\nI added pa_table.validate() in front of to_pydict() which seems to avoid the crash. My pipeline finished successfully with the change.\r\n\r\n\u00a0\r\n{code:java}\r\ntry:\r\n   for batch_id, batch in enumerate(arrow_stream):\r\n        pa_table = pa.Table.from_batches([batch]).select(self.schema)\r\n        # add validate() that seems to avoid the crash\r\n        pa_table.validate()\r\n        pv_dict = pa_table.to_pydict()\r\n        \r\nexcept Exception as e:\r\n   logging.error(\"file: {} got exception: {}\".format(file, str(e)))\r\n{code}\r\n\u00a0\r\n\r\nThe error messages in the log:\r\n\r\n(1) got exception: Expected to be able to read 11431400 bytes for message body, got 10389614\r\n\r\n(2) /arrow/cpp/src/arrow/array/data.cc:94: Check failed: (off) <= (length) Slice offset greater than array length",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jgan2012",
                        "name": "jgan2012",
                        "key": "jgan2012",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Jim Gan",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-07-22T18:02:03.734+0000",
                    "updated": "2021-07-22T18:08:45.612+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13391254/comment/17385702",
                    "id": "17385702",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Indeed, if you may have invalid / corrupt data, calling the {{validate()}} method is the way to check for it. This is not done by default because validation has a non-zero cost (also, full validation using {{validate(full=True)}}, while safer, may be more costly even).",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-07-22T18:13:19.412+0000",
                    "updated": "2021-07-22T18:13:19.412+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13391254/comment/17385703",
                    "id": "17385703",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Closing as not a bug, since this is caused by reading an invalid data file. The {{validate()}} method is able to catch and report the issue.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2021-07-22T18:14:03.526+0000",
                    "updated": "2021-07-22T18:14:03.526+0000"
                }
            ],
            "maxResults": 4,
            "total": 4,
            "startAt": 0
        },
        "customfield_12311820": "0|z0t81c:",
        "customfield_12314139": null
    }
}