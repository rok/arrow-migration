{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13292201",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201",
    "key": "ARROW-8136",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12346687",
                "id": "12346687",
                "description": "",
                "name": "0.17.0",
                "archived": false,
                "released": true,
                "releaseDate": "2020-04-20"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            },
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
            "name": "jorisvandenbossche",
            "key": "jorisvandenbossche",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
            },
            "displayName": "Joris Van den Bossche",
            "active": true,
            "timeZone": "Europe/Brussels"
        },
        "aggregateprogress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 13200,
            "total": 13200,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-8136/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 23,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404751",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T14:32:00.125+0000",
                    "updated": "2020-03-17T14:32:00.125+0000",
                    "started": "2020-03-17T14:32:00.125+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404751",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404763",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#issuecomment-600111118\n \n \n   https://issues.apache.org/jira/browse/ARROW-8136\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T14:46:35.704+0000",
                    "updated": "2020-03-17T14:46:35.704+0000",
                    "started": "2020-03-17T14:46:35.704+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404763",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404780",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#issuecomment-600123324\n \n \n   (going to add some more tests)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T15:08:55.615+0000",
                    "updated": "2020-03-17T15:08:55.615+0000",
                    "started": "2020-03-17T15:08:55.615+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404780",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404829",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#issuecomment-600154645\n \n \n   Appveyor passed on my fork: https://ci.appveyor.com/project/jorisvandenbossche/arrow/builds/31525720\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T16:05:34.630+0000",
                    "updated": "2020-03-17T16:05:34.630+0000",
                    "started": "2020-03-17T16:05:34.630+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404829",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404830",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "bkietz commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643\n \n \n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T16:06:33.877+0000",
                    "updated": "2020-03-17T16:06:33.877+0000",
                    "started": "2020-03-17T16:06:33.877+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404830",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404837",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#discussion_r393802530\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,11 +153,17 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem\n \n-    if filesystem is not None:\n-        return filesystem, path\n-    return FileSystem.from_uri(path)\n+    if filesystem is None:\n+        try:\n+            return FileSystem.from_uri(path)\n+        except Exception:\n \n Review comment:\n   Shouldn't you be a bit more specific here? Some filesystems might fail instantiating for other reasons (e.g. bad S3 configuration?).\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T16:19:22.421+0000",
                    "updated": "2020-03-17T16:19:22.421+0000",
                    "started": "2020-03-17T16:19:22.421+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404837",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404841",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#discussion_r393807946\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,11 +153,17 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem\n \n-    if filesystem is not None:\n-        return filesystem, path\n-    return FileSystem.from_uri(path)\n+    if filesystem is None:\n+        try:\n+            return FileSystem.from_uri(path)\n+        except Exception:\n \n Review comment:\n   Yeah, that's true (copied it from the old code without thinking about it much further).\r\n   \r\n   I suppose the problem, though, is which error? Right now, this gives an ArrowInvalid:\r\n   \r\n   ```\r\n   In [31]: pyarrow.fs.FileSystem.from_uri('blabla')  \r\n   ---------------------------------------------------------------------------\r\n   ArrowInvalid                              Traceback (most recent call last)\r\n   <ipython-input-31-64eb29ab5232> in <module>\r\n   ----> 1 pyarrow.fs.FileSystem.from_uri('blabla')\r\n   \r\n   ~/scipy/repos/arrow/python/pyarrow/_fs.pyx in pyarrow._fs.FileSystem.from_uri()\r\n   \r\n   ~/scipy/repos/arrow/python/pyarrow/error.pxi in pyarrow.lib.pyarrow_internal_check_status()\r\n   \r\n   ~/scipy/repos/arrow/python/pyarrow/error.pxi in pyarrow.lib.check_status()\r\n   \r\n   ArrowInvalid: URI has empty scheme: 'blabla'\r\n   ```\r\n   \r\n   Do you know what eg S3 gives?\r\n   \r\n   Alternatively, I could also explicitly check first if the path exists as a (relative) local file path, instead of relying on catching an error to fall back\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T16:27:06.446+0000",
                    "updated": "2020-03-17T16:27:06.446+0000",
                    "started": "2020-03-17T16:27:06.446+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404841",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404848",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#discussion_r393815526\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,11 +153,17 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem\n \n-    if filesystem is not None:\n-        return filesystem, path\n-    return FileSystem.from_uri(path)\n+    if filesystem is None:\n+        try:\n+            return FileSystem.from_uri(path)\n+        except Exception:\n \n Review comment:\n   Well, right now, it seems creating a filesystem can also give a `ArrowInvalid`, if some parameters are invalid (for example if you are giving a S3 scheme other than \"http\" or \"https\").\r\n   \r\n   In any case, `except Exception` is wrong.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T16:38:23.562+0000",
                    "updated": "2020-03-17T16:38:23.562+0000",
                    "started": "2020-03-17T16:38:23.562+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404848",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404939",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#discussion_r393942000\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,11 +153,17 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem\n \n-    if filesystem is not None:\n-        return filesystem, path\n-    return FileSystem.from_uri(path)\n+    if filesystem is None:\n+        try:\n+            return FileSystem.from_uri(path)\n+        except Exception:\n \n Review comment:\n   OK, but so catching `ArrowInvalid` (although certainly better) won't solve the actual concern about other errors being catched, right?\r\n   \r\n   So checking if the path exists as a local path might be better?\r\n   \n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T20:13:27.830+0000",
                    "updated": "2020-03-17T20:13:27.830+0000",
                    "started": "2020-03-17T20:13:27.830+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404939",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/404953",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6643: ARROW-8136: [Python] Restore creating a dataset from a relative path\nURL: https://github.com/apache/arrow/pull/6643#discussion_r393953028\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,11 +153,17 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem\n \n-    if filesystem is not None:\n-        return filesystem, path\n-    return FileSystem.from_uri(path)\n+    if filesystem is None:\n+        try:\n+            return FileSystem.from_uri(path)\n+        except Exception:\n \n Review comment:\n   > So checking if the path exists as a local path might be better?\r\n   \r\n   Yes, that sounds reasonable. At least for _reading_ a dataset...\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-17T20:34:45.657+0000",
                    "updated": "2020-03-17T20:34:45.657+0000",
                    "started": "2020-03-17T20:34:45.656+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "404953",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405418",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6655: ARROW-8136: [Python] More robust inferenc of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655\n \n \n   See https://github.com/apache/arrow/pull/6643#discussion_r393802530\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:22:38.920+0000",
                    "updated": "2020-03-18T13:22:38.920+0000",
                    "started": "2020-03-18T13:22:38.919+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405418",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405422",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on issue #6655: ARROW-8136: [Python] More robust inferenc of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#issuecomment-600623998\n \n \n   https://issues.apache.org/jira/browse/ARROW-8136\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:31:38.364+0000",
                    "updated": "2020-03-18T13:31:38.364+0000",
                    "started": "2020-03-18T13:31:38.364+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405422",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405426",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#issuecomment-600626948\n \n \n   So with this, we are back at the Windows path failure ..\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:37:42.251+0000",
                    "updated": "2020-03-18T13:37:42.251+0000",
                    "started": "2020-03-18T13:37:42.250+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405426",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405429",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394354500\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n+        if infos == FileType.NonExistent:\n \n Review comment:\n   Hmm, there's something fishy here. Shouldn't it be `infos.type == ...`?\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:43:07.383+0000",
                    "updated": "2020-03-18T13:43:07.383+0000",
                    "started": "2020-03-18T13:43:07.383+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405429",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405430",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394353964\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n \n Review comment:\n   Hmm, I don't understand why the Python filesystem wrapper doesn't get a `get_target_info` taking a single path argument. The `[0]` dance is certainly not pretty :-)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:43:07.387+0000",
                    "updated": "2020-03-18T13:43:07.387+0000",
                    "started": "2020-03-18T13:43:07.387+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405430",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405433",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394358953\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n+        if infos == FileType.NonExistent:\n \n Review comment:\n   Sorry, this is a typo, that should certainly be `infos.type`. \r\n   (and all tests are passing because we don't yet have any test that passes an URI that is not for a local file system ..)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:49:22.554+0000",
                    "updated": "2020-03-18T13:49:22.554+0000",
                    "started": "2020-03-18T13:49:22.553+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405433",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405434",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394359544\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n+        if infos == FileType.NonExistent:\n \n Review comment:\n   > (and all tests are passing because we don't yet have any test that passes an URI that is not for a local file system ..)\r\n   \r\n   Hmm, I thought so. Then you should certainly add some tests.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:50:12.154+0000",
                    "updated": "2020-03-18T13:50:12.154+0000",
                    "started": "2020-03-18T13:50:12.153+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405434",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405435",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394359544\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n+        if infos == FileType.NonExistent:\n \n Review comment:\n   > (and all tests are passing because we don't yet have any test that passes an URI that is not for a local file system ..)\r\n   \r\n   Hmm, I thought so. Then you should certainly add some tests.\r\n   \r\n   Edit: hmm, that may not be that easy. I thought of using `mockfs` but for now it will probably create a new instance every time you pass a URI. Perhaps we need a way to create named mockfs instances.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T13:52:25.361+0000",
                    "updated": "2020-03-18T13:52:25.361+0000",
                    "started": "2020-03-18T13:52:25.360+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405435",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/405450",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on pull request #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#discussion_r394400139\n \n \n\n ##########\n File path: python/pyarrow/dataset.py\n ##########\n @@ -153,15 +153,14 @@ def partitioning(schema=None, field_names=None, flavor=None):\n \n def _ensure_fs(filesystem, path):\n     # Validate or infer the filesystem from the path\n-    from pyarrow.fs import FileSystem, LocalFileSystem\n+    from pyarrow.fs import FileSystem, LocalFileSystem, FileType\n \n     if filesystem is None:\n-        try:\n+        # first check if the file exists as a local (relative) file path\n+        filesystem = LocalFileSystem()\n+        infos = filesystem.get_target_infos([path])[0]\n+        if infos == FileType.NonExistent:\n \n Review comment:\n   > Edit: hmm, that may not be that easy. I thought of using mockfs but for now it will probably create a new instance every time you pass a URI. Perhaps we need a way to create named mockfs instances.\r\n   \r\n   Yeah, I first though to use mockfs as well. But indeed, that's not possible right now to point to an existing mockfs with an URI.\r\n   \r\n   But added a test with S3 then. I confirmed that it actually failed with the original typo.\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-18T14:44:11.692+0000",
                    "updated": "2020-03-18T14:44:11.692+0000",
                    "started": "2020-03-18T14:44:11.692+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "405450",
                    "issueId": "13292201"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/worklog/406351",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jorisvandenbossche commented on issue #6655: ARROW-8136: [Python] More robust inference of local relative path in dataset\nURL: https://github.com/apache/arrow/pull/6655#issuecomment-601262375\n \n \n   @pitrou there is now an error on Windows for the S3 URI string test that I added:\r\n   \r\n   E   OSError: [WinError 123] Failed querying information for path 's3://arrow:apachearrow@mybucket/data.parquet?scheme=http&endpoint_override=localhost%3A1283'. Detail: [Windows error 123] The filename, directory name, or volume label syntax is incorrect.\r\n   \r\n   This is coming from passing the S3 URI to `LocalFileSystem().get_target_infos([..])`. I can put a try block around that call to \"solve\" this. But is the error expected? For local (absolute or relative) paths that don't exist, it doesn't given an error. Also this only fails on Windows (on linux such a path just gives a NonExistent file)\n \n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2020-03-19T16:00:18.087+0000",
                    "updated": "2020-03-19T16:00:18.087+0000",
                    "started": "2020-03-19T16:00:18.087+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "406351",
                    "issueId": "13292201"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": 13200,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@187a9606[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6d9bb5e6[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4c0114c2[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7c85ac21[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@496eb04[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@3fe9470c[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7b0ae337[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2a3facd3[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1942bc5b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@6ce64958[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@40d90ca8[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@17d76954[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 13200,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Mar 17 16:06:35 UTC 2020",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2020-03-17T16:06:34.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-8136/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2020-03-17T13:49:33.000+0000",
        "updated": "2020-03-19T17:20:30.000+0000",
        "timeoriginalestimate": null,
        "description": "Since https://github.com/apache/arrow/pull/6597, local relative paths don't work anymore:\r\n\r\n{code}\r\nIn [1]: import pyarrow.dataset as ds  \r\n\r\nIn [2]: ds.dataset(\"test.parquet\")  \r\n---------------------------------------------------------------------------\r\nArrowInvalid                              Traceback (most recent call last)\r\n<ipython-input-2-23ecfce52d13> in <module>\r\n----> 1 ds.dataset(\"test.parquet\")\r\n\r\n~/scipy/repos/arrow/python/pyarrow/dataset.py in dataset(paths_or_factories, filesystem, partitioning, format)\r\n    327 \r\n    328     if isinstance(paths_or_factories, str):\r\n--> 329         return factory(paths_or_factories, **kwargs).finish()\r\n    330 \r\n    331     if not isinstance(paths_or_factories, list):\r\n\r\n~/scipy/repos/arrow/python/pyarrow/dataset.py in factory(path_or_paths, filesystem, partitioning, format)\r\n    246     factories = []\r\n    247     for path in path_or_paths:\r\n--> 248         fs, paths_or_selector = _ensure_fs_and_paths(path, filesystem)\r\n    249         factories.append(FileSystemDatasetFactory(fs, paths_or_selector,\r\n    250                                                   format, options))\r\n\r\n~/scipy/repos/arrow/python/pyarrow/dataset.py in _ensure_fs_and_paths(path, filesystem)\r\n    165     from pyarrow.fs import FileType, FileSelector\r\n    166 \r\n--> 167     filesystem, path = _ensure_fs(filesystem, _stringify_path(path))\r\n    168     infos = filesystem.get_target_infos([path])[0]\r\n    169     if infos.type == FileType.Directory:\r\n\r\n~/scipy/repos/arrow/python/pyarrow/dataset.py in _ensure_fs(filesystem, path)\r\n    158     if filesystem is not None:\r\n    159         return filesystem, path\r\n--> 160     return FileSystem.from_uri(path)\r\n    161 \r\n    162 \r\n\r\n~/scipy/repos/arrow/python/pyarrow/_fs.pyx in pyarrow._fs.FileSystem.from_uri()\r\n\r\n~/scipy/repos/arrow/python/pyarrow/error.pxi in pyarrow.lib.pyarrow_internal_check_status()\r\n\r\n~/scipy/repos/arrow/python/pyarrow/error.pxi in pyarrow.lib.check_status()\r\n\r\nArrowInvalid: URI has empty scheme: 'test.parquet'\r\n\r\n{code}\r\n\r\n[~apitrou] Is this something that should be fixed in {{FileSystemFromUriOrPath}} or rather on the python side? ({{FileSystem.from_uri}} ensures to get the absolute path for Pathlib objects, but not for strings)",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 13200
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++][Python] Creating dataset from relative path no longer working",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17060924",
                    "id": "17060924",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "There is no reliable way to distinguish between a relative path or a URI.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-03-17T13:56:07.953+0000",
                    "updated": "2020-03-17T13:56:07.953+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17060930",
                    "id": "17060930",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "Still, users do this _all the time_ (myself included), we support it in other places (eg {{pyarrow.parquet.read_table}}), ... So I personally think we will need to add support for it in some way.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-03-17T13:59:39.279+0000",
                    "updated": "2020-03-17T13:59:57.420+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17060933",
                    "id": "17060933",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Perhaps we can hack up something on the Python side. But it may still fail for _some_ local paths, e.g. \"{{test:demo.parquet}}\".",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-03-17T14:02:10.024+0000",
                    "updated": "2020-03-17T14:02:10.024+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17060937",
                    "id": "17060937",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "body": "We also actually support relative paths in {{FileSystem.get_target_infos}}",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jorisvandenbossche",
                        "name": "jorisvandenbossche",
                        "key": "jorisvandenbossche",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Joris Van den Bossche",
                        "active": true,
                        "timeZone": "Europe/Brussels"
                    },
                    "created": "2020-03-17T14:05:14.800+0000",
                    "updated": "2020-03-17T14:05:14.800+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17060943",
                    "id": "17060943",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "What does {{get_target_infos}} have to do with it? It doesn't take a URI.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2020-03-17T14:11:34.799+0000",
                    "updated": "2020-03-17T14:11:34.799+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13292201/comment/17061023",
                    "id": "17061023",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "body": "Issue resolved by pull request 6643\n[https://github.com/apache/arrow/pull/6643]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=bkietz",
                        "name": "bkietz",
                        "key": "bkietz",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=bkietz&avatarId=37277",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=bkietz&avatarId=37277",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=bkietz&avatarId=37277",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=bkietz&avatarId=37277"
                        },
                        "displayName": "Ben Kietzman",
                        "active": true,
                        "timeZone": "America/New_York"
                    },
                    "created": "2020-03-17T16:06:35.045+0000",
                    "updated": "2020-03-17T16:06:35.045+0000"
                }
            ],
            "maxResults": 6,
            "total": 6,
            "startAt": 0
        },
        "customfield_12311820": "0|z0cm48:",
        "customfield_12314139": null
    }
}