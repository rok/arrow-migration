{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13360450",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450",
    "key": "ARROW-11752",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12349493",
                "id": "12349493",
                "description": "",
                "name": "4.0.0",
                "archived": false,
                "released": true,
                "releaseDate": "2021-04-26"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/4",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg",
            "name": "Minor",
            "id": "4"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=thisisnic",
            "name": "thisisnic",
            "key": "thisisnic",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=39937",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=39937",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=39937",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=39937"
            },
            "displayName": "Nicola Crane",
            "active": true,
            "timeZone": "Africa/Casablanca"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12333008",
                "id": "12333008",
                "name": "R"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
            "name": "npr",
            "key": "npr",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
            },
            "displayName": "Neal Richardson",
            "active": true,
            "timeZone": "America/Los_Angeles"
        },
        "aggregateprogress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 12000,
            "total": 12000,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11752/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 20,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577667",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic opened a new pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909\n\n\n   `testthat::expect_is` is now deprecated - this PR replaces uses of it with alternative functions.  When updating `expect_dplyr_error`, I fixed an issue with its usage which led to one of the tests failing as it no longer gives the expected error, so have set this test to skip.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T15:05:54.257+0000",
                    "updated": "2021-04-06T15:05:54.257+0000",
                    "started": "2021-04-06T15:05:54.257+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577667",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577807",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#issuecomment-814336024\n\n\n   https://issues.apache.org/jira/browse/ARROW-11752\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T18:16:48.828+0000",
                    "updated": "2021-04-06T18:16:48.828+0000",
                    "started": "2021-04-06T18:16:48.828+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577807",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577872",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r607945460\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -23,6 +23,11 @@ expect_data_frame <- function(x, y, ...) {\n   expect_equal(as.data.frame(x), y, ...)\n }\n \n+expect_r6_class <- function(object, class){\n+  expect_s3_class(object, class)\n+  expect_s3_class(object, c(\"R6\"))\n\nReview comment:\n       This is super minor, but we don't need the `c(` and `)` here.\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -272,7 +272,7 @@ test_that(\"filter() with string ops\", {\n \n test_that(\"filter environment scope\", {\n   # \"object 'b_var' not found\"\n-  expect_dplyr_error(input %>% filter(batch, chr == b_var))\n+  expect_dplyr_error(filter(batch, chr == b_var), tbl)\n\nReview comment:\n       This one ended up being more complicated than I realized! It turns out that both `expect_dplyr_error()` had issues *and* these tests did. This isn't at all your fault, these tests weren't doing the right thing \r\n   \r\n   We want to keep the `input %>%` part here, that [gets (tidily) evaled](https://github.com/thisisnic/arrow/blob/arrow-11752/r/tests/testthat/helper-expectation.R#L111) and replaces the `input` with whatever is being given in `tbl`.\r\n   \r\n   Additionally, that `batch` that is here when we started is just plain wrong. I looked through git history to figure out why I put it there, but cannot find a compelling reason or explanation.\r\n   \r\n    What we want on this line is something like:\r\n    \r\n    ```\r\n      expect_dplyr_error(input %>% filter(chr == b_var), tbl)\r\n    ```\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  tbl\n\nReview comment:\n       We might consider using `force()` here. It won't do anything different as far as I know, but it's what I've seen elsewhere used to mark that this object should be evaluated here.\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  tbl\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n     error = function (e) conditionMessage(e)\n\nReview comment:\n       ```suggestion\r\n       error = function (e) {\r\n             msg <- conditionMessage(e)\r\n   \r\n         # The error here is of the form:\r\n         #\r\n         # Problem with `filter()` input `..1`.\r\n         # x object 'b_var' not found\r\n         # \u2139 Input `..1` is `chr == b_var`.\r\n         #\r\n         # but what we really care about is the `x` block\r\n         # so (temporarily) let's pull those blocks out when we find them\r\n         if (grepl(\"object '.*'.not.found\", msg)) {\r\n           return(gsub(\"^.*(object '.*'.not found).*$\", \"\\\\1\", msg))\r\n         }\r\n         if (grepl('could not find function \".*\"', msg)) {\r\n           return(gsub('^.*(could not find function \".*\").*$', \"\\\\1\", msg))\r\n         }\r\n         invisible(structure(msg, class = \"try-error\", condition = e))\r\n       }\r\n   ```\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n\nReview comment:\n       I did a bunch of digging through this + through git history to figure out what is going on here, and `expect_dplyr_error()` has a few issues on top of the one that you've caught here. This setup is super confusing since both the helper and the tests were wrong in different ways, making debugging this super hard (congrats on getting as much as you did here on your first PR, I wouldn't have gotten close to this!)\r\n   \r\n   Ultimately what we want is for `expect_dplyr_error()` to evaluate the expression both as a standard R / dplyr based expression and then also as an arrow-backed dplyr expression and then we compare that the errors we get from the pure-dplyr version are the same as the errors we get from the arrow version.\r\n    \r\n    _it turns out_ that the way that dplyr errors / the way that we catch them here isn't quite right and so the tests below will fail.\r\n    \r\n    I resurrected the code I suggest below from git history + some gsubing on the errors. The crux of the issue so far is:\r\n   \r\n   dplyr returns on error with the form:\r\n   ```\r\n   Problem with `filter()` input `..1`.\r\n   x object 'b_var' not found\r\n   \u2139 Input `..1` is `chr == b_var`.\r\n   ```\r\n   \r\n   but what we really care about is just the `x` block:\r\n   `object 'b_var' not found`\r\n   \r\n   Which is all that arrow returns, but that should be good enough for us to consider them having the same error behavior.\r\n   \r\n   The code I added below is probably not the right way to do this (since we would only be able to test a handful of error types this way) but I wanted to confirm that was what was going on. \n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -389,11 +390,14 @@ test_that(\"filter() with .data pronoun\", {\n     tbl\n   )\n \n+  skip(\"test now faulty as code no longer gives error\")\n   # but there is an error if we don't override the masking with `.env`\n   expect_dplyr_error(\n     tbl %>%\n\nReview comment:\n       This `tbl %>%` we'll want to change to `input %>%` as well.\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -283,7 +283,8 @@ test_that(\"filter environment scope\", {\n   )\n   # Also for functions\n   # 'could not find function \"isEqualTo\"' because we haven't defined it yet\n-  expect_dplyr_error(filter(batch, isEqualTo(int, 4)))\n+  expect_dplyr_error(filter(batch, isEqualTo(int, 4)), tbl)\n\nReview comment:\n       ```suggestion\r\n     expect_dplyr_error(input %>% filter(isEqualTo(int, 4)), tbl)\r\n   ```\r\n   \r\n   Like above, this test was wrong to start with, something like this is what we want here.\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -389,11 +390,14 @@ test_that(\"filter() with .data pronoun\", {\n     tbl\n   )\n \n+  skip(\"test now faulty as code no longer gives error\")\n\nReview comment:\n       When you come back to this, could you put here what the output is that you get when you unskip this? I don't think that the changes we made above to `expect_dplyr_error` will magically fix this, but I think there is something else going on here.\n\n##########\nFile path: r/tests/testthat/test-read-write.R\n##########\n@@ -119,7 +119,7 @@ test_that(\"reading/writing a raw vector (sparklyr integration)\", {\n     as.data.frame(RecordBatchStreamReader$create(x)$read_next_batch())\n   }\n   bytes <- write_to_raw(example_data)\n-  expect_is(bytes, \"raw\")\n+  expect_true(is.raw(bytes))\n\nReview comment:\n       Could we use `expect_type()` here?\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -23,6 +23,11 @@ expect_data_frame <- function(x, y, ...) {\n   expect_equal(as.data.frame(x), y, ...)\n }\n \n+expect_r6_class <- function(object, class){\n\nReview comment:\n       Nice helper!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:26:13.795+0000",
                    "updated": "2021-04-06T20:26:13.795+0000",
                    "started": "2021-04-06T20:26:13.795+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577872",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577877",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608161039\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -283,7 +283,8 @@ test_that(\"filter environment scope\", {\n   )\n   # Also for functions\n   # 'could not find function \"isEqualTo\"' because we haven't defined it yet\n-  expect_dplyr_error(filter(batch, isEqualTo(int, 4)))\n+  expect_dplyr_error(filter(batch, isEqualTo(int, 4)), tbl)\n\nReview comment:\n       @jonkeane despite the comment in the definition of `expect_dplyr_error()` saying that the expression should be\r\n   >A dplyr pipeline with `input` as its start\r\n   \r\n   It does not actually need to _start_ with `input`. So the use of the pipe vs. the first-argument here is not significant. The replacement of `batch` with `input` _is_ of course significant.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:32:46.561+0000",
                    "updated": "2021-04-06T20:32:46.561+0000",
                    "started": "2021-04-06T20:32:46.560+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577877",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577880",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608162415\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -283,7 +283,8 @@ test_that(\"filter environment scope\", {\n   )\n   # Also for functions\n   # 'could not find function \"isEqualTo\"' because we haven't defined it yet\n-  expect_dplyr_error(filter(batch, isEqualTo(int, 4)))\n+  expect_dplyr_error(filter(batch, isEqualTo(int, 4)), tbl)\n\nReview comment:\n       Yeah, absolutely. I tried to find where `batch` came from here because it's a mystery to me \u2014 do you have any ideas? Other than a bad copy-pasta?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:35:10.147+0000",
                    "updated": "2021-04-06T20:35:10.147+0000",
                    "started": "2021-04-06T20:35:10.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577880",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577882",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ianmcook commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608163370\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -283,7 +283,8 @@ test_that(\"filter environment scope\", {\n   )\n   # Also for functions\n   # 'could not find function \"isEqualTo\"' because we haven't defined it yet\n-  expect_dplyr_error(filter(batch, isEqualTo(int, 4)))\n+  expect_dplyr_error(filter(batch, isEqualTo(int, 4)), tbl)\n\nReview comment:\n       \ud83e\udd37\u200d\u2642\ufe0f \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:36:46.368+0000",
                    "updated": "2021-04-06T20:36:46.368+0000",
                    "started": "2021-04-06T20:36:46.368+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577882",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577885",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608164693\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  tbl\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n     error = function (e) conditionMessage(e)\n\nReview comment:\n       @jonkeane I don't fully understand why this is necessary, but as it turns out your regular expressions are already encapsulated in `i18ize_error_messages()` (https://github.com/apache/arrow/blob/master/r/R/dplyr.R#L374), so maybe that can be reused.\r\n   \r\n   Also I believe you just want to return `msg` from this, not a `try-error`, at least that's the current behavior and also what the early returns you added do.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:39:05.363+0000",
                    "updated": "2021-04-06T20:39:05.363+0000",
                    "started": "2021-04-06T20:39:05.363+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577885",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577893",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "jonkeane commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608171625\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  tbl\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n     error = function (e) conditionMessage(e)\n\nReview comment:\n       Yeah, returning `msg` makes sense there, I dug the core of this from git history and that's what we returned when those `grepl()`s didn't find anything before \u2014 though I bet it wasn't exercised. Returning simply `msg` sounds right.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T20:51:04.868+0000",
                    "updated": "2021-04-06T20:51:04.868+0000",
                    "started": "2021-04-06T20:51:04.868+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577893",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/577945",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608205253\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -283,7 +283,8 @@ test_that(\"filter environment scope\", {\n   )\n   # Also for functions\n   # 'could not find function \"isEqualTo\"' because we haven't defined it yet\n-  expect_dplyr_error(filter(batch, isEqualTo(int, 4)))\n+  expect_dplyr_error(filter(batch, isEqualTo(int, 4)), tbl)\n\nReview comment:\n       `batch` is defined near the top of `test-dplyr.R`, where this test was before I broke it out into a separate file.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-06T21:54:13.710+0000",
                    "updated": "2021-04-06T21:54:13.710+0000",
                    "started": "2021-04-06T21:54:13.710+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "577945",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578288",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608563789\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -23,6 +23,11 @@ expect_data_frame <- function(x, y, ...) {\n   expect_equal(as.data.frame(x), y, ...)\n }\n \n+expect_r6_class <- function(object, class){\n+  expect_s3_class(object, class)\n+  expect_s3_class(object, c(\"R6\"))\n\nReview comment:\n       Oops, deleted now!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:20:31.933+0000",
                    "updated": "2021-04-07T11:20:31.933+0000",
                    "started": "2021-04-07T11:20:31.932+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578288",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578289",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608563970\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,16 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  tbl\n\nReview comment:\n       Done!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:20:44.977+0000",
                    "updated": "2021-04-07T11:20:44.977+0000",
                    "started": "2021-04-07T11:20:44.977+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578289",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578290",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608564469\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -272,7 +272,7 @@ test_that(\"filter() with string ops\", {\n \n test_that(\"filter environment scope\", {\n   # \"object 'b_var' not found\"\n-  expect_dplyr_error(input %>% filter(batch, chr == b_var))\n+  expect_dplyr_error(filter(batch, chr == b_var), tbl)\n\nReview comment:\n       That makes sense; updated now!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:21:40.005+0000",
                    "updated": "2021-04-07T11:21:40.005+0000",
                    "started": "2021-04-07T11:21:40.005+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578290",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578291",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608564920\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -389,11 +390,14 @@ test_that(\"filter() with .data pronoun\", {\n     tbl\n   )\n \n+  skip(\"test now faulty as code no longer gives error\")\n   # but there is an error if we don't override the masking with `.env`\n   expect_dplyr_error(\n     tbl %>%\n\nReview comment:\n       Sorted!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:22:23.142+0000",
                    "updated": "2021-04-07T11:22:23.142+0000",
                    "started": "2021-04-07T11:22:23.142+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578291",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578292",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608565185\n\n\n\n##########\nFile path: r/tests/testthat/test-dplyr-filter.R\n##########\n@@ -389,11 +390,14 @@ test_that(\"filter() with .data pronoun\", {\n     tbl\n   )\n \n+  skip(\"test now faulty as code no longer gives error\")\n\nReview comment:\n       Cool, done! :)\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:22:46.313+0000",
                    "updated": "2021-04-07T11:22:46.313+0000",
                    "started": "2021-04-07T11:22:46.312+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578292",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/578294",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r608567208\n\n\n\n##########\nFile path: r/tests/testthat/test-read-write.R\n##########\n@@ -119,7 +119,7 @@ test_that(\"reading/writing a raw vector (sparklyr integration)\", {\n     as.data.frame(RecordBatchStreamReader$create(x)$read_next_batch())\n   }\n   bytes <- write_to_raw(example_data)\n-  expect_is(bytes, \"raw\")\n+  expect_true(is.raw(bytes))\n\nReview comment:\n       Aha, we can! I was getting mixed up as I'd been accidentally using `arrow::type` instead of `base::typeof` to inspect objects, everything makes a lot more sense now.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-07T11:26:23.217+0000",
                    "updated": "2021-04-07T11:26:23.217+0000",
                    "started": "2021-04-07T11:26:23.216+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "578294",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/580118",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "nealrichardson commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r610751324\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n\nReview comment:\n       This line appears oddly indented\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n+\n+      # The error here is of the form:\n+      #\n+      # Problem with `filter()` input `..1`.\n+      # x object 'b_var' not found\n+      # \u2139 Input `..1` is `chr == b_var`.\n+      #\n+      # but what we really care about is the `x` block\n+      # so (temporarily) let's pull those blocks out when we find them\n+      if (grepl(\"object '.*'.not.found\", msg)) {\n+        return(gsub(\"^.*(object '.*'.not found).*$\", \"\\\\1\", msg))\n+      }\n+      if (grepl('could not find function \".*\"', msg)) {\n+        return(gsub('^.*(could not find function \".*\").*$', \"\\\\1\", msg))\n+      }\n+      invisible(structure(msg, class = \"try-error\", condition = e))\n\nReview comment:\n       How about this? Uses the same regex pattern we already have encoded for this elsewhere.\r\n   \r\n   ```suggestion\r\n         pattern <- i18ize_error_messages()\r\n         if (grepl(pattern, msg)) {\r\n           msg <- sub(paste0(\"^.*(\", pattern, \").*$\"), \"\\\\1\", msg))\r\n         }\r\n         msg\r\n   ```\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n+\n+      # The error here is of the form:\n+      #\n+      # Problem with `filter()` input `..1`.\n+      # x object 'b_var' not found\n+      # \u2139 Input `..1` is `chr == b_var`.\n+      #\n+      # but what we really care about is the `x` block\n+      # so (temporarily) let's pull those blocks out when we find them\n+      if (grepl(\"object '.*'.not.found\", msg)) {\n+        return(gsub(\"^.*(object '.*'.not found).*$\", \"\\\\1\", msg))\n+      }\n+      if (grepl('could not find function \".*\"', msg)) {\n+        return(gsub('^.*(could not find function \".*\").*$', \"\\\\1\", msg))\n+      }\n+      invisible(structure(msg, class = \"try-error\", condition = e))\n+    }\n   )\n-  expect_is(msg, \"character\", label = \"dplyr on data.frame did not error\")\n+  # make sure msg is a character object (i.e. there has been an error)\n+  expect_type(msg, \"character\")\n\nReview comment:\n       ```suggestion\r\n     # If it did not error, we would get a data.frame or whatever\r\n     # This expectation will tell us \"dplyr on data.frame errored is not TRUE\"\r\n     expect_true(identical(typeof(msg), \"character\"), label = \"dplyr on data.frame errored\")\r\n   ```\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-09T16:21:34.535+0000",
                    "updated": "2021-04-09T16:21:34.535+0000",
                    "started": "2021-04-09T16:21:34.535+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580118",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/580834",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r611436837\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n+\n+      # The error here is of the form:\n+      #\n+      # Problem with `filter()` input `..1`.\n+      # x object 'b_var' not found\n+      # \u2139 Input `..1` is `chr == b_var`.\n+      #\n+      # but what we really care about is the `x` block\n+      # so (temporarily) let's pull those blocks out when we find them\n+      if (grepl(\"object '.*'.not.found\", msg)) {\n+        return(gsub(\"^.*(object '.*'.not found).*$\", \"\\\\1\", msg))\n+      }\n+      if (grepl('could not find function \".*\"', msg)) {\n+        return(gsub('^.*(could not find function \".*\").*$', \"\\\\1\", msg))\n+      }\n+      invisible(structure(msg, class = \"try-error\", condition = e))\n\nReview comment:\n       Thanks! Will give this a go.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-12T08:42:15.309+0000",
                    "updated": "2021-04-12T08:42:15.309+0000",
                    "started": "2021-04-12T08:42:15.309+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580834",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/580898",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r611546649\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n\nReview comment:\n       You're right, fixed now.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-12T11:27:42.943+0000",
                    "updated": "2021-04-12T11:27:42.943+0000",
                    "started": "2021-04-12T11:27:42.943+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580898",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/580899",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "thisisnic commented on a change in pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909#discussion_r611546778\n\n\n\n##########\nFile path: r/tests/testthat/helper-expectation.R\n##########\n@@ -98,12 +103,34 @@ expect_dplyr_equal <- function(expr, # A dplyr pipeline with `input` as its star\n expect_dplyr_error <- function(expr, # A dplyr pipeline with `input` as its start\n                                tbl,  # A tbl/df as reference, will make RB/Table with\n                                ...) {\n+  # ensure we have supplied tbl\n+  force(tbl)\n+  \n   expr <- rlang::enquo(expr)\n   msg <- tryCatch(\n     rlang::eval_tidy(expr, rlang::new_data_mask(rlang::env(input = tbl))),\n-    error = function (e) conditionMessage(e)\n+    error = function (e) {\n+          msg <- conditionMessage(e)\n+\n+      # The error here is of the form:\n+      #\n+      # Problem with `filter()` input `..1`.\n+      # x object 'b_var' not found\n+      # \u2139 Input `..1` is `chr == b_var`.\n+      #\n+      # but what we really care about is the `x` block\n+      # so (temporarily) let's pull those blocks out when we find them\n+      if (grepl(\"object '.*'.not.found\", msg)) {\n+        return(gsub(\"^.*(object '.*'.not found).*$\", \"\\\\1\", msg))\n+      }\n+      if (grepl('could not find function \".*\"', msg)) {\n+        return(gsub('^.*(could not find function \".*\").*$', \"\\\\1\", msg))\n+      }\n+      invisible(structure(msg, class = \"try-error\", condition = e))\n\nReview comment:\n       Worked perfectly, cheers!\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-12T11:27:55.881+0000",
                    "updated": "2021-04-12T11:27:55.881+0000",
                    "started": "2021-04-12T11:27:55.881+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "580899",
                    "issueId": "13360450"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/worklog/581695",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "kszucs closed pull request #9909:\nURL: https://github.com/apache/arrow/pull/9909\n\n\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-04-13T11:02:26.958+0000",
                    "updated": "2021-04-13T11:02:26.958+0000",
                    "started": "2021-04-13T11:02:26.957+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "581695",
                    "issueId": "13360450"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
            "id": "4",
            "description": "An improvement or enhancement to an existing feature or task.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
            "name": "Improvement",
            "subtask": false,
            "avatarId": 21140
        },
        "timespent": 12000,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@6a9c60d0[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5570a549[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2fba6c04[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@7fb0de57[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4388842c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@2dd838b6[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@51febb45[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@2845954b[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2febcd8b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@439a4d48[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@671ae2ed[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@6371cc88[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 12000,
        "customfield_12312520": null,
        "customfield_12312521": "Tue Apr 13 11:02:21 UTC 2021",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2021-04-13T11:02:21.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-11752/watchers",
            "watchCount": 3,
            "isWatching": false
        },
        "created": "2021-02-23T22:11:42.000+0000",
        "updated": "2021-04-13T11:02:27.000+0000",
        "timeoriginalestimate": null,
        "description": "Per https://testthat.r-lib.org/reference/expect_is.html it has been superceded. We have ~180 instances of it in our tests that should be upgraded.",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "3h 20m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 12000
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[R] Replace usage of testthat::expect_is()",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/comment/17314052",
                    "id": "17314052",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "Many (though not all!) of our uses are testing our own R6 class objects which isn't totally obvious how to test. https://github.com/r-lib/testthat/issues/1271 suggests using {{expect_s3_class(object, \"R6classname\")}} We could (and probably should to match the accepted wisdom?) do that. We could also write our own helper something like {{expect_r6_class}} that uses {{expect_s3_class}} and then also checks that the object is _also_ an R6 object.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-04-02T19:39:17.760+0000",
                    "updated": "2021-04-02T19:39:17.760+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/comment/17314081",
                    "id": "17314081",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "One of the quickest ways to get the R package tests working is to  use {{make test}} from the {{arrow/r}} directory. That will run install the current version of the arrow r package, set up some environment variables for the run and run the tests for you. https://github.com/apache/arrow/blob/master/r/Makefile#L26-L28 for more details on what that's doing.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=jonkeane",
                        "name": "jonkeane",
                        "key": "jonkeane",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34057",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34057",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34057",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34057"
                        },
                        "displayName": "Jonathan Keane",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2021-04-02T20:54:52.530+0000",
                    "updated": "2021-04-02T20:54:52.530+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13360450/comment/17320081",
                    "id": "17320081",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "body": "Issue resolved by pull request 9909\n[https://github.com/apache/arrow/pull/9909]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=kszucs",
                        "name": "kszucs",
                        "key": "kszucs",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "Krisztian Szucs",
                        "active": true,
                        "timeZone": "Europe/Budapest"
                    },
                    "created": "2021-04-13T11:02:21.282+0000",
                    "updated": "2021-04-13T11:02:21.282+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|z0nzj4:",
        "customfield_12314139": null
    }
}