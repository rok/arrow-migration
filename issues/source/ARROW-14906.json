{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13414341",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341",
    "key": "ARROW-14906",
    "fields": {
        "parent": {
            "id": "13414334",
            "key": "ARROW-14902",
            "self": "https://issues.apache.org/jira/rest/api/2/issue/13414334",
            "fields": {
                "summary": "[R] Update write_csv_arrow() to support all args of readr::write_csv()",
                "status": {
                    "self": "https://issues.apache.org/jira/rest/api/2/status/1",
                    "description": "The issue is open and ready for the assignee to start work on it.",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
                    "name": "Open",
                    "id": "1",
                    "statusCategory": {
                        "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                        "id": 2,
                        "key": "new",
                        "colorName": "blue-gray",
                        "name": "To Do"
                    }
                },
                "priority": {
                    "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
                    "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
                    "name": "Major",
                    "id": "3"
                },
                "issuetype": {
                    "self": "https://issues.apache.org/jira/rest/api/2/issuetype/4",
                    "id": "4",
                    "description": "An improvement or enhancement to an existing feature or task.",
                    "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype",
                    "name": "Improvement",
                    "subtask": false,
                    "avatarId": 21140
                }
            }
        },
        "fixVersions": [],
        "resolution": null,
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "good-first-issue",
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": 0,
        "customfield_12312330": null,
        "versions": [],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": null,
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/1",
            "description": "The issue is open and ready for the assignee to start work on it.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png",
            "name": "Open",
            "id": "1",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2",
                "id": 2,
                "key": "new",
                "colorName": "blue-gray",
                "name": "To Do"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328935",
                "id": "12328935",
                "name": "C++"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": 0,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=dragosmg",
            "name": "dragosmg",
            "key": "dragosmg",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34061",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34061",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34061",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34061"
            },
            "displayName": "Drago\u0219 Moldovan-Gr\u00fcnfeld",
            "active": true,
            "timeZone": "Etc/UTC"
        },
        "aggregateprogress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 9600,
            "total": 9600,
            "percent": 100
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14906/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 16,
            "worklogs": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/690496",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11857:\nURL: https://github.com/apache/arrow/pull/11857#issuecomment-986009711\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-04T11:04:53.146+0000",
                    "updated": "2021-12-04T11:04:53.146+0000",
                    "started": "2021-12-04T11:04:53.146+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "690496",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/690647",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "github-actions[bot] commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-986245280\n\n\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-05T14:58:31.320+0000",
                    "updated": "2021-12-05T14:58:31.320+0000",
                    "started": "2021-12-05T14:58:31.320+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "690647",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691020",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763031350\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       Shouldn't we also test for the escape char?\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       (Though, once merged with #11849: that PR uses CountQuotes to check that quotes don't appear when quoting is disabled, however, we need to make sure that doesn't cause spurious errors if the escape character appears in an unquoted cell. So looks like we need both CountQuotes and CountEscapes.)\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       Also CountEscapes (or CountQuotes) will also need to test for the escape char.\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -184,9 +185,11 @@ class UnquotedColumnPopulator : public ColumnPopulator {\n // a quote character (\") and escaping is done my adding another quote.\n class QuotedColumnPopulator : public ColumnPopulator {\n\nReview comment:\n       Note the above docstring is outdated now.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T14:13:57.139+0000",
                    "updated": "2021-12-06T14:13:57.139+0000",
                    "started": "2021-12-06T14:13:57.139+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691020",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691045",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ahadnagy commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763060850\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       https://www.rdocumentation.org/packages/readr/versions/1.3.1/topics/write_delim\r\n   If I understand correctly, the R function we're trying to align with only escapes quotes.\r\n   \r\n   (Correspond line in the Vroom source: https://github.com/r-lib/vroom/blob/c5b115b1b5f21852886d6407317386b215706239/src/vroom_write.cc#L146)\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T14:33:57.683+0000",
                    "updated": "2021-12-06T14:33:57.683+0000",
                    "started": "2021-12-06T14:33:57.683+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691045",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691047",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ahadnagy commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763060850\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       https://www.rdocumentation.org/packages/readr/versions/1.3.1/topics/write_delim\r\n   If I understand correctly, the R function we're trying to align with only escapes quotes.\r\n   \r\n   (Corresponding line in the Vroom source: https://github.com/r-lib/vroom/blob/c5b115b1b5f21852886d6407317386b215706239/src/vroom_write.cc#L146)\r\n   \n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T14:34:56.459+0000",
                    "updated": "2021-12-06T14:34:56.459+0000",
                    "started": "2021-12-06T14:34:56.459+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691047",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691051",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763064982\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -126,13 +126,14 @@ class ColumnPopulator {\n \n // Copies the contents of to out properly escaping any necessary characters.\n // Returns the position prior to last copied character (out_end is decremented).\n-char* EscapeReverse(arrow::util::string_view s, char* out_end) {\n+char* EscapeReverse(arrow::util::string_view s, char* out_end, bool escaping,\n+                    char escape_char) {\n   for (const char* val = s.data() + s.length() - 1; val >= s.data(); val--, out_end--) {\n-    if (*val == '\"') {\n-      *out_end = *val;\n+    *out_end = *val;\n+    if (escaping && *val == '\"') {\n\nReview comment:\n       Ah, I see. Then that simplifies things greatly.\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T14:38:08.399+0000",
                    "updated": "2021-12-06T14:38:08.399+0000",
                    "started": "2021-12-06T14:38:08.398+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691051",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691137",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763117754\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -390,7 +407,7 @@ class CSVWriterImpl : public ipc::RecordBatchWriter {\n     for (int col = 0; col < schema_->num_fields(); col++) {\n       const std::string& col_name = schema_->field(col)->name();\n       header_length += col_name.size();\n-      header_length += CountEscapes(col_name);\n+      header_length += options_.escaping ? CountEscapes(col_name) : 0;\n\nReview comment:\n       The same goes here, if escaping is disabled, we should ensure that no escaping is actually required.\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -390,7 +407,7 @@ class CSVWriterImpl : public ipc::RecordBatchWriter {\n     for (int col = 0; col < schema_->num_fields(); col++) {\n       const std::string& col_name = schema_->field(col)->name();\n       header_length += col_name.size();\n-      header_length += CountEscapes(col_name);\n+      header_length += options_.escaping ? CountEscapes(col_name) : 0;\n\nReview comment:\n       (We should also cover these with tests.)\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -195,11 +199,17 @@ class QuotedColumnPopulator : public ColumnPopulator {\n     VisitArrayDataInline<StringType>(\n         *input.data(),\n         [&](arrow::util::string_view s) {\n-          int64_t escaped_count = CountEscapes(s);\n-          // TODO: Maybe use 64 bit row lengths or safe cast?\n-          row_needs_escaping_[row_number] = escaped_count > 0;\n-          row_lengths[row_number] += static_cast<int32_t>(s.length()) +\n-                                     static_cast<int32_t>(escaped_count + kQuoteCount);\n+          if (escaping_) {\n+            int64_t escaped_count = CountEscapes(s);\n\nReview comment:\n       If escaping is disabled, perhaps we should still count escapes and error if the number is non-zero?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T15:49:02.472+0000",
                    "updated": "2021-12-06T15:49:02.472+0000",
                    "started": "2021-12-06T15:49:02.472+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691137",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691216",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-986959254\n\n\n   Hmm, wouldn't it be better to wait for PR #11849 before continuing work on this one?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T16:51:50.447+0000",
                    "updated": "2021-12-06T16:51:50.447+0000",
                    "started": "2021-12-06T16:51:50.447+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691216",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/691380",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "emkornfield commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r763434419\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -253,6 +263,8 @@ class QuotedColumnPopulator : public ColumnPopulator {\n   // at some point we should change this to use memory_pool\n   // backed allocator.\n   std::vector<bool> row_needs_escaping_;\n+  bool escaping_;\n\nReview comment:\n       nit: const for this and escape_char_\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-06T22:04:51.229+0000",
                    "updated": "2021-12-06T22:04:51.229+0000",
                    "started": "2021-12-06T22:04:51.228+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "691380",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/694099",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "lidavidm commented on a change in pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#discussion_r766826456\n\n\n\n##########\nFile path: cpp/src/arrow/csv/writer.cc\n##########\n@@ -462,25 +483,32 @@ class CSVWriterImpl : public ipc::RecordBatchWriter {\n     return Status::OK();\n   }\n \n-  int64_t CalculateHeaderSize() const {\n+  Result<int64_t> CalculateHeaderSize() const {\n     int64_t header_length = 0;\n     for (int col = 0; col < schema_->num_fields(); col++) {\n       const std::string& col_name = schema_->field(col)->name();\n+      int64_t escaped_count = CountQuotes(col_name);\n+      if (!options_.escaping && escaped_count > 0) {\n+        return Status::Invalid(\"Need to escape in CSV header, but escaping is disabled.\");\n+      }\n       header_length += col_name.size();\n-      header_length += CountQuotes(col_name);\n+      header_length += escaped_count;\n     }\n     return header_length + (kQuoteDelimiterCount * schema_->num_fields());\n   }\n \n   Status WriteHeader() {\n     // Only called once, as part of initialization\n-    RETURN_NOT_OK(data_buffer_->Resize(CalculateHeaderSize(), /*shrink_to_fit=*/false));\n+    int64_t header_size;\n+    ASSIGN_OR_RAISE(header_size, CalculateHeaderSize());\n\nReview comment:\n       N.B. the ASSIGN_OR_RAISE macro lets you declare the variable inline (`ASSIGN_OR_RAISE(int64_t header_size, CalculateHeaderSize());`)\n\n##########\nFile path: cpp/src/arrow/csv/writer_test.cc\n##########\n@@ -49,6 +49,8 @@ struct WriterTestParams {\n   WriteOptions options;\n   util::optional<std::string> expected_output;\n   Status expected_status;\n+  bool options_invalid;\n+  bool escaping_invalid;\n\nReview comment:\n       It seems these aren't used anymore?\n\n\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-10T16:45:24.496+0000",
                    "updated": "2021-12-10T16:45:24.496+0000",
                    "started": "2021-12-10T16:45:24.496+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "694099",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/694935",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-992284814\n\n\n   1) Can you rebase this and fix conflicts?\r\n   2) It seems it would be nice to have a common setting for quoting and escaping (either you quote or you escape special chars, not both at once)\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2021-12-13T09:46:42.064+0000",
                    "updated": "2021-12-13T09:46:42.064+0000",
                    "started": "2021-12-13T09:46:42.064+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "694935",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/702913",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ahadnagy commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-1004062137\n\n\n   > 2. It seems it would be nice to have a common setting for quoting and escaping (either you quote or you escape special chars, not both at once)\r\n   \r\n   These are different options in both Pandas (https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html) and readr (https://readr.tidyverse.org/reference/write_delim.html). I'd lean towards aligning with these, but if you have a proposal, we can discuss that.\r\n   \n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-03T12:33:30.298+0000",
                    "updated": "2022-01-03T12:33:30.298+0000",
                    "started": "2022-01-03T12:33:30.298+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "702913",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/702914",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-1004066106\n\n\n   @ahadnagy If you have both quoting and escaping enabled, how do you decide whether you should quote or escape a special character?\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-03T12:42:11.725+0000",
                    "updated": "2022-01-03T12:42:11.725+0000",
                    "started": "2022-01-03T12:42:11.725+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "702914",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/702918",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "ahadnagy commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-1004072707\n\n\n   Currently, the escape character is being used (this aligns with readr).\r\n   The Pandas csv_writer has a `doublequote` parameter to control quoting/escaping inside a field explicitly.\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-03T12:57:02.501+0000",
                    "updated": "2022-01-03T12:57:02.501+0000",
                    "started": "2022-01-03T12:57:02.501+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "702918",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/702923",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on pull request #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-1004074040\n\n\n   Right, but this also makes the whole API confusing (why is the escape character being used? what if both double-quoting and escaping are enabled?).\n\n\n-- \nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on to GitHub and use the\nURL above to go to the specific comment.\n\nTo unsubscribe, e-mail: github-unsubscribe@arrow.apache.org\n\nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "created": "2022-01-03T12:59:51.438+0000",
                    "updated": "2022-01-03T12:59:51.438+0000",
                    "started": "2022-01-03T12:59:51.438+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "702923",
                    "issueId": "13414341"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/worklog/759244",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "comment": "pitrou commented on PR #11863:\nURL: https://github.com/apache/arrow/pull/11863#issuecomment-1103950027\n\n   Let me suggest the following API:\r\n   ```c++\r\n     /// \\brief Quoting style\r\n     QuotingStyle quoting_style = QuotingStyle::Needed;\r\n   \r\n     /// Whether a quote inside a quoted value is double-quoted (if true)\r\n     /// or escaped using the `escape_char` (if false).\r\n     bool double_quote = true;\r\n   \r\n     /// Escaping character for non-quoted fields.\r\n     char escape_char = kDefaultEscapeChar;\r\n   ```\r\n   \r\n   with the following semantics:\r\n   * if in a quoted field and `double_quote` is true, a quote in a value is double-quoted (i.e. becomes `\"\"`)\r\n   * if in a quoted field and `double_quote` is false, a quote in a value is escape (e.g. becomes `\\\"` for the default escape char)\r\n   * if in a non-quoted field, any special character (quote, field delimiter, end of line character) is escaped using the escape char\r\n   \r\n   \n\n\n",
                    "created": "2022-04-20T13:43:57.401+0000",
                    "updated": "2022-04-20T13:43:57.401+0000",
                    "started": "2022-04-20T13:43:57.401+0000",
                    "timeSpent": "10m",
                    "timeSpentSeconds": 600,
                    "id": "759244",
                    "issueId": "13414341"
                }
            ]
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/7",
            "id": "7",
            "description": "The sub-task of the issue",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype",
            "name": "Sub-task",
            "subtask": true,
            "avatarId": 21146
        },
        "timespent": 9600,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@79228fab[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1eaef420[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47786459[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@2e1e9762[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4d27dbde[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@305b5a9f[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3485aa61[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6efa9e14[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1d70413e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@77156fad[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@6e5a058c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@54ea3c6d[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": 9600,
        "customfield_12312520": null,
        "customfield_12312521": "Fri Jul 15 15:32:22 UTC 2022",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": null,
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-14906/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2021-11-29T15:57:44.000+0000",
        "updated": "2022-07-15T15:33:40.000+0000",
        "timeoriginalestimate": null,
        "description": "We would use this for alignment with {{readr::write_csv()}}. There the {{escape}} argument controls the type of escape to use when quotes are in the data:\r\n* {{double}}: quotes are escaped by doubling them\r\n* {{backslash}}: quotes are escaped by a preceding backslash\r\n* {{none}}: quotes are not escaped",
        "customfield_10010": null,
        "timetracking": {
            "remainingEstimate": "0h",
            "timeSpent": "2h 40m",
            "remainingEstimateSeconds": 0,
            "timeSpentSeconds": 9600
        },
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[C++] Enable CSV Writer to control the type of escape used for quoting",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13414341/comment/17567298",
                    "id": "17567298",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "body": "This issue has been inactive for 3 months, so it has been unassigned and marked as unstarted. If you are still working on this, feel free to reassign yourself and resume progress.",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=npr",
                        "name": "npr",
                        "key": "npr",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34045",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34045",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34045",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34045"
                        },
                        "displayName": "Neal Richardson",
                        "active": true,
                        "timeZone": "America/Los_Angeles"
                    },
                    "created": "2022-07-15T15:32:22.689+0000",
                    "updated": "2022-07-15T15:32:22.689+0000"
                }
            ],
            "maxResults": 1,
            "total": 1,
            "startAt": 0
        },
        "customfield_12311820": "0|z0x6ao:",
        "customfield_12314139": null
    }
}