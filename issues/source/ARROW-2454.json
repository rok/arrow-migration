{
    "expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields",
    "id": "13152237",
    "self": "https://issues.apache.org/jira/rest/api/2/issue/13152237",
    "key": "ARROW-2454",
    "fields": {
        "fixVersions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12342562",
                "id": "12342562",
                "description": "",
                "name": "0.10.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-08-06"
            }
        ],
        "resolution": {
            "self": "https://issues.apache.org/jira/rest/api/2/resolution/1",
            "id": "1",
            "description": "A fix for this issue is checked into the tree and tested.",
            "name": "Fixed"
        },
        "customfield_12312322": null,
        "customfield_12312323": null,
        "customfield_12312320": null,
        "customfield_12310420": "9223372036854775807",
        "customfield_12312321": null,
        "customfield_12312328": null,
        "customfield_12312329": null,
        "customfield_12312326": null,
        "customfield_12310300": null,
        "customfield_12312327": null,
        "customfield_12312324": null,
        "customfield_12312720": null,
        "customfield_12312325": null,
        "lastViewed": null,
        "priority": {
            "self": "https://issues.apache.org/jira/rest/api/2/priority/3",
            "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg",
            "name": "Major",
            "id": "3"
        },
        "labels": [
            "pull-request-available"
        ],
        "customfield_12312333": null,
        "customfield_12312334": null,
        "customfield_12313422": "false",
        "customfield_12310310": "0.0",
        "customfield_12312331": null,
        "customfield_12312332": null,
        "aggregatetimeoriginalestimate": null,
        "timeestimate": null,
        "customfield_12312330": null,
        "versions": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/version/12341707",
                "id": "12341707",
                "description": "",
                "name": "0.9.0",
                "archived": false,
                "released": true,
                "releaseDate": "2018-03-19"
            }
        ],
        "customfield_12311120": null,
        "customfield_12313826": null,
        "customfield_12312339": null,
        "issuelinks": [],
        "customfield_12313825": null,
        "assignee": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "customfield_12312337": null,
        "customfield_12313823": null,
        "customfield_12312338": null,
        "customfield_12311920": null,
        "customfield_12313822": null,
        "customfield_12312335": null,
        "customfield_12313821": null,
        "customfield_12312336": null,
        "customfield_12313820": null,
        "status": {
            "self": "https://issues.apache.org/jira/rest/api/2/status/5",
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.",
            "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png",
            "name": "Resolved",
            "id": "5",
            "statusCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3",
                "id": 3,
                "key": "done",
                "colorName": "green",
                "name": "Done"
            }
        },
        "components": [
            {
                "self": "https://issues.apache.org/jira/rest/api/2/component/12328936",
                "id": "12328936",
                "name": "Python"
            }
        ],
        "customfield_12312026": null,
        "customfield_12312023": null,
        "customfield_12312024": null,
        "aggregatetimeestimate": null,
        "customfield_12312022": null,
        "customfield_12310921": null,
        "customfield_12310920": "9223372036854775807",
        "customfield_12312823": null,
        "creator": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "subtasks": [],
        "reporter": {
            "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
            "name": "apitrou",
            "key": "pitrou",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
            },
            "displayName": "Antoine Pitrou",
            "active": true,
            "timeZone": "Europe/Paris"
        },
        "aggregateprogress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313520": null,
        "customfield_12310250": null,
        "progress": {
            "progress": 0,
            "total": 0
        },
        "customfield_12313924": null,
        "votes": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2454/votes",
            "votes": 0,
            "hasVoted": false
        },
        "worklog": {
            "startAt": 0,
            "maxResults": 20,
            "total": 0,
            "worklogs": []
        },
        "customfield_12313920": null,
        "issuetype": {
            "self": "https://issues.apache.org/jira/rest/api/2/issuetype/1",
            "id": "1",
            "description": "A problem which impairs or prevents the functions of the product.",
            "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype",
            "name": "Bug",
            "subtask": false,
            "avatarId": 21133
        },
        "timespent": null,
        "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@4129d1c7[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2e2f907c[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5f5c2706[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@d22e0e1[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@13441e99[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@605aa204[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5e00cd1e[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@443f1bd7[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@773c651f[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4243a37e[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1af3fe15[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@262eaf3f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}",
        "customfield_12314141": null,
        "customfield_12314140": null,
        "project": {
            "self": "https://issues.apache.org/jira/rest/api/2/project/12319525",
            "id": "12319525",
            "key": "ARROW",
            "name": "Apache Arrow",
            "projectTypeKey": "software",
            "avatarUrls": {
                "48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12319525&avatarId=10011",
                "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12319525&avatarId=10011",
                "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12319525&avatarId=10011",
                "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12319525&avatarId=10011"
            },
            "projectCategory": {
                "self": "https://issues.apache.org/jira/rest/api/2/projectCategory/13960",
                "id": "13960",
                "description": "Apache Arrow",
                "name": "Arrow"
            }
        },
        "aggregatetimespent": null,
        "customfield_12312520": null,
        "customfield_12312521": "Mon Apr 16 15:36:14 UTC 2018",
        "customfield_12314422": null,
        "customfield_12314421": null,
        "customfield_12314146": null,
        "customfield_12314420": null,
        "customfield_12314145": null,
        "customfield_12314144": null,
        "customfield_12314143": null,
        "resolutiondate": "2018-04-16T15:36:14.000+0000",
        "workratio": -1,
        "customfield_12312923": null,
        "customfield_12312920": null,
        "customfield_12312921": null,
        "watches": {
            "self": "https://issues.apache.org/jira/rest/api/2/issue/ARROW-2454/watchers",
            "watchCount": 2,
            "isWatching": false
        },
        "created": "2018-04-13T09:54:01.000+0000",
        "updated": "2018-04-16T15:36:14.000+0000",
        "timeoriginalestimate": null,
        "description": "{code:python}\r\n>>> col = pa.Column.from_array('ints', pa.array([1,2,3]))\r\n>>> col\r\n<pyarrow.lib.Column object at 0x7f65398fff00>\r\nchunk 0: <pyarrow.lib.Int64Array object at 0x7f64fd13ab88>\r\n[\r\n  1,\r\n  2,\r\n  3\r\n]\r\n>>> col.data\r\n<pyarrow.lib.ChunkedArray at 0x7f653986ef00>\r\n>>> col.data[:1]\r\n<pyarrow.lib.ChunkedArray at 0x7f6539884720>\r\n>>> col.data[:0]\r\nErreur de segmentation (core dumped)\r\n{code}\r\n",
        "customfield_10010": null,
        "timetracking": {},
        "customfield_12314523": null,
        "customfield_12314127": null,
        "customfield_12314522": null,
        "customfield_12314126": null,
        "customfield_12314521": null,
        "customfield_12314125": null,
        "customfield_12314520": null,
        "customfield_12314124": null,
        "attachment": [],
        "customfield_12312340": null,
        "customfield_12314123": null,
        "customfield_12312341": null,
        "customfield_12312220": null,
        "customfield_12314122": null,
        "customfield_12314121": null,
        "customfield_12314120": null,
        "customfield_12314129": null,
        "customfield_12314524": null,
        "customfield_12314128": null,
        "summary": "[Python] Empty chunked array slice crashes",
        "customfield_12314130": null,
        "customfield_12310291": null,
        "customfield_12310290": null,
        "customfield_12314138": null,
        "customfield_12314137": null,
        "environment": null,
        "customfield_12314136": null,
        "customfield_12314135": null,
        "customfield_12311020": null,
        "customfield_12314134": null,
        "duedate": null,
        "customfield_12314132": null,
        "customfield_12314131": null,
        "comment": {
            "comments": [
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13152237/comment/16439211",
                    "id": "16439211",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou opened a new pull request #1897: ARROW-2454: [C++] Allow zero-array chunked arrays\nURL: https://github.com/apache/arrow/pull/1897\n \n \n   This allows code to be more regular and less fragile.\r\n   \r\n   Also fix the chunked array slicing logic.\n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-16T10:03:42.230+0000",
                    "updated": "2018-04-16T10:03:42.230+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13152237/comment/16439595",
                    "id": "16439595",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "body": "pitrou closed pull request #1897: ARROW-2454: [C++] Allow zero-array chunked arrays\nURL: https://github.com/apache/arrow/pull/1897\n \n \n   \n\nThis is a PR merged from a forked repository.\nAs GitHub hides the original diff on merge, it is displayed below for\nthe sake of provenance:\n\nAs this is a foreign pull request (from a fork), the diff is supplied\nbelow (as it won't show otherwise due to GitHub magic):\n\ndiff --git a/cpp/src/arrow/table-test.cc b/cpp/src/arrow/table-test.cc\nindex b1cf6e59a2..0b9f75df19 100644\n--- a/cpp/src/arrow/table-test.cc\n+++ b/cpp/src/arrow/table-test.cc\n@@ -43,7 +43,9 @@ class TestChunkedArray : public TestBase {\n  protected:\n   virtual void Construct() {\n     one_ = std::make_shared<ChunkedArray>(arrays_one_);\n-    another_ = std::make_shared<ChunkedArray>(arrays_another_);\n+    if (!arrays_another_.empty()) {\n+      another_ = std::make_shared<ChunkedArray>(arrays_another_);\n+    }\n   }\n \n   ArrayVector arrays_one_;\n@@ -121,6 +123,23 @@ TEST_F(TestChunkedArray, SliceEquals) {\n   std::shared_ptr<ChunkedArray> slice2 = one_->Slice(75)->Slice(25)->Slice(25, 50);\n   ASSERT_EQ(slice2->length(), 50);\n   test::AssertChunkedEqual(*slice, *slice2);\n+\n+  // Making empty slices of a ChunkedArray\n+  std::shared_ptr<ChunkedArray> slice3 = one_->Slice(one_->length(), 99);\n+  ASSERT_EQ(slice3->length(), 0);\n+  ASSERT_EQ(slice3->num_chunks(), 0);\n+  ASSERT_TRUE(slice3->type()->Equals(one_->type()));\n+\n+  std::shared_ptr<ChunkedArray> slice4 = one_->Slice(10, 0);\n+  ASSERT_EQ(slice4->length(), 0);\n+  ASSERT_EQ(slice4->num_chunks(), 0);\n+  ASSERT_TRUE(slice4->type()->Equals(one_->type()));\n+\n+  // Slicing an empty ChunkedArray\n+  std::shared_ptr<ChunkedArray> slice5 = slice4->Slice(0, 10);\n+  ASSERT_EQ(slice5->length(), 0);\n+  ASSERT_EQ(slice5->num_chunks(), 0);\n+  ASSERT_TRUE(slice5->type()->Equals(one_->type()));\n }\n \n class TestColumn : public TestChunkedArray {\ndiff --git a/cpp/src/arrow/table.cc b/cpp/src/arrow/table.cc\nindex f6ac6dd3b1..8af47ea220 100644\n--- a/cpp/src/arrow/table.cc\n+++ b/cpp/src/arrow/table.cc\n@@ -39,13 +39,25 @@ namespace arrow {\n ChunkedArray::ChunkedArray(const ArrayVector& chunks) : chunks_(chunks) {\n   length_ = 0;\n   null_count_ = 0;\n+  DCHECK_GT(chunks.size(), 0)\n+      << \"cannot construct ChunkedArray from empty vector and omitted type\";\n+  type_ = chunks[0]->type();\n   for (const std::shared_ptr<Array>& chunk : chunks) {\n     length_ += chunk->length();\n     null_count_ += chunk->null_count();\n   }\n }\n \n-std::shared_ptr<DataType> ChunkedArray::type() const { return chunks_[0]->type(); }\n+ChunkedArray::ChunkedArray(const ArrayVector& chunks,\n+                           const std::shared_ptr<DataType>& type)\n+    : chunks_(chunks), type_(type) {\n+  length_ = 0;\n+  null_count_ = 0;\n+  for (const std::shared_ptr<Array>& chunk : chunks) {\n+    length_ += chunk->length();\n+    null_count_ += chunk->null_count();\n+  }\n+}\n \n bool ChunkedArray::Equals(const ChunkedArray& other) const {\n   if (length_ != other.length()) {\n@@ -107,20 +119,20 @@ std::shared_ptr<ChunkedArray> ChunkedArray::Slice(int64_t offset, int64_t length\n   DCHECK_LE(offset, length_);\n \n   int curr_chunk = 0;\n-  while (offset >= chunk(curr_chunk)->length()) {\n+  while (curr_chunk < num_chunks() && offset >= chunk(curr_chunk)->length()) {\n     offset -= chunk(curr_chunk)->length();\n     curr_chunk++;\n   }\n \n   ArrayVector new_chunks;\n-  while (length > 0 && curr_chunk < num_chunks()) {\n+  while (curr_chunk < num_chunks() && length > 0) {\n     new_chunks.push_back(chunk(curr_chunk)->Slice(offset, length));\n     length -= chunk(curr_chunk)->length() - offset;\n     offset = 0;\n     curr_chunk++;\n   }\n \n-  return std::make_shared<ChunkedArray>(new_chunks);\n+  return std::make_shared<ChunkedArray>(new_chunks, type_);\n }\n \n std::shared_ptr<ChunkedArray> ChunkedArray::Slice(int64_t offset) const {\n@@ -129,15 +141,15 @@ std::shared_ptr<ChunkedArray> ChunkedArray::Slice(int64_t offset) const {\n \n Column::Column(const std::shared_ptr<Field>& field, const ArrayVector& chunks)\n     : field_(field) {\n-  data_ = std::make_shared<ChunkedArray>(chunks);\n+  data_ = std::make_shared<ChunkedArray>(chunks, field->type());\n }\n \n Column::Column(const std::shared_ptr<Field>& field, const std::shared_ptr<Array>& data)\n     : field_(field) {\n   if (!data) {\n-    data_ = std::make_shared<ChunkedArray>(ArrayVector({}));\n+    data_ = std::make_shared<ChunkedArray>(ArrayVector({}), field->type());\n   } else {\n-    data_ = std::make_shared<ChunkedArray>(ArrayVector({data}));\n+    data_ = std::make_shared<ChunkedArray>(ArrayVector({data}), field->type());\n   }\n }\n \ndiff --git a/cpp/src/arrow/table.h b/cpp/src/arrow/table.h\nindex 20d027d6a5..32af224ff4 100644\n--- a/cpp/src/arrow/table.h\n+++ b/cpp/src/arrow/table.h\n@@ -40,6 +40,7 @@ class Status;\n class ARROW_EXPORT ChunkedArray {\n  public:\n   explicit ChunkedArray(const ArrayVector& chunks);\n+  ChunkedArray(const ArrayVector& chunks, const std::shared_ptr<DataType>& type);\n \n   /// \\return the total length of the chunked array; computed on construction\n   int64_t length() const { return length_; }\n@@ -68,7 +69,7 @@ class ARROW_EXPORT ChunkedArray {\n   /// \\brief Slice from offset until end of the chunked array\n   std::shared_ptr<ChunkedArray> Slice(int64_t offset) const;\n \n-  std::shared_ptr<DataType> type() const;\n+  std::shared_ptr<DataType> type() const { return type_; }\n \n   bool Equals(const ChunkedArray& other) const;\n   bool Equals(const std::shared_ptr<ChunkedArray>& other) const;\n@@ -77,6 +78,7 @@ class ARROW_EXPORT ChunkedArray {\n   ArrayVector chunks_;\n   int64_t length_;\n   int64_t null_count_;\n+  std::shared_ptr<DataType> type_;\n \n  private:\n   ARROW_DISALLOW_COPY_AND_ASSIGN(ChunkedArray);\ndiff --git a/cpp/src/arrow/type.h b/cpp/src/arrow/type.h\nindex ce213b9995..e50760b55d 100644\n--- a/cpp/src/arrow/type.h\n+++ b/cpp/src/arrow/type.h\n@@ -140,8 +140,8 @@ class ARROW_EXPORT DataType {\n \n   // Return whether the types are equal\n   //\n-  // Types that are logically convertable from one to another e.g. List<UInt8>\n-  // and Binary are NOT equal).\n+  // Types that are logically convertible from one to another (e.g. List<UInt8>\n+  // and Binary) are NOT equal.\n   virtual bool Equals(const DataType& other) const;\n   bool Equals(const std::shared_ptr<DataType>& other) const;\n \ndiff --git a/python/pyarrow/tests/test_table.py b/python/pyarrow/tests/test_table.py\nindex 81564352b1..5303cb2190 100644\n--- a/python/pyarrow/tests/test_table.py\n+++ b/python/pyarrow/tests/test_table.py\n@@ -44,6 +44,10 @@ def test_chunked_array_getitem():\n     data_slice = data[4:-1]\n     assert data_slice.to_pylist() == [5]\n \n+    data_slice = data[99:99]\n+    assert data_slice.type == data.type\n+    assert data_slice.to_pylist() == []\n+\n \n def test_column_basics():\n     data = [\n\n\n \n\n----------------------------------------------------------------\nThis is an automated message from the Apache Git Service.\nTo respond to the message, please log on GitHub and use the\nURL above to go to the specific comment.\n \nFor queries about this service, please contact Infrastructure at:\nusers@infra.apache.org\n",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot",
                        "name": "githubbot",
                        "key": "githubbot",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"
                        },
                        "displayName": "ASF GitHub Bot",
                        "active": true,
                        "timeZone": "Etc/UTC"
                    },
                    "created": "2018-04-16T15:36:14.464+0000",
                    "updated": "2018-04-16T15:36:14.464+0000"
                },
                {
                    "self": "https://issues.apache.org/jira/rest/api/2/issue/13152237/comment/16439596",
                    "id": "16439596",
                    "author": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "body": "Issue resolved by pull request 1897\n[https://github.com/apache/arrow/pull/1897]",
                    "updateAuthor": {
                        "self": "https://issues.apache.org/jira/rest/api/2/user?username=apitrou",
                        "name": "apitrou",
                        "key": "pitrou",
                        "avatarUrls": {
                            "48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=pitrou&avatarId=35049",
                            "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=pitrou&avatarId=35049",
                            "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=pitrou&avatarId=35049",
                            "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=pitrou&avatarId=35049"
                        },
                        "displayName": "Antoine Pitrou",
                        "active": true,
                        "timeZone": "Europe/Paris"
                    },
                    "created": "2018-04-16T15:36:14.687+0000",
                    "updated": "2018-04-16T15:36:14.687+0000"
                }
            ],
            "maxResults": 3,
            "total": 3,
            "startAt": 0
        },
        "customfield_12311820": "0|i3silb:",
        "customfield_12314139": null
    }
}